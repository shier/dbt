06:48:53.046378 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_Vendor: 
    
  if object_id ('"dbo"."Auct_Vendor__dbt_backup"','U') is not null
    begin
    drop table "dbo"."Auct_Vendor__dbt_backup"
    end

06:48:53.243120 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
06:48:53.256853 [debug] [Thread-4  ]: finished collecting timing info
06:48:53.257292 [debug] [Thread-4  ]: On model.Shawn.Auct_Vendor: Close
06:48:53.258025 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8211e7d1-e715-45ef-98de-e4fa4f0e542c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2765601850>]}
06:48:53.258474 [info ] [Thread-4  ]: 397 of 411 OK created table model dbo.Auct_Vendor............................... [[32mOK[0m in 3.34s]
06:48:53.258862 [debug] [Thread-4  ]: Finished running node model.Shawn.Auct_Vendor
06:48:53.259035 [debug] [Thread-4  ]: Began running node model.Shawn.Auct_VendorBooth
06:48:53.259353 [info ] [Thread-4  ]: 399 of 411 START table model dbo.Auct_VendorBooth............................... [RUN]
06:48:53.259733 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.Auct_VendorBooth"
06:48:53.259874 [debug] [Thread-4  ]: Began compiling node model.Shawn.Auct_VendorBooth
06:48:53.259999 [debug] [Thread-4  ]: Compiling model.Shawn.Auct_VendorBooth
06:48:53.262426 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.Auct_VendorBooth"
06:48:53.262868 [debug] [Thread-4  ]: finished collecting timing info
06:48:53.263016 [debug] [Thread-4  ]: Began executing node model.Shawn.Auct_VendorBooth
06:48:53.298433 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.Auct_VendorBooth"
06:48:53.299128 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorBooth".
06:48:53.299307 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_VendorBooth: 
  
  if object_id ('"dbo"."Auct_VendorBooth__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_VendorBooth__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."Auct_VendorBooth__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."Auct_VendorBooth__dbt_tmp"
    end


   EXEC('create view dbo.Auct_VendorBooth__dbt_tmp_temp_view as
    
Select
	cast([VendorBoothID] as int) [VENDORBOOTHID],
	cast([BoothID] as int) [BOOTHID],
	cast([VendorAuctionID] as int) [VENDORAUCTIONID],
	cast([UpdateEventID] as int) [UPDATEEVENTID],
	cast([Created] as datetime) [CREATED] 
From stg.[Auct_VendorBooth_FinalView]
    ');

  CREATE TABLE "dbo"."Auct_VendorBooth__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.Auct_VendorBooth__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."Auct_VendorBooth__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_VendorBooth__dbt_tmp_temp_view"
    end



06:48:53.299423 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
06:48:53.299559 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
06:48:53.411963 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
06:48:55.238200 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.55 seconds
06:48:55.253301 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorAuction".
06:48:55.253657 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_VendorAuction: rename object "dbo"."Auct_VendorAuction" to Auct_VendorAuction__dbt_backup
06:48:55.257989 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 5.27 seconds
06:48:55.272411 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_UsersKey".
06:48:55.272756 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_UsersKey: rename object "dbo"."Auct_UsersKey" to Auct_UsersKey__dbt_backup
06:48:55.284950 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:48:55.299131 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorAuction".
06:48:55.299492 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_VendorAuction: rename object "dbo"."Auct_VendorAuction__dbt_tmp" to Auct_VendorAuction
06:48:55.303395 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:48:55.317343 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_UsersKey".
06:48:55.317630 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_UsersKey: rename object "dbo"."Auct_UsersKey__dbt_tmp" to Auct_UsersKey
06:48:55.328153 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:48:55.329856 [debug] [Thread-1  ]: On model.Shawn.Auct_VendorAuction: COMMIT
06:48:55.333587 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorAuction".
06:48:55.333803 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_VendorAuction: 
    
  if object_id ('"dbo"."Auct_VendorAuction__dbt_backup"','U') is not null
    begin
    drop table "dbo"."Auct_VendorAuction__dbt_backup"
    end

06:48:55.346663 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:48:55.348392 [debug] [Thread-3  ]: On model.Shawn.Auct_UsersKey: COMMIT
06:48:55.352416 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_UsersKey".
06:48:55.352576 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.05 seconds
06:48:55.352741 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_UsersKey: 
    
  if object_id ('"dbo"."Auct_UsersKey__dbt_backup"','U') is not null
    begin
    drop table "dbo"."Auct_UsersKey__dbt_backup"
    end

06:48:55.366895 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorBooth".
06:48:55.367455 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_VendorBooth: rename object "dbo"."Auct_VendorBooth" to Auct_VendorBooth__dbt_backup
06:48:55.397296 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:48:55.411764 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorBooth".
06:48:55.412136 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_VendorBooth: rename object "dbo"."Auct_VendorBooth__dbt_tmp" to Auct_VendorBooth
06:48:55.442616 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:48:55.444409 [debug] [Thread-4  ]: On model.Shawn.Auct_VendorBooth: COMMIT
06:48:55.448697 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorBooth".
06:48:55.448927 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_VendorBooth: 
    
  if object_id ('"dbo"."Auct_VendorBooth__dbt_backup"','U') is not null
    begin
    drop table "dbo"."Auct_VendorBooth__dbt_backup"
    end

06:48:55.506460 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
06:48:55.519783 [debug] [Thread-1  ]: finished collecting timing info
06:48:55.520206 [debug] [Thread-1  ]: On model.Shawn.Auct_VendorAuction: Close
06:48:55.520919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8211e7d1-e715-45ef-98de-e4fa4f0e542c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27656019a0>]}
06:48:55.521378 [info ] [Thread-1  ]: 398 of 411 OK created table model dbo.Auct_VendorAuction........................ [[32mOK[0m in 3.87s]
06:48:55.521744 [debug] [Thread-1  ]: Finished running node model.Shawn.Auct_VendorAuction
06:48:55.521923 [debug] [Thread-1  ]: Began running node model.Shawn.Auct_VendorNotification
06:48:55.522242 [info ] [Thread-1  ]: 400 of 411 START table model dbo.Auct_VendorNotification........................ [RUN]
06:48:55.522664 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.Auct_VendorNotification"
06:48:55.522818 [debug] [Thread-1  ]: Began compiling node model.Shawn.Auct_VendorNotification
06:48:55.522971 [debug] [Thread-1  ]: Compiling model.Shawn.Auct_VendorNotification
06:48:55.525389 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.Auct_VendorNotification"
06:48:55.525803 [debug] [Thread-1  ]: finished collecting timing info
06:48:55.526024 [debug] [Thread-1  ]: Began executing node model.Shawn.Auct_VendorNotification
06:48:55.638167 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
06:48:55.638581 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
06:48:55.652753 [debug] [Thread-3  ]: finished collecting timing info
06:48:55.674628 [debug] [Thread-3  ]: On model.Shawn.Auct_UsersKey: Close
06:48:55.675494 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8211e7d1-e715-45ef-98de-e4fa4f0e542c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27645c5a90>]}
06:48:55.675928 [info ] [Thread-3  ]: 396 of 411 OK created table model dbo.Auct_UsersKey............................. [[32mOK[0m in 5.78s]
06:48:55.676287 [debug] [Thread-3  ]: Finished running node model.Shawn.Auct_UsersKey
06:48:55.676458 [debug] [Thread-3  ]: Began running node model.Shawn.Auct_VendorRef
06:48:55.676771 [info ] [Thread-3  ]: 401 of 411 START table model dbo.Auct_VendorRef................................. [RUN]
06:48:55.677155 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.Auct_VendorRef"
06:48:55.677296 [debug] [Thread-3  ]: Began compiling node model.Shawn.Auct_VendorRef
06:48:55.677427 [debug] [Thread-3  ]: Compiling model.Shawn.Auct_VendorRef
06:48:55.679988 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.Auct_VendorRef"
06:48:55.680825 [debug] [Thread-4  ]: finished collecting timing info
06:48:55.692125 [debug] [Thread-4  ]: On model.Shawn.Auct_VendorBooth: Close
06:48:55.693015 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8211e7d1-e715-45ef-98de-e4fa4f0e542c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27643b46a0>]}
06:48:55.693597 [info ] [Thread-4  ]: 399 of 411 OK created table model dbo.Auct_VendorBooth.......................... [[32mOK[0m in 2.43s]
06:48:55.693255 [debug] [Thread-3  ]: finished collecting timing info
06:48:55.693965 [debug] [Thread-3  ]: Began executing node model.Shawn.Auct_VendorRef
06:48:55.703848 [debug] [Thread-4  ]: Finished running node model.Shawn.Auct_VendorBooth
06:48:55.721929 [debug] [Thread-4  ]: Began running node model.Shawn.Auct_VendorStatus
06:48:55.728661 [info ] [Thread-4  ]: 402 of 411 START table model dbo.Auct_VendorStatus.............................. [RUN]
06:48:55.740232 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.Auct_VendorStatus"
06:48:55.740494 [debug] [Thread-4  ]: Began compiling node model.Shawn.Auct_VendorStatus
06:48:55.740641 [debug] [Thread-4  ]: Compiling model.Shawn.Auct_VendorStatus
06:48:55.728365 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.Auct_VendorNotification"
06:48:55.743997 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorNotification".
06:48:55.744157 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_VendorNotification: 
  
  if object_id ('"dbo"."Auct_VendorNotification__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_VendorNotification__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."Auct_VendorNotification__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."Auct_VendorNotification__dbt_tmp"
    end


   EXEC('create view dbo.Auct_VendorNotification__dbt_tmp_temp_view as
    
Select
	cast([VendorNotificationID] as int) [VENDORNOTIFICATIONID],
	cast([VendorID] as int) [VENDORID],
	cast([AuctionType] as nvarchar(4000)) [AUCTIONTYPE],
	cast([ReceiveInfo] as nvarchar(4000)) [RECEIVEINFO],
	cast([UpdateEventID] as int) [UPDATEEVENTID],
	cast([Created] as datetime) [CREATED] 
From stg.[Auct_VendorNotification_FinalView]
    ');

  CREATE TABLE "dbo"."Auct_VendorNotification__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.Auct_VendorNotification__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."Auct_VendorNotification__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_VendorNotification__dbt_tmp_temp_view"
    end



06:48:55.744282 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
06:48:55.744416 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
06:48:55.743437 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.Auct_VendorStatus"
06:48:55.751683 [debug] [Thread-4  ]: finished collecting timing info
06:48:55.751855 [debug] [Thread-4  ]: Began executing node model.Shawn.Auct_VendorStatus
06:48:55.751133 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.Auct_VendorRef"
06:48:55.764216 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorRef".
06:48:55.764466 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_VendorRef: 
  
  if object_id ('"dbo"."Auct_VendorRef__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_VendorRef__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."Auct_VendorRef__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."Auct_VendorRef__dbt_tmp"
    end


   EXEC('create view dbo.Auct_VendorRef__dbt_tmp_temp_view as
    
Select
	cast([OldVendorID] as int) [OLDVENDORID],
	cast([NewVendorID] as int) [NEWVENDORID],
	cast([VendorAuctionID] as int) [VENDORAUCTIONID] 
From stg.[Auct_VendorRef_FinalView]
    ');

  CREATE TABLE "dbo"."Auct_VendorRef__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.Auct_VendorRef__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."Auct_VendorRef__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_VendorRef__dbt_tmp_temp_view"
    end



06:48:55.764586 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
06:48:55.764734 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
06:48:55.799681 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.Auct_VendorStatus"
06:48:55.800335 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorStatus".
06:48:55.800527 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_VendorStatus: 
  
  if object_id ('"dbo"."Auct_VendorStatus__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_VendorStatus__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."Auct_VendorStatus__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."Auct_VendorStatus__dbt_tmp"
    end


   EXEC('create view dbo.Auct_VendorStatus__dbt_tmp_temp_view as
    
Select
	cast([VendorStatusID] as int) [VENDORSTATUSID],
	cast([Name] as nvarchar(4000)) [NAME],
	cast([Created] as datetime) [CREATED],
	cast([UpdateEventID] as int) [UPDATEEVENTID] 
From stg.[Auct_VendorStatus_FinalView]
    ');

  CREATE TABLE "dbo"."Auct_VendorStatus__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.Auct_VendorStatus__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."Auct_VendorStatus__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_VendorStatus__dbt_tmp_temp_view"
    end



06:48:55.800650 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
06:48:55.800790 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
06:48:55.853625 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
06:48:55.868070 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
06:48:55.922858 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
06:48:58.168261 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.37 seconds
06:48:58.183522 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorStatus".
06:48:58.183895 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_VendorStatus: rename object "dbo"."Auct_VendorStatus" to Auct_VendorStatus__dbt_backup
06:48:58.218282 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:48:58.232798 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorStatus".
06:48:58.233165 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_VendorStatus: rename object "dbo"."Auct_VendorStatus__dbt_tmp" to Auct_VendorStatus
06:48:58.261200 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:48:58.263069 [debug] [Thread-4  ]: On model.Shawn.Auct_VendorStatus: COMMIT
06:48:58.267345 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorStatus".
06:48:58.267574 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_VendorStatus: 
    
  if object_id ('"dbo"."Auct_VendorStatus__dbt_backup"','U') is not null
    begin
    drop table "dbo"."Auct_VendorStatus__dbt_backup"
    end

06:48:58.484069 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
06:48:58.498075 [debug] [Thread-4  ]: finished collecting timing info
06:48:58.498501 [debug] [Thread-4  ]: On model.Shawn.Auct_VendorStatus: Close
06:48:58.499258 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8211e7d1-e715-45ef-98de-e4fa4f0e542c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27671d46a0>]}
06:48:58.499693 [info ] [Thread-4  ]: 402 of 411 OK created table model dbo.Auct_VendorStatus......................... [[32mOK[0m in 2.76s]
06:48:58.500044 [debug] [Thread-4  ]: Finished running node model.Shawn.Auct_VendorStatus
06:48:58.500217 [debug] [Thread-4  ]: Began running node model.Shawn.Auct_VendorType
06:48:58.500544 [info ] [Thread-4  ]: 403 of 411 START table model dbo.Auct_VendorType................................ [RUN]
06:48:58.500936 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.Auct_VendorType"
06:48:58.501079 [debug] [Thread-4  ]: Began compiling node model.Shawn.Auct_VendorType
06:48:58.501205 [debug] [Thread-4  ]: Compiling model.Shawn.Auct_VendorType
06:48:58.503704 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.Auct_VendorType"
06:48:58.504126 [debug] [Thread-4  ]: finished collecting timing info
06:48:58.504275 [debug] [Thread-4  ]: Began executing node model.Shawn.Auct_VendorType
06:48:58.539965 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.Auct_VendorType"
06:48:58.540647 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorType".
06:48:58.540829 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_VendorType: 
  
  if object_id ('"dbo"."Auct_VendorType__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_VendorType__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."Auct_VendorType__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."Auct_VendorType__dbt_tmp"
    end


   EXEC('create view dbo.Auct_VendorType__dbt_tmp_temp_view as
    
Select
	cast([VendorTypeID] as int) [VENDORTYPEID],
	cast([Name] as nvarchar(4000)) [NAME],
	cast([Created] as datetime) [CREATED],
	cast([UpdateEventID] as int) [UPDATEEVENTID] 
From stg.[Auct_VendorType_FinalView]
    ');

  CREATE TABLE "dbo"."Auct_VendorType__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.Auct_VendorType__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."Auct_VendorType__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_VendorType__dbt_tmp_temp_view"
    end



06:48:58.540957 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
06:48:58.541102 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
06:48:58.638492 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
06:48:58.812369 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.05 seconds
06:48:58.828153 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorRef".
06:48:58.828527 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_VendorRef: rename object "dbo"."Auct_VendorRef" to Auct_VendorRef__dbt_backup
06:48:58.863337 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:48:58.877980 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorRef".
06:48:58.878345 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_VendorRef: rename object "dbo"."Auct_VendorRef__dbt_tmp" to Auct_VendorRef
06:48:58.920512 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
06:48:58.922367 [debug] [Thread-3  ]: On model.Shawn.Auct_VendorRef: COMMIT
06:48:58.926942 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorRef".
06:48:58.927208 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_VendorRef: 
    
  if object_id ('"dbo"."Auct_VendorRef__dbt_backup"','U') is not null
    begin
    drop table "dbo"."Auct_VendorRef__dbt_backup"
    end

06:48:59.113221 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
06:48:59.125290 [debug] [Thread-3  ]: finished collecting timing info
06:48:59.125685 [debug] [Thread-3  ]: On model.Shawn.Auct_VendorRef: Close
06:48:59.126420 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8211e7d1-e715-45ef-98de-e4fa4f0e542c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27567c94c0>]}
06:48:59.126930 [info ] [Thread-3  ]: 401 of 411 OK created table model dbo.Auct_VendorRef............................ [[32mOK[0m in 3.45s]
06:48:59.127298 [debug] [Thread-3  ]: Finished running node model.Shawn.Auct_VendorRef
06:48:59.127475 [debug] [Thread-3  ]: Began running node model.Shawn.Auct_VendorsurCharge
06:48:59.127797 [info ] [Thread-3  ]: 404 of 411 START table model dbo.Auct_VendorsurCharge........................... [RUN]
06:48:59.128185 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.Auct_VendorsurCharge"
06:48:59.128325 [debug] [Thread-3  ]: Began compiling node model.Shawn.Auct_VendorsurCharge
06:48:59.128452 [debug] [Thread-3  ]: Compiling model.Shawn.Auct_VendorsurCharge
06:48:59.130905 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.Auct_VendorsurCharge"
06:48:59.131304 [debug] [Thread-3  ]: finished collecting timing info
06:48:59.131511 [debug] [Thread-3  ]: Began executing node model.Shawn.Auct_VendorsurCharge
06:48:59.166200 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.Auct_VendorsurCharge"
06:48:59.166921 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorsurCharge".
06:48:59.167113 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_VendorsurCharge: 
  
  if object_id ('"dbo"."Auct_VendorsurCharge__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_VendorsurCharge__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."Auct_VendorsurCharge__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."Auct_VendorsurCharge__dbt_tmp"
    end


   EXEC('create view dbo.Auct_VendorsurCharge__dbt_tmp_temp_view as
    
Select
	cast([VendorsurChargeID] as int) [VENDORSURCHARGEID],
	cast([VendorAuctionID] as int) [VENDORAUCTIONID],
	cast([Created] as datetime) [CREATED],
	cast([UpdateEventID] as int) [UPDATEEVENTID],
	cast([Surchagecost] as numeric(19,4)) [SURCHAGECOST] 
From stg.[Auct_VendorsurCharge_FinalView]
    ');

  CREATE TABLE "dbo"."Auct_VendorsurCharge__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.Auct_VendorsurCharge__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."Auct_VendorsurCharge__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_VendorsurCharge__dbt_tmp_temp_view"
    end



06:48:59.167240 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
06:48:59.167378 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
06:48:59.230236 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.49 seconds
06:48:59.244278 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorNotification".
06:48:59.244633 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_VendorNotification: rename object "dbo"."Auct_VendorNotification" to Auct_VendorNotification__dbt_backup
06:48:59.268769 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
06:48:59.284645 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
06:48:59.297856 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorNotification".
06:48:59.298184 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_VendorNotification: rename object "dbo"."Auct_VendorNotification__dbt_tmp" to Auct_VendorNotification
06:48:59.338906 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
06:48:59.340585 [debug] [Thread-1  ]: On model.Shawn.Auct_VendorNotification: COMMIT
06:48:59.344577 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorNotification".
06:48:59.344774 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_VendorNotification: 
    
  if object_id ('"dbo"."Auct_VendorNotification__dbt_backup"','U') is not null
    begin
    drop table "dbo"."Auct_VendorNotification__dbt_backup"
    end

06:48:59.558821 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
06:48:59.571731 [debug] [Thread-1  ]: finished collecting timing info
06:48:59.572132 [debug] [Thread-1  ]: On model.Shawn.Auct_VendorNotification: Close
06:48:59.572927 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8211e7d1-e715-45ef-98de-e4fa4f0e542c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2767251f40>]}
06:48:59.573384 [info ] [Thread-1  ]: 400 of 411 OK created table model dbo.Auct_VendorNotification................... [[32mOK[0m in 4.05s]
06:48:59.573737 [debug] [Thread-1  ]: Finished running node model.Shawn.Auct_VendorNotification
06:48:59.573910 [debug] [Thread-1  ]: Began running node model.Shawn.Auct_Venue
06:48:59.574222 [info ] [Thread-1  ]: 405 of 411 START table model dbo.Auct_Venue..................................... [RUN]
06:48:59.574633 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.Auct_Venue"
06:48:59.574780 [debug] [Thread-1  ]: Began compiling node model.Shawn.Auct_Venue
06:48:59.574908 [debug] [Thread-1  ]: Compiling model.Shawn.Auct_Venue
06:48:59.577333 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.Auct_Venue"
06:48:59.577736 [debug] [Thread-1  ]: finished collecting timing info
06:48:59.577881 [debug] [Thread-1  ]: Began executing node model.Shawn.Auct_Venue
06:48:59.612476 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.Auct_Venue"
06:48:59.613153 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Venue".
06:48:59.613353 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Venue: 
  
  if object_id ('"dbo"."Auct_Venue__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_Venue__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."Auct_Venue__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."Auct_Venue__dbt_tmp"
    end


   EXEC('create view dbo.Auct_Venue__dbt_tmp_temp_view as
    
Select
	cast([VenueID] as int) [VENUEID],
	cast([Name] as nvarchar(4000)) [NAME],
	cast([AddressID] as int) [ADDRESSID],
	cast([ShippingName] as nvarchar(4000)) [SHIPPINGNAME],
	cast([ShippingAddressID] as int) [SHIPPINGADDRESSID],
	cast([Active] as int) [ACTIVE] 
From stg.[Auct_Venue_FinalView]
    ');

  CREATE TABLE "dbo"."Auct_Venue__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.Auct_Venue__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."Auct_Venue__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_Venue__dbt_tmp_temp_view"
    end



06:48:59.613479 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
06:48:59.613621 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
06:48:59.715552 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
06:49:00.682479 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.14 seconds
06:49:00.698058 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorType".
06:49:00.698425 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_VendorType: rename object "dbo"."Auct_VendorType" to Auct_VendorType__dbt_backup
06:49:00.735964 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
06:49:00.749883 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorType".
06:49:00.750223 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_VendorType: rename object "dbo"."Auct_VendorType__dbt_tmp" to Auct_VendorType
06:49:00.780128 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:49:00.781968 [debug] [Thread-4  ]: On model.Shawn.Auct_VendorType: COMMIT
06:49:00.786262 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorType".
06:49:00.786489 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_VendorType: 
    
  if object_id ('"dbo"."Auct_VendorType__dbt_backup"','U') is not null
    begin
    drop table "dbo"."Auct_VendorType__dbt_backup"
    end

06:49:01.003294 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
06:49:01.015946 [debug] [Thread-4  ]: finished collecting timing info
06:49:01.016324 [debug] [Thread-4  ]: On model.Shawn.Auct_VendorType: Close
06:49:01.017032 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8211e7d1-e715-45ef-98de-e4fa4f0e542c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27642930a0>]}
06:49:01.017485 [info ] [Thread-4  ]: 403 of 411 OK created table model dbo.Auct_VendorType........................... [[32mOK[0m in 2.52s]
06:49:01.017847 [debug] [Thread-4  ]: Finished running node model.Shawn.Auct_VendorType
06:49:01.018023 [debug] [Thread-4  ]: Began running node model.Shawn.Auct_WaitingList
06:49:01.018335 [info ] [Thread-4  ]: 406 of 411 START table model dbo.Auct_WaitingList............................... [RUN]
06:49:01.018742 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.Auct_WaitingList"
06:49:01.018889 [debug] [Thread-4  ]: Began compiling node model.Shawn.Auct_WaitingList
06:49:01.019015 [debug] [Thread-4  ]: Compiling model.Shawn.Auct_WaitingList
06:49:01.021380 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.Auct_WaitingList"
06:49:01.021779 [debug] [Thread-4  ]: finished collecting timing info
06:49:01.021922 [debug] [Thread-4  ]: Began executing node model.Shawn.Auct_WaitingList
06:49:01.056096 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.Auct_WaitingList"
06:49:01.056749 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_WaitingList".
06:49:01.056927 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_WaitingList: 
  
  if object_id ('"dbo"."Auct_WaitingList__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_WaitingList__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."Auct_WaitingList__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."Auct_WaitingList__dbt_tmp"
    end


   EXEC('create view dbo.Auct_WaitingList__dbt_tmp_temp_view as
    
Select
	cast([AuctionID] as int) [AUCTIONID],
	cast([CustomerAccountID] as int) [CUSTOMERACCOUNTID],
	cast([WaitingStateBit] as int) [WAITINGSTATEBIT],
	cast([WaitingListTypeID] as int) [WAITINGLISTTYPEID],
	cast([CreatedByUserName] as nvarchar(4000)) [CREATEDBYUSERNAME],
	cast([Created] as datetime) [CREATED],
	cast([WaitingListID] as int) [WAITINGLISTID] 
From stg.[Auct_WaitingList_FinalView]
    ');

  CREATE TABLE "dbo"."Auct_WaitingList__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.Auct_WaitingList__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."Auct_WaitingList__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_WaitingList__dbt_tmp_temp_view"
    end



06:49:01.057044 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
06:49:01.057180 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
06:49:01.174089 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
06:49:01.264903 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.10 seconds
06:49:01.280229 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorsurCharge".
06:49:01.280553 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_VendorsurCharge: rename object "dbo"."Auct_VendorsurCharge" to Auct_VendorsurCharge__dbt_backup
06:49:01.309461 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:49:01.324423 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorsurCharge".
06:49:01.324724 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_VendorsurCharge: rename object "dbo"."Auct_VendorsurCharge__dbt_tmp" to Auct_VendorsurCharge
06:49:01.365683 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
06:49:01.367465 [debug] [Thread-3  ]: On model.Shawn.Auct_VendorsurCharge: COMMIT
06:49:01.371383 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_VendorsurCharge".
06:49:01.371577 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_VendorsurCharge: 
    
  if object_id ('"dbo"."Auct_VendorsurCharge__dbt_backup"','U') is not null
    begin
    drop table "dbo"."Auct_VendorsurCharge__dbt_backup"
    end

06:49:01.574168 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.96 seconds
06:49:01.588941 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Venue".
06:49:01.589152 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
06:49:01.589371 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Venue: rename object "dbo"."Auct_Venue" to Auct_Venue__dbt_backup
06:49:01.599278 [debug] [Thread-3  ]: finished collecting timing info
06:49:01.599791 [debug] [Thread-3  ]: On model.Shawn.Auct_VendorsurCharge: Close
06:49:01.600425 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8211e7d1-e715-45ef-98de-e4fa4f0e542c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27656031c0>]}
06:49:01.600833 [info ] [Thread-3  ]: 404 of 411 OK created table model dbo.Auct_VendorsurCharge...................... [[32mOK[0m in 2.47s]
06:49:01.601217 [debug] [Thread-3  ]: Finished running node model.Shawn.Auct_VendorsurCharge
06:49:01.601385 [debug] [Thread-3  ]: Began running node model.Shawn.Auct_WebEvents
06:49:01.601695 [info ] [Thread-3  ]: 407 of 411 START table model dbo.Auct_WebEvents................................. [RUN]
06:49:01.602061 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.Auct_WebEvents"
06:49:01.602256 [debug] [Thread-3  ]: Began compiling node model.Shawn.Auct_WebEvents
06:49:01.602389 [debug] [Thread-3  ]: Compiling model.Shawn.Auct_WebEvents
06:49:01.605025 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.Auct_WebEvents"
06:49:01.605416 [debug] [Thread-3  ]: finished collecting timing info
06:49:01.605559 [debug] [Thread-3  ]: Began executing node model.Shawn.Auct_WebEvents
06:49:01.638801 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
06:49:01.648829 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.Auct_WebEvents"
06:49:01.649438 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_WebEvents".
06:49:01.649618 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_WebEvents: 
  
  if object_id ('"dbo"."Auct_WebEvents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_WebEvents__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."Auct_WebEvents__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."Auct_WebEvents__dbt_tmp"
    end


   EXEC('create view dbo.Auct_WebEvents__dbt_tmp_temp_view as
    
Select
	cast([Latitude] as numeric(18,10)) [Latitude],
	cast([Longitude] as numeric(18,10)) [Longitude],
	cast([EventID] as nvarchar(4000)) [EventID],
	cast([Address] as nvarchar(4000)) [Address],
	cast([City] as nvarchar(4000)) [City],
	cast([State] as nvarchar(4000)) [State],
	cast([PostalCode] as nvarchar(4000)) [PostalCode],
	cast([SiteMapImageURL] as nvarchar(4000)) [SiteMapImageUrl],
	cast([SiteMapPdfURL] as nvarchar(4000)) [SiteMapPdfUrl],
	cast([GooglEMapdirectionURL] as nvarchar(4000)) [GoogleMapDirectionUrl],
	cast([WeatherLocationID] as int) [WeatherLocationID],
	cast([VenueName] as nvarchar(4000)) [VenueName],
	cast([VenueStartDate] as datetime) [VenueStartDate],
	cast([VenueEndDate] as datetime) [VenueEndDate],
	cast([VenueImage] as nvarchar(4000)) [VenueImage],
	cast([VendorSiteMapPdfURL] as nvarchar(4000)) [VendorSiteMapPdfUrl],
	cast([TicketPackageURL] as nvarchar(4000)) [TicketPackageURL],
	cast([EventStatusBit] as int) [EventStatusBit],
	cast([EventName] as nvarchar(4000)) [EventName],
	cast([EventURLName] as nvarchar(4000)) [EventUrlName],
	cast([HotelsForHopeID] as nvarchar(4000)) [HotelsForHopeID],
	cast([VipPackagePageName] as nvarchar(4000)) [VIPPackagePageName],
	cast([AuctionProject] as nvarchar(4000)) [AuctionProject],
	cast([AcceptingApplicationsBit] as int) [AcceptingApplicationsBit],
	cast([BlockLiveStreamID] as nvarchar(4000)) [BlockLiveStreamID],
	cast([LivesTageStreamID] as nvarchar(4000)) [LIveStageStreamID],
	cast([BlockLiveStreamlsembedID] as nvarchar(4000)) [BlockLiveStreamLSEmbedID],
	cast([LivesTageStreamlsembedID] as nvarchar(4000)) [LiveStageStreamLSEmbedID],
	cast([AcceptingConsignmentsMessage] as nvarchar(4000)) [AcceptingConsignmentsMessage],
	cast([CDNBaseURL] as nvarchar(4000)) [CDNBaseURL],
	cast([LivesTagePageURL] as nvarchar(4000)) [LiveStagePageURL],
	cast([ModifiedByUserName] as nvarchar(4000)) [ModifiedByUserName],
	cast([ModifiedDateTime] as datetime) [ModifiedDateTime],
	cast([License] as nvarchar(4000)) [License],
	cast([EventTypeID] as int) [EventTypeID],
	cast([MapdirectionImageURL] as nvarchar(4000)) [MapDirectionImageUrl] 
From stg.[Auct_WebEvents_FinalView]
    ');

  CREATE TABLE "dbo"."Auct_WebEvents__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.Auct_WebEvents__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."Auct_WebEvents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_WebEvents__dbt_tmp_temp_view"
    end



06:49:01.649747 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
06:49:01.649883 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
06:49:01.655106 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Venue".
06:49:01.655325 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Venue: rename object "dbo"."Auct_Venue__dbt_tmp" to Auct_Venue
06:49:01.685653 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:49:01.687211 [debug] [Thread-1  ]: On model.Shawn.Auct_Venue: COMMIT
06:49:01.691361 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Venue".
06:49:01.691560 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Venue: 
    
  if object_id ('"dbo"."Auct_Venue__dbt_backup"','U') is not null
    begin
    drop table "dbo"."Auct_Venue__dbt_backup"
    end

06:49:01.743934 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
06:49:01.913001 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
06:49:01.925793 [debug] [Thread-1  ]: finished collecting timing info
06:49:01.926167 [debug] [Thread-1  ]: On model.Shawn.Auct_Venue: Close
06:49:01.926871 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8211e7d1-e715-45ef-98de-e4fa4f0e542c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27671bf040>]}
06:49:01.927317 [info ] [Thread-1  ]: 405 of 411 OK created table model dbo.Auct_Venue................................ [[32mOK[0m in 2.35s]
06:49:01.927677 [debug] [Thread-1  ]: Finished running node model.Shawn.Auct_Venue
06:49:01.927848 [debug] [Thread-1  ]: Began running node model.Shawn.Auct_WebEventsArchive
06:49:01.928154 [info ] [Thread-1  ]: 408 of 411 START table model dbo.Auct_WebEventsArchive.......................... [RUN]
06:49:01.928527 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.Auct_WebEventsArchive"
06:49:01.928667 [debug] [Thread-1  ]: Began compiling node model.Shawn.Auct_WebEventsArchive
06:49:01.928793 [debug] [Thread-1  ]: Compiling model.Shawn.Auct_WebEventsArchive
06:49:01.931358 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.Auct_WebEventsArchive"
06:49:01.931778 [debug] [Thread-1  ]: finished collecting timing info
06:49:01.931989 [debug] [Thread-1  ]: Began executing node model.Shawn.Auct_WebEventsArchive
06:49:01.965796 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.Auct_WebEventsArchive"
06:49:01.966444 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_WebEventsArchive".
06:49:01.966662 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_WebEventsArchive: 
  
  if object_id ('"dbo"."Auct_WebEventsArchive__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_WebEventsArchive__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."Auct_WebEventsArchive__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."Auct_WebEventsArchive__dbt_tmp"
    end


   EXEC('create view dbo.Auct_WebEventsArchive__dbt_tmp_temp_view as
    
Select
	cast([EventArchiveID] as nvarchar(4000)) [EventArchiveID],
	cast([EventID] as nvarchar(4000)) [EventID],
	cast([Address] as nvarchar(4000)) [Address],
	cast([City] as nvarchar(4000)) [City],
	cast([State] as nvarchar(4000)) [State],
	cast([PostalCode] as nvarchar(4000)) [PostalCode],
	cast([SiteMapImageURL] as nvarchar(4000)) [SiteMapImageUrl],
	cast([VendorSiteMapPdfURL] as nvarchar(4000)) [VendorSiteMapPdfUrl],
	cast([SiteMapPdfURL] as nvarchar(4000)) [SiteMapPdfUrl],
	cast([GooglEMapdirectionURL] as nvarchar(4000)) [GoogleMapDirectionUrl],
	cast([WeatherLocationID] as int) [WeatherLocationID],
	cast([VenueName] as nvarchar(4000)) [VenueName],
	cast([VenueStartDate] as datetime) [VenueStartDate],
	cast([VenueEndDate] as datetime) [VenueEndDate],
	cast([VenueImage] as nvarchar(4000)) [VenueImage],
	cast([TicketPackageURL] as nvarchar(4000)) [TicketPackageURL],
	cast([EventStatusBit] as int) [EventStatusBit],
	cast([EventName] as nvarchar(4000)) [EventName],
	cast([EventURLName] as nvarchar(4000)) [EventUrlName],
	cast([HotelsForHopeID] as nvarchar(4000)) [HotelsForHopeID],
	cast([VipPackagePageName] as nvarchar(4000)) [VIPPackagePageName],
	cast([LivesTagePageURL] as nvarchar(4000)) [LiveStagePageURL],
	cast([AuctionProject] as nvarchar(4000)) [AuctionProject],
	cast([AcceptingApplicationsBit] as int) [AcceptingApplicationsBit],
	cast([BlockLiveStreamID] as nvarchar(4000)) [BlockLiveStreamID],
	cast([LivesTageStreamID] as nvarchar(4000)) [LIveStageStreamID],
	cast([BlockLiveStreamlsembedID] as nvarchar(4000)) [BlockLiveStreamLSEmbedID],
	cast([LivesTageStreamlsembedID] as nvarchar(4000)) [LiveStageStreamLSEmbedID],
	cast([AcceptingConsignmentsMessage] as nvarchar(4000)) [AcceptingConsignmentsMessage],
	cast([CDNBaseURL] as nvarchar(4000)) [CDNBaseURL],
	cast([ModifiedByUserName] as nvarchar(4000)) [ModifiedByUserName],
	cast([ModifiedDateTime] as datetime) [ModifiedDateTime],
	cast([License] as nvarchar(4000)) [License],
	cast([MapdirectionImageURL] as nvarchar(4000)) [MapDirectionImageUrl],
	cast([Latitude] as numeric(18,2)) [Latitude],
	cast([Longitude] as numeric(18,2)) [Longitude] 
From stg.[Auct_WebEventsArchive_FinalView]
    ');

  CREATE TABLE "dbo"."Auct_WebEventsArchive__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.Auct_WebEventsArchive__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."Auct_WebEventsArchive__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_WebEventsArchive__dbt_tmp_temp_view"
    end



06:49:01.966795 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
06:49:01.966940 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
06:49:02.064235 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
06:49:03.157255 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.10 seconds
06:49:03.171991 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_WaitingList".
06:49:03.172342 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_WaitingList: rename object "dbo"."Auct_WaitingList" to Auct_WaitingList__dbt_backup
06:49:03.205437 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:49:03.218776 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_WaitingList".
06:49:03.219105 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_WaitingList: rename object "dbo"."Auct_WaitingList__dbt_tmp" to Auct_WaitingList
06:49:03.249314 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:49:03.251152 [debug] [Thread-4  ]: On model.Shawn.Auct_WaitingList: COMMIT
06:49:03.255147 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_WaitingList".
06:49:03.255360 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_WaitingList: 
    
  if object_id ('"dbo"."Auct_WaitingList__dbt_backup"','U') is not null
    begin
    drop table "dbo"."Auct_WaitingList__dbt_backup"
    end

06:49:03.440344 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
06:49:03.453229 [debug] [Thread-4  ]: finished collecting timing info
06:49:03.453602 [debug] [Thread-4  ]: On model.Shawn.Auct_WaitingList: Close
06:49:03.454299 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8211e7d1-e715-45ef-98de-e4fa4f0e542c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2765603460>]}
06:49:03.454779 [info ] [Thread-4  ]: 406 of 411 OK created table model dbo.Auct_WaitingList.......................... [[32mOK[0m in 2.44s]
06:49:03.455158 [debug] [Thread-4  ]: Finished running node model.Shawn.Auct_WaitingList
06:49:03.455327 [debug] [Thread-4  ]: Began running node model.Shawn.Auct_WorldRecords
06:49:03.455640 [info ] [Thread-4  ]: 409 of 411 START table model dbo.Auct_WorldRecords.............................. [RUN]
06:49:03.456020 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.Auct_WorldRecords"
06:49:03.456160 [debug] [Thread-4  ]: Began compiling node model.Shawn.Auct_WorldRecords
06:49:03.456287 [debug] [Thread-4  ]: Compiling model.Shawn.Auct_WorldRecords
06:49:03.458673 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.Auct_WorldRecords"
06:49:03.459085 [debug] [Thread-4  ]: finished collecting timing info
06:49:03.459293 [debug] [Thread-4  ]: Began executing node model.Shawn.Auct_WorldRecords
06:49:03.493792 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.Auct_WorldRecords"
06:49:03.494823 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_WorldRecords".
06:49:03.495028 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_WorldRecords: 
  
  if object_id ('"dbo"."Auct_WorldRecords__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_WorldRecords__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."Auct_WorldRecords__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."Auct_WorldRecords__dbt_tmp"
    end


   EXEC('create view dbo.Auct_WorldRecords__dbt_tmp_temp_view as
    
Select
	cast([Wrsp] as numeric(18,2)) [WRSP],
	cast([LotNumber] as numeric(18,2)) [LOTNUMBER],
	cast([Wrsh] as numeric(18,2)) [WRSH],
	cast([Wrsscm] as numeric(18,2)) [WRSSCM],
	cast([AuctionID] as int) [AUCTIONID],
	cast([Comments] as nvarchar(4000)) [COMMENTS],
	cast([Created] as datetime) [CREATED] 
From stg.[Auct_WorldRecords_FinalView]
    ');

  CREATE TABLE "dbo"."Auct_WorldRecords__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.Auct_WorldRecords__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."Auct_WorldRecords__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_WorldRecords__dbt_tmp_temp_view"
    end



06:49:03.495145 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
06:49:03.495282 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
06:49:03.610148 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
06:49:03.736662 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.09 seconds
06:49:03.751224 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_WebEvents".
06:49:03.751553 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_WebEvents: rename object "dbo"."Auct_WebEvents" to Auct_WebEvents__dbt_backup
06:49:03.791372 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
06:49:03.805726 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_WebEvents".
06:49:03.806056 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_WebEvents: rename object "dbo"."Auct_WebEvents__dbt_tmp" to Auct_WebEvents
06:49:03.834071 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:49:03.835924 [debug] [Thread-3  ]: On model.Shawn.Auct_WebEvents: COMMIT
06:49:03.840429 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_WebEvents".
06:49:03.840703 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_WebEvents: 
    
  if object_id ('"dbo"."Auct_WebEvents__dbt_backup"','U') is not null
    begin
    drop table "dbo"."Auct_WebEvents__dbt_backup"
    end

06:49:04.052619 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
06:49:04.163576 [debug] [Thread-3  ]: finished collecting timing info
06:49:04.164009 [debug] [Thread-3  ]: On model.Shawn.Auct_WebEvents: Close
06:49:04.164734 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8211e7d1-e715-45ef-98de-e4fa4f0e542c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2765661b80>]}
06:49:04.165204 [info ] [Thread-3  ]: 407 of 411 OK created table model dbo.Auct_WebEvents............................ [[32mOK[0m in 2.56s]
06:49:04.165569 [debug] [Thread-3  ]: Finished running node model.Shawn.Auct_WebEvents
06:49:04.165740 [debug] [Thread-3  ]: Began running node model.Shawn.Auct_WorldRecords2
06:49:04.166050 [info ] [Thread-3  ]: 410 of 411 START table model dbo.Auct_WorldRecords2............................. [RUN]
06:49:04.166432 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.Auct_WorldRecords2"
06:49:04.166607 [debug] [Thread-3  ]: Began compiling node model.Shawn.Auct_WorldRecords2
06:49:04.166752 [debug] [Thread-3  ]: Compiling model.Shawn.Auct_WorldRecords2
06:49:04.169250 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.Auct_WorldRecords2"
06:49:04.169658 [debug] [Thread-3  ]: finished collecting timing info
06:49:04.169868 [debug] [Thread-3  ]: Began executing node model.Shawn.Auct_WorldRecords2
06:49:04.204082 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.Auct_WorldRecords2"
06:49:04.204686 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_WorldRecords2".
06:49:04.204864 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_WorldRecords2: 
  
  if object_id ('"dbo"."Auct_WorldRecords2__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_WorldRecords2__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."Auct_WorldRecords2__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."Auct_WorldRecords2__dbt_tmp"
    end


   EXEC('create view dbo.Auct_WorldRecords2__dbt_tmp_temp_view as
    
Select
	cast([AuctionID] as numeric(18,0)) [AuctionID],
	cast([WorldRecordSales$Hagerty] as numeric(19,4)) [WorldRecordSales$Hagerty],
	cast([WorldRecordSales$sPortsCarmarket] as numeric(19,4)) [WorldRecordSales$SportsCarMarket],
	cast([WorldRecordSalesPrice] as numeric(19,4)) [WorldRecordSalesPrice],
	cast([Lot#] as real) [Lot#],
	cast([Comments] as nvarchar(4000)) [Comments],
	cast([WorldRecordID] as int) [WorldRecordID] 
From stg.[Auct_WorldRecords2_FinalView]
    ');

  CREATE TABLE "dbo"."Auct_WorldRecords2__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.Auct_WorldRecords2__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."Auct_WorldRecords2__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_WorldRecords2__dbt_tmp_temp_view"
    end



06:49:04.204981 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
06:49:04.205116 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
06:49:04.218490 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.25 seconds
06:49:04.236150 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_WebEventsArchive".
06:49:04.236489 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_WebEventsArchive: rename object "dbo"."Auct_WebEventsArchive" to Auct_WebEventsArchive__dbt_backup
06:49:04.285158 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
06:49:04.298947 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_WebEventsArchive".
06:49:04.299302 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_WebEventsArchive: rename object "dbo"."Auct_WebEventsArchive__dbt_tmp" to Auct_WebEventsArchive
06:49:04.306088 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
06:49:04.327031 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:49:04.328684 [debug] [Thread-1  ]: On model.Shawn.Auct_WebEventsArchive: COMMIT
06:49:04.332811 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_WebEventsArchive".
06:49:04.333017 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_WebEventsArchive: 
    
  if object_id ('"dbo"."Auct_WebEventsArchive__dbt_backup"','U') is not null
    begin
    drop table "dbo"."Auct_WebEventsArchive__dbt_backup"
    end

06:49:04.519808 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
06:49:04.532409 [debug] [Thread-1  ]: finished collecting timing info
06:49:04.532776 [debug] [Thread-1  ]: On model.Shawn.Auct_WebEventsArchive: Close
06:49:04.533457 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8211e7d1-e715-45ef-98de-e4fa4f0e542c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2765603700>]}
06:49:04.533915 [info ] [Thread-1  ]: 408 of 411 OK created table model dbo.Auct_WebEventsArchive..................... [[32mOK[0m in 2.60s]
06:49:04.534269 [debug] [Thread-1  ]: Finished running node model.Shawn.Auct_WebEventsArchive
06:49:04.534443 [debug] [Thread-1  ]: Began running node model.Shawn.Auct_Year
06:49:04.534788 [info ] [Thread-1  ]: 411 of 411 START table model dbo.Auct_Year...................................... [RUN]
06:49:04.535171 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.Auct_Year"
06:49:04.535310 [debug] [Thread-1  ]: Began compiling node model.Shawn.Auct_Year
06:49:04.535437 [debug] [Thread-1  ]: Compiling model.Shawn.Auct_Year
06:49:04.537762 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.Auct_Year"
06:49:04.538164 [debug] [Thread-1  ]: finished collecting timing info
06:49:04.538310 [debug] [Thread-1  ]: Began executing node model.Shawn.Auct_Year
06:49:04.571458 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.Auct_Year"
06:49:04.572055 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Year".
06:49:04.572234 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Year: 
  
  if object_id ('"dbo"."Auct_Year__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_Year__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."Auct_Year__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."Auct_Year__dbt_tmp"
    end


   EXEC('create view dbo.Auct_Year__dbt_tmp_temp_view as
    
Select
	cast([YearID] as int) [YEARID],
	cast([DropDownText] as nvarchar(4000)) [DROPDOWNTEXT],
	cast([DisplayText] as nvarchar(4000)) [DISPLAYTEXT] 
From stg.[Auct_Year_FinalView]
    ');

  CREATE TABLE "dbo"."Auct_Year__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.Auct_Year__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."Auct_Year__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_Year__dbt_tmp_temp_view"
    end



06:49:04.572352 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
06:49:04.572489 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
06:49:04.672382 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
06:49:05.611726 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.12 seconds
06:49:05.626792 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_WorldRecords".
06:49:05.627136 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_WorldRecords: rename object "dbo"."Auct_WorldRecords" to Auct_WorldRecords__dbt_backup
06:49:05.656582 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:49:05.671214 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_WorldRecords".
06:49:05.671594 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_WorldRecords: rename object "dbo"."Auct_WorldRecords__dbt_tmp" to Auct_WorldRecords
06:49:05.699629 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:49:05.701437 [debug] [Thread-4  ]: On model.Shawn.Auct_WorldRecords: COMMIT
06:49:05.705873 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_WorldRecords".
06:49:05.706127 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.Auct_WorldRecords: 
    
  if object_id ('"dbo"."Auct_WorldRecords__dbt_backup"','U') is not null
    begin
    drop table "dbo"."Auct_WorldRecords__dbt_backup"
    end

06:49:05.928766 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
06:49:05.941260 [debug] [Thread-4  ]: finished collecting timing info
06:49:05.941618 [debug] [Thread-4  ]: On model.Shawn.Auct_WorldRecords: Close
06:49:05.942307 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8211e7d1-e715-45ef-98de-e4fa4f0e542c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2765603850>]}
06:49:05.942765 [info ] [Thread-4  ]: 409 of 411 OK created table model dbo.Auct_WorldRecords......................... [[32mOK[0m in 2.49s]
06:49:05.943129 [debug] [Thread-4  ]: Finished running node model.Shawn.Auct_WorldRecords
06:49:06.412858 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.21 seconds
06:49:06.427725 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_WorldRecords2".
06:49:06.428044 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_WorldRecords2: rename object "dbo"."Auct_WorldRecords2" to Auct_WorldRecords2__dbt_backup
06:49:06.458884 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:49:06.472024 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_WorldRecords2".
06:49:06.472332 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_WorldRecords2: rename object "dbo"."Auct_WorldRecords2__dbt_tmp" to Auct_WorldRecords2
06:49:06.500467 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:49:06.502233 [debug] [Thread-3  ]: On model.Shawn.Auct_WorldRecords2: COMMIT
06:49:06.506278 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_WorldRecords2".
06:49:06.506483 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_WorldRecords2: 
    
  if object_id ('"dbo"."Auct_WorldRecords2__dbt_backup"','U') is not null
    begin
    drop table "dbo"."Auct_WorldRecords2__dbt_backup"
    end

06:49:06.689241 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
06:49:06.702703 [debug] [Thread-3  ]: finished collecting timing info
06:49:06.703098 [debug] [Thread-3  ]: On model.Shawn.Auct_WorldRecords2: Close
06:49:06.703804 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8211e7d1-e715-45ef-98de-e4fa4f0e542c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27640dae20>]}
06:49:06.704256 [info ] [Thread-3  ]: 410 of 411 OK created table model dbo.Auct_WorldRecords2........................ [[32mOK[0m in 2.54s]
06:49:06.704608 [debug] [Thread-3  ]: Finished running node model.Shawn.Auct_WorldRecords2
06:49:07.291161 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.72 seconds
06:49:07.305582 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Year".
06:49:07.305914 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Year: rename object "dbo"."Auct_Year" to Auct_Year__dbt_backup
06:49:07.339256 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:49:07.352277 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Year".
06:49:07.352590 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Year: rename object "dbo"."Auct_Year__dbt_tmp" to Auct_Year
06:49:07.380549 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
06:49:07.382341 [debug] [Thread-1  ]: On model.Shawn.Auct_Year: COMMIT
06:49:07.386664 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Year".
06:49:07.386881 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Year: 
    
  if object_id ('"dbo"."Auct_Year__dbt_backup"','U') is not null
    begin
    drop table "dbo"."Auct_Year__dbt_backup"
    end

06:49:07.558653 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
06:49:07.571743 [debug] [Thread-1  ]: finished collecting timing info
06:49:07.572157 [debug] [Thread-1  ]: On model.Shawn.Auct_Year: Close
06:49:07.572898 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8211e7d1-e715-45ef-98de-e4fa4f0e542c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27671fc4c0>]}
06:49:07.573368 [info ] [Thread-1  ]: 411 of 411 OK created table model dbo.Auct_Year................................. [[32mOK[0m in 3.04s]
06:49:07.573733 [debug] [Thread-1  ]: Finished running node model.Shawn.Auct_Year
07:06:20.450030 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1080.80 seconds
07:06:20.465536 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Tmp_WebSiteEmailList".
07:06:20.465924 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.Auct_Tmp_WebSiteEmailList: rename object "dbo"."Auct_Tmp_WebSiteEmailList" to Auct_Tmp_WebSiteEmailList__dbt_backup
07:06:20.959702 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.49 seconds
07:06:20.974680 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Tmp_WebSiteEmailList".
07:06:20.975051 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.Auct_Tmp_WebSiteEmailList: rename object "dbo"."Auct_Tmp_WebSiteEmailList__dbt_tmp" to Auct_Tmp_WebSiteEmailList
07:06:21.006492 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
07:06:21.008350 [debug] [Thread-2  ]: On model.Shawn.Auct_Tmp_WebSiteEmailList: COMMIT
07:06:21.012583 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Tmp_WebSiteEmailList".
07:06:21.012827 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.Auct_Tmp_WebSiteEmailList: 
    
  if object_id ('"dbo"."Auct_Tmp_WebSiteEmailList__dbt_backup"','U') is not null
    begin
    drop table "dbo"."Auct_Tmp_WebSiteEmailList__dbt_backup"
    end

07:06:21.717119 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.70 seconds
07:06:21.730109 [debug] [Thread-2  ]: finished collecting timing info
07:06:21.730527 [debug] [Thread-2  ]: On model.Shawn.Auct_Tmp_WebSiteEmailList: Close
07:06:21.731310 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8211e7d1-e715-45ef-98de-e4fa4f0e542c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f276404eac0>]}
07:06:21.731763 [info ] [Thread-2  ]: 382 of 411 OK created table model dbo.Auct_Tmp_WebSiteEmailList................. [[32mOK[0m in 1082.13s]
07:06:21.732139 [debug] [Thread-2  ]: Finished running node model.Shawn.Auct_Tmp_WebSiteEmailList
07:06:21.734810 [debug] [MainThread]: Acquiring new synapse connection "master"
07:06:21.735254 [debug] [MainThread]: On master: COMMIT
07:06:21.736822 [info ] [MainThread]: 
07:06:21.737294 [info ] [MainThread]: Finished running 411 table models in 1685.83s.
07:06:21.737508 [debug] [MainThread]: Connection 'master' was properly closed.
07:06:21.737620 [debug] [MainThread]: Connection 'model.Shawn.Auct_Year' was properly closed.
07:06:21.737715 [debug] [MainThread]: Connection 'model.Shawn.Auct_Tmp_WebSiteEmailList' was properly closed.
07:06:21.737805 [debug] [MainThread]: Connection 'model.Shawn.Auct_WorldRecords' was properly closed.
07:06:21.737893 [debug] [MainThread]: Connection 'model.Shawn.Auct_WorldRecords2' was properly closed.
07:06:22.006144 [info ] [MainThread]: 
07:06:22.006612 [info ] [MainThread]: [32mCompleted successfully[0m
07:06:22.007454 [info ] [MainThread]: 
07:06:22.007652 [info ] [MainThread]: Done. PASS=411 WARN=0 ERROR=0 SKIP=0 TOTAL=411
07:06:22.007986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f276410f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2764043f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2767bb1af0>]}


============================== 2022-09-21 07:06:24.420458 | e40ed7ec-0812-4b2c-9140-71a149aaa420 ==============================
07:06:24.420458 [info ] [MainThread]: Running with dbt=1.0.0
07:06:24.426931 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/Auctioneer', record_timing_info=None, rpc_method='run', select=['step5_0'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
07:06:24.427261 [debug] [MainThread]: Tracking: tracking
07:06:24.427644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748af0cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748af0ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748af0cf70>]}
07:06:24.921085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:06:24.921695 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:06:25.005336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e40ed7ec-0812-4b2c-9140-71a149aaa420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748adf2c70>]}
07:06:25.274879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e40ed7ec-0812-4b2c-9140-71a149aaa420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748a19f2e0>]}
07:06:25.275450 [info ] [MainThread]: Found 1345 models, 0 tests, 354 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:06:25.306909 [info ] [MainThread]: 
07:06:25.307790 [debug] [MainThread]: Acquiring new synapse connection "master"
07:06:25.309693 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
07:06:25.319994 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
07:06:25.320362 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
07:06:25.320508 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:06:25.320669 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:06:25.648087 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:06:25.684152 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.36 seconds
07:06:25.686134 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
07:06:25.762629 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
07:06:25.769541 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
07:06:25.770213 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
07:06:25.772099 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
07:06:25.772302 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
07:06:25.772445 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:06:25.772586 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:06:25.770433 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
07:06:25.774149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:06:25.774323 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:06:25.905531 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:06:25.906052 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:06:25.979203 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.20 seconds
07:06:26.013210 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.24 seconds
07:06:26.176248 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
07:06:26.176720 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
07:06:26.188969 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
07:06:26.189378 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
07:06:48.395359 [debug] [MainThread]: On master: COMMIT
07:06:48.396062 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
07:06:48.396406 [info ] [MainThread]: 
07:06:48.399513 [debug] [Thread-1  ]: Began running node model.Shawn.Auct_Address_Merge_Step1
07:06:48.399883 [info ] [Thread-1  ]: 1 of 1 START table model stg.Auct_Address_Merge_Step1........................... [RUN]
07:06:48.400340 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.Auct_Address_Merge_Step1"
07:06:48.400500 [debug] [Thread-1  ]: Began compiling node model.Shawn.Auct_Address_Merge_Step1
07:06:48.400656 [debug] [Thread-1  ]: Compiling model.Shawn.Auct_Address_Merge_Step1
07:06:48.403437 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.Auct_Address_Merge_Step1"
07:06:48.403932 [debug] [Thread-1  ]: finished collecting timing info
07:06:48.404106 [debug] [Thread-1  ]: Began executing node model.Shawn.Auct_Address_Merge_Step1
07:06:48.496576 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.Auct_Address_Merge_Step1"
07:06:48.497347 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step1".
07:06:48.497570 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step1: 
  
  if object_id ('"stg"."Auct_Address_Merge_Step1__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Address_Merge_Step1__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."Auct_Address_Merge_Step1__dbt_tmp"','U') is not null
    begin
    drop table "stg"."Auct_Address_Merge_Step1__dbt_tmp"
    end


   EXEC('create view stg.Auct_Address_Merge_Step1__dbt_tmp_temp_view as
    

select  
    Created,AddressID 
from stg.[Auct_Address_FinalView] where Created is not NULL
    ');

  CREATE TABLE "stg"."Auct_Address_Merge_Step1__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.Auct_Address_Merge_Step1__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."Auct_Address_Merge_Step1__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Address_Merge_Step1__dbt_tmp_temp_view"
    end



07:06:48.497709 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:06:48.497936 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:06:48.629014 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:06:51.964973 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.47 seconds
07:06:51.984655 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step1".
07:06:51.985049 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step1: rename object "stg"."Auct_Address_Merge_Step1" to Auct_Address_Merge_Step1__dbt_backup
07:06:52.059090 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
07:06:52.074062 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step1".
07:06:52.074459 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step1: rename object "stg"."Auct_Address_Merge_Step1__dbt_tmp" to Auct_Address_Merge_Step1
07:06:52.106211 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
07:06:52.118449 [debug] [Thread-1  ]: On model.Shawn.Auct_Address_Merge_Step1: COMMIT
07:06:52.125704 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step1".
07:06:52.126096 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step1: 
    
  if object_id ('"stg"."Auct_Address_Merge_Step1__dbt_backup"','U') is not null
    begin
    drop table "stg"."Auct_Address_Merge_Step1__dbt_backup"
    end

07:06:52.803342 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.68 seconds
07:06:52.816454 [debug] [Thread-1  ]: finished collecting timing info
07:06:52.816892 [debug] [Thread-1  ]: On model.Shawn.Auct_Address_Merge_Step1: Close
07:06:52.817682 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e40ed7ec-0812-4b2c-9140-71a149aaa420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748860c190>]}
07:06:52.818312 [info ] [Thread-1  ]: 1 of 1 OK created table model stg.Auct_Address_Merge_Step1...................... [[32mOK[0m in 4.42s]
07:06:52.818742 [debug] [Thread-1  ]: Finished running node model.Shawn.Auct_Address_Merge_Step1
07:06:52.820005 [debug] [MainThread]: Acquiring new synapse connection "master"
07:06:52.820504 [debug] [MainThread]: On master: COMMIT
07:06:52.820857 [info ] [MainThread]: 
07:06:52.821111 [info ] [MainThread]: Finished running 1 table model in 27.51s.
07:06:52.821310 [debug] [MainThread]: Connection 'master' was properly closed.
07:06:52.821415 [debug] [MainThread]: Connection 'model.Shawn.Auct_Address_Merge_Step1' was properly closed.
07:06:52.821510 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
07:06:53.015248 [info ] [MainThread]: 
07:06:53.015637 [info ] [MainThread]: [32mCompleted successfully[0m
07:06:53.015927 [info ] [MainThread]: 
07:06:53.016107 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
07:06:53.016426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748a3a6c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748a5d7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748868f580>]}


============================== 2022-09-21 07:06:55.349033 | fa7c7039-6a46-46ff-826c-5a5f4fe051ef ==============================
07:06:55.349033 [info ] [MainThread]: Running with dbt=1.0.0
07:06:55.354926 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/Auctioneer', record_timing_info=None, rpc_method='run', select=['step5_1'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
07:06:55.355258 [debug] [MainThread]: Tracking: tracking
07:06:55.355628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5db2a21e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5db2a21eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5db2a21f10>]}
07:06:55.852188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:06:55.852752 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:06:55.934967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa7c7039-6a46-46ff-826c-5a5f4fe051ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5db2905be0>]}
07:06:56.196642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa7c7039-6a46-46ff-826c-5a5f4fe051ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5db1cf2250>]}
07:06:56.197243 [info ] [MainThread]: Found 1345 models, 0 tests, 354 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:06:56.227359 [info ] [MainThread]: 
07:06:56.228161 [debug] [MainThread]: Acquiring new synapse connection "master"
07:06:56.229835 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
07:06:56.239119 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
07:06:56.239439 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
07:06:56.239577 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:06:56.239729 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:06:56.544413 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:06:56.578808 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.34 seconds
07:06:56.580817 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
07:06:56.656670 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
07:06:56.663573 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
07:06:56.664027 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
07:06:56.665953 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
07:06:56.666173 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
07:06:56.666297 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:06:56.666427 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:06:56.664355 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
07:06:56.668030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:06:56.668240 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:06:56.775401 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:06:56.776645 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:06:56.845242 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
07:06:56.848068 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
07:06:57.023723 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
07:06:57.024190 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
07:06:57.062368 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
07:06:57.071700 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
07:07:19.348087 [debug] [MainThread]: On master: COMMIT
07:07:19.348791 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
07:07:19.349122 [info ] [MainThread]: 
07:07:19.352192 [debug] [Thread-1  ]: Began running node model.Shawn.Auct_Address_Merge_Step2
07:07:19.352582 [info ] [Thread-1  ]: 1 of 1 START table model stg.Auct_Address_Merge_Step2........................... [RUN]
07:07:19.353089 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.Auct_Address_Merge_Step2"
07:07:19.353253 [debug] [Thread-1  ]: Began compiling node model.Shawn.Auct_Address_Merge_Step2
07:07:19.353406 [debug] [Thread-1  ]: Compiling model.Shawn.Auct_Address_Merge_Step2
07:07:19.356361 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.Auct_Address_Merge_Step2"
07:07:19.356916 [debug] [Thread-1  ]: finished collecting timing info
07:07:19.357094 [debug] [Thread-1  ]: Began executing node model.Shawn.Auct_Address_Merge_Step2
07:07:19.450755 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.Auct_Address_Merge_Step2"
07:07:19.451519 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step2".
07:07:19.451727 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step2: 
  
  if object_id ('"stg"."Auct_Address_Merge_Step2__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Address_Merge_Step2__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."Auct_Address_Merge_Step2__dbt_tmp"','U') is not null
    begin
    drop table "stg"."Auct_Address_Merge_Step2__dbt_tmp"
    end


   EXEC('create view stg.Auct_Address_Merge_Step2__dbt_tmp_temp_view as
    
With idList as (
    select * from stg.Auct_Address_Merge_Step1
),
nullList as (
    select AddressID from stg.[Auct_Address_FinalView]  where Created is NULL
)

select  nullList.AddressID, (select top 1 idList.Created from idList where AddressID<nullList.[AddressID] order by AddressID desc) as Created
from nullList
    ');

  CREATE TABLE "stg"."Auct_Address_Merge_Step2__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.Auct_Address_Merge_Step2__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."Auct_Address_Merge_Step2__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Address_Merge_Step2__dbt_tmp_temp_view"
    end



07:07:19.451848 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:07:19.452003 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:07:19.639333 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:08:02.105499 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 42.65 seconds
07:08:02.125559 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step2".
07:08:02.125939 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step2: rename object "stg"."Auct_Address_Merge_Step2" to Auct_Address_Merge_Step2__dbt_backup
07:08:02.397063 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
07:08:02.411587 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step2".
07:08:02.411975 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step2: rename object "stg"."Auct_Address_Merge_Step2__dbt_tmp" to Auct_Address_Merge_Step2
07:08:02.442681 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
07:08:02.454685 [debug] [Thread-1  ]: On model.Shawn.Auct_Address_Merge_Step2: COMMIT
07:08:02.461829 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step2".
07:08:02.462202 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step2: 
    
  if object_id ('"stg"."Auct_Address_Merge_Step2__dbt_backup"','U') is not null
    begin
    drop table "stg"."Auct_Address_Merge_Step2__dbt_backup"
    end

07:08:03.698904 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.24 seconds
07:08:03.711958 [debug] [Thread-1  ]: finished collecting timing info
07:08:03.712352 [debug] [Thread-1  ]: On model.Shawn.Auct_Address_Merge_Step2: Close
07:08:03.713156 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa7c7039-6a46-46ff-826c-5a5f4fe051ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5db01ec430>]}
07:08:03.713677 [info ] [Thread-1  ]: 1 of 1 OK created table model stg.Auct_Address_Merge_Step2...................... [[32mOK[0m in 44.36s]
07:08:03.714073 [debug] [Thread-1  ]: Finished running node model.Shawn.Auct_Address_Merge_Step2
07:08:03.715403 [debug] [MainThread]: Acquiring new synapse connection "master"
07:08:03.715892 [debug] [MainThread]: On master: COMMIT
07:08:03.716258 [info ] [MainThread]: 
07:08:03.716517 [info ] [MainThread]: Finished running 1 table model in 67.49s.
07:08:03.716714 [debug] [MainThread]: Connection 'master' was properly closed.
07:08:03.716817 [debug] [MainThread]: Connection 'model.Shawn.Auct_Address_Merge_Step2' was properly closed.
07:08:03.716913 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
07:08:03.908736 [info ] [MainThread]: 
07:08:03.909136 [info ] [MainThread]: [32mCompleted successfully[0m
07:08:03.909425 [info ] [MainThread]: 
07:08:03.909608 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
07:08:03.909912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5db212bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5db25b5640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5db01e93d0>]}


============================== 2022-09-21 07:08:06.218645 | 9853100f-52a7-44ea-a0a2-66670aa7f5f1 ==============================
07:08:06.218645 [info ] [MainThread]: Running with dbt=1.0.0
07:08:06.219323 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/Auctioneer', record_timing_info=None, rpc_method='run', select=['step5_2'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
07:08:06.219580 [debug] [MainThread]: Tracking: tracking
07:08:06.219921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91f678ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91f678f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91f678fa0>]}
07:08:06.699114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:08:06.699627 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:08:06.781032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9853100f-52a7-44ea-a0a2-66670aa7f5f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91f55cc70>]}
07:08:07.035018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9853100f-52a7-44ea-a0a2-66670aa7f5f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91e90a2e0>]}
07:08:07.035573 [info ] [MainThread]: Found 1345 models, 0 tests, 354 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:08:07.064469 [info ] [MainThread]: 
07:08:07.065286 [debug] [MainThread]: Acquiring new synapse connection "master"
07:08:07.066918 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
07:08:07.076143 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
07:08:07.076569 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
07:08:07.076729 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:08:07.076879 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:08:07.387811 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:08:07.422211 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.35 seconds
07:08:07.424253 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
07:08:07.500532 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
07:08:07.506505 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
07:08:07.506957 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
07:08:07.508730 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
07:08:07.508920 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
07:08:07.509041 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:08:07.509172 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:08:07.507236 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
07:08:07.510750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:08:07.510923 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:08:07.623317 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:08:07.626337 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:08:07.693530 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
07:08:07.694164 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
07:08:07.932762 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
07:08:07.943892 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
07:08:08.005877 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
07:08:08.015693 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
07:08:30.138100 [debug] [MainThread]: On master: COMMIT
07:08:30.138873 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
07:08:30.139237 [info ] [MainThread]: 
07:08:30.142987 [debug] [Thread-1  ]: Began running node model.Shawn.Auct_Address_Merge_Step3
07:08:30.143404 [info ] [Thread-1  ]: 1 of 1 START table model stg.Auct_Address_Merge_Step3........................... [RUN]
07:08:30.143934 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.Auct_Address_Merge_Step3"
07:08:30.144108 [debug] [Thread-1  ]: Began compiling node model.Shawn.Auct_Address_Merge_Step3
07:08:30.144271 [debug] [Thread-1  ]: Compiling model.Shawn.Auct_Address_Merge_Step3
07:08:30.147423 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.Auct_Address_Merge_Step3"
07:08:30.147982 [debug] [Thread-1  ]: finished collecting timing info
07:08:30.148159 [debug] [Thread-1  ]: Began executing node model.Shawn.Auct_Address_Merge_Step3
07:08:30.241308 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.Auct_Address_Merge_Step3"
07:08:30.242129 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step3".
07:08:30.242346 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step3: 
  
  if object_id ('"stg"."Auct_Address_Merge_Step3__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Address_Merge_Step3__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."Auct_Address_Merge_Step3__dbt_tmp"','U') is not null
    begin
    drop table "stg"."Auct_Address_Merge_Step3__dbt_tmp"
    end


   EXEC('create view stg.Auct_Address_Merge_Step3__dbt_tmp_temp_view as
    
    SELECT 
        [AddressID],
        [Created]
    FROM (
        SELECT 
            [AddressID],
            [Created],
            ROW_NUMBER() OVER(
                PARTITION BY [AddressID]
                ORDER BY [Created]
            ) AS [RowNumber]
        FROM (
            SELECT 
                DISTINCT consgt.[AddressID],
                CASE WHEN consgt.[Created] IS NOT NULL 
                    THEN 
                        CASE WHEN consgt.[Created]<=auc.[AuctionBegins] 
                            THEN consgt.[Created]
                        ELSE auc.[AuctionBegins] 
                    END
                ELSE auc.[AuctionBegins] 
                END AS [Created]
            FROM [Auct_Consignment_FinalView] consgt -- (Update) might need replace [Auct_Consignment_Ex]
            LEFT JOIN [Auct_Auction_FinalView] auc -- (Update) might need replace [Auct_Auction_Ex]
                ON consgt.[AuctionID]=auc.[AuctionID]
            WHERE consgt.[AddressID] IS NOT NULL AND (CASE WHEN consgt.[Created] IS NOT NULL THEN CASE WHEN consgt.[Created]<=auc.[AuctionBegins] THEN consgt.[Created] ELSE auc.[AuctionBegins] END ELSE auc.[AuctionBegins] END) IS NOT NULL
            UNION 
            SELECT 
                aucbid.[AddressID],
                CASE WHEN aucbid.[Created] IS NOT NULL 
                    THEN 
                        CASE WHEN aucbid.[Created]<=auc.[AuctionBegins] 
                            THEN aucbid.[Created]
                        ELSE auc.[AuctionBegins] 
                    END
                ELSE auc.[AuctionBegins] 
                END AS [Created]
            FROM [Auct_AuctionBidder_FinalView] aucbid -- (Update) might need replace [Auct_AuctionBidder_Ex]
            LEFT JOIN [Auct_Auction_FinalView] auc -- (Update) might need replace [Auct_Auction_Ex]
                ON aucbid.[AuctionID]=auc.[AuctionID]
            WHERE aucbid.[AddressID] IS NOT NULL AND (CASE WHEN aucbid.[Created] IS NOT NULL THEN CASE WHEN aucbid.[Created]<=auc.[AuctionBegins] THEN aucbid.[Created] ELSE auc.[AuctionBegins] END ELSE auc.[AuctionBegins] END) IS NOT NULL
            UNION 
            SELECT 
                [AddressID],
                [RegistrationDate]
            FROM [Auct_AuctionBidder_FinalView] -- (Update) might need replace [Auct_AuctionBidder_Ex]
            WHERE [AddressID] IS NOT NULL AND [RegistrationDate] IS NOT NULL
            UNION 
            SELECT 
                [AddressID],
                [Created]
            FROM [Auct_Bidder_FinalView] -- (Update) might need replace [Auct_Bidder_Ex]
            WHERE [AddressID] IS NOT NULL AND [Created] IS NOT NULL
            ) AS temp1
        ) AS temp2
    WHERE [RowNumber]=1
    ');

  CREATE TABLE "stg"."Auct_Address_Merge_Step3__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.Auct_Address_Merge_Step3__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."Auct_Address_Merge_Step3__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Address_Merge_Step3__dbt_tmp_temp_view"
    end



07:08:30.242482 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:08:30.242685 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:08:30.398049 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:08:36.496440 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.25 seconds
07:08:36.515055 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step3".
07:08:36.515414 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step3: rename object "stg"."Auct_Address_Merge_Step3" to Auct_Address_Merge_Step3__dbt_backup
07:08:36.589620 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
07:08:36.603241 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step3".
07:08:36.603566 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step3: rename object "stg"."Auct_Address_Merge_Step3__dbt_tmp" to Auct_Address_Merge_Step3
07:08:36.634276 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
07:08:36.645827 [debug] [Thread-1  ]: On model.Shawn.Auct_Address_Merge_Step3: COMMIT
07:08:36.652462 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step3".
07:08:36.652718 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step3: 
    
  if object_id ('"stg"."Auct_Address_Merge_Step3__dbt_backup"','U') is not null
    begin
    drop table "stg"."Auct_Address_Merge_Step3__dbt_backup"
    end

07:08:38.149826 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.50 seconds
07:08:38.162771 [debug] [Thread-1  ]: finished collecting timing info
07:08:38.163201 [debug] [Thread-1  ]: On model.Shawn.Auct_Address_Merge_Step3: Close
07:08:38.163985 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9853100f-52a7-44ea-a0a2-66670aa7f5f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91c5f2fa0>]}
07:08:38.164478 [info ] [Thread-1  ]: 1 of 1 OK created table model stg.Auct_Address_Merge_Step3...................... [[32mOK[0m in 8.02s]
07:08:38.164854 [debug] [Thread-1  ]: Finished running node model.Shawn.Auct_Address_Merge_Step3
07:08:38.166119 [debug] [MainThread]: Acquiring new synapse connection "master"
07:08:38.166625 [debug] [MainThread]: On master: COMMIT
07:08:38.166949 [info ] [MainThread]: 
07:08:38.167196 [info ] [MainThread]: Finished running 1 table model in 31.10s.
07:08:38.167388 [debug] [MainThread]: Connection 'master' was properly closed.
07:08:38.167497 [debug] [MainThread]: Connection 'model.Shawn.Auct_Address_Merge_Step3' was properly closed.
07:08:38.167591 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
07:08:38.353597 [info ] [MainThread]: 
07:08:38.354005 [info ] [MainThread]: [32mCompleted successfully[0m
07:08:38.354301 [info ] [MainThread]: 
07:08:38.354484 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
07:08:38.354859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91eb10c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91ed415e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91ed41be0>]}


============================== 2022-09-21 07:08:40.615015 | 1e96bafb-d1d8-4225-9c64-349f43cc9a2d ==============================
07:08:40.615015 [info ] [MainThread]: Running with dbt=1.0.0
07:08:40.615659 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/Auctioneer', record_timing_info=None, rpc_method='run', select=['step5_3'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
07:08:40.615895 [debug] [MainThread]: Tracking: tracking
07:08:40.616226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff63138ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff63138ef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6313ad040>]}
07:08:41.088832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:08:41.089311 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:08:41.171132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e96bafb-d1d8-4225-9c64-349f43cc9a2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff631270cd0>]}
07:08:41.424613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e96bafb-d1d8-4225-9c64-349f43cc9a2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff63071e340>]}
07:08:41.425174 [info ] [MainThread]: Found 1345 models, 0 tests, 354 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:08:41.453937 [info ] [MainThread]: 
07:08:41.454769 [debug] [MainThread]: Acquiring new synapse connection "master"
07:08:41.456405 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
07:08:41.465921 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
07:08:41.466219 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
07:08:41.466362 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:08:41.466512 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:08:41.759657 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:08:41.794460 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.33 seconds
07:08:41.796481 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
07:08:41.873649 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
07:08:41.879762 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
07:08:41.880158 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
07:08:41.881908 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
07:08:41.882097 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
07:08:41.882220 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:08:41.882352 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:08:41.880446 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
07:08:41.883910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:08:41.884081 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:08:42.006341 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:08:42.007351 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:08:42.075402 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
07:08:42.077416 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.20 seconds
07:08:42.209594 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
07:08:42.219706 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
07:08:42.282761 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
07:08:42.291837 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
07:09:04.671308 [debug] [MainThread]: On master: COMMIT
07:09:04.672024 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
07:09:04.672370 [info ] [MainThread]: 
07:09:04.676136 [debug] [Thread-1  ]: Began running node model.Shawn.Auct_Address_Merge_Step4
07:09:04.676561 [info ] [Thread-1  ]: 1 of 1 START table model stg.Auct_Address_Merge_Step4........................... [RUN]
07:09:04.677103 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.Auct_Address_Merge_Step4"
07:09:04.677274 [debug] [Thread-1  ]: Began compiling node model.Shawn.Auct_Address_Merge_Step4
07:09:04.677433 [debug] [Thread-1  ]: Compiling model.Shawn.Auct_Address_Merge_Step4
07:09:04.680513 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.Auct_Address_Merge_Step4"
07:09:04.681065 [debug] [Thread-1  ]: finished collecting timing info
07:09:04.681241 [debug] [Thread-1  ]: Began executing node model.Shawn.Auct_Address_Merge_Step4
07:09:04.776268 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.Auct_Address_Merge_Step4"
07:09:04.777060 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step4".
07:09:04.777269 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step4: 
  
  if object_id ('"stg"."Auct_Address_Merge_Step4__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Address_Merge_Step4__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."Auct_Address_Merge_Step4__dbt_tmp"','U') is not null
    begin
    drop table "stg"."Auct_Address_Merge_Step4__dbt_tmp"
    end


   EXEC('create view stg.Auct_Address_Merge_Step4__dbt_tmp_temp_view as
    
  SELECT 
        [ShippingAddressID],
        [Created],
        [RowNumber]
    FROM (
        SELECT 
            [ShippingAddressID],
            [Created],
            ROW_NUMBER() OVER(
                PARTITION BY [ShippingAddressID]
                ORDER BY [Created]
            ) AS [RowNumber]
        FROM (
            SELECT 
                aucbid.[ShippingAddressID],
                CASE WHEN aucbid.[Created] IS NOT NULL 
                    THEN 
                        CASE WHEN aucbid.[Created]<=auc.[AuctionBegins] 
                            THEN aucbid.[Created]
                        ELSE auc.[AuctionBegins] 
                    END
                ELSE auc.[AuctionBegins] 
                END AS [Created]
            FROM [Auct_AuctionBidder_FinalView] aucbid -- (Update) might need replace [Auct_AuctionBidder_Ex]
            LEFT JOIN [Auct_Auction_FinalView] auc -- (Update) might need replace [Auct_Auction_Ex]
                ON aucbid.[AuctionID]=auc.[AuctionID]
            WHERE aucbid.[ShippingAddressID] IS NOT NULL AND (CASE WHEN aucbid.[Created] IS NOT NULL THEN CASE WHEN aucbid.[Created]<=auc.[AuctionBegins] THEN aucbid.[Created] ELSE auc.[AuctionBegins] END ELSE auc.[AuctionBegins] END) IS NOT NULL
            UNION 
            SELECT 
                [ShippingAddressID],
                [RegistrationDate]
            FROM [Auct_AuctionBidder_FinalView] -- (Update) might need replace [Auct_AuctionBidder_Ex]
            WHERE [ShippingAddressID] IS NOT NULL AND [RegistrationDate] IS NOT NULL
            UNION 
            SELECT 
                [ShippingAddressID],
                [Created]
            FROM [Auct_Bidder_FinalView] -- (Update) might need replace [Auct_Bidder_Ex]
            WHERE [ShippingAddressID] IS NOT NULL AND [Created] IS NOT NULL
            ) AS temp1
        ) AS temp2
    WHERE [RowNumber]=1
    ');

  CREATE TABLE "stg"."Auct_Address_Merge_Step4__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.Auct_Address_Merge_Step4__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."Auct_Address_Merge_Step4__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Address_Merge_Step4__dbt_tmp_temp_view"
    end



07:09:04.777390 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:09:04.777533 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:09:04.887815 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:09:09.290067 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 4.51 seconds
07:09:09.399795 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step4".
07:09:09.400132 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step4: rename object "stg"."Auct_Address_Merge_Step4" to Auct_Address_Merge_Step4__dbt_backup
07:09:09.668282 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
07:09:09.682406 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step4".
07:09:09.682791 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step4: rename object "stg"."Auct_Address_Merge_Step4__dbt_tmp" to Auct_Address_Merge_Step4
07:09:09.714884 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
07:09:09.726115 [debug] [Thread-1  ]: On model.Shawn.Auct_Address_Merge_Step4: COMMIT
07:09:09.733339 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step4".
07:09:09.733652 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step4: 
    
  if object_id ('"stg"."Auct_Address_Merge_Step4__dbt_backup"','U') is not null
    begin
    drop table "stg"."Auct_Address_Merge_Step4__dbt_backup"
    end

07:09:10.792280 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
07:09:10.805087 [debug] [Thread-1  ]: finished collecting timing info
07:09:10.805482 [debug] [Thread-1  ]: On model.Shawn.Auct_Address_Merge_Step4: Close
07:09:10.806255 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e96bafb-d1d8-4225-9c64-349f43cc9a2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62e31c7f0>]}
07:09:10.806784 [info ] [Thread-1  ]: 1 of 1 OK created table model stg.Auct_Address_Merge_Step4...................... [[32mOK[0m in 6.13s]
07:09:10.807174 [debug] [Thread-1  ]: Finished running node model.Shawn.Auct_Address_Merge_Step4
07:09:10.808452 [debug] [MainThread]: Acquiring new synapse connection "master"
07:09:10.808915 [debug] [MainThread]: On master: COMMIT
07:09:10.809245 [info ] [MainThread]: 
07:09:10.809492 [info ] [MainThread]: Finished running 1 table model in 29.35s.
07:09:10.809686 [debug] [MainThread]: Connection 'master' was properly closed.
07:09:10.809791 [debug] [MainThread]: Connection 'model.Shawn.Auct_Address_Merge_Step4' was properly closed.
07:09:10.809884 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
07:09:10.899114 [info ] [MainThread]: 
07:09:10.899491 [info ] [MainThread]: [32mCompleted successfully[0m
07:09:10.899778 [info ] [MainThread]: 
07:09:10.899960 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
07:09:10.900266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff630ea5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff630f4ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62e31cdf0>]}


============================== 2022-09-21 07:09:13.268113 | e910b9c2-8331-4beb-a345-6c11177f6894 ==============================
07:09:13.268113 [info ] [MainThread]: Running with dbt=1.0.0
07:09:13.274204 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/Auctioneer', record_timing_info=None, rpc_method='run', select=['step5_4'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
07:09:13.274506 [debug] [MainThread]: Tracking: tracking
07:09:13.274910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3ea7af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3ea7afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3ea99040>]}
07:09:13.749025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:09:13.749529 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:09:13.831320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e910b9c2-8331-4beb-a345-6c11177f6894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3e95ed00>]}
07:09:14.086126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e910b9c2-8331-4beb-a345-6c11177f6894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3de0c310>]}
07:09:14.086702 [info ] [MainThread]: Found 1345 models, 0 tests, 354 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:09:14.116138 [info ] [MainThread]: 
07:09:14.116938 [debug] [MainThread]: Acquiring new synapse connection "master"
07:09:14.118821 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
07:09:14.128064 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
07:09:14.128291 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
07:09:14.128420 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:09:14.128565 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:09:14.410957 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:09:14.444789 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.32 seconds
07:09:14.446793 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
07:09:14.523637 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
07:09:14.530201 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
07:09:14.530766 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
07:09:14.532417 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
07:09:14.532594 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
07:09:14.532715 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:09:14.532847 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:09:14.530954 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
07:09:14.534337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:09:14.534504 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:09:14.655949 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:09:14.656660 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:09:14.723413 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
07:09:14.726362 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
07:09:14.862907 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
07:09:14.875890 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
07:09:14.939880 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
07:09:14.951856 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
07:09:37.028524 [debug] [MainThread]: On master: COMMIT
07:09:37.029206 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
07:09:37.029530 [info ] [MainThread]: 
07:09:37.032718 [debug] [Thread-1  ]: Began running node model.Shawn.Auct_Address_Merge_Step5
07:09:37.033091 [info ] [Thread-1  ]: 1 of 1 START table model stg.Auct_Address_Merge_Step5........................... [RUN]
07:09:37.033571 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.Auct_Address_Merge_Step5"
07:09:37.033737 [debug] [Thread-1  ]: Began compiling node model.Shawn.Auct_Address_Merge_Step5
07:09:37.033893 [debug] [Thread-1  ]: Compiling model.Shawn.Auct_Address_Merge_Step5
07:09:37.036748 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.Auct_Address_Merge_Step5"
07:09:37.037279 [debug] [Thread-1  ]: finished collecting timing info
07:09:37.037453 [debug] [Thread-1  ]: Began executing node model.Shawn.Auct_Address_Merge_Step5
07:09:37.129310 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.Auct_Address_Merge_Step5"
07:09:37.130050 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step5".
07:09:37.130260 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step5: 
  
  if object_id ('"stg"."Auct_Address_Merge_Step5__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Address_Merge_Step5__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."Auct_Address_Merge_Step5__dbt_tmp"','U') is not null
    begin
    drop table "stg"."Auct_Address_Merge_Step5__dbt_tmp"
    end


   EXEC('create view stg.Auct_Address_Merge_Step5__dbt_tmp_temp_view as
    

  SELECT 
        [AddressID],
        [Created],
        [RowNumber]
    FROM (
        SELECT 
            [AddressID],
            [Created],
            ROW_NUMBER() OVER(
                PARTITION BY [AddressID]
                ORDER BY [Created]
            ) AS [RowNumber]
        FROM (
            SELECT 
                [AddressID],
                [Created]
            FROM Auct_Address_Merge_Step3
            UNION
            SELECT 
                [ShippingAddressID],
                [Created]
            FROM Auct_Address_Merge_Step4
            ) AS temp1
        ) AS temp2
    WHERE [RowNumber]=1
    ');

  CREATE TABLE "stg"."Auct_Address_Merge_Step5__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.Auct_Address_Merge_Step5__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."Auct_Address_Merge_Step5__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Address_Merge_Step5__dbt_tmp_temp_view"
    end



07:09:37.130385 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:09:37.130522 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:09:37.251187 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:09:49.619341 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 12.49 seconds
07:09:49.638457 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step5".
07:09:49.638839 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step5: rename object "stg"."Auct_Address_Merge_Step5" to Auct_Address_Merge_Step5__dbt_backup
07:09:49.708065 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
07:09:49.721688 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step5".
07:09:49.722032 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step5: rename object "stg"."Auct_Address_Merge_Step5__dbt_tmp" to Auct_Address_Merge_Step5
07:09:49.752219 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
07:09:49.764623 [debug] [Thread-1  ]: On model.Shawn.Auct_Address_Merge_Step5: COMMIT
07:09:49.771370 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step5".
07:09:49.771626 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step5: 
    
  if object_id ('"stg"."Auct_Address_Merge_Step5__dbt_backup"','U') is not null
    begin
    drop table "stg"."Auct_Address_Merge_Step5__dbt_backup"
    end

07:09:51.296895 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.53 seconds
07:09:51.310210 [debug] [Thread-1  ]: finished collecting timing info
07:09:51.311358 [debug] [Thread-1  ]: On model.Shawn.Auct_Address_Merge_Step5: Close
07:09:51.312440 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e910b9c2-8331-4beb-a345-6c11177f6894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3c1fb820>]}
07:09:51.312961 [info ] [Thread-1  ]: 1 of 1 OK created table model stg.Auct_Address_Merge_Step5...................... [[32mOK[0m in 14.28s]
07:09:51.313367 [debug] [Thread-1  ]: Finished running node model.Shawn.Auct_Address_Merge_Step5
07:09:51.316323 [debug] [MainThread]: Acquiring new synapse connection "master"
07:09:51.316882 [debug] [MainThread]: On master: COMMIT
07:09:51.317365 [info ] [MainThread]: 
07:09:51.317648 [info ] [MainThread]: Finished running 1 table model in 37.20s.
07:09:51.317849 [debug] [MainThread]: Connection 'master' was properly closed.
07:09:51.317959 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
07:09:51.318057 [debug] [MainThread]: Connection 'model.Shawn.Auct_Address_Merge_Step5' was properly closed.
07:09:51.521309 [info ] [MainThread]: 
07:09:51.521707 [info ] [MainThread]: [32mCompleted successfully[0m
07:09:51.522007 [info ] [MainThread]: 
07:09:51.522192 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
07:09:51.522503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3e130a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3e530e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e409ce6a0>]}


============================== 2022-09-21 07:09:53.967604 | a97ffd81-3ab2-4cda-aafd-7c852e480c95 ==============================
07:09:53.967604 [info ] [MainThread]: Running with dbt=1.0.0
07:09:53.970875 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/Auctioneer', record_timing_info=None, rpc_method='run', select=['step5_5'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
07:09:53.974641 [debug] [MainThread]: Tracking: tracking
07:09:53.975136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748535feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748535ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748535ff70>]}
07:09:54.470720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:09:54.471257 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:09:54.553343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a97ffd81-3ab2-4cda-aafd-7c852e480c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748523fc40>]}
07:09:54.820039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a97ffd81-3ab2-4cda-aafd-7c852e480c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74845ed2b0>]}
07:09:54.820588 [info ] [MainThread]: Found 1345 models, 0 tests, 354 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:09:54.850434 [info ] [MainThread]: 
07:09:54.851281 [debug] [MainThread]: Acquiring new synapse connection "master"
07:09:54.852919 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
07:09:54.862277 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
07:09:54.862623 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
07:09:54.862778 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:09:54.862932 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:09:55.171180 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:09:55.208360 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.35 seconds
07:09:55.210240 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
07:09:55.285211 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
07:09:55.291366 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
07:09:55.291791 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
07:09:55.293645 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
07:09:55.293854 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
07:09:55.293979 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:09:55.294118 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:09:55.292100 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
07:09:55.295705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:09:55.295877 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:09:55.411225 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:09:55.411910 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:09:55.479490 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
07:09:55.480594 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
07:09:55.622795 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
07:09:55.631894 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
07:09:55.709664 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
07:09:55.710142 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
07:10:17.973446 [debug] [MainThread]: On master: COMMIT
07:10:17.974114 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
07:10:17.974425 [info ] [MainThread]: 
07:10:17.978022 [debug] [Thread-1  ]: Began running node model.Shawn.Auct_Address_Merge_Step6
07:10:17.978390 [info ] [Thread-1  ]: 1 of 1 START table model stg.Auct_Address_Merge_Step6........................... [RUN]
07:10:17.978899 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.Auct_Address_Merge_Step6"
07:10:17.979064 [debug] [Thread-1  ]: Began compiling node model.Shawn.Auct_Address_Merge_Step6
07:10:17.979217 [debug] [Thread-1  ]: Compiling model.Shawn.Auct_Address_Merge_Step6
07:10:17.982428 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.Auct_Address_Merge_Step6"
07:10:17.982985 [debug] [Thread-1  ]: finished collecting timing info
07:10:17.983155 [debug] [Thread-1  ]: Began executing node model.Shawn.Auct_Address_Merge_Step6
07:10:18.075224 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.Auct_Address_Merge_Step6"
07:10:18.075976 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step6".
07:10:18.076176 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step6: 
  
  if object_id ('"stg"."Auct_Address_Merge_Step6__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Address_Merge_Step6__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."Auct_Address_Merge_Step6__dbt_tmp"','U') is not null
    begin
    drop table "stg"."Auct_Address_Merge_Step6__dbt_tmp"
    end


   EXEC('create view stg.Auct_Address_Merge_Step6__dbt_tmp_temp_view as
    

With idList as (
    select * from stg.Auct_Address_Merge_Step2
),temp1 as (
                SELECT 
                    firstspotted.[RowNumber],
                    addrasgmt.[CustomerAccountID],
                    addrasgmt.[CompanyID] AS [CurrentCompanyID],
                    ISNULL(addr.[AddressID], addrasgmt.[AddressID]) AS [AddressID],
                    NULLIF(CONCAT(addr.[Address1], '' '', addr.[Address2]), '''') AS [Address],
                    addr.[City],
                    addr.[StateProvince], -- (Update) addr.[StateProvince], OR  addr.[StateProvince] AS [StateProvince],
                    addr.[PostalCode],
                    country.[Name] AS [Country], -- (Update) country.[Country],
                    addrty.[Name] AS [AddressType], -- (Update) addrty.[AddressType],
                    CASE WHEN addrasgmt.[AddDescr] IN (''BAD ADDRESS'') AND addrsts.[Name] IN (''VERIFIED'') -- (Update) CASE WHEN addrasgmt.[AddDescription] IN (''BAD ADDRESS'') AND addrsts.[AddressStatus] IN (''VERIFIED'')
                        THEN ''BAD''
                    ELSE addrsts.[Name] -- (Update) ELSE addrsts.[AddressStatus]
                    END AS [AddressStatus],
                    addrasgmt.[IsDefault] AS [IsDefaultAddress],
                    addr.[Active] AS [IsActiveAddress], -- (Update) addr.[Active] AS [IsActiveAddress], OR addr.[IsActive] AS [IsActiveAddress], 
                    -- ISNULL(addr.[Created], (SELECT TOP 1 addr2.[Created] FROM [Auct_Address_FinalView] addr2 WHERE addr2.[AddressID]<addr.[AddressID] AND addr2.[Created] IS NOT NULL ORDER BY addr2.[AddressID] DESC)) AS [CreatedAddress1],
                    ISNULL(addr.[Created], (select idList.Created from idList where AddressID=addr.[AddressID])) AS [CreatedAddress1],
                    
                    firstspotted.[Created] AS [CreatedAddress2],
                    -- (Comment) SELECT [AddressID], COUNT(*) FROM Address_merged GROUP BY [AddressID] ORDER BY COUNT(*) DESC; seems like all record for [AddressID] only happen once
                    CASE 
                        WHEN firstspotted.[Created] IS NOT NULL
                            THEN CASE 
                                WHEN ISNULL(addr.[Created], (select idList.Created from idList where AddressID=addr.[AddressID]))<=firstspotted.[Created]
                                    THEN ISNULL(addr.[Created], (select idList.Created from idList where AddressID=addr.[AddressID]))
                                ELSE firstspotted.[Created]
                                END
                        ELSE ISNULL(addr.[Created], (select idList.Created from idList where AddressID=addr.[AddressID]))
                    END AS [CreatedAddress]
                FROM stg.[Auct_Address_FinalView] addr -- need replace [Auct_Address_FinalView] with [Auct_Address_Cleaning_stg]
                FULL OUTER JOIN stg.[Auct_AddressAssignments_FinalView] addrasgmt -- need replace [Auct_AddressAssignments_Ex] with [Auct_AddressAssignments]
                    ON addr.[AddressID]=addrasgmt.[AddressID]
                LEFT JOIN stg.[Auct_Country_FinalView] country -- need replace [Auct_Country_Ex] with [Auct_Country]
                    ON addr.[Country]=country.[CountryID] -- (Update) ON addr.[CountryID]=country.[CountryID]
                LEFT JOIN stg.[Auct_AddressTypes_FinalView] addrty -- need replace [Auct_AddressTypes_Ex] with [Auct_AddressTypes]
                    ON addrasgmt.[AddressTypeID]=addrty.[AddressTypeID]
                LEFT JOIN stg.[Auct_AddressStatus_FinalView] addrsts -- need replace [Auct_AddressStatus_Ex] with [Auct_AddressStatus] 
                    ON addrasgmt.[AddressStatusID]=addrsts.[AddressStatusID]
                LEFT JOIN stg.[Auct_Address_Merge_Step5] firstspotted 
                    ON addr.[AddressID]=firstspotted.[AddressID]
                WHERE COALESCE(NULLIF(CONCAT(addr.[Address1], '' '', addr.[Address2]), ''''), addr.[City], addr.[StateProvince], addr.[PostalCode], country.[Name]) IS NOT NULL -- (Update) WHERE COALESCE(NULLIF(CONCAT(addr.[Address1], '' '', addr.[Address2]), ''''), addr.[City], addr.[StateProvince], addr.[PostalCode], country.[Name]) IS NOT NULL
                -- (Comment) SELECT COUNT(DISTINCT [AddressID]) FROM Address_merged; -- 243041
)     

 SELECT
                [CustomerAccountID],
                [CurrentCompanyID],
                [AddressID],
                [Address],
                [City],
                [StateProvince],
                [PostalCode],
                [Country],
                [AddressType],
                [AddressStatus],
                [IsDefaultAddress],
                [IsActiveAddress],
                [CreatedAddress],
                ROW_NUMBER() OVER(
                    PARTITION BY [CustomerAccountID], [CurrentCompanyID], [AddressID], [Address], [City], [StateProvince], [PostalCode], [Country], [AddressType], [AddressStatus], [IsDefaultAddress], [IsActiveAddress], [CreatedAddress]
                    ORDER BY [CustomerAccountID], [CurrentCompanyID], [AddressID], [Address], [City], [StateProvince], [PostalCode], [Country], [AddressType], [AddressStatus], [IsDefaultAddress], [IsActiveAddress], [CreatedAddress]
                ) AS [RowNumber]
            FROM temp1
    ');

  CREATE TABLE "stg"."Auct_Address_Merge_Step6__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.Auct_Address_Merge_Step6__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."Auct_Address_Merge_Step6__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Address_Merge_Step6__dbt_tmp_temp_view"
    end



07:10:18.076310 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:10:18.076453 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:10:18.210025 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:10:33.240640 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 15.16 seconds
07:10:33.357812 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step6".
07:10:33.358191 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step6: rename object "stg"."Auct_Address_Merge_Step6" to Auct_Address_Merge_Step6__dbt_backup
07:10:33.431195 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
07:10:33.444659 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step6".
07:10:33.445024 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step6: rename object "stg"."Auct_Address_Merge_Step6__dbt_tmp" to Auct_Address_Merge_Step6
07:10:33.481265 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
07:10:33.492124 [debug] [Thread-1  ]: On model.Shawn.Auct_Address_Merge_Step6: COMMIT
07:10:33.498917 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step6".
07:10:33.499266 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step6: 
    
  if object_id ('"stg"."Auct_Address_Merge_Step6__dbt_backup"','U') is not null
    begin
    drop table "stg"."Auct_Address_Merge_Step6__dbt_backup"
    end

07:10:34.783315 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.28 seconds
07:10:34.795599 [debug] [Thread-1  ]: finished collecting timing info
07:10:34.795966 [debug] [Thread-1  ]: On model.Shawn.Auct_Address_Merge_Step6: Close
07:10:34.796698 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a97ffd81-3ab2-4cda-aafd-7c852e480c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74822c4040>]}
07:10:34.797158 [info ] [Thread-1  ]: 1 of 1 OK created table model stg.Auct_Address_Merge_Step6...................... [[32mOK[0m in 16.82s]
07:10:34.797529 [debug] [Thread-1  ]: Finished running node model.Shawn.Auct_Address_Merge_Step6
07:10:34.798801 [debug] [MainThread]: Acquiring new synapse connection "master"
07:10:34.799286 [debug] [MainThread]: On master: COMMIT
07:10:34.799620 [info ] [MainThread]: 
07:10:34.799870 [info ] [MainThread]: Finished running 1 table model in 39.95s.
07:10:34.800067 [debug] [MainThread]: Connection 'master' was properly closed.
07:10:34.800171 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
07:10:34.800265 [debug] [MainThread]: Connection 'model.Shawn.Auct_Address_Merge_Step6' was properly closed.
07:10:34.888937 [info ] [MainThread]: 
07:10:34.889334 [info ] [MainThread]: [32mCompleted successfully[0m
07:10:34.889630 [info ] [MainThread]: 
07:10:34.889813 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
07:10:34.890112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74847f5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7484e5dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74822a1a60>]}


============================== 2022-09-21 07:10:37.200372 | 0e082c44-f6b9-4f9f-880f-43c7f3d7bd13 ==============================
07:10:37.200372 [info ] [MainThread]: Running with dbt=1.0.0
07:10:37.206845 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/Auctioneer', record_timing_info=None, rpc_method='run', select=['step5_6'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
07:10:37.207157 [debug] [MainThread]: Tracking: tracking
07:10:37.207518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6554d2de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6554d2dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6554d2df40>]}
07:10:37.673379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:10:37.673919 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:10:37.756885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e082c44-f6b9-4f9f-880f-43c7f3d7bd13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6554c11c10>]}
07:10:38.014762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e082c44-f6b9-4f9f-880f-43c7f3d7bd13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6553fbf280>]}
07:10:38.015338 [info ] [MainThread]: Found 1345 models, 0 tests, 354 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:10:38.044232 [info ] [MainThread]: 
07:10:38.045035 [debug] [MainThread]: Acquiring new synapse connection "master"
07:10:38.046667 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
07:10:38.055838 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
07:10:38.056110 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
07:10:38.056244 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:10:38.056394 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:10:38.364427 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:10:38.399832 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.34 seconds
07:10:38.401934 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
07:10:38.479476 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
07:10:38.486034 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
07:10:38.486510 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
07:10:38.488439 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
07:10:38.489196 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
07:10:38.489322 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:10:38.489460 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:10:38.486855 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
07:10:38.490819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:10:38.490996 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:10:38.598820 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:10:38.599339 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:10:38.668656 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
07:10:38.672849 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
07:10:38.807123 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
07:10:38.815873 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
07:10:38.881040 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
07:10:38.891819 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
07:11:00.922917 [debug] [MainThread]: On master: COMMIT
07:11:00.923615 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
07:11:00.923957 [info ] [MainThread]: 
07:11:00.927618 [debug] [Thread-1  ]: Began running node model.Shawn.Auct_Address_Merge_Step7
07:11:00.928018 [info ] [Thread-1  ]: 1 of 1 START table model stg.Auct_Address_Merge_Step7........................... [RUN]
07:11:00.928529 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.Auct_Address_Merge_Step7"
07:11:00.928695 [debug] [Thread-1  ]: Began compiling node model.Shawn.Auct_Address_Merge_Step7
07:11:00.928845 [debug] [Thread-1  ]: Compiling model.Shawn.Auct_Address_Merge_Step7
07:11:00.932021 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.Auct_Address_Merge_Step7"
07:11:00.932583 [debug] [Thread-1  ]: finished collecting timing info
07:11:00.932762 [debug] [Thread-1  ]: Began executing node model.Shawn.Auct_Address_Merge_Step7
07:11:01.024720 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.Auct_Address_Merge_Step7"
07:11:01.025484 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step7".
07:11:01.025683 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step7: 
  
  if object_id ('"stg"."Auct_Address_Merge_Step7__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Address_Merge_Step7__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."Auct_Address_Merge_Step7__dbt_tmp"','U') is not null
    begin
    drop table "stg"."Auct_Address_Merge_Step7__dbt_tmp"
    end


   EXEC('create view stg.Auct_Address_Merge_Step7__dbt_tmp_temp_view as
    
SELECT 
        [CustomerAccountID],
        [CurrentCompanyID],
        [AddressID],
        [Address],
        [City],
        [StateProvince],
        [PostalCode],
        [Country],
        [AddressType],
        [AddressStatus],
        [IsDefaultAddress],
        [IsActiveAddress],
        [EffectiveStartDate],
        ISNULL([EffectiveEndDate], ''9999-12-31'') AS [EffectiveEndDate]
    FROM (
        SELECT     
            [CustomerAccountID],
            [CurrentCompanyID],
            [AddressID],
            [Address],
            [City],
            [StateProvince],
            [PostalCode],
            [Country],
            [AddressType],
            [AddressStatus],
            [IsDefaultAddress],
            [IsActiveAddress],
            [CreatedAddress] AS [EffectiveStartDate],
            CASE WHEN [CustomerAccountID] IS NOT NULL
                THEN LEAD([CreatedAddress]) OVER(
                        PARTITION BY [CustomerAccountID], [AddressID], [AddressType]
                        ORDER BY [CustomerAccountID], [AddressID], [AddressType], [CreatedAddress]
                    ) 
            ELSE LEAD([CreatedAddress]) OVER(
                        PARTITION BY [AddressID], [AddressType]
                        ORDER BY [AddressID], [AddressType], [CreatedAddress]
                    ) 
            END AS [EffectiveEndDate]
        FROM  
             stg.[Auct_Address_Merge_Step6]
        WHERE [RowNumber]=1
        ) AS temp3
    ');

  CREATE TABLE "stg"."Auct_Address_Merge_Step7__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.Auct_Address_Merge_Step7__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."Auct_Address_Merge_Step7__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Address_Merge_Step7__dbt_tmp_temp_view"
    end



07:11:01.025815 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:11:01.025960 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:11:01.141096 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:11:17.956889 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 16.93 seconds
07:11:18.065045 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step7".
07:11:18.065398 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step7: rename object "stg"."Auct_Address_Merge_Step7" to Auct_Address_Merge_Step7__dbt_backup
07:11:18.321957 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
07:11:18.335093 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step7".
07:11:18.335430 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step7: rename object "stg"."Auct_Address_Merge_Step7__dbt_tmp" to Auct_Address_Merge_Step7
07:11:18.366369 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
07:11:18.377361 [debug] [Thread-1  ]: On model.Shawn.Auct_Address_Merge_Step7: COMMIT
07:11:18.383988 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_Step7".
07:11:18.384318 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_Step7: 
    
  if object_id ('"stg"."Auct_Address_Merge_Step7__dbt_backup"','U') is not null
    begin
    drop table "stg"."Auct_Address_Merge_Step7__dbt_backup"
    end

07:11:19.400076 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.02 seconds
07:11:19.411668 [debug] [Thread-1  ]: finished collecting timing info
07:11:19.412070 [debug] [Thread-1  ]: On model.Shawn.Auct_Address_Merge_Step7: Close
07:11:19.412807 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e082c44-f6b9-4f9f-880f-43c7f3d7bd13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6551c74070>]}
07:11:19.413283 [info ] [Thread-1  ]: 1 of 1 OK created table model stg.Auct_Address_Merge_Step7...................... [[32mOK[0m in 18.48s]
07:11:19.413668 [debug] [Thread-1  ]: Finished running node model.Shawn.Auct_Address_Merge_Step7
07:11:19.414958 [debug] [MainThread]: Acquiring new synapse connection "master"
07:11:19.415402 [debug] [MainThread]: On master: COMMIT
07:11:19.415719 [info ] [MainThread]: 
07:11:19.415960 [info ] [MainThread]: Finished running 1 table model in 41.37s.
07:11:19.416148 [debug] [MainThread]: Connection 'master' was properly closed.
07:11:19.416253 [debug] [MainThread]: Connection 'model.Shawn.Auct_Address_Merge_Step7' was properly closed.
07:11:19.416348 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
07:11:19.507751 [info ] [MainThread]: 
07:11:19.508133 [info ] [MainThread]: [32mCompleted successfully[0m
07:11:19.508411 [info ] [MainThread]: 
07:11:19.508588 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
07:11:19.508881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6554356430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6554895bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6551d00a30>]}


============================== 2022-09-21 07:11:21.926444 | d7ca3430-1d84-4b68-8695-aef04c712f97 ==============================
07:11:21.926444 [info ] [MainThread]: Running with dbt=1.0.0
07:11:21.931309 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/Auctioneer', record_timing_info=None, rpc_method='run', select=['step6_0'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
07:11:21.931591 [debug] [MainThread]: Tracking: tracking
07:11:21.932026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a01013f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a01013fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a01032040>]}
07:11:22.450911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:11:22.451476 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:11:22.539370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7ca3430-1d84-4b68-8695-aef04c712f97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a00ef7cd0>]}
07:11:22.821582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7ca3430-1d84-4b68-8695-aef04c712f97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a003a5340>]}
07:11:22.822162 [info ] [MainThread]: Found 1345 models, 0 tests, 354 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:11:22.852096 [info ] [MainThread]: 
07:11:22.852905 [debug] [MainThread]: Acquiring new synapse connection "master"
07:11:22.854633 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
07:11:22.863907 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
07:11:22.864210 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
07:11:22.864350 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:11:22.864504 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:11:23.184512 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:11:23.218491 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.35 seconds
07:11:23.220414 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
07:11:23.302075 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
07:11:23.308250 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
07:11:23.308700 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
07:11:23.310599 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
07:11:23.310822 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
07:11:23.310961 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:11:23.311102 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:11:23.309001 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
07:11:23.312897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:11:23.313110 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:11:23.432455 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:11:23.433468 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:11:23.499058 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
07:11:23.501613 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
07:11:23.674955 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
07:11:23.683897 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
07:11:23.732598 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
07:11:23.747868 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
07:11:45.958057 [debug] [MainThread]: On master: COMMIT
07:11:45.958829 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
07:11:45.959174 [info ] [MainThread]: 
07:11:45.962930 [debug] [Thread-1  ]: Began running node model.Shawn.Auct_Contact_Merge
07:11:45.963443 [info ] [Thread-1  ]: 1 of 2 START table model stg.Auct_Contact_Merge................................. [RUN]
07:11:45.963963 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.Auct_Contact_Merge"
07:11:45.964144 [debug] [Thread-1  ]: Began compiling node model.Shawn.Auct_Contact_Merge
07:11:45.963179 [debug] [Thread-2  ]: Began running node model.Shawn.Auct_Email_Merge
07:11:45.964561 [info ] [Thread-2  ]: 2 of 2 START table model stg.Auct_Email_Merge................................... [RUN]
07:11:45.964953 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.Auct_Email_Merge"
07:11:45.965095 [debug] [Thread-2  ]: Began compiling node model.Shawn.Auct_Email_Merge
07:11:45.965213 [debug] [Thread-2  ]: Compiling model.Shawn.Auct_Email_Merge
07:11:45.964322 [debug] [Thread-1  ]: Compiling model.Shawn.Auct_Contact_Merge
07:11:45.971449 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.Auct_Contact_Merge"
07:11:45.971959 [debug] [Thread-1  ]: finished collecting timing info
07:11:45.972133 [debug] [Thread-1  ]: Began executing node model.Shawn.Auct_Contact_Merge
07:11:45.968825 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.Auct_Email_Merge"
07:11:45.979964 [debug] [Thread-2  ]: finished collecting timing info
07:11:45.980138 [debug] [Thread-2  ]: Began executing node model.Shawn.Auct_Email_Merge
07:11:46.144461 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.Auct_Contact_Merge"
07:11:46.147232 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.Auct_Email_Merge"
07:11:46.147990 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Email_Merge".
07:11:46.148166 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.Auct_Email_Merge: 
  
  if object_id ('"stg"."Auct_Email_Merge__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Email_Merge__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."Auct_Email_Merge__dbt_tmp"','U') is not null
    begin
    drop table "stg"."Auct_Email_Merge__dbt_tmp"
    end


   EXEC('create view stg.Auct_Email_Merge__dbt_tmp_temp_view as
    


-- DECLARE @MaxValidDate AS DATETIME;
-- SET @MaxValidDate=''9999-12-31'';



With Auct_Contact_Ex AS (
	 select * from stg.[Auct_Contact_FinalView]
),
Auct_CustomerAccount_Ex AS (
	 select * from stg.[Auct_CustomerAccount_FinalView]
),
Auct_Emails_Ex AS (
	 select * from stg.[Auct_Emails_FinalView]
),
Auct_Invoice_Ex AS (
	 select * from stg.[Auct_Invoice_FinalView]
),

Email_merged_CTE AS (
    SELECT 
        [CustomerAccountID],
        [ContactID],
        [Email],
        [Email_Cleaned],
        [IsActiveEmail],
        [EmailBlastOptIn],
        [EffectiveStartDate], 
        [EffectiveEndDate],
        CASE WHEN [NewRowNumber]=''1'' 
            THEN ''1''
        ELSE ''0''
        END AS [IsCurrent]
    FROM (
        SELECT 
            [CustomerAccountID],
            [ContactID],
            [Email],
            [Email_Cleaned],
            [IsActiveEmail],
            [EmailBlastOptIn],
            [EffectiveStartDate],
            ISNULL([EffectiveEndDate], ''9999-12-31'') AS [EffectiveEndDate],
            ROW_NUMBER() OVER(
                PARTITION BY [CustomerAccountID], [ContactID]
                ORDER BY [EffectiveStartDate] DESC, ISNULL([EffectiveEndDate], ''9999-12-31'') DESC
            ) AS [NewRowNumber]
        FROM (
            SELECT 
                [CustomerAccountID],
                [ContactID],
                [Email],
                [Email_Cleaned],
                [IsActiveEmail],
                NULLIF([EmailBlastOptIn], '''') AS [EmailBlastOptIn],
                [Created] AS [EffectiveStartDate],
                LEAD([Created]) OVER(
                    PARTITION BY [CustomerAccountID], [ContactID]
                    ORDER BY [CustomerAccountID], [ContactID], [Created]
                ) AS [EffectiveEndDate],
                ROW_NUMBER() OVER(
                    PARTITION BY [CustomerAccountID], [ContactID], [Email], [IsActiveEmail], NULLIF([EmailBlastOptIn], ''''), [Created]
                    ORDER BY [CustomerAccountID], [ContactID], [Email], [IsActiveEmail], NULLIF([EmailBlastOptIn], ''''), [Created]
                ) AS [RowNumber]
            FROM (
                SELECT 
                    cxacct.[CustomerAccountID], 
                    con.[ContactID],
                    con.[Email], -- (Update) con.[Email], OR con.[Email] AS [Email], 
                    con.[Email_Cleaned],
                    con.[Active] AS [IsActiveEmail], -- (Update) con.[IsActive] AS [IsActiveEmail], OR con.[Active] AS [IsActiveEmail],
                    '''' as [EmailBlastOptIn],
                    con.[Created]
                FROM [Auct_Contact_Ex] con -- FROM .[Auct_Contact_Ex] con -- (Update) need replace .[Auct_Contact_Ex] with .[Auct_Contact_Ex] !!!
                LEFT JOIN [Auct_CustomerAccount_Ex] cxacct -- (Update) need replace .[Auct_CustomerAccount_Ex] with .[Auct_CustomerAccount]
                    ON con.[ContactID]=cxacct.[ContactID]
                LEFT JOIN [Auct_Invoice_Ex] inv -- (Update) need replace .[Auct_Invoice_Ex] with .[Auct_Invoice]
                    ON cxacct.[ContactID]=inv.[ContactID]
                WHERE NULLIF(con.[Email], '''') IS NOT NULL -- (Update) WHERE NULLIF(con.[Email], '''') IS NOT NULL OR NULLIF(con.[Email], '''') IS NOT NULL
                UNION 
                SELECT
                    email.[CustomerAccountID],
                    email.[ContactID],
                    email.[Email], -- (Update) email.[Email], or email.[Email], 
                    email.[Email_Cleaned],
                    email.[Active], -- (Update) email.[IsActive], OR email.[Active],
                    email.[EmailBlastOptIn],
                    email.[Created]
                FROM [Auct_Emails_Ex] email -- need replace .[Auct_Emails_Ex] with .[Auct_Emails_Ex]
                WHERE NULLIF(email.[Email], '''') IS NOT NULL -- (Update) WHERE NULLIF(email.[Email], '''') IS NOT NULL OR WHERE NULLIF(email.[Email], '''') IS NOT NULL
                ) AS temp1
            ) AS temp2
        WHERE [RowNumber]=1
        ) AS temp3
)
SELECT 
    [CustomerAccountID],
    [ContactID],
    -- [Name],
    [Email],
    [Email_Cleaned],
    [IsActiveEmail],
    [EmailBlastOptIn],
    [EffectiveStartDate], 
    [EffectiveEndDate],
    [IsCurrent]
FROM Email_merged_CTE
    ');

  CREATE TABLE "stg"."Auct_Email_Merge__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.Auct_Email_Merge__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."Auct_Email_Merge__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Email_Merge__dbt_tmp_temp_view"
    end



07:11:46.148300 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
07:11:46.148547 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:11:46.148713 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Contact_Merge".
07:11:46.149989 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Contact_Merge: 
  
  if object_id ('"stg"."Auct_Contact_Merge__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Contact_Merge__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."Auct_Contact_Merge__dbt_tmp"','U') is not null
    begin
    drop table "stg"."Auct_Contact_Merge__dbt_tmp"
    end


   EXEC('create view stg.Auct_Contact_Merge__dbt_tmp_temp_view as
    

With Auct_Contact_Ex AS (
	 select * from stg.[Auct_Contact_FinalView]
),
Auct_CustomerAccount_Ex AS (
	 select * from stg.[Auct_CustomerAccount_FinalView]
),
Auct_Invoice_Ex AS (
	 select * from stg.[Auct_Invoice_FinalView]
),
Contact_merged AS (
    SELECT 
        DISTINCT cxacct.[CustomerAccountID], 
        con.[ContactID],
        ISNULL(con.[Name], LEFT(inv.[InvoiceName], PATINDEX(''%[0-9]%'', inv.[InvoiceName])-1)) AS [Name]
    FROM [Auct_Contact_Ex] con -- need replace [Auct_Contact_Ex] with [Auct_Contact_Cleaning_stg]
    LEFT JOIN [Auct_CustomerAccount_Ex] cxacct -- need replace [Auct_CustomerAccount_Ex] with [Auct_CustomerAccount]
        ON con.[ContactID]=cxacct.[ContactID]
    LEFT JOIN [Auct_Invoice_Ex] inv -- need replace [Auct_Invoice_Ex] with [Auct_Invoice]
        ON cxacct.[ContactID]=inv.[ContactID]
    WHERE ISNULL(con.[Name], LEFT(inv.[InvoiceName], PATINDEX(''%[0-9]%'', inv.[InvoiceName])-1)) IS NOT NULL
    UNION
    SELECT 
        DISTINCT cxacct.[CustomerAccountID], 
        cxacct.[ContactID],
        ISNULL(con.[Name], LEFT(inv.[InvoiceName], PATINDEX(''%[0-9]%'', inv.[InvoiceName])-1)) AS [Name]
    FROM [Auct_CustomerAccount_Ex] cxacct -- need replace [Auct_CustomerAccount_Ex] with [Auct_CustomerAccount]
    LEFT JOIN [Auct_Invoice_Ex] inv -- need replace [Auct_Invoice_Ex] with [Auct_Invoice]
        ON cxacct.[ContactID]=inv.[ContactID]
    LEFT JOIN [Auct_Contact_Ex] con -- need replace [Auct_Contact] with [Auct_Contact_Cleaning_stg]
        ON cxacct.[ContactID]=con.[ContactID]
    WHERE (ISNULL(con.[Name], LEFT(inv.[InvoiceName], PATINDEX(''%[0-9]%'', inv.[InvoiceName])-1))) IS NOT NULL
)

SELECT 
    [CustomerAccountID],
    [ContactID],
    [Name]
FROM Contact_merged
    ');

  CREATE TABLE "stg"."Auct_Contact_Merge__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.Auct_Contact_Merge__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."Auct_Contact_Merge__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Contact_Merge__dbt_tmp_temp_view"
    end



07:11:46.150143 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:11:46.150299 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:11:46.313220 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:11:46.313758 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:11:58.586464 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 12.44 seconds
07:11:58.605491 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Contact_Merge".
07:11:58.605863 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Contact_Merge: rename object "stg"."Auct_Contact_Merge" to Auct_Contact_Merge__dbt_backup
07:11:58.674274 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
07:11:58.688191 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Contact_Merge".
07:11:58.688563 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Contact_Merge: rename object "stg"."Auct_Contact_Merge__dbt_tmp" to Auct_Contact_Merge
07:11:58.763513 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
07:11:58.775843 [debug] [Thread-1  ]: On model.Shawn.Auct_Contact_Merge: COMMIT
07:11:58.782945 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Contact_Merge".
07:11:58.783294 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Contact_Merge: 
    
  if object_id ('"stg"."Auct_Contact_Merge__dbt_backup"','U') is not null
    begin
    drop table "stg"."Auct_Contact_Merge__dbt_backup"
    end

07:12:00.060320 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.28 seconds
07:12:00.074242 [debug] [Thread-1  ]: finished collecting timing info
07:12:00.074717 [debug] [Thread-1  ]: On model.Shawn.Auct_Contact_Merge: Close
07:12:00.075536 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ca3430-1d84-4b68-8695-aef04c712f97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fdf348b0>]}
07:12:00.076047 [info ] [Thread-1  ]: 1 of 2 OK created table model stg.Auct_Contact_Merge............................ [[32mOK[0m in 14.11s]
07:12:00.076443 [debug] [Thread-1  ]: Finished running node model.Shawn.Auct_Contact_Merge
07:12:08.472654 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 22.32 seconds
07:12:08.487745 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Email_Merge".
07:12:08.488106 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.Auct_Email_Merge: rename object "stg"."Auct_Email_Merge" to Auct_Email_Merge__dbt_backup
07:12:08.551406 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
07:12:08.565012 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Email_Merge".
07:12:08.565362 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.Auct_Email_Merge: rename object "stg"."Auct_Email_Merge__dbt_tmp" to Auct_Email_Merge
07:12:08.597702 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
07:12:08.599703 [debug] [Thread-2  ]: On model.Shawn.Auct_Email_Merge: COMMIT
07:12:08.603847 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Email_Merge".
07:12:08.604059 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.Auct_Email_Merge: 
    
  if object_id ('"stg"."Auct_Email_Merge__dbt_backup"','U') is not null
    begin
    drop table "stg"."Auct_Email_Merge__dbt_backup"
    end

07:12:10.077211 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.47 seconds
07:12:10.090646 [debug] [Thread-2  ]: finished collecting timing info
07:12:10.091028 [debug] [Thread-2  ]: On model.Shawn.Auct_Email_Merge: Close
07:12:10.091777 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ca3430-1d84-4b68-8695-aef04c712f97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fdf21c10>]}
07:12:10.092260 [info ] [Thread-2  ]: 2 of 2 OK created table model stg.Auct_Email_Merge.............................. [[32mOK[0m in 24.13s]
07:12:10.092630 [debug] [Thread-2  ]: Finished running node model.Shawn.Auct_Email_Merge
07:12:10.093990 [debug] [MainThread]: Acquiring new synapse connection "master"
07:12:10.094463 [debug] [MainThread]: On master: COMMIT
07:12:10.094903 [info ] [MainThread]: 
07:12:10.095167 [info ] [MainThread]: Finished running 2 table models in 47.24s.
07:12:10.095369 [debug] [MainThread]: Connection 'master' was properly closed.
07:12:10.095474 [debug] [MainThread]: Connection 'model.Shawn.Auct_Email_Merge' was properly closed.
07:12:10.095570 [debug] [MainThread]: Connection 'model.Shawn.Auct_Contact_Merge' was properly closed.
07:12:10.280835 [info ] [MainThread]: 
07:12:10.281231 [info ] [MainThread]: [32mCompleted successfully[0m
07:12:10.281529 [info ] [MainThread]: 
07:12:10.281718 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
07:12:10.282030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a004b6d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a00b86a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a00722cd0>]}


============================== 2022-09-21 07:12:12.588299 | da7e47ae-4ca2-44bc-9e43-68c181f8d6ad ==============================
07:12:12.588299 [info ] [MainThread]: Running with dbt=1.0.0
07:12:12.594882 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/Auctioneer', record_timing_info=None, rpc_method='run', select=['step6_1'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
07:12:12.595182 [debug] [MainThread]: Tracking: tracking
07:12:12.595538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a0052ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a0052f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a0052fa0>]}
07:12:13.069643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:12:13.070167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:12:13.152036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da7e47ae-4ca2-44bc-9e43-68c181f8d6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff29ff36c70>]}
07:12:13.404343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da7e47ae-4ca2-44bc-9e43-68c181f8d6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff29f2e42e0>]}
07:12:13.405054 [info ] [MainThread]: Found 1345 models, 0 tests, 354 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:12:13.433904 [info ] [MainThread]: 
07:12:13.434740 [debug] [MainThread]: Acquiring new synapse connection "master"
07:12:13.436312 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
07:12:13.445677 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
07:12:13.445967 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
07:12:13.446101 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:12:13.446250 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:12:13.755248 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:12:13.789503 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.34 seconds
07:12:13.791494 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
07:12:13.867761 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
07:12:13.873724 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
07:12:13.874280 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
07:12:13.875990 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
07:12:13.876173 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
07:12:13.876291 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:12:13.876422 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:12:13.874477 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
07:12:13.877958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:12:13.878120 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:12:13.985785 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:12:13.986436 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:12:14.054195 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
07:12:14.058440 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
07:12:14.205796 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
07:12:14.215881 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
07:12:14.255670 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
07:12:14.264330 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
07:12:36.663627 [debug] [MainThread]: On master: COMMIT
07:12:36.664314 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
07:12:36.664634 [info ] [MainThread]: 
07:12:36.668234 [debug] [Thread-1  ]: Began running node model.Shawn.Auct_Phone_Merge
07:12:36.668630 [info ] [Thread-1  ]: 1 of 1 START table model stg.Auct_Phone_Merge................................... [RUN]
07:12:36.669129 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.Auct_Phone_Merge"
07:12:36.669299 [debug] [Thread-1  ]: Began compiling node model.Shawn.Auct_Phone_Merge
07:12:36.669452 [debug] [Thread-1  ]: Compiling model.Shawn.Auct_Phone_Merge
07:12:36.674913 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.Auct_Phone_Merge"
07:12:36.675482 [debug] [Thread-1  ]: finished collecting timing info
07:12:36.675659 [debug] [Thread-1  ]: Began executing node model.Shawn.Auct_Phone_Merge
07:12:36.767525 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.Auct_Phone_Merge"
07:12:36.768298 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Phone_Merge".
07:12:36.768497 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Phone_Merge: 
  
  if object_id ('"stg"."Auct_Phone_Merge__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Phone_Merge__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."Auct_Phone_Merge__dbt_tmp"','U') is not null
    begin
    drop table "stg"."Auct_Phone_Merge__dbt_tmp"
    end


   EXEC('create view stg.Auct_Phone_Merge__dbt_tmp_temp_view as
    
With 

Phone_merged1 AS (
    SELECT 
        [CustomerAccountID],
        [PhoneID],
        [PhoneNumber],
        [PhoneType],
        [PhoneStatus],
        [IsDefaultPhone],
        [IsActivePhone],
        [EffectiveStartDate],
        ISNULL([EffectiveEndDate], ''9999-12-31'') AS [EffectiveEndDate]
    FROM (
        SELECT 
            [CustomerAccountID],
            [PhoneID],
            [PhoneNumber],
            [PhoneType],
            [PhoneStatus],
            [IsDefaultPhone],
            [IsActivePhone],
            [Created] AS [EffectiveStartDate],
            CASE WHEN [CustomerAccountID] IS NOT NULL
                THEN LEAD([Created]) OVER(
                        PARTITION BY [CustomerAccountID], [PhoneID], [PhoneType]
                        ORDER BY [CustomerAccountID], [PhoneID], [PhoneType], [Created]
                    ) 
            ELSE LEAD([Created]) OVER(
                        PARTITION BY [PhoneID], [PhoneType]
                        ORDER BY [PhoneID], [PhoneType], [Created]
                    ) 
            END AS [EffectiveEndDate]
        FROM (
            SELECT 
                [CustomerAccountID],
                [PhoneID],
                [PhoneNumber],
                [PhoneType],
                [PhoneStatus],
                [IsDefaultPhone],
                [IsActivePhone],
                [Created],
                [DateSourcePhone],
                ROW_NUMBER() OVER(
                    PARTITION BY [CustomerAccountID], [PhoneID], [PhoneNumber], [PhoneType], [PhoneStatus], [IsDefaultPhone], [IsActivePhone]
                    ORDER BY [CustomerAccountID], [PhoneID], [PhoneNumber], [PhoneType], [PhoneStatus], [IsDefaultPhone], [IsActivePhone], [Created]
                ) AS [RowNumber]
            FROM (
                SELECT 
                    phasgmt.[CustomerAccountID],
                    ISNULL(phasgmt.[PhoneID], ph.[PhoneID]) AS [PhoneID],
                    -- ph.[AreaCode],
                    -- ph.[PhoneNumber],
                    CASE 
                        WHEN ph.[AreaCode] IS NULL 
                            THEN ph.[PhoneNumber]
                        WHEN ph.[AreaCode] IS NOT NULL
                            THEN CONCAT(ph.[AreaCode], ''-'', ph.[PhoneNumber])
                    END AS [PhoneNumber],
                    NULLIF(phty.[Name], ''[None]'') AS [PhoneType], -- (Update) NULLIF(phty.[PhoneType], ''[None]'') AS [PhoneType],
                    phsts.[Name] AS [PhoneStatus], -- (Update) phsts.[PhoneStatus],
                    phasgmt.[IsDefault] AS [IsDefaultPhone],
                    ph.[Active] AS [IsActivePhone], -- (Update) ph.[IsActive] AS [IsActivePhone], OR ph.[Active] AS [IsActivePhone],
                    ph.[Created] AS [CreatedPhone],
                    phasgmt.[Created] AS [CreatedPhoneAssignments] -- (Update) phasgmt.[Created] AS [CreatedPhoneAssignments]
                FROM stg.[Auct_PhoneAssignments_FinalView] phasgmt -- (Update) need replace [dbo].[Auct_PhoneAssignments_Ex] with [dbo].[Auct_PhoneAssignments]
                FULL OUTER JOIN stg.[Auct_Phone_Finalview] ph -- (Update) need replace [dbo].[Auct_Phone_Ex] with [dbo].[Auct_Phone_Ex]
                    ON phasgmt.[PhoneID]=ph.[PhoneID]
                LEFT JOIN stg.[Auct_PhoneType_FinalView] phty -- (Update) need replace [dbo].[Auct_PhoneType_Ex] with [dbo].[Auct_PhoneType]
                    ON phasgmt.[PhoneTypeID]=phty.[PhoneTypeID]
                LEFT JOIN stg.[Auct_PhoneStatus_FinalView] phsts -- (Update) need replace [dbo].[Auct_PhoneStatus_Ex] with [dbo].[Auct_PhoneStatus]
                    ON phasgmt.[PhoneStatusID]=phsts.[PhoneStatusID]
                WHERE (CASE WHEN ph.[AreaCode] IS NULL THEN ph.[PhoneNumber] WHEN ph.[AreaCode] IS NOT NULL THEN CONCAT(ph.[AreaCode], ''-'', ph.[PhoneNumber]) END) IS NOT NULL
                ) AS temp1
            UNPIVOT ([Created] FOR [DateSourcePhone] IN ([CreatedPhone], [CreatedPhoneAssignments])) AS unpvt
            ) AS temp2
        WHERE [RowNumber]=1
        ) AS temp3
)
, Phone_merged AS (
    SELECT 
        *,
        CASE WHEN [NewRowNumber]=''1'' 
            THEN ''1''
        ELSE ''0''
        END AS [IsCurrent] 
    FROM (
        SELECT 
            *,
            CASE WHEN [CustomerAccountID] IS NOT NULL
                THEN ROW_NUMBER() OVER(
                    PARTITION BY [CustomerAccountID]
                    ORDER BY [EffectiveStartDate] DESC, ISNULL([EffectiveEndDate], ''9999-12-31'') DESC
                    ) 
            ELSE ROW_NUMBER() OVER(
                PARTITION BY [EffectiveStartDate]
                ORDER BY [EffectiveStartDate] DESC, ISNULL([EffectiveEndDate], ''9999-12-31'') DESC
                )
            END AS [NewRowNumber]
        FROM (
            SELECT 
                [CustomerAccountID],
                MIN([mobilephone_PhoneID]) AS [MobilePhone_PhoneID], 
                MIN([mobilephone_PhoneNumber]) AS [MobilePhone_PhoneNumber], 
                MIN([mobilephone_PhoneStatus]) AS [MobilePhone_PhoneStatus], 
                MIN([IsDefault_mobilephone]) AS [IsDefaultMobilePhone], 
                MIN([IsActive_mobilephone]) AS [IsActiveMobilePhone], 
                MIN([directphone_PhoneID]) AS [DirectPhone_PhoneID], 
                MIN([directphone_PhoneNumber]) AS [DirectPhone_PhoneNumber], 
                MIN([directphone_PhoneStatus]) AS [DirectPhone_PhoneStatus],
                MIN([IsDefault_directphone]) AS [IsDefaultDirectPhone],  
                MIN([IsActive_directphone]) AS [IsActiveDirectPhone],  
                MIN([homephone_PhoneID]) AS [HomePhone_PhoneID],
                MIN([homephone_PhoneNumber]) AS [HomePhone_PhoneNumber], 
                MIN([homephone_PhoneStatus]) AS [HomePhone_PhoneStatus],  
                MIN([IsDefault_homephone]) AS [IsDefaultHomePhone],  
                MIN([IsActive_homephone]) AS [IsActiveHomePhone],  
                MIN([homefax_PhoneID]) AS [HomeFax_PhoneID],  
                MIN([homefax_PhoneNumber]) AS [HomeFax_PhoneNumber], 
                MIN([homefax_PhoneStatus]) AS [HomeFax_PhoneStatus],  
                MIN([IsDefault_homefax]) AS [IsDefaultHomeFax],  
                MIN([IsActive_homefax]) AS [IsActiveHomeFax],  
                MIN([dealermobile_PhoneID]) AS [DealerMobile_PhoneID],  
                MIN([dealermobile_PhoneNumber]) AS [DealerMobile_PhoneNumber], 
                MIN([dealermobile_PhoneStatus]) AS [DealerMobile_PhoneStatus],  
                MIN([IsDefault_dealermobile]) AS [IsDefaultDealerMobile],  
                MIN([IsActive_dealermobile]) AS [IsActiveDealerMobile],  
                MIN([dealerphone_PhoneID]) AS [DealerPhone_PhoneID],  
                MIN([dealerphone_PhoneNumber]) AS [DealerPhone_PhoneNumber], 
                MIN([dealerphone_PhoneStatus]) AS [DealerPhone_PhoneStatus],  
                MIN([IsDefault_dealerphone]) AS [IsDefaultDealerPhone],  
                MIN([IsActive_dealerphone]) AS [IsActiveDealerPhone],  
                MIN([dealerfax_PhoneID]) AS [DealerFax_PhoneID],  
                MIN([dealerfax_PhoneNumber]) AS [DealerFax_PhoneNumber], 
                MIN([dealerfax_PhoneStatus]) AS [DealerFax_PhoneStatus],  
                MIN([IsDefault_dealerfax]) AS [IsDefaultDealerFax],  
                MIN([IsActive_dealerfax]) AS [IsActiveDealerFax],  
                MIN([businessphone_PhoneID]) AS [BusinessPhone_PhoneID],  
                MIN([businessphone_PhoneNumber]) AS [BusinessPhone_PhoneNumber], 
                MIN([businessphone_PhoneStatus]) AS [BusinessPhone_PhoneStatus],  
                MIN([IsDefault_businessphone]) AS [IsDefaultBusinessPhone],  
                MIN([IsActive_businessphone]) AS [IsActiveBusinessPhone],  
                MIN([businessfax_PhoneID]) AS [BusinessFax_PhoneID],  
                MIN([businessfax_PhoneNumber]) AS [BusinessFax_PhoneNumber], 
                MIN([businessfax_PhoneStatus]) AS [BusinessFax_PhoneStatus],  
                MIN([IsDefault_businessfax]) AS [IsDefaultBusinessFax],  
                MIN([IsActive_businessfax]) AS [IsActiveBusinessFax],  
                MIN([businessmobile_PhoneID]) AS [BusinessMobile_PhoneID],  
                MIN([businessmobile_PhoneNumber]) AS [BusinessMobile_PhoneNumber], 
                MIN([businessmobile_PhoneStatus]) AS [BusinessMobile_PhoneStatus],  
                MIN([IsDefault_businessmobile]) AS [IsDefaultBusinessMobile],  
                MIN([IsActive_businessmobile]) AS [IsActiveBusinessMobile], 
                MIN([vendorphone_PhoneID]) AS [VendorPhone_PhoneID],  
                MIN([vendorphone_PhoneNumber]) AS [VendorPhone_PhoneNumber], 
                MIN([vendorphone_PhoneStatus]) AS [VendorPhone_PhoneStatus],  
                MIN([IsDefault_vendorphone]) AS [IsDefaultVendorPhone],      
                MIN([IsActive_vendorphone]) AS [IsActiveVendorPhone],  
                MIN([vendorfax_PhoneID]) AS [VendorFax_PhoneID],  
                MIN([vendorfax_PhoneNumber]) AS [VendorFax_PhoneNumber], 
                MIN([vendorfax_PhoneStatus]) AS [VendorFax_PhoneStatus],  
                MIN([IsDefault_vendorfax]) AS [IsDefaultVendorFax],  
                MIN([IsActive_vendorfax]) AS [IsActiveVendorFax],  
                MIN([requestphone_PhoneID]) AS [RequestNumber_PhoneID],  
                MIN([requestphone_PhoneNumber]) AS [RequestNumber_PhoneNumber], 
                MIN([requestphone_PhoneStatus]) AS [RequestNumber_PhoneStatus],  
                MIN([IsDefault_requestphone]) AS [IsDefaultRequestNumber],  
                MIN([IsActive_requestphone]) AS [IsActiveRequestNumber],  
                MIN([requestfax_PhoneID]) AS [RequestFax_PhoneID],  
                MIN([requestfax_PhoneNumber]) AS [RequestFax_PhoneNumber],
                MIN([requestfax_PhoneStatus]) AS [RequestFax_PhoneStatus],
                MIN([IsDefault_requestfax]) AS [IsDefaultRequestFax],
                MIN([IsActive_requestfax]) AS [IsActiveRequestFax],
                MIN([localphone_PhoneID]) AS [LocalPhone_PhoneID],
                MIN([localphone_PhoneNumber]) AS [LocalPhone_PhoneNumber],
                MIN([localphone_PhoneStatus]) AS [LocalPhone_PhoneStatus], 
                MIN([IsDefault_localphone]) AS [IsDefaultLocalPhone],
                MIN([IsActive_localphone]) AS [IsActiveLocalPhone], 
                MIN([pager_PhoneID]) AS [Pager_PhoneID],
                MIN([pager_PhoneNumber]) AS [Pager_PhoneNumber], 
                MIN([pager_PhoneStatus]) AS [Pager_PhoneStatus],  
                MIN([IsDefault_pager]) AS [IsDefaultPager],
                MIN([IsActive_pager]) AS [IsActivePager],
                MIN([UnknownPhoneType_PhoneID]) AS [UnknownPhoneType_PhoneID],
                MIN([UnknownPhoneType_PhoneNumber]) AS [UnknownPhoneType_PhoneNumber], 
                MIN([UnknownPhoneType_PhoneStatus]) AS [UnknownPhoneType_PhoneStatus],  
                MIN([IsDefault_UnknownPhoneType]) AS [IsDefaultUnknownPhoneType],
                MIN([IsActive_UnknownPhoneType]) AS [IsActiveUnknownPhoneType],
                [EffectiveStartDate],
                [EffectiveEndDate]
            FROM (
                SELECT 
                    *
                FROM (
                    SELECT 
                        *
                    FROM (
                        SELECT 
                            *
                        FROM (
                            SELECT 
                                *
                            FROM (
                                SELECT 
                                    [CustomerAccountID],
                                    [PhoneID] AS Val1, -- (ORIGINAL) [PhoneID],
                                    ISNULL(REPLACE(LOWER([PhoneType]), '' '', ''''), ''UnknownPhoneType'')+''_PhoneID'' AS Col1, -- (ORIGINAL) [PhoneType],
                                    [PhoneNumber] AS Val2, -- (ORIGINAL) [PhoneNumber],
                                    ISNULL(REPLACE(LOWER([PhoneType]), '' '', ''''), ''UnknownPhoneType'')+''_PhoneNumber'' AS Col2, -- (ORIGINAL) [PhoneType],
                                    [PhoneStatus] AS Val3, -- (ORIGINAL) [PhoneStatus],
                                    ISNULL(REPLACE(LOWER([PhoneType]), '' '', ''''), ''UnknownPhoneType'')+''_PhoneStatus'' AS Col3, -- (ORIGINAL) [PhoneType],           
                                    [IsDefaultPhone] AS Val4, -- (ORIGINAL) [IsDefaultPhone],
                                    ''IsDefault_'' + ISNULL(REPLACE(LOWER([PhoneType]), '' '', ''''), ''UnknownPhoneType'') AS Col4, -- (ORIGINAL) [PhoneType],           
                                    [IsActivePhone] AS Val5, -- (ORIGINAL) [IsActivePhone],
                                    ''IsActive_'' + ISNULL(REPLACE(LOWER([PhoneType]), '' '', ''''), ''UnknownPhoneType'') AS Col5, -- (ORIGINAL) [PhoneType],                          
                                    [EffectiveStartDate],
                                    [EffectiveEndDate]
                                FROM Phone_merged1 where [PhoneNumber] is not null  --clean null data
                                ) AS SRC1 
                                -- FOR [PhoneID]
                                PIVOT (
                                    MAX(Val1) FOR Col1 IN ([mobilephone_PhoneID], [directphone_PhoneID], [homephone_PhoneID], [homefax_PhoneID], [dealermobile_PhoneID], [dealerphone_PhoneID], [dealerfax_PhoneID], [businessphone_PhoneID], [businessfax_PhoneID], [businessmobile_PhoneID], [vendorphone_PhoneID], [vendorfax_PhoneID], [requestphone_PhoneID], [requestfax_PhoneID], [localphone_PhoneID], [pager_PhoneID], [UnknownPhoneType_PhoneID])
                                ) AS PVT1
                            ) AS SRC2
                            -- FOR [PhoneNumber]
                            PIVOT (
                                MAX(Val2) FOR Col2 IN ([mobilephone_PhoneNumber], [directphone_PhoneNumber], [homephone_PhoneNumber], [homefax_PhoneNumber], [dealermobile_PhoneNumber], [dealerphone_PhoneNumber], [dealerfax_PhoneNumber], [businessphone_PhoneNumber], [businessfax_PhoneNumber], [businessmobile_PhoneNumber], [vendorphone_PhoneNumber], [vendorfax_PhoneNumber], [requestphone_PhoneNumber], [requestfax_PhoneNumber], [localphone_PhoneNumber], [pager_PhoneNumber], [UnknownPhoneType_PhoneNumber])
                            ) AS PVT2
                        ) AS SRC3 
                        -- FOR [PhoneStatus]
                        PIVOT (
                            MAX(Val3) FOR Col3 IN ([mobilephone_PhoneStatus], [directphone_PhoneStatus], [homephone_PhoneStatus], [homefax_PhoneStatus], [dealermobile_PhoneStatus], [dealerphone_PhoneStatus], [dealerfax_PhoneStatus], [businessphone_PhoneStatus], [businessfax_PhoneStatus], [businessmobile_PhoneStatus], [vendorphone_PhoneStatus], [vendorfax_PhoneStatus], [requestphone_PhoneStatus], [requestfax_PhoneStatus], [localphone_PhoneStatus], [pager_PhoneStatus], [UnknownPhoneType_PhoneStatus])
                        ) AS PVT3
                    ) AS SRC4
                    -- FOR [IsDefaultPhone]
                    PIVOT (
                        MAX(Val4) FOR Col4 IN ([IsDefault_mobilephone], [IsDefault_directphone], [IsDefault_homephone], [IsDefault_homefax], [IsDefault_dealermobile], [IsDefault_dealerphone], [IsDefault_dealerfax], [IsDefault_businessphone], [IsDefault_businessfax], [IsDefault_businessmobile], [IsDefault_vendorphone], [IsDefault_vendorfax], [IsDefault_requestphone], [IsDefault_requestfax], [IsDefault_localphone], [IsDefault_pager], [IsDefault_UnknownPhoneType])
                    ) AS PVT4
                ) AS SRC5 
                -- FOR [IsActivePhone]
                PIVOT (
                    MAX(Val5) FOR Col5 IN ([IsActive_mobilephone], [IsActive_directphone], [IsActive_homephone], [IsActive_homefax], [IsActive_dealermobile], [IsActive_dealerphone], [IsActive_dealerfax], [IsActive_businessphone], [IsActive_businessfax], [IsActive_businessmobile], [IsActive_vendorphone], [IsActive_vendorfax], [IsActive_requestphone], [IsActive_requestfax], [IsActive_localphone], [IsActive_pager], [IsActive_UnknownPhoneType])
                
                ) AS PVT5
                GROUP BY [CustomerAccountID], [EffectiveStartDate], [EffectiveEndDate]
            ) AS temp1
        ) AS temp2
) 

SELECT 
    [CustomerAccountID],
    -- [PhoneID],
    -- [PhoneNumber],,
    -- [PhoneType],
    -- [PhoneStatus],
    -- [IsDefaultPhone],
    -- [IsActivePhone],
  
    -- HASHBYTES(''SHA2_256'', concat(
    --         Cast([MobilePhone_PhoneID] as varchar),Cast([DirectPhone_PhoneID] as varchar), Cast([HomePhone_PhoneID] as varchar),
    --             Cast([HomeFax_PhoneID] as varchar), Cast([DealerMobile_PhoneID] as varchar), Cast([DealerPhone_PhoneID] as varchar),
    --             Cast([DealerFax_PhoneID] as varchar), Cast([BusinessPhone_PhoneID] as varchar), Cast([BusinessFax_PhoneID] as varchar),
    --             Cast([BusinessMobile_PhoneID] as varchar),  Cast([VendorPhone_PhoneID] as varchar), Cast([VendorFax_PhoneID] as varchar),
    --             Cast([RequestNumber_PhoneID] as varchar),  Cast([RequestFax_PhoneID] as varchar),  Cast([LocalPhone_PhoneID] as varchar),
    --             Cast([Pager_PhoneID] as varchar), Cast([UnknownPhoneType_PhoneID] as varchar)
    --         )
    --     ) 
    -- AS HashPhoneID,
    [MobilePhone_PhoneID], 
    [MobilePhone_PhoneNumber], 
    [MobilePhone_PhoneStatus], 
    [IsDefaultMobilePhone], 
    [IsActiveMobilePhone], 
    [DirectPhone_PhoneID], 
    [DirectPhone_PhoneNumber], 
    [DirectPhone_PhoneStatus],
    [IsDefaultDirectPhone],  
    [IsActiveDirectPhone],  
    [HomePhone_PhoneID],
    [HomePhone_PhoneNumber], 
    [HomePhone_PhoneStatus],  
    [IsDefaultHomePhone],  
    [IsActiveHomePhone],  
    [HomeFax_PhoneID],  
    [HomeFax_PhoneNumber], 
    [HomeFax_PhoneStatus],  
    [IsDefaultHomeFax],  
    [IsActiveHomeFax],  
    [DealerMobile_PhoneID],  
    [DealerMobile_PhoneNumber], 
    [DealerMobile_PhoneStatus],  
    [IsDefaultDealerMobile],  
    [IsActiveDealerMobile],  
    [DealerPhone_PhoneID],  
    [DealerPhone_PhoneNumber], 
    [DealerPhone_PhoneStatus],  
    [IsDefaultDealerPhone],  
    [IsActiveDealerPhone],  
    [DealerFax_PhoneID],  
    [DealerFax_PhoneNumber], 
    [DealerFax_PhoneStatus],  
    [IsDefaultDealerFax],  
    [IsActiveDealerFax],  
    [BusinessPhone_PhoneID],  
    [BusinessPhone_PhoneNumber], 
    [BusinessPhone_PhoneStatus],  
    [IsDefaultBusinessPhone],  
    [IsActiveBusinessPhone],  
    [BusinessFax_PhoneID],  
    [BusinessFax_PhoneNumber], 
    [BusinessFax_PhoneStatus],  
    [IsDefaultBusinessFax],  
    [IsActiveBusinessFax],  
    [BusinessMobile_PhoneID],  
    [BusinessMobile_PhoneNumber], 
    [BusinessMobile_PhoneStatus],  
    [IsDefaultBusinessMobile],  
    [IsActiveBusinessMobile], 
    [VendorPhone_PhoneID],  
    [VendorPhone_PhoneNumber], 
    [VendorPhone_PhoneStatus],  
    [IsDefaultVendorPhone],      
    [IsActiveVendorPhone],  
    [VendorFax_PhoneID],  
    [VendorFax_PhoneNumber], 
    [VendorFax_PhoneStatus],  
    [IsDefaultVendorFax],  
    [IsActiveVendorFax],  
    [RequestNumber_PhoneID],  
    [RequestNumber_PhoneNumber], 
    [RequestNumber_PhoneStatus],  
    [IsDefaultRequestNumber],  
    [IsActiveRequestNumber],  
    [RequestFax_PhoneID],  
    [RequestFax_PhoneNumber],
    [RequestFax_PhoneStatus],
    [IsDefaultRequestFax],
    [IsActiveRequestFax],
    [LocalPhone_PhoneID],
    [LocalPhone_PhoneNumber],
    [LocalPhone_PhoneStatus], 
    [IsDefaultLocalPhone],
    [IsActiveLocalPhone], 
    [Pager_PhoneID],
    [Pager_PhoneNumber], 
    [Pager_PhoneStatus],  
    [IsDefaultPager],
    [IsActivePager],
    [UnknownPhoneType_PhoneID],
    [UnknownPhoneType_PhoneNumber], 
    [UnknownPhoneType_PhoneStatus],  
    [IsDefaultUnknownPhoneType],
    [IsActiveUnknownPhoneType],
    [EffectiveStartDate],
    [EffectiveEndDate],
    [IsCurrent] 
FROM Phone_merged
    ');

  CREATE TABLE "stg"."Auct_Phone_Merge__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.Auct_Phone_Merge__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."Auct_Phone_Merge__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Phone_Merge__dbt_tmp_temp_view"
    end



07:12:36.768678 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:12:36.768831 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:12:36.894310 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:13:18.829071 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 42.06 seconds
07:13:18.847831 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Phone_Merge".
07:13:18.848175 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Phone_Merge: rename object "stg"."Auct_Phone_Merge" to Auct_Phone_Merge__dbt_backup
07:13:19.125579 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
07:13:19.139801 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Phone_Merge".
07:13:19.140155 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Phone_Merge: rename object "stg"."Auct_Phone_Merge__dbt_tmp" to Auct_Phone_Merge
07:13:19.171892 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
07:13:19.183663 [debug] [Thread-1  ]: On model.Shawn.Auct_Phone_Merge: COMMIT
07:13:19.190780 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Phone_Merge".
07:13:19.191124 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Phone_Merge: 
    
  if object_id ('"stg"."Auct_Phone_Merge__dbt_backup"','U') is not null
    begin
    drop table "stg"."Auct_Phone_Merge__dbt_backup"
    end

07:13:21.111860 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.92 seconds
07:13:21.125284 [debug] [Thread-1  ]: finished collecting timing info
07:13:21.125684 [debug] [Thread-1  ]: On model.Shawn.Auct_Phone_Merge: Close
07:13:21.126484 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da7e47ae-4ca2-44bc-9e43-68c181f8d6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff29d00f250>]}
07:13:21.127015 [info ] [Thread-1  ]: 1 of 1 OK created table model stg.Auct_Phone_Merge.............................. [[32mOK[0m in 44.46s]
07:13:21.127398 [debug] [Thread-1  ]: Finished running node model.Shawn.Auct_Phone_Merge
07:13:21.128694 [debug] [MainThread]: Acquiring new synapse connection "master"
07:13:21.129166 [debug] [MainThread]: On master: COMMIT
07:13:21.129496 [info ] [MainThread]: 
07:13:21.129739 [info ] [MainThread]: Finished running 1 table model in 67.70s.
07:13:21.129931 [debug] [MainThread]: Connection 'master' was properly closed.
07:13:21.130034 [debug] [MainThread]: Connection 'model.Shawn.Auct_Phone_Merge' was properly closed.
07:13:21.130129 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
07:13:21.322986 [info ] [MainThread]: 
07:13:21.323369 [info ] [MainThread]: [32mCompleted successfully[0m
07:13:21.323665 [info ] [MainThread]: 
07:13:21.323849 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
07:13:21.324152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff29f4ebc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff29f71b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff29d013b50>]}


============================== 2022-09-21 07:13:23.769497 | fa17749a-ed07-42e8-bb78-dd07a9c0c6f6 ==============================
07:13:23.769497 [info ] [MainThread]: Running with dbt=1.0.0
07:13:23.774955 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/Auctioneer', record_timing_info=None, rpc_method='run', select=['step6_2'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
07:13:23.775296 [debug] [MainThread]: Tracking: tracking
07:13:23.775683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f83d1deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f83d1df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f83d1df70>]}
07:13:24.275774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:13:24.276342 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:13:24.359451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa17749a-ed07-42e8-bb78-dd07a9c0c6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f83c01c40>]}
07:13:24.626529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa17749a-ed07-42e8-bb78-dd07a9c0c6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f82f6e2b0>]}
07:13:24.627154 [info ] [MainThread]: Found 1345 models, 0 tests, 354 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:13:24.657610 [info ] [MainThread]: 
07:13:24.658442 [debug] [MainThread]: Acquiring new synapse connection "master"
07:13:24.660127 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
07:13:24.669463 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
07:13:24.669750 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
07:13:24.669888 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:13:24.670035 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:13:24.965105 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:13:25.000018 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.33 seconds
07:13:25.002007 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
07:13:25.078975 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
07:13:25.086215 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
07:13:25.087004 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
07:13:25.088980 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
07:13:25.089195 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
07:13:25.089319 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:13:25.089451 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:13:25.087357 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
07:13:25.090836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:13:25.091314 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:13:25.216264 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:13:25.217166 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:13:25.285472 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.20 seconds
07:13:25.287522 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.20 seconds
07:13:25.460053 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
07:13:25.460473 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
07:13:25.498762 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
07:13:25.507709 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
07:13:47.621395 [debug] [MainThread]: On master: COMMIT
07:13:47.622073 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
07:13:47.622398 [info ] [MainThread]: 
07:13:47.626014 [debug] [Thread-1  ]: Began running node model.Shawn.Auct_Customer_HistoricalCompanyID_Lookup
07:13:47.626417 [info ] [Thread-1  ]: 1 of 1 START table model stg.Auct_Customer_HistoricalCompanyID_Lookup........... [RUN]
07:13:47.626975 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.Auct_Customer_HistoricalCompanyID_Lookup"
07:13:47.627143 [debug] [Thread-1  ]: Began compiling node model.Shawn.Auct_Customer_HistoricalCompanyID_Lookup
07:13:47.627296 [debug] [Thread-1  ]: Compiling model.Shawn.Auct_Customer_HistoricalCompanyID_Lookup
07:13:47.630267 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.Auct_Customer_HistoricalCompanyID_Lookup"
07:13:47.630823 [debug] [Thread-1  ]: finished collecting timing info
07:13:47.630997 [debug] [Thread-1  ]: Began executing node model.Shawn.Auct_Customer_HistoricalCompanyID_Lookup
07:13:47.723511 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.Auct_Customer_HistoricalCompanyID_Lookup"
07:13:47.724280 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Customer_HistoricalCompanyID_Lookup".
07:13:47.724486 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Customer_HistoricalCompanyID_Lookup: 
  
  if object_id ('"stg"."Auct_Customer_HistoricalCompanyID_Lookup__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Customer_HistoricalCompanyID_Lookup__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."Auct_Customer_HistoricalCompanyID_Lookup__dbt_tmp"','U') is not null
    begin
    drop table "stg"."Auct_Customer_HistoricalCompanyID_Lookup__dbt_tmp"
    end


   EXEC('create view stg.Auct_Customer_HistoricalCompanyID_Lookup__dbt_tmp_temp_view as
    

With Auct_Customer_HistoricalCompanyID_CTE AS (
    SELECT 
        [CustomerAccountID],
        STRING_AGG([CompanyID], '','') AS [CompanyID]
    FROM (
        SELECT 
            cxacct.[CustomerAccountID],
            cxacct.[CompanyID]
        FROM [Auct_CustomerAccount_FinalView] cxacct -- (Update) need replace [dbo].[Auct_CustomerAccount_Ex] with [dbo].[Auct_CustomerAccount]
        WHERE COALESCE(cxacct.[CustomerAccountID], cxacct.[CompanyID]) IS NOT NULL 
            AND cxacct.[CompanyID] IS NOT NULL
        UNION
        SELECT 
            addrmrg.[CustomerAccountID],
            addrmrg.[CurrentCompanyID] AS [CompanyID]
        FROM [stg].[Auct_Address_Merge] addrmrg
        WHERE COALESCE(addrmrg.[CustomerAccountID], addrmrg.[CurrentCompanyID]) IS NOT NULL 
            AND addrmrg.[CurrentCompanyID] IS NOT NULL
        ) AS temp1
    GROUP BY [CustomerAccountID]
)

SELECT 
    [CustomerAccountID],
    [CompanyID]
FROM Auct_Customer_HistoricalCompanyID_CTE
    ');

  CREATE TABLE "stg"."Auct_Customer_HistoricalCompanyID_Lookup__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.Auct_Customer_HistoricalCompanyID_Lookup__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."Auct_Customer_HistoricalCompanyID_Lookup__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Customer_HistoricalCompanyID_Lookup__dbt_tmp_temp_view"
    end



07:13:47.724618 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:13:47.724762 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:13:47.849099 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:13:51.002152 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.28 seconds
07:13:51.021031 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Customer_HistoricalCompanyID_Lookup".
07:13:51.021406 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Customer_HistoricalCompanyID_Lookup: rename object "stg"."Auct_Customer_HistoricalCompanyID_Lookup" to Auct_Customer_HistoricalCompanyID_Lookup__dbt_backup
07:13:51.096085 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
07:13:51.111400 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Customer_HistoricalCompanyID_Lookup".
07:13:51.111773 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Customer_HistoricalCompanyID_Lookup: rename object "stg"."Auct_Customer_HistoricalCompanyID_Lookup__dbt_tmp" to Auct_Customer_HistoricalCompanyID_Lookup
07:13:51.147312 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
07:13:51.159335 [debug] [Thread-1  ]: On model.Shawn.Auct_Customer_HistoricalCompanyID_Lookup: COMMIT
07:13:51.166525 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Customer_HistoricalCompanyID_Lookup".
07:13:51.166902 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Customer_HistoricalCompanyID_Lookup: 
    
  if object_id ('"stg"."Auct_Customer_HistoricalCompanyID_Lookup__dbt_backup"','U') is not null
    begin
    drop table "stg"."Auct_Customer_HistoricalCompanyID_Lookup__dbt_backup"
    end

07:13:52.559793 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.39 seconds
07:13:52.573111 [debug] [Thread-1  ]: finished collecting timing info
07:13:52.573531 [debug] [Thread-1  ]: On model.Shawn.Auct_Customer_HistoricalCompanyID_Lookup: Close
07:13:52.574289 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa17749a-ed07-42e8-bb78-dd07a9c0c6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f80c26400>]}
07:13:52.574815 [info ] [Thread-1  ]: 1 of 1 OK created table model stg.Auct_Customer_HistoricalCompanyID_Lookup...... [[32mOK[0m in 4.95s]
07:13:52.575202 [debug] [Thread-1  ]: Finished running node model.Shawn.Auct_Customer_HistoricalCompanyID_Lookup
07:13:52.576479 [debug] [MainThread]: Acquiring new synapse connection "master"
07:13:52.576951 [debug] [MainThread]: On master: COMMIT
07:13:52.577282 [info ] [MainThread]: 
07:13:52.577529 [info ] [MainThread]: Finished running 1 table model in 27.92s.
07:13:52.577725 [debug] [MainThread]: Connection 'master' was properly closed.
07:13:52.577828 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
07:13:52.577924 [debug] [MainThread]: Connection 'model.Shawn.Auct_Customer_HistoricalCompanyID_Lookup' was properly closed.
07:13:52.774701 [info ] [MainThread]: 
07:13:52.775110 [info ] [MainThread]: [32mCompleted successfully[0m
07:13:52.775411 [info ] [MainThread]: 
07:13:52.775597 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
07:13:52.775897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f833e6bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f831b6e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f80cd4880>]}


============================== 2022-09-21 07:13:55.106036 | 4818ffa2-cd9a-455b-9aff-ec7ddf152c61 ==============================
07:13:55.106036 [info ] [MainThread]: Running with dbt=1.0.0
07:13:55.111181 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/Auctioneer', record_timing_info=None, rpc_method='run', select=['step6_3'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
07:13:55.111436 [debug] [MainThread]: Tracking: tracking
07:13:55.111781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aff448e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aff448ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aff448f40>]}
07:13:55.599648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:13:55.600169 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:13:55.684565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4818ffa2-cd9a-455b-9aff-ec7ddf152c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aff32cc10>]}
07:13:55.947343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4818ffa2-cd9a-455b-9aff-ec7ddf152c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7afe6da280>]}
07:13:55.947894 [info ] [MainThread]: Found 1345 models, 0 tests, 354 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:13:55.978270 [info ] [MainThread]: 
07:13:55.979145 [debug] [MainThread]: Acquiring new synapse connection "master"
07:13:55.980898 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
07:13:55.990222 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
07:13:55.990661 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
07:13:55.992541 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
07:13:55.992746 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
07:13:55.992873 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:13:55.993014 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:13:55.990969 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
07:13:55.994680 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:13:55.994860 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:13:56.269581 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:13:56.273528 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:13:56.305728 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.31 seconds
07:13:56.307659 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.31 seconds
07:13:56.308932 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
07:13:56.309801 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
07:13:56.386066 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
07:13:56.392260 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
07:13:56.392714 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
07:13:56.394838 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
07:13:56.395071 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
07:13:56.395194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:13:56.395337 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:13:56.393040 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
07:13:56.396651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:13:56.397128 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:13:56.508002 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:13:56.508981 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:13:56.572751 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
07:13:56.580839 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
07:13:56.750293 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
07:13:56.750779 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
07:13:56.789806 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
07:13:56.799688 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
07:14:18.819715 [debug] [MainThread]: On master: COMMIT
07:14:18.820411 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
07:14:18.820733 [info ] [MainThread]: 
07:14:18.824375 [debug] [Thread-1  ]: Began running node model.Shawn.Auct_Customer_ContactType_Lookup
07:14:18.824884 [info ] [Thread-1  ]: 1 of 2 START table model stg.Auct_Customer_ContactType_Lookup................... [RUN]
07:14:18.825384 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.Auct_Customer_ContactType_Lookup"
07:14:18.825558 [debug] [Thread-1  ]: Began compiling node model.Shawn.Auct_Customer_ContactType_Lookup
07:14:18.825720 [debug] [Thread-1  ]: Compiling model.Shawn.Auct_Customer_ContactType_Lookup
07:14:18.824620 [debug] [Thread-2  ]: Began running node model.Shawn.Auct_Item_BR
07:14:18.830758 [info ] [Thread-2  ]: 2 of 2 START table model dbo.Auct_Item_BR....................................... [RUN]
07:14:18.831210 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.Auct_Item_BR"
07:14:18.831364 [debug] [Thread-2  ]: Began compiling node model.Shawn.Auct_Item_BR
07:14:18.831490 [debug] [Thread-2  ]: Compiling model.Shawn.Auct_Item_BR
07:14:18.833892 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.Auct_Item_BR"
07:14:18.830385 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.Auct_Customer_ContactType_Lookup"
07:14:18.834518 [debug] [Thread-1  ]: finished collecting timing info
07:14:18.834715 [debug] [Thread-1  ]: Began executing node model.Shawn.Auct_Customer_ContactType_Lookup
07:14:18.843872 [debug] [Thread-2  ]: finished collecting timing info
07:14:18.844066 [debug] [Thread-2  ]: Began executing node model.Shawn.Auct_Item_BR
07:14:18.980246 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.Auct_Item_BR"
07:14:18.981024 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Item_BR".
07:14:18.981227 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.Auct_Item_BR: 
  
  if object_id ('"dbo"."Auct_Item_BR__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_Item_BR__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."Auct_Item_BR__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."Auct_Item_BR__dbt_tmp"
    end


   EXEC('create view dbo.Auct_Item_BR__dbt_tmp_temp_view as
    

WITH Auct_Item_BR_stg AS (
	SELECT 
		[Item_Skey],
		[ItemType],
		[ItemDescription]
	FROM [dbo].[Auct_Car_DM]
	UNION 
	SELECT 
		[Item_Skey],
		[ItemType],
		[ItemDescription]
	FROM [dbo].[Auct_Automobilia_DM]
)

SELECT 
	[Item_Skey],
	[ItemType],
	[ItemDescription]
FROM Auct_Item_BR_stg
    ');

  CREATE TABLE "dbo"."Auct_Item_BR__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.Auct_Item_BR__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."Auct_Item_BR__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."Auct_Item_BR__dbt_tmp_temp_view"
    end



07:14:18.981349 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
07:14:18.981494 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:14:18.984297 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.Auct_Customer_ContactType_Lookup"
07:14:18.984824 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Customer_ContactType_Lookup".
07:14:18.985003 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Customer_ContactType_Lookup: 
  
  if object_id ('"stg"."Auct_Customer_ContactType_Lookup__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Customer_ContactType_Lookup__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."Auct_Customer_ContactType_Lookup__dbt_tmp"','U') is not null
    begin
    drop table "stg"."Auct_Customer_ContactType_Lookup__dbt_tmp"
    end


   EXEC('create view stg.Auct_Customer_ContactType_Lookup__dbt_tmp_temp_view as
    

-- DECLARE @BidderContactType AS VARCHAR(100), @ConsignorContactType AS VARCHAR(100);
-- SET @BidderContactType=''Bidder'';
-- SET @ConsignorContactType=''Consignor'';
With Auct_AuctionBidder_Ex AS (
	 select * from stg.[Auct_AuctionBidder_FinalView]
),
Auct_Bidder_Ex AS (
	 select * from stg.[Auct_Bidder_FinalView]
),
Auct_Consignment_Ex AS (
	 select * from stg.[Auct_Consignment_FinalView]
),
Auct_ContactContact_Ex AS (
	 select * from stg.[Auct_ContactContact_FinalView]
),
Auct_ContactType_Ex AS (
	 select * from stg.[Auct_ContactType_FinalView]
),
Auct_Auction_CTE AS (
    SELECT
        [AuctionID],
        [Auction_Skey], 
        ISNULL([City], ''UNRECORDED'') AS [AuctionCity],
        ISNULL(NULLIF([Year], ''0''), YEAR([AuctionBegins])) AS [AuctionYear],
        [AuctionBegins], 
        [AuctionEnds],
        LAG([AuctionBegins]) OVER(ORDER BY [Year], [AuctionBegins], [AuctionEnds], [AuctionID]) AS [PreviousAuctionBegins],
        LAG([AuctionEnds]) OVER(ORDER BY [Year], [AuctionBegins], [AuctionEnds], [AuctionID]) AS [PreviousAuctionEnds]
    FROM [dbo].[Auct_Auction_DM] -- (Update) replaced [Auct_Auction_Ex] LEFT JOIN [Auct_AuctionLocation_Ex] with [dbo].[Auct_Auction_DM]
)
-- FOR [PresumedContactType] of Customer in Auct_Consignment and Auct_AuctionBidder table
, Auct_Customer_ContactType_CTE1 AS (
    SELECT 
        [CustomerAccountID],
        [AuctionID],
        STRING_AGG([ContactType], '','') WITHIN GROUP (ORDER BY [Created]) AS [PresumedContactType],
        MIN([Created]) AS [CreatedPresumedContactType]
    FROM (
        SELECT 
            [CustomerAccountID],
            [AuctionID],
            [ContactType],
            [Created],
            ROW_NUMBER() OVER(
                PARTITION BY [CustomerAccountID], [AuctionID], [ContactType]
                ORDER BY [CustomerAccountID], [AuctionID], [ContactType], [Created]
            ) AS [RowNumber]
        FROM (
            SELECT 
                DISTINCT [CustomerAccountID],
                [AuctionID],
                ''Consignor''  [ContactType],
                [Created]
            FROM [Auct_Consignment_Ex]
            UNION 
            SELECT 
                DISTINCT bid.[CustomerAccountID],
                aucbid.[AuctionID],
                ''Bidder'' [ContactType],
                ISNULL(aucbid.[RegistrationDate], aucbid.[Created])
            FROM [Auct_AuctionBidder_Ex] aucbid 
            LEFT JOIN [Auct_Bidder_Ex] bid 
                ON aucbid.[BidderID]=bid.[BidderID]
            ) AS temp1 
            WHERE COALESCE([CustomerAccountID], [AuctionID]) IS NOT NULL
                AND [AuctionID] IN (SELECT DISTINCT [AuctionID] FROM [dbo].[Auct_Auction_DM])
        ) AS temp2
    WHERE [RowNumber]=1
    GROUP BY [CustomerAccountID], [AuctionID]
)
-- SELECT * FROM Auct_Customer_ContactType_stg1 WHERE [RowNumber]>1;
-- SELECT * FROM Auct_Customer_ContactType_stg1 WHERE [CustomerAccountID]=1138 AND [AuctionID]=1
-- SELECT * FROM Auct_Customer_ContactType_stg1 ORDER BY [AuctionID], [CustomerAccountID];
-- For [ContactType] IN [Auct_ContactContact_Ex] AND [Auct_ContactType_Ex]
, Auct_Customer_ContactType_CTE2_Initial AS (
    SELECT 
        [CustomerAccountID],
        [ContactType],
        [CreatedContactType],
        [AuctionID] AS [PresumedAuctionID],
        [PreviousAuctionEnds],
        [AuctionEnds],
        ROW_NUMBER() OVER(
            PARTITION BY [CustomerAccountID], [ContactType], [CreatedContactType], [AuctionID], [PreviousAuctionEnds], [AuctionEnds]
            ORDER BY [CustomerAccountID], [ContactType], [CreatedContactType], [AuctionID], [PreviousAuctionEnds], [AuctionEnds]
        ) AS [RowNumber]
    FROM (
        SELECT 
            concon.[CustomerAccountID],
            -- (Update) conty.[Name] to conty.[ContactType]
            CASE 
                WHEN conty.[Name] IN (''ABSENTEE'')
                    THEN ''Bidder-Absentee''
                WHEN conty.[Name] IN (''AUTOMOBILIA BIDDER'')
                    THEN ''Bidder-Automobilia''
                WHEN conty.[Name] IN (''BIDDER'', ''SEASON PASS BIDDER'', ''SOCIAL BIDDER'', ''BIDDER INFO'', ''BIDDER INFO PALM BEACH'')
                    THEN ''Bidder''
                WHEN conty.[Name] IN (''VIP BIDDER'', ''VIP CUSTOMER'', ''VIP HOUSTON'', ''VIP LAS VEGAS'', ''VIP NORTHEAST'', ''VIP ORANGE COUNTY'', ''VIP PALM BEACH'', ''VIP SCOTTSDALE'', 
                                        ''VIP GUEST RENO/TAHOE'', ''VIP GUEST ALL'')
                    THEN ''Bidder-VIPPackages''
                WHEN conty.[Name] IN (''CRAIG''''S VIP GUEST'')
                    THEN ''Bidder-VIPCraigJackson''''sBox''
                WHEN conty.[Name] IN (''CONSIGNOR'', ''CONSIGNMENT INFO PALM BEACH'', ''CONSIGNMENT INFO'')
                    THEN ''Consignor''
                ELSE NULL
            END AS [ContactType],
            CASE 
                WHEN conty.[Name] IN (''ABSENTEE'', ''AUTOMOBILIA BIDDER'', ''BIDDER'', ''SEASON PASS BIDDER'', ''SOCIAL BIDDER'', ''BIDDER INFO'', ''BIDDER INFO PALM BEACH'', 
                                        ''VIP BIDDER'', ''VIP CUSTOMER'', ''VIP HOUSTON'', ''VIP LAS VEGAS'', ''VIP NORTHEAST'', ''VIP ORANGE COUNTY'', ''VIP PALM BEACH'', ''VIP SCOTTSDALE'', ''VIP GUEST RENO/TAHOE'', ''VIP GUEST ALL'', 
                                        ''CRAIG''''S VIP GUEST'', ''CONSIGNOR'', ''CONSIGNMENT INFO PALM BEACH'', ''CONSIGNMENT INFO'')
                THEN CAST(concon.[Created] AS DATETIME)
                ELSE NULL
            END AS [CreatedContactType]
        FROM [Auct_ContactContact_Ex] concon 
        LEFT JOIN [Auct_ContactType_Ex] conty
            ON concon.[ContactTypeID]=conty.[ContactTypeID]
        ) AS temp1
        ,  Auct_Auction_CTE
    WHERE [ContactType] IS NOT NULL AND [CreatedContactType] IS NOT NULL
        AND [CreatedContactType] BETWEEN [PreviousAuctionEnds] AND [AuctionEnds]
)
, Auct_Customer_ContactType_CTE2_Final AS (
    SELECT 
        [CustomerAccountID],
        [PresumedAuctionID],
        -- [ContactType],
        STRING_AGG([ContactType], '','') WITHIN GROUP (ORDER BY [MinCreatedContactType] DESC) AS [ContactType],
        [MinCreatedContactType]
    FROM (
        SELECT
            cxconty1.[CustomerAccountID],
            cxconty1.[PresumedAuctionID],
            cxconty1.[ContactType],
            cxconty1.[CreatedContactType],
            temp1.[MinCreatedContactType],
            ROW_NUMBER() OVER(
                PARTITION BY cxconty1.[CustomerAccountID], cxconty1.[PresumedAuctionID], cxconty1.[ContactType], temp1.[MinCreatedContactType]
                ORDER BY cxconty1.[CustomerAccountID], cxconty1.[PresumedAuctionID], cxconty1.[ContactType], temp1.[MinCreatedContactType]
            ) AS [NewRowNumber]
        FROM Auct_Customer_ContactType_CTE2_Initial cxconty1
        INNER JOIN (
            SELECT 
                [CustomerAccountID], 
                [PresumedAuctionID], 
                MIN([CreatedContactType]) AS [MinCreatedContactType]
            FROM Auct_Customer_ContactType_CTE2_Initial
            GROUP BY [CustomerAccountID], [PresumedAuctionID]
            ) AS temp1
        ON cxconty1.[CustomerAccountID]=temp1.[CustomerAccountID]
            AND cxconty1.[PresumedAuctionID]=temp1.[PresumedAuctionID]
        WHERE cxconty1.[RowNumber]=1
    ) AS temp2
    WHERE [NewRowNumber]=1
    GROUP BY [CustomerAccountID], [PresumedAuctionID], [MinCreatedContactType]
)
-- SELECT MAX(LEN([ContactType])) FROM Auct_Customer_ContactType_CTE2_Final; -- LEN([ContactType])=66
-- SELECT * FROM Auct_Customer_ContactType_CTE2_Final WHERE LEN([ContactType])=66;
-- SELECT [CustomerAccountID], [PresumedAuctionID], COUNT(*) FROM Auct_Customer_ContactType_CTE2_Final GROUP BY [CustomerAccountID], [PresumedAuctionID] ORDER BY COUNT(*) DESC;
, Auct_Customer_ContactType_merged_Initial AS (
    SELECT 
        [CustomerAccountID],
        [AuctionID],
        [PresumedContactType] AS [ContactType],
        [CreatedPresumedContactType] AS [CreatedContactType]
    FROM Auct_Customer_ContactType_CTE1
    WHERE [CustomerAccountID] IS NOT NULL
    UNION
    SELECT 
        [CustomerAccountID],
        [PresumedAuctionID],
        [ContactType],
        [MinCreatedContactType]
    FROM Auct_Customer_ContactType_CTE2_Final
)
, Auct_Customer_ContactType_merged_Inter AS (
    SELECT 
        [CustomerAccountID],
        [AuctionID],
        [NeedFixContactType] AS [ContactType],
        [CreatedContactType],
        ROW_NUMBER() OVER(
            PARTITION BY [CustomerAccountID], [AuctionID], [NeedFixContactType], [CreatedContactType]
            ORDER BY [CustomerAccountID], [AuctionID], [NeedFixContactType], [CreatedContactType]
        ) AS [NewRowNumber]
    FROM (
        SELECT 
            [CustomerAccountID],
            [AuctionID],
            VALUE AS [NeedFixContactType],
            [CreatedContactType]
        FROM (
            SELECT 
                [CustomerAccountID],
                [AuctionID],
                -- [ContactType],
                STRING_AGG([ContactType], '','') WITHIN GROUP (ORDER BY [MinCreatedContactType] DESC) AS [ContactType],
                [MinCreatedContactType] AS [CreatedContactType]
            FROM (
                SELECT 
                    cxcontymrg1.[CustomerAccountID],
                    cxcontymrg1.[AuctionID],
                    cxcontymrg1.[ContactType],
                    cxcontymrg1.[CreatedContactType],
                    temp1.[MinCreatedContactType],
                    ROW_NUMBER() OVER(
                        PARTITION BY cxcontymrg1.[CustomerAccountID], cxcontymrg1.[AuctionID], cxcontymrg1.[ContactType], cxcontymrg1.[CreatedContactType], temp1.[MinCreatedContactType]
                        ORDER BY cxcontymrg1.[CustomerAccountID], cxcontymrg1.[AuctionID], cxcontymrg1.[ContactType], cxcontymrg1.[CreatedContactType], temp1.[MinCreatedContactType]
                    ) AS [RowNumber]
                FROM Auct_Customer_ContactType_merged_Initial cxcontymrg1
                INNER JOIN (
                    SELECT 
                        [CustomerAccountID],
                        [AuctionID],
                        MIN([CreatedContactType]) AS [MinCreatedContactType]
                    FROM Auct_Customer_ContactType_merged_Initial
                    GROUP BY [CustomerAccountID], [AuctionID]
                    ) AS temp1 
                    ON cxcontymrg1.[CustomerAccountID]=temp1.[CustomerAccountID]
                        AND cxcontymrg1.[AuctionID]=temp1.[AuctionID]
                ) AS temp2
                WHERE [RowNumber]=1
            GROUP BY [CustomerAccountID], [AuctionID], [MinCreatedContactType]
        ) AS temp3
        OUTER APPLY STRING_SPLIT([ContactType], '','')
    ) AS temp4
)
, Auct_Customer_ContactType_merged_Pivot AS (
    SELECT
        [CustomerAccountID],
        [AuctionID],
        [CreatedContactType],
        [Consignor],
        [Bidder],
        [Bidder-VIPPackages], 
        [Bidder-VIPCraigJackson''sBox], 
        [Bidder_Absentee], 
        [Bidder-Automobilia],
        CASE WHEN [Consignor]=1 THEN 1 ELSE 0 END AS [ConsignorFlag],
        CASE WHEN COALESCE([Bidder], [Bidder-VIPPackages], [Bidder-VIPCraigJackson''sBox], [Bidder_Absentee], [Bidder-Automobilia])=1 THEN 1 ELSE 0 END AS [AuctionBidderFlag]
    FROM (
        SELECT 
            [CustomerAccountID],
            [AuctionID],
            [CreatedContactType],
            CASE WHEN [Consignor] IN (''Consignor'') THEN 1 ELSE 0 END AS [Consignor],
            CASE WHEN [Bidder] IN (''Bidder'') THEN 1 ELSE 0 END AS [Bidder],
            CASE WHEN [Bidder-VIPPackages] IN (''Bidder-VIPPackages'') THEN 1 ELSE 0 END AS [Bidder-VIPPackages],
            CASE WHEN [Bidder-VIPCraigJackson''sBox] IN (''Bidder-VIPCraigJackson''''sBox'') THEN 1 ELSE 0 END AS [Bidder-VIPCraigJackson''sBox],
            CASE WHEN [Bidder_Absentee] IN (''Bidder_Absentee'') THEN 1 ELSE 0 END AS [Bidder_Absentee],
            CASE WHEN [Bidder-Automobilia] IN (''Bidder-Automobilia'') THEN 1 ELSE 0 END AS [Bidder-Automobilia]
        FROM (
            SELECT 
                [CustomerAccountID],
                [AuctionID],
                [CreatedContactType],
                [Consignor],
                [Bidder],
                [Bidder-VIPPackages], 
                [Bidder-VIPCraigJackson''sBox], 
                [Bidder_Absentee], 
                [Bidder-Automobilia]
            FROM (
                SELECT 
                    [CustomerAccountID],
                    [AuctionID],
                    [ContactType] AS Col,
                    [ContactType] AS Val,
                    [CreatedContactType]
                FROM Auct_Customer_ContactType_merged_Inter
                WHERE [NewRowNumber]=1
                ) AS SRC1 
            -- FOR [ContactType]
            PIVOT (
                MAX(Val) FOR Col IN ([Consignor], [Bidder], [Bidder-VIPPackages], [Bidder-VIPCraigJackson''sBox], [Bidder_Absentee], [Bidder-Automobilia])
            ) AS PVT1
        ) AS temp1
    ) AS temp2
)
SELECT 
    [CustomerAccountID],
    [AuctionID],
    [CreatedContactType],
    [Consignor],
    [Bidder],
    [Bidder-VIPPackages],
    [Bidder-VIPCraigJackson''sBox],
    [Bidder_Absentee],
    [Bidder-Automobilia],
    [ConsignorFlag],
    [AuctionBidderFlag]
FROM Auct_Customer_ContactType_merged_Pivot
    ');

  CREATE TABLE "stg"."Auct_Customer_ContactType_Lookup__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.Auct_Customer_ContactType_Lookup__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."Auct_Customer_ContactType_Lookup__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Customer_ContactType_Lookup__dbt_tmp_temp_view"
    end



07:14:18.985162 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:14:18.985307 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:14:19.109307 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:14:19.110846 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:14:29.816784 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 10.83 seconds
07:14:29.836197 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Customer_ContactType_Lookup".
07:14:29.836569 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Customer_ContactType_Lookup: rename object "stg"."Auct_Customer_ContactType_Lookup" to Auct_Customer_ContactType_Lookup__dbt_backup
07:14:30.126234 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
07:14:30.241982 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Customer_ContactType_Lookup".
07:14:30.242375 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Customer_ContactType_Lookup: rename object "stg"."Auct_Customer_ContactType_Lookup__dbt_tmp" to Auct_Customer_ContactType_Lookup
07:14:30.274580 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
07:14:30.286352 [debug] [Thread-1  ]: On model.Shawn.Auct_Customer_ContactType_Lookup: COMMIT
07:14:30.293676 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Customer_ContactType_Lookup".
07:14:30.294007 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Customer_ContactType_Lookup: 
    
  if object_id ('"stg"."Auct_Customer_ContactType_Lookup__dbt_backup"','U') is not null
    begin
    drop table "stg"."Auct_Customer_ContactType_Lookup__dbt_backup"
    end

07:14:31.110911 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.82 seconds
07:14:31.123578 [debug] [Thread-1  ]: finished collecting timing info
07:14:31.124016 [debug] [Thread-1  ]: On model.Shawn.Auct_Customer_ContactType_Lookup: Close
07:14:31.124823 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4818ffa2-cd9a-455b-9aff-ec7ddf152c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7afc3b1af0>]}
07:14:31.125325 [info ] [Thread-1  ]: 1 of 2 OK created table model stg.Auct_Customer_ContactType_Lookup.............. [[32mOK[0m in 12.30s]
07:14:31.125721 [debug] [Thread-1  ]: Finished running node model.Shawn.Auct_Customer_ContactType_Lookup
07:14:37.668621 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 18.69 seconds
07:14:37.683536 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Item_BR".
07:14:37.683918 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.Auct_Item_BR: rename object "dbo"."Auct_Item_BR" to Auct_Item_BR__dbt_backup
07:14:37.720444 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
07:14:37.734219 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Item_BR".
07:14:37.734654 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.Auct_Item_BR: rename object "dbo"."Auct_Item_BR__dbt_tmp" to Auct_Item_BR
07:14:37.766808 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
07:14:37.768792 [debug] [Thread-2  ]: On model.Shawn.Auct_Item_BR: COMMIT
07:14:37.773316 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Item_BR".
07:14:37.773609 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.Auct_Item_BR: 
    
  if object_id ('"dbo"."Auct_Item_BR__dbt_backup"','U') is not null
    begin
    drop table "dbo"."Auct_Item_BR__dbt_backup"
    end

07:14:39.189722 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.42 seconds
07:14:39.203255 [debug] [Thread-2  ]: finished collecting timing info
07:14:39.203666 [debug] [Thread-2  ]: On model.Shawn.Auct_Item_BR: Close
07:14:39.204441 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4818ffa2-cd9a-455b-9aff-ec7ddf152c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7afc3d7bb0>]}
07:14:39.204927 [info ] [Thread-2  ]: 2 of 2 OK created table model dbo.Auct_Item_BR.................................. [[32mOK[0m in 20.37s]
07:14:39.205306 [debug] [Thread-2  ]: Finished running node model.Shawn.Auct_Item_BR
07:14:39.206669 [debug] [MainThread]: Acquiring new synapse connection "master"
07:14:39.207146 [debug] [MainThread]: On master: COMMIT
07:14:39.207507 [info ] [MainThread]: 
07:14:39.207762 [info ] [MainThread]: Finished running 2 table models in 43.23s.
07:14:39.207956 [debug] [MainThread]: Connection 'master' was properly closed.
07:14:39.208058 [debug] [MainThread]: Connection 'model.Shawn.Auct_Customer_ContactType_Lookup' was properly closed.
07:14:39.208151 [debug] [MainThread]: Connection 'model.Shawn.Auct_Item_BR' was properly closed.
07:14:39.297096 [info ] [MainThread]: 
07:14:39.297500 [info ] [MainThread]: [32mCompleted successfully[0m
07:14:39.297792 [info ] [MainThread]: 
07:14:39.297974 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
07:14:39.298274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7afeb1f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7afeb1ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7afc398d60>]}


============================== 2022-09-21 07:14:41.652204 | 42798f54-539c-4a70-ad4c-2bc956c80a61 ==============================
07:14:41.652204 [info ] [MainThread]: Running with dbt=1.0.0
07:14:41.658845 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/Auctioneer', record_timing_info=None, rpc_method='run', select=['step7_0'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
07:14:41.659125 [debug] [MainThread]: Tracking: tracking
07:14:41.659464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f478a178df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f478a178e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f478a178eb0>]}
07:14:42.132331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:14:42.132854 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:14:42.214004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42798f54-539c-4a70-ad4c-2bc956c80a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f478a05cb80>]}
07:14:42.462933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42798f54-539c-4a70-ad4c-2bc956c80a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47895091f0>]}
07:14:42.463515 [info ] [MainThread]: Found 1345 models, 0 tests, 354 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:14:42.492347 [info ] [MainThread]: 
07:14:42.493127 [debug] [MainThread]: Acquiring new synapse connection "master"
07:14:42.494788 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
07:14:42.503935 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
07:14:42.504173 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
07:14:42.504307 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:14:42.504454 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:14:42.804398 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:14:42.837402 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.33 seconds
07:14:42.839452 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
07:14:42.916585 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
07:14:42.922650 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
07:14:42.923050 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
07:14:42.924806 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
07:14:42.924986 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
07:14:42.925106 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:14:42.925235 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:14:42.923329 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
07:14:42.926770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:14:42.926955 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:14:43.042368 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:14:43.043137 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:14:43.113613 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
07:14:43.114689 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
07:14:43.258795 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
07:14:43.267727 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
07:14:43.346467 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
07:14:43.355690 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
07:15:05.676177 [debug] [MainThread]: On master: COMMIT
07:15:05.676888 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
07:15:05.677210 [info ] [MainThread]: 
07:15:05.680404 [debug] [Thread-1  ]: Began running node model.Shawn.Auct_Address_Merge_NoNull
07:15:05.680983 [info ] [Thread-1  ]: 1 of 3 START table model stg.Auct_Address_Merge_NoNull.......................... [RUN]
07:15:05.681501 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.Auct_Address_Merge_NoNull"
07:15:05.681674 [debug] [Thread-1  ]: Began compiling node model.Shawn.Auct_Address_Merge_NoNull
07:15:05.680741 [debug] [Thread-3  ]: Began running node model.Shawn.Auct_Phone_Merge_NoNull
07:15:05.682081 [info ] [Thread-3  ]: 3 of 3 START table model stg.Auct_Phone_Merge_NoNull............................ [RUN]
07:15:05.680641 [debug] [Thread-2  ]: Began running node model.Shawn.Auct_Email_Merge_NoNull
07:15:05.682801 [info ] [Thread-2  ]: 2 of 3 START table model stg.Auct_Email_Merge_NoNull............................ [RUN]
07:15:05.683295 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.Auct_Email_Merge_NoNull"
07:15:05.683454 [debug] [Thread-2  ]: Began compiling node model.Shawn.Auct_Email_Merge_NoNull
07:15:05.683585 [debug] [Thread-2  ]: Compiling model.Shawn.Auct_Email_Merge_NoNull
07:15:05.686404 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.Auct_Email_Merge_NoNull"
07:15:05.682521 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.Auct_Phone_Merge_NoNull"
07:15:05.686772 [debug] [Thread-3  ]: Began compiling node model.Shawn.Auct_Phone_Merge_NoNull
07:15:05.686923 [debug] [Thread-3  ]: Compiling model.Shawn.Auct_Phone_Merge_NoNull
07:15:05.689488 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.Auct_Phone_Merge_NoNull"
07:15:05.681842 [debug] [Thread-1  ]: Compiling model.Shawn.Auct_Address_Merge_NoNull
07:15:05.691990 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.Auct_Address_Merge_NoNull"
07:15:05.692535 [debug] [Thread-1  ]: finished collecting timing info
07:15:05.693108 [debug] [Thread-1  ]: Began executing node model.Shawn.Auct_Address_Merge_NoNull
07:15:05.692996 [debug] [Thread-2  ]: finished collecting timing info
07:15:05.699859 [debug] [Thread-2  ]: Began executing node model.Shawn.Auct_Email_Merge_NoNull
07:15:05.692799 [debug] [Thread-3  ]: finished collecting timing info
07:15:05.723317 [debug] [Thread-3  ]: Began executing node model.Shawn.Auct_Phone_Merge_NoNull
07:15:05.927760 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.Auct_Email_Merge_NoNull"
07:15:05.936704 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Email_Merge_NoNull".
07:15:05.936898 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.Auct_Email_Merge_NoNull: 
  
  if object_id ('"stg"."Auct_Email_Merge_NoNull__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Email_Merge_NoNull__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."Auct_Email_Merge_NoNull__dbt_tmp"','U') is not null
    begin
    drop table "stg"."Auct_Email_Merge_NoNull__dbt_tmp"
    end


   EXEC('create view stg.Auct_Email_Merge_NoNull__dbt_tmp_temp_view as
    
select * FROM [stg].[Auct_Email_Merge] where CustomerAccountID is not null  and EffectiveStartDate is not null and EffectiveEndDate is not null
    ');

  CREATE TABLE "stg"."Auct_Email_Merge_NoNull__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.Auct_Email_Merge_NoNull__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."Auct_Email_Merge_NoNull__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Email_Merge_NoNull__dbt_tmp_temp_view"
    end



07:15:05.937021 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
07:15:05.937173 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:15:05.932664 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.Auct_Address_Merge_NoNull"
07:15:05.939167 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_NoNull".
07:15:05.935986 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.Auct_Phone_Merge_NoNull"
07:15:05.939833 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Phone_Merge_NoNull".
07:15:05.939982 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_Phone_Merge_NoNull: 
  
  if object_id ('"stg"."Auct_Phone_Merge_NoNull__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Phone_Merge_NoNull__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."Auct_Phone_Merge_NoNull__dbt_tmp"','U') is not null
    begin
    drop table "stg"."Auct_Phone_Merge_NoNull__dbt_tmp"
    end


   EXEC('create view stg.Auct_Phone_Merge_NoNull__dbt_tmp_temp_view as
    
select * FROM [stg].[Auct_Phone_Merge] where CustomerAccountID is not null and EffectiveStartDate is not null and EffectiveEndDate is not null
    ');

  CREATE TABLE "stg"."Auct_Phone_Merge_NoNull__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.Auct_Phone_Merge_NoNull__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."Auct_Phone_Merge_NoNull__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Phone_Merge_NoNull__dbt_tmp_temp_view"
    end



07:15:05.940102 [debug] [Thread-3  ]: Opening a new connection, currently in state init
07:15:05.940235 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:15:05.939341 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_NoNull: 
  
  if object_id ('"stg"."Auct_Address_Merge_NoNull__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Address_Merge_NoNull__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."Auct_Address_Merge_NoNull__dbt_tmp"','U') is not null
    begin
    drop table "stg"."Auct_Address_Merge_NoNull__dbt_tmp"
    end


   EXEC('create view stg.Auct_Address_Merge_NoNull__dbt_tmp_temp_view as
    
select * FROM [stg].[Auct_Address_Merge] where CustomerAccountID is not null and EffectiveStartDate is not null and EffectiveEndDate is not null
    ');

  CREATE TABLE "stg"."Auct_Address_Merge_NoNull__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.Auct_Address_Merge_NoNull__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."Auct_Address_Merge_NoNull__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Address_Merge_NoNull__dbt_tmp_temp_view"
    end



07:15:05.941351 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:15:05.941514 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:15:06.056677 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:15:06.058590 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:15:06.060138 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:15:09.818724 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.88 seconds
07:15:09.837744 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_NoNull".
07:15:09.838111 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_NoNull: rename object "stg"."Auct_Address_Merge_NoNull" to Auct_Address_Merge_NoNull__dbt_backup
07:15:09.912273 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
07:15:09.926969 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_NoNull".
07:15:09.927355 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_NoNull: rename object "stg"."Auct_Address_Merge_NoNull__dbt_tmp" to Auct_Address_Merge_NoNull
07:15:09.968968 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
07:15:09.980600 [debug] [Thread-1  ]: On model.Shawn.Auct_Address_Merge_NoNull: COMMIT
07:15:09.987628 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Address_Merge_NoNull".
07:15:09.987953 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Address_Merge_NoNull: 
    
  if object_id ('"stg"."Auct_Address_Merge_NoNull__dbt_backup"','U') is not null
    begin
    drop table "stg"."Auct_Address_Merge_NoNull__dbt_backup"
    end

07:15:10.602264 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.61 seconds
07:15:10.615335 [debug] [Thread-1  ]: finished collecting timing info
07:15:10.615760 [debug] [Thread-1  ]: On model.Shawn.Auct_Address_Merge_NoNull: Close
07:15:10.616557 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42798f54-539c-4a70-ad4c-2bc956c80a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4783052490>]}
07:15:10.617054 [info ] [Thread-1  ]: 1 of 3 OK created table model stg.Auct_Address_Merge_NoNull..................... [[32mOK[0m in 4.94s]
07:15:10.617444 [debug] [Thread-1  ]: Finished running node model.Shawn.Auct_Address_Merge_NoNull
07:15:15.085906 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 9.15 seconds
07:15:15.101335 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Phone_Merge_NoNull".
07:15:15.101654 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_Phone_Merge_NoNull: rename object "stg"."Auct_Phone_Merge_NoNull" to Auct_Phone_Merge_NoNull__dbt_backup
07:15:15.220252 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
07:15:15.234148 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Phone_Merge_NoNull".
07:15:15.234484 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_Phone_Merge_NoNull: rename object "stg"."Auct_Phone_Merge_NoNull__dbt_tmp" to Auct_Phone_Merge_NoNull
07:15:15.269086 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
07:15:15.271092 [debug] [Thread-3  ]: On model.Shawn.Auct_Phone_Merge_NoNull: COMMIT
07:15:15.275419 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Phone_Merge_NoNull".
07:15:15.275643 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.Auct_Phone_Merge_NoNull: 
    
  if object_id ('"stg"."Auct_Phone_Merge_NoNull__dbt_backup"','U') is not null
    begin
    drop table "stg"."Auct_Phone_Merge_NoNull__dbt_backup"
    end

07:15:16.632271 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.36 seconds
07:15:16.645875 [debug] [Thread-3  ]: finished collecting timing info
07:15:16.646277 [debug] [Thread-3  ]: On model.Shawn.Auct_Phone_Merge_NoNull: Close
07:15:16.647043 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42798f54-539c-4a70-ad4c-2bc956c80a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f478303d490>]}
07:15:16.647513 [info ] [Thread-3  ]: 3 of 3 OK created table model stg.Auct_Phone_Merge_NoNull....................... [[32mOK[0m in 10.96s]
07:15:16.647876 [debug] [Thread-3  ]: Finished running node model.Shawn.Auct_Phone_Merge_NoNull
07:15:21.043527 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 15.11 seconds
07:15:21.058267 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Email_Merge_NoNull".
07:15:21.058651 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.Auct_Email_Merge_NoNull: rename object "stg"."Auct_Email_Merge_NoNull" to Auct_Email_Merge_NoNull__dbt_backup
07:15:21.094015 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
07:15:21.108214 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Email_Merge_NoNull".
07:15:21.108554 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.Auct_Email_Merge_NoNull: rename object "stg"."Auct_Email_Merge_NoNull__dbt_tmp" to Auct_Email_Merge_NoNull
07:15:21.145804 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
07:15:21.147790 [debug] [Thread-2  ]: On model.Shawn.Auct_Email_Merge_NoNull: COMMIT
07:15:21.151961 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Email_Merge_NoNull".
07:15:21.152169 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.Auct_Email_Merge_NoNull: 
    
  if object_id ('"stg"."Auct_Email_Merge_NoNull__dbt_backup"','U') is not null
    begin
    drop table "stg"."Auct_Email_Merge_NoNull__dbt_backup"
    end

07:15:22.698318 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.55 seconds
07:15:22.712080 [debug] [Thread-2  ]: finished collecting timing info
07:15:22.712477 [debug] [Thread-2  ]: On model.Shawn.Auct_Email_Merge_NoNull: Close
07:15:22.713218 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42798f54-539c-4a70-ad4c-2bc956c80a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f478303a8e0>]}
07:15:22.713684 [info ] [Thread-2  ]: 2 of 3 OK created table model stg.Auct_Email_Merge_NoNull....................... [[32mOK[0m in 17.03s]
07:15:22.714056 [debug] [Thread-2  ]: Finished running node model.Shawn.Auct_Email_Merge_NoNull
07:15:22.715416 [debug] [MainThread]: Acquiring new synapse connection "master"
07:15:22.715890 [debug] [MainThread]: On master: COMMIT
07:15:22.716246 [info ] [MainThread]: 
07:15:22.716497 [info ] [MainThread]: Finished running 3 table models in 40.22s.
07:15:22.716693 [debug] [MainThread]: Connection 'master' was properly closed.
07:15:22.716798 [debug] [MainThread]: Connection 'model.Shawn.Auct_Address_Merge_NoNull' was properly closed.
07:15:22.716893 [debug] [MainThread]: Connection 'model.Shawn.Auct_Email_Merge_NoNull' was properly closed.
07:15:22.716982 [debug] [MainThread]: Connection 'model.Shawn.Auct_Phone_Merge_NoNull' was properly closed.
07:15:22.895734 [info ] [MainThread]: 
07:15:22.896132 [info ] [MainThread]: [32mCompleted successfully[0m
07:15:22.896418 [info ] [MainThread]: 
07:15:22.896601 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
07:15:22.896906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4783183d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47830b8fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47830b8ee0>]}


============================== 2022-09-21 07:15:25.169744 | 86898c8d-7ac5-4f41-9c91-86af4698dd16 ==============================
07:15:25.169744 [info ] [MainThread]: Running with dbt=1.0.0
07:15:25.174971 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/Auctioneer', record_timing_info=None, rpc_method='run', select=['step7_1'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
07:15:25.175238 [debug] [MainThread]: Tracking: tracking
07:15:25.175579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3566ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3566fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3566ff70>]}
07:15:25.656452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:15:25.656982 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:15:25.740532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86898c8d-7ac5-4f41-9c91-86af4698dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef35551c10>]}
07:15:26.002084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86898c8d-7ac5-4f41-9c91-86af4698dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef348ff280>]}
07:15:26.002722 [info ] [MainThread]: Found 1345 models, 0 tests, 354 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:15:26.032270 [info ] [MainThread]: 
07:15:26.033089 [debug] [MainThread]: Acquiring new synapse connection "master"
07:15:26.034717 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
07:15:26.043999 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
07:15:26.044298 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
07:15:26.044432 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:15:26.044580 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:15:26.331336 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:15:26.374090 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.33 seconds
07:15:26.376318 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
07:15:26.452864 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
07:15:26.459226 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
07:15:26.459696 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
07:15:26.461644 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
07:15:26.461858 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
07:15:26.461983 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:15:26.462117 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:15:26.460020 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
07:15:26.463496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:15:26.463989 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:15:26.603255 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:15:26.603754 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:15:26.675953 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.21 seconds
07:15:26.676509 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.21 seconds
07:15:26.827357 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
07:15:26.840258 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
07:15:26.899801 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
07:15:26.900247 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
07:15:49.106918 [debug] [MainThread]: On master: COMMIT
07:15:49.107612 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
07:15:49.107937 [info ] [MainThread]: 
07:15:49.111563 [debug] [Thread-1  ]: Began running node model.Shawn.Auct_Customer_Archive_BR_Step1
07:15:49.111949 [info ] [Thread-1  ]: 1 of 1 START table model stg.Auct_Customer_Archive_BR_Step1..................... [RUN]
07:15:49.112445 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.Auct_Customer_Archive_BR_Step1"
07:15:49.112611 [debug] [Thread-1  ]: Began compiling node model.Shawn.Auct_Customer_Archive_BR_Step1
07:15:49.112767 [debug] [Thread-1  ]: Compiling model.Shawn.Auct_Customer_Archive_BR_Step1
07:15:49.115645 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.Auct_Customer_Archive_BR_Step1"
07:15:49.116160 [debug] [Thread-1  ]: finished collecting timing info
07:15:49.116329 [debug] [Thread-1  ]: Began executing node model.Shawn.Auct_Customer_Archive_BR_Step1
07:15:49.208958 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.Auct_Customer_Archive_BR_Step1"
07:15:49.209679 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Customer_Archive_BR_Step1".
07:15:49.209885 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Customer_Archive_BR_Step1: 
  
  if object_id ('"stg"."Auct_Customer_Archive_BR_Step1__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Customer_Archive_BR_Step1__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."Auct_Customer_Archive_BR_Step1__dbt_tmp"','U') is not null
    begin
    drop table "stg"."Auct_Customer_Archive_BR_Step1__dbt_tmp"
    end


   EXEC('create view stg.Auct_Customer_Archive_BR_Step1__dbt_tmp_temp_view as
    
-- Auct_CA_ValidDateRanges
With ValidDates AS (
    SELECT [CustomerAccountID], [EffectiveStartDate] AS [Date] FROM [stg].[Auct_Email_Merge_NoNull]
    UNION
    SELECT [CustomerAccountID], [EffectiveEndDate] AS [Date] FROM [stg].[Auct_Email_Merge_NoNull]
    UNION
    SELECT [CustomerAccountID], [EffectiveStartDate] AS [Date] FROM [stg].[Auct_Phone_Merge_NoNull]
    UNION
    SELECT [CustomerAccountID], [EffectiveEndDate] AS [Date] FROM [stg].[Auct_Phone_Merge_NoNull]
    UNION
    SELECT [CustomerAccountID], [EffectiveStartDate] AS [Date] FROM [stg].[Auct_Address_Merge_NoNull]
    UNION
    SELECT [CustomerAccountID], [EffectiveEndDate] AS [Date] FROM [stg].[Auct_Address_Merge_NoNull]
),
list as (
 SELECT 
        [CustomerAccountID],
        [EffectiveStartDate],
        [EffectiveEndDate]
    FROM (
        SELECT 
            [CustomerAccountID],
            [Date] AS [EffectiveStartDate],
            LEAD([Date], 1) OVER(
                                PARTITION BY [CustomerAccountID]
                                ORDER BY [Date]
            ) AS [EffectiveEndDate]
        FROM ValidDates
        ) AS temp1
    WHERE [EffectiveEndDate] IS NOT NULL 

)

select * from list
    ');

  CREATE TABLE "stg"."Auct_Customer_Archive_BR_Step1__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.Auct_Customer_Archive_BR_Step1__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."Auct_Customer_Archive_BR_Step1__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."Auct_Customer_Archive_BR_Step1__dbt_tmp_temp_view"
    end



07:15:49.210016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:15:49.210161 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
07:15:49.327071 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
07:16:11.922985 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 22.71 seconds
07:16:12.026240 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Customer_Archive_BR_Step1".
07:16:12.026626 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Customer_Archive_BR_Step1: rename object "stg"."Auct_Customer_Archive_BR_Step1" to Auct_Customer_Archive_BR_Step1__dbt_backup
07:16:12.292426 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
07:16:12.305553 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Customer_Archive_BR_Step1".
07:16:12.305885 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Customer_Archive_BR_Step1: rename object "stg"."Auct_Customer_Archive_BR_Step1__dbt_tmp" to Auct_Customer_Archive_BR_Step1
07:16:12.338616 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
07:16:12.349729 [debug] [Thread-1  ]: On model.Shawn.Auct_Customer_Archive_BR_Step1: COMMIT
07:16:12.356734 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.Auct_Customer_Archive_BR_Step1".
07:16:12.357056 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.Auct_Customer_Archive_BR_Step1: 
    
  if object_id ('"stg"."Auct_Customer_Archive_BR_Step1__dbt_backup"','U') is not null
    begin
    drop table "stg"."Auct_Customer_Archive_BR_Step1__dbt_backup"
    end

07:16:13.345529 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.99 seconds
07:16:13.358630 [debug] [Thread-1  ]: finished collecting timing info
07:16:13.359002 [debug] [Thread-1  ]: On model.Shawn.Auct_Customer_Archive_BR_Step1: Close
07:16:13.359747 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86898c8d-7ac5-4f41-9c91-86af4698dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3263e790>]}
07:16:13.360236 [info ] [Thread-1  ]: 1 of 1 OK created table model stg.Auct_Customer_Archive_BR_Step1................ [[32mOK[0m in 24.25s]
07:16:13.360616 [debug] [Thread-1  ]: Finished running node model.Shawn.Auct_Customer_Archive_BR_Step1
07:16:13.361874 [debug] [MainThread]: Acquiring new synapse connection "master"
07:16:13.362374 [debug] [MainThread]: On master: COMMIT
07:16:13.362725 [info ] [MainThread]: 
07:16:13.362998 [info ] [MainThread]: Finished running 1 table model in 47.33s.
07:16:13.363195 [debug] [MainThread]: Connection 'master' was properly closed.
07:16:13.363301 [debug] [MainThread]: Connection 'model.Shawn.Auct_Customer_Archive_BR_Step1' was properly closed.
07:16:13.363399 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
07:16:13.453217 [info ] [MainThread]: 
07:16:13.453618 [info ] [MainThread]: [32mCompleted successfully[0m
07:16:13.453916 [info ] [MainThread]: 
07:16:13.454103 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
07:16:13.454413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef351d5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef35233bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3259ca30>]}
