

============================== 2022-09-18 21:19:37.071053 | 1a59a2cc-cfb9-4f66-98fd-f7907ee07ae9 ==============================
21:19:37.071053 [info ] [MainThread]: Running with dbt=1.0.0
21:19:37.071681 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step2_Incr'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
21:19:37.071906 [debug] [MainThread]: Tracking: tracking
21:19:37.072248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf58386dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf58386430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf58386f70>]}
21:19:37.105678 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
21:19:37.106101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1a59a2cc-cfb9-4f66-98fd-f7907ee07ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5833b340>]}
21:19:37.232962 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
21:19:37.234504 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
21:19:37.240427 [debug] [MainThread]: Parsing macros/materializations/seeds/str_replace.sql
21:19:37.241329 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
21:19:37.246769 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
21:19:37.248323 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
21:19:37.251045 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
21:19:37.251764 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
21:19:37.253712 [debug] [MainThread]: Parsing macros/adapters/columns.sql
21:19:37.258165 [debug] [MainThread]: Parsing macros/adapters/relation.sql
21:19:37.261111 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
21:19:37.267127 [debug] [MainThread]: Parsing macros/adapters/schema.sql
21:19:37.268077 [debug] [MainThread]: Parsing macros/adapters.sql
21:19:37.268286 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
21:19:37.273124 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
21:19:37.274357 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
21:19:37.281351 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
21:19:37.283171 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
21:19:37.283848 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
21:19:37.285248 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
21:19:37.289470 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
21:19:37.291969 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
21:19:37.293375 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
21:19:37.293837 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
21:19:37.294038 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
21:19:37.298600 [debug] [MainThread]: Parsing macros/adapters/columns.sql
21:19:37.303139 [debug] [MainThread]: Parsing macros/adapters/relation.sql
21:19:37.308444 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
21:19:37.317309 [debug] [MainThread]: Parsing macros/adapters/schema.sql
21:19:37.320438 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
21:19:37.324539 [debug] [MainThread]: Parsing macros/materializations/configs.sql
21:19:37.326947 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
21:19:37.328820 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
21:19:37.333217 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
21:19:37.335058 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
21:19:37.341186 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
21:19:37.357247 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
21:19:37.369070 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
21:19:37.370979 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
21:19:37.387662 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
21:19:37.398959 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
21:19:37.403601 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
21:19:37.415019 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
21:19:37.425193 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
21:19:37.426967 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
21:19:37.442440 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
21:19:37.449995 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
21:19:37.453075 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
21:19:37.455522 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
21:19:37.458206 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
21:19:37.465312 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
21:19:37.466720 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
21:19:37.467484 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
21:19:37.468886 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
21:19:37.469499 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
21:19:37.470412 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
21:19:37.473370 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
21:19:37.477802 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
21:19:37.485483 [debug] [MainThread]: Parsing macros/adapters/columns.sql
21:19:37.495179 [debug] [MainThread]: Parsing macros/adapters/relation.sql
21:19:37.504808 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
21:19:37.507669 [debug] [MainThread]: Parsing macros/adapters/schema.sql
21:19:37.509923 [debug] [MainThread]: Parsing macros/etc/datetime.sql
21:19:37.518584 [debug] [MainThread]: Parsing macros/etc/statement.sql
21:19:37.523055 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
21:19:37.524710 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
21:19:37.527228 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
21:19:37.528796 [debug] [MainThread]: Parsing tests/generic/builtin.sql
21:19:37.747062 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Tiers.sql
21:19:37.757935 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Categories.sql
21:19:37.760288 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Events.sql
21:19:37.762521 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Locations.sql
21:19:37.764692 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingsReserveHistory.sql
21:19:37.767063 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingPaymentCharge.sql
21:19:37.769096 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserMessages.sql
21:19:37.771130 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ReListHistory.sql
21:19:37.773120 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypeproperties.sql
21:19:37.775129 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UnProcessedQueueMessages.sql
21:19:37.777387 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryCustomFields.sql
21:19:37.779362 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Feeschedules.sql
21:19:37.781309 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryListings.sql
21:19:37.783284 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_LogentriesBuffer.sql
21:19:37.785236 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_DailyhuntEmailSubscribers.sql
21:19:37.787204 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Languages.sql
21:19:37.789409 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Reports.sql
21:19:37.791364 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserAlerts.sql
21:19:37.793307 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Propertybags.sql
21:19:37.795271 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingQuestions.sql
21:19:37.797325 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Countries.sql
21:19:37.799540 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingMedias.sql
21:19:37.801465 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Feedbacks.sql
21:19:37.803455 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Invoices.sql
21:19:37.805411 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ExternalUserIDs.sql
21:19:37.807458 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Listings.sql
21:19:37.809405 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_MediaassetMetaData.sql
21:19:37.812172 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ShippingOptions.sql
21:19:37.814132 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingLocations.sql
21:19:37.816080 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Siteproperties.sql
21:19:37.818004 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SMStemplates.sql
21:19:37.819999 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedCategoryMap.sql
21:19:37.822203 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PaymentprovIDErs.sql
21:19:37.824158 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_States.sql
21:19:37.826075 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Increments.sql
21:19:37.828007 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ThReadTracking.sql
21:19:37.829947 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserOptOut.sql
21:19:37.831908 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Attributes.sql
21:19:37.834096 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingEnddttmAudit.sql
21:19:37.836045 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ShippingMethods.sql
21:19:37.837976 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingActions.sql
21:19:37.839939 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_BannerCategories.sql
21:19:37.841904 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Logentries.sql
21:19:37.844123 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Properties.sql
21:19:37.846050 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_BiddingTransactions.sql
21:19:37.848979 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Banners.sql
21:19:37.852547 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Contents.sql
21:19:37.854615 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedUserMap.sql
21:19:37.856579 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SalesTaxRates.sql
21:19:37.862194 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Notifications.sql
21:19:37.865333 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Feeproperties.sql
21:19:37.867360 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypeFeeprovIDErs.sql
21:19:37.870112 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_AuctionEventMedias.sql
21:19:37.873150 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_AuctionEvents.sql
21:19:37.875483 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Emailtemplates.sql
21:19:37.877438 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Addresses.sql
21:19:37.879453 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Media.sql
21:19:37.881389 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SubmittedListingPayment.sql
21:19:37.883362 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CustomFields.sql
21:19:37.885343 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_MediaMetaData.sql
21:19:37.887582 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SysDiagrams.sql
21:19:37.889492 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Lots.sql
21:19:37.891463 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CreditCardTypes.sql
21:19:37.893383 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Listingdecorations.sql
21:19:37.895365 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_KeyTable.sql
21:19:37.897538 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Watches.sql
21:19:37.899474 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_StripeCustomers.sql
21:19:37.901393 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PropertybagItems.sql
21:19:37.903364 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Version.sql
21:19:37.905282 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserLogins.sql
21:19:37.907245 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Userclaims.sql
21:19:37.909415 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Logstats.sql
21:19:37.911351 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Customcurrencies.sql
21:19:37.913272 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Userproperties.sql
21:19:37.915429 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_LineItems.sql
21:19:37.917366 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingActionproperties.sql
21:19:37.919591 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryCount.sql
21:19:37.921526 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedregionMap.sql
21:19:37.923477 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_NewSalestoInvoice.sql
21:19:37.925404 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Offers.sql
21:19:37.927350 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Mediaassets.sql
21:19:37.929273 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Currencies.sql
21:19:37.931464 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Users.sql
21:19:37.933372 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserRoles.sql
21:19:37.935311 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryListingTypes.sql
21:19:37.937243 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingCommentsMedias.sql
21:19:37.939191 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypeMedia.sql
21:19:37.941390 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SMStemplatecontents.sql
21:19:37.943333 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PaymentResponses.sql
21:19:37.945262 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CustomFieldenums.sql
21:19:37.947206 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Decorations.sql
21:19:37.949116 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypes.sql
21:19:37.951088 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Emailtemplatecontents.sql
21:19:37.953490 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CreditCards.sql
21:19:37.955429 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Mediavariations.sql
21:19:37.957335 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Roles.sql
21:19:37.959272 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingComments.sql
21:19:37.961313 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Contactus.sql
21:19:37.963541 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Model.sql
21:19:37.965482 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PaymentConfigurationTable.sql
21:19:37.967423 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedListingsMap.sql
21:19:37.969338 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Listingproperties.sql
21:19:37.971369 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Eventproperties.sql
21:19:37.973309 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CreditCardsExtraInFormation.sql
21:19:37.975602 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_BannedUsers.sql
21:19:37.977793 [debug] [MainThread]: 1603: static parser failed on tmp/SZ_AH_Properties_Pivot_Full.sql
21:19:37.994442 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/SZ_AH_Properties_Pivot_Full.sql
21:19:37.996185 [debug] [MainThread]: 1699: static parser successfully parsed step8_4_FT/AH_Listings_FT.sql
21:19:37.998451 [debug] [MainThread]: 1603: static parser failed on step7_3/SZ_AH_AllProperties_One_Column.sql
21:19:38.005269 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step7_3/SZ_AH_AllProperties_One_Column.sql
21:19:38.006599 [debug] [MainThread]: 1699: static parser successfully parsed step7_3/SZ_AH_Properties_CustomFields_Lookup.sql
21:19:38.008938 [debug] [MainThread]: 1699: static parser successfully parsed step8_2_FT_stg/AH_Listings_FT_stg.sql
21:19:38.011092 [debug] [MainThread]: 1603: static parser failed on step7_2/SZ_AH_Properties_Value_ColumnMapping.sql
21:19:38.016459 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step7_2/SZ_AH_Properties_Value_ColumnMapping.sql
21:19:38.017612 [debug] [MainThread]: 1699: static parser successfully parsed step7_1/SZ_AH_Properties_FieldType.sql
21:19:38.019610 [debug] [MainThread]: 1699: static parser successfully parsed step7_1/SZ_AH_Properties_FieldIDs.sql
21:19:38.021629 [debug] [MainThread]: 1603: static parser failed on step2_Incr/AH_UserLogins_Incr.sql
21:19:38.029394 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step2_Incr/AH_UserLogins_Incr.sql
21:19:38.030709 [debug] [MainThread]: 1603: static parser failed on step2_Incr/AH_CreditCards_Incr.sql
21:19:38.034825 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step2_Incr/AH_CreditCards_Incr.sql
21:19:38.036042 [debug] [MainThread]: 1603: static parser failed on step2_Incr/AH_Logstats_Incr.sql
21:19:38.039863 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step2_Incr/AH_Logstats_Incr.sql
21:19:38.041055 [debug] [MainThread]: 1603: static parser failed on step2_Incr/AH_UnProcessedQueueMessages_Incr.sql
21:19:38.044902 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step2_Incr/AH_UnProcessedQueueMessages_Incr.sql
21:19:38.046205 [debug] [MainThread]: 1603: static parser failed on step7_4/SZ_AH_Properties_Pivot.sql
21:19:38.054078 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step7_4/SZ_AH_Properties_Pivot.sql
21:19:38.055461 [debug] [MainThread]: 1699: static parser successfully parsed step8_1_DM/AH_Cars_DM.sql
21:19:38.057631 [debug] [MainThread]: 1699: static parser successfully parsed step8_3_FT_tmp/AH_Listings_FT_tmp.sql
21:19:38.061110 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_ListingActions_FT_stg.sql
21:19:38.063137 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_Watches_FT_stg.sql
21:19:38.065134 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_Invoices_FT_stg.sql
21:19:38.067123 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_LineItems_FT_stg.sql
21:19:38.069073 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_ListingPaymentCharge_FT_stg.sql
21:19:38.071036 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_SubmittedListingPayment_FT_stg.sql
21:19:38.073193 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_LineItems_FT_tmp.sql
21:19:38.075181 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_SubmittedListingPayment_FT_tmp.sql
21:19:38.077106 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_Invoices_FT_tmp.sql
21:19:38.079079 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_Watches_FT_tmp.sql
21:19:38.081012 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_ListingActions_FT_tmp.sql
21:19:38.083234 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_ListingPaymentCharge_FT_tmp.sql
21:19:38.085183 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Users_InterView.sql
21:19:38.087161 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_BannerCategories_InterView.sql
21:19:38.089120 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Events_InterView.sql
21:19:38.091092 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Logstats_InterView.sql
21:19:38.093120 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Attributes_InterView.sql
21:19:38.095330 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserRoles_InterView.sql
21:19:38.097237 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Locations_InterView.sql
21:19:38.099212 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Mediavariations_InterView.sql
21:19:38.101124 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SalesTaxRates_InterView.sql
21:19:38.103059 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CustomFieldenums_InterView.sql
21:19:38.105243 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ImportedUserMap_InterView.sql
21:19:38.107170 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Increments_InterView.sql
21:19:38.109081 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Customcurrencies_InterView.sql
21:19:38.111058 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Lots_InterView.sql
21:19:38.112962 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Contactus_InterView.sql
21:19:38.114975 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SMStemplates_InterView.sql
21:19:38.117307 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_BannedUsers_InterView.sql
21:19:38.119345 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Userproperties_InterView.sql
21:19:38.121246 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CreditCards_InterView.sql
21:19:38.123749 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Offers_InterView.sql
21:19:38.125673 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_PropertybagItems_InterView.sql
21:19:38.127957 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingActionproperties_InterView.sql
21:19:38.129885 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_States_InterView.sql
21:19:38.131856 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CategoryCustomFields_InterView.sql
21:19:38.133779 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingComments_InterView.sql
21:19:38.135734 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CustomFields_InterView.sql
21:19:38.137650 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Version_InterView.sql
21:19:38.139863 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Categories_InterView.sql
21:19:38.141777 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_MediaMetaData_InterView.sql
21:19:38.143766 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingsReserveHistory_InterView.sql
21:19:38.145684 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingTypes_InterView.sql
21:19:38.147618 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingTypeFeeprovIDErs_InterView.sql
21:19:38.149800 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CreditCardsExtraInFormation_InterView.sql
21:19:38.151722 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_PaymentprovIDErs_InterView.sql
21:19:38.153627 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingLocations_InterView.sql
21:19:38.155563 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Banners_InterView.sql
21:19:38.157487 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Eventproperties_InterView.sql
21:19:38.159431 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingCommentsMedias_InterView.sql
21:19:38.161619 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Languages_InterView.sql
21:19:38.163594 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Emailtemplatecontents_InterView.sql
21:19:38.165526 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Feedbacks_InterView.sql
21:19:38.167475 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_AuctionEvents_InterView.sql
21:19:38.169372 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SubmittedListingPayment_InterView.sql
21:19:38.171564 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_AuctionEventMedias_InterView.sql
21:19:38.173472 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingQuestions_InterView.sql
21:19:38.175466 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ShippingOptions_InterView.sql
21:19:38.177392 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Contents_InterView.sql
21:19:38.179323 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ImportedListingsMap_InterView.sql
21:19:38.181227 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Properties_InterView.sql
21:19:38.183402 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Listingdecorations_InterView.sql
21:19:38.185322 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Feeschedules_InterView.sql
21:19:38.187250 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ImportedCategoryMap_InterView.sql
21:19:38.189157 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Emailtemplates_InterView.sql
21:19:38.191083 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Reports_InterView.sql
21:19:38.193508 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CreditCardTypes_InterView.sql
21:19:38.195456 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserAlerts_InterView.sql
21:19:38.197371 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingTypeMedia_InterView.sql
21:19:38.199314 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ExternalUserIDs_InterView.sql
21:19:38.201214 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ThReadTracking_InterView.sql
21:19:38.203184 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ShippingMethods_InterView.sql
21:19:38.205404 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Invoices_InterView.sql
21:19:38.207367 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_MediaassetMetaData_InterView.sql
21:19:38.209281 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Propertybags_InterView.sql
21:19:38.211213 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingPaymentCharge_InterView.sql
21:19:38.213106 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingTypeproperties_InterView.sql
21:19:38.215330 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Logentries_InterView.sql
21:19:38.217236 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Listings_InterView.sql
21:19:38.219184 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Notifications_InterView.sql
21:19:38.221105 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingActions_InterView.sql
21:19:38.223057 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_KeyTable_InterView.sql
21:19:38.224983 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Watches_InterView.sql
21:19:38.227206 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Siteproperties_InterView.sql
21:19:38.229150 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserOptOut_InterView.sql
21:19:38.231083 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_BiddingTransactions_InterView.sql
21:19:38.232984 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SysDiagrams_InterView.sql
21:19:38.235033 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Tiers_InterView.sql
21:19:38.237420 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_PaymentConfigurationTable_InterView.sql
21:19:38.239378 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Userclaims_InterView.sql
21:19:38.241306 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserLogins_InterView.sql
21:19:38.243261 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ImportedregionMap_InterView.sql
21:19:38.245233 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Countries_InterView.sql
21:19:38.247209 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_LineItems_InterView.sql
21:19:38.249436 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UnProcessedQueueMessages_InterView.sql
21:19:38.251386 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CategoryCount_InterView.sql
21:19:38.253293 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_StripeCustomers_InterView.sql
21:19:38.255230 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserMessages_InterView.sql
21:19:38.257162 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Decorations_InterView.sql
21:19:38.259381 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Model_InterView.sql
21:19:38.261272 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Addresses_InterView.sql
21:19:38.263200 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Mediaassets_InterView.sql
21:19:38.265106 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Roles_InterView.sql
21:19:38.267059 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_NewSalestoInvoice_InterView.sql
21:19:38.268971 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CategoryListingTypes_InterView.sql
21:19:38.271184 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ReListHistory_InterView.sql
21:19:38.273089 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Listingproperties_InterView.sql
21:19:38.275021 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Feeproperties_InterView.sql
21:19:38.276915 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Currencies_InterView.sql
21:19:38.278866 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingMedias_InterView.sql
21:19:38.281034 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Media_InterView.sql
21:19:38.282960 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingEnddttmAudit_InterView.sql
21:19:38.284879 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_PaymentResponses_InterView.sql
21:19:38.286827 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CategoryListings_InterView.sql
21:19:38.288747 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_LogentriesBuffer_InterView.sql
21:19:38.290679 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_DailyhuntEmailSubscribers_InterView.sql
21:19:38.292827 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SMStemplatecontents_InterView.sql
21:19:38.294777 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Siteproperties_FinalView.sql
21:19:38.296677 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Feeschedules_FinalView.sql
21:19:38.298600 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Properties_FinalView.sql
21:19:38.300520 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Logentries_FinalView.sql
21:19:38.302732 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Userclaims_FinalView.sql
21:19:38.304652 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserOptOut_FinalView.sql
21:19:38.306586 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CreditCardTypes_FinalView.sql
21:19:38.308520 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_KeyTable_FinalView.sql
21:19:38.310445 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Invoices_FinalView.sql
21:19:38.312383 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_LineItems_FinalView.sql
21:19:38.314582 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Propertybags_FinalView.sql
21:19:38.316701 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Contactus_FinalView.sql
21:19:38.318654 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Currencies_FinalView.sql
21:19:38.320565 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Users_FinalView.sql
21:19:38.322483 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserMessages_FinalView.sql
21:19:38.324940 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Addresses_FinalView.sql
21:19:38.326893 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Listingdecorations_FinalView.sql
21:19:38.328777 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Roles_FinalView.sql
21:19:38.330697 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Watches_FinalView.sql
21:19:38.332597 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingTypeMedia_FinalView.sql
21:19:38.334531 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_PaymentResponses_FinalView.sql
21:19:38.336764 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SubmittedListingPayment_FinalView.sql
21:19:38.338685 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ExternalUserIDs_FinalView.sql
21:19:38.340575 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SalesTaxRates_FinalView.sql
21:19:38.342469 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserLogins_FinalView.sql
21:19:38.344399 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CustomFields_FinalView.sql
21:19:38.347014 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_BiddingTransactions_FinalView.sql
21:19:38.349072 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Emailtemplates_FinalView.sql
21:19:38.350989 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ImportedregionMap_FinalView.sql
21:19:38.352886 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_BannerCategories_FinalView.sql
21:19:38.354837 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingActions_FinalView.sql
21:19:38.356749 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ShippingOptions_FinalView.sql
21:19:38.358921 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Contents_FinalView.sql
21:19:38.360841 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingActionproperties_FinalView.sql
21:19:38.362773 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ReListHistory_FinalView.sql
21:19:38.364802 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ShippingMethods_FinalView.sql
21:19:38.366778 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Offers_FinalView.sql
21:19:38.368953 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CustomFieldenums_FinalView.sql
21:19:38.370864 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Emailtemplatecontents_FinalView.sql
21:19:38.372755 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Mediavariations_FinalView.sql
21:19:38.374691 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CategoryListingTypes_FinalView.sql
21:19:38.376609 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CategoryCustomFields_FinalView.sql
21:19:38.378526 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingPaymentCharge_FinalView.sql
21:19:38.380712 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Userproperties_FinalView.sql
21:19:38.382647 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Feeproperties_FinalView.sql
21:19:38.384566 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ImportedCategoryMap_FinalView.sql
21:19:38.386459 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingTypeFeeprovIDErs_FinalView.sql
21:19:38.388401 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingEnddttmAudit_FinalView.sql
21:19:38.390629 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_MediaassetMetaData_FinalView.sql
21:19:38.392527 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Listings_FinalView.sql
21:19:38.394445 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Mediaassets_FinalView.sql
21:19:38.396388 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Media_FinalView.sql
21:19:38.398307 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_AuctionEvents_FinalView.sql
21:19:38.400286 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Locations_FinalView.sql
21:19:38.402424 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CategoryCount_FinalView.sql
21:19:38.404382 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingLocations_FinalView.sql
21:19:38.406312 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SMStemplatecontents_FinalView.sql
21:19:38.408256 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingQuestions_FinalView.sql
21:19:38.410172 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CategoryListings_FinalView.sql
21:19:38.412409 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Feedbacks_FinalView.sql
21:19:38.414323 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Lots_FinalView.sql
21:19:38.416250 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SMStemplates_FinalView.sql
21:19:38.418156 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Reports_FinalView.sql
21:19:38.420099 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Countries_FinalView.sql
21:19:38.422012 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Eventproperties_FinalView.sql
21:19:38.424204 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingCommentsMedias_FinalView.sql
21:19:38.426127 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_States_FinalView.sql
21:19:38.428046 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_PaymentConfigurationTable_FinalView.sql
21:19:38.429943 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SysDiagrams_FinalView.sql
21:19:38.431897 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserRoles_FinalView.sql
21:19:38.434083 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_AuctionEventMedias_FinalView.sql
21:19:38.436005 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Listingproperties_FinalView.sql
21:19:38.437899 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserAlerts_FinalView.sql
21:19:38.439908 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingTypeproperties_FinalView.sql
21:19:38.441828 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CreditCardsExtraInFormation_FinalView.sql
21:19:38.443773 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_NewSalestoInvoice_FinalView.sql
21:19:38.446054 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Customcurrencies_FinalView.sql
21:19:38.448082 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_DailyhuntEmailSubscribers_FinalView.sql
21:19:38.450167 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Events_FinalView.sql
21:19:38.452150 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ImportedListingsMap_FinalView.sql
21:19:38.454076 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_BannedUsers_FinalView.sql
21:19:38.456508 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_MediaMetaData_FinalView.sql
21:19:38.458413 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Notifications_FinalView.sql
21:19:38.460331 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingsReserveHistory_FinalView.sql
21:19:38.462219 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Decorations_FinalView.sql
21:19:38.464158 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Attributes_FinalView.sql
21:19:38.466092 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Tiers_FinalView.sql
21:19:38.468268 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Model_FinalView.sql
21:19:38.470172 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_PaymentprovIDErs_FinalView.sql
21:19:38.472077 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingMedias_FinalView.sql
21:19:38.473982 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ImportedUserMap_FinalView.sql
21:19:38.475931 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingComments_FinalView.sql
21:19:38.478115 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Logstats_FinalView.sql
21:19:38.480041 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UnProcessedQueueMessages_FinalView.sql
21:19:38.481947 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ThReadTracking_FinalView.sql
21:19:38.483892 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_PropertybagItems_FinalView.sql
21:19:38.485817 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CreditCards_FinalView.sql
21:19:38.487776 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Version_FinalView.sql
21:19:38.489914 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_LogentriesBuffer_FinalView.sql
21:19:38.491832 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingTypes_FinalView.sql
21:19:38.493727 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Increments_FinalView.sql
21:19:38.495677 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Categories_FinalView.sql
21:19:38.497575 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Banners_FinalView.sql
21:19:38.499722 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Languages_FinalView.sql
21:19:38.501601 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_StripeCustomers_FinalView.sql
21:19:38.503523 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_ListingPaymentCharge_FT.sql
21:19:38.505426 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_Watches_FT.sql
21:19:38.507343 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_LineItems_FT.sql
21:19:38.509282 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_Invoice_FT.sql
21:19:38.511414 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_ListingActions_FT.sql
21:19:38.513306 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_SubmittedListingPayment_FT.sql
21:19:38.515427 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_Currencies_DM.sql
21:19:38.517307 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_ShippingOptions_DM.sql
21:19:38.519326 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_Buyers_DM.sql
21:19:38.521492 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_Categories_DM.sql
21:19:38.523490 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_Consignors_DM.sql
21:19:39.057953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a59a2cc-cfb9-4f66-98fd-f7907ee07ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf58824040>]}
21:19:39.105186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a59a2cc-cfb9-4f66-98fd-f7907ee07ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5881be20>]}
21:19:39.105638 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:19:39.113242 [info ] [MainThread]: 
21:19:39.113801 [debug] [MainThread]: Acquiring new synapse connection "master"
21:19:39.114939 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
21:19:39.120402 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
21:19:39.120593 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
21:19:39.120721 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:19:39.120858 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:19:39.406121 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:19:39.443530 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.32 seconds
21:19:39.445456 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
21:19:39.467331 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
21:19:39.473289 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
21:19:39.473825 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
21:19:39.475799 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
21:19:39.475984 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
21:19:39.476105 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:19:39.476238 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:19:39.474015 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
21:19:39.477744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:19:39.477916 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:19:39.612291 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:19:39.614316 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:19:39.679990 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:19:39.684654 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:19:39.743303 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
21:19:39.755705 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
21:19:39.798847 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
21:19:39.808121 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
21:20:01.105159 [debug] [MainThread]: On master: COMMIT
21:20:01.105862 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
21:20:01.106181 [info ] [MainThread]: 
21:20:01.109876 [debug] [Thread-1  ]: Began running node model.Shawn.AH_CreditCards_Incr
21:20:01.110115 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Logstats_Incr
21:20:01.110819 [info ] [Thread-2  ]: 2 of 4 START incremental model stg.AH_Logstats_Incr............................. [RUN]
21:20:01.111304 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Logstats_Incr"
21:20:01.111477 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Logstats_Incr
21:20:01.111629 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Logstats_Incr
21:20:01.110287 [debug] [Thread-4  ]: Began running node model.Shawn.AH_UserLogins_Incr
21:20:01.119937 [info ] [Thread-4  ]: 4 of 4 START incremental model stg.AH_UserLogins_Incr........................... [RUN]
21:20:01.120497 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_UserLogins_Incr"
21:20:01.120665 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_UserLogins_Incr
21:20:01.120802 [debug] [Thread-4  ]: Compiling model.Shawn.AH_UserLogins_Incr
21:20:01.110519 [info ] [Thread-1  ]: 1 of 4 START incremental model stg.AH_CreditCards_Incr.......................... [RUN]
21:20:01.110208 [debug] [Thread-3  ]: Began running node model.Shawn.AH_UnProcessedQueueMessages_Incr
21:20:01.151868 [info ] [Thread-3  ]: 3 of 4 START incremental model stg.AH_UnProcessedQueueMessages_Incr............. [RUN]
21:20:01.162044 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr"
21:20:01.162289 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_UnProcessedQueueMessages_Incr
21:20:01.162442 [debug] [Thread-3  ]: Compiling model.Shawn.AH_UnProcessedQueueMessages_Incr
21:20:01.140303 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_CreditCards_Incr"
21:20:01.175008 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_CreditCards_Incr
21:20:01.175203 [debug] [Thread-1  ]: Compiling model.Shawn.AH_CreditCards_Incr
21:20:01.161447 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Logstats_Incr"
21:20:01.174777 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_UserLogins_Incr"
21:20:01.214288 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_CreditCards_Incr"
21:20:01.215066 [debug] [Thread-2  ]: finished collecting timing info
21:20:01.215530 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Logstats_Incr
21:20:01.208960 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_UnProcessedQueueMessages_Incr"
21:20:01.215286 [debug] [Thread-4  ]: finished collecting timing info
21:20:01.224202 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_UserLogins_Incr
21:20:01.224450 [debug] [Thread-1  ]: finished collecting timing info
21:20:01.261903 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_CreditCards_Incr
21:20:01.224616 [debug] [Thread-3  ]: finished collecting timing info
21:20:01.311768 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_UnProcessedQueueMessages_Incr
21:20:01.531750 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
21:20:01.552922 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    
  
  if object_id ('"stg"."AH_CreditCards_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCards_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CreditCards_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CreditCards_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CreditCards_Incr__dbt_tmp_temp_view as
    
With hashData as (
		Select
			*, HASHBYTES(''SHA2_256'', concat(Cast([ID] as varchar), [ExpirationMonth], [ExpirationYear], Cast([CreditCardTypeID] as varchar), Cast([UserID] as varchar), Cast([AddressID] as varchar), Cast([CreatedOn] as varchar), Cast([UpdatedOn] as varchar), Cast([DeletedOn] as varchar), [CardNumber], [LastUpdatedUser], [LastFourdigits], [Description])) as dbt_scd_id,
			CURRENT_TIMESTAMP as dbt_updated_at,
			CURRENT_TIMESTAMP as dbt_valid_from, 
			NULL as dbt_valid_to
		From stg.[AH_CreditCards_InterView]
	)
Select * From hashData

	where not exists 
	(
		select dbt_scd_id 
		from "BJAC_DW_PROD"."stg"."AH_CreditCards_Incr" compareData
		where hashData.dbt_scd_id=compareData.dbt_scd_id
	)

    ');

  CREATE TABLE "stg"."#AH_CreditCards_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CreditCards_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CreditCards_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCards_Incr__dbt_tmp_temp_view"
    end



  
21:20:01.553103 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:20:01.553251 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:20:01.552762 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
21:20:01.554868 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    
  
  if object_id ('"stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view as
    
With hashData as (
		Select
			*, HASHBYTES(''SHA2_256'', concat([QueueName], [QueueData], Cast([QueueOrder] as varchar))) as dbt_scd_id,
			CURRENT_TIMESTAMP as dbt_updated_at, 
			CURRENT_TIMESTAMP as dbt_valid_from, 
			NULL as dbt_valid_to
		From stg.[AH_UnProcessedQueueMessages_InterView]
	)
Select * From hashData

	where not exists 
	(
		select dbt_scd_id 
		from "BJAC_DW_PROD"."stg"."AH_UnProcessedQueueMessages_Incr" compareData
		where hashData.dbt_scd_id=compareData.dbt_scd_id
	)

    ');

  CREATE TABLE "stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view"
    end



  
21:20:01.555071 [debug] [Thread-3  ]: Opening a new connection, currently in state init
21:20:01.555246 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:20:01.550296 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
21:20:01.556236 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    
  
  if object_id ('"stg"."AH_UserLogins_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserLogins_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UserLogins_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserLogins_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UserLogins_Incr__dbt_tmp_temp_view as
    
With hashData as (
		Select
			*, HASHBYTES(''SHA2_256'', concat([LoginprovIDEr], [ProvIDErKey], Cast([UserID] as varchar))) as dbt_scd_id,
			CURRENT_TIMESTAMP as dbt_updated_at, 
			CURRENT_TIMESTAMP as dbt_valid_from, 
			NULL as dbt_valid_to
		From stg.[AH_UserLogins_InterView]
	)
Select * From hashData

	where not exists 
	(
		select dbt_scd_id 
		from "BJAC_DW_PROD"."stg"."AH_UserLogins_Incr" compareData
		where hashData.dbt_scd_id=compareData.dbt_scd_id
	)

    ');

  CREATE TABLE "stg"."#AH_UserLogins_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UserLogins_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UserLogins_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserLogins_Incr__dbt_tmp_temp_view"
    end



  
21:20:01.556385 [debug] [Thread-4  ]: Opening a new connection, currently in state init
21:20:01.556525 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:20:01.547325 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
21:20:01.557316 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    
  
  if object_id ('"stg"."AH_Logstats_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Logstats_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Logstats_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Logstats_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Logstats_Incr__dbt_tmp_temp_view as
    
With hashData as (
		Select
			*, HASHBYTES(''SHA2_256'', concat(Cast([FromDate] as varchar), Cast([RangeMinutes] as varchar), Cast([EntryCount] as varchar), Cast([IsArchived] as varchar), [Severity])) as dbt_scd_id,
			CURRENT_TIMESTAMP as dbt_updated_at, 
			CURRENT_TIMESTAMP as dbt_valid_from, 
			NULL as dbt_valid_to
		From stg.[AH_Logstats_InterView]
	)
Select * From hashData

	where not exists 
	(
		select dbt_scd_id 
		from "BJAC_DW_PROD"."stg"."AH_Logstats_Incr" compareData
		where hashData.dbt_scd_id=compareData.dbt_scd_id
	)

    ');

  CREATE TABLE "stg"."#AH_Logstats_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Logstats_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Logstats_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Logstats_Incr__dbt_tmp_temp_view"
    end



  
21:20:01.557475 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:20:01.557609 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:20:01.687896 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:20:01.695081 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:20:01.700293 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:20:01.700755 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:20:06.454161 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 4.90 seconds
21:20:06.470044 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
21:20:06.470424 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    
  if object_id ('"stg"."AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:20:06.511441 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:20:06.513119 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
21:20:06.513355 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserLogins_Incr__dbt_tmp"
    
21:20:06.566332 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 5.01 seconds
21:20:06.570006 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
21:20:06.570310 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    
  if object_id ('"stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:20:06.807536 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:20:06.809215 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
21:20:06.809475 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"
    
21:20:08.499706 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.99 seconds
21:20:08.501448 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
21:20:08.501700 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:20:08.613126 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:20:08.618495 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
21:20:08.618802 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.81 seconds
21:20:08.620171 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
21:20:08.620398 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:20:08.619031 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    
  if object_id ('"stg"."AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:20:08.703143 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:20:08.705905 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
21:20:08.706233 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    
  if object_id ('"stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:20:08.906901 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.35 seconds
21:20:08.910878 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
21:20:08.911221 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    
  if object_id ('"stg"."AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:20:08.969354 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
21:20:08.972582 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
21:20:08.972890 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserLogins_Incr'
      and table_schema = 'stg'
  
21:20:08.978825 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:20:08.981651 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
21:20:08.981941 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:20:08.983060 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
21:20:08.983235 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Logstats_Incr__dbt_tmp"
    
21:20:08.982051 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UnProcessedQueueMessages_Incr'
      and table_schema = 'stg'
  
21:20:09.045828 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:20:09.054995 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
21:20:09.055351 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserLogins_Incr'
      and table_schema = 'stg'
  
21:20:09.060506 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:20:09.064047 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
21:20:09.064340 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UnProcessedQueueMessages_Incr'
      and table_schema = 'stg'
  
21:20:09.102405 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:20:09.113942 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_UserLogins_Incr"
21:20:09.114876 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
21:20:09.115095 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
      
      
      delete from "BJAC_DW_PROD"."stg"."AH_UserLogins_Incr"
          where (
                dbt_scd_id) in (
      select (dbt_scd_id)
      from "BJAC_DW_PROD"."stg"."#AH_UserLogins_Incr__dbt_tmp"
          );

      
      

      insert into "BJAC_DW_PROD"."stg"."AH_UserLogins_Incr" ("LoginprovIDEr", "ProvIDErKey", "UserID", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")
          (
      select "LoginprovIDEr", "ProvIDErKey", "UserID", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to"
      from "BJAC_DW_PROD"."stg"."#AH_UserLogins_Incr__dbt_tmp"
          )


  
21:20:09.120890 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:20:09.123383 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_UnProcessedQueueMessages_Incr"
21:20:09.123934 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
21:20:09.124097 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
      
      
      delete from "BJAC_DW_PROD"."stg"."AH_UnProcessedQueueMessages_Incr"
          where (
                dbt_scd_id) in (
      select (dbt_scd_id)
      from "BJAC_DW_PROD"."stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"
          );

      
      

      insert into "BJAC_DW_PROD"."stg"."AH_UnProcessedQueueMessages_Incr" ("QueueName", "QueueData", "QueueOrder", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")
          (
      select "QueueName", "QueueData", "QueueOrder", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to"
      from "BJAC_DW_PROD"."stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"
          )


  
21:20:10.138774 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
21:20:10.140378 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
21:20:10.140573 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:20:10.220757 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:20:10.223870 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
21:20:10.224133 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    
  if object_id ('"stg"."AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:20:10.441243 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:20:10.444219 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
21:20:10.444498 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logstats_Incr'
      and table_schema = 'stg'
  
21:20:10.513368 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:20:10.517396 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
21:20:10.517706 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logstats_Incr'
      and table_schema = 'stg'
  
21:20:10.556550 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:20:10.559351 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Logstats_Incr"
21:20:10.559900 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
21:20:10.560074 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
      
      
      delete from "BJAC_DW_PROD"."stg"."AH_Logstats_Incr"
          where (
                dbt_scd_id) in (
      select (dbt_scd_id)
      from "BJAC_DW_PROD"."stg"."#AH_Logstats_Incr__dbt_tmp"
          );

      
      

      insert into "BJAC_DW_PROD"."stg"."AH_Logstats_Incr" ("FromDate", "RangeMinutes", "EntryCount", "IsArchived", "Severity", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")
          (
      select "FromDate", "RangeMinutes", "EntryCount", "IsArchived", "Severity", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to"
      from "BJAC_DW_PROD"."stg"."#AH_Logstats_Incr__dbt_tmp"
          )


  
21:20:11.047149 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.92 seconds
21:20:11.055346 [debug] [Thread-3  ]: On model.Shawn.AH_UnProcessedQueueMessages_Incr: COMMIT
21:20:11.068481 [debug] [Thread-3  ]: finished collecting timing info
21:20:11.068924 [debug] [Thread-3  ]: On model.Shawn.AH_UnProcessedQueueMessages_Incr: Close
21:20:11.069738 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a59a2cc-cfb9-4f66-98fd-f7907ee07ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf505706d0>]}
21:20:11.070229 [info ] [Thread-3  ]: 3 of 4 OK created incremental model stg.AH_UnProcessedQueueMessages_Incr........ [[32mOK[0m in 9.91s]
21:20:11.070662 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_UnProcessedQueueMessages_Incr
21:20:11.581235 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.47 seconds
21:20:11.583082 [debug] [Thread-4  ]: On model.Shawn.AH_UserLogins_Incr: COMMIT
21:20:11.658410 [debug] [Thread-4  ]: finished collecting timing info
21:20:11.658819 [debug] [Thread-4  ]: On model.Shawn.AH_UserLogins_Incr: Close
21:20:11.659534 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a59a2cc-cfb9-4f66-98fd-f7907ee07ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5053fa00>]}
21:20:11.660003 [info ] [Thread-4  ]: 4 of 4 OK created incremental model stg.AH_UserLogins_Incr...................... [[32mOK[0m in 10.54s]
21:20:11.660377 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_UserLogins_Incr
21:20:12.584001 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.02 seconds
21:20:12.585795 [debug] [Thread-2  ]: On model.Shawn.AH_Logstats_Incr: COMMIT
21:20:12.597394 [debug] [Thread-2  ]: finished collecting timing info
21:20:12.597715 [debug] [Thread-2  ]: On model.Shawn.AH_Logstats_Incr: Close
21:20:12.598408 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a59a2cc-cfb9-4f66-98fd-f7907ee07ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf51db3670>]}
21:20:12.598899 [info ] [Thread-2  ]: 2 of 4 OK created incremental model stg.AH_Logstats_Incr........................ [[32mOK[0m in 11.49s]
21:20:12.599252 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Logstats_Incr
21:20:19.243909 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 17.69 seconds
21:20:19.247564 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
21:20:19.247749 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    
  if object_id ('"stg"."AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:20:19.289426 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:20:19.291239 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
21:20:19.291455 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCards_Incr__dbt_tmp"
    
21:20:20.195949 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.90 seconds
21:20:20.197666 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
21:20:20.197897 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:20:20.267876 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:20:20.270412 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
21:20:20.270667 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    
  if object_id ('"stg"."AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:20:20.527551 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:20:20.530737 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
21:20:20.530994 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCards_Incr'
      and table_schema = 'stg'
  
21:20:20.622015 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:20:20.625986 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
21:20:20.626223 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCards_Incr'
      and table_schema = 'stg'
  
21:20:20.660188 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:20:20.663218 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_CreditCards_Incr"
21:20:20.663800 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
21:20:20.663976 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
      
      
      delete from "BJAC_DW_PROD"."stg"."AH_CreditCards_Incr"
          where (
                dbt_scd_id) in (
      select (dbt_scd_id)
      from "BJAC_DW_PROD"."stg"."#AH_CreditCards_Incr__dbt_tmp"
          );

      
      

      insert into "BJAC_DW_PROD"."stg"."AH_CreditCards_Incr" ("ID", "ExpirationMonth", "ExpirationYear", "CreditCardTypeID", "UserID", "AddressID", "CreatedOn", "UpdatedOn", "DeletedOn", "CardNumber", "LastUpdatedUser", "LastFourdigits", "Description", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")
          (
      select "ID", "ExpirationMonth", "ExpirationYear", "CreditCardTypeID", "UserID", "AddressID", "CreatedOn", "UpdatedOn", "DeletedOn", "CardNumber", "LastUpdatedUser", "LastFourdigits", "Description", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to"
      from "BJAC_DW_PROD"."stg"."#AH_CreditCards_Incr__dbt_tmp"
          )


  
21:20:22.142582 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.48 seconds
21:20:22.144422 [debug] [Thread-1  ]: On model.Shawn.AH_CreditCards_Incr: COMMIT
21:20:22.156793 [debug] [Thread-1  ]: finished collecting timing info
21:20:22.157107 [debug] [Thread-1  ]: On model.Shawn.AH_CreditCards_Incr: Close
21:20:22.157839 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a59a2cc-cfb9-4f66-98fd-f7907ee07ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf51eb25b0>]}
21:20:22.158303 [info ] [Thread-1  ]: 1 of 4 OK created incremental model stg.AH_CreditCards_Incr..................... [[32mOK[0m in 21.02s]
21:20:22.158681 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_CreditCards_Incr
21:20:22.160155 [debug] [MainThread]: Acquiring new synapse connection "master"
21:20:22.160464 [debug] [MainThread]: On master: COMMIT
21:20:22.160806 [info ] [MainThread]: 
21:20:22.161054 [info ] [MainThread]: Finished running 4 incremental models in 43.05s.
21:20:22.161246 [debug] [MainThread]: Connection 'master' was properly closed.
21:20:22.161350 [debug] [MainThread]: Connection 'model.Shawn.AH_Logstats_Incr' was properly closed.
21:20:22.161445 [debug] [MainThread]: Connection 'model.Shawn.AH_CreditCards_Incr' was properly closed.
21:20:22.161533 [debug] [MainThread]: Connection 'model.Shawn.AH_UserLogins_Incr' was properly closed.
21:20:22.161619 [debug] [MainThread]: Connection 'model.Shawn.AH_UnProcessedQueueMessages_Incr' was properly closed.
21:20:22.189951 [info ] [MainThread]: 
21:20:22.190307 [info ] [MainThread]: [32mCompleted successfully[0m
21:20:22.190620 [info ] [MainThread]: 
21:20:22.190813 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
21:20:22.191110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf58386e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf53e241c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf51dc2fd0>]}


============================== 2022-09-18 21:20:24.534923 | 40edc34f-cbec-4a38-9c84-8b24d68b9976 ==============================
21:20:24.534923 [info ] [MainThread]: Running with dbt=1.0.0
21:20:24.535560 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='snapshot', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='snapshot', write_json=None)
21:20:24.535811 [debug] [MainThread]: Tracking: tracking
21:20:24.536132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55bd5aee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55bd5af40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55bd5af70>]}
21:20:24.723801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:20:24.724183 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:20:24.750216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55bcde280>]}
21:20:24.798101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55dd19a00>]}
21:20:24.798578 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:20:24.810994 [info ] [MainThread]: 
21:20:24.811662 [debug] [MainThread]: Acquiring new synapse connection "master"
21:20:24.816972 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
21:20:24.826107 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
21:20:24.826317 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
21:20:24.826444 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:20:24.826614 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:20:25.304824 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:20:25.352169 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.53 seconds
21:20:25.354107 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
21:20:25.375927 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
21:20:25.381998 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
21:20:25.382648 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
21:20:25.384829 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
21:20:25.385048 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
21:20:25.385173 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:20:25.385311 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:20:25.382868 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
21:20:25.386718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:20:25.387240 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:20:25.484332 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:20:25.486764 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:20:25.552035 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:20:25.553989 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:20:25.681393 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
21:20:25.687718 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
21:20:25.732032 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
21:20:25.743886 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
21:20:47.270816 [debug] [MainThread]: On master: COMMIT
21:20:47.271504 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
21:20:47.271832 [info ] [MainThread]: 
21:20:47.276817 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Addresses_Incr
21:20:47.277484 [info ] [Thread-1  ]: 1 of 101 START snapshot stg.AH_Addresses_Incr................................... [RUN]
21:20:47.277983 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Addresses_Incr"
21:20:47.278161 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Addresses_Incr
21:20:47.278314 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Addresses_Incr
21:20:47.277175 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_AuctionEventMedias_Incr
21:20:47.281556 [info ] [Thread-3  ]: 3 of 101 START snapshot stg.AH_AuctionEventMedias_Incr.......................... [RUN]
21:20:47.282009 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr"
21:20:47.282167 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_AuctionEventMedias_Incr
21:20:47.282294 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_AuctionEventMedias_Incr
21:20:47.285131 [debug] [Thread-3  ]: finished collecting timing info
21:20:47.277070 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Attributes_Incr
21:20:47.285646 [info ] [Thread-2  ]: 2 of 101 START snapshot stg.AH_Attributes_Incr.................................. [RUN]
21:20:47.286056 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Attributes_Incr"
21:20:47.286205 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Attributes_Incr
21:20:47.286326 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Attributes_Incr
21:20:47.288648 [debug] [Thread-2  ]: finished collecting timing info
21:20:47.277252 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_AuctionEvents_Incr
21:20:47.289060 [info ] [Thread-4  ]: 4 of 101 START snapshot stg.AH_AuctionEvents_Incr............................... [RUN]
21:20:47.289463 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr"
21:20:47.289610 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_AuctionEvents_Incr
21:20:47.289727 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_AuctionEvents_Incr
21:20:47.292055 [debug] [Thread-4  ]: finished collecting timing info
21:20:47.281261 [debug] [Thread-1  ]: finished collecting timing info
21:20:47.292390 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Addresses_Incr
21:20:47.285337 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_AuctionEventMedias_Incr
21:20:47.288846 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Attributes_Incr
21:20:47.336112 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:20:47.292252 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_AuctionEvents_Incr
21:20:47.343121 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:20:47.343312 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:20:47.343432 [debug] [Thread-4  ]: Opening a new connection, currently in state init
21:20:47.343561 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:20:47.340688 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:20:47.345008 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:20:47.345179 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:20:47.333388 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:20:47.346114 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:20:47.346254 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:20:47.346375 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:20:47.340417 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:20:47.347516 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:20:47.347660 [debug] [Thread-3  ]: Opening a new connection, currently in state init
21:20:47.347784 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:20:47.465347 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:20:47.469268 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:20:47.475416 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:20:47.476000 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:20:47.501530 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:20:47.502025 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:20:47.505010 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:20:47.505167 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:20:47.639596 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:20:47.655106 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:20:47.643182 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:20:47.655460 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:20:47.645347 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:20:47.655722 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:20:47.654778 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:20:47.655988 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:20:47.686095 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:20:47.686470 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:20:47.686619 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:20:47.710812 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:20:47.695841 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:20:47.713022 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:20:47.713212 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_AuctionEvents_InterView]
        ) as __dbt_sbq
    
21:20:47.711272 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:20:47.713521 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Addresses_InterView]
        ) as __dbt_sbq
    
21:20:47.711388 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Attributes_InterView]
        ) as __dbt_sbq
    
21:20:47.709089 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:20:47.713879 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_AuctionEventMedias_InterView]
        ) as __dbt_sbq
    
21:20:47.774468 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:20:47.782616 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:20:47.782951 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:20:47.783088 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:20:47.827039 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:20:47.859717 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Addresses_Incr"
        ) as __dbt_sbq
    
21:20:47.830334 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:20:47.862199 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr"
        ) as __dbt_sbq
    
21:20:47.861780 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:20:47.862496 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr"
        ) as __dbt_sbq
    
21:20:47.865177 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:20:47.865361 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Attributes_Incr"
        ) as __dbt_sbq
    
21:20:47.915229 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:20:47.924513 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:20:47.940585 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:20:47.942521 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:20:47.942966 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr'
      and table_schema = 'stg'
  
21:20:47.942814 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr'
      and table_schema = 'stg'
  
21:20:47.948234 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:20:47.951369 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:20:47.951575 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr'
      and table_schema = 'stg'
  
21:20:48.018817 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:20:48.027926 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:20:48.039713 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:20:48.046354 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:20:48.065748 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:20:48.066498 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:20:48.066811 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
        
  
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_AuctionEventMedias_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_AuctionEventMedias_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701''), CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_AuctionEventMedias_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_temp_view"
    end



    
21:20:48.062976 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:20:48.067229 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
        
  
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_AuctionEvents_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_AuctionEvents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_AuctionEvents_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_AuctionEvents_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701''), CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SoftclosingGroupIncrementseconds != source_data.SoftclosingGroupIncrementseconds
        or
        (
            ((snapshotted_data.SoftclosingGroupIncrementseconds is null) and not (source_data.SoftclosingGroupIncrementseconds is null))
            or
            ((not snapshotted_data.SoftclosingGroupIncrementseconds is null) and (source_data.SoftclosingGroupIncrementseconds is null))
        ) or snapshotted_data.LotCount != source_data.LotCount
        or
        (
            ((snapshotted_data.LotCount is null) and not (source_data.LotCount is null))
            or
            ((not snapshotted_data.LotCount is null) and (source_data.LotCount is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.CurrencyID != source_data.CurrencyID
        or
        (
            ((snapshotted_data.CurrencyID is null) and not (source_data.CurrencyID is null))
            or
            ((not snapshotted_data.CurrencyID is null) and (source_data.CurrencyID is null))
        ) or snapshotted_data.ClosingGroupIncrementseconds != source_data.ClosingGroupIncrementseconds
        or
        (
            ((snapshotted_data.ClosingGroupIncrementseconds is null) and not (source_data.ClosingGroupIncrementseconds is null))
            or
            ((not snapshotted_data.ClosingGroupIncrementseconds is null) and (source_data.ClosingGroupIncrementseconds is null))
        ) or snapshotted_data.CurrentclosingGroup != source_data.CurrentclosingGroup
        or
        (
            ((snapshotted_data.CurrentclosingGroup is null) and not (source_data.CurrentclosingGroup is null))
            or
            ((not snapshotted_data.CurrentclosingGroup is null) and (source_data.CurrentclosingGroup is null))
        ) or snapshotted_data.CurrentSoftclosingGroup != source_data.CurrentSoftclosingGroup
        or
        (
            ((snapshotted_data.CurrentSoftclosingGroup is null) and not (source_data.CurrentSoftclosingGroup is null))
            or
            ((not snapshotted_data.CurrentSoftclosingGroup is null) and (source_data.CurrentSoftclosingGroup is null))
        ) or snapshotted_data.CurrentLotOrder != source_data.CurrentLotOrder
        or
        (
            ((snapshotted_data.CurrentLotOrder is null) and not (source_data.CurrentLotOrder is null))
            or
            ((not snapshotted_data.CurrentLotOrder is null) and (source_data.CurrentLotOrder is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.ProxyBidding != source_data.ProxyBidding
        or
        (
            ((snapshotted_data.ProxyBidding is null) and not (source_data.ProxyBidding is null))
            or
            ((not snapshotted_data.ProxyBidding is null) and (source_data.ProxyBidding is null))
        ) or snapshotted_data.Published != source_data.Published
        or
        (
            ((snapshotted_data.Published is null) and not (source_data.Published is null))
            or
            ((not snapshotted_data.Published is null) and (source_data.Published is null))
        ) or snapshotted_data.PreviewLots != source_data.PreviewLots
        or
        (
            ((snapshotted_data.PreviewLots is null) and not (source_data.PreviewLots is null))
            or
            ((not snapshotted_data.PreviewLots is null) and (source_data.PreviewLots is null))
        ) or snapshotted_data.LotsTaxable != source_data.LotsTaxable
        or
        (
            ((snapshotted_data.LotsTaxable is null) and not (source_data.LotsTaxable is null))
            or
            ((not snapshotted_data.LotsTaxable is null) and (source_data.LotsTaxable is null))
        ) or snapshotted_data.FollowLiveEnabled != source_data.FollowLiveEnabled
        or
        (
            ((snapshotted_data.FollowLiveEnabled is null) and not (source_data.FollowLiveEnabled is null))
            or
            ((not snapshotted_data.FollowLiveEnabled is null) and (source_data.FollowLiveEnabled is null))
        ) or snapshotted_data.BuyersPremiumPercent != source_data.BuyersPremiumPercent
        or
        (
            ((snapshotted_data.BuyersPremiumPercent is null) and not (source_data.BuyersPremiumPercent is null))
            or
            ((not snapshotted_data.BuyersPremiumPercent is null) and (source_data.BuyersPremiumPercent is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Startdttm != source_data.Startdttm
        or
        (
            ((snapshotted_data.Startdttm is null) and not (source_data.Startdttm is null))
            or
            ((not snapshotted_data.Startdttm is null) and (source_data.Startdttm is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.EstimatedLastEnddttm != source_data.EstimatedLastEnddttm
        or
        (
            ((snapshotted_data.EstimatedLastEnddttm is null) and not (source_data.EstimatedLastEnddttm is null))
            or
            ((not snapshotted_data.EstimatedLastEnddttm is null) and (source_data.EstimatedLastEnddttm is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.Timezone != source_data.Timezone
        or
        (
            ((snapshotted_data.Timezone is null) and not (source_data.Timezone is null))
            or
            ((not snapshotted_data.Timezone is null) and (source_data.Timezone is null))
        ) or snapshotted_data.TermsandConditions != source_data.TermsandConditions
        or
        (
            ((snapshotted_data.TermsandConditions is null) and not (source_data.TermsandConditions is null))
            or
            ((not snapshotted_data.TermsandConditions is null) and (source_data.TermsandConditions is null))
        ) or snapshotted_data.PrimaryImageURI != source_data.PrimaryImageURI
        or
        (
            ((snapshotted_data.PrimaryImageURI is null) and not (source_data.PrimaryImageURI is null))
            or
            ((not snapshotted_data.PrimaryImageURI is null) and (source_data.PrimaryImageURI is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.SecondaryImageURI != source_data.SecondaryImageURI
        or
        (
            ((snapshotted_data.SecondaryImageURI is null) and not (source_data.SecondaryImageURI is null))
            or
            ((not snapshotted_data.SecondaryImageURI is null) and (source_data.SecondaryImageURI is null))
        ) or snapshotted_data.OwnerUserName != source_data.OwnerUserName
        or
        (
            ((snapshotted_data.OwnerUserName is null) and not (source_data.OwnerUserName is null))
            or
            ((not snapshotted_data.OwnerUserName is null) and (source_data.OwnerUserName is null))
        ) or snapshotted_data.ShippingInfo != source_data.ShippingInfo
        or
        (
            ((snapshotted_data.ShippingInfo is null) and not (source_data.ShippingInfo is null))
            or
            ((not snapshotted_data.ShippingInfo is null) and (source_data.ShippingInfo is null))
        ) or snapshotted_data.SubTitle != source_data.SubTitle
        or
        (
            ((snapshotted_data.SubTitle is null) and not (source_data.SubTitle is null))
            or
            ((not snapshotted_data.SubTitle is null) and (source_data.SubTitle is null))
        ) or snapshotted_data.ManagedByName != source_data.ManagedByName
        or
        (
            ((snapshotted_data.ManagedByName is null) and not (source_data.ManagedByName is null))
            or
            ((not snapshotted_data.ManagedByName is null) and (source_data.ManagedByName is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SoftclosingGroupIncrementseconds != source_data.SoftclosingGroupIncrementseconds
        or
        (
            ((snapshotted_data.SoftclosingGroupIncrementseconds is null) and not (source_data.SoftclosingGroupIncrementseconds is null))
            or
            ((not snapshotted_data.SoftclosingGroupIncrementseconds is null) and (source_data.SoftclosingGroupIncrementseconds is null))
        ) or snapshotted_data.LotCount != source_data.LotCount
        or
        (
            ((snapshotted_data.LotCount is null) and not (source_data.LotCount is null))
            or
            ((not snapshotted_data.LotCount is null) and (source_data.LotCount is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.CurrencyID != source_data.CurrencyID
        or
        (
            ((snapshotted_data.CurrencyID is null) and not (source_data.CurrencyID is null))
            or
            ((not snapshotted_data.CurrencyID is null) and (source_data.CurrencyID is null))
        ) or snapshotted_data.ClosingGroupIncrementseconds != source_data.ClosingGroupIncrementseconds
        or
        (
            ((snapshotted_data.ClosingGroupIncrementseconds is null) and not (source_data.ClosingGroupIncrementseconds is null))
            or
            ((not snapshotted_data.ClosingGroupIncrementseconds is null) and (source_data.ClosingGroupIncrementseconds is null))
        ) or snapshotted_data.CurrentclosingGroup != source_data.CurrentclosingGroup
        or
        (
            ((snapshotted_data.CurrentclosingGroup is null) and not (source_data.CurrentclosingGroup is null))
            or
            ((not snapshotted_data.CurrentclosingGroup is null) and (source_data.CurrentclosingGroup is null))
        ) or snapshotted_data.CurrentSoftclosingGroup != source_data.CurrentSoftclosingGroup
        or
        (
            ((snapshotted_data.CurrentSoftclosingGroup is null) and not (source_data.CurrentSoftclosingGroup is null))
            or
            ((not snapshotted_data.CurrentSoftclosingGroup is null) and (source_data.CurrentSoftclosingGroup is null))
        ) or snapshotted_data.CurrentLotOrder != source_data.CurrentLotOrder
        or
        (
            ((snapshotted_data.CurrentLotOrder is null) and not (source_data.CurrentLotOrder is null))
            or
            ((not snapshotted_data.CurrentLotOrder is null) and (source_data.CurrentLotOrder is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.ProxyBidding != source_data.ProxyBidding
        or
        (
            ((snapshotted_data.ProxyBidding is null) and not (source_data.ProxyBidding is null))
            or
            ((not snapshotted_data.ProxyBidding is null) and (source_data.ProxyBidding is null))
        ) or snapshotted_data.Published != source_data.Published
        or
        (
            ((snapshotted_data.Published is null) and not (source_data.Published is null))
            or
            ((not snapshotted_data.Published is null) and (source_data.Published is null))
        ) or snapshotted_data.PreviewLots != source_data.PreviewLots
        or
        (
            ((snapshotted_data.PreviewLots is null) and not (source_data.PreviewLots is null))
            or
            ((not snapshotted_data.PreviewLots is null) and (source_data.PreviewLots is null))
        ) or snapshotted_data.LotsTaxable != source_data.LotsTaxable
        or
        (
            ((snapshotted_data.LotsTaxable is null) and not (source_data.LotsTaxable is null))
            or
            ((not snapshotted_data.LotsTaxable is null) and (source_data.LotsTaxable is null))
        ) or snapshotted_data.FollowLiveEnabled != source_data.FollowLiveEnabled
        or
        (
            ((snapshotted_data.FollowLiveEnabled is null) and not (source_data.FollowLiveEnabled is null))
            or
            ((not snapshotted_data.FollowLiveEnabled is null) and (source_data.FollowLiveEnabled is null))
        ) or snapshotted_data.BuyersPremiumPercent != source_data.BuyersPremiumPercent
        or
        (
            ((snapshotted_data.BuyersPremiumPercent is null) and not (source_data.BuyersPremiumPercent is null))
            or
            ((not snapshotted_data.BuyersPremiumPercent is null) and (source_data.BuyersPremiumPercent is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Startdttm != source_data.Startdttm
        or
        (
            ((snapshotted_data.Startdttm is null) and not (source_data.Startdttm is null))
            or
            ((not snapshotted_data.Startdttm is null) and (source_data.Startdttm is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.EstimatedLastEnddttm != source_data.EstimatedLastEnddttm
        or
        (
            ((snapshotted_data.EstimatedLastEnddttm is null) and not (source_data.EstimatedLastEnddttm is null))
            or
            ((not snapshotted_data.EstimatedLastEnddttm is null) and (source_data.EstimatedLastEnddttm is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.Timezone != source_data.Timezone
        or
        (
            ((snapshotted_data.Timezone is null) and not (source_data.Timezone is null))
            or
            ((not snapshotted_data.Timezone is null) and (source_data.Timezone is null))
        ) or snapshotted_data.TermsandConditions != source_data.TermsandConditions
        or
        (
            ((snapshotted_data.TermsandConditions is null) and not (source_data.TermsandConditions is null))
            or
            ((not snapshotted_data.TermsandConditions is null) and (source_data.TermsandConditions is null))
        ) or snapshotted_data.PrimaryImageURI != source_data.PrimaryImageURI
        or
        (
            ((snapshotted_data.PrimaryImageURI is null) and not (source_data.PrimaryImageURI is null))
            or
            ((not snapshotted_data.PrimaryImageURI is null) and (source_data.PrimaryImageURI is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.SecondaryImageURI != source_data.SecondaryImageURI
        or
        (
            ((snapshotted_data.SecondaryImageURI is null) and not (source_data.SecondaryImageURI is null))
            or
            ((not snapshotted_data.SecondaryImageURI is null) and (source_data.SecondaryImageURI is null))
        ) or snapshotted_data.OwnerUserName != source_data.OwnerUserName
        or
        (
            ((snapshotted_data.OwnerUserName is null) and not (source_data.OwnerUserName is null))
            or
            ((not snapshotted_data.OwnerUserName is null) and (source_data.OwnerUserName is null))
        ) or snapshotted_data.ShippingInfo != source_data.ShippingInfo
        or
        (
            ((snapshotted_data.ShippingInfo is null) and not (source_data.ShippingInfo is null))
            or
            ((not snapshotted_data.ShippingInfo is null) and (source_data.ShippingInfo is null))
        ) or snapshotted_data.SubTitle != source_data.SubTitle
        or
        (
            ((snapshotted_data.SubTitle is null) and not (source_data.SubTitle is null))
            or
            ((not snapshotted_data.SubTitle is null) and (source_data.SubTitle is null))
        ) or snapshotted_data.ManagedByName != source_data.ManagedByName
        or
        (
            ((snapshotted_data.ManagedByName is null) and not (source_data.ManagedByName is null))
            or
            ((not snapshotted_data.ManagedByName is null) and (source_data.ManagedByName is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_AuctionEvents_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_AuctionEvents_Incr__dbt_tmp_temp_view"
    end



    
21:20:48.066641 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr'
      and table_schema = 'stg'
  
21:20:48.061326 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:20:48.067894 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
        
  
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Attributes_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Attributes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Attributes_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Attributes_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Attributes_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Attributes_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701''), CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ConText != source_data.ConText
        or
        (
            ((snapshotted_data.ConText is null) and not (source_data.ConText is null))
            or
            ((not snapshotted_data.ConText is null) and (source_data.ConText is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.EditMode != source_data.EditMode
        or
        (
            ((snapshotted_data.EditMode is null) and not (source_data.EditMode is null))
            or
            ((not snapshotted_data.EditMode is null) and (source_data.EditMode is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ConText != source_data.ConText
        or
        (
            ((snapshotted_data.ConText is null) and not (source_data.ConText is null))
            or
            ((not snapshotted_data.ConText is null) and (source_data.ConText is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.EditMode != source_data.EditMode
        or
        (
            ((snapshotted_data.EditMode is null) and not (source_data.EditMode is null))
            or
            ((not snapshotted_data.EditMode is null) and (source_data.EditMode is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Attributes_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Attributes_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Attributes_Incr__dbt_tmp_temp_view"
    end



    
21:20:48.139819 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:20:48.143804 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:20:48.144106 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
        
  
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Addresses_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Addresses_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Addresses_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Addresses_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Addresses_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Addresses_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701''), CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:20:47.671701'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.CountryID != source_data.CountryID
        or
        (
            ((snapshotted_data.CountryID is null) and not (source_data.CountryID is null))
            or
            ((not snapshotted_data.CountryID is null) and (source_data.CountryID is null))
        ) or snapshotted_data.Street1 != source_data.Street1
        or
        (
            ((snapshotted_data.Street1 is null) and not (source_data.Street1 is null))
            or
            ((not snapshotted_data.Street1 is null) and (source_data.Street1 is null))
        ) or snapshotted_data.Street2 != source_data.Street2
        or
        (
            ((snapshotted_data.Street2 is null) and not (source_data.Street2 is null))
            or
            ((not snapshotted_data.Street2 is null) and (source_data.Street2 is null))
        ) or snapshotted_data.City != source_data.City
        or
        (
            ((snapshotted_data.City is null) and not (source_data.City is null))
            or
            ((not snapshotted_data.City is null) and (source_data.City is null))
        ) or snapshotted_data.Stateregion != source_data.Stateregion
        or
        (
            ((snapshotted_data.Stateregion is null) and not (source_data.Stateregion is null))
            or
            ((not snapshotted_data.Stateregion is null) and (source_data.Stateregion is null))
        ) or snapshotted_data.ZipPostal != source_data.ZipPostal
        or
        (
            ((snapshotted_data.ZipPostal is null) and not (source_data.ZipPostal is null))
            or
            ((not snapshotted_data.ZipPostal is null) and (source_data.ZipPostal is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.CountryID != source_data.CountryID
        or
        (
            ((snapshotted_data.CountryID is null) and not (source_data.CountryID is null))
            or
            ((not snapshotted_data.CountryID is null) and (source_data.CountryID is null))
        ) or snapshotted_data.Street1 != source_data.Street1
        or
        (
            ((snapshotted_data.Street1 is null) and not (source_data.Street1 is null))
            or
            ((not snapshotted_data.Street1 is null) and (source_data.Street1 is null))
        ) or snapshotted_data.Street2 != source_data.Street2
        or
        (
            ((snapshotted_data.Street2 is null) and not (source_data.Street2 is null))
            or
            ((not snapshotted_data.Street2 is null) and (source_data.Street2 is null))
        ) or snapshotted_data.City != source_data.City
        or
        (
            ((snapshotted_data.City is null) and not (source_data.City is null))
            or
            ((not snapshotted_data.City is null) and (source_data.City is null))
        ) or snapshotted_data.Stateregion != source_data.Stateregion
        or
        (
            ((snapshotted_data.Stateregion is null) and not (source_data.Stateregion is null))
            or
            ((not snapshotted_data.Stateregion is null) and (source_data.Stateregion is null))
        ) or snapshotted_data.ZipPostal != source_data.ZipPostal
        or
        (
            ((snapshotted_data.ZipPostal is null) and not (source_data.ZipPostal is null))
            or
            ((not snapshotted_data.ZipPostal is null) and (source_data.ZipPostal is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Addresses_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Addresses_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Addresses_Incr__dbt_tmp_temp_view"
    end



    
21:20:55.554015 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.49 seconds
21:20:55.563341 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:20:55.563661 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:20:55.608164 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:20:55.609816 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:20:55.610064 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Attributes_Incr__dbt_tmp"
    
21:20:56.150051 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 8.08 seconds
21:20:56.229002 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:20:56.229397 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:20:56.276420 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:20:56.277998 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:20:56.278277 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    
21:20:56.989554 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
21:20:56.991222 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:20:56.991447 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:20:57.065371 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:20:57.068161 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:20:57.068473 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:20:57.307371 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:20:57.310675 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:20:57.310986 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr'
      and table_schema = 'stg'
  
21:20:57.346789 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:20:57.351062 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:20:57.351380 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:20:57.417196 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:20:57.419001 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:20:57.419261 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Attributes_Incr__dbt_tmp"
    
21:20:57.491435 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.21 seconds
21:20:57.493174 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:20:57.493436 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:20:57.650766 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:20:57.653421 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:20:57.653701 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:20:57.975912 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
21:20:57.979176 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:20:57.979424 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr'
      and table_schema = 'stg'
  
21:20:58.059688 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:20:58.063701 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:20:58.063985 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:20:58.207361 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:20:58.208991 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:20:58.209230 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    
21:20:58.557283 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.14 seconds
21:20:58.559020 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:20:58.559256 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:20:58.621429 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:20:58.623990 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:20:58.624249 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:20:58.884890 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:20:58.888001 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:20:58.888267 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr'
      and table_schema = 'stg'
  
21:20:58.933896 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:20:58.942483 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:20:58.942866 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:20:58.980299 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:20:58.981957 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:20:58.982213 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Attributes_Incr__dbt_tmp"
    
21:20:59.563443 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.35 seconds
21:20:59.565223 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:20:59.565505 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:20:59.612197 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:20:59.615217 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:20:59.615524 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:00.016894 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
21:21:00.019824 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:21:00.020102 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr'
      and table_schema = 'stg'
  
21:21:00.055195 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:00.059990 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:21:00.060351 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:00.096948 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:00.098631 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:21:00.098905 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    
21:21:00.257467 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.28 seconds
21:21:00.259109 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:21:00.259303 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:00.296055 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:00.298911 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:21:00.299203 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:00.643142 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
21:21:00.649878 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Attributes_Incr"
21:21:00.650644 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:21:00.650849 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Attributes_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Attributes_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Attributes_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Attributes_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Attributes_Incr" (
                  "ID", "ConText", "Name", "Value", "EditMode", "Type", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "ConText", "Name", "Value", "EditMode", "Type", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Attributes_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:21:01.459072 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.36 seconds
21:21:01.460741 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:21:01.460944 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:01.499303 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:01.502340 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:21:01.503110 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:01.901182 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
21:21:01.903418 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_AuctionEventMedias_Incr"
21:21:01.903870 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:21:01.904004 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_AuctionEventMedias_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr" (
                  "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "DisplayOrder", "MediaID", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "DisplayOrder", "MediaID", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:21:02.382706 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.73 seconds
21:21:02.389894 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Attributes_Incr: COMMIT
21:21:02.393073 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:21:02.393352 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."#AH_Attributes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Attributes_Incr__dbt_tmp"
    end

21:21:02.431098 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:02.445643 [debug] [Thread-2  ]: finished collecting timing info
21:21:02.446074 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Attributes_Incr: Close
21:21:02.446899 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc558731280>]}
21:21:02.447438 [info ] [Thread-2  ]: 2 of 101 OK snapshotted stg.AH_Attributes_Incr.................................. [[32mOK[0m in 15.16s]
21:21:02.447831 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Attributes_Incr
21:21:02.448017 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_BannedUsers_Incr
21:21:02.448582 [info ] [Thread-2  ]: 5 of 101 START snapshot stg.AH_BannedUsers_Incr................................. [RUN]
21:21:02.449064 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_BannedUsers_Incr"
21:21:02.449218 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_BannedUsers_Incr
21:21:02.449374 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_BannedUsers_Incr
21:21:02.452270 [debug] [Thread-2  ]: finished collecting timing info
21:21:02.452471 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_BannedUsers_Incr
21:21:02.455458 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:02.455670 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:21:02.455793 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:21:02.455989 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:21:02.575096 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:21:02.626482 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:21:02.649841 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:02.650221 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:21:02.682710 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:02.685308 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:02.685659 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_BannedUsers_InterView]
        ) as __dbt_sbq
    
21:21:02.751329 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:21:02.773409 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:02.773820 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr"
        ) as __dbt_sbq
    
21:21:02.836987 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:21:02.840339 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:02.840606 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr'
      and table_schema = 'stg'
  
21:21:02.976116 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:21:02.980041 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:02.980343 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
        
  
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BannedUsers_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_BannedUsers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BannedUsers_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_BannedUsers_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_BannedUsers_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:02.656162'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:02.656162'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:21:02.656162''), CONVERT(DATETIME2, ''2022-09-18 21:21:02.656162'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:21:02.656162'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:02.656162'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:02.656162'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:21:02.656162'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Lastip != source_data.Lastip
        or
        (
            ((snapshotted_data.Lastip is null) and not (source_data.Lastip is null))
            or
            ((not snapshotted_data.Lastip is null) and (source_data.Lastip is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.FName != source_data.FName
        or
        (
            ((snapshotted_data.FName is null) and not (source_data.FName is null))
            or
            ((not snapshotted_data.FName is null) and (source_data.FName is null))
        ) or snapshotted_data.LName != source_data.LName
        or
        (
            ((snapshotted_data.LName is null) and not (source_data.LName is null))
            or
            ((not snapshotted_data.LName is null) and (source_data.LName is null))
        ) or snapshotted_data.IsLockedOut != source_data.IsLockedOut
        or
        (
            ((snapshotted_data.IsLockedOut is null) and not (source_data.IsLockedOut is null))
            or
            ((not snapshotted_data.IsLockedOut is null) and (source_data.IsLockedOut is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Lastip != source_data.Lastip
        or
        (
            ((snapshotted_data.Lastip is null) and not (source_data.Lastip is null))
            or
            ((not snapshotted_data.Lastip is null) and (source_data.Lastip is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.FName != source_data.FName
        or
        (
            ((snapshotted_data.FName is null) and not (source_data.FName is null))
            or
            ((not snapshotted_data.FName is null) and (source_data.FName is null))
        ) or snapshotted_data.LName != source_data.LName
        or
        (
            ((snapshotted_data.LName is null) and not (source_data.LName is null))
            or
            ((not snapshotted_data.LName is null) and (source_data.LName is null))
        ) or snapshotted_data.IsLockedOut != source_data.IsLockedOut
        or
        (
            ((snapshotted_data.IsLockedOut is null) and not (source_data.IsLockedOut is null))
            or
            ((not snapshotted_data.IsLockedOut is null) and (source_data.IsLockedOut is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_BannedUsers_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_BannedUsers_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BannedUsers_Incr__dbt_tmp_temp_view"
    end



    
21:21:03.466584 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.56 seconds
21:21:03.468269 [debug] [Thread-3  ]: On snapshot.Shawn.AH_AuctionEventMedias_Incr: COMMIT
21:21:03.469030 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:21:03.469183 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    end

21:21:03.506239 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:03.520489 [debug] [Thread-3  ]: finished collecting timing info
21:21:03.520890 [debug] [Thread-3  ]: On snapshot.Shawn.AH_AuctionEventMedias_Incr: Close
21:21:03.521652 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55877d220>]}
21:21:03.522180 [info ] [Thread-3  ]: 3 of 101 OK snapshotted stg.AH_AuctionEventMedias_Incr.......................... [[32mOK[0m in 16.24s]
21:21:03.522598 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_AuctionEventMedias_Incr
21:21:03.522793 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_BannerCategories_Incr
21:21:03.523212 [info ] [Thread-3  ]: 6 of 101 START snapshot stg.AH_BannerCategories_Incr............................ [RUN]
21:21:03.523632 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_BannerCategories_Incr"
21:21:03.523786 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_BannerCategories_Incr
21:21:03.523924 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_BannerCategories_Incr
21:21:03.526770 [debug] [Thread-3  ]: finished collecting timing info
21:21:03.527029 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_BannerCategories_Incr
21:21:03.529778 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:03.529955 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:21:03.530071 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:21:03.530199 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:21:03.643784 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:21:03.697043 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:21:03.719570 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:03.719934 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:21:03.784174 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:21:03.786265 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:03.786802 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_BannerCategories_InterView]
        ) as __dbt_sbq
    
21:21:03.893302 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:21:03.916225 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:03.916581 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr"
        ) as __dbt_sbq
    
21:21:04.011948 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:21:04.015653 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:04.015890 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr'
      and table_schema = 'stg'
  
21:21:04.085896 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:21:04.089583 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:04.089862 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
        
  
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BannerCategories_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_BannerCategories_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BannerCategories_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_BannerCategories_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_BannerCategories_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:03.765498'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:03.765498'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:21:03.765498''), CONVERT(DATETIME2, ''2022-09-18 21:21:03.765498'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:21:03.765498'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:03.765498'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:03.765498'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:21:03.765498'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.BannerID != source_data.BannerID
        or
        (
            ((snapshotted_data.BannerID is null) and not (source_data.BannerID is null))
            or
            ((not snapshotted_data.BannerID is null) and (source_data.BannerID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.BannerID != source_data.BannerID
        or
        (
            ((snapshotted_data.BannerID is null) and not (source_data.BannerID is null))
            or
            ((not snapshotted_data.BannerID is null) and (source_data.BannerID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_BannerCategories_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_BannerCategories_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BannerCategories_Incr__dbt_tmp_temp_view"
    end



    
21:21:08.128547 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 19.98 seconds
21:21:08.132246 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:21:08.132499 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:08.179955 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:08.181337 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:21:08.182152 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Addresses_Incr__dbt_tmp"
    
21:21:09.943921 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.76 seconds
21:21:09.945551 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:21:09.945735 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:10.035784 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:21:10.038530 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:21:10.038861 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:10.327924 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.35 seconds
21:21:10.331663 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:10.331943 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:10.373021 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:10.374673 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:10.374916 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannedUsers_Incr__dbt_tmp"
    
21:21:10.472305 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.38 seconds
21:21:10.475781 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:10.476049 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:10.515339 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:10.516935 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:10.517174 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannerCategories_Incr__dbt_tmp"
    
21:21:10.617667 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.58 seconds
21:21:10.620846 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:21:10.621154 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr'
      and table_schema = 'stg'
  
21:21:10.655548 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:10.659804 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:21:10.660073 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:10.707524 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:10.709158 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:21:10.709371 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Addresses_Incr__dbt_tmp"
    
21:21:12.072259 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.55 seconds
21:21:12.073831 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:12.074010 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:12.074320 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.36 seconds
21:21:12.075485 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:21:12.075769 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:12.079320 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.70 seconds
21:21:12.080450 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:12.080629 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:12.128207 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:12.131410 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:21:12.131687 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:12.161116 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:21:12.163832 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:12.164099 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:12.171070 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:21:12.173270 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:12.173480 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:12.340557 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:21:12.345304 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:21:12.345594 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr'
      and table_schema = 'stg'
  
21:21:12.383881 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:12.388577 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:21:12.388907 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:12.446832 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:21:12.448431 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:21:12.448665 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Addresses_Incr__dbt_tmp"
    
21:21:12.549108 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.38 seconds
21:21:12.552232 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:12.552481 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr'
      and table_schema = 'stg'
  
21:21:12.597716 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.42 seconds
21:21:12.600619 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:12.600862 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr'
      and table_schema = 'stg'
  
21:21:12.613370 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:21:12.617223 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:12.617463 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:12.658577 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:21:12.663012 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:12.663202 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:12.664629 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:12.664825 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannerCategories_Incr__dbt_tmp"
    
21:21:12.663397 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:12.703727 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:12.705291 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:12.705537 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannedUsers_Incr__dbt_tmp"
    
21:21:14.403991 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.74 seconds
21:21:14.405594 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:14.405783 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:14.415835 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.97 seconds
21:21:14.417253 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:21:14.417463 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:14.417732 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.71 seconds
21:21:14.418816 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:14.418991 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:14.439914 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:14.442417 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:14.442689 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:14.451720 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:14.454052 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:21:14.454267 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:14.456442 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:14.458644 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:14.458824 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:14.665799 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:21:14.668794 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:14.669045 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr'
      and table_schema = 'stg'
  
21:21:14.669248 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 26.60 seconds
21:21:14.672355 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:21:14.672555 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:14.672744 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:21:14.674753 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Addresses_Incr"
21:21:14.675182 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:21:14.675327 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Addresses_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Addresses_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Addresses_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Addresses_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Addresses_Incr" (
                  "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "UserID", "CountryID", "Street1", "Street2", "City", "Stateregion", "ZipPostal", "LastUpdatedUser", "Description", "FirstName", "LastName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "UserID", "CountryID", "Street1", "Street2", "City", "Stateregion", "ZipPostal", "LastUpdatedUser", "Description", "FirstName", "LastName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Addresses_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:21:14.713352 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:21:14.716144 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:14.716384 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr'
      and table_schema = 'stg'
  
21:21:14.716805 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:14.717771 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:21:14.717943 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    
21:21:14.748917 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:14.753331 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:14.753572 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:14.806047 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:14.807776 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:14.808000 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannedUsers_Incr__dbt_tmp"
    
21:21:15.032355 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
21:21:15.036897 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:15.037178 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:15.081482 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:15.083120 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:15.083363 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannerCategories_Incr__dbt_tmp"
    
21:21:15.944521 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.14 seconds
21:21:15.946168 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:15.946351 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:16.018854 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:21:16.021498 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:16.021706 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:16.255805 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:21:16.257911 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_BannedUsers_Incr"
21:21:16.258425 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:16.258633 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_BannedUsers_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr" (
                  "ID", "Lastip", "UserName", "FName", "LName", "IsLockedOut", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Lastip", "UserName", "FName", "LName", "IsLockedOut", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_BannedUsers_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:21:16.417790 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.70 seconds
21:21:16.419613 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:21:16.419864 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:16.462595 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
21:21:16.464320 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:16.464588 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:16.508843 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:21:16.514488 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:21:16.514831 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:16.567909 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:21:16.570499 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:16.570794 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:16.655453 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.98 seconds
21:21:16.657269 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Addresses_Incr: COMMIT
21:21:16.658125 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:21:16.658335 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."#AH_Addresses_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Addresses_Incr__dbt_tmp"
    end

21:21:16.704209 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:16.718027 [debug] [Thread-1  ]: finished collecting timing info
21:21:16.718424 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Addresses_Incr: Close
21:21:16.719174 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc558784eb0>]}
21:21:16.719688 [info ] [Thread-1  ]: 1 of 101 OK snapshotted stg.AH_Addresses_Incr................................... [[32mOK[0m in 29.44s]
21:21:16.720076 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Addresses_Incr
21:21:16.720258 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Banners_Incr
21:21:16.720647 [info ] [Thread-1  ]: 7 of 101 START snapshot stg.AH_Banners_Incr..................................... [RUN]
21:21:16.721055 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Banners_Incr"
21:21:16.721207 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Banners_Incr
21:21:16.721340 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Banners_Incr
21:21:16.724115 [debug] [Thread-1  ]: finished collecting timing info
21:21:16.724311 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Banners_Incr
21:21:16.727224 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:16.727402 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:21:16.727520 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:21:16.727646 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:21:16.757558 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:21:16.760728 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:21:16.760981 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr'
      and table_schema = 'stg'
  
21:21:16.828605 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:21:16.833120 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:21:16.833368 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:16.865790 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:21:16.868027 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_BannerCategories_Incr"
21:21:16.868633 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:16.868826 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_BannerCategories_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "BannerID", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "BannerID", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_BannerCategories_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:21:16.887815 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:16.889225 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:21:16.889437 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    
21:21:16.907769 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:21:16.936525 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:21:16.959153 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:16.959521 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:21:16.988189 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:16.990467 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:16.990780 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Banners_InterView]
        ) as __dbt_sbq
    
21:21:17.068875 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:21:17.091320 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:17.091690 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Banners_Incr"
        ) as __dbt_sbq
    
21:21:17.159195 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:21:17.163293 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:17.163561 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr'
      and table_schema = 'stg'
  
21:21:17.247806 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:21:17.251378 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:17.251630 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
        
  
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Banners_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Banners_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Banners_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Banners_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Banners_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Banners_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:16.968739'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:16.968739'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:21:16.968739''), CONVERT(DATETIME2, ''2022-09-18 21:21:16.968739'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:21:16.968739'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:16.968739'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:16.968739'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:21:16.968739'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.LinkURI != source_data.LinkURI
        or
        (
            ((snapshotted_data.LinkURI is null) and not (source_data.LinkURI is null))
            or
            ((not snapshotted_data.LinkURI is null) and (source_data.LinkURI is null))
        ) or snapshotted_data.BannerLocation != source_data.BannerLocation
        or
        (
            ((snapshotted_data.BannerLocation is null) and not (source_data.BannerLocation is null))
            or
            ((not snapshotted_data.BannerLocation is null) and (source_data.BannerLocation is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.LinkURI != source_data.LinkURI
        or
        (
            ((snapshotted_data.LinkURI is null) and not (source_data.LinkURI is null))
            or
            ((not snapshotted_data.LinkURI is null) and (source_data.LinkURI is null))
        ) or snapshotted_data.BannerLocation != source_data.BannerLocation
        or
        (
            ((snapshotted_data.BannerLocation is null) and not (source_data.BannerLocation is null))
            or
            ((not snapshotted_data.BannerLocation is null) and (source_data.BannerLocation is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Banners_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Banners_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Banners_Incr__dbt_tmp_temp_view"
    end



    
21:21:17.848154 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.59 seconds
21:21:17.850000 [debug] [Thread-2  ]: On snapshot.Shawn.AH_BannedUsers_Incr: COMMIT
21:21:17.850822 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:21:17.851007 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."#AH_BannedUsers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BannedUsers_Incr__dbt_tmp"
    end

21:21:17.896933 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:17.910700 [debug] [Thread-2  ]: finished collecting timing info
21:21:17.911090 [debug] [Thread-2  ]: On snapshot.Shawn.AH_BannedUsers_Incr: Close
21:21:17.911846 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559872820>]}
21:21:17.912373 [info ] [Thread-2  ]: 5 of 101 OK snapshotted stg.AH_BannedUsers_Incr................................. [[32mOK[0m in 15.46s]
21:21:17.912753 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_BannedUsers_Incr
21:21:17.912932 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_BiddingTransactions_Incr
21:21:17.913332 [info ] [Thread-2  ]: 8 of 101 START snapshot stg.AH_BiddingTransactions_Incr......................... [RUN]
21:21:17.913751 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr"
21:21:17.913904 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_BiddingTransactions_Incr
21:21:17.914036 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_BiddingTransactions_Incr
21:21:17.916814 [debug] [Thread-2  ]: finished collecting timing info
21:21:17.917014 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_BiddingTransactions_Incr
21:21:17.919850 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:17.920031 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:21:17.920163 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:21:17.920294 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:21:18.019839 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:21:18.049044 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:21:18.072192 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:18.072606 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:21:18.107499 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:18.109812 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:18.110374 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_BiddingTransactions_InterView]
        ) as __dbt_sbq
    
21:21:18.168068 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:21:18.190889 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:18.191229 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr"
        ) as __dbt_sbq
    
21:21:18.279906 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:21:18.283581 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:18.283864 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr'
      and table_schema = 'stg'
  
21:21:18.332098 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.44 seconds
21:21:18.334155 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:21:18.334402 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:18.375095 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:21:18.377002 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:18.379915 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:21:18.382034 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:18.381904 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:18.382356 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
        
  
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BiddingTransactions_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_BiddingTransactions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_BiddingTransactions_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_BiddingTransactions_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:18.078127'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:18.078127'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:21:18.078127''), CONVERT(DATETIME2, ''2022-09-18 21:21:18.078127'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:21:18.078127'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:18.078127'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:18.078127'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:21:18.078127'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Maxmindscore != source_data.Maxmindscore
        or
        (
            ((snapshotted_data.Maxmindscore is null) and not (source_data.Maxmindscore is null))
            or
            ((not snapshotted_data.Maxmindscore is null) and (source_data.Maxmindscore is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ListingActionID != source_data.ListingActionID
        or
        (
            ((snapshotted_data.ListingActionID is null) and not (source_data.ListingActionID is null))
            or
            ((not snapshotted_data.ListingActionID is null) and (source_data.ListingActionID is null))
        ) or snapshotted_data.CreditCardID != source_data.CreditCardID
        or
        (
            ((snapshotted_data.CreditCardID is null) and not (source_data.CreditCardID is null))
            or
            ((not snapshotted_data.CreditCardID is null) and (source_data.CreditCardID is null))
        ) or snapshotted_data.Active != source_data.Active
        or
        (
            ((snapshotted_data.Active is null) and not (source_data.Active is null))
            or
            ((not snapshotted_data.Active is null) and (source_data.Active is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Maxmindscore != source_data.Maxmindscore
        or
        (
            ((snapshotted_data.Maxmindscore is null) and not (source_data.Maxmindscore is null))
            or
            ((not snapshotted_data.Maxmindscore is null) and (source_data.Maxmindscore is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ListingActionID != source_data.ListingActionID
        or
        (
            ((snapshotted_data.ListingActionID is null) and not (source_data.ListingActionID is null))
            or
            ((not snapshotted_data.ListingActionID is null) and (source_data.ListingActionID is null))
        ) or snapshotted_data.CreditCardID != source_data.CreditCardID
        or
        (
            ((snapshotted_data.CreditCardID is null) and not (source_data.CreditCardID is null))
            or
            ((not snapshotted_data.CreditCardID is null) and (source_data.CreditCardID is null))
        ) or snapshotted_data.Active != source_data.Active
        or
        (
            ((snapshotted_data.Active is null) and not (source_data.Active is null))
            or
            ((not snapshotted_data.Active is null) and (source_data.Active is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_BiddingTransactions_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BiddingTransactions_Incr__dbt_tmp_temp_view"
    end



    
21:21:18.413061 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.54 seconds
21:21:18.414866 [debug] [Thread-3  ]: On snapshot.Shawn.AH_BannerCategories_Incr: COMMIT
21:21:18.416057 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:21:18.416260 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."#AH_BannerCategories_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BannerCategories_Incr__dbt_tmp"
    end

21:21:18.457441 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:18.471489 [debug] [Thread-3  ]: finished collecting timing info
21:21:18.471876 [debug] [Thread-3  ]: On snapshot.Shawn.AH_BannerCategories_Incr: Close
21:21:18.472633 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559872970>]}
21:21:18.473140 [info ] [Thread-3  ]: 6 of 101 OK snapshotted stg.AH_BannerCategories_Incr............................ [[32mOK[0m in 14.95s]
21:21:18.473519 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_BannerCategories_Incr
21:21:18.473697 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Categories_Incr
21:21:18.474098 [info ] [Thread-3  ]: 9 of 101 START snapshot stg.AH_Categories_Incr.................................. [RUN]
21:21:18.474519 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Categories_Incr"
21:21:18.474706 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Categories_Incr
21:21:18.474841 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Categories_Incr
21:21:18.477598 [debug] [Thread-3  ]: finished collecting timing info
21:21:18.478012 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Categories_Incr
21:21:18.480766 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:18.481001 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:21:18.481134 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:21:18.481266 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:21:18.579509 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:21:18.614179 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:21:18.636833 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:18.637091 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:21:18.639882 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:21:18.640098 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr'
      and table_schema = 'stg'
  
21:21:18.637324 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:21:18.667907 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:18.670193 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:18.670462 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Categories_InterView]
        ) as __dbt_sbq
    
21:21:18.673888 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:18.679026 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:21:18.679245 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:18.718453 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:18.720102 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:21:18.720353 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    
21:21:18.724689 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:18.746937 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:18.747315 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Categories_Incr"
        ) as __dbt_sbq
    
21:21:18.819345 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:21:18.824352 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:18.824708 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr'
      and table_schema = 'stg'
  
21:21:18.892779 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:21:18.896917 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:18.897213 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
        
  
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Categories_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Categories_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Categories_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Categories_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Categories_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Categories_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:18.640643'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:18.640643'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:21:18.640643''), CONVERT(DATETIME2, ''2022-09-18 21:21:18.640643'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:21:18.640643'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:18.640643'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:18.640643'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:21:18.640643'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ParentCategoryID != source_data.ParentCategoryID
        or
        (
            ((snapshotted_data.ParentCategoryID is null) and not (source_data.ParentCategoryID is null))
            or
            ((not snapshotted_data.ParentCategoryID is null) and (source_data.ParentCategoryID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.Lft != source_data.Lft
        or
        (
            ((snapshotted_data.Lft is null) and not (source_data.Lft is null))
            or
            ((not snapshotted_data.Lft is null) and (source_data.Lft is null))
        ) or snapshotted_data.Rgt != source_data.Rgt
        or
        (
            ((snapshotted_data.Rgt is null) and not (source_data.Rgt is null))
            or
            ((not snapshotted_data.Rgt is null) and (source_data.Rgt is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.RolesAllowed != source_data.RolesAllowed
        or
        (
            ((snapshotted_data.RolesAllowed is null) and not (source_data.RolesAllowed is null))
            or
            ((not snapshotted_data.RolesAllowed is null) and (source_data.RolesAllowed is null))
        ) or snapshotted_data.EnabledCustomProperty != source_data.EnabledCustomProperty
        or
        (
            ((snapshotted_data.EnabledCustomProperty is null) and not (source_data.EnabledCustomProperty is null))
            or
            ((not snapshotted_data.EnabledCustomProperty is null) and (source_data.EnabledCustomProperty is null))
        ) or snapshotted_data.MetaKeyWords != source_data.MetaKeyWords
        or
        (
            ((snapshotted_data.MetaKeyWords is null) and not (source_data.MetaKeyWords is null))
            or
            ((not snapshotted_data.MetaKeyWords is null) and (source_data.MetaKeyWords is null))
        ) or snapshotted_data.MetaDescription != source_data.MetaDescription
        or
        (
            ((snapshotted_data.MetaDescription is null) and not (source_data.MetaDescription is null))
            or
            ((not snapshotted_data.MetaDescription is null) and (source_data.MetaDescription is null))
        ) or snapshotted_data.PageTitle != source_data.PageTitle
        or
        (
            ((snapshotted_data.PageTitle is null) and not (source_data.PageTitle is null))
            or
            ((not snapshotted_data.PageTitle is null) and (source_data.PageTitle is null))
        ) or snapshotted_data.Pagecontent != source_data.Pagecontent
        or
        (
            ((snapshotted_data.Pagecontent is null) and not (source_data.Pagecontent is null))
            or
            ((not snapshotted_data.Pagecontent is null) and (source_data.Pagecontent is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.MvcAction != source_data.MvcAction
        or
        (
            ((snapshotted_data.MvcAction is null) and not (source_data.MvcAction is null))
            or
            ((not snapshotted_data.MvcAction is null) and (source_data.MvcAction is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ParentCategoryID != source_data.ParentCategoryID
        or
        (
            ((snapshotted_data.ParentCategoryID is null) and not (source_data.ParentCategoryID is null))
            or
            ((not snapshotted_data.ParentCategoryID is null) and (source_data.ParentCategoryID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.Lft != source_data.Lft
        or
        (
            ((snapshotted_data.Lft is null) and not (source_data.Lft is null))
            or
            ((not snapshotted_data.Lft is null) and (source_data.Lft is null))
        ) or snapshotted_data.Rgt != source_data.Rgt
        or
        (
            ((snapshotted_data.Rgt is null) and not (source_data.Rgt is null))
            or
            ((not snapshotted_data.Rgt is null) and (source_data.Rgt is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.RolesAllowed != source_data.RolesAllowed
        or
        (
            ((snapshotted_data.RolesAllowed is null) and not (source_data.RolesAllowed is null))
            or
            ((not snapshotted_data.RolesAllowed is null) and (source_data.RolesAllowed is null))
        ) or snapshotted_data.EnabledCustomProperty != source_data.EnabledCustomProperty
        or
        (
            ((snapshotted_data.EnabledCustomProperty is null) and not (source_data.EnabledCustomProperty is null))
            or
            ((not snapshotted_data.EnabledCustomProperty is null) and (source_data.EnabledCustomProperty is null))
        ) or snapshotted_data.MetaKeyWords != source_data.MetaKeyWords
        or
        (
            ((snapshotted_data.MetaKeyWords is null) and not (source_data.MetaKeyWords is null))
            or
            ((not snapshotted_data.MetaKeyWords is null) and (source_data.MetaKeyWords is null))
        ) or snapshotted_data.MetaDescription != source_data.MetaDescription
        or
        (
            ((snapshotted_data.MetaDescription is null) and not (source_data.MetaDescription is null))
            or
            ((not snapshotted_data.MetaDescription is null) and (source_data.MetaDescription is null))
        ) or snapshotted_data.PageTitle != source_data.PageTitle
        or
        (
            ((snapshotted_data.PageTitle is null) and not (source_data.PageTitle is null))
            or
            ((not snapshotted_data.PageTitle is null) and (source_data.PageTitle is null))
        ) or snapshotted_data.Pagecontent != source_data.Pagecontent
        or
        (
            ((snapshotted_data.Pagecontent is null) and not (source_data.Pagecontent is null))
            or
            ((not snapshotted_data.Pagecontent is null) and (source_data.Pagecontent is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.MvcAction != source_data.MvcAction
        or
        (
            ((snapshotted_data.MvcAction is null) and not (source_data.MvcAction is null))
            or
            ((not snapshotted_data.MvcAction is null) and (source_data.MvcAction is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Categories_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Categories_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Categories_Incr__dbt_tmp_temp_view"
    end



    
21:21:19.783509 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
21:21:19.785192 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:21:19.785400 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:19.823430 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:19.826781 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:21:19.827065 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:20.136768 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
21:21:20.139703 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_AuctionEvents_Incr"
21:21:20.140211 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:21:20.140370 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_AuctionEvents_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr" (
                  "ID", "SoftclosingGroupIncrementseconds", "LotCount", "CategoryID", "CurrencyID", "ClosingGroupIncrementseconds", "CurrentclosingGroup", "CurrentSoftclosingGroup", "CurrentLotOrder", "OwnerID", "ProxyBidding", "Published", "PreviewLots", "LotsTaxable", "FollowLiveEnabled", "BuyersPremiumPercent", "DeletedOn", "Startdttm", "Enddttm", "EstimatedLastEnddttm", "CreatedOn", "UpdatedOn", "Description", "LastUpdatedUser", "Status", "Timezone", "TermsandConditions", "PrimaryImageURI", "Title", "SecondaryImageURI", "OwnerUserName", "ShippingInfo", "SubTitle", "ManagedByName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SoftclosingGroupIncrementseconds", "LotCount", "CategoryID", "CurrencyID", "ClosingGroupIncrementseconds", "CurrentclosingGroup", "CurrentSoftclosingGroup", "CurrentLotOrder", "OwnerID", "ProxyBidding", "Published", "PreviewLots", "LotsTaxable", "FollowLiveEnabled", "BuyersPremiumPercent", "DeletedOn", "Startdttm", "Enddttm", "EstimatedLastEnddttm", "CreatedOn", "UpdatedOn", "Description", "LastUpdatedUser", "Status", "Timezone", "TermsandConditions", "PrimaryImageURI", "Title", "SecondaryImageURI", "OwnerUserName", "ShippingInfo", "SubTitle", "ManagedByName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_AuctionEvents_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:21:21.930223 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.79 seconds
21:21:21.931948 [debug] [Thread-4  ]: On snapshot.Shawn.AH_AuctionEvents_Incr: COMMIT
21:21:21.932769 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:21:21.932923 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."#AH_AuctionEvents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    end

21:21:21.979346 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:21.993164 [debug] [Thread-4  ]: finished collecting timing info
21:21:21.993556 [debug] [Thread-4  ]: On snapshot.Shawn.AH_AuctionEvents_Incr: Close
21:21:21.994321 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55874d070>]}
21:21:21.994866 [info ] [Thread-4  ]: 4 of 101 OK snapshotted stg.AH_AuctionEvents_Incr............................... [[32mOK[0m in 34.70s]
21:21:21.995243 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_AuctionEvents_Incr
21:21:21.995424 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_CategoryCount_Incr
21:21:21.995813 [info ] [Thread-4  ]: 10 of 101 START snapshot stg.AH_CategoryCount_Incr.............................. [RUN]
21:21:21.996231 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CategoryCount_Incr"
21:21:21.996384 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_CategoryCount_Incr
21:21:21.996516 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_CategoryCount_Incr
21:21:21.999290 [debug] [Thread-4  ]: finished collecting timing info
21:21:21.999548 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_CategoryCount_Incr
21:21:22.002231 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:22.002410 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:21:22.002530 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:21:22.002692 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:21:22.149964 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:21:22.181926 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:21:22.205734 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:22.206092 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:21:22.234957 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:22.237198 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:22.237717 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CategoryCount_InterView]
        ) as __dbt_sbq
    
21:21:22.340381 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:21:22.362357 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:22.362761 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr"
        ) as __dbt_sbq
    
21:21:22.525794 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:21:22.529321 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:22.529575 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr'
      and table_schema = 'stg'
  
21:21:22.639879 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:21:22.643660 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:22.643929 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
        
  
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryCount_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CategoryCount_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryCount_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CategoryCount_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CategoryCount_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:22.218850'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:22.218850'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:21:22.218850''), CONVERT(DATETIME2, ''2022-09-18 21:21:22.218850'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:21:22.218850'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:22.218850'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:22.218850'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:21:22.218850'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Count != source_data.Count
        or
        (
            ((snapshotted_data.Count is null) and not (source_data.Count is null))
            or
            ((not snapshotted_data.Count is null) and (source_data.Count is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Count != source_data.Count
        or
        (
            ((snapshotted_data.Count is null) and not (source_data.Count is null))
            or
            ((not snapshotted_data.Count is null) and (source_data.Count is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CategoryCount_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CategoryCount_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryCount_Incr__dbt_tmp_temp_view"
    end



    
21:21:23.533412 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.28 seconds
21:21:23.536764 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:23.536962 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:23.578715 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:23.580320 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:23.580565 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Banners_Incr__dbt_tmp"
    
21:21:24.829776 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.45 seconds
21:21:24.833209 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:24.833409 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:24.871054 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:24.872839 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:24.873101 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    
21:21:25.009788 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.43 seconds
21:21:25.011648 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:25.011904 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:25.085203 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:21:25.088156 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:25.088407 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:25.441978 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
21:21:25.445178 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:25.445443 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr'
      and table_schema = 'stg'
  
21:21:25.498495 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:25.502922 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:25.503273 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:25.544241 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:25.545907 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:25.546157 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Banners_Incr__dbt_tmp"
    
21:21:26.240014 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.37 seconds
21:21:26.241538 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:26.241763 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:26.329287 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:21:26.332015 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:26.332294 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:26.467237 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.92 seconds
21:21:26.468973 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:26.469220 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:26.515262 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:26.518253 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:26.518631 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:26.633457 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.99 seconds
21:21:26.637285 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:26.633950 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:21:26.640156 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:26.640424 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr'
      and table_schema = 'stg'
  
21:21:26.637631 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:26.681883 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:26.687935 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:26.688288 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:26.689567 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:26.689784 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCount_Incr__dbt_tmp"
    
21:21:26.688546 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:26.718365 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:21:26.721455 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:26.721771 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr'
      and table_schema = 'stg'
  
21:21:26.745538 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:21:26.747217 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:26.747492 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    
21:21:26.782789 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:21:26.787324 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:26.787669 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:26.827185 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:26.828836 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:26.829080 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Banners_Incr__dbt_tmp"
    
21:21:28.149959 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.40 seconds
21:21:28.151665 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:28.151868 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:28.152193 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.46 seconds
21:21:28.153716 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:28.153935 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:28.196385 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.37 seconds
21:21:28.199274 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:28.199571 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:28.218535 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:21:28.221068 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:28.221345 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:28.245975 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:28.248677 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:28.248953 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:28.256890 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:21:28.259158 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:28.259392 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:28.459710 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:21:28.463087 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:28.463415 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr'
      and table_schema = 'stg'
  
21:21:28.547903 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:21:28.551249 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:28.548406 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:21:28.553385 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Banners_Incr"
21:21:28.553889 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:28.554060 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Banners_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Banners_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Banners_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Banners_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Banners_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaID", "LinkURI", "BannerLocation", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaID", "LinkURI", "BannerLocation", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Banners_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:21:28.551582 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr'
      and table_schema = 'stg'
  
21:21:28.557718 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:21:28.561739 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:28.561987 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:28.586471 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:28.590839 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:28.591206 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:28.607626 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:28.609290 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:28.609556 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    
21:21:28.631189 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:28.632840 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:28.633097 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCount_Incr__dbt_tmp"
    
21:21:29.746946 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.11 seconds
21:21:29.748670 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:29.748860 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:29.786120 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:29.788865 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:29.789127 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:30.059322 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.45 seconds
21:21:30.061100 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:30.061365 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:30.086508 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.53 seconds
21:21:30.088744 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Banners_Incr: COMMIT
21:21:30.089660 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:21:30.089871 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."#AH_Banners_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Banners_Incr__dbt_tmp"
    end

21:21:30.096332 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:30.098904 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:30.099147 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:30.105539 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
21:21:30.108371 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:30.108621 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr'
      and table_schema = 'stg'
  
21:21:30.132277 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:30.147343 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:30.151113 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:30.151516 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:30.147197 [debug] [Thread-1  ]: finished collecting timing info
21:21:30.151749 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Banners_Incr: Close
21:21:30.152651 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5598726a0>]}
21:21:30.153226 [info ] [Thread-1  ]: 7 of 101 OK snapshotted stg.AH_Banners_Incr..................................... [[32mOK[0m in 13.43s]
21:21:30.153615 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Banners_Incr
21:21:30.153797 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_CategoryCustomFields_Incr
21:21:30.154175 [info ] [Thread-1  ]: 11 of 101 START snapshot stg.AH_CategoryCustomFields_Incr....................... [RUN]
21:21:30.154619 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr"
21:21:30.154782 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_CategoryCustomFields_Incr
21:21:30.154916 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_CategoryCustomFields_Incr
21:21:30.157715 [debug] [Thread-1  ]: finished collecting timing info
21:21:30.157912 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_CategoryCustomFields_Incr
21:21:30.160725 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:30.160917 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:21:30.161036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:21:30.161165 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:21:30.195348 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:30.197106 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:30.197399 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCount_Incr__dbt_tmp"
    
21:21:30.299042 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:21:30.329534 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:21:30.353310 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:30.353716 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:21:30.371386 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:21:30.373660 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_BiddingTransactions_Incr"
21:21:30.374282 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:30.374466 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_BiddingTransactions_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr" (
                  "ID", "TransactionID", "Maxmindscore", "Amount", "ListingActionID", "CreditCardID", "Active", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "TransactionID", "Maxmindscore", "Amount", "ListingActionID", "CreditCardID", "Active", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:21:30.385903 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:30.388316 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:30.388573 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CategoryCustomFields_InterView]
        ) as __dbt_sbq
    
21:21:30.440447 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:30.462910 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:30.463308 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr"
        ) as __dbt_sbq
    
21:21:30.531211 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:21:30.535251 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:30.535560 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr'
      and table_schema = 'stg'
  
21:21:30.634191 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:21:30.637707 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:30.638007 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
        
  
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CategoryCustomFields_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CategoryCustomFields_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:30.359643'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:30.359643'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:21:30.359643''), CONVERT(DATETIME2, ''2022-09-18 21:21:30.359643'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:21:30.359643'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:30.359643'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:30.359643'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:21:30.359643'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CategoryCustomFields_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_temp_view"
    end



    
21:21:31.189035 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.99 seconds
21:21:31.190850 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:31.191135 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:31.226410 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:31.229034 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:31.229323 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:31.555072 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
21:21:31.557239 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CategoryCount_Incr"
21:21:31.557799 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:31.557977 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CategoryCount_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr" (
                  "ID", "Count", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Count", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CategoryCount_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:21:31.643087 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.27 seconds
21:21:31.644926 [debug] [Thread-2  ]: On snapshot.Shawn.AH_BiddingTransactions_Incr: COMMIT
21:21:31.645838 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:21:31.646042 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."#AH_BiddingTransactions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    end

21:21:31.784744 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:21:31.798504 [debug] [Thread-2  ]: finished collecting timing info
21:21:31.798957 [debug] [Thread-2  ]: On snapshot.Shawn.AH_BiddingTransactions_Incr: Close
21:21:31.799767 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559872c10>]}
21:21:31.800292 [info ] [Thread-2  ]: 8 of 101 OK snapshotted stg.AH_BiddingTransactions_Incr......................... [[32mOK[0m in 13.89s]
21:21:31.800683 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_BiddingTransactions_Incr
21:21:31.800863 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_CategoryListingTypes_Incr
21:21:31.801272 [info ] [Thread-2  ]: 12 of 101 START snapshot stg.AH_CategoryListingTypes_Incr....................... [RUN]
21:21:31.801717 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr"
21:21:31.801870 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_CategoryListingTypes_Incr
21:21:31.802008 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_CategoryListingTypes_Incr
21:21:31.804958 [debug] [Thread-2  ]: finished collecting timing info
21:21:31.805157 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_CategoryListingTypes_Incr
21:21:31.808084 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:31.808265 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:21:31.808383 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:21:31.808510 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:21:31.938464 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:21:32.050361 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:21:32.073468 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:32.073876 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:21:32.107008 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:32.109684 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:32.109973 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CategoryListingTypes_InterView]
        ) as __dbt_sbq
    
21:21:32.267406 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:21:32.290334 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:32.290753 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr"
        ) as __dbt_sbq
    
21:21:32.382010 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:21:32.385479 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:32.385799 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr'
      and table_schema = 'stg'
  
21:21:32.463135 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:21:32.467056 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:32.467406 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
        
  
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CategoryListingTypes_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CategoryListingTypes_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:32.078592'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:32.078592'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:21:32.078592''), CONVERT(DATETIME2, ''2022-09-18 21:21:32.078592'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:21:32.078592'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:32.078592'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:32.078592'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:21:32.078592'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CategoryListingTypes_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_temp_view"
    end



    
21:21:33.784929 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.23 seconds
21:21:33.786742 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CategoryCount_Incr: COMMIT
21:21:33.787522 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:21:33.787680 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."#AH_CategoryCount_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryCount_Incr__dbt_tmp"
    end

21:21:33.836491 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:33.852131 [debug] [Thread-4  ]: finished collecting timing info
21:21:33.852556 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CategoryCount_Incr: Close
21:21:33.853317 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc558730340>]}
21:21:33.853812 [info ] [Thread-4  ]: 10 of 101 OK snapshotted stg.AH_CategoryCount_Incr.............................. [[32mOK[0m in 11.86s]
21:21:33.854199 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_CategoryCount_Incr
21:21:33.854383 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_CategoryListings_Incr
21:21:33.854817 [info ] [Thread-4  ]: 13 of 101 START snapshot stg.AH_CategoryListings_Incr........................... [RUN]
21:21:33.855263 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CategoryListings_Incr"
21:21:33.855421 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_CategoryListings_Incr
21:21:33.855557 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_CategoryListings_Incr
21:21:33.858336 [debug] [Thread-4  ]: finished collecting timing info
21:21:33.858620 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_CategoryListings_Incr
21:21:33.861443 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:33.861622 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:21:33.861743 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:21:33.861873 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:21:33.982127 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:21:34.052845 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:21:34.075904 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:34.076306 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:21:34.104272 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:34.106573 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:34.107184 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CategoryListings_InterView]
        ) as __dbt_sbq
    
21:21:34.160911 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:34.182883 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:34.183277 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr"
        ) as __dbt_sbq
    
21:21:34.433469 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:21:34.436995 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:34.437313 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr'
      and table_schema = 'stg'
  
21:21:34.510525 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:21:34.514358 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:34.514699 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
        
  
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryListings_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CategoryListings_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryListings_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CategoryListings_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CategoryListings_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:34.078465'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:34.078465'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:21:34.078465''), CONVERT(DATETIME2, ''2022-09-18 21:21:34.078465'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:21:34.078465'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:34.078465'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:34.078465'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:21:34.078465'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CategoryListings_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CategoryListings_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryListings_Incr__dbt_tmp_temp_view"
    end



    
21:21:37.449548 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 18.55 seconds
21:21:37.453096 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:37.453330 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:37.495650 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:37.497253 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:37.497489 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Categories_Incr__dbt_tmp"
    
21:21:39.363873 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.87 seconds
21:21:39.365559 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:39.365814 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:39.489153 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:21:39.492095 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:39.492363 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:40.158807 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.67 seconds
21:21:40.161901 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:40.162226 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr'
      and table_schema = 'stg'
  
21:21:40.250778 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:21:40.255404 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:40.255680 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:40.410459 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:21:40.412120 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:40.412366 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Categories_Incr__dbt_tmp"
    
21:21:43.091208 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 10.62 seconds
21:21:43.094866 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:43.095141 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:43.172966 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:21:43.174654 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:43.174903 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    
21:21:43.744218 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.33 seconds
21:21:43.745822 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:43.746009 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:43.893942 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:21:43.896875 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:43.897113 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:44.394004 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.50 seconds
21:21:44.397202 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:44.397442 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr'
      and table_schema = 'stg'
  
21:21:44.470255 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:21:44.476117 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:44.476382 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:44.562236 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:21:44.635732 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:44.636082 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Categories_Incr__dbt_tmp"
    
21:21:45.228333 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.05 seconds
21:21:45.229997 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:45.230242 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:45.341505 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:21:45.344162 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:45.344425 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:45.678394 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
21:21:45.681519 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:45.681777 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr'
      and table_schema = 'stg'
  
21:21:45.733311 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:45.737559 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:45.737811 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:45.795302 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:21:45.796818 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:45.797052 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    
21:21:46.703506 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.07 seconds
21:21:46.705146 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:46.705342 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:46.757008 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:46.760276 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:46.760528 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:47.087406 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
21:21:47.090198 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Categories_Incr"
21:21:47.090800 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:47.090989 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Categories_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Categories_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Categories_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Categories_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Categories_Incr" (
                  "ID", "ParentCategoryID", "DisplayOrder", "Lft", "Rgt", "CreatedOn", "UpdatedOn", "DeletedOn", "RolesAllowed", "EnabledCustomProperty", "MetaKeyWords", "MetaDescription", "PageTitle", "Pagecontent", "Name", "LastUpdatedUser", "Type", "MvcAction", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "ParentCategoryID", "DisplayOrder", "Lft", "Rgt", "CreatedOn", "UpdatedOn", "DeletedOn", "RolesAllowed", "EnabledCustomProperty", "MetaKeyWords", "MetaDescription", "PageTitle", "Pagecontent", "Name", "LastUpdatedUser", "Type", "MvcAction", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Categories_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:21:47.672998 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.88 seconds
21:21:47.674673 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:47.674890 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:47.726420 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:47.729483 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:47.729736 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:48.034966 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
21:21:48.038146 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:48.038415 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr'
      and table_schema = 'stg'
  
21:21:48.093471 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:48.097652 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:48.097923 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:48.183688 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:21:48.185335 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:48.185589 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    
21:21:49.211348 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.12 seconds
21:21:49.213360 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Categories_Incr: COMMIT
21:21:49.214128 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:21:49.214274 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."#AH_Categories_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Categories_Incr__dbt_tmp"
    end

21:21:49.279235 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:21:49.291637 [debug] [Thread-3  ]: finished collecting timing info
21:21:49.291985 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Categories_Incr: Close
21:21:49.292684 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559872d60>]}
21:21:49.293190 [info ] [Thread-3  ]: 9 of 101 OK snapshotted stg.AH_Categories_Incr.................................. [[32mOK[0m in 30.82s]
21:21:49.293565 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Categories_Incr
21:21:49.293760 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Contactus_Incr
21:21:49.294150 [info ] [Thread-3  ]: 14 of 101 START snapshot stg.AH_Contactus_Incr.................................. [RUN]
21:21:49.294586 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Contactus_Incr"
21:21:49.294744 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Contactus_Incr
21:21:49.294874 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Contactus_Incr
21:21:49.297612 [debug] [Thread-3  ]: finished collecting timing info
21:21:49.297801 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Contactus_Incr
21:21:49.300597 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:21:49.300786 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:21:49.300905 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:21:49.301034 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:21:49.322721 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.14 seconds
21:21:49.324134 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:49.324338 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:49.365712 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:49.368426 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:49.368688 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:49.416457 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:21:49.473766 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:21:49.496666 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:21:49.497040 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:21:49.532732 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:49.534987 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:21:49.535248 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Contactus_InterView]
        ) as __dbt_sbq
    
21:21:49.612151 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:21:49.634782 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:21:49.635157 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Contactus_Incr"
        ) as __dbt_sbq
    
21:21:49.668507 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:21:49.670754 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CategoryListingTypes_Incr"
21:21:49.671268 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:49.671435 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CategoryListingTypes_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr" (
                  "ID", "CategoryID", "ListingTypeID", "CreatedOn", "UpdatedOn", "DeletedOn", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CategoryID", "ListingTypeID", "CreatedOn", "UpdatedOn", "DeletedOn", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:21:49.746873 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 19.11 seconds
21:21:49.750567 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:49.750826 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:49.819379 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:21:49.820983 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:49.821224 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    
21:21:49.822451 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:21:49.825395 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:21:49.825572 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr'
      and table_schema = 'stg'
  
21:21:49.892716 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:21:49.895945 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:21:49.896202 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
        
  
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Contactus_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Contactus_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Contactus_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Contactus_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Contactus_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Contactus_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:49.516238'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:49.516238'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:21:49.516238''), CONVERT(DATETIME2, ''2022-09-18 21:21:49.516238'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:21:49.516238'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:49.516238'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:49.516238'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:21:49.516238'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Contactus_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Contactus_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Contactus_Incr__dbt_tmp_temp_view"
    end



    
21:21:49.926631 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 15.41 seconds
21:21:49.930163 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:49.930430 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:49.977069 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:49.978753 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:49.978998 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListings_Incr__dbt_tmp"
    
21:21:51.211470 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.39 seconds
21:21:51.213193 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:51.213434 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:51.265672 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.59 seconds
21:21:51.267490 [debug] [Thread-2  ]: On snapshot.Shawn.AH_CategoryListingTypes_Incr: COMMIT
21:21:51.268636 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:21:51.268838 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    end

21:21:51.293609 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:21:51.296297 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:51.296564 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:51.324624 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:21:51.338341 [debug] [Thread-2  ]: finished collecting timing info
21:21:51.338776 [debug] [Thread-2  ]: On snapshot.Shawn.AH_CategoryListingTypes_Incr: Close
21:21:51.339547 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559862040>]}
21:21:51.340099 [info ] [Thread-2  ]: 12 of 101 OK snapshotted stg.AH_CategoryListingTypes_Incr....................... [[32mOK[0m in 19.54s]
21:21:51.340505 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_CategoryListingTypes_Incr
21:21:51.340705 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Contents_Incr
21:21:51.341108 [info ] [Thread-2  ]: 15 of 101 START snapshot stg.AH_Contents_Incr................................... [RUN]
21:21:51.341543 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Contents_Incr"
21:21:51.341695 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Contents_Incr
21:21:51.341831 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Contents_Incr
21:21:51.344610 [debug] [Thread-2  ]: finished collecting timing info
21:21:51.344817 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Contents_Incr
21:21:51.347670 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:21:51.347849 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:21:51.347971 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:21:51.348100 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:21:51.400445 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.42 seconds
21:21:51.401985 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:51.402215 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:51.470828 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:21:51.495514 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:21:51.498157 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:51.498420 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:51.510362 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:21:51.532649 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:21:51.532928 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:21:51.551360 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:21:51.554008 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:51.554240 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr'
      and table_schema = 'stg'
  
21:21:51.560724 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:51.562750 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:21:51.562947 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Contents_InterView]
        ) as __dbt_sbq
    
21:21:51.589962 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:51.594317 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:51.594667 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:51.619784 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:21:51.639031 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:51.640447 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:51.640691 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    
21:21:51.644567 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:21:51.644776 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Contents_Incr"
        ) as __dbt_sbq
    
21:21:51.716873 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:21:51.720674 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:21:51.720921 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr'
      and table_schema = 'stg'
  
21:21:51.758769 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:21:51.761872 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:51.762194 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr'
      and table_schema = 'stg'
  
21:21:51.794416 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:21:51.798162 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:21:51.798444 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
        
  
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Contents_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Contents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Contents_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Contents_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Contents_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Contents_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:51.547517'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:51.547517'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:21:51.547517''), CONVERT(DATETIME2, ''2022-09-18 21:21:51.547517'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:21:51.547517'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:51.547517'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:51.547517'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:21:51.547517'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.Usehtmleditor != source_data.Usehtmleditor
        or
        (
            ((snapshotted_data.Usehtmleditor is null) and not (source_data.Usehtmleditor is null))
            or
            ((not snapshotted_data.Usehtmleditor is null) and (source_data.Usehtmleditor is null))
        ) or snapshotted_data.Userdefined != source_data.Userdefined
        or
        (
            ((snapshotted_data.Userdefined is null) and not (source_data.Userdefined is null))
            or
            ((not snapshotted_data.Userdefined is null) and (source_data.Userdefined is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Text != source_data.Text
        or
        (
            ((snapshotted_data.Text is null) and not (source_data.Text is null))
            or
            ((not snapshotted_data.Text is null) and (source_data.Text is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.PageTitle != source_data.PageTitle
        or
        (
            ((snapshotted_data.PageTitle is null) and not (source_data.PageTitle is null))
            or
            ((not snapshotted_data.PageTitle is null) and (source_data.PageTitle is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.Usehtmleditor != source_data.Usehtmleditor
        or
        (
            ((snapshotted_data.Usehtmleditor is null) and not (source_data.Usehtmleditor is null))
            or
            ((not snapshotted_data.Usehtmleditor is null) and (source_data.Usehtmleditor is null))
        ) or snapshotted_data.Userdefined != source_data.Userdefined
        or
        (
            ((snapshotted_data.Userdefined is null) and not (source_data.Userdefined is null))
            or
            ((not snapshotted_data.Userdefined is null) and (source_data.Userdefined is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Text != source_data.Text
        or
        (
            ((snapshotted_data.Text is null) and not (source_data.Text is null))
            or
            ((not snapshotted_data.Text is null) and (source_data.Text is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.PageTitle != source_data.PageTitle
        or
        (
            ((snapshotted_data.PageTitle is null) and not (source_data.PageTitle is null))
            or
            ((not snapshotted_data.PageTitle is null) and (source_data.PageTitle is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Contents_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Contents_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Contents_Incr__dbt_tmp_temp_view"
    end



    
21:21:51.805286 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:51.809017 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:51.809227 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:51.851190 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:51.852756 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:51.852992 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListings_Incr__dbt_tmp"
    
21:21:52.855800 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.21 seconds
21:21:52.857442 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:52.857621 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:52.891253 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:52.893878 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:52.894129 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:53.042738 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.19 seconds
21:21:53.044450 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:53.044688 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:53.114070 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:21:53.117016 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:53.117264 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:53.172447 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:21:53.175130 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:53.175351 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr'
      and table_schema = 'stg'
  
21:21:53.210816 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:53.215486 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:53.215764 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:53.269167 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:53.270844 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:53.271089 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    
21:21:53.326418 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:21:53.329060 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:53.329272 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr'
      and table_schema = 'stg'
  
21:21:53.363407 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:53.368096 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:53.368410 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:53.414754 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:53.416350 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:53.416570 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListings_Incr__dbt_tmp"
    
21:21:54.319266 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
21:21:54.320892 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:54.321073 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:54.373613 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:54.376140 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:54.376345 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:54.654420 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:21:54.656741 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CategoryCustomFields_Incr"
21:21:54.657371 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:54.657567 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CategoryCustomFields_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "CategoryID", "CustomFieldID", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "CategoryID", "CustomFieldID", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:21:54.704202 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.29 seconds
21:21:54.705887 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:54.706122 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:54.763594 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:21:54.766081 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:54.766363 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:55.001790 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:21:55.003969 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CategoryListings_Incr"
21:21:55.004502 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:55.004687 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CategoryListings_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr" (
                  "ID", "DeletedOn", "CreatedOn", "UpdatedOn", "ListingID", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DeletedOn", "CreatedOn", "UpdatedOn", "ListingID", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CategoryListings_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:21:55.095995 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 5.20 seconds
21:21:55.102020 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:21:55.102307 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:55.142315 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:55.143966 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:21:55.144209 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contactus_Incr__dbt_tmp"
    
21:21:56.652934 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.00 seconds
21:21:56.654683 [debug] [Thread-1  ]: On snapshot.Shawn.AH_CategoryCustomFields_Incr: COMMIT
21:21:56.655690 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:21:56.655840 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    end

21:21:56.702959 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:56.715760 [debug] [Thread-1  ]: finished collecting timing info
21:21:56.716178 [debug] [Thread-1  ]: On snapshot.Shawn.AH_CategoryCustomFields_Incr: Close
21:21:56.716965 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559872eb0>]}
21:21:56.717472 [info ] [Thread-1  ]: 11 of 101 OK snapshotted stg.AH_CategoryCustomFields_Incr....................... [[32mOK[0m in 26.56s]
21:21:56.717860 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_CategoryCustomFields_Incr
21:21:56.718043 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Countries_Incr
21:21:56.718438 [info ] [Thread-1  ]: 16 of 101 START snapshot stg.AH_Countries_Incr.................................. [RUN]
21:21:56.718910 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Countries_Incr"
21:21:56.719060 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Countries_Incr
21:21:56.719208 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Countries_Incr
21:21:56.722077 [debug] [Thread-1  ]: finished collecting timing info
21:21:56.722287 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Countries_Incr
21:21:56.725475 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:21:56.725669 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:21:56.725789 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:21:56.725921 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:21:56.844036 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:21:56.882447 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:21:56.905396 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:21:56.905819 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:21:56.938505 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:56.940752 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:21:56.941342 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Countries_InterView]
        ) as __dbt_sbq
    
21:21:56.947486 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.80 seconds
21:21:56.949104 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:21:56.949339 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:57.003141 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:21:57.003668 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.00 seconds
21:21:57.005219 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CategoryListings_Incr: COMMIT
21:21:57.006096 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:21:57.006292 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."#AH_CategoryListings_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryListings_Incr__dbt_tmp"
    end

21:21:57.023614 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:21:57.026035 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:21:57.026369 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:57.031480 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:21:57.031802 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Countries_Incr"
        ) as __dbt_sbq
    
21:21:57.067743 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:21:57.081472 [debug] [Thread-4  ]: finished collecting timing info
21:21:57.081923 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CategoryListings_Incr: Close
21:21:57.082773 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5598622e0>]}
21:21:57.083296 [info ] [Thread-4  ]: 13 of 101 OK snapshotted stg.AH_CategoryListings_Incr........................... [[32mOK[0m in 23.23s]
21:21:57.083680 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_CategoryListings_Incr
21:21:57.083859 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_CreditCardTypes_Incr
21:21:57.084265 [info ] [Thread-4  ]: 17 of 101 START snapshot stg.AH_CreditCardTypes_Incr............................ [RUN]
21:21:57.084711 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr"
21:21:57.084864 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_CreditCardTypes_Incr
21:21:57.085002 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_CreditCardTypes_Incr
21:21:57.087902 [debug] [Thread-4  ]: finished collecting timing info
21:21:57.088183 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_CreditCardTypes_Incr
21:21:57.091192 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:21:57.091380 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:21:57.091500 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:21:57.091628 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:21:57.137554 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:21:57.141153 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:21:57.141474 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr'
      and table_schema = 'stg'
  
21:21:57.196711 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:21:57.223206 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:21:57.227596 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:21:57.228026 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:21:57.228170 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
        
  
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Countries_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Countries_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Countries_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Countries_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Countries_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Countries_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:56.922599'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:56.922599'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:21:56.922599''), CONVERT(DATETIME2, ''2022-09-18 21:21:56.922599'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:21:56.922599'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:56.922599'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:56.922599'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:21:56.922599'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.StateRequired != source_data.StateRequired
        or
        (
            ((snapshotted_data.StateRequired is null) and not (source_data.StateRequired is null))
            or
            ((not snapshotted_data.StateRequired is null) and (source_data.StateRequired is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.StateRequired != source_data.StateRequired
        or
        (
            ((snapshotted_data.StateRequired is null) and not (source_data.StateRequired is null))
            or
            ((not snapshotted_data.StateRequired is null) and (source_data.StateRequired is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Countries_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Countries_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Countries_Incr__dbt_tmp_temp_view"
    end



    
21:21:57.251410 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:21:57.251806 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:21:57.280085 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:21:57.282906 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:21:57.283233 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CreditCardTypes_InterView]
        ) as __dbt_sbq
    
21:21:57.308473 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:21:57.311539 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:21:57.311889 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr'
      and table_schema = 'stg'
  
21:21:57.343819 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:21:57.358630 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:57.362390 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:21:57.371445 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:57.371028 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:21:57.371823 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr"
        ) as __dbt_sbq
    
21:21:57.408920 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:57.410625 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:21:57.410896 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contactus_Incr__dbt_tmp"
    
21:21:57.421370 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:57.424732 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:21:57.425044 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr'
      and table_schema = 'stg'
  
21:21:57.493864 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:21:57.497845 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:21:57.498189 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
        
  
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCardTypes_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CreditCardTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CreditCardTypes_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CreditCardTypes_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:57.266408'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:57.266408'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:21:57.266408''), CONVERT(DATETIME2, ''2022-09-18 21:21:57.266408'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:21:57.266408'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:21:57.266408'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:21:57.266408'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:21:57.266408'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CreditCardTypes_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCardTypes_Incr__dbt_tmp_temp_view"
    end



    
21:21:58.658721 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.25 seconds
21:21:58.660349 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:21:58.660550 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:21:58.696460 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:58.699019 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:21:58.699223 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:58.991692 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:21:58.995259 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:21:58.995609 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr'
      and table_schema = 'stg'
  
21:21:59.039360 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:21:59.043980 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:21:59.044354 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:21:59.090977 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:21:59.092632 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:21:59.092888 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contactus_Incr__dbt_tmp"
    
21:22:00.801350 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.71 seconds
21:22:00.803012 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:22:00.803203 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:00.872512 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:00.875282 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:22:00.875586 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:01.130049 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:22:01.132210 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Contactus_Incr"
21:22:01.132664 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:22:01.132794 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Contactus_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Contactus_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Contactus_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Contactus_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Contactus_Incr" (
                  "ID", "Email", "FirstName", "LastName", "Message", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Email", "FirstName", "LastName", "Message", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Contactus_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:22:03.108797 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.98 seconds
21:22:03.110648 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Contactus_Incr: COMMIT
21:22:03.111819 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:22:03.112022 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."#AH_Contactus_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Contactus_Incr__dbt_tmp"
    end

21:22:03.161618 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:03.175099 [debug] [Thread-3  ]: finished collecting timing info
21:22:03.175467 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Contactus_Incr: Close
21:22:03.176199 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559862190>]}
21:22:03.176707 [info ] [Thread-3  ]: 14 of 101 OK snapshotted stg.AH_Contactus_Incr.................................. [[32mOK[0m in 13.88s]
21:22:03.177097 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Contactus_Incr
21:22:03.177278 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr
21:22:03.177674 [info ] [Thread-3  ]: 18 of 101 START snapshot stg.AH_CreditCardsExtraInFormation_Incr................ [RUN]
21:22:03.178095 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr"
21:22:03.178248 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr
21:22:03.178378 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr
21:22:03.181102 [debug] [Thread-3  ]: finished collecting timing info
21:22:03.181300 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr
21:22:03.184058 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:03.184235 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:22:03.184363 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:22:03.184500 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:22:03.298300 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:22:03.330578 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:22:03.354204 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:03.354568 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:22:03.395448 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:03.397699 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:03.398509 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CreditCardsExtraInFormation_InterView]
        ) as __dbt_sbq
    
21:22:03.472738 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:03.495370 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:03.495757 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr"
        ) as __dbt_sbq
    
21:22:03.564365 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:03.568033 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:03.568307 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr'
      and table_schema = 'stg'
  
21:22:03.657729 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:22:03.661497 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:03.661769 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
        
  
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CreditCardsExtraInFormation_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:03.375834'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:03.375834'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:22:03.375834''), CONVERT(DATETIME2, ''2022-09-18 21:22:03.375834'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:22:03.375834'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:03.375834'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:03.375834'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:22:03.375834'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Cvv != source_data.Cvv
        or
        (
            ((snapshotted_data.Cvv is null) and not (source_data.Cvv is null))
            or
            ((not snapshotted_data.Cvv is null) and (source_data.Cvv is null))
        ) or snapshotted_data.CreditCardID != source_data.CreditCardID
        or
        (
            ((snapshotted_data.CreditCardID is null) and not (source_data.CreditCardID is null))
            or
            ((not snapshotted_data.CreditCardID is null) and (source_data.CreditCardID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Cvv != source_data.Cvv
        or
        (
            ((snapshotted_data.Cvv is null) and not (source_data.Cvv is null))
            or
            ((not snapshotted_data.Cvv is null) and (source_data.Cvv is null))
        ) or snapshotted_data.CreditCardID != source_data.CreditCardID
        or
        (
            ((snapshotted_data.CreditCardID is null) and not (source_data.CreditCardID is null))
            or
            ((not snapshotted_data.CreditCardID is null) and (source_data.CreditCardID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view"
    end



    
21:22:03.915495 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 12.12 seconds
21:22:03.919225 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:22:03.919506 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:03.967706 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:03.969350 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:22:03.969601 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contents_Incr__dbt_tmp"
    
21:22:04.475129 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 6.98 seconds
21:22:04.478799 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:22:04.479081 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:04.519920 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:04.521572 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:22:04.521835 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    
21:22:05.078470 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.11 seconds
21:22:05.079964 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:22:05.080159 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:05.117101 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 7.88 seconds
21:22:05.120775 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:22:05.121109 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:05.151209 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:05.154115 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:22:05.154387 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:05.169801 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:05.171338 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:22:05.171562 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Countries_Incr__dbt_tmp"
    
21:22:05.404603 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:22:05.407718 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:22:05.407912 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr'
      and table_schema = 'stg'
  
21:22:05.446419 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:05.450795 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:22:05.451085 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:05.491940 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
21:22:05.493691 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:22:05.493937 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:05.494225 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:05.495340 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:22:05.495534 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contents_Incr__dbt_tmp"
    
21:22:05.570535 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:05.573152 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:22:05.573410 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:05.829067 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:22:05.832279 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:22:05.832581 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr'
      and table_schema = 'stg'
  
21:22:05.876293 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:05.880474 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:22:05.880771 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:05.928515 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:05.930143 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:22:05.930366 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    
21:22:06.127944 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
21:22:06.129685 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:22:06.129942 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:06.225202 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:22:06.227892 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:22:06.228178 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:06.509556 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:22:06.512756 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:22:06.513063 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr'
      and table_schema = 'stg'
  
21:22:06.591655 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:06.595817 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:22:06.596177 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:06.597976 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
21:22:06.599217 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:22:06.599407 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:06.631549 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:22:06.634383 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:22:06.634698 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:06.635494 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:06.636527 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:22:06.636700 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Countries_Incr__dbt_tmp"
    
21:22:06.854913 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:22:06.858100 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:22:06.858410 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr'
      and table_schema = 'stg'
  
21:22:06.914246 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:06.920894 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:22:06.921239 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:06.958909 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:06.960545 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:22:06.960816 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contents_Incr__dbt_tmp"
    
21:22:07.204662 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.27 seconds
21:22:07.206410 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:22:07.206699 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:07.254586 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:07.257235 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:22:07.257501 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:07.526655 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:22:07.529914 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:22:07.530196 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr'
      and table_schema = 'stg'
  
21:22:07.564312 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:22:07.568840 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:22:07.569158 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:07.632880 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:07.634141 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.97 seconds
21:22:07.636958 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:07.637149 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:07.637527 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:22:07.637799 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    
21:22:07.706574 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:07.708214 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:07.708468 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    
21:22:07.762040 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.13 seconds
21:22:07.763738 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:22:07.764015 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:07.802957 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:07.805942 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:22:07.806217 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:08.052549 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:22:08.055552 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:22:08.055815 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr'
      and table_schema = 'stg'
  
21:22:08.100900 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.14 seconds
21:22:08.102668 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:22:08.102917 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:08.116799 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:08.121453 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:22:08.121770 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:08.145072 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:08.147882 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:22:08.148161 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:08.166802 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:08.168336 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:22:08.168570 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Countries_Incr__dbt_tmp"
    
21:22:08.360207 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:22:08.362513 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Contents_Incr"
21:22:08.363038 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:22:08.363182 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Contents_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Contents_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Contents_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Contents_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Contents_Incr" (
                  "ID", "DisplayOrder", "Usehtmleditor", "Userdefined", "CreatedOn", "UpdatedOn", "DeletedOn", "Text", "Name", "Culture", "PageTitle", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DisplayOrder", "Usehtmleditor", "Userdefined", "CreatedOn", "UpdatedOn", "DeletedOn", "Text", "Name", "Culture", "PageTitle", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Contents_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:22:08.725483 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.09 seconds
21:22:08.727262 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:22:08.727493 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:08.762457 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
21:22:08.764431 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:08.764699 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:08.772848 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:08.775113 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:22:08.775324 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:08.852873 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:22:08.855506 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:08.855768 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:09.022753 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:22:09.025423 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CreditCardTypes_Incr"
21:22:09.026027 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:22:09.026216 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CreditCardTypes_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr" (
                  "ID", "Enabled", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Enabled", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:22:09.104590 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
21:22:09.106325 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:22:09.106607 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:09.143288 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:22:09.146299 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:09.146621 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr'
      and table_schema = 'stg'
  
21:22:09.153465 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:09.156290 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:22:09.156530 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:09.180621 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:22:09.184677 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:09.184980 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:09.226708 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:09.228361 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:09.228624 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    
21:22:09.387414 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:22:09.389746 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Countries_Incr"
21:22:09.390324 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:22:09.390501 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Countries_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Countries_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Countries_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Countries_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Countries_Incr" (
                  "ID", "Name", "Code", "CreatedOn", "UpdatedOn", "DeletedOn", "Enabled", "StateRequired", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Code", "CreatedOn", "UpdatedOn", "DeletedOn", "Enabled", "StateRequired", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Countries_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:22:09.715106 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.35 seconds
21:22:09.716926 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Contents_Incr: COMMIT
21:22:09.717770 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:22:09.717963 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."#AH_Contents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Contents_Incr__dbt_tmp"
    end

21:22:09.763910 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:09.778179 [debug] [Thread-2  ]: finished collecting timing info
21:22:09.778569 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Contents_Incr: Close
21:22:09.779296 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559862580>]}
21:22:09.779794 [info ] [Thread-2  ]: 15 of 101 OK snapshotted stg.AH_Contents_Incr................................... [[32mOK[0m in 18.44s]
21:22:09.780173 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Contents_Incr
21:22:09.780351 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Currencies_Incr
21:22:09.780749 [info ] [Thread-2  ]: 19 of 101 START snapshot stg.AH_Currencies_Incr................................. [RUN]
21:22:09.781165 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Currencies_Incr"
21:22:09.781317 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Currencies_Incr
21:22:09.781452 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Currencies_Incr
21:22:09.784166 [debug] [Thread-2  ]: finished collecting timing info
21:22:09.784472 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Currencies_Incr
21:22:09.787229 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:09.787406 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:22:09.787525 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:22:09.787652 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:22:09.906042 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:22:09.933909 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:22:09.956869 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:09.957258 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:22:09.985616 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:22:09.988013 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:09.988586 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Currencies_InterView]
        ) as __dbt_sbq
    
21:22:10.049567 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:10.071395 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:10.071752 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Currencies_Incr"
        ) as __dbt_sbq
    
21:22:10.135119 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:10.138749 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:10.139003 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr'
      and table_schema = 'stg'
  
21:22:10.257525 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:22:10.261838 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:10.262164 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
        
  
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Currencies_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Currencies_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Currencies_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Currencies_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Currencies_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Currencies_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:09.969672'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:09.969672'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:22:09.969672''), CONVERT(DATETIME2, ''2022-09-18 21:22:09.969672'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:22:09.969672'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:09.969672'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:09.969672'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:22:09.969672'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ConVersiontousd != source_data.ConVersiontousd
        or
        (
            ((snapshotted_data.ConVersiontousd is null) and not (source_data.ConVersiontousd is null))
            or
            ((not snapshotted_data.ConVersiontousd is null) and (source_data.ConVersiontousd is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ConVersiontousd != source_data.ConVersiontousd
        or
        (
            ((snapshotted_data.ConVersiontousd is null) and not (source_data.ConVersiontousd is null))
            or
            ((not snapshotted_data.ConVersiontousd is null) and (source_data.ConVersiontousd is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Currencies_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Currencies_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Currencies_Incr__dbt_tmp_temp_view"
    end



    
21:22:10.417865 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.39 seconds
21:22:10.419693 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CreditCardTypes_Incr: COMMIT
21:22:10.420571 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:22:10.420756 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."#AH_CreditCardTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    end

21:22:10.461586 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:10.475176 [debug] [Thread-4  ]: finished collecting timing info
21:22:10.475610 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CreditCardTypes_Incr: Close
21:22:10.476432 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5598626d0>]}
21:22:10.476951 [info ] [Thread-4  ]: 17 of 101 OK snapshotted stg.AH_CreditCardTypes_Incr............................ [[32mOK[0m in 13.39s]
21:22:10.477343 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_CreditCardTypes_Incr
21:22:10.477524 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_CustomFieldenums_Incr
21:22:10.477920 [info ] [Thread-4  ]: 20 of 101 START snapshot stg.AH_CustomFieldenums_Incr........................... [RUN]
21:22:10.478351 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr"
21:22:10.478503 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_CustomFieldenums_Incr
21:22:10.478677 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_CustomFieldenums_Incr
21:22:10.481594 [debug] [Thread-4  ]: finished collecting timing info
21:22:10.481801 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_CustomFieldenums_Incr
21:22:10.484762 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:10.484951 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:22:10.485072 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:22:10.485201 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:22:10.528880 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.30 seconds
21:22:10.530524 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:10.530796 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:10.565117 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:22:10.567756 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:10.568005 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:10.598183 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:22:10.631742 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:22:10.655263 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:10.655615 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:22:10.693156 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:10.695438 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:10.695682 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CustomFieldenums_InterView]
        ) as __dbt_sbq
    
21:22:10.764068 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:10.786444 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:10.786822 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr"
        ) as __dbt_sbq
    
21:22:10.834351 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.44 seconds
21:22:10.836195 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Countries_Incr: COMMIT
21:22:10.837060 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:22:10.837258 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."#AH_Countries_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Countries_Incr__dbt_tmp"
    end

21:22:10.880933 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:22:10.884854 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:10.885109 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr'
      and table_schema = 'stg'
  
21:22:10.893722 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:10.906432 [debug] [Thread-1  ]: finished collecting timing info
21:22:10.906799 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Countries_Incr: Close
21:22:10.907528 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559862430>]}
21:22:10.908000 [info ] [Thread-1  ]: 16 of 101 OK snapshotted stg.AH_Countries_Incr.................................. [[32mOK[0m in 14.19s]
21:22:10.908372 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Countries_Incr
21:22:10.908552 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_CustomFields_Incr
21:22:10.908927 [info ] [Thread-1  ]: 21 of 101 START snapshot stg.AH_CustomFields_Incr............................... [RUN]
21:22:10.909334 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CustomFields_Incr"
21:22:10.909493 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_CustomFields_Incr
21:22:10.909629 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_CustomFields_Incr
21:22:10.912339 [debug] [Thread-1  ]: finished collecting timing info
21:22:10.912585 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_CustomFields_Incr
21:22:10.915293 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:10.915474 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:22:10.915616 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:22:10.915748 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:22:10.953071 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:10.956835 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:10.957188 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
        
  
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CustomFieldenums_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CustomFieldenums_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CustomFieldenums_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CustomFieldenums_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:10.657194'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:10.657194'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:22:10.657194''), CONVERT(DATETIME2, ''2022-09-18 21:22:10.657194'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:22:10.657194'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:10.657194'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:10.657194'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:22:10.657194'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CustomFieldenums_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CustomFieldenums_Incr__dbt_tmp_temp_view"
    end



    
21:22:11.018639 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:22:11.046716 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:22:11.070198 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:11.070601 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:22:11.094627 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.53 seconds
21:22:11.097536 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:11.097815 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr'
      and table_schema = 'stg'
  
21:22:11.104910 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:22:11.107085 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:11.107298 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CustomFields_InterView]
        ) as __dbt_sbq
    
21:22:11.150905 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:11.155315 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:11.155569 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:11.191724 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:11.211374 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:11.212842 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:11.213086 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    
21:22:11.216295 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:11.216511 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr"
        ) as __dbt_sbq
    
21:22:11.311220 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:22:11.315255 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:11.315591 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr'
      and table_schema = 'stg'
  
21:22:11.403726 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:22:11.407709 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:11.407981 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
        
  
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CustomFields_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CustomFields_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CustomFields_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CustomFields_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CustomFields_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:11.079165'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:11.079165'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:22:11.079165''), CONVERT(DATETIME2, ''2022-09-18 21:22:11.079165'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:22:11.079165'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:11.079165'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:11.079165'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:22:11.079165'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Required != source_data.Required
        or
        (
            ((snapshotted_data.Required is null) and not (source_data.Required is null))
            or
            ((not snapshotted_data.Required is null) and (source_data.Required is null))
        ) or snapshotted_data.Deferred != source_data.Deferred
        or
        (
            ((snapshotted_data.Deferred is null) and not (source_data.Deferred is null))
            or
            ((not snapshotted_data.Deferred is null) and (source_data.Deferred is null))
        ) or snapshotted_data.Encrypted != source_data.Encrypted
        or
        (
            ((snapshotted_data.Encrypted is null) and not (source_data.Encrypted is null))
            or
            ((not snapshotted_data.Encrypted is null) and (source_data.Encrypted is null))
        ) or snapshotted_data.IncludeonInvoice != source_data.IncludeonInvoice
        or
        (
            ((snapshotted_data.IncludeonInvoice is null) and not (source_data.IncludeonInvoice is null))
            or
            ((not snapshotted_data.IncludeonInvoice is null) and (source_data.IncludeonInvoice is null))
        ) or snapshotted_data.IncludeinSalesReport != source_data.IncludeinSalesReport
        or
        (
            ((snapshotted_data.IncludeinSalesReport is null) and not (source_data.IncludeinSalesReport is null))
            or
            ((not snapshotted_data.IncludeinSalesReport is null) and (source_data.IncludeinSalesReport is null))
        ) or snapshotted_data.IncludeonInvoiceasSeller != source_data.IncludeonInvoiceasSeller
        or
        (
            ((snapshotted_data.IncludeonInvoiceasSeller is null) and not (source_data.IncludeonInvoiceasSeller is null))
            or
            ((not snapshotted_data.IncludeonInvoiceasSeller is null) and (source_data.IncludeonInvoiceasSeller is null))
        ) or snapshotted_data.IncludeonInvoiceasBuyer != source_data.IncludeonInvoiceasBuyer
        or
        (
            ((snapshotted_data.IncludeonInvoiceasBuyer is null) and not (source_data.IncludeonInvoiceasBuyer is null))
            or
            ((not snapshotted_data.IncludeonInvoiceasBuyer is null) and (source_data.IncludeonInvoiceasBuyer is null))
        ) or snapshotted_data.IncludeinSalesReportasSeller != source_data.IncludeinSalesReportasSeller
        or
        (
            ((snapshotted_data.IncludeinSalesReportasSeller is null) and not (source_data.IncludeinSalesReportasSeller is null))
            or
            ((not snapshotted_data.IncludeinSalesReportasSeller is null) and (source_data.IncludeinSalesReportasSeller is null))
        ) or snapshotted_data.IncludeinSalesReportasBuyer != source_data.IncludeinSalesReportasBuyer
        or
        (
            ((snapshotted_data.IncludeinSalesReportasBuyer is null) and not (source_data.IncludeinSalesReportasBuyer is null))
            or
            ((not snapshotted_data.IncludeinSalesReportasBuyer is null) and (source_data.IncludeinSalesReportasBuyer is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.VisiBIlity != source_data.VisiBIlity
        or
        (
            ((snapshotted_data.VisiBIlity is null) and not (source_data.VisiBIlity is null))
            or
            ((not snapshotted_data.VisiBIlity is null) and (source_data.VisiBIlity is null))
        ) or snapshotted_data.MutaBIlity != source_data.MutaBIlity
        or
        (
            ((snapshotted_data.MutaBIlity is null) and not (source_data.MutaBIlity is null))
            or
            ((not snapshotted_data.MutaBIlity is null) and (source_data.MutaBIlity is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.DefaultValue != source_data.DefaultValue
        or
        (
            ((snapshotted_data.DefaultValue is null) and not (source_data.DefaultValue is null))
            or
            ((not snapshotted_data.DefaultValue is null) and (source_data.DefaultValue is null))
        ) or snapshotted_data.GroupName != source_data.GroupName
        or
        (
            ((snapshotted_data.GroupName is null) and not (source_data.GroupName is null))
            or
            ((not snapshotted_data.GroupName is null) and (source_data.GroupName is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Required != source_data.Required
        or
        (
            ((snapshotted_data.Required is null) and not (source_data.Required is null))
            or
            ((not snapshotted_data.Required is null) and (source_data.Required is null))
        ) or snapshotted_data.Deferred != source_data.Deferred
        or
        (
            ((snapshotted_data.Deferred is null) and not (source_data.Deferred is null))
            or
            ((not snapshotted_data.Deferred is null) and (source_data.Deferred is null))
        ) or snapshotted_data.Encrypted != source_data.Encrypted
        or
        (
            ((snapshotted_data.Encrypted is null) and not (source_data.Encrypted is null))
            or
            ((not snapshotted_data.Encrypted is null) and (source_data.Encrypted is null))
        ) or snapshotted_data.IncludeonInvoice != source_data.IncludeonInvoice
        or
        (
            ((snapshotted_data.IncludeonInvoice is null) and not (source_data.IncludeonInvoice is null))
            or
            ((not snapshotted_data.IncludeonInvoice is null) and (source_data.IncludeonInvoice is null))
        ) or snapshotted_data.IncludeinSalesReport != source_data.IncludeinSalesReport
        or
        (
            ((snapshotted_data.IncludeinSalesReport is null) and not (source_data.IncludeinSalesReport is null))
            or
            ((not snapshotted_data.IncludeinSalesReport is null) and (source_data.IncludeinSalesReport is null))
        ) or snapshotted_data.IncludeonInvoiceasSeller != source_data.IncludeonInvoiceasSeller
        or
        (
            ((snapshotted_data.IncludeonInvoiceasSeller is null) and not (source_data.IncludeonInvoiceasSeller is null))
            or
            ((not snapshotted_data.IncludeonInvoiceasSeller is null) and (source_data.IncludeonInvoiceasSeller is null))
        ) or snapshotted_data.IncludeonInvoiceasBuyer != source_data.IncludeonInvoiceasBuyer
        or
        (
            ((snapshotted_data.IncludeonInvoiceasBuyer is null) and not (source_data.IncludeonInvoiceasBuyer is null))
            or
            ((not snapshotted_data.IncludeonInvoiceasBuyer is null) and (source_data.IncludeonInvoiceasBuyer is null))
        ) or snapshotted_data.IncludeinSalesReportasSeller != source_data.IncludeinSalesReportasSeller
        or
        (
            ((snapshotted_data.IncludeinSalesReportasSeller is null) and not (source_data.IncludeinSalesReportasSeller is null))
            or
            ((not snapshotted_data.IncludeinSalesReportasSeller is null) and (source_data.IncludeinSalesReportasSeller is null))
        ) or snapshotted_data.IncludeinSalesReportasBuyer != source_data.IncludeinSalesReportasBuyer
        or
        (
            ((snapshotted_data.IncludeinSalesReportasBuyer is null) and not (source_data.IncludeinSalesReportasBuyer is null))
            or
            ((not snapshotted_data.IncludeinSalesReportasBuyer is null) and (source_data.IncludeinSalesReportasBuyer is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.VisiBIlity != source_data.VisiBIlity
        or
        (
            ((snapshotted_data.VisiBIlity is null) and not (source_data.VisiBIlity is null))
            or
            ((not snapshotted_data.VisiBIlity is null) and (source_data.VisiBIlity is null))
        ) or snapshotted_data.MutaBIlity != source_data.MutaBIlity
        or
        (
            ((snapshotted_data.MutaBIlity is null) and not (source_data.MutaBIlity is null))
            or
            ((not snapshotted_data.MutaBIlity is null) and (source_data.MutaBIlity is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.DefaultValue != source_data.DefaultValue
        or
        (
            ((snapshotted_data.DefaultValue is null) and not (source_data.DefaultValue is null))
            or
            ((not snapshotted_data.DefaultValue is null) and (source_data.DefaultValue is null))
        ) or snapshotted_data.GroupName != source_data.GroupName
        or
        (
            ((snapshotted_data.GroupName is null) and not (source_data.GroupName is null))
            or
            ((not snapshotted_data.GroupName is null) and (source_data.GroupName is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CustomFields_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CustomFields_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CustomFields_Incr__dbt_tmp_temp_view"
    end



    
21:22:12.091709 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
21:22:12.093449 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:12.093698 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:12.127207 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:22:12.129763 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:12.130011 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:12.460177 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
21:22:12.462237 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr"
21:22:12.462708 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:12.462852 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr" (
                  "ID", "Cvv", "CreditCardID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Cvv", "CreditCardID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:22:14.164257 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.70 seconds
21:22:14.166356 [debug] [Thread-3  ]: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: COMMIT
21:22:14.167162 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:22:14.167307 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    end

21:22:14.462535 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:22:14.476849 [debug] [Thread-3  ]: finished collecting timing info
21:22:14.477217 [debug] [Thread-3  ]: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: Close
21:22:14.477938 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559862820>]}
21:22:14.478407 [info ] [Thread-3  ]: 18 of 101 OK snapshotted stg.AH_CreditCardsExtraInFormation_Incr................ [[32mOK[0m in 11.30s]
21:22:14.478822 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr
21:22:14.479004 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Customcurrencies_Incr
21:22:14.479379 [info ] [Thread-3  ]: 22 of 101 START snapshot stg.AH_Customcurrencies_Incr........................... [RUN]
21:22:14.479771 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr"
21:22:14.479921 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Customcurrencies_Incr
21:22:14.480052 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Customcurrencies_Incr
21:22:14.482748 [debug] [Thread-3  ]: finished collecting timing info
21:22:14.482939 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Customcurrencies_Incr
21:22:14.485685 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:14.485862 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:22:14.485980 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:22:14.486105 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:22:14.599285 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:22:14.626877 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:22:14.650257 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:14.650666 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:22:14.699139 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:14.701393 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:14.701939 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Customcurrencies_InterView]
        ) as __dbt_sbq
    
21:22:14.756607 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:14.778844 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:14.779189 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr"
        ) as __dbt_sbq
    
21:22:14.851351 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:14.854860 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:14.855110 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr'
      and table_schema = 'stg'
  
21:22:14.931538 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:14.935372 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:14.935635 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
        
  
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Customcurrencies_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Customcurrencies_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Customcurrencies_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Customcurrencies_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:14.657242'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:14.657242'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:22:14.657242''), CONVERT(DATETIME2, ''2022-09-18 21:22:14.657242'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:22:14.657242'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:14.657242'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:14.657242'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:22:14.657242'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Isocurrencysymbol != source_data.Isocurrencysymbol
        or
        (
            ((snapshotted_data.Isocurrencysymbol is null) and not (source_data.Isocurrencysymbol is null))
            or
            ((not snapshotted_data.Isocurrencysymbol is null) and (source_data.Isocurrencysymbol is null))
        ) or snapshotted_data.Currencysymbol != source_data.Currencysymbol
        or
        (
            ((snapshotted_data.Currencysymbol is null) and not (source_data.Currencysymbol is null))
            or
            ((not snapshotted_data.Currencysymbol is null) and (source_data.Currencysymbol is null))
        ) or snapshotted_data.CurrencyenglishName != source_data.CurrencyenglishName
        or
        (
            ((snapshotted_data.CurrencyenglishName is null) and not (source_data.CurrencyenglishName is null))
            or
            ((not snapshotted_data.CurrencyenglishName is null) and (source_data.CurrencyenglishName is null))
        ) or snapshotted_data.CurrencynativeName != source_data.CurrencynativeName
        or
        (
            ((snapshotted_data.CurrencynativeName is null) and not (source_data.CurrencynativeName is null))
            or
            ((not snapshotted_data.CurrencynativeName is null) and (source_data.CurrencynativeName is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Isocurrencysymbol != source_data.Isocurrencysymbol
        or
        (
            ((snapshotted_data.Isocurrencysymbol is null) and not (source_data.Isocurrencysymbol is null))
            or
            ((not snapshotted_data.Isocurrencysymbol is null) and (source_data.Isocurrencysymbol is null))
        ) or snapshotted_data.Currencysymbol != source_data.Currencysymbol
        or
        (
            ((snapshotted_data.Currencysymbol is null) and not (source_data.Currencysymbol is null))
            or
            ((not snapshotted_data.Currencysymbol is null) and (source_data.Currencysymbol is null))
        ) or snapshotted_data.CurrencyenglishName != source_data.CurrencyenglishName
        or
        (
            ((snapshotted_data.CurrencyenglishName is null) and not (source_data.CurrencyenglishName is null))
            or
            ((not snapshotted_data.CurrencyenglishName is null) and (source_data.CurrencyenglishName is null))
        ) or snapshotted_data.CurrencynativeName != source_data.CurrencynativeName
        or
        (
            ((snapshotted_data.CurrencynativeName is null) and not (source_data.CurrencynativeName is null))
            or
            ((not snapshotted_data.CurrencynativeName is null) and (source_data.CurrencynativeName is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Customcurrencies_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Customcurrencies_Incr__dbt_tmp_temp_view"
    end



    
21:22:16.030177 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 5.77 seconds
21:22:16.034304 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:16.034678 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:16.089744 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:16.091225 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:16.091449 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Currencies_Incr__dbt_tmp"
    
21:22:17.304347 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.21 seconds
21:22:17.305828 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:17.306000 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:17.412694 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:22:17.415295 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:17.415491 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:17.687129 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:22:17.690126 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:17.690309 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr'
      and table_schema = 'stg'
  
21:22:17.726441 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:17.730424 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:17.730670 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:17.788736 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:17.790255 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:17.790480 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Currencies_Incr__dbt_tmp"
    
21:22:17.852224 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 6.89 seconds
21:22:17.855524 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:17.855782 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:17.899380 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:17.900907 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:17.901145 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    
21:22:18.669061 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
21:22:18.670667 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:18.670850 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:18.708352 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:18.710950 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:18.711193 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:18.854083 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
21:22:18.855803 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:18.856060 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:18.942119 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:22:18.944795 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:18.945047 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:18.989312 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:22:18.992264 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:18.992504 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr'
      and table_schema = 'stg'
  
21:22:19.029974 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:19.034134 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:19.034385 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:19.096296 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:19.098006 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:19.098241 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Currencies_Incr__dbt_tmp"
    
21:22:19.243540 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:22:19.246798 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:19.247030 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr'
      and table_schema = 'stg'
  
21:22:19.301964 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:19.306316 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:19.306562 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:19.355605 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:19.357133 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:19.357378 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    
21:22:20.238944 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.14 seconds
21:22:20.244730 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:20.245048 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:20.303792 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:20.306691 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:20.306948 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:20.548998 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:22:20.551238 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Currencies_Incr"
21:22:20.551763 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:20.551929 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Currencies_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Currencies_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Currencies_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Currencies_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Currencies_Incr" (
                  "ID", "Code", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "ConVersiontousd", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Code", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "ConVersiontousd", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Currencies_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:22:20.703975 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.35 seconds
21:22:20.705667 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:20.705916 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:20.754865 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:20.757455 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:20.757691 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:20.981973 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:22:20.985247 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:20.985511 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr'
      and table_schema = 'stg'
  
21:22:21.061120 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:21.065682 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:21.065969 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:21.101540 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:21.103099 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:21.103336 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    
21:22:21.359797 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.42 seconds
21:22:21.363429 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:21.363677 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:21.405951 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:21.407643 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:21.407893 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    
21:22:22.068932 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.52 seconds
21:22:22.070766 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Currencies_Incr: COMMIT
21:22:22.071624 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:22:22.071833 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."#AH_Currencies_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Currencies_Incr__dbt_tmp"
    end

21:22:22.108566 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:22.122801 [debug] [Thread-2  ]: finished collecting timing info
21:22:22.123079 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Currencies_Incr: Close
21:22:22.123741 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5586ea2e0>]}
21:22:22.124188 [info ] [Thread-2  ]: 19 of 101 OK snapshotted stg.AH_Currencies_Incr................................. [[32mOK[0m in 12.34s]
21:22:22.124552 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Currencies_Incr
21:22:22.124727 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr
21:22:22.125095 [info ] [Thread-2  ]: 23 of 101 START snapshot stg.AH_DailyhuntEmailSubscribers_Incr.................. [RUN]
21:22:22.125488 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr"
21:22:22.125636 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr
21:22:22.125768 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr
21:22:22.128417 [debug] [Thread-2  ]: finished collecting timing info
21:22:22.128605 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr
21:22:22.131308 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:22.131482 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:22:22.131599 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:22:22.131725 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:22:22.232939 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:22:22.262852 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:22:22.285704 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:22.286076 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:22:22.315783 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.21 seconds
21:22:22.317488 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:22.317750 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:22.320392 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:22:22.322486 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:22.322692 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_DailyhuntEmailSubscribers_InterView]
        ) as __dbt_sbq
    
21:22:22.373745 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:22.376889 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:22.377195 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:22.395401 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:22.417205 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:22.417523 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr"
        ) as __dbt_sbq
    
21:22:22.520511 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:22:22.524534 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:22.524718 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.12 seconds
21:22:22.525983 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:22.526174 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:22.524910 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr'
      and table_schema = 'stg'
  
21:22:22.604113 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:22.607810 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:22.608006 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:22.610246 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:22.610421 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:22.608196 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
        
  
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_DailyhuntEmailSubscribers_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:22.297978'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:22.297978'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:22:22.297978''), CONVERT(DATETIME2, ''2022-09-18 21:22:22.297978'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:22:22.297978'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:22.297978'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:22.297978'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:22:22.297978'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ) or snapshotted_data.ZipCode != source_data.ZipCode
        or
        (
            ((snapshotted_data.ZipCode is null) and not (source_data.ZipCode is null))
            or
            ((not snapshotted_data.ZipCode is null) and (source_data.ZipCode is null))
        ) or snapshotted_data.ASenthusiast != source_data.ASenthusiast
        or
        (
            ((snapshotted_data.ASenthusiast is null) and not (source_data.ASenthusiast is null))
            or
            ((not snapshotted_data.ASenthusiast is null) and (source_data.ASenthusiast is null))
        ) or snapshotted_data.AsBidder != source_data.AsBidder
        or
        (
            ((snapshotted_data.AsBidder is null) and not (source_data.AsBidder is null))
            or
            ((not snapshotted_data.AsBidder is null) and (source_data.AsBidder is null))
        ) or snapshotted_data.AsConsignor != source_data.AsConsignor
        or
        (
            ((snapshotted_data.AsConsignor is null) and not (source_data.AsConsignor is null))
            or
            ((not snapshotted_data.AsConsignor is null) and (source_data.AsConsignor is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ) or snapshotted_data.ZipCode != source_data.ZipCode
        or
        (
            ((snapshotted_data.ZipCode is null) and not (source_data.ZipCode is null))
            or
            ((not snapshotted_data.ZipCode is null) and (source_data.ZipCode is null))
        ) or snapshotted_data.ASenthusiast != source_data.ASenthusiast
        or
        (
            ((snapshotted_data.ASenthusiast is null) and not (source_data.ASenthusiast is null))
            or
            ((not snapshotted_data.ASenthusiast is null) and (source_data.ASenthusiast is null))
        ) or snapshotted_data.AsBidder != source_data.AsBidder
        or
        (
            ((snapshotted_data.AsBidder is null) and not (source_data.AsBidder is null))
            or
            ((not snapshotted_data.AsBidder is null) and (source_data.AsBidder is null))
        ) or snapshotted_data.AsConsignor != source_data.AsConsignor
        or
        (
            ((snapshotted_data.AsConsignor is null) and not (source_data.AsConsignor is null))
            or
            ((not snapshotted_data.AsConsignor is null) and (source_data.AsConsignor is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view"
    end



    
21:22:22.620580 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:22:22.622033 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CustomFieldenums_Incr"
21:22:22.622459 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:22.622636 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CustomFieldenums_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr" (
                  "ID", "Name", "Value", "CreatedOn", "UpdatedOn", "DeletedOn", "CustomFieldID", "Enabled", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Value", "CreatedOn", "UpdatedOn", "DeletedOn", "CustomFieldID", "Enabled", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:22:22.920314 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
21:22:22.923267 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:22.923516 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr'
      and table_schema = 'stg'
  
21:22:22.960290 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:22.964632 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:22.964896 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:23.011284 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:23.012854 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:23.013093 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    
21:22:24.130702 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.51 seconds
21:22:24.132424 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CustomFieldenums_Incr: COMMIT
21:22:24.133472 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:22:24.133628 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."#AH_CustomFieldenums_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    end

21:22:24.180413 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:24.194674 [debug] [Thread-4  ]: finished collecting timing info
21:22:24.195061 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CustomFieldenums_Incr: Close
21:22:24.195811 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559862c10>]}
21:22:24.196321 [info ] [Thread-4  ]: 20 of 101 OK snapshotted stg.AH_CustomFieldenums_Incr........................... [[32mOK[0m in 13.72s]
21:22:24.196706 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_CustomFieldenums_Incr
21:22:24.196885 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Decorations_Incr
21:22:24.197279 [info ] [Thread-4  ]: 24 of 101 START snapshot stg.AH_Decorations_Incr................................ [RUN]
21:22:24.197697 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Decorations_Incr"
21:22:24.197852 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Decorations_Incr
21:22:24.197984 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Decorations_Incr
21:22:24.200782 [debug] [Thread-4  ]: finished collecting timing info
21:22:24.200982 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Decorations_Incr
21:22:24.203831 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:24.204008 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:22:24.204128 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:22:24.204256 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:22:24.334839 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:22:24.371118 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:22:24.394080 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:24.394420 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:22:24.421855 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:22:24.423958 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:24.424446 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Decorations_InterView]
        ) as __dbt_sbq
    
21:22:24.485586 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:24.507798 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:24.508114 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Decorations_Incr"
        ) as __dbt_sbq
    
21:22:24.671677 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:22:24.675317 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:24.675552 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr'
      and table_schema = 'stg'
  
21:22:24.740667 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.73 seconds
21:22:24.742591 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:24.742830 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:24.761814 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:22:24.765028 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:24.765234 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
        
  
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Decorations_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Decorations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Decorations_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Decorations_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Decorations_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Decorations_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:24.407383'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:24.407383'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:22:24.407383''), CONVERT(DATETIME2, ''2022-09-18 21:22:24.407383'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:22:24.407383'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:24.407383'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:24.407383'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:22:24.407383'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ValIDFields != source_data.ValIDFields
        or
        (
            ((snapshotted_data.ValIDFields is null) and not (source_data.ValIDFields is null))
            or
            ((not snapshotted_data.ValIDFields is null) and (source_data.ValIDFields is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.FormatString != source_data.FormatString
        or
        (
            ((snapshotted_data.FormatString is null) and not (source_data.FormatString is null))
            or
            ((not snapshotted_data.FormatString is null) and (source_data.FormatString is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ValIDFields != source_data.ValIDFields
        or
        (
            ((snapshotted_data.ValIDFields is null) and not (source_data.ValIDFields is null))
            or
            ((not snapshotted_data.ValIDFields is null) and (source_data.ValIDFields is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.FormatString != source_data.FormatString
        or
        (
            ((snapshotted_data.FormatString is null) and not (source_data.FormatString is null))
            or
            ((not snapshotted_data.FormatString is null) and (source_data.FormatString is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Decorations_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Decorations_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Decorations_Incr__dbt_tmp_temp_view"
    end



    
21:22:24.786164 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:24.788771 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:24.788999 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:25.059056 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:22:25.062243 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:25.062512 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr'
      and table_schema = 'stg'
  
21:22:25.108320 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:25.112974 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:25.113304 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:25.161597 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:25.163265 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:25.163511 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    
21:22:26.362898 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 14.95 seconds
21:22:26.366352 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:26.366695 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:26.451564 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:26.453113 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:26.453297 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFields_Incr__dbt_tmp"
    
21:22:27.298015 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.13 seconds
21:22:27.299822 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:27.300079 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:27.340739 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:27.343490 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:27.343751 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:27.509934 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
21:22:27.511705 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:27.511965 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:27.596249 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:27.599751 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:27.600058 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:27.636131 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:22:27.638424 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Customcurrencies_Incr"
21:22:27.639025 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:27.639209 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Customcurrencies_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Isocurrencysymbol", "Currencysymbol", "CurrencyenglishName", "CurrencynativeName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Isocurrencysymbol", "Currencysymbol", "CurrencyenglishName", "CurrencynativeName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Customcurrencies_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:22:27.894138 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:22:27.897164 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:27.898923 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr'
      and table_schema = 'stg'
  
21:22:27.935553 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:27.940047 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:27.940371 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:27.979109 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:28.064208 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:28.064590 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFields_Incr__dbt_tmp"
    
21:22:29.119824 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
21:22:29.121466 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:29.121654 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:29.184892 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:29.187558 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:29.187736 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:29.342410 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.70 seconds
21:22:29.344160 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Customcurrencies_Incr: COMMIT
21:22:29.345132 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:22:29.345285 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."#AH_Customcurrencies_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    end

21:22:29.409919 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:29.422797 [debug] [Thread-3  ]: finished collecting timing info
21:22:29.423222 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Customcurrencies_Incr: Close
21:22:29.424006 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5597fc880>]}
21:22:29.424546 [info ] [Thread-3  ]: 22 of 101 OK snapshotted stg.AH_Customcurrencies_Incr........................... [[32mOK[0m in 14.94s]
21:22:29.424958 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Customcurrencies_Incr
21:22:29.425142 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Emailtemplatecontents_Incr
21:22:29.425541 [info ] [Thread-3  ]: 25 of 101 START snapshot stg.AH_Emailtemplatecontents_Incr...................... [RUN]
21:22:29.425965 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr"
21:22:29.426120 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Emailtemplatecontents_Incr
21:22:29.426259 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Emailtemplatecontents_Incr
21:22:29.429084 [debug] [Thread-3  ]: finished collecting timing info
21:22:29.429282 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Emailtemplatecontents_Incr
21:22:29.432292 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:29.432472 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:22:29.432590 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:22:29.432721 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:22:29.545392 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
21:22:29.548579 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:29.548867 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr'
      and table_schema = 'stg'
  
21:22:29.553987 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:22:29.582675 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:22:29.587578 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:29.587897 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:29.601930 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:22:29.624799 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:29.625188 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:22:29.626372 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:29.627634 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:29.627822 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFields_Incr__dbt_tmp"
    
21:22:29.671625 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:29.674296 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:29.674656 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Emailtemplatecontents_InterView]
        ) as __dbt_sbq
    
21:22:29.741860 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:29.764529 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:29.764926 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr"
        ) as __dbt_sbq
    
21:22:30.030037 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:22:30.033617 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:30.033888 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr'
      and table_schema = 'stg'
  
21:22:30.122969 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:22:30.126575 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:30.126881 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
        
  
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Emailtemplatecontents_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:29.641886'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:29.641886'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:22:29.641886''), CONVERT(DATETIME2, ''2022-09-18 21:22:29.641886'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:22:29.641886'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:29.641886'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:29.641886'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:22:29.641886'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.SuBJect != source_data.SuBJect
        or
        (
            ((snapshotted_data.SuBJect is null) and not (source_data.SuBJect is null))
            or
            ((not snapshotted_data.SuBJect is null) and (source_data.SuBJect is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.SuBJect != source_data.SuBJect
        or
        (
            ((snapshotted_data.SuBJect is null) and not (source_data.SuBJect is null))
            or
            ((not snapshotted_data.SuBJect is null) and (source_data.SuBJect is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view"
    end



    
21:22:30.243275 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.63 seconds
21:22:30.247033 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:30.247325 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:30.293109 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:30.294788 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:30.295063 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    
21:22:30.712005 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.08 seconds
21:22:30.713857 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:30.714130 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:30.749673 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:30.752741 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:30.753089 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:31.014803 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:22:31.017358 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CustomFields_Incr"
21:22:31.017943 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:31.018124 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CustomFields_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr" (
                  "ID", "Required", "Deferred", "Encrypted", "IncludeonInvoice", "IncludeinSalesReport", "IncludeonInvoiceasSeller", "IncludeonInvoiceasBuyer", "IncludeinSalesReportasSeller", "IncludeinSalesReportasBuyer", "Type", "DisplayOrder", "VisiBIlity", "MutaBIlity", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "DefaultValue", "GroupName", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Required", "Deferred", "Encrypted", "IncludeonInvoice", "IncludeinSalesReport", "IncludeonInvoiceasSeller", "IncludeonInvoiceasBuyer", "IncludeinSalesReportasSeller", "IncludeinSalesReportasBuyer", "Type", "DisplayOrder", "VisiBIlity", "MutaBIlity", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "DefaultValue", "GroupName", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CustomFields_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:22:31.436874 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.14 seconds
21:22:31.438614 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:31.438842 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:31.541446 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:22:31.544416 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:31.544757 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:32.092612 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.55 seconds
21:22:32.095698 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:32.095985 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr'
      and table_schema = 'stg'
  
21:22:32.132126 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:32.136525 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:32.136851 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:32.177294 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:32.179307 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:32.179596 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    
21:22:32.459354 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.44 seconds
21:22:32.461113 [debug] [Thread-1  ]: On snapshot.Shawn.AH_CustomFields_Incr: COMMIT
21:22:32.461838 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:22:32.461978 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."#AH_CustomFields_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CustomFields_Incr__dbt_tmp"
    end

21:22:32.519942 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:32.533819 [debug] [Thread-1  ]: finished collecting timing info
21:22:32.534256 [debug] [Thread-1  ]: On snapshot.Shawn.AH_CustomFields_Incr: Close
21:22:32.535106 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55877ba90>]}
21:22:32.535656 [info ] [Thread-1  ]: 21 of 101 OK snapshotted stg.AH_CustomFields_Incr............................... [[32mOK[0m in 21.63s]
21:22:32.536058 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_CustomFields_Incr
21:22:32.536244 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Emailtemplates_Incr
21:22:32.536642 [info ] [Thread-1  ]: 26 of 101 START snapshot stg.AH_Emailtemplates_Incr............................. [RUN]
21:22:32.537140 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr"
21:22:32.537293 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Emailtemplates_Incr
21:22:32.537428 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Emailtemplates_Incr
21:22:32.540354 [debug] [Thread-1  ]: finished collecting timing info
21:22:32.540552 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Emailtemplates_Incr
21:22:32.543423 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:32.543610 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:22:32.543728 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:22:32.543858 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:22:32.665290 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:22:32.716799 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:22:32.741093 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:32.741522 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:22:32.768916 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:22:32.771267 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:32.771886 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Emailtemplates_InterView]
        ) as __dbt_sbq
    
21:22:32.854793 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:32.877132 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:32.877551 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr"
        ) as __dbt_sbq
    
21:22:32.935143 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:32.938902 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:32.939243 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr'
      and table_schema = 'stg'
  
21:22:33.013637 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:33.018024 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:33.018374 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
        
  
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Emailtemplates_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Emailtemplates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Emailtemplates_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Emailtemplates_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:32.751253'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:32.751253'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:22:32.751253''), CONVERT(DATETIME2, ''2022-09-18 21:22:32.751253'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:22:32.751253'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:32.751253'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:32.751253'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:22:32.751253'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Emailtemplates_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Emailtemplates_Incr__dbt_tmp_temp_view"
    end



    
21:22:33.424791 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.24 seconds
21:22:33.426471 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:33.426700 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:33.487588 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:33.490117 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:33.490359 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:33.855186 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
21:22:33.858386 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:33.858711 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr'
      and table_schema = 'stg'
  
21:22:33.894124 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:33.898702 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:33.899009 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:33.954482 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:33.956131 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:33.956380 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    
21:22:34.040915 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 9.28 seconds
21:22:34.044585 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:34.044895 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:34.086059 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:34.087717 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:34.087973 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Decorations_Incr__dbt_tmp"
    
21:22:35.217383 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.26 seconds
21:22:35.219179 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:35.219436 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:35.256051 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.17 seconds
21:22:35.257803 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:35.258056 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:35.278498 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:35.281239 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:35.281522 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:35.332478 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:35.336731 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:35.337038 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:35.677847 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
21:22:35.680136 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr"
21:22:35.680657 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:35.680820 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr" (
                  "ID", "Email", "FirstName", "LastName", "ZipCode", "ASenthusiast", "AsBidder", "AsConsignor", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Email", "FirstName", "LastName", "ZipCode", "ASenthusiast", "AsBidder", "AsConsignor", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:22:35.824184 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.49 seconds
21:22:35.827159 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:35.827473 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr'
      and table_schema = 'stg'
  
21:22:35.862300 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:22:35.866990 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:35.867308 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:35.909617 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:35.911629 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:35.911889 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Decorations_Incr__dbt_tmp"
    
21:22:37.246033 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.33 seconds
21:22:37.247689 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:37.247882 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:37.305551 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:37.308263 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:37.308464 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:37.571443 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:22:37.574651 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:37.574982 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr'
      and table_schema = 'stg'
  
21:22:37.622950 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.94 seconds
21:22:37.624753 [debug] [Thread-2  ]: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: COMMIT
21:22:37.625621 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:22:37.625824 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    end

21:22:37.626679 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:37.630535 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:37.630741 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:37.675651 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:37.687760 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:37.689115 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:37.689358 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Decorations_Incr__dbt_tmp"
    
21:22:37.691701 [debug] [Thread-2  ]: finished collecting timing info
21:22:37.691946 [debug] [Thread-2  ]: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: Close
21:22:37.692633 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5584c3df0>]}
21:22:37.693102 [info ] [Thread-2  ]: 23 of 101 OK snapshotted stg.AH_DailyhuntEmailSubscribers_Incr.................. [[32mOK[0m in 15.57s]
21:22:37.693476 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr
21:22:37.693657 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Eventproperties_Incr
21:22:37.694049 [info ] [Thread-2  ]: 27 of 101 START snapshot stg.AH_Eventproperties_Incr............................ [RUN]
21:22:37.694471 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Eventproperties_Incr"
21:22:37.694661 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Eventproperties_Incr
21:22:37.694800 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Eventproperties_Incr
21:22:37.697549 [debug] [Thread-2  ]: finished collecting timing info
21:22:37.697799 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Eventproperties_Incr
21:22:37.700553 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:37.700730 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:22:37.700921 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:22:37.701073 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:22:37.808944 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:22:37.843559 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:22:37.867027 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:37.867421 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:22:37.932413 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:37.934809 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:37.935070 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Eventproperties_InterView]
        ) as __dbt_sbq
    
21:22:38.016987 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:38.040304 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:38.040696 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr"
        ) as __dbt_sbq
    
21:22:38.107506 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:38.111023 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:38.111302 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr'
      and table_schema = 'stg'
  
21:22:38.189305 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:38.193400 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:38.193776 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
        
  
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Eventproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Eventproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Eventproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Eventproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Eventproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:37.892005'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:37.892005'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:22:37.892005''), CONVERT(DATETIME2, ''2022-09-18 21:22:37.892005'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:22:37.892005'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:37.892005'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:37.892005'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:22:37.892005'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Eventproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Eventproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Eventproperties_Incr__dbt_tmp_temp_view"
    end



    
21:22:39.337936 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.65 seconds
21:22:39.339560 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:39.339738 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:39.382617 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:39.385390 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:39.385650 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:39.388549 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.37 seconds
21:22:39.392296 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:39.392496 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:39.440049 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:39.441645 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:39.441891 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    
21:22:39.671836 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:22:39.674118 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Decorations_Incr"
21:22:39.674682 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:39.674862 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Decorations_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Decorations_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Decorations_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Decorations_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Decorations_Incr" (
                  "ID", "PayToproceed", "CreatedOn", "UpdatedOn", "DeletedOn", "ValIDFields", "Description", "LastUpdatedUser", "Name", "FormatString", "Amount", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "PayToproceed", "CreatedOn", "UpdatedOn", "DeletedOn", "ValIDFields", "Description", "LastUpdatedUser", "Name", "FormatString", "Amount", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Decorations_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:22:39.804108 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 9.68 seconds
21:22:39.807740 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:39.807996 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:39.851710 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:39.853330 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:39.853570 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    
21:22:40.825791 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
21:22:40.828093 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:40.828280 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:40.900533 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:40.903141 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:40.903342 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:41.188948 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:22:41.192175 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:41.192437 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr'
      and table_schema = 'stg'
  
21:22:41.235171 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
21:22:41.236952 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:41.237213 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:41.237525 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:41.241293 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:41.241512 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:41.282566 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:41.284143 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:41.284383 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    
21:22:41.322654 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.65 seconds
21:22:41.324415 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Decorations_Incr: COMMIT
21:22:41.325543 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:22:41.325699 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:22:41.327691 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:41.327867 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:41.325847 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."#AH_Decorations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Decorations_Incr__dbt_tmp"
    end

21:22:41.363740 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:41.377642 [debug] [Thread-4  ]: finished collecting timing info
21:22:41.378027 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Decorations_Incr: Close
21:22:41.378808 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55987d040>]}
21:22:41.379298 [info ] [Thread-4  ]: 24 of 101 OK snapshotted stg.AH_Decorations_Incr................................ [[32mOK[0m in 17.18s]
21:22:41.379673 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Decorations_Incr
21:22:41.379856 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Events_Incr
21:22:41.380237 [info ] [Thread-4  ]: 28 of 101 START snapshot stg.AH_Events_Incr..................................... [RUN]
21:22:41.380649 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Events_Incr"
21:22:41.380799 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Events_Incr
21:22:41.380934 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Events_Incr
21:22:41.383694 [debug] [Thread-4  ]: finished collecting timing info
21:22:41.383964 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Events_Incr
21:22:41.386638 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:41.386819 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:22:41.386939 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:22:41.387069 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:22:41.504098 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:22:41.541473 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:22:41.564509 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:41.564893 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:22:41.595561 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:22:41.598115 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:41.598386 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Events_InterView]
        ) as __dbt_sbq
    
21:22:41.652720 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:41.675610 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:41.676000 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Events_Incr"
        ) as __dbt_sbq
    
21:22:41.700786 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.37 seconds
21:22:41.703628 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:41.703864 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr'
      and table_schema = 'stg'
  
21:22:41.725506 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:41.729404 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:41.729691 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr'
      and table_schema = 'stg'
  
21:22:41.750617 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:41.754919 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:41.755275 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:41.797304 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:41.798956 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:41.799212 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    
21:22:41.825731 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:22:41.829654 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:41.829925 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
        
  
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Events_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Events_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Events_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Events_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Events_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Events_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:41.579545'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:41.579545'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:22:41.579545''), CONVERT(DATETIME2, ''2022-09-18 21:22:41.579545'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:22:41.579545'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:41.579545'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:41.579545'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:22:41.579545'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Events_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Events_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Events_Incr__dbt_tmp_temp_view"
    end



    
21:22:42.553782 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.27 seconds
21:22:42.555443 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:42.555624 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:42.592521 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:42.595184 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:42.595425 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:42.888316 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:22:42.891629 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:42.891961 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr'
      and table_schema = 'stg'
  
21:22:42.959941 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:42.964449 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:42.964736 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:43.004953 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:43.006602 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:43.006839 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    
21:22:43.445769 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.65 seconds
21:22:43.447425 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:43.447619 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:43.493426 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:43.496090 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:43.496326 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:44.083112 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.59 seconds
21:22:44.087688 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:44.088003 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr'
      and table_schema = 'stg'
  
21:22:44.123114 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:22:44.127869 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:44.128193 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:44.190111 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:44.191642 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:44.191853 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    
21:22:44.248540 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.24 seconds
21:22:44.250186 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:44.250454 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:44.319992 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:44.322948 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:44.323196 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:44.595093 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:22:44.597345 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Emailtemplates_Incr"
21:22:44.597893 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:44.598068 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Emailtemplates_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr" (
                  "ID", "Enabled", "UpdatedOn", "DeletedOn", "CreatedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Enabled", "UpdatedOn", "DeletedOn", "CreatedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Emailtemplates_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:22:45.363627 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.17 seconds
21:22:45.365336 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:45.365535 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:45.403722 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:45.406702 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:45.406951 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:45.669521 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:22:45.671798 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Emailtemplatecontents_Incr"
21:22:45.672347 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:45.672520 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr" (
                  "ID", "Name", "Culture", "SuBJect", "Body", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Culture", "SuBJect", "Body", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:22:46.055080 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.46 seconds
21:22:46.057141 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Emailtemplates_Incr: COMMIT
21:22:46.057975 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:22:46.058152 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."#AH_Emailtemplates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    end

21:22:46.095616 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:46.108274 [debug] [Thread-1  ]: finished collecting timing info
21:22:46.108674 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Emailtemplates_Incr: Close
21:22:46.109425 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5587b25b0>]}
21:22:46.109928 [info ] [Thread-1  ]: 26 of 101 OK snapshotted stg.AH_Emailtemplates_Incr............................. [[32mOK[0m in 13.57s]
21:22:46.110311 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Emailtemplates_Incr
21:22:46.110487 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ExternalUserIDs_Incr
21:22:46.110928 [info ] [Thread-1  ]: 29 of 101 START snapshot stg.AH_ExternalUserIDs_Incr............................ [RUN]
21:22:46.111342 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr"
21:22:46.111492 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ExternalUserIDs_Incr
21:22:46.111622 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ExternalUserIDs_Incr
21:22:46.114374 [debug] [Thread-1  ]: finished collecting timing info
21:22:46.114680 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ExternalUserIDs_Incr
21:22:46.117581 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:46.117768 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:22:46.117886 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:22:46.118014 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:22:46.225353 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:22:46.262908 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:22:46.287097 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:46.287454 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:22:46.323150 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:46.325453 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:46.326104 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ExternalUserIDs_InterView]
        ) as __dbt_sbq
    
21:22:46.391262 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:46.413118 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:46.413467 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr"
        ) as __dbt_sbq
    
21:22:46.464657 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:46.468497 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:46.468750 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr'
      and table_schema = 'stg'
  
21:22:46.554534 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:22:46.558344 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:46.558692 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
        
  
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ExternalUserIDs_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ExternalUserIDs_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:46.298303'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:46.298303'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:22:46.298303''), CONVERT(DATETIME2, ''2022-09-18 21:22:46.298303'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:22:46.298303'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:46.298303'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:46.298303'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:22:46.298303'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ProvIDErName != source_data.ProvIDErName
        or
        (
            ((snapshotted_data.ProvIDErName is null) and not (source_data.ProvIDErName is null))
            or
            ((not snapshotted_data.ProvIDErName is null) and (source_data.ProvIDErName is null))
        ) or snapshotted_data.ProvIDErUserID != source_data.ProvIDErUserID
        or
        (
            ((snapshotted_data.ProvIDErUserID is null) and not (source_data.ProvIDErUserID is null))
            or
            ((not snapshotted_data.ProvIDErUserID is null) and (source_data.ProvIDErUserID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LocalUserID != source_data.LocalUserID
        or
        (
            ((snapshotted_data.LocalUserID is null) and not (source_data.LocalUserID is null))
            or
            ((not snapshotted_data.LocalUserID is null) and (source_data.LocalUserID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ProvIDErName != source_data.ProvIDErName
        or
        (
            ((snapshotted_data.ProvIDErName is null) and not (source_data.ProvIDErName is null))
            or
            ((not snapshotted_data.ProvIDErName is null) and (source_data.ProvIDErName is null))
        ) or snapshotted_data.ProvIDErUserID != source_data.ProvIDErUserID
        or
        (
            ((snapshotted_data.ProvIDErUserID is null) and not (source_data.ProvIDErUserID is null))
            or
            ((not snapshotted_data.ProvIDErUserID is null) and (source_data.ProvIDErUserID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LocalUserID != source_data.LocalUserID
        or
        (
            ((snapshotted_data.LocalUserID is null) and not (source_data.LocalUserID is null))
            or
            ((not snapshotted_data.LocalUserID is null) and (source_data.LocalUserID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ExternalUserIDs_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_temp_view"
    end



    
21:22:47.018659 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.35 seconds
21:22:47.020435 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: COMMIT
21:22:47.021281 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:22:47.021481 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    end

21:22:47.069329 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:47.082875 [debug] [Thread-3  ]: finished collecting timing info
21:22:47.083278 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: Close
21:22:47.084041 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55987d2e0>]}
21:22:47.084567 [info ] [Thread-3  ]: 25 of 101 OK snapshotted stg.AH_Emailtemplatecontents_Incr...................... [[32mOK[0m in 17.66s]
21:22:47.084968 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Emailtemplatecontents_Incr
21:22:47.085158 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Feedbacks_Incr
21:22:47.085552 [info ] [Thread-3  ]: 30 of 101 START snapshot stg.AH_Feedbacks_Incr.................................. [RUN]
21:22:47.085997 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Feedbacks_Incr"
21:22:47.086148 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Feedbacks_Incr
21:22:47.086282 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Feedbacks_Incr
21:22:47.089094 [debug] [Thread-3  ]: finished collecting timing info
21:22:47.089291 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Feedbacks_Incr
21:22:47.092196 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:22:47.092377 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:22:47.092496 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:22:47.092624 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:22:47.176141 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 5.35 seconds
21:22:47.179672 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:47.179943 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:47.191724 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:22:47.225194 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:47.226857 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:47.227107 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Events_Incr__dbt_tmp"
    
21:22:47.236011 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:22:47.258163 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:22:47.258523 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:22:47.317842 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:47.320452 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:22:47.320706 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Feedbacks_InterView]
        ) as __dbt_sbq
    
21:22:47.380948 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:47.402993 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:22:47.403375 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr"
        ) as __dbt_sbq
    
21:22:47.456896 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:47.460210 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:22:47.460479 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr'
      and table_schema = 'stg'
  
21:22:47.539271 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:47.543248 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:22:47.543554 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
        
  
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feedbacks_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Feedbacks_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feedbacks_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Feedbacks_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Feedbacks_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:47.282690'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:47.282690'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:22:47.282690''), CONVERT(DATETIME2, ''2022-09-18 21:22:47.282690'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:22:47.282690'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:47.282690'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:47.282690'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:22:47.282690'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SEndingUserID != source_data.SEndingUserID
        or
        (
            ((snapshotted_data.SEndingUserID is null) and not (source_data.SEndingUserID is null))
            or
            ((not snapshotted_data.SEndingUserID is null) and (source_data.SEndingUserID is null))
        ) or snapshotted_data.ReceivINgUserID != source_data.ReceivINgUserID
        or
        (
            ((snapshotted_data.ReceivINgUserID is null) and not (source_data.ReceivINgUserID is null))
            or
            ((not snapshotted_data.ReceivINgUserID is null) and (source_data.ReceivINgUserID is null))
        ) or snapshotted_data.Rating != source_data.Rating
        or
        (
            ((snapshotted_data.Rating is null) and not (source_data.Rating is null))
            or
            ((not snapshotted_data.Rating is null) and (source_data.Rating is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.ListingOwnerUserName != source_data.ListingOwnerUserName
        or
        (
            ((snapshotted_data.ListingOwnerUserName is null) and not (source_data.ListingOwnerUserName is null))
            or
            ((not snapshotted_data.ListingOwnerUserName is null) and (source_data.ListingOwnerUserName is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SEndingUserID != source_data.SEndingUserID
        or
        (
            ((snapshotted_data.SEndingUserID is null) and not (source_data.SEndingUserID is null))
            or
            ((not snapshotted_data.SEndingUserID is null) and (source_data.SEndingUserID is null))
        ) or snapshotted_data.ReceivINgUserID != source_data.ReceivINgUserID
        or
        (
            ((snapshotted_data.ReceivINgUserID is null) and not (source_data.ReceivINgUserID is null))
            or
            ((not snapshotted_data.ReceivINgUserID is null) and (source_data.ReceivINgUserID is null))
        ) or snapshotted_data.Rating != source_data.Rating
        or
        (
            ((snapshotted_data.Rating is null) and not (source_data.Rating is null))
            or
            ((not snapshotted_data.Rating is null) and (source_data.Rating is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.ListingOwnerUserName != source_data.ListingOwnerUserName
        or
        (
            ((snapshotted_data.ListingOwnerUserName is null) and not (source_data.ListingOwnerUserName is null))
            or
            ((not snapshotted_data.ListingOwnerUserName is null) and (source_data.ListingOwnerUserName is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Feedbacks_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Feedbacks_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feedbacks_Incr__dbt_tmp_temp_view"
    end



    
21:22:47.909331 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 9.72 seconds
21:22:47.913027 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:47.913303 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:47.957871 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:47.959522 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:47.959774 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Eventproperties_Incr__dbt_tmp"
    
21:22:48.447748 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.22 seconds
21:22:48.449377 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:48.449584 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:48.532386 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:48.535025 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:48.535276 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:48.997304 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.04 seconds
21:22:48.999091 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:48.999343 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:49.028921 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.49 seconds
21:22:49.032171 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:49.032448 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr'
      and table_schema = 'stg'
  
21:22:49.081864 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:49.084661 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:49.084910 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:49.101697 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:49.106941 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:49.107208 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:49.158304 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:49.160327 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:49.160561 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Events_Incr__dbt_tmp"
    
21:22:49.393196 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
21:22:49.396365 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:49.396629 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr'
      and table_schema = 'stg'
  
21:22:49.432752 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:49.437334 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:49.437635 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:49.502466 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:49.504002 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:49.504221 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Eventproperties_Incr__dbt_tmp"
    
21:22:50.102109 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
21:22:50.103865 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:50.104119 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:50.171269 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:50.173658 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:50.173884 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:50.415920 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:22:50.419088 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:50.419325 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr'
      and table_schema = 'stg'
  
21:22:50.455852 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:50.460099 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:50.460369 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:50.503034 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:50.504654 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:50.504897 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Events_Incr__dbt_tmp"
    
21:22:50.578305 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.07 seconds
21:22:50.579837 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:50.580063 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:50.704338 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:22:50.707448 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:50.707713 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:50.984365 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:22:50.987361 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:50.987623 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr'
      and table_schema = 'stg'
  
21:22:51.042843 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:51.047599 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:51.047879 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:51.130831 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:51.133055 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:51.133310 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Eventproperties_Incr__dbt_tmp"
    
21:22:51.883892 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
21:22:51.885517 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:51.885710 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:51.935272 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:51.937884 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:51.938162 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:52.171218 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:22:52.173400 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Events_Incr"
21:22:52.173939 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:52.174114 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Events_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Events_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Events_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Events_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Events_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Events_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:22:52.357679 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.22 seconds
21:22:52.359365 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:52.359552 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:52.415736 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:52.418463 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:52.418761 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:53.090398 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.53 seconds
21:22:53.094191 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:53.094492 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:53.134913 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:53.136641 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:53.136910 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    
21:22:53.155493 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.74 seconds
21:22:53.157855 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Eventproperties_Incr"
21:22:53.158464 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:53.158691 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Eventproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr" (
                  "ID", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "DecimalnativeValue", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "BoolnativeValue", "IntnativeValue", "AuctionEventID", "CustomFieldID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "DecimalnativeValue", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "BoolnativeValue", "IntnativeValue", "AuctionEventID", "CustomFieldID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Eventproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:22:53.444514 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.27 seconds
21:22:53.446514 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Events_Incr: COMMIT
21:22:53.447511 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:22:53.447704 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."#AH_Events_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Events_Incr__dbt_tmp"
    end

21:22:53.507346 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:53.521281 [debug] [Thread-4  ]: finished collecting timing info
21:22:53.521690 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Events_Incr: Close
21:22:53.522451 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5585ac430>]}
21:22:53.685777 [info ] [Thread-4  ]: 28 of 101 OK snapshotted stg.AH_Events_Incr..................................... [[32mOK[0m in 12.14s]
21:22:53.686756 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Events_Incr
21:22:53.686966 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Feeproperties_Incr
21:22:53.687357 [info ] [Thread-4  ]: 31 of 101 START snapshot stg.AH_Feeproperties_Incr.............................. [RUN]
21:22:53.687848 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Feeproperties_Incr"
21:22:53.688030 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Feeproperties_Incr
21:22:53.688172 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Feeproperties_Incr
21:22:53.691134 [debug] [Thread-4  ]: finished collecting timing info
21:22:53.691328 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Feeproperties_Incr
21:22:53.693919 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:22:53.694101 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:22:53.694219 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:22:53.694350 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:22:53.813857 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:22:53.848684 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:22:53.871414 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:22:53.871806 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:22:53.903546 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:22:53.905825 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:22:53.906106 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Feeproperties_InterView]
        ) as __dbt_sbq
    
21:22:53.988848 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:54.011854 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:22:54.012274 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr"
        ) as __dbt_sbq
    
21:22:54.084957 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:54.088465 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:22:54.088739 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr'
      and table_schema = 'stg'
  
21:22:54.185916 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:22:54.190368 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:22:54.190654 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
        
  
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feeproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Feeproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feeproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Feeproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Feeproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:53.876528'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:53.876528'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:22:53.876528''), CONVERT(DATETIME2, ''2022-09-18 21:22:53.876528'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:22:53.876528'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:53.876528'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:53.876528'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:22:53.876528'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Processor != source_data.Processor
        or
        (
            ((snapshotted_data.Processor is null) and not (source_data.Processor is null))
            or
            ((not snapshotted_data.Processor is null) and (source_data.Processor is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Processor != source_data.Processor
        or
        (
            ((snapshotted_data.Processor is null) and not (source_data.Processor is null))
            or
            ((not snapshotted_data.Processor is null) and (source_data.Processor is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Feeproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Feeproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feeproperties_Incr__dbt_tmp_temp_view"
    end



    
21:22:54.198842 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
21:22:54.200114 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:54.200312 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:54.270941 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:54.273626 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:54.273913 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:54.494304 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.34 seconds
21:22:54.496150 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Eventproperties_Incr: COMMIT
21:22:54.497265 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:22:54.497446 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."#AH_Eventproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Eventproperties_Incr__dbt_tmp"
    end

21:22:54.526891 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:22:54.529833 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:54.530100 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr'
      and table_schema = 'stg'
  
21:22:54.534072 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:54.546834 [debug] [Thread-2  ]: finished collecting timing info
21:22:54.547126 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Eventproperties_Incr: Close
21:22:54.547808 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55987d430>]}
21:22:54.548277 [info ] [Thread-2  ]: 27 of 101 OK snapshotted stg.AH_Eventproperties_Incr............................ [[32mOK[0m in 16.85s]
21:22:54.548644 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Eventproperties_Incr
21:22:54.548823 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Feeschedules_Incr
21:22:54.549238 [info ] [Thread-2  ]: 32 of 101 START snapshot stg.AH_Feeschedules_Incr............................... [RUN]
21:22:54.549651 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Feeschedules_Incr"
21:22:54.549803 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Feeschedules_Incr
21:22:54.549933 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Feeschedules_Incr
21:22:54.552681 [debug] [Thread-2  ]: finished collecting timing info
21:22:54.552872 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Feeschedules_Incr
21:22:54.555636 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:22:54.555813 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:22:54.555929 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:22:54.556059 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:22:54.587530 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:54.591717 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:54.591976 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:54.631500 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:54.633057 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:54.633297 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    
21:22:54.681047 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:22:54.711603 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:22:54.734892 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:22:54.735266 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:22:54.775321 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:54.777956 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:22:54.778245 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Feeschedules_InterView]
        ) as __dbt_sbq
    
21:22:54.833325 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:54.855549 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:22:54.855937 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr"
        ) as __dbt_sbq
    
21:22:54.912745 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:54.916280 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:22:54.916607 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr'
      and table_schema = 'stg'
  
21:22:54.998193 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:55.002164 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:22:55.002509 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
        
  
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feeschedules_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Feeschedules_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feeschedules_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Feeschedules_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Feeschedules_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:54.751543'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:54.751543'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:22:54.751543''), CONVERT(DATETIME2, ''2022-09-18 21:22:54.751543'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:22:54.751543'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:54.751543'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:54.751543'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:22:54.751543'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Feeschedules_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Feeschedules_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feeschedules_Incr__dbt_tmp_temp_view"
    end



    
21:22:55.917725 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.28 seconds
21:22:55.919428 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:55.919628 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:55.963669 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:55.966394 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:55.966719 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:56.322753 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
21:22:56.326007 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:56.326326 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr'
      and table_schema = 'stg'
  
21:22:56.361809 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:56.366327 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:56.366703 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:56.416806 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:56.419508 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:56.419774 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    
21:22:56.572723 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 9.03 seconds
21:22:56.576275 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:22:56.578120 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:56.619960 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:56.621628 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:22:56.621889 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feedbacks_Incr__dbt_tmp"
    
21:22:57.538739 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.12 seconds
21:22:57.540369 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:57.540566 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:57.585393 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:57.588185 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:57.588462 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:57.708736 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.09 seconds
21:22:57.710463 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:22:57.710736 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:57.804256 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:22:57.807235 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:22:57.807549 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:57.878997 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:22:57.881245 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ExternalUserIDs_Incr"
21:22:57.881821 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:57.882004 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ExternalUserIDs_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr" (
                  "ID", "ProvIDErName", "ProvIDErUserID", "CreatedOn", "UpdatedOn", "DeletedOn", "LocalUserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "ProvIDErName", "ProvIDErUserID", "CreatedOn", "UpdatedOn", "DeletedOn", "LocalUserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:22:58.069808 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:22:58.072890 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:22:58.073187 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr'
      and table_schema = 'stg'
  
21:22:58.117321 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:58.121682 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:22:58.122032 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:58.175391 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:58.177242 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:22:58.177510 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feedbacks_Incr__dbt_tmp"
    
21:22:59.275144 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
21:22:59.276833 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:22:59.277037 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:22:59.340003 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:22:59.342580 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:22:59.342808 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:59.375191 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.49 seconds
21:22:59.377063 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ExternalUserIDs_Incr: COMMIT
21:22:59.378154 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:22:59.378367 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    end

21:22:59.426339 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:22:59.441479 [debug] [Thread-1  ]: finished collecting timing info
21:22:59.441929 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ExternalUserIDs_Incr: Close
21:22:59.442787 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55987d820>]}
21:22:59.443310 [info ] [Thread-1  ]: 29 of 101 OK snapshotted stg.AH_ExternalUserIDs_Incr............................ [[32mOK[0m in 13.33s]
21:22:59.443704 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ExternalUserIDs_Incr
21:22:59.443891 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ImportedCategoryMap_Incr
21:22:59.444287 [info ] [Thread-1  ]: 33 of 101 START snapshot stg.AH_ImportedCategoryMap_Incr........................ [RUN]
21:22:59.444727 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr"
21:22:59.444882 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ImportedCategoryMap_Incr
21:22:59.445017 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ImportedCategoryMap_Incr
21:22:59.447921 [debug] [Thread-1  ]: finished collecting timing info
21:22:59.448131 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ImportedCategoryMap_Incr
21:22:59.451226 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:22:59.451419 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:22:59.451539 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:22:59.451693 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:22:59.566605 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:22:59.610106 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:22:59.631397 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:22:59.634431 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:22:59.636875 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr'
      and table_schema = 'stg'
  
21:22:59.636736 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:22:59.637234 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:22:59.677919 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:22:59.680198 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:22:59.680484 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ImportedCategoryMap_InterView]
        ) as __dbt_sbq
    
21:22:59.706202 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:22:59.710999 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:22:59.711355 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:22:59.756745 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:59.779043 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:22:59.779477 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr"
        ) as __dbt_sbq
    
21:22:59.794413 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:59.796021 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:22:59.796274 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feedbacks_Incr__dbt_tmp"
    
21:22:59.863954 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:22:59.867907 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:22:59.868268 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr'
      and table_schema = 'stg'
  
21:22:59.961320 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:22:59.965075 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:22:59.965387 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
        
  
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ImportedCategoryMap_InterView]

    ),

    snapshotted_data as (

        select *,
            LocalCategoryID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LocalCategoryID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:59.657865'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:59.657865'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:22:59.657865''), CONVERT(DATETIME2, ''2022-09-18 21:22:59.657865'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(LocalCategoryID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:22:59.657865'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LocalCategoryID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:22:59.657865'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:22:59.657865'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:22:59.657865'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.LocalCategoryID != source_data.LocalCategoryID
        or
        (
            ((snapshotted_data.LocalCategoryID is null) and not (source_data.LocalCategoryID is null))
            or
            ((not snapshotted_data.LocalCategoryID is null) and (source_data.LocalCategoryID is null))
        ) or snapshotted_data.ForeignCategoryID != source_data.ForeignCategoryID
        or
        (
            ((snapshotted_data.ForeignCategoryID is null) and not (source_data.ForeignCategoryID is null))
            or
            ((not snapshotted_data.ForeignCategoryID is null) and (source_data.ForeignCategoryID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.LocalCategoryID != source_data.LocalCategoryID
        or
        (
            ((snapshotted_data.LocalCategoryID is null) and not (source_data.LocalCategoryID is null))
            or
            ((not snapshotted_data.LocalCategoryID is null) and (source_data.LocalCategoryID is null))
        ) or snapshotted_data.ForeignCategoryID != source_data.ForeignCategoryID
        or
        (
            ((snapshotted_data.ForeignCategoryID is null) and not (source_data.ForeignCategoryID is null))
            or
            ((not snapshotted_data.ForeignCategoryID is null) and (source_data.ForeignCategoryID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view"
    end



    
21:23:00.949412 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
21:23:00.951097 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:23:00.951295 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:01.002842 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:01.005480 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:23:01.006122 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:01.286178 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:23:01.289307 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Feedbacks_Incr"
21:23:01.289962 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:23:01.290142 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Feedbacks_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr" (
                  "ID", "SEndingUserID", "ReceivINgUserID", "Rating", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Comment", "LastUpdatedUser", "ListingOwnerUserName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SEndingUserID", "ReceivINgUserID", "Rating", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Comment", "LastUpdatedUser", "ListingOwnerUserName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Feedbacks_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:23:02.061363 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 7.87 seconds
21:23:02.065201 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:23:02.065567 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:02.105377 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:02.107089 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:23:02.107374 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeproperties_Incr__dbt_tmp"
    
21:23:02.669745 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.67 seconds
21:23:02.673498 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:23:02.673887 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:02.722753 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:02.724461 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:23:02.724735 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeschedules_Incr__dbt_tmp"
    
21:23:03.043589 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.75 seconds
21:23:03.045418 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Feedbacks_Incr: COMMIT
21:23:03.046282 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:23:03.046476 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."#AH_Feedbacks_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feedbacks_Incr__dbt_tmp"
    end

21:23:03.116710 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:03.214206 [debug] [Thread-3  ]: finished collecting timing info
21:23:03.214664 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Feedbacks_Incr: Close
21:23:03.215461 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55987d6d0>]}
21:23:03.215968 [info ] [Thread-3  ]: 30 of 101 OK snapshotted stg.AH_Feedbacks_Incr.................................. [[32mOK[0m in 16.13s]
21:23:03.216388 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Feedbacks_Incr
21:23:03.216578 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ImportedListingsMap_Incr
21:23:03.216961 [info ] [Thread-3  ]: 34 of 101 START snapshot stg.AH_ImportedListingsMap_Incr........................ [RUN]
21:23:03.217397 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr"
21:23:03.217550 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ImportedListingsMap_Incr
21:23:03.217682 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ImportedListingsMap_Incr
21:23:03.220649 [debug] [Thread-3  ]: finished collecting timing info
21:23:03.220847 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ImportedListingsMap_Incr
21:23:03.223421 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:03.223597 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:23:03.223714 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:23:03.223841 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:23:03.231840 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.12 seconds
21:23:03.233349 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:23:03.233546 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:03.311333 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:23:03.313820 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:23:03.314068 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:03.343949 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:23:03.372112 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:23:03.395464 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:03.395853 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:23:03.462075 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:03.462432 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.50 seconds
21:23:03.466093 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:23:03.468411 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:03.468250 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:03.468792 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ImportedListingsMap_InterView]
        ) as __dbt_sbq
    
21:23:03.507105 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:03.508758 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:23:03.509011 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    
21:23:03.521515 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:03.544283 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:03.544648 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr"
        ) as __dbt_sbq
    
21:23:03.550120 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:23:03.552962 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:23:03.553193 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr'
      and table_schema = 'stg'
  
21:23:03.587136 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:23:03.591750 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:23:03.591989 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:03.596121 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:03.596362 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr'
      and table_schema = 'stg'
  
21:23:03.592216 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:03.644522 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:03.646184 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:23:03.646433 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeproperties_Incr__dbt_tmp"
    
21:23:03.668956 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:03.672451 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:03.672723 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
        
  
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ImportedListingsMap_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ImportedListingsMap_InterView]

    ),

    snapshotted_data as (

        select *,
            LoCallistingID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LoCallistingID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:03.423551'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:03.423551'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:23:03.423551''), CONVERT(DATETIME2, ''2022-09-18 21:23:03.423551'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(LoCallistingID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:23:03.423551'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LoCallistingID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:03.423551'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:03.423551'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:23:03.423551'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.LoCallistingID != source_data.LoCallistingID
        or
        (
            ((snapshotted_data.LoCallistingID is null) and not (source_data.LoCallistingID is null))
            or
            ((not snapshotted_data.LoCallistingID is null) and (source_data.LoCallistingID is null))
        ) or snapshotted_data.ForeignListingID != source_data.ForeignListingID
        or
        (
            ((snapshotted_data.ForeignListingID is null) and not (source_data.ForeignListingID is null))
            or
            ((not snapshotted_data.ForeignListingID is null) and (source_data.ForeignListingID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.LoCallistingID != source_data.LoCallistingID
        or
        (
            ((snapshotted_data.LoCallistingID is null) and not (source_data.LoCallistingID is null))
            or
            ((not snapshotted_data.LoCallistingID is null) and (source_data.LoCallistingID is null))
        ) or snapshotted_data.ForeignListingID != source_data.ForeignListingID
        or
        (
            ((snapshotted_data.ForeignListingID is null) and not (source_data.ForeignListingID is null))
            or
            ((not snapshotted_data.ForeignListingID is null) and (source_data.ForeignListingID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ImportedListingsMap_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_temp_view"
    end



    
21:23:03.856811 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.13 seconds
21:23:03.858648 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:23:03.858918 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:03.937664 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:23:03.940464 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:23:03.940734 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:04.175945 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:23:04.179346 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:23:04.179623 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr'
      and table_schema = 'stg'
  
21:23:04.215406 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:04.219585 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:23:04.219903 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:04.306756 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:23:04.308384 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:23:04.308651 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeschedules_Incr__dbt_tmp"
    
21:23:04.638581 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.13 seconds
21:23:04.640308 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:23:04.640566 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:04.660221 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.01 seconds
21:23:04.661962 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:23:04.662263 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:04.696108 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:23:04.698762 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:23:04.699022 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:04.710382 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:04.713071 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:23:04.713345 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:05.107663 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
21:23:05.110723 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:23:05.111040 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr'
      and table_schema = 'stg'
  
21:23:05.158362 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:05.163552 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:23:05.163940 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:05.215063 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:05.217215 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:23:05.217530 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeproperties_Incr__dbt_tmp"
    
21:23:05.230103 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.92 seconds
21:23:05.231916 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:23:05.232231 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:05.272231 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:05.275070 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:23:05.275401 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:05.289619 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.58 seconds
21:23:05.293186 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:23:05.293467 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr'
      and table_schema = 'stg'
  
21:23:05.338920 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:05.343166 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:23:05.343501 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:05.396048 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:05.397718 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:23:05.398014 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    
21:23:05.559905 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:23:05.563135 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:23:05.563470 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr'
      and table_schema = 'stg'
  
21:23:05.605272 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:05.609699 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:23:05.610031 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:05.670801 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:23:05.672359 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:23:05.672594 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeschedules_Incr__dbt_tmp"
    
21:23:06.323844 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.11 seconds
21:23:06.325516 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:23:06.325719 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:06.363270 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:06.365976 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:23:06.366300 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:06.596370 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.20 seconds
21:23:06.598121 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:23:06.598368 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:06.634384 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:06.637282 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:23:06.637581 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:06.657846 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:23:06.660251 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Feeproperties_Incr"
21:23:06.660826 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:23:06.660993 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Feeproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr" (
                  "ID", "Processor", "Name", "Description", "Amount", "CreatedOn", "UpdatedOn", "DeletedOn", "ListingTypeID", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Processor", "Name", "Description", "Amount", "CreatedOn", "UpdatedOn", "DeletedOn", "ListingTypeID", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Feeproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:23:06.917545 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.24 seconds
21:23:06.919388 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:23:06.919656 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:06.946943 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
21:23:06.949894 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:23:06.950193 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr'
      and table_schema = 'stg'
  
21:23:06.959122 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:06.961947 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:23:06.962226 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:06.989159 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:06.996090 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:23:06.996472 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:07.034740 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:07.036393 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:23:07.036656 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    
21:23:07.108851 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.44 seconds
21:23:07.112413 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:07.112729 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:07.170616 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:23:07.172247 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:07.172481 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    
21:23:07.176155 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:23:07.177991 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Feeschedules_Incr"
21:23:07.178472 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:23:07.178661 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Feeschedules_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr" (
                  "ID", "PayToproceed", "CreatedOn", "UpdatedOn", "DeletedOn", "EventID", "ListingTypeID", "Description", "LastUpdatedUser", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "PayToproceed", "CreatedOn", "UpdatedOn", "DeletedOn", "EventID", "ListingTypeID", "Description", "LastUpdatedUser", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Feeschedules_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:23:08.328536 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.67 seconds
21:23:08.330275 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Feeproperties_Incr: COMMIT
21:23:08.331220 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:23:08.331432 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."#AH_Feeproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feeproperties_Incr__dbt_tmp"
    end

21:23:08.396339 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:23:08.409679 [debug] [Thread-4  ]: finished collecting timing info
21:23:08.410108 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Feeproperties_Incr: Close
21:23:08.410929 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55987dac0>]}
21:23:08.411474 [info ] [Thread-4  ]: 31 of 101 OK snapshotted stg.AH_Feeproperties_Incr.............................. [[32mOK[0m in 14.72s]
21:23:08.411871 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Feeproperties_Incr
21:23:08.412054 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ImportedUserMap_Incr
21:23:08.412439 [info ] [Thread-4  ]: 35 of 101 START snapshot stg.AH_ImportedUserMap_Incr............................ [RUN]
21:23:08.412872 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr"
21:23:08.413025 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ImportedUserMap_Incr
21:23:08.413157 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ImportedUserMap_Incr
21:23:08.416074 [debug] [Thread-4  ]: finished collecting timing info
21:23:08.416334 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ImportedUserMap_Incr
21:23:08.419209 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:08.419387 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:23:08.419507 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:23:08.419642 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:23:08.546489 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:23:08.576209 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:23:08.599387 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:08.599792 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:23:08.648985 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:08.651284 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:08.651858 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ImportedUserMap_InterView]
        ) as __dbt_sbq
    
21:23:08.664657 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.63 seconds
21:23:08.666343 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:23:08.666622 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:08.700014 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:23:08.702598 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:23:08.702857 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:08.714903 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:23:08.738225 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:08.738655 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr"
        ) as __dbt_sbq
    
21:23:08.778171 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.61 seconds
21:23:08.779925 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:08.780167 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:08.805275 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:08.808941 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:08.809231 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr'
      and table_schema = 'stg'
  
21:23:08.854703 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:08.857255 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:08.857532 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:08.882787 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:08.886256 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:08.886588 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
        
  
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedUserMap_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ImportedUserMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ImportedUserMap_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ImportedUserMap_InterView]

    ),

    snapshotted_data as (

        select *,
            LocalUserID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LocalUserID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:08.611211'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:08.611211'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:23:08.611211''), CONVERT(DATETIME2, ''2022-09-18 21:23:08.611211'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(LocalUserID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:23:08.611211'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LocalUserID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:08.611211'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:08.611211'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:23:08.611211'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.LocalUserID != source_data.LocalUserID
        or
        (
            ((snapshotted_data.LocalUserID is null) and not (source_data.LocalUserID is null))
            or
            ((not snapshotted_data.LocalUserID is null) and (source_data.LocalUserID is null))
        ) or snapshotted_data.ForeignUserID != source_data.ForeignUserID
        or
        (
            ((snapshotted_data.ForeignUserID is null) and not (source_data.ForeignUserID is null))
            or
            ((not snapshotted_data.ForeignUserID is null) and (source_data.ForeignUserID is null))
        ) or snapshotted_data.ImportedUserName != source_data.ImportedUserName
        or
        (
            ((snapshotted_data.ImportedUserName is null) and not (source_data.ImportedUserName is null))
            or
            ((not snapshotted_data.ImportedUserName is null) and (source_data.ImportedUserName is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.LocalUserID != source_data.LocalUserID
        or
        (
            ((snapshotted_data.LocalUserID is null) and not (source_data.LocalUserID is null))
            or
            ((not snapshotted_data.LocalUserID is null) and (source_data.LocalUserID is null))
        ) or snapshotted_data.ForeignUserID != source_data.ForeignUserID
        or
        (
            ((snapshotted_data.ForeignUserID is null) and not (source_data.ForeignUserID is null))
            or
            ((not snapshotted_data.ForeignUserID is null) and (source_data.ForeignUserID is null))
        ) or snapshotted_data.ImportedUserName != source_data.ImportedUserName
        or
        (
            ((snapshotted_data.ImportedUserName is null) and not (source_data.ImportedUserName is null))
            or
            ((not snapshotted_data.ImportedUserName is null) and (source_data.ImportedUserName is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ImportedUserMap_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedUserMap_Incr__dbt_tmp_temp_view"
    end



    
21:23:08.953342 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:23:08.955521 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ImportedCategoryMap_Incr"
21:23:08.956112 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:23:08.956301 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr" (
                  "LocalCategoryID", "ForeignCategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "LocalCategoryID", "ForeignCategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:23:09.084653 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:23:09.088144 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:09.088475 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr'
      and table_schema = 'stg'
  
21:23:09.131232 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:09.135513 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:09.135855 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:09.166488 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.99 seconds
21:23:09.168353 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Feeschedules_Incr: COMMIT
21:23:09.169265 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:23:09.169474 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."#AH_Feeschedules_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feeschedules_Incr__dbt_tmp"
    end

21:23:09.175753 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:09.177125 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:09.177350 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    
21:23:09.216826 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:09.231769 [debug] [Thread-2  ]: finished collecting timing info
21:23:09.232222 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Feeschedules_Incr: Close
21:23:09.233070 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55849e760>]}
21:23:09.233611 [info ] [Thread-2  ]: 32 of 101 OK snapshotted stg.AH_Feeschedules_Incr............................... [[32mOK[0m in 14.68s]
21:23:09.234001 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Feeschedules_Incr
21:23:09.234187 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ImportedregionMap_Incr
21:23:09.234614 [info ] [Thread-2  ]: 36 of 101 START snapshot stg.AH_ImportedregionMap_Incr.......................... [RUN]
21:23:09.235091 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr"
21:23:09.235248 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ImportedregionMap_Incr
21:23:09.235387 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ImportedregionMap_Incr
21:23:09.238328 [debug] [Thread-2  ]: finished collecting timing info
21:23:09.238567 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ImportedregionMap_Incr
21:23:09.241501 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:09.241707 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:23:09.241832 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:23:09.241966 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:23:09.355139 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:23:09.392143 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:23:09.415215 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:09.415602 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:23:09.453369 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:09.455707 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:09.456318 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ImportedregionMap_InterView]
        ) as __dbt_sbq
    
21:23:09.515529 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:23:09.537370 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:09.537773 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr"
        ) as __dbt_sbq
    
21:23:09.589534 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:09.593285 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:09.593588 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr'
      and table_schema = 'stg'
  
21:23:09.687825 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:23:09.691655 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:09.691957 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
        
  
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedregionMap_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ImportedregionMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ImportedregionMap_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ImportedregionMap_InterView]

    ),

    snapshotted_data as (

        select *,
            LocalregionID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LocalregionID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:09.439276'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:09.439276'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:23:09.439276''), CONVERT(DATETIME2, ''2022-09-18 21:23:09.439276'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(LocalregionID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:23:09.439276'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LocalregionID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:09.439276'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:09.439276'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:23:09.439276'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.LocalregionID != source_data.LocalregionID
        or
        (
            ((snapshotted_data.LocalregionID is null) and not (source_data.LocalregionID is null))
            or
            ((not snapshotted_data.LocalregionID is null) and (source_data.LocalregionID is null))
        ) or snapshotted_data.ForeignregionID != source_data.ForeignregionID
        or
        (
            ((snapshotted_data.ForeignregionID is null) and not (source_data.ForeignregionID is null))
            or
            ((not snapshotted_data.ForeignregionID is null) and (source_data.ForeignregionID is null))
        ) or snapshotted_data.Foreignregiontier != source_data.Foreignregiontier
        or
        (
            ((snapshotted_data.Foreignregiontier is null) and not (source_data.Foreignregiontier is null))
            or
            ((not snapshotted_data.Foreignregiontier is null) and (source_data.Foreignregiontier is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.LocalregionID != source_data.LocalregionID
        or
        (
            ((snapshotted_data.LocalregionID is null) and not (source_data.LocalregionID is null))
            or
            ((not snapshotted_data.LocalregionID is null) and (source_data.LocalregionID is null))
        ) or snapshotted_data.ForeignregionID != source_data.ForeignregionID
        or
        (
            ((snapshotted_data.ForeignregionID is null) and not (source_data.ForeignregionID is null))
            or
            ((not snapshotted_data.ForeignregionID is null) and (source_data.ForeignregionID is null))
        ) or snapshotted_data.Foreignregiontier != source_data.Foreignregiontier
        or
        (
            ((snapshotted_data.Foreignregiontier is null) and not (source_data.Foreignregiontier is null))
            or
            ((not snapshotted_data.Foreignregiontier is null) and (source_data.Foreignregiontier is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ImportedregionMap_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedregionMap_Incr__dbt_tmp_temp_view"
    end



    
21:23:10.564529 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.39 seconds
21:23:10.566162 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:10.566349 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:10.613191 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:10.615736 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:10.615985 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:10.617537 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.66 seconds
21:23:10.618847 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: COMMIT
21:23:10.619592 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:23:10.619774 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    end

21:23:10.657131 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:10.671113 [debug] [Thread-1  ]: finished collecting timing info
21:23:10.671483 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: Close
21:23:10.672212 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55987dc10>]}
21:23:10.672731 [info ] [Thread-1  ]: 33 of 101 OK snapshotted stg.AH_ImportedCategoryMap_Incr........................ [[32mOK[0m in 11.23s]
21:23:10.673099 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ImportedCategoryMap_Incr
21:23:10.673278 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Increments_Incr
21:23:10.673650 [info ] [Thread-1  ]: 37 of 101 START snapshot stg.AH_Increments_Incr................................. [RUN]
21:23:10.674058 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Increments_Incr"
21:23:10.674205 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Increments_Incr
21:23:10.674510 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Increments_Incr
21:23:10.677239 [debug] [Thread-1  ]: finished collecting timing info
21:23:10.677428 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Increments_Incr
21:23:10.680220 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:10.680396 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:23:10.680512 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:23:10.680639 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:23:10.811330 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:23:10.843292 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:23:10.865701 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:10.866044 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:23:10.893759 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:23:10.895883 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:10.896425 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Increments_InterView]
        ) as __dbt_sbq
    
21:23:10.954007 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:23:10.975908 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:10.976250 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Increments_Incr"
        ) as __dbt_sbq
    
21:23:11.004819 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
21:23:11.007720 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:11.007959 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr'
      and table_schema = 'stg'
  
21:23:11.044177 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:11.048405 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:11.048674 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr'
      and table_schema = 'stg'
  
21:23:11.052080 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:11.055325 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:11.055506 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:11.098183 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:11.099836 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:11.100079 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    
21:23:11.120253 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:11.123950 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:11.124236 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
        
  
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Increments_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Increments_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Increments_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Increments_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Increments_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Increments_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:10.876789'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:10.876789'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:23:10.876789''), CONVERT(DATETIME2, ''2022-09-18 21:23:10.876789'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:23:10.876789'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:10.876789'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:10.876789'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:23:10.876789'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.PriceLevel != source_data.PriceLevel
        or
        (
            ((snapshotted_data.PriceLevel is null) and not (source_data.PriceLevel is null))
            or
            ((not snapshotted_data.PriceLevel is null) and (source_data.PriceLevel is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.PriceLevel != source_data.PriceLevel
        or
        (
            ((snapshotted_data.PriceLevel is null) and not (source_data.PriceLevel is null))
            or
            ((not snapshotted_data.PriceLevel is null) and (source_data.PriceLevel is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Increments_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Increments_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Increments_Incr__dbt_tmp_temp_view"
    end



    
21:23:12.126789 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
21:23:12.128408 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:12.128600 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:12.170036 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:12.172605 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:12.172862 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:12.461852 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:23:12.463896 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ImportedListingsMap_Incr"
21:23:12.464345 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:12.464479 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ImportedListingsMap_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr" (
                  "LoCallistingID", "ForeignListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "LoCallistingID", "ForeignListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:23:12.633887 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.75 seconds
21:23:12.637539 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:12.637809 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:12.682615 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:12.684180 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:12.684419 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    
21:23:13.060224 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.37 seconds
21:23:13.063801 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:13.064086 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:13.127928 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:23:13.129440 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:13.129674 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    
21:23:13.978634 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.29 seconds
21:23:13.980198 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:13.980382 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:14.003672 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.54 seconds
21:23:14.005520 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ImportedListingsMap_Incr: COMMIT
21:23:14.006391 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:23:14.006628 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    end

21:23:14.042776 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:14.052358 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:14.054591 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:14.054859 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:14.059990 [debug] [Thread-3  ]: finished collecting timing info
21:23:14.060312 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ImportedListingsMap_Incr: Close
21:23:14.061051 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55987dd60>]}
21:23:14.061550 [info ] [Thread-3  ]: 34 of 101 OK snapshotted stg.AH_ImportedListingsMap_Incr........................ [[32mOK[0m in 10.84s]
21:23:14.061938 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ImportedListingsMap_Incr
21:23:14.062141 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Invoices_Incr
21:23:14.062575 [info ] [Thread-3  ]: 38 of 101 START snapshot stg.AH_Invoices_Incr................................... [RUN]
21:23:14.063031 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Invoices_Incr"
21:23:14.063185 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Invoices_Incr
21:23:14.063322 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Invoices_Incr
21:23:14.066200 [debug] [Thread-3  ]: finished collecting timing info
21:23:14.066401 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Invoices_Incr
21:23:14.069307 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:23:14.069491 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:23:14.069610 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:23:14.069743 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:23:14.200342 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:23:14.236767 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:23:14.259731 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:23:14.260116 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:23:14.292489 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:23:14.295009 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:23:14.295255 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Invoices_InterView]
        ) as __dbt_sbq
    
21:23:14.322027 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.19 seconds
21:23:14.323722 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:14.323965 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:14.385704 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:23:14.407875 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:23:14.408235 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Invoices_Incr"
        ) as __dbt_sbq
    
21:23:14.417693 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:23:14.420125 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:14.420388 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:14.493680 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.44 seconds
21:23:14.497071 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:14.497738 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr'
      and table_schema = 'stg'
  
21:23:14.497597 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:23:14.501457 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:23:14.501660 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr'
      and table_schema = 'stg'
  
21:23:14.533054 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:14.537447 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:14.537814 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:14.570410 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:14.575154 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:23:14.575490 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
        
  
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Invoices_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Invoices_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Invoices_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Invoices_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Invoices_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Invoices_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:14.267466'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:14.267466'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:23:14.267466''), CONVERT(DATETIME2, ''2022-09-18 21:23:14.267466'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:23:14.267466'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:14.267466'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:14.267466'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:23:14.267466'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Paiddttm != source_data.Paiddttm
        or
        (
            ((snapshotted_data.Paiddttm is null) and not (source_data.Paiddttm is null))
            or
            ((not snapshotted_data.Paiddttm is null) and (source_data.Paiddttm is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Createddttm != source_data.Createddttm
        or
        (
            ((snapshotted_data.Createddttm is null) and not (source_data.Createddttm is null))
            or
            ((not snapshotted_data.Createddttm is null) and (source_data.Createddttm is null))
        ) or snapshotted_data.Fulfilleddttm != source_data.Fulfilleddttm
        or
        (
            ((snapshotted_data.Fulfilleddttm is null) and not (source_data.Fulfilleddttm is null))
            or
            ((not snapshotted_data.Fulfilleddttm is null) and (source_data.Fulfilleddttm is null))
        ) or snapshotted_data.PropertybagID != source_data.PropertybagID
        or
        (
            ((snapshotted_data.PropertybagID is null) and not (source_data.PropertybagID is null))
            or
            ((not snapshotted_data.PropertybagID is null) and (source_data.PropertybagID is null))
        ) or snapshotted_data.ShippingOptionID != source_data.ShippingOptionID
        or
        (
            ((snapshotted_data.ShippingOptionID is null) and not (source_data.ShippingOptionID is null))
            or
            ((not snapshotted_data.ShippingOptionID is null) and (source_data.ShippingOptionID is null))
        ) or snapshotted_data.PayerID != source_data.PayerID
        or
        (
            ((snapshotted_data.PayerID is null) and not (source_data.PayerID is null))
            or
            ((not snapshotted_data.PayerID is null) and (source_data.PayerID is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.SalesTax != source_data.SalesTax
        or
        (
            ((snapshotted_data.SalesTax is null) and not (source_data.SalesTax is null))
            or
            ((not snapshotted_data.SalesTax is null) and (source_data.SalesTax is null))
        ) or snapshotted_data.BuyersPremiumPercent != source_data.BuyersPremiumPercent
        or
        (
            ((snapshotted_data.BuyersPremiumPercent is null) and not (source_data.BuyersPremiumPercent is null))
            or
            ((not snapshotted_data.BuyersPremiumPercent is null) and (source_data.BuyersPremiumPercent is null))
        ) or snapshotted_data.BuyersPremiumAmount != source_data.BuyersPremiumAmount
        or
        (
            ((snapshotted_data.BuyersPremiumAmount is null) and not (source_data.BuyersPremiumAmount is null))
            or
            ((not snapshotted_data.BuyersPremiumAmount is null) and (source_data.BuyersPremiumAmount is null))
        ) or snapshotted_data.ShippingAmount != source_data.ShippingAmount
        or
        (
            ((snapshotted_data.ShippingAmount is null) and not (source_data.ShippingAmount is null))
            or
            ((not snapshotted_data.ShippingAmount is null) and (source_data.ShippingAmount is null))
        ) or snapshotted_data.SubTotal != source_data.SubTotal
        or
        (
            ((snapshotted_data.SubTotal is null) and not (source_data.SubTotal is null))
            or
            ((not snapshotted_data.SubTotal is null) and (source_data.SubTotal is null))
        ) or snapshotted_data.Total != source_data.Total
        or
        (
            ((snapshotted_data.Total is null) and not (source_data.Total is null))
            or
            ((not snapshotted_data.Total is null) and (source_data.Total is null))
        ) or snapshotted_data.IsPayerLocked != source_data.IsPayerLocked
        or
        (
            ((snapshotted_data.IsPayerLocked is null) and not (source_data.IsPayerLocked is null))
            or
            ((not snapshotted_data.IsPayerLocked is null) and (source_data.IsPayerLocked is null))
        ) or snapshotted_data.Shipped != source_data.Shipped
        or
        (
            ((snapshotted_data.Shipped is null) and not (source_data.Shipped is null))
            or
            ((not snapshotted_data.Shipped is null) and (source_data.Shipped is null))
        ) or snapshotted_data.IsArchived != source_data.IsArchived
        or
        (
            ((snapshotted_data.IsArchived is null) and not (source_data.IsArchived is null))
            or
            ((not snapshotted_data.IsArchived is null) and (source_data.IsArchived is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.ShippingLastName != source_data.ShippingLastName
        or
        (
            ((snapshotted_data.ShippingLastName is null) and not (source_data.ShippingLastName is null))
            or
            ((not snapshotted_data.ShippingLastName is null) and (source_data.ShippingLastName is null))
        ) or snapshotted_data.BillingLastName != source_data.BillingLastName
        or
        (
            ((snapshotted_data.BillingLastName is null) and not (source_data.BillingLastName is null))
            or
            ((not snapshotted_data.BillingLastName is null) and (source_data.BillingLastName is null))
        ) or snapshotted_data.OwnerName != source_data.OwnerName
        or
        (
            ((snapshotted_data.OwnerName is null) and not (source_data.OwnerName is null))
            or
            ((not snapshotted_data.OwnerName is null) and (source_data.OwnerName is null))
        ) or snapshotted_data.Shippingdetails != source_data.Shippingdetails
        or
        (
            ((snapshotted_data.Shippingdetails is null) and not (source_data.Shippingdetails is null))
            or
            ((not snapshotted_data.Shippingdetails is null) and (source_data.Shippingdetails is null))
        ) or snapshotted_data.OwnerCity != source_data.OwnerCity
        or
        (
            ((snapshotted_data.OwnerCity is null) and not (source_data.OwnerCity is null))
            or
            ((not snapshotted_data.OwnerCity is null) and (source_data.OwnerCity is null))
        ) or snapshotted_data.OwnerStateregion != source_data.OwnerStateregion
        or
        (
            ((snapshotted_data.OwnerStateregion is null) and not (source_data.OwnerStateregion is null))
            or
            ((not snapshotted_data.OwnerStateregion is null) and (source_data.OwnerStateregion is null))
        ) or snapshotted_data.OwnerzipPostal != source_data.OwnerzipPostal
        or
        (
            ((snapshotted_data.OwnerzipPostal is null) and not (source_data.OwnerzipPostal is null))
            or
            ((not snapshotted_data.OwnerzipPostal is null) and (source_data.OwnerzipPostal is null))
        ) or snapshotted_data.OwnerCountry != source_data.OwnerCountry
        or
        (
            ((snapshotted_data.OwnerCountry is null) and not (source_data.OwnerCountry is null))
            or
            ((not snapshotted_data.OwnerCountry is null) and (source_data.OwnerCountry is null))
        ) or snapshotted_data.ShippingFirstName != source_data.ShippingFirstName
        or
        (
            ((snapshotted_data.ShippingFirstName is null) and not (source_data.ShippingFirstName is null))
            or
            ((not snapshotted_data.ShippingFirstName is null) and (source_data.ShippingFirstName is null))
        ) or snapshotted_data.BillingFirstName != source_data.BillingFirstName
        or
        (
            ((snapshotted_data.BillingFirstName is null) and not (source_data.BillingFirstName is null))
            or
            ((not snapshotted_data.BillingFirstName is null) and (source_data.BillingFirstName is null))
        ) or snapshotted_data.BillingCity != source_data.BillingCity
        or
        (
            ((snapshotted_data.BillingCity is null) and not (source_data.BillingCity is null))
            or
            ((not snapshotted_data.BillingCity is null) and (source_data.BillingCity is null))
        ) or snapshotted_data.BillingStateregion != source_data.BillingStateregion
        or
        (
            ((snapshotted_data.BillingStateregion is null) and not (source_data.BillingStateregion is null))
            or
            ((not snapshotted_data.BillingStateregion is null) and (source_data.BillingStateregion is null))
        ) or snapshotted_data.BillingzipPostal != source_data.BillingzipPostal
        or
        (
            ((snapshotted_data.BillingzipPostal is null) and not (source_data.BillingzipPostal is null))
            or
            ((not snapshotted_data.BillingzipPostal is null) and (source_data.BillingzipPostal is null))
        ) or snapshotted_data.BillingCountry != source_data.BillingCountry
        or
        (
            ((snapshotted_data.BillingCountry is null) and not (source_data.BillingCountry is null))
            or
            ((not snapshotted_data.BillingCountry is null) and (source_data.BillingCountry is null))
        ) or snapshotted_data.OwnerStreet1 != source_data.OwnerStreet1
        or
        (
            ((snapshotted_data.OwnerStreet1 is null) and not (source_data.OwnerStreet1 is null))
            or
            ((not snapshotted_data.OwnerStreet1 is null) and (source_data.OwnerStreet1 is null))
        ) or snapshotted_data.OwnerStreet2 != source_data.OwnerStreet2
        or
        (
            ((snapshotted_data.OwnerStreet2 is null) and not (source_data.OwnerStreet2 is null))
            or
            ((not snapshotted_data.OwnerStreet2 is null) and (source_data.OwnerStreet2 is null))
        ) or snapshotted_data.ShippingCity != source_data.ShippingCity
        or
        (
            ((snapshotted_data.ShippingCity is null) and not (source_data.ShippingCity is null))
            or
            ((not snapshotted_data.ShippingCity is null) and (source_data.ShippingCity is null))
        ) or snapshotted_data.ShippingStateregion != source_data.ShippingStateregion
        or
        (
            ((snapshotted_data.ShippingStateregion is null) and not (source_data.ShippingStateregion is null))
            or
            ((not snapshotted_data.ShippingStateregion is null) and (source_data.ShippingStateregion is null))
        ) or snapshotted_data.ShippingzipPostal != source_data.ShippingzipPostal
        or
        (
            ((snapshotted_data.ShippingzipPostal is null) and not (source_data.ShippingzipPostal is null))
            or
            ((not snapshotted_data.ShippingzipPostal is null) and (source_data.ShippingzipPostal is null))
        ) or snapshotted_data.ShippingCountry != source_data.ShippingCountry
        or
        (
            ((snapshotted_data.ShippingCountry is null) and not (source_data.ShippingCountry is null))
            or
            ((not snapshotted_data.ShippingCountry is null) and (source_data.ShippingCountry is null))
        ) or snapshotted_data.BillingStreet1 != source_data.BillingStreet1
        or
        (
            ((snapshotted_data.BillingStreet1 is null) and not (source_data.BillingStreet1 is null))
            or
            ((not snapshotted_data.BillingStreet1 is null) and (source_data.BillingStreet1 is null))
        ) or snapshotted_data.BillingStreet2 != source_data.BillingStreet2
        or
        (
            ((snapshotted_data.BillingStreet2 is null) and not (source_data.BillingStreet2 is null))
            or
            ((not snapshotted_data.BillingStreet2 is null) and (source_data.BillingStreet2 is null))
        ) or snapshotted_data.Comments != source_data.Comments
        or
        (
            ((snapshotted_data.Comments is null) and not (source_data.Comments is null))
            or
            ((not snapshotted_data.Comments is null) and (source_data.Comments is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Currency != source_data.Currency
        or
        (
            ((snapshotted_data.Currency is null) and not (source_data.Currency is null))
            or
            ((not snapshotted_data.Currency is null) and (source_data.Currency is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.ShippingStreet1 != source_data.ShippingStreet1
        or
        (
            ((snapshotted_data.ShippingStreet1 is null) and not (source_data.ShippingStreet1 is null))
            or
            ((not snapshotted_data.ShippingStreet1 is null) and (source_data.ShippingStreet1 is null))
        ) or snapshotted_data.ShippingStreet2 != source_data.ShippingStreet2
        or
        (
            ((snapshotted_data.ShippingStreet2 is null) and not (source_data.ShippingStreet2 is null))
            or
            ((not snapshotted_data.ShippingStreet2 is null) and (source_data.ShippingStreet2 is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Paiddttm != source_data.Paiddttm
        or
        (
            ((snapshotted_data.Paiddttm is null) and not (source_data.Paiddttm is null))
            or
            ((not snapshotted_data.Paiddttm is null) and (source_data.Paiddttm is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Createddttm != source_data.Createddttm
        or
        (
            ((snapshotted_data.Createddttm is null) and not (source_data.Createddttm is null))
            or
            ((not snapshotted_data.Createddttm is null) and (source_data.Createddttm is null))
        ) or snapshotted_data.Fulfilleddttm != source_data.Fulfilleddttm
        or
        (
            ((snapshotted_data.Fulfilleddttm is null) and not (source_data.Fulfilleddttm is null))
            or
            ((not snapshotted_data.Fulfilleddttm is null) and (source_data.Fulfilleddttm is null))
        ) or snapshotted_data.PropertybagID != source_data.PropertybagID
        or
        (
            ((snapshotted_data.PropertybagID is null) and not (source_data.PropertybagID is null))
            or
            ((not snapshotted_data.PropertybagID is null) and (source_data.PropertybagID is null))
        ) or snapshotted_data.ShippingOptionID != source_data.ShippingOptionID
        or
        (
            ((snapshotted_data.ShippingOptionID is null) and not (source_data.ShippingOptionID is null))
            or
            ((not snapshotted_data.ShippingOptionID is null) and (source_data.ShippingOptionID is null))
        ) or snapshotted_data.PayerID != source_data.PayerID
        or
        (
            ((snapshotted_data.PayerID is null) and not (source_data.PayerID is null))
            or
            ((not snapshotted_data.PayerID is null) and (source_data.PayerID is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.SalesTax != source_data.SalesTax
        or
        (
            ((snapshotted_data.SalesTax is null) and not (source_data.SalesTax is null))
            or
            ((not snapshotted_data.SalesTax is null) and (source_data.SalesTax is null))
        ) or snapshotted_data.BuyersPremiumPercent != source_data.BuyersPremiumPercent
        or
        (
            ((snapshotted_data.BuyersPremiumPercent is null) and not (source_data.BuyersPremiumPercent is null))
            or
            ((not snapshotted_data.BuyersPremiumPercent is null) and (source_data.BuyersPremiumPercent is null))
        ) or snapshotted_data.BuyersPremiumAmount != source_data.BuyersPremiumAmount
        or
        (
            ((snapshotted_data.BuyersPremiumAmount is null) and not (source_data.BuyersPremiumAmount is null))
            or
            ((not snapshotted_data.BuyersPremiumAmount is null) and (source_data.BuyersPremiumAmount is null))
        ) or snapshotted_data.ShippingAmount != source_data.ShippingAmount
        or
        (
            ((snapshotted_data.ShippingAmount is null) and not (source_data.ShippingAmount is null))
            or
            ((not snapshotted_data.ShippingAmount is null) and (source_data.ShippingAmount is null))
        ) or snapshotted_data.SubTotal != source_data.SubTotal
        or
        (
            ((snapshotted_data.SubTotal is null) and not (source_data.SubTotal is null))
            or
            ((not snapshotted_data.SubTotal is null) and (source_data.SubTotal is null))
        ) or snapshotted_data.Total != source_data.Total
        or
        (
            ((snapshotted_data.Total is null) and not (source_data.Total is null))
            or
            ((not snapshotted_data.Total is null) and (source_data.Total is null))
        ) or snapshotted_data.IsPayerLocked != source_data.IsPayerLocked
        or
        (
            ((snapshotted_data.IsPayerLocked is null) and not (source_data.IsPayerLocked is null))
            or
            ((not snapshotted_data.IsPayerLocked is null) and (source_data.IsPayerLocked is null))
        ) or snapshotted_data.Shipped != source_data.Shipped
        or
        (
            ((snapshotted_data.Shipped is null) and not (source_data.Shipped is null))
            or
            ((not snapshotted_data.Shipped is null) and (source_data.Shipped is null))
        ) or snapshotted_data.IsArchived != source_data.IsArchived
        or
        (
            ((snapshotted_data.IsArchived is null) and not (source_data.IsArchived is null))
            or
            ((not snapshotted_data.IsArchived is null) and (source_data.IsArchived is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.ShippingLastName != source_data.ShippingLastName
        or
        (
            ((snapshotted_data.ShippingLastName is null) and not (source_data.ShippingLastName is null))
            or
            ((not snapshotted_data.ShippingLastName is null) and (source_data.ShippingLastName is null))
        ) or snapshotted_data.BillingLastName != source_data.BillingLastName
        or
        (
            ((snapshotted_data.BillingLastName is null) and not (source_data.BillingLastName is null))
            or
            ((not snapshotted_data.BillingLastName is null) and (source_data.BillingLastName is null))
        ) or snapshotted_data.OwnerName != source_data.OwnerName
        or
        (
            ((snapshotted_data.OwnerName is null) and not (source_data.OwnerName is null))
            or
            ((not snapshotted_data.OwnerName is null) and (source_data.OwnerName is null))
        ) or snapshotted_data.Shippingdetails != source_data.Shippingdetails
        or
        (
            ((snapshotted_data.Shippingdetails is null) and not (source_data.Shippingdetails is null))
            or
            ((not snapshotted_data.Shippingdetails is null) and (source_data.Shippingdetails is null))
        ) or snapshotted_data.OwnerCity != source_data.OwnerCity
        or
        (
            ((snapshotted_data.OwnerCity is null) and not (source_data.OwnerCity is null))
            or
            ((not snapshotted_data.OwnerCity is null) and (source_data.OwnerCity is null))
        ) or snapshotted_data.OwnerStateregion != source_data.OwnerStateregion
        or
        (
            ((snapshotted_data.OwnerStateregion is null) and not (source_data.OwnerStateregion is null))
            or
            ((not snapshotted_data.OwnerStateregion is null) and (source_data.OwnerStateregion is null))
        ) or snapshotted_data.OwnerzipPostal != source_data.OwnerzipPostal
        or
        (
            ((snapshotted_data.OwnerzipPostal is null) and not (source_data.OwnerzipPostal is null))
            or
            ((not snapshotted_data.OwnerzipPostal is null) and (source_data.OwnerzipPostal is null))
        ) or snapshotted_data.OwnerCountry != source_data.OwnerCountry
        or
        (
            ((snapshotted_data.OwnerCountry is null) and not (source_data.OwnerCountry is null))
            or
            ((not snapshotted_data.OwnerCountry is null) and (source_data.OwnerCountry is null))
        ) or snapshotted_data.ShippingFirstName != source_data.ShippingFirstName
        or
        (
            ((snapshotted_data.ShippingFirstName is null) and not (source_data.ShippingFirstName is null))
            or
            ((not snapshotted_data.ShippingFirstName is null) and (source_data.ShippingFirstName is null))
        ) or snapshotted_data.BillingFirstName != source_data.BillingFirstName
        or
        (
            ((snapshotted_data.BillingFirstName is null) and not (source_data.BillingFirstName is null))
            or
            ((not snapshotted_data.BillingFirstName is null) and (source_data.BillingFirstName is null))
        ) or snapshotted_data.BillingCity != source_data.BillingCity
        or
        (
            ((snapshotted_data.BillingCity is null) and not (source_data.BillingCity is null))
            or
            ((not snapshotted_data.BillingCity is null) and (source_data.BillingCity is null))
        ) or snapshotted_data.BillingStateregion != source_data.BillingStateregion
        or
        (
            ((snapshotted_data.BillingStateregion is null) and not (source_data.BillingStateregion is null))
            or
            ((not snapshotted_data.BillingStateregion is null) and (source_data.BillingStateregion is null))
        ) or snapshotted_data.BillingzipPostal != source_data.BillingzipPostal
        or
        (
            ((snapshotted_data.BillingzipPostal is null) and not (source_data.BillingzipPostal is null))
            or
            ((not snapshotted_data.BillingzipPostal is null) and (source_data.BillingzipPostal is null))
        ) or snapshotted_data.BillingCountry != source_data.BillingCountry
        or
        (
            ((snapshotted_data.BillingCountry is null) and not (source_data.BillingCountry is null))
            or
            ((not snapshotted_data.BillingCountry is null) and (source_data.BillingCountry is null))
        ) or snapshotted_data.OwnerStreet1 != source_data.OwnerStreet1
        or
        (
            ((snapshotted_data.OwnerStreet1 is null) and not (source_data.OwnerStreet1 is null))
            or
            ((not snapshotted_data.OwnerStreet1 is null) and (source_data.OwnerStreet1 is null))
        ) or snapshotted_data.OwnerStreet2 != source_data.OwnerStreet2
        or
        (
            ((snapshotted_data.OwnerStreet2 is null) and not (source_data.OwnerStreet2 is null))
            or
            ((not snapshotted_data.OwnerStreet2 is null) and (source_data.OwnerStreet2 is null))
        ) or snapshotted_data.ShippingCity != source_data.ShippingCity
        or
        (
            ((snapshotted_data.ShippingCity is null) and not (source_data.ShippingCity is null))
            or
            ((not snapshotted_data.ShippingCity is null) and (source_data.ShippingCity is null))
        ) or snapshotted_data.ShippingStateregion != source_data.ShippingStateregion
        or
        (
            ((snapshotted_data.ShippingStateregion is null) and not (source_data.ShippingStateregion is null))
            or
            ((not snapshotted_data.ShippingStateregion is null) and (source_data.ShippingStateregion is null))
        ) or snapshotted_data.ShippingzipPostal != source_data.ShippingzipPostal
        or
        (
            ((snapshotted_data.ShippingzipPostal is null) and not (source_data.ShippingzipPostal is null))
            or
            ((not snapshotted_data.ShippingzipPostal is null) and (source_data.ShippingzipPostal is null))
        ) or snapshotted_data.ShippingCountry != source_data.ShippingCountry
        or
        (
            ((snapshotted_data.ShippingCountry is null) and not (source_data.ShippingCountry is null))
            or
            ((not snapshotted_data.ShippingCountry is null) and (source_data.ShippingCountry is null))
        ) or snapshotted_data.BillingStreet1 != source_data.BillingStreet1
        or
        (
            ((snapshotted_data.BillingStreet1 is null) and not (source_data.BillingStreet1 is null))
            or
            ((not snapshotted_data.BillingStreet1 is null) and (source_data.BillingStreet1 is null))
        ) or snapshotted_data.BillingStreet2 != source_data.BillingStreet2
        or
        (
            ((snapshotted_data.BillingStreet2 is null) and not (source_data.BillingStreet2 is null))
            or
            ((not snapshotted_data.BillingStreet2 is null) and (source_data.BillingStreet2 is null))
        ) or snapshotted_data.Comments != source_data.Comments
        or
        (
            ((snapshotted_data.Comments is null) and not (source_data.Comments is null))
            or
            ((not snapshotted_data.Comments is null) and (source_data.Comments is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Currency != source_data.Currency
        or
        (
            ((snapshotted_data.Currency is null) and not (source_data.Currency is null))
            or
            ((not snapshotted_data.Currency is null) and (source_data.Currency is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.ShippingStreet1 != source_data.ShippingStreet1
        or
        (
            ((snapshotted_data.ShippingStreet1 is null) and not (source_data.ShippingStreet1 is null))
            or
            ((not snapshotted_data.ShippingStreet1 is null) and (source_data.ShippingStreet1 is null))
        ) or snapshotted_data.ShippingStreet2 != source_data.ShippingStreet2
        or
        (
            ((snapshotted_data.ShippingStreet2 is null) and not (source_data.ShippingStreet2 is null))
            or
            ((not snapshotted_data.ShippingStreet2 is null) and (source_data.ShippingStreet2 is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Invoices_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Invoices_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Invoices_Incr__dbt_tmp_temp_view"
    end



    
21:23:14.579108 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:14.580448 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:14.580668 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    
21:23:14.631797 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:23:14.637434 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:14.637746 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr'
      and table_schema = 'stg'
  
21:23:14.675724 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:14.680233 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:14.680524 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:14.721376 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:14.723073 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:14.723336 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    
21:23:15.606173 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
21:23:15.607823 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:15.608009 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:15.647253 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:15.649829 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:15.650108 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:15.756119 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
21:23:15.759591 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:15.759850 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:15.795758 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:15.798347 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:15.798658 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:15.897761 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:23:15.900971 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:15.901245 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr'
      and table_schema = 'stg'
  
21:23:15.976406 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:15.980603 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:15.980902 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:16.019868 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:16.021478 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:16.021725 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    
21:23:16.042612 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:23:16.045541 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:16.045814 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr'
      and table_schema = 'stg'
  
21:23:16.079462 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:23:16.084305 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:16.084604 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:16.137823 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:16.139680 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:16.139947 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    
21:23:17.168692 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
21:23:17.170348 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:17.170669 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:17.176388 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
21:23:17.177770 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:17.177956 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:17.212165 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:17.214729 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:17.214995 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:17.217653 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:17.219895 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:17.220110 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:17.463444 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:23:17.465511 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ImportedregionMap_Incr"
21:23:17.465961 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:17.466083 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ImportedregionMap_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr" (
                  "LocalregionID", "ForeignregionID", "Foreignregiontier", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "LocalregionID", "ForeignregionID", "Foreignregiontier", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:23:17.505043 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:23:17.507191 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ImportedUserMap_Incr"
21:23:17.507692 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:17.507859 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ImportedUserMap_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr" (
                  "LocalUserID", "ForeignUserID", "ImportedUserName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "LocalUserID", "ForeignUserID", "ImportedUserName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:23:18.181850 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 7.06 seconds
21:23:18.185687 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:18.185997 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:18.225928 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:18.227639 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:18.227916 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Increments_Incr__dbt_tmp"
    
21:23:19.065054 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.56 seconds
21:23:19.066841 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ImportedUserMap_Incr: COMMIT
21:23:19.067615 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:23:19.067770 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."#AH_ImportedUserMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    end

21:23:19.110464 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:19.124759 [debug] [Thread-4  ]: finished collecting timing info
21:23:19.125138 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ImportedUserMap_Incr: Close
21:23:19.125862 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5585f2d90>]}
21:23:19.126372 [info ] [Thread-4  ]: 35 of 101 OK snapshotted stg.AH_ImportedUserMap_Incr............................ [[32mOK[0m in 10.71s]
21:23:19.126793 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ImportedUserMap_Incr
21:23:19.126977 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_KeyTable_Incr
21:23:19.127345 [info ] [Thread-4  ]: 39 of 101 START snapshot stg.AH_KeyTable_Incr................................... [RUN]
21:23:19.127747 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_KeyTable_Incr"
21:23:19.127916 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_KeyTable_Incr
21:23:19.128051 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_KeyTable_Incr
21:23:19.130809 [debug] [Thread-4  ]: finished collecting timing info
21:23:19.131002 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_KeyTable_Incr
21:23:19.133707 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:19.133883 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:23:19.134001 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:23:19.134129 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:23:19.174946 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.71 seconds
21:23:19.176781 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ImportedregionMap_Incr: COMMIT
21:23:19.177571 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:23:19.177743 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."#AH_ImportedregionMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    end

21:23:19.217991 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:19.231876 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.00 seconds
21:23:19.233310 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:19.233547 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:19.234574 [debug] [Thread-2  ]: finished collecting timing info
21:23:19.234805 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ImportedregionMap_Incr: Close
21:23:19.235431 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559879040>]}
21:23:19.235899 [info ] [Thread-2  ]: 36 of 101 OK snapshotted stg.AH_ImportedregionMap_Incr.......................... [[32mOK[0m in 10.00s]
21:23:19.236266 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ImportedregionMap_Incr
21:23:19.236440 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Languages_Incr
21:23:19.236808 [info ] [Thread-2  ]: 40 of 101 START snapshot stg.AH_Languages_Incr.................................. [RUN]
21:23:19.237246 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Languages_Incr"
21:23:19.237405 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Languages_Incr
21:23:19.237537 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Languages_Incr
21:23:19.240279 [debug] [Thread-2  ]: finished collecting timing info
21:23:19.240468 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Languages_Incr
21:23:19.240733 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:23:19.243551 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:19.243882 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:23:19.244012 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:23:19.244155 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:23:19.272387 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:23:19.296158 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:19.296514 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:23:19.305208 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:19.310825 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:19.311038 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:19.325877 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:23:19.327716 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:19.327925 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_KeyTable_InterView]
        ) as __dbt_sbq
    
21:23:19.344309 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:23:19.375102 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:23:19.396086 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:19.409974 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:19.410335 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:23:19.420727 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:19.421060 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr"
        ) as __dbt_sbq
    
21:23:19.460917 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:19.463519 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:19.463792 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Languages_InterView]
        ) as __dbt_sbq
    
21:23:19.497877 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:23:19.501460 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:19.501742 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr'
      and table_schema = 'stg'
  
21:23:19.530462 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:23:19.533610 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:19.533860 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr'
      and table_schema = 'stg'
  
21:23:19.547576 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:23:19.569244 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:19.569609 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Languages_Incr"
        ) as __dbt_sbq
    
21:23:19.604315 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:23:19.608215 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:19.608553 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
        
  
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_KeyTable_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_KeyTable_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_KeyTable_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_KeyTable_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_KeyTable_InterView]

    ),

    snapshotted_data as (

        select *,
            NextID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            NextID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:19.298798'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:19.298798'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:23:19.298798''), CONVERT(DATETIME2, ''2022-09-18 21:23:19.298798'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(NextID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:23:19.298798'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            NextID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:19.298798'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:19.298798'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:23:19.298798'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.NextID != source_data.NextID
        or
        (
            ((snapshotted_data.NextID is null) and not (source_data.NextID is null))
            or
            ((not snapshotted_data.NextID is null) and (source_data.NextID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.NextID != source_data.NextID
        or
        (
            ((snapshotted_data.NextID is null) and not (source_data.NextID is null))
            or
            ((not snapshotted_data.NextID is null) and (source_data.NextID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_KeyTable_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_KeyTable_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_KeyTable_Incr__dbt_tmp_temp_view"
    end



    
21:23:19.613518 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:23:19.618236 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:19.618461 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:19.633188 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:23:19.636214 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:19.636452 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr'
      and table_schema = 'stg'
  
21:23:19.664211 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:19.665770 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:19.666010 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Increments_Incr__dbt_tmp"
    
21:23:19.722758 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:23:19.726608 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:19.726872 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
        
  
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Languages_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Languages_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Languages_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Languages_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Languages_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Languages_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:19.439424'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:19.439424'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:23:19.439424''), CONVERT(DATETIME2, ''2022-09-18 21:23:19.439424'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:23:19.439424'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:19.439424'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:19.439424'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:23:19.439424'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Languages_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Languages_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Languages_Incr__dbt_tmp_temp_view"
    end



    
21:23:20.758623 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.09 seconds
21:23:20.760339 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:20.760583 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:20.804416 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:20.807191 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:20.807451 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:21.036885 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:23:21.040121 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:21.040383 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr'
      and table_schema = 'stg'
  
21:23:21.163705 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:23:21.168290 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:21.168584 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:21.233338 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:23:21.234985 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:21.235231 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Increments_Incr__dbt_tmp"
    
21:23:22.320859 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.09 seconds
21:23:22.322448 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:22.322660 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:22.357211 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:23:22.359925 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:22.360185 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:22.576093 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:23:22.578382 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Increments_Incr"
21:23:22.578999 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:22.579189 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Increments_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Increments_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Increments_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Increments_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Increments_Incr" (
                  "ID", "LastUpdatedUser", "PriceLevel", "Amount", "ListingTypeID", "AuctionEventID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "LastUpdatedUser", "PriceLevel", "Amount", "ListingTypeID", "AuctionEventID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Increments_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:23:22.734259 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.13 seconds
21:23:22.737931 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:22.738193 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:22.821166 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:23:22.822822 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:22.823061 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_KeyTable_Incr__dbt_tmp"
    
21:23:24.081497 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.26 seconds
21:23:24.083191 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:24.083385 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:24.194674 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:23:24.197408 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:24.197642 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:24.199463 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.62 seconds
21:23:24.200778 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Increments_Incr: COMMIT
21:23:24.201492 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:23:24.201661 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."#AH_Increments_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Increments_Incr__dbt_tmp"
    end

21:23:24.250974 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:24.265460 [debug] [Thread-1  ]: finished collecting timing info
21:23:24.265903 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Increments_Incr: Close
21:23:24.266756 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5584b89a0>]}
21:23:24.267290 [info ] [Thread-1  ]: 37 of 101 OK snapshotted stg.AH_Increments_Incr................................. [[32mOK[0m in 13.59s]
21:23:24.267679 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Increments_Incr
21:23:24.267864 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_LineItems_Incr
21:23:24.268256 [info ] [Thread-1  ]: 41 of 101 START snapshot stg.AH_LineItems_Incr.................................. [RUN]
21:23:24.268700 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_LineItems_Incr"
21:23:24.268857 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_LineItems_Incr
21:23:24.268989 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_LineItems_Incr
21:23:24.271974 [debug] [Thread-1  ]: finished collecting timing info
21:23:24.272181 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_LineItems_Incr
21:23:24.275267 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:24.275475 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:23:24.275595 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:23:24.275729 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:23:24.389459 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:23:24.425986 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:23:24.449124 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:24.449508 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:23:24.491688 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:24.493892 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:24.494443 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_LineItems_InterView]
        ) as __dbt_sbq
    
21:23:24.532522 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
21:23:24.535391 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:24.535636 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr'
      and table_schema = 'stg'
  
21:23:24.584883 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:23:24.598511 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:23:24.602338 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:24.611709 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:24.612579 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:24.612775 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_LineItems_Incr"
        ) as __dbt_sbq
    
21:23:24.655873 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:24.657518 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:24.657775 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_KeyTable_Incr__dbt_tmp"
    
21:23:24.735165 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:23:24.739303 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:24.739594 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr'
      and table_schema = 'stg'
  
21:23:24.828272 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:23:24.832337 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:24.832624 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
        
  
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LineItems_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_LineItems_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_LineItems_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_LineItems_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_LineItems_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_LineItems_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:24.470753'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:24.470753'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:23:24.470753''), CONVERT(DATETIME2, ''2022-09-18 21:23:24.470753'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:23:24.470753'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:24.470753'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:24.470753'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:23:24.470753'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Currency != source_data.Currency
        or
        (
            ((snapshotted_data.Currency is null) and not (source_data.Currency is null))
            or
            ((not snapshotted_data.Currency is null) and (source_data.Currency is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.LotNumber != source_data.LotNumber
        or
        (
            ((snapshotted_data.LotNumber is null) and not (source_data.LotNumber is null))
            or
            ((not snapshotted_data.LotNumber is null) and (source_data.LotNumber is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.InvoiceID != source_data.InvoiceID
        or
        (
            ((snapshotted_data.InvoiceID is null) and not (source_data.InvoiceID is null))
            or
            ((not snapshotted_data.InvoiceID is null) and (source_data.InvoiceID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.PayerID != source_data.PayerID
        or
        (
            ((snapshotted_data.PayerID is null) and not (source_data.PayerID is null))
            or
            ((not snapshotted_data.PayerID is null) and (source_data.PayerID is null))
        ) or snapshotted_data.ReListiteration != source_data.ReListiteration
        or
        (
            ((snapshotted_data.ReListiteration is null) and not (source_data.ReListiteration is null))
            or
            ((not snapshotted_data.ReListiteration is null) and (source_data.ReListiteration is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.TotalAmount != source_data.TotalAmount
        or
        (
            ((snapshotted_data.TotalAmount is null) and not (source_data.TotalAmount is null))
            or
            ((not snapshotted_data.TotalAmount is null) and (source_data.TotalAmount is null))
        ) or snapshotted_data.PeRunitAmount != source_data.PeRunitAmount
        or
        (
            ((snapshotted_data.PeRunitAmount is null) and not (source_data.PeRunitAmount is null))
            or
            ((not snapshotted_data.PeRunitAmount is null) and (source_data.PeRunitAmount is null))
        ) or snapshotted_data.Taxable != source_data.Taxable
        or
        (
            ((snapshotted_data.Taxable is null) and not (source_data.Taxable is null))
            or
            ((not snapshotted_data.Taxable is null) and (source_data.Taxable is null))
        ) or snapshotted_data.IsArchived != source_data.IsArchived
        or
        (
            ((snapshotted_data.IsArchived is null) and not (source_data.IsArchived is null))
            or
            ((not snapshotted_data.IsArchived is null) and (source_data.IsArchived is null))
        ) or snapshotted_data.BuyersPremiuMapplies != source_data.BuyersPremiuMapplies
        or
        (
            ((snapshotted_data.BuyersPremiuMapplies is null) and not (source_data.BuyersPremiuMapplies is null))
            or
            ((not snapshotted_data.BuyersPremiuMapplies is null) and (source_data.BuyersPremiuMapplies is null))
        ) or snapshotted_data.IsPayerArchived != source_data.IsPayerArchived
        or
        (
            ((snapshotted_data.IsPayerArchived is null) and not (source_data.IsPayerArchived is null))
            or
            ((not snapshotted_data.IsPayerArchived is null) and (source_data.IsPayerArchived is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Currency != source_data.Currency
        or
        (
            ((snapshotted_data.Currency is null) and not (source_data.Currency is null))
            or
            ((not snapshotted_data.Currency is null) and (source_data.Currency is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.LotNumber != source_data.LotNumber
        or
        (
            ((snapshotted_data.LotNumber is null) and not (source_data.LotNumber is null))
            or
            ((not snapshotted_data.LotNumber is null) and (source_data.LotNumber is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.InvoiceID != source_data.InvoiceID
        or
        (
            ((snapshotted_data.InvoiceID is null) and not (source_data.InvoiceID is null))
            or
            ((not snapshotted_data.InvoiceID is null) and (source_data.InvoiceID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.PayerID != source_data.PayerID
        or
        (
            ((snapshotted_data.PayerID is null) and not (source_data.PayerID is null))
            or
            ((not snapshotted_data.PayerID is null) and (source_data.PayerID is null))
        ) or snapshotted_data.ReListiteration != source_data.ReListiteration
        or
        (
            ((snapshotted_data.ReListiteration is null) and not (source_data.ReListiteration is null))
            or
            ((not snapshotted_data.ReListiteration is null) and (source_data.ReListiteration is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.TotalAmount != source_data.TotalAmount
        or
        (
            ((snapshotted_data.TotalAmount is null) and not (source_data.TotalAmount is null))
            or
            ((not snapshotted_data.TotalAmount is null) and (source_data.TotalAmount is null))
        ) or snapshotted_data.PeRunitAmount != source_data.PeRunitAmount
        or
        (
            ((snapshotted_data.PeRunitAmount is null) and not (source_data.PeRunitAmount is null))
            or
            ((not snapshotted_data.PeRunitAmount is null) and (source_data.PeRunitAmount is null))
        ) or snapshotted_data.Taxable != source_data.Taxable
        or
        (
            ((snapshotted_data.Taxable is null) and not (source_data.Taxable is null))
            or
            ((not snapshotted_data.Taxable is null) and (source_data.Taxable is null))
        ) or snapshotted_data.IsArchived != source_data.IsArchived
        or
        (
            ((snapshotted_data.IsArchived is null) and not (source_data.IsArchived is null))
            or
            ((not snapshotted_data.IsArchived is null) and (source_data.IsArchived is null))
        ) or snapshotted_data.BuyersPremiuMapplies != source_data.BuyersPremiuMapplies
        or
        (
            ((snapshotted_data.BuyersPremiuMapplies is null) and not (source_data.BuyersPremiuMapplies is null))
            or
            ((not snapshotted_data.BuyersPremiuMapplies is null) and (source_data.BuyersPremiuMapplies is null))
        ) or snapshotted_data.IsPayerArchived != source_data.IsPayerArchived
        or
        (
            ((snapshotted_data.IsPayerArchived is null) and not (source_data.IsPayerArchived is null))
            or
            ((not snapshotted_data.IsPayerArchived is null) and (source_data.IsPayerArchived is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_LineItems_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_LineItems_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LineItems_Incr__dbt_tmp_temp_view"
    end



    
21:23:25.413933 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 5.69 seconds
21:23:25.417514 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:25.417757 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:25.457826 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:25.459554 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:25.459853 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Languages_Incr__dbt_tmp"
    
21:23:25.566332 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.91 seconds
21:23:25.568147 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:25.568425 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:25.610233 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:25.612824 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:25.613117 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:25.845681 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:23:25.849945 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:25.850291 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr'
      and table_schema = 'stg'
  
21:23:25.887135 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:25.977432 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:25.977843 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:26.072979 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:23:26.074657 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:26.074941 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_KeyTable_Incr__dbt_tmp"
    
21:23:26.737097 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.28 seconds
21:23:26.738882 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:26.739137 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:26.817489 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:23:26.820215 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:26.820509 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:26.963097 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.89 seconds
21:23:26.964792 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:26.965039 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:27.027107 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:23:27.029434 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:27.029683 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:27.103342 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:23:27.106380 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:27.106684 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr'
      and table_schema = 'stg'
  
21:23:27.147270 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:27.151681 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:27.152036 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:27.189157 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:27.190823 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:27.191071 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Languages_Incr__dbt_tmp"
    
21:23:27.255086 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:23:27.257021 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_KeyTable_Incr"
21:23:27.257543 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:27.257704 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_KeyTable_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr" (
                  "NextID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "NextID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_KeyTable_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:23:28.142937 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
21:23:28.144584 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:28.145007 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:28.184538 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:28.187280 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:28.187595 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:28.571266 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.38 seconds
21:23:28.574350 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:28.574687 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr'
      and table_schema = 'stg'
  
21:23:28.615862 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:28.620388 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:28.620723 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:28.667356 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:28.668996 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:28.669243 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Languages_Incr__dbt_tmp"
    
21:23:28.824088 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.57 seconds
21:23:28.825891 [debug] [Thread-4  ]: On snapshot.Shawn.AH_KeyTable_Incr: COMMIT
21:23:28.826789 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:23:28.826994 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."#AH_KeyTable_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_KeyTable_Incr__dbt_tmp"
    end

21:23:28.880736 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:28.894589 [debug] [Thread-4  ]: finished collecting timing info
21:23:28.895025 [debug] [Thread-4  ]: On snapshot.Shawn.AH_KeyTable_Incr: Close
21:23:28.895830 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559879430>]}
21:23:28.896377 [info ] [Thread-4  ]: 39 of 101 OK snapshotted stg.AH_KeyTable_Incr................................... [[32mOK[0m in 9.77s]
21:23:28.896787 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_KeyTable_Incr
21:23:28.896973 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ListingActionproperties_Incr
21:23:28.897376 [info ] [Thread-4  ]: 42 of 101 START snapshot stg.AH_ListingActionproperties_Incr.................... [RUN]
21:23:28.897865 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr"
21:23:28.898025 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ListingActionproperties_Incr
21:23:28.898164 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ListingActionproperties_Incr
21:23:28.901220 [debug] [Thread-4  ]: finished collecting timing info
21:23:28.901443 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ListingActionproperties_Incr
21:23:28.904683 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:28.904879 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:23:28.905001 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:23:28.905133 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:23:29.007779 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:23:29.036339 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:23:29.059692 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:29.060078 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:23:29.087758 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:23:29.090318 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:29.090618 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingActionproperties_InterView]
        ) as __dbt_sbq
    
21:23:29.154760 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:23:29.178168 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:29.178563 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr"
        ) as __dbt_sbq
    
21:23:29.268049 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:23:29.271804 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:29.272094 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr'
      and table_schema = 'stg'
  
21:23:29.363294 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:23:29.366992 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:29.367286 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
        
  
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActionproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingActionproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingActionproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingActionproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:29.064562'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:29.064562'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:23:29.064562''), CONVERT(DATETIME2, ''2022-09-18 21:23:29.064562'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:23:29.064562'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:29.064562'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:29.064562'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:23:29.064562'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.ListingActionID != source_data.ListingActionID
        or
        (
            ((snapshotted_data.ListingActionID is null) and not (source_data.ListingActionID is null))
            or
            ((not snapshotted_data.ListingActionID is null) and (source_data.ListingActionID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.ListingActionID != source_data.ListingActionID
        or
        (
            ((snapshotted_data.ListingActionID is null) and not (source_data.ListingActionID is null))
            or
            ((not snapshotted_data.ListingActionID is null) and (source_data.ListingActionID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingActionproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActionproperties_Incr__dbt_tmp_temp_view"
    end



    
21:23:29.764096 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.09 seconds
21:23:29.765852 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:29.766127 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:29.809147 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:29.811851 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:29.812153 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:30.056481 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:23:30.058772 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Languages_Incr"
21:23:30.059393 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:30.059578 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Languages_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Languages_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Languages_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Languages_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Languages_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Code", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Code", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Languages_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:23:32.165232 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.11 seconds
21:23:32.166993 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Languages_Incr: COMMIT
21:23:32.168207 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:23:32.168375 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."#AH_Languages_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Languages_Incr__dbt_tmp"
    end

21:23:32.219698 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:32.233476 [debug] [Thread-2  ]: finished collecting timing info
21:23:32.233923 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Languages_Incr: Close
21:23:32.234775 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559879580>]}
21:23:32.235322 [info ] [Thread-2  ]: 40 of 101 OK snapshotted stg.AH_Languages_Incr.................................. [[32mOK[0m in 13.00s]
21:23:32.235713 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Languages_Incr
21:23:32.235895 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ListingActions_Incr
21:23:32.236282 [info ] [Thread-2  ]: 43 of 101 START snapshot stg.AH_ListingActions_Incr............................. [RUN]
21:23:32.236728 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingActions_Incr"
21:23:32.236886 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ListingActions_Incr
21:23:32.237020 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ListingActions_Incr
21:23:32.240006 [debug] [Thread-2  ]: finished collecting timing info
21:23:32.240221 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ListingActions_Incr
21:23:32.243317 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:32.243551 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:23:32.243675 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:23:32.243806 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:23:32.364326 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:23:32.393449 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:23:32.416226 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:32.416607 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:23:32.447999 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:23:32.450237 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:32.450832 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingActions_InterView]
        ) as __dbt_sbq
    
21:23:32.520394 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:32.543270 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:32.543666 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr"
        ) as __dbt_sbq
    
21:23:32.715159 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:23:32.718483 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:32.718793 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr'
      and table_schema = 'stg'
  
21:23:32.863880 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:23:32.868067 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:32.868450 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
        
  
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActions_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingActions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingActions_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingActions_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingActions_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:32.423993'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:32.423993'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:23:32.423993''), CONVERT(DATETIME2, ''2022-09-18 21:23:32.423993'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:23:32.423993'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:32.423993'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:32.423993'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:23:32.423993'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Reason != source_data.Reason
        or
        (
            ((snapshotted_data.Reason is null) and not (source_data.Reason is null))
            or
            ((not snapshotted_data.Reason is null) and (source_data.Reason is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Actiondttm != source_data.Actiondttm
        or
        (
            ((snapshotted_data.Actiondttm is null) and not (source_data.Actiondttm is null))
            or
            ((not snapshotted_data.Actiondttm is null) and (source_data.Actiondttm is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ProxyAmount != source_data.ProxyAmount
        or
        (
            ((snapshotted_data.ProxyAmount is null) and not (source_data.ProxyAmount is null))
            or
            ((not snapshotted_data.ProxyAmount is null) and (source_data.ProxyAmount is null))
        ) or snapshotted_data.Userentered != source_data.Userentered
        or
        (
            ((snapshotted_data.Userentered is null) and not (source_data.Userentered is null))
            or
            ((not snapshotted_data.Userentered is null) and (source_data.Userentered is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Reason != source_data.Reason
        or
        (
            ((snapshotted_data.Reason is null) and not (source_data.Reason is null))
            or
            ((not snapshotted_data.Reason is null) and (source_data.Reason is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Actiondttm != source_data.Actiondttm
        or
        (
            ((snapshotted_data.Actiondttm is null) and not (source_data.Actiondttm is null))
            or
            ((not snapshotted_data.Actiondttm is null) and (source_data.Actiondttm is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ProxyAmount != source_data.ProxyAmount
        or
        (
            ((snapshotted_data.ProxyAmount is null) and not (source_data.ProxyAmount is null))
            or
            ((not snapshotted_data.ProxyAmount is null) and (source_data.ProxyAmount is null))
        ) or snapshotted_data.Userentered != source_data.Userentered
        or
        (
            ((snapshotted_data.Userentered is null) and not (source_data.Userentered is null))
            or
            ((not snapshotted_data.Userentered is null) and (source_data.Userentered is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingActions_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingActions_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActions_Incr__dbt_tmp_temp_view"
    end



    
21:23:49.119508 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 19.75 seconds
21:23:49.123707 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:49.123947 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:49.162570 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:49.163992 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:49.164209 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    
21:23:49.398636 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 24.57 seconds
21:23:49.402118 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:49.402361 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:49.441343 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:49.442958 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:49.443175 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LineItems_Incr__dbt_tmp"
    
21:23:50.217977 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
21:23:50.219745 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:50.220009 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:50.300822 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:23:50.303636 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:50.303893 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:50.501527 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:23:50.504592 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:50.504816 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr'
      and table_schema = 'stg'
  
21:23:50.578742 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:50.583154 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:50.583434 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:50.636032 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:50.637588 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:50.637841 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    
21:23:50.832772 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.39 seconds
21:23:50.834470 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:50.834737 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:50.945733 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:23:50.948790 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:50.949052 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:51.173044 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:23:51.176147 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:51.176380 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr'
      and table_schema = 'stg'
  
21:23:51.252900 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:23:51.257504 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:51.257743 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:51.303262 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:51.304868 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:51.305111 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LineItems_Incr__dbt_tmp"
    
21:23:51.899610 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.26 seconds
21:23:51.901327 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:51.901559 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:51.947722 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:51.950730 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:51.950983 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:52.204503 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:23:52.207409 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:52.207644 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr'
      and table_schema = 'stg'
  
21:23:52.240385 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:23:52.245168 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:52.245464 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:52.286966 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:52.288551 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:52.288779 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    
21:23:52.554450 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 19.69 seconds
21:23:52.558025 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:52.558309 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:52.603301 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.30 seconds
21:23:52.604926 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:52.605144 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:52.605387 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:52.606344 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:52.606581 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActions_Incr__dbt_tmp"
    
21:23:52.639895 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:23:52.642799 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:52.643039 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:52.932607 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:23:52.935767 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:52.936036 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr'
      and table_schema = 'stg'
  
21:23:52.984208 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:52.989053 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:52.989317 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:53.037821 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:53.039464 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:53.039711 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LineItems_Incr__dbt_tmp"
    
21:23:53.609246 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.32 seconds
21:23:53.610850 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:53.611034 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:53.733041 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:23:53.735910 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:53.736136 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:53.857974 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.25 seconds
21:23:53.862048 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:53.862311 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:53.939823 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:23:53.942683 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:53.942935 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:53.943357 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:23:53.945201 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingActionproperties_Incr"
21:23:53.945687 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:53.945862 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingActionproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr" (
                  "ID", "BoolnativeValue", "DecimalnativeValue", "CustomFieldID", "IntnativeValue", "ListingActionID", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "BoolnativeValue", "DecimalnativeValue", "CustomFieldID", "IntnativeValue", "ListingActionID", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:23:54.434991 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.49 seconds
21:23:54.438137 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:54.438343 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr'
      and table_schema = 'stg'
  
21:23:54.503449 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:23:54.507731 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:54.508003 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:54.602049 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:23:54.603702 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:54.603956 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActions_Incr__dbt_tmp"
    
21:23:54.732608 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.69 seconds
21:23:54.734339 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:54.734578 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:54.878409 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:23:54.881526 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:54.881800 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:55.650458 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.77 seconds
21:23:55.653020 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_LineItems_Incr"
21:23:55.653468 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:55.653604 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_LineItems_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_LineItems_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_LineItems_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_LineItems_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_LineItems_Incr" (
                  "ID", "Currency", "Status", "Type", "LotNumber", "Description", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "InvoiceID", "ListingID", "Quantity", "OwnerID", "PayerID", "ReListiteration", "AuctionEventID", "TotalAmount", "PeRunitAmount", "Taxable", "IsArchived", "BuyersPremiuMapplies", "IsPayerArchived", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Currency", "Status", "Type", "LotNumber", "Description", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "InvoiceID", "ListingID", "Quantity", "OwnerID", "PayerID", "ReListiteration", "AuctionEventID", "TotalAmount", "PeRunitAmount", "Taxable", "IsArchived", "BuyersPremiuMapplies", "IsPayerArchived", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_LineItems_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:23:56.067419 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.46 seconds
21:23:56.069184 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:56.069446 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:56.137820 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:56.140511 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:56.140793 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:56.190805 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.24 seconds
21:23:56.193506 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingActionproperties_Incr: COMMIT
21:23:56.194727 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:23:56.194921 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."#AH_ListingActionproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    end

21:23:56.236332 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:56.249733 [debug] [Thread-4  ]: finished collecting timing info
21:23:56.250161 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingActionproperties_Incr: Close
21:23:56.250961 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559879970>]}
21:23:56.251489 [info ] [Thread-4  ]: 42 of 101 OK snapshotted stg.AH_ListingActionproperties_Incr.................... [[32mOK[0m in 27.35s]
21:23:56.251886 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ListingActionproperties_Incr
21:23:56.252065 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ListingCommentsMedias_Incr
21:23:56.252436 [info ] [Thread-4  ]: 44 of 101 START snapshot stg.AH_ListingCommentsMedias_Incr...................... [RUN]
21:23:56.252858 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr"
21:23:56.253013 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ListingCommentsMedias_Incr
21:23:56.253148 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ListingCommentsMedias_Incr
21:23:56.256026 [debug] [Thread-4  ]: finished collecting timing info
21:23:56.256225 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ListingCommentsMedias_Incr
21:23:56.259097 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:23:56.259279 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:23:56.259397 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:23:56.259526 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:23:56.364137 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:23:56.367059 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:56.367312 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr'
      and table_schema = 'stg'
  
21:23:56.376247 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:23:56.401862 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:23:56.406764 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:56.406976 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:23:56.407177 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:56.429408 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:23:56.429773 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:23:56.451774 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:56.453352 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:56.453613 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActions_Incr__dbt_tmp"
    
21:23:56.470853 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:56.473178 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:23:56.473483 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingCommentsMedias_InterView]
        ) as __dbt_sbq
    
21:23:56.542892 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:56.565972 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:23:56.566357 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr"
        ) as __dbt_sbq
    
21:23:56.644299 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:23:56.648390 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:23:56.648716 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr'
      and table_schema = 'stg'
  
21:23:56.696463 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 42.12 seconds
21:23:56.700190 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:23:56.700534 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:56.746639 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:23:56.750999 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:23:56.751241 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:23:56.752623 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:23:56.752840 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Invoices_Incr__dbt_tmp"
    
21:23:56.751477 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
        
  
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingCommentsMedias_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:56.439959'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:56.439959'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:23:56.439959''), CONVERT(DATETIME2, ''2022-09-18 21:23:56.439959'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:23:56.439959'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:56.439959'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:56.439959'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:23:56.439959'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.CommentID != source_data.CommentID
        or
        (
            ((snapshotted_data.CommentID is null) and not (source_data.CommentID is null))
            or
            ((not snapshotted_data.CommentID is null) and (source_data.CommentID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.CommentID != source_data.CommentID
        or
        (
            ((snapshotted_data.CommentID is null) and not (source_data.CommentID is null))
            or
            ((not snapshotted_data.CommentID is null) and (source_data.CommentID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view"
    end



    
21:23:57.359155 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.71 seconds
21:23:57.360909 [debug] [Thread-1  ]: On snapshot.Shawn.AH_LineItems_Incr: COMMIT
21:23:57.361684 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:23:57.361834 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."#AH_LineItems_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_LineItems_Incr__dbt_tmp"
    end

21:23:57.542017 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:23:57.556752 [debug] [Thread-1  ]: finished collecting timing info
21:23:57.557188 [debug] [Thread-1  ]: On snapshot.Shawn.AH_LineItems_Incr: Close
21:23:57.558000 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5585626a0>]}
21:23:57.558527 [info ] [Thread-1  ]: 41 of 101 OK snapshotted stg.AH_LineItems_Incr.................................. [[32mOK[0m in 33.29s]
21:23:57.558992 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_LineItems_Incr
21:23:57.559175 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ListingComments_Incr
21:23:57.559547 [info ] [Thread-1  ]: 45 of 101 START snapshot stg.AH_ListingComments_Incr............................ [RUN]
21:23:57.559980 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingComments_Incr"
21:23:57.560134 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ListingComments_Incr
21:23:57.560269 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ListingComments_Incr
21:23:57.563197 [debug] [Thread-1  ]: finished collecting timing info
21:23:57.563401 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ListingComments_Incr
21:23:57.566280 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:23:57.566461 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:23:57.566625 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:23:57.566772 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:23:57.698745 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:23:57.729484 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:23:57.752468 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:23:57.752842 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:23:57.931343 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:23:57.933568 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:23:57.934116 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingComments_InterView]
        ) as __dbt_sbq
    
21:23:58.002056 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:58.024370 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:23:58.024781 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr"
        ) as __dbt_sbq
    
21:23:58.239696 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:23:58.243448 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:23:58.243727 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr'
      and table_schema = 'stg'
  
21:23:58.279061 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.83 seconds
21:23:58.280778 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.53 seconds
21:23:58.282033 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:23:58.282228 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:58.282850 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:58.283063 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:23:58.315946 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:58.319757 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:23:58.320127 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
        
  
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingComments_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingComments_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingComments_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingComments_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingComments_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:57.768105'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:57.768105'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:23:57.768105''), CONVERT(DATETIME2, ''2022-09-18 21:23:57.768105'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:23:57.768105'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:23:57.768105'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:23:57.768105'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:23:57.768105'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.IsBID != source_data.IsBID
        or
        (
            ((snapshotted_data.IsBID is null) and not (source_data.IsBID is null))
            or
            ((not snapshotted_data.IsBID is null) and (source_data.IsBID is null))
        ) or snapshotted_data.Approved != source_data.Approved
        or
        (
            ((snapshotted_data.Approved is null) and not (source_data.Approved is null))
            or
            ((not snapshotted_data.Approved is null) and (source_data.Approved is null))
        ) or snapshotted_data.ParentID != source_data.ParentID
        or
        (
            ((snapshotted_data.ParentID is null) and not (source_data.ParentID is null))
            or
            ((not snapshotted_data.ParentID is null) and (source_data.ParentID is null))
        ) or snapshotted_data.ReportCount != source_data.ReportCount
        or
        (
            ((snapshotted_data.ReportCount is null) and not (source_data.ReportCount is null))
            or
            ((not snapshotted_data.ReportCount is null) and (source_data.ReportCount is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.IsBID != source_data.IsBID
        or
        (
            ((snapshotted_data.IsBID is null) and not (source_data.IsBID is null))
            or
            ((not snapshotted_data.IsBID is null) and (source_data.IsBID is null))
        ) or snapshotted_data.Approved != source_data.Approved
        or
        (
            ((snapshotted_data.Approved is null) and not (source_data.Approved is null))
            or
            ((not snapshotted_data.Approved is null) and (source_data.Approved is null))
        ) or snapshotted_data.ParentID != source_data.ParentID
        or
        (
            ((snapshotted_data.ParentID is null) and not (source_data.ParentID is null))
            or
            ((not snapshotted_data.ParentID is null) and (source_data.ParentID is null))
        ) or snapshotted_data.ReportCount != source_data.ReportCount
        or
        (
            ((snapshotted_data.ReportCount is null) and not (source_data.ReportCount is null))
            or
            ((not snapshotted_data.ReportCount is null) and (source_data.ReportCount is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingComments_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingComments_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingComments_Incr__dbt_tmp_temp_view"
    end



    
21:23:58.324707 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:23:58.327213 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:58.327451 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:58.362762 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:23:58.367225 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:23:58.367527 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:58.526641 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:23:58.529011 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingActions_Incr"
21:23:58.529548 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:23:58.529714 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingActions_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr" (
                  "ID", "Description", "LastUpdatedUser", "Reason", "Status", "CreatedOn", "UpdatedOn", "DeletedOn", "Actiondttm", "Amount", "ProxyAmount", "Userentered", "UserID", "ListingID", "Quantity", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Description", "LastUpdatedUser", "Reason", "Status", "CreatedOn", "UpdatedOn", "DeletedOn", "Actiondttm", "Amount", "ProxyAmount", "Userentered", "UserID", "ListingID", "Quantity", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingActions_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:23:58.652591 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:23:58.655591 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:23:58.655845 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr'
      and table_schema = 'stg'
  
21:23:58.733903 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:23:58.739457 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:23:58.739760 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:23:58.807548 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:23:58.809511 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:23:58.809761 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Invoices_Incr__dbt_tmp"
    
21:24:00.551789 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.02 seconds
21:24:00.553542 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingActions_Incr: COMMIT
21:24:00.554341 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:24:00.554494 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."#AH_ListingActions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingActions_Incr__dbt_tmp"
    end

21:24:00.591370 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:00.604874 [debug] [Thread-2  ]: finished collecting timing info
21:24:00.605288 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingActions_Incr: Close
21:24:00.606076 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559879ac0>]}
21:24:00.606629 [info ] [Thread-2  ]: 43 of 101 OK snapshotted stg.AH_ListingActions_Incr............................. [[32mOK[0m in 28.37s]
21:24:00.607021 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ListingActions_Incr
21:24:00.607199 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ListingEnddttmAudit_Incr
21:24:00.607572 [info ] [Thread-2  ]: 46 of 101 START snapshot stg.AH_ListingEnddttmAudit_Incr........................ [RUN]
21:24:00.607990 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr"
21:24:00.608144 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ListingEnddttmAudit_Incr
21:24:00.608296 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ListingEnddttmAudit_Incr
21:24:00.611186 [debug] [Thread-2  ]: finished collecting timing info
21:24:00.611380 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ListingEnddttmAudit_Incr
21:24:00.614241 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:00.614419 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:24:00.614558 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:24:00.614702 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:24:00.770704 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:24:00.800817 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:24:00.824216 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:00.824620 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:24:01.006035 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:24:01.008302 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:01.008867 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingEnddttmAudit_InterView]
        ) as __dbt_sbq
    
21:24:01.135159 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:24:01.158420 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:01.158832 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr"
        ) as __dbt_sbq
    
21:24:01.241984 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.43 seconds
21:24:01.243725 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:24:01.243973 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:01.248389 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:24:01.251575 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:01.251771 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr'
      and table_schema = 'stg'
  
21:24:01.329329 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:24:01.333073 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:24:01.333393 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:01.343164 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:24:01.346357 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:01.346713 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
        
  
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingEnddttmAudit_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:00.986947'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:00.986947'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:24:00.986947''), CONVERT(DATETIME2, ''2022-09-18 21:24:00.986947'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:24:00.986947'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:00.986947'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:00.986947'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:24:00.986947'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.SourceListingID != source_data.SourceListingID
        or
        (
            ((snapshotted_data.SourceListingID is null) and not (source_data.SourceListingID is null))
            or
            ((not snapshotted_data.SourceListingID is null) and (source_data.SourceListingID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Origin != source_data.Origin
        or
        (
            ((snapshotted_data.Origin is null) and not (source_data.Origin is null))
            or
            ((not snapshotted_data.Origin is null) and (source_data.Origin is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.SourceListingID != source_data.SourceListingID
        or
        (
            ((snapshotted_data.SourceListingID is null) and not (source_data.SourceListingID is null))
            or
            ((not snapshotted_data.SourceListingID is null) and (source_data.SourceListingID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Origin != source_data.Origin
        or
        (
            ((snapshotted_data.Origin is null) and not (source_data.Origin is null))
            or
            ((not snapshotted_data.Origin is null) and (source_data.Origin is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view"
    end



    
21:24:01.599134 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:24:01.602439 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:24:01.602771 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr'
      and table_schema = 'stg'
  
21:24:01.645354 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:01.653293 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:24:01.653770 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:01.696578 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:01.698219 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:24:01.698460 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Invoices_Incr__dbt_tmp"
    
21:24:03.508572 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.81 seconds
21:24:03.510286 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:24:03.510527 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:03.552261 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:03.555714 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:24:03.555942 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:03.865953 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
21:24:03.869004 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Invoices_Incr"
21:24:03.869526 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:24:03.869679 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Invoices_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Invoices_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Invoices_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Invoices_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Invoices_Incr" (
                  "ID", "Paiddttm", "CreatedOn", "UpdatedOn", "DeletedOn", "Createddttm", "Fulfilleddttm", "PropertybagID", "ShippingOptionID", "PayerID", "OwnerID", "AuctionEventID", "SalesTax", "BuyersPremiumPercent", "BuyersPremiumAmount", "ShippingAmount", "SubTotal", "Total", "IsPayerLocked", "Shipped", "IsArchived", "Status", "ShippingLastName", "BillingLastName", "OwnerName", "Shippingdetails", "OwnerCity", "OwnerStateregion", "OwnerzipPostal", "OwnerCountry", "ShippingFirstName", "BillingFirstName", "BillingCity", "BillingStateregion", "BillingzipPostal", "BillingCountry", "OwnerStreet1", "OwnerStreet2", "ShippingCity", "ShippingStateregion", "ShippingzipPostal", "ShippingCountry", "BillingStreet1", "BillingStreet2", "Comments", "LastUpdatedUser", "Currency", "Type", "ShippingStreet1", "ShippingStreet2", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Paiddttm", "CreatedOn", "UpdatedOn", "DeletedOn", "Createddttm", "Fulfilleddttm", "PropertybagID", "ShippingOptionID", "PayerID", "OwnerID", "AuctionEventID", "SalesTax", "BuyersPremiumPercent", "BuyersPremiumAmount", "ShippingAmount", "SubTotal", "Total", "IsPayerLocked", "Shipped", "IsArchived", "Status", "ShippingLastName", "BillingLastName", "OwnerName", "Shippingdetails", "OwnerCity", "OwnerStateregion", "OwnerzipPostal", "OwnerCountry", "ShippingFirstName", "BillingFirstName", "BillingCity", "BillingStateregion", "BillingzipPostal", "BillingCountry", "OwnerStreet1", "OwnerStreet2", "ShippingCity", "ShippingStateregion", "ShippingzipPostal", "ShippingCountry", "BillingStreet1", "BillingStreet2", "Comments", "LastUpdatedUser", "Currency", "Type", "ShippingStreet1", "ShippingStreet2", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Invoices_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:24:06.032618 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.16 seconds
21:24:06.034410 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Invoices_Incr: COMMIT
21:24:06.035254 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:24:06.035411 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."#AH_Invoices_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Invoices_Incr__dbt_tmp"
    end

21:24:06.083416 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:06.099069 [debug] [Thread-3  ]: finished collecting timing info
21:24:06.099490 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Invoices_Incr: Close
21:24:06.100290 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55866d730>]}
21:24:06.100817 [info ] [Thread-3  ]: 38 of 101 OK snapshotted stg.AH_Invoices_Incr................................... [[32mOK[0m in 52.04s]
21:24:06.101207 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Invoices_Incr
21:24:06.101391 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ListingLocations_Incr
21:24:06.101773 [info ] [Thread-3  ]: 47 of 101 START snapshot stg.AH_ListingLocations_Incr........................... [RUN]
21:24:06.102200 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingLocations_Incr"
21:24:06.102352 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ListingLocations_Incr
21:24:06.102485 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ListingLocations_Incr
21:24:06.105331 [debug] [Thread-3  ]: finished collecting timing info
21:24:06.105534 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ListingLocations_Incr
21:24:06.108654 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:06.108864 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:24:06.108983 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:24:06.109114 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:24:06.228834 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:24:06.268880 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:24:06.291780 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:06.292170 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:24:06.322821 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:24:06.325078 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:06.325680 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingLocations_InterView]
        ) as __dbt_sbq
    
21:24:06.412900 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:24:06.434913 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:06.435306 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr"
        ) as __dbt_sbq
    
21:24:06.499886 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:24:06.503594 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:06.503862 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr'
      and table_schema = 'stg'
  
21:24:06.637054 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:24:06.640818 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:06.641078 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
        
  
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingLocations_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingLocations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingLocations_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingLocations_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingLocations_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:06.299452'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:06.299452'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:24:06.299452''), CONVERT(DATETIME2, ''2022-09-18 21:24:06.299452'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:24:06.299452'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:06.299452'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:06.299452'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:24:06.299452'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LocationID != source_data.LocationID
        or
        (
            ((snapshotted_data.LocationID is null) and not (source_data.LocationID is null))
            or
            ((not snapshotted_data.LocationID is null) and (source_data.LocationID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LocationID != source_data.LocationID
        or
        (
            ((snapshotted_data.LocationID is null) and not (source_data.LocationID is null))
            or
            ((not snapshotted_data.LocationID is null) and (source_data.LocationID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingLocations_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingLocations_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingLocations_Incr__dbt_tmp_temp_view"
    end



    
21:24:07.110771 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 10.36 seconds
21:24:07.115052 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:24:07.115368 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:07.153624 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:07.155302 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:24:07.155563 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    
21:24:08.564792 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.41 seconds
21:24:08.566432 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:24:08.566648 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:08.630180 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.28 seconds
21:24:08.633548 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:08.633798 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:08.641966 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:24:08.644253 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:24:08.644485 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:08.675809 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:08.677483 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:08.677722 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    
21:24:08.891107 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:24:08.894282 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:24:08.894623 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr'
      and table_schema = 'stg'
  
21:24:08.969484 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:24:08.973995 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:24:08.974299 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:09.011405 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:09.013040 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:24:09.013287 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    
21:24:09.773685 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
21:24:09.775473 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:09.775724 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:09.867787 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:24:09.870393 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:09.870657 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:10.562609 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.69 seconds
21:24:10.565603 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:10.565803 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr'
      and table_schema = 'stg'
  
21:24:10.643693 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:24:10.647842 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:10.648130 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:10.692289 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:10.693928 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:10.694181 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    
21:24:10.852595 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.84 seconds
21:24:10.854388 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:24:10.854695 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:10.895072 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:10.897653 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:24:10.897932 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:11.119164 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:24:11.122374 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:24:11.122706 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr'
      and table_schema = 'stg'
  
21:24:11.172313 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:11.177074 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:24:11.177381 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:11.285359 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:24:11.287019 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:24:11.287236 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    
21:24:11.719941 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
21:24:11.721543 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:11.721728 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:11.772931 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:11.775980 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:11.776236 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:11.989859 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:24:11.992945 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:11.993209 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr'
      and table_schema = 'stg'
  
21:24:12.031528 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:12.035921 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:12.036208 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:12.080128 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:12.081694 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:12.081931 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    
21:24:12.358035 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.07 seconds
21:24:12.359669 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:24:12.359900 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:12.423741 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:24:12.426381 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:24:12.426635 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:12.563292 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 14.24 seconds
21:24:12.566617 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:24:12.566857 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:12.629945 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:24:12.631642 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:24:12.631863 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingComments_Incr__dbt_tmp"
    
21:24:12.679290 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:24:12.681484 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingCommentsMedias_Incr"
21:24:12.682035 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:24:12.682214 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr" (
                  "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "MediaID", "CommentID", "DisplayOrder", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "MediaID", "CommentID", "DisplayOrder", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:24:13.130877 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
21:24:13.132590 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:13.132835 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:13.149858 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.51 seconds
21:24:13.155541 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:13.155851 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:13.185090 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:13.187940 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:13.188195 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:13.194929 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:13.196208 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:13.196400 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingLocations_Incr__dbt_tmp"
    
21:24:13.435656 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:24:13.437842 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingEnddttmAudit_Incr"
21:24:13.438290 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:13.438430 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr" (
                  "ID", "SqlDaTestamp", "Enddttm", "SourceListingID", "ListingID", "Origin", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SqlDaTestamp", "Enddttm", "SourceListingID", "ListingID", "Origin", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:24:13.842031 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.21 seconds
21:24:13.843748 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:24:13.843994 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:13.930897 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:24:13.933660 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:24:13.933906 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:14.171954 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:24:14.175269 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:24:14.175517 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr'
      and table_schema = 'stg'
  
21:24:14.259934 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:24:14.264329 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:24:14.264585 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:14.295830 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
21:24:14.297333 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:14.297552 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:14.301295 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:14.301488 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.62 seconds
21:24:14.303373 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: COMMIT
21:24:14.304141 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:24:14.304326 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    end

21:24:14.304841 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:24:14.305020 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingComments_Incr__dbt_tmp"
    
21:24:14.364394 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:24:14.372665 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:24:14.374721 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:14.374906 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:14.380212 [debug] [Thread-4  ]: finished collecting timing info
21:24:14.380429 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: Close
21:24:14.381060 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559879d60>]}
21:24:14.381500 [info ] [Thread-4  ]: 44 of 101 OK snapshotted stg.AH_ListingCommentsMedias_Incr...................... [[32mOK[0m in 18.13s]
21:24:14.381860 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ListingCommentsMedias_Incr
21:24:14.382037 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ListingMedias_Incr
21:24:14.382393 [info ] [Thread-4  ]: 48 of 101 START snapshot stg.AH_ListingMedias_Incr.............................. [RUN]
21:24:14.382986 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingMedias_Incr"
21:24:14.383148 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ListingMedias_Incr
21:24:14.383283 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ListingMedias_Incr
21:24:14.385935 [debug] [Thread-4  ]: finished collecting timing info
21:24:14.386122 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ListingMedias_Incr
21:24:14.388909 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:14.389085 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:24:14.389203 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:24:14.389326 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:24:14.667102 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:24:14.676106 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:24:14.679018 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:14.679304 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr'
      and table_schema = 'stg'
  
21:24:14.694973 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
21:24:14.718052 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:14.718425 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:24:14.721078 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:14.724637 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:14.724821 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:14.746640 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:24:14.748764 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:14.749010 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingMedias_InterView]
        ) as __dbt_sbq
    
21:24:14.761030 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:14.762374 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:14.762616 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingLocations_Incr__dbt_tmp"
    
21:24:14.803181 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:14.825153 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:14.825523 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr"
        ) as __dbt_sbq
    
21:24:14.909620 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:24:14.913542 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:14.913800 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr'
      and table_schema = 'stg'
  
21:24:14.995022 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.56 seconds
21:24:14.996778 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: COMMIT
21:24:14.997621 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:24:14.997816 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    end

21:24:15.002431 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:24:15.005412 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:15.005593 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
        
  
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingMedias_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingMedias_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingMedias_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingMedias_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:14.721441'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:14.721441'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:24:14.721441''), CONVERT(DATETIME2, ''2022-09-18 21:24:14.721441'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:24:14.721441'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:14.721441'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:14.721441'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:24:14.721441'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingMedias_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingMedias_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingMedias_Incr__dbt_tmp_temp_view"
    end



    
21:24:15.042180 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:15.129045 [debug] [Thread-2  ]: finished collecting timing info
21:24:15.129440 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: Close
21:24:15.130181 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559879eb0>]}
21:24:15.130716 [info ] [Thread-2  ]: 46 of 101 OK snapshotted stg.AH_ListingEnddttmAudit_Incr........................ [[32mOK[0m in 14.52s]
21:24:15.131103 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ListingEnddttmAudit_Incr
21:24:15.131279 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ListingPaymentCharge_Incr
21:24:15.131640 [info ] [Thread-2  ]: 49 of 101 START snapshot stg.AH_ListingPaymentCharge_Incr....................... [RUN]
21:24:15.132047 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr"
21:24:15.132198 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ListingPaymentCharge_Incr
21:24:15.132330 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ListingPaymentCharge_Incr
21:24:15.135146 [debug] [Thread-2  ]: finished collecting timing info
21:24:15.135402 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ListingPaymentCharge_Incr
21:24:15.137911 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:15.138088 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:24:15.138222 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:24:15.138352 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:24:15.226213 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.92 seconds
21:24:15.228112 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:24:15.228353 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:15.247757 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:24:15.263327 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:24:15.265644 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:24:15.265862 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:15.274059 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:24:15.295618 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:15.295826 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:24:15.325941 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:24:15.328412 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:15.328655 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingPaymentCharge_InterView]
        ) as __dbt_sbq
    
21:24:15.402781 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:24:15.425206 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:15.425539 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr"
        ) as __dbt_sbq
    
21:24:15.531125 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:24:15.534929 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:15.535178 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr'
      and table_schema = 'stg'
  
21:24:15.606850 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:24:15.610456 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:15.610741 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
        
  
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingPaymentCharge_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:15.299582'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:15.299582'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:24:15.299582''), CONVERT(DATETIME2, ''2022-09-18 21:24:15.299582'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:24:15.299582'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:15.299582'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:15.299582'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:24:15.299582'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.ChargeAmount != source_data.ChargeAmount
        or
        (
            ((snapshotted_data.ChargeAmount is null) and not (source_data.ChargeAmount is null))
            or
            ((not snapshotted_data.ChargeAmount is null) and (source_data.ChargeAmount is null))
        ) or snapshotted_data.TotalBID != source_data.TotalBID
        or
        (
            ((snapshotted_data.TotalBID is null) and not (source_data.TotalBID is null))
            or
            ((not snapshotted_data.TotalBID is null) and (source_data.TotalBID is null))
        ) or snapshotted_data.BidHoldPercentage != source_data.BidHoldPercentage
        or
        (
            ((snapshotted_data.BidHoldPercentage is null) and not (source_data.BidHoldPercentage is null))
            or
            ((not snapshotted_data.BidHoldPercentage is null) and (source_data.BidHoldPercentage is null))
        ) or snapshotted_data.MaximumBidCharge != source_data.MaximumBidCharge
        or
        (
            ((snapshotted_data.MaximumBidCharge is null) and not (source_data.MaximumBidCharge is null))
            or
            ((not snapshotted_data.MaximumBidCharge is null) and (source_data.MaximumBidCharge is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.ChargeAmount != source_data.ChargeAmount
        or
        (
            ((snapshotted_data.ChargeAmount is null) and not (source_data.ChargeAmount is null))
            or
            ((not snapshotted_data.ChargeAmount is null) and (source_data.ChargeAmount is null))
        ) or snapshotted_data.TotalBID != source_data.TotalBID
        or
        (
            ((snapshotted_data.TotalBID is null) and not (source_data.TotalBID is null))
            or
            ((not snapshotted_data.TotalBID is null) and (source_data.TotalBID is null))
        ) or snapshotted_data.BidHoldPercentage != source_data.BidHoldPercentage
        or
        (
            ((snapshotted_data.BidHoldPercentage is null) and not (source_data.BidHoldPercentage is null))
            or
            ((not snapshotted_data.BidHoldPercentage is null) and (source_data.BidHoldPercentage is null))
        ) or snapshotted_data.MaximumBidCharge != source_data.MaximumBidCharge
        or
        (
            ((snapshotted_data.MaximumBidCharge is null) and not (source_data.MaximumBidCharge is null))
            or
            ((not snapshotted_data.MaximumBidCharge is null) and (source_data.MaximumBidCharge is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view"
    end



    
21:24:15.636136 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.37 seconds
21:24:15.639290 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:24:15.639522 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr'
      and table_schema = 'stg'
  
21:24:15.672570 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:24:15.677854 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:24:15.678092 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:15.714445 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:15.715862 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:24:15.716083 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingComments_Incr__dbt_tmp"
    
21:24:16.145754 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
21:24:16.147518 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:16.147758 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:16.460457 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
21:24:16.463001 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:16.463191 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:16.652930 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:24:16.656162 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:16.656411 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr'
      and table_schema = 'stg'
  
21:24:16.703739 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:16.708247 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:16.708562 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:16.752179 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:16.753728 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:16.753972 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingLocations_Incr__dbt_tmp"
    
21:24:16.982239 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.27 seconds
21:24:16.983945 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:24:16.984189 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:17.036881 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:17.039638 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:24:17.039958 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:17.578840 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.54 seconds
21:24:17.581129 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingComments_Incr"
21:24:17.581567 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:24:17.581690 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingComments_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr" (
                  "ID", "IsBID", "Approved", "ParentID", "ReportCount", "UserID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "UserName", "Comment", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "IsBID", "Approved", "ParentID", "ReportCount", "UserID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "UserName", "Comment", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingComments_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:24:18.028126 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.27 seconds
21:24:18.029821 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:18.030053 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:18.065298 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:18.068217 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:18.068478 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:18.604606 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.54 seconds
21:24:18.606775 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingLocations_Incr"
21:24:18.607226 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:18.607364 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingLocations_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr" (
                  "ID", "LocationID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "LocationID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingLocations_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:24:20.214486 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.63 seconds
21:24:20.216249 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingComments_Incr: COMMIT
21:24:20.217026 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:24:20.217168 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."#AH_ListingComments_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingComments_Incr__dbt_tmp"
    end

21:24:20.267636 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:20.282669 [debug] [Thread-1  ]: finished collecting timing info
21:24:20.283082 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingComments_Incr: Close
21:24:20.283860 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559879c10>]}
21:24:20.284391 [info ] [Thread-1  ]: 45 of 101 OK snapshotted stg.AH_ListingComments_Incr............................ [[32mOK[0m in 22.72s]
21:24:20.284795 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ListingComments_Incr
21:24:20.284978 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ListingQuestions_Incr
21:24:20.285364 [info ] [Thread-1  ]: 50 of 101 START snapshot stg.AH_ListingQuestions_Incr........................... [RUN]
21:24:20.285774 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr"
21:24:20.285925 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ListingQuestions_Incr
21:24:20.286057 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ListingQuestions_Incr
21:24:20.288964 [debug] [Thread-1  ]: finished collecting timing info
21:24:20.289164 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ListingQuestions_Incr
21:24:20.291969 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:20.292148 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:24:20.292268 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:24:20.292399 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:24:20.405964 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:24:20.434895 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:24:20.458525 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:20.458913 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:24:20.485543 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:24:20.487732 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:20.488257 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingQuestions_InterView]
        ) as __dbt_sbq
    
21:24:20.570623 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:24:20.593463 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:20.593814 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr"
        ) as __dbt_sbq
    
21:24:20.641613 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.03 seconds
21:24:20.643472 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingLocations_Incr: COMMIT
21:24:20.644351 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:24:20.644549 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."#AH_ListingLocations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingLocations_Incr__dbt_tmp"
    end

21:24:20.685826 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:20.699111 [debug] [Thread-3  ]: finished collecting timing info
21:24:20.699495 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingLocations_Incr: Close
21:24:20.700250 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559879820>]}
21:24:20.700758 [info ] [Thread-3  ]: 47 of 101 OK snapshotted stg.AH_ListingLocations_Incr........................... [[32mOK[0m in 14.60s]
21:24:20.701148 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ListingLocations_Incr
21:24:20.701330 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr
21:24:20.701708 [info ] [Thread-3  ]: 51 of 101 START snapshot stg.AH_ListingTypeFeeprovIDErs_Incr.................... [RUN]
21:24:20.702128 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr"
21:24:20.702277 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr
21:24:20.702410 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr
21:24:20.705272 [debug] [Thread-3  ]: finished collecting timing info
21:24:20.705478 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr
21:24:20.708344 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:20.708546 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:24:20.708667 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:24:20.708799 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:24:21.087858 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.49 seconds
21:24:21.091700 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:21.091984 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr'
      and table_schema = 'stg'
  
21:24:21.094099 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:24:21.193940 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.49 seconds
21:24:21.217288 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:21.217665 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:24:21.231562 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:24:21.235272 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:21.235533 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
        
  
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingQuestions_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingQuestions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingQuestions_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingQuestions_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:20.471530'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:20.471530'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:24:20.471530''), CONVERT(DATETIME2, ''2022-09-18 21:24:20.471530'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:24:20.471530'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:20.471530'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:20.471530'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:24:20.471530'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Question != source_data.Question
        or
        (
            ((snapshotted_data.Question is null) and not (source_data.Question is null))
            or
            ((not snapshotted_data.Question is null) and (source_data.Question is null))
        ) or snapshotted_data.Answer != source_data.Answer
        or
        (
            ((snapshotted_data.Answer is null) and not (source_data.Answer is null))
            or
            ((not snapshotted_data.Answer is null) and (source_data.Answer is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Question != source_data.Question
        or
        (
            ((snapshotted_data.Question is null) and not (source_data.Question is null))
            or
            ((not snapshotted_data.Question is null) and (source_data.Question is null))
        ) or snapshotted_data.Answer != source_data.Answer
        or
        (
            ((snapshotted_data.Answer is null) and not (source_data.Answer is null))
            or
            ((not snapshotted_data.Answer is null) and (source_data.Answer is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingQuestions_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingQuestions_Incr__dbt_tmp_temp_view"
    end



    
21:24:21.250141 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:24:21.251977 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:21.252181 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingTypeFeeprovIDErs_InterView]
        ) as __dbt_sbq
    
21:24:21.360866 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:24:21.383019 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:21.383345 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr"
        ) as __dbt_sbq
    
21:24:21.447944 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:24:21.451918 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:21.452221 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr'
      and table_schema = 'stg'
  
21:24:21.524060 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:24:21.527819 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:21.528094 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
        
  
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingTypeFeeprovIDErs_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:21.221542'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:21.221542'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:24:21.221542''), CONVERT(DATETIME2, ''2022-09-18 21:24:21.221542'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:24:21.221542'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:21.221542'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:21.221542'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:24:21.221542'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ProvIDErName != source_data.ProvIDErName
        or
        (
            ((snapshotted_data.ProvIDErName is null) and not (source_data.ProvIDErName is null))
            or
            ((not snapshotted_data.ProvIDErName is null) and (source_data.ProvIDErName is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ProvIDErName != source_data.ProvIDErName
        or
        (
            ((snapshotted_data.ProvIDErName is null) and not (source_data.ProvIDErName is null))
            or
            ((not snapshotted_data.ProvIDErName is null) and (source_data.ProvIDErName is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view"
    end



    
21:24:27.310520 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 11.70 seconds
21:24:27.314194 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:27.314526 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:27.475427 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:24:27.476977 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:27.477163 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    
21:24:28.662507 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 7.13 seconds
21:24:28.666009 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:28.666250 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:28.710942 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:28.712559 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:28.712781 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    
21:24:28.895885 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.42 seconds
21:24:28.897596 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:28.897845 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:28.983824 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:24:28.986607 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:28.986906 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:29.257995 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:24:29.262325 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:29.262675 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr'
      and table_schema = 'stg'
  
21:24:29.308068 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:29.312553 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:29.312901 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:29.354950 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:29.356731 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:29.356986 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    
21:24:29.907309 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 14.90 seconds
21:24:29.910891 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:29.911205 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:29.942746 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.23 seconds
21:24:29.944464 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:29.944717 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:29.957482 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:29.959125 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:29.959362 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingMedias_Incr__dbt_tmp"
    
21:24:30.028948 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:24:30.031706 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:30.032014 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:30.392254 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.04 seconds
21:24:30.394357 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:30.394668 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:30.432046 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:30.434875 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:30.435179 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:30.787938 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.76 seconds
21:24:30.791309 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:30.791613 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr'
      and table_schema = 'stg'
  
21:24:30.831982 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:30.836318 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:30.836659 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:30.856797 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.42 seconds
21:24:30.859792 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:30.860083 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr'
      and table_schema = 'stg'
  
21:24:30.876564 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:30.878322 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:30.878642 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    
21:24:30.893860 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:24:30.898150 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:30.898501 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:30.957644 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:24:30.959289 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:30.959529 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    
21:24:31.710574 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.75 seconds
21:24:31.712231 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:31.712430 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:31.761372 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 10.53 seconds
21:24:31.765049 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:31.765408 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:31.783733 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:24:31.786569 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:31.786872 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:31.807156 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:31.808824 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:31.809079 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    
21:24:32.007334 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:24:32.010593 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:32.011084 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr'
      and table_schema = 'stg'
  
21:24:32.050355 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:32.054679 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:32.055022 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:32.060695 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
21:24:32.062253 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:32.062495 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:32.091245 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:32.092977 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:32.093302 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingMedias_Incr__dbt_tmp"
    
21:24:32.095379 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:24:32.097581 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:32.097785 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:32.154046 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.28 seconds
21:24:32.156128 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:32.156393 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:32.196340 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:32.199102 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:32.199453 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:32.332001 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:24:32.334342 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingPaymentCharge_Incr"
21:24:32.334989 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:32.335181 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr" (
                  "ID", "BuyerID", "ListingID", "UpdatedOn", "CreatedOn", "TransactionID", "ChargeAmount", "TotalBID", "BidHoldPercentage", "MaximumBidCharge", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "BuyerID", "ListingID", "UpdatedOn", "CreatedOn", "TransactionID", "ChargeAmount", "TotalBID", "BidHoldPercentage", "MaximumBidCharge", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:24:32.433078 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:24:32.436099 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:32.436412 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr'
      and table_schema = 'stg'
  
21:24:32.475866 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:32.483181 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:32.483569 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:32.522666 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:32.524633 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:32.524933 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    
21:24:32.866935 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
21:24:32.868676 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:32.868950 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:32.941051 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:24:32.943616 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:32.943898 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:33.057006 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
21:24:33.058840 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:33.059121 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:33.103897 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:33.106679 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:33.107016 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:33.150311 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:24:33.153703 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:33.154065 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr'
      and table_schema = 'stg'
  
21:24:33.192320 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:33.196853 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:33.197208 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:33.248635 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:33.250696 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:33.251027 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    
21:24:33.336819 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:24:33.340025 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:33.340325 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr'
      and table_schema = 'stg'
  
21:24:33.380012 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:33.384395 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:33.384735 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:33.430252 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:33.431916 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:33.432162 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingMedias_Incr__dbt_tmp"
    
21:24:33.797669 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.46 seconds
21:24:33.799450 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: COMMIT
21:24:33.800241 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:24:33.800390 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    end

21:24:33.868448 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:24:33.882874 [debug] [Thread-2  ]: finished collecting timing info
21:24:33.883125 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.36 seconds
21:24:33.884641 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:33.884871 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:33.883405 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: Close
21:24:33.885696 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5598602e0>]}
21:24:33.886174 [info ] [Thread-2  ]: 49 of 101 OK snapshotted stg.AH_ListingPaymentCharge_Incr....................... [[32mOK[0m in 18.75s]
21:24:33.886593 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ListingPaymentCharge_Incr
21:24:33.886792 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ListingTypeMedia_Incr
21:24:33.887171 [info ] [Thread-2  ]: 52 of 101 START snapshot stg.AH_ListingTypeMedia_Incr........................... [RUN]
21:24:33.887580 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr"
21:24:33.887729 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ListingTypeMedia_Incr
21:24:33.887861 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ListingTypeMedia_Incr
21:24:33.890862 [debug] [Thread-2  ]: finished collecting timing info
21:24:33.891118 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ListingTypeMedia_Incr
21:24:33.893748 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:33.893924 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:24:33.894038 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:24:33.894164 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:24:33.939529 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:33.942178 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:33.942442 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:34.049317 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:24:34.086109 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:24:34.109283 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:34.109681 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:24:34.146175 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:34.148525 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:34.148829 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingTypeMedia_InterView]
        ) as __dbt_sbq
    
21:24:34.200143 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:24:34.202662 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr"
21:24:34.203203 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:34.203368 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr" (
                  "ID", "ProvIDErName", "CreatedOn", "UpdatedOn", "DeletedOn", "ListingTypeID", "Enabled", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "ProvIDErName", "CreatedOn", "UpdatedOn", "DeletedOn", "ListingTypeID", "Enabled", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:24:34.205446 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:24:34.227017 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:34.227403 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr"
        ) as __dbt_sbq
    
21:24:34.274431 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:34.278435 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:34.278760 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr'
      and table_schema = 'stg'
  
21:24:34.323832 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.07 seconds
21:24:34.325558 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:34.325804 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:34.353353 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:24:34.356930 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:34.357186 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
        
  
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingTypeMedia_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingTypeMedia_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:34.127989'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:34.127989'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:24:34.127989''), CONVERT(DATETIME2, ''2022-09-18 21:24:34.127989'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:24:34.127989'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:34.127989'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:34.127989'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:24:34.127989'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaassetName != source_data.MediaassetName
        or
        (
            ((snapshotted_data.MediaassetName is null) and not (source_data.MediaassetName is null))
            or
            ((not snapshotted_data.MediaassetName is null) and (source_data.MediaassetName is null))
        ) or snapshotted_data.Scope != source_data.Scope
        or
        (
            ((snapshotted_data.Scope is null) and not (source_data.Scope is null))
            or
            ((not snapshotted_data.Scope is null) and (source_data.Scope is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaassetName != source_data.MediaassetName
        or
        (
            ((snapshotted_data.MediaassetName is null) and not (source_data.MediaassetName is null))
            or
            ((not snapshotted_data.MediaassetName is null) and (source_data.MediaassetName is null))
        ) or snapshotted_data.Scope != source_data.Scope
        or
        (
            ((snapshotted_data.Scope is null) and not (source_data.Scope is null))
            or
            ((not snapshotted_data.Scope is null) and (source_data.Scope is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingTypeMedia_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_temp_view"
    end



    
21:24:34.358021 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:24:34.360247 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:34.360431 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:34.445970 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.01 seconds
21:24:34.447731 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:34.447981 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:34.490957 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:34.493631 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:34.493948 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:34.589211 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:24:34.592460 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:34.592757 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr'
      and table_schema = 'stg'
  
21:24:34.629293 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:34.633595 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:34.633912 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:34.670203 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:34.671912 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:34.672187 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    
21:24:34.716425 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:24:34.718715 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingMedias_Incr"
21:24:34.719287 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:34.719467 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingMedias_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaID", "ListingID", "DisplayOrder", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaID", "ListingID", "DisplayOrder", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingMedias_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:24:35.820197 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.62 seconds
21:24:35.821937 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: COMMIT
21:24:35.822870 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:24:35.823083 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    end

21:24:36.088205 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:24:36.106919 [debug] [Thread-3  ]: finished collecting timing info
21:24:36.107188 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.43 seconds
21:24:36.110280 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:36.110708 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:36.107474 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: Close
21:24:36.111628 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559860430>]}
21:24:36.112152 [info ] [Thread-3  ]: 51 of 101 OK snapshotted stg.AH_ListingTypeFeeprovIDErs_Incr.................... [[32mOK[0m in 15.41s]
21:24:36.112542 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr
21:24:36.112732 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ListingTypeproperties_Incr
21:24:36.113125 [info ] [Thread-3  ]: 53 of 101 START snapshot stg.AH_ListingTypeproperties_Incr...................... [RUN]
21:24:36.113575 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr"
21:24:36.113732 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ListingTypeproperties_Incr
21:24:36.113867 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ListingTypeproperties_Incr
21:24:36.120979 [debug] [Thread-3  ]: finished collecting timing info
21:24:36.122347 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ListingTypeproperties_Incr
21:24:36.125594 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:36.125788 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:24:36.125908 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:24:36.126039 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:24:36.157101 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:36.159686 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:36.160058 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:36.226816 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:24:36.263877 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:24:36.288166 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:36.288546 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:24:36.327259 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:36.329516 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:36.329777 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingTypeproperties_InterView]
        ) as __dbt_sbq
    
21:24:36.402805 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:24:36.413212 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:24:36.415296 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingQuestions_Incr"
21:24:36.415849 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:36.416019 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingQuestions_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr" (
                  "ID", "UserID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "UserName", "Question", "Answer", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UserID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "UserName", "Question", "Answer", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingQuestions_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:24:36.428972 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:36.429291 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr"
        ) as __dbt_sbq
    
21:24:36.440475 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.72 seconds
21:24:36.442135 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingMedias_Incr: COMMIT
21:24:36.442952 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:24:36.443130 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."#AH_ListingMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingMedias_Incr__dbt_tmp"
    end

21:24:36.485497 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:36.496725 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:24:36.500051 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:36.503339 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr'
      and table_schema = 'stg'
  
21:24:36.503183 [debug] [Thread-4  ]: finished collecting timing info
21:24:36.503728 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingMedias_Incr: Close
21:24:36.504404 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559860040>]}
21:24:36.504860 [info ] [Thread-4  ]: 48 of 101 OK snapshotted stg.AH_ListingMedias_Incr.............................. [[32mOK[0m in 22.12s]
21:24:36.505243 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ListingMedias_Incr
21:24:36.505426 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ListingTypes_Incr
21:24:36.505787 [info ] [Thread-4  ]: 54 of 101 START snapshot stg.AH_ListingTypes_Incr............................... [RUN]
21:24:36.506193 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingTypes_Incr"
21:24:36.506346 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ListingTypes_Incr
21:24:36.506482 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ListingTypes_Incr
21:24:36.509224 [debug] [Thread-4  ]: finished collecting timing info
21:24:36.509420 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ListingTypes_Incr
21:24:36.512256 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:36.512437 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:24:36.512556 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:24:36.512686 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:24:36.576823 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:24:36.580306 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:36.580728 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
        
  
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingTypeproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingTypeproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:36.299897'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:36.299897'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:24:36.299897''), CONVERT(DATETIME2, ''2022-09-18 21:24:36.299897'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:24:36.299897'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:36.299897'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:36.299897'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:24:36.299897'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Scope != source_data.Scope
        or
        (
            ((snapshotted_data.Scope is null) and not (source_data.Scope is null))
            or
            ((not snapshotted_data.Scope is null) and (source_data.Scope is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Scope != source_data.Scope
        or
        (
            ((snapshotted_data.Scope is null) and not (source_data.Scope is null))
            or
            ((not snapshotted_data.Scope is null) and (source_data.Scope is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingTypeproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_temp_view"
    end



    
21:24:36.609242 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:24:36.675922 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:24:36.699485 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:36.699884 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:24:36.731627 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:24:36.733883 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:36.734149 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingTypes_InterView]
        ) as __dbt_sbq
    
21:24:36.789321 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:36.812237 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:36.812615 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr"
        ) as __dbt_sbq
    
21:24:36.891408 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:24:36.895429 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:36.895783 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr'
      and table_schema = 'stg'
  
21:24:36.970895 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:24:36.974516 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:36.974942 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
        
  
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypes_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypes_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingTypes_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingTypes_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:36.706152'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:36.706152'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:24:36.706152''), CONVERT(DATETIME2, ''2022-09-18 21:24:36.706152'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:24:36.706152'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:36.706152'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:36.706152'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:24:36.706152'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingTypes_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingTypes_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypes_Incr__dbt_tmp_temp_view"
    end



    
21:24:37.740073 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.32 seconds
21:24:37.742316 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingQuestions_Incr: COMMIT
21:24:37.743469 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:24:37.743631 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."#AH_ListingQuestions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    end

21:24:37.782775 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:37.796053 [debug] [Thread-1  ]: finished collecting timing info
21:24:37.796480 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingQuestions_Incr: Close
21:24:37.797272 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559860190>]}
21:24:37.797791 [info ] [Thread-1  ]: 50 of 101 OK snapshotted stg.AH_ListingQuestions_Incr........................... [[32mOK[0m in 17.51s]
21:24:37.798176 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ListingQuestions_Incr
21:24:37.798359 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Listingdecorations_Incr
21:24:37.798774 [info ] [Thread-1  ]: 55 of 101 START snapshot stg.AH_Listingdecorations_Incr......................... [RUN]
21:24:37.799193 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr"
21:24:37.799349 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Listingdecorations_Incr
21:24:37.799486 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Listingdecorations_Incr
21:24:37.802430 [debug] [Thread-1  ]: finished collecting timing info
21:24:37.802656 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Listingdecorations_Incr
21:24:37.805441 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:37.805627 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:24:37.805750 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:24:37.805882 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:24:37.923061 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:24:37.954756 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:24:37.977549 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:37.977946 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:24:38.013592 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:38.016242 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:38.016517 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Listingdecorations_InterView]
        ) as __dbt_sbq
    
21:24:38.080289 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:24:38.102516 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:38.102924 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr"
        ) as __dbt_sbq
    
21:24:38.150785 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:38.154271 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:38.154621 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr'
      and table_schema = 'stg'
  
21:24:38.231452 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:24:38.235209 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:38.235494 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
        
  
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listingdecorations_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Listingdecorations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Listingdecorations_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Listingdecorations_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:37.987424'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:37.987424'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:24:37.987424''), CONVERT(DATETIME2, ''2022-09-18 21:24:37.987424'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:24:37.987424'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:37.987424'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:37.987424'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:24:37.987424'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DecorationID != source_data.DecorationID
        or
        (
            ((snapshotted_data.DecorationID is null) and not (source_data.DecorationID is null))
            or
            ((not snapshotted_data.DecorationID is null) and (source_data.DecorationID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DecorationID != source_data.DecorationID
        or
        (
            ((snapshotted_data.DecorationID is null) and not (source_data.DecorationID is null))
            or
            ((not snapshotted_data.DecorationID is null) and (source_data.DecorationID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Listingdecorations_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listingdecorations_Incr__dbt_tmp_temp_view"
    end



    
21:24:40.447433 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.09 seconds
21:24:40.451158 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:40.451449 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:40.498264 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:40.500007 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:40.500291 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    
21:24:41.576297 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.08 seconds
21:24:41.577930 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:41.578116 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:41.656693 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:24:41.659250 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:41.659420 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:41.922327 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:24:41.925545 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:41.925840 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr'
      and table_schema = 'stg'
  
21:24:41.963366 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:41.967754 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:41.968095 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:42.006404 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:42.008148 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:42.008485 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    
21:24:42.736143 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 5.76 seconds
21:24:42.740804 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:42.741561 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:42.804376 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:24:42.805893 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:42.806103 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypes_Incr__dbt_tmp"
    
21:24:43.202708 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.19 seconds
21:24:43.204482 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:43.204768 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:43.275857 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:24:43.278591 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:43.278857 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:43.576009 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:24:43.579221 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:43.579432 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr'
      and table_schema = 'stg'
  
21:24:43.630861 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:43.636054 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:43.636345 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:43.674381 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:43.676024 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:43.676279 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    
21:24:43.949541 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.14 seconds
21:24:43.951306 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:43.951560 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:44.035841 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:24:44.038473 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:44.038755 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:44.180733 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.95 seconds
21:24:44.184450 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:44.184724 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:44.234300 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:44.235951 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:44.236187 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    
21:24:44.282211 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:24:44.285385 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:44.285664 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr'
      and table_schema = 'stg'
  
21:24:44.320253 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:24:44.324294 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:44.324546 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:44.367718 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:44.369364 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:44.369620 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypes_Incr__dbt_tmp"
    
21:24:44.584046 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.91 seconds
21:24:44.585793 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:44.586098 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:44.638016 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:44.641093 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:44.641327 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:44.932511 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:24:44.934797 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingTypeMedia_Incr"
21:24:44.935365 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:44.935548 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingTypeMedia_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr" (
                  "ID", "Enabled", "ListingTypeID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaassetName", "Scope", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Enabled", "ListingTypeID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaassetName", "Scope", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:24:45.495085 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.26 seconds
21:24:45.496718 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:45.496901 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:45.562799 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.19 seconds
21:24:45.564443 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:45.564679 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:45.592790 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:24:45.595457 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:45.595728 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:45.606146 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:45.608540 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:45.608831 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:45.858864 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:24:45.862115 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:45.862401 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr'
      and table_schema = 'stg'
  
21:24:45.902773 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:45.907192 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:45.907502 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:46.173686 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.58 seconds
21:24:46.176805 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:46.177212 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr'
      and table_schema = 'stg'
  
21:24:46.177097 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:24:46.178342 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:46.178515 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypes_Incr__dbt_tmp"
    
21:24:46.221853 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:46.226315 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:46.226648 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:46.277476 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:46.279553 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:46.279819 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    
21:24:46.362724 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.43 seconds
21:24:46.364548 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingTypeMedia_Incr: COMMIT
21:24:46.365402 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:24:46.365595 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    end

21:24:46.416280 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:46.430964 [debug] [Thread-2  ]: finished collecting timing info
21:24:46.431403 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingTypeMedia_Incr: Close
21:24:46.432174 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5598606d0>]}
21:24:46.432684 [info ] [Thread-2  ]: 52 of 101 OK snapshotted stg.AH_ListingTypeMedia_Incr........................... [[32mOK[0m in 12.54s]
21:24:46.433067 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ListingTypeMedia_Incr
21:24:46.433246 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Listingproperties_Incr
21:24:46.433611 [info ] [Thread-2  ]: 56 of 101 START snapshot stg.AH_Listingproperties_Incr.......................... [RUN]
21:24:46.434026 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Listingproperties_Incr"
21:24:46.434176 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Listingproperties_Incr
21:24:46.434309 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Listingproperties_Incr
21:24:46.437138 [debug] [Thread-2  ]: finished collecting timing info
21:24:46.437400 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Listingproperties_Incr
21:24:46.440468 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:24:46.440651 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:24:46.440769 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:24:46.440897 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:24:46.580655 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:24:46.610474 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:24:46.633530 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:24:46.633917 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:24:46.663493 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:24:46.665715 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:24:46.666521 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Listingproperties_InterView]
        ) as __dbt_sbq
    
21:24:46.736257 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:24:46.758347 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:24:46.758753 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr"
        ) as __dbt_sbq
    
21:24:46.860679 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:24:46.864264 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:24:46.864547 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr'
      and table_schema = 'stg'
  
21:24:46.934573 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:24:46.938596 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:24:46.938924 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
        
  
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listingproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Listingproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listingproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Listingproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Listingproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:46.643804'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:46.643804'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:24:46.643804''), CONVERT(DATETIME2, ''2022-09-18 21:24:46.643804'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:24:46.643804'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:46.643804'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:46.643804'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:24:46.643804'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Listingproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Listingproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listingproperties_Incr__dbt_tmp_temp_view"
    end



    
21:24:47.129365 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 10.55 seconds
21:24:47.133060 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:47.133339 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:47.175178 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:47.176858 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:47.177130 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    
21:24:47.489840 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.31 seconds
21:24:47.491671 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:47.491919 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:47.511375 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.23 seconds
21:24:47.513049 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:47.513283 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:47.525300 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:24:47.527594 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:47.527808 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:47.552768 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:47.555418 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:47.555669 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:47.716694 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:24:47.719319 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingTypes_Incr"
21:24:47.719863 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:47.720032 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingTypes_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingTypes_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:24:47.757159 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:24:47.761221 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:47.761514 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr'
      and table_schema = 'stg'
  
21:24:47.816141 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:47.820690 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:47.820975 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:47.860571 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:47.862202 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:47.862445 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    
21:24:48.685747 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.51 seconds
21:24:48.687427 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:48.687610 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:48.804748 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:24:48.807864 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:48.808090 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:49.065656 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:24:49.068753 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:49.069000 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr'
      and table_schema = 'stg'
  
21:24:49.193150 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.33 seconds
21:24:49.195181 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:49.195425 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:49.235920 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:49.238617 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:49.238881 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:49.332502 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:24:49.336993 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:49.337251 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:49.383766 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:49.385416 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:49.385665 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    
21:24:49.556740 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
21:24:49.559011 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Listingdecorations_Incr"
21:24:49.559598 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:49.559788 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Listingdecorations_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "DecorationID", "ListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "DecorationID", "ListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Listingdecorations_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:24:49.671441 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.95 seconds
21:24:49.673267 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingTypes_Incr: COMMIT
21:24:49.674147 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:24:49.674349 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."#AH_ListingTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypes_Incr__dbt_tmp"
    end

21:24:49.717021 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:49.731539 [debug] [Thread-4  ]: finished collecting timing info
21:24:49.731983 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingTypes_Incr: Close
21:24:49.732799 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559860580>]}
21:24:49.733321 [info ] [Thread-4  ]: 54 of 101 OK snapshotted stg.AH_ListingTypes_Incr............................... [[32mOK[0m in 13.23s]
21:24:49.733751 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ListingTypes_Incr
21:24:49.733937 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ListingsReserveHistory_Incr
21:24:49.734318 [info ] [Thread-4  ]: 57 of 101 START snapshot stg.AH_ListingsReserveHistory_Incr..................... [RUN]
21:24:49.734802 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr"
21:24:49.734961 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ListingsReserveHistory_Incr
21:24:49.735095 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ListingsReserveHistory_Incr
21:24:49.737982 [debug] [Thread-4  ]: finished collecting timing info
21:24:49.738174 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ListingsReserveHistory_Incr
21:24:49.741052 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:24:49.741234 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:24:49.741354 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:24:49.741485 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:24:49.875283 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:24:49.905032 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:24:49.928341 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:24:49.928701 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:24:49.957649 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:24:49.959942 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:24:49.960518 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingsReserveHistory_InterView]
        ) as __dbt_sbq
    
21:24:50.094295 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:24:50.116863 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:24:50.117264 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr"
        ) as __dbt_sbq
    
21:24:50.451623 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
21:24:50.455111 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:24:50.455352 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr'
      and table_schema = 'stg'
  
21:24:50.532998 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:24:50.536796 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:24:50.537054 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
        
  
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingsReserveHistory_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:49.940767'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:49.940767'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:24:49.940767''), CONVERT(DATETIME2, ''2022-09-18 21:24:49.940767'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:24:49.940767'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:49.940767'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:49.940767'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:24:49.940767'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.OldReserve != source_data.OldReserve
        or
        (
            ((snapshotted_data.OldReserve is null) and not (source_data.OldReserve is null))
            or
            ((not snapshotted_data.OldReserve is null) and (source_data.OldReserve is null))
        ) or snapshotted_data.NewReserve != source_data.NewReserve
        or
        (
            ((snapshotted_data.NewReserve is null) and not (source_data.NewReserve is null))
            or
            ((not snapshotted_data.NewReserve is null) and (source_data.NewReserve is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.OldReserve != source_data.OldReserve
        or
        (
            ((snapshotted_data.OldReserve is null) and not (source_data.OldReserve is null))
            or
            ((not snapshotted_data.OldReserve is null) and (source_data.OldReserve is null))
        ) or snapshotted_data.NewReserve != source_data.NewReserve
        or
        (
            ((snapshotted_data.NewReserve is null) and not (source_data.NewReserve is null))
            or
            ((not snapshotted_data.NewReserve is null) and (source_data.NewReserve is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view"
    end



    
21:24:50.626532 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.24 seconds
21:24:50.628280 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:50.628531 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:50.747686 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:24:50.750507 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:50.750815 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:50.969752 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:24:50.973042 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:50.973298 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr'
      and table_schema = 'stg'
  
21:24:51.209293 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:24:51.214684 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:51.214998 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:51.263448 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:24:51.265149 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:51.265402 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    
21:24:51.794082 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.23 seconds
21:24:51.795965 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Listingdecorations_Incr: COMMIT
21:24:51.796832 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:24:51.796987 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."#AH_Listingdecorations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    end

21:24:51.836469 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:51.850382 [debug] [Thread-1  ]: finished collecting timing info
21:24:51.850800 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Listingdecorations_Incr: Close
21:24:51.851566 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559860820>]}
21:24:51.852068 [info ] [Thread-1  ]: 55 of 101 OK snapshotted stg.AH_Listingdecorations_Incr......................... [[32mOK[0m in 14.05s]
21:24:51.852484 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Listingdecorations_Incr
21:24:51.852669 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Listings_Incr
21:24:51.853036 [info ] [Thread-1  ]: 58 of 101 START snapshot stg.AH_Listings_Incr................................... [RUN]
21:24:51.853463 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Listings_Incr"
21:24:51.853617 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Listings_Incr
21:24:51.853751 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Listings_Incr
21:24:51.856611 [debug] [Thread-1  ]: finished collecting timing info
21:24:51.856812 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Listings_Incr
21:24:51.859848 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:24:51.860033 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:24:51.860154 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:24:51.860283 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:24:51.962725 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:24:51.992308 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:24:52.015441 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:24:52.015835 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:24:52.059942 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:52.062195 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:24:52.062811 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Listings_InterView]
        ) as __dbt_sbq
    
21:24:52.262842 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:24:52.286048 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:24:52.286449 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Listings_Incr"
        ) as __dbt_sbq
    
21:24:52.719561 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
21:24:52.723569 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:24:52.723811 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr'
      and table_schema = 'stg'
  
21:24:52.808125 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:24:52.812797 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:24:52.813158 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
        
  
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listings_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Listings_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listings_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Listings_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Listings_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Listings_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:52.018863'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:52.018863'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:24:52.018863''), CONVERT(DATETIME2, ''2022-09-18 21:24:52.018863'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:24:52.018863'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:52.018863'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:52.018863'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:24:52.018863'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.PrimaryImageURI != source_data.PrimaryImageURI
        or
        (
            ((snapshotted_data.PrimaryImageURI is null) and not (source_data.PrimaryImageURI is null))
            or
            ((not snapshotted_data.PrimaryImageURI is null) and (source_data.PrimaryImageURI is null))
        ) or snapshotted_data.OwnerUserName != source_data.OwnerUserName
        or
        (
            ((snapshotted_data.OwnerUserName is null) and not (source_data.OwnerUserName is null))
            or
            ((not snapshotted_data.OwnerUserName is null) and (source_data.OwnerUserName is null))
        ) or snapshotted_data.CurrentListingActionUserName != source_data.CurrentListingActionUserName
        or
        (
            ((snapshotted_data.CurrentListingActionUserName is null) and not (source_data.CurrentListingActionUserName is null))
            or
            ((not snapshotted_data.CurrentListingActionUserName is null) and (source_data.CurrentListingActionUserName is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.SubTitle != source_data.SubTitle
        or
        (
            ((snapshotted_data.SubTitle is null) and not (source_data.SubTitle is null))
            or
            ((not snapshotted_data.SubTitle is null) and (source_data.SubTitle is null))
        ) or snapshotted_data.Location != source_data.Location
        or
        (
            ((snapshotted_data.Location is null) and not (source_data.Location is null))
            or
            ((not snapshotted_data.Location is null) and (source_data.Location is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.Startdttm != source_data.Startdttm
        or
        (
            ((snapshotted_data.Startdttm is null) and not (source_data.Startdttm is null))
            or
            ((not snapshotted_data.Startdttm is null) and (source_data.Startdttm is null))
        ) or snapshotted_data.AutoreListrEMAining != source_data.AutoreListrEMAining
        or
        (
            ((snapshotted_data.AutoreListrEMAining is null) and not (source_data.AutoreListrEMAining is null))
            or
            ((not snapshotted_data.AutoreListrEMAining is null) and (source_data.AutoreListrEMAining is null))
        ) or snapshotted_data.CurrentQuantity != source_data.CurrentQuantity
        or
        (
            ((snapshotted_data.CurrentQuantity is null) and not (source_data.CurrentQuantity is null))
            or
            ((not snapshotted_data.CurrentQuantity is null) and (source_data.CurrentQuantity is null))
        ) or snapshotted_data.OriginalQuantity != source_data.OriginalQuantity
        or
        (
            ((snapshotted_data.OriginalQuantity is null) and not (source_data.OriginalQuantity is null))
            or
            ((not snapshotted_data.OriginalQuantity is null) and (source_data.OriginalQuantity is null))
        ) or snapshotted_data.ReListiteration != source_data.ReListiteration
        or
        (
            ((snapshotted_data.ReListiteration is null) and not (source_data.ReListiteration is null))
            or
            ((not snapshotted_data.ReListiteration is null) and (source_data.ReListiteration is null))
        ) or snapshotted_data.LotID != source_data.LotID
        or
        (
            ((snapshotted_data.LotID is null) and not (source_data.LotID is null))
            or
            ((not snapshotted_data.LotID is null) and (source_data.LotID is null))
        ) or snapshotted_data.AcceptedActionCount != source_data.AcceptedActionCount
        or
        (
            ((snapshotted_data.AcceptedActionCount is null) and not (source_data.AcceptedActionCount is null))
            or
            ((not snapshotted_data.AcceptedActionCount is null) and (source_data.AcceptedActionCount is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Duration != source_data.Duration
        or
        (
            ((snapshotted_data.Duration is null) and not (source_data.Duration is null))
            or
            ((not snapshotted_data.Duration is null) and (source_data.Duration is null))
        ) or snapshotted_data.Version != source_data.Version
        or
        (
            ((snapshotted_data.Version is null) and not (source_data.Version is null))
            or
            ((not snapshotted_data.Version is null) and (source_data.Version is null))
        ) or snapshotted_data.CurrencyID != source_data.CurrencyID
        or
        (
            ((snapshotted_data.CurrencyID is null) and not (source_data.CurrencyID is null))
            or
            ((not snapshotted_data.CurrencyID is null) and (source_data.CurrencyID is null))
        ) or snapshotted_data.PrimaryCategoryID != source_data.PrimaryCategoryID
        or
        (
            ((snapshotted_data.PrimaryCategoryID is null) and not (source_data.PrimaryCategoryID is null))
            or
            ((not snapshotted_data.PrimaryCategoryID is null) and (source_data.PrimaryCategoryID is null))
        ) or snapshotted_data.CurrentListingActionID != source_data.CurrentListingActionID
        or
        (
            ((snapshotted_data.CurrentListingActionID is null) and not (source_data.CurrentListingActionID is null))
            or
            ((not snapshotted_data.CurrentListingActionID is null) and (source_data.CurrentListingActionID is null))
        ) or snapshotted_data.OfferCount != source_data.OfferCount
        or
        (
            ((snapshotted_data.OfferCount is null) and not (source_data.OfferCount is null))
            or
            ((not snapshotted_data.OfferCount is null) and (source_data.OfferCount is null))
        ) or snapshotted_data.OriginalreListCount != source_data.OriginalreListCount
        or
        (
            ((snapshotted_data.OriginalreListCount is null) and not (source_data.OriginalreListCount is null))
            or
            ((not snapshotted_data.OriginalreListCount is null) and (source_data.OriginalreListCount is null))
        ) or snapshotted_data.Hits != source_data.Hits
        or
        (
            ((snapshotted_data.Hits is null) and not (source_data.Hits is null))
            or
            ((not snapshotted_data.Hits is null) and (source_data.Hits is null))
        ) or snapshotted_data.CurrentPrice != source_data.CurrentPrice
        or
        (
            ((snapshotted_data.CurrentPrice is null) and not (source_data.CurrentPrice is null))
            or
            ((not snapshotted_data.CurrentPrice is null) and (source_data.CurrentPrice is null))
        ) or snapshotted_data.Increment != source_data.Increment
        or
        (
            ((snapshotted_data.Increment is null) and not (source_data.Increment is null))
            or
            ((not snapshotted_data.Increment is null) and (source_data.Increment is null))
        ) or snapshotted_data.OriginalPrice != source_data.OriginalPrice
        or
        (
            ((snapshotted_data.OriginalPrice is null) and not (source_data.OriginalPrice is null))
            or
            ((not snapshotted_data.OriginalPrice is null) and (source_data.OriginalPrice is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.PrimaryImageURI != source_data.PrimaryImageURI
        or
        (
            ((snapshotted_data.PrimaryImageURI is null) and not (source_data.PrimaryImageURI is null))
            or
            ((not snapshotted_data.PrimaryImageURI is null) and (source_data.PrimaryImageURI is null))
        ) or snapshotted_data.OwnerUserName != source_data.OwnerUserName
        or
        (
            ((snapshotted_data.OwnerUserName is null) and not (source_data.OwnerUserName is null))
            or
            ((not snapshotted_data.OwnerUserName is null) and (source_data.OwnerUserName is null))
        ) or snapshotted_data.CurrentListingActionUserName != source_data.CurrentListingActionUserName
        or
        (
            ((snapshotted_data.CurrentListingActionUserName is null) and not (source_data.CurrentListingActionUserName is null))
            or
            ((not snapshotted_data.CurrentListingActionUserName is null) and (source_data.CurrentListingActionUserName is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.SubTitle != source_data.SubTitle
        or
        (
            ((snapshotted_data.SubTitle is null) and not (source_data.SubTitle is null))
            or
            ((not snapshotted_data.SubTitle is null) and (source_data.SubTitle is null))
        ) or snapshotted_data.Location != source_data.Location
        or
        (
            ((snapshotted_data.Location is null) and not (source_data.Location is null))
            or
            ((not snapshotted_data.Location is null) and (source_data.Location is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.Startdttm != source_data.Startdttm
        or
        (
            ((snapshotted_data.Startdttm is null) and not (source_data.Startdttm is null))
            or
            ((not snapshotted_data.Startdttm is null) and (source_data.Startdttm is null))
        ) or snapshotted_data.AutoreListrEMAining != source_data.AutoreListrEMAining
        or
        (
            ((snapshotted_data.AutoreListrEMAining is null) and not (source_data.AutoreListrEMAining is null))
            or
            ((not snapshotted_data.AutoreListrEMAining is null) and (source_data.AutoreListrEMAining is null))
        ) or snapshotted_data.CurrentQuantity != source_data.CurrentQuantity
        or
        (
            ((snapshotted_data.CurrentQuantity is null) and not (source_data.CurrentQuantity is null))
            or
            ((not snapshotted_data.CurrentQuantity is null) and (source_data.CurrentQuantity is null))
        ) or snapshotted_data.OriginalQuantity != source_data.OriginalQuantity
        or
        (
            ((snapshotted_data.OriginalQuantity is null) and not (source_data.OriginalQuantity is null))
            or
            ((not snapshotted_data.OriginalQuantity is null) and (source_data.OriginalQuantity is null))
        ) or snapshotted_data.ReListiteration != source_data.ReListiteration
        or
        (
            ((snapshotted_data.ReListiteration is null) and not (source_data.ReListiteration is null))
            or
            ((not snapshotted_data.ReListiteration is null) and (source_data.ReListiteration is null))
        ) or snapshotted_data.LotID != source_data.LotID
        or
        (
            ((snapshotted_data.LotID is null) and not (source_data.LotID is null))
            or
            ((not snapshotted_data.LotID is null) and (source_data.LotID is null))
        ) or snapshotted_data.AcceptedActionCount != source_data.AcceptedActionCount
        or
        (
            ((snapshotted_data.AcceptedActionCount is null) and not (source_data.AcceptedActionCount is null))
            or
            ((not snapshotted_data.AcceptedActionCount is null) and (source_data.AcceptedActionCount is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Duration != source_data.Duration
        or
        (
            ((snapshotted_data.Duration is null) and not (source_data.Duration is null))
            or
            ((not snapshotted_data.Duration is null) and (source_data.Duration is null))
        ) or snapshotted_data.Version != source_data.Version
        or
        (
            ((snapshotted_data.Version is null) and not (source_data.Version is null))
            or
            ((not snapshotted_data.Version is null) and (source_data.Version is null))
        ) or snapshotted_data.CurrencyID != source_data.CurrencyID
        or
        (
            ((snapshotted_data.CurrencyID is null) and not (source_data.CurrencyID is null))
            or
            ((not snapshotted_data.CurrencyID is null) and (source_data.CurrencyID is null))
        ) or snapshotted_data.PrimaryCategoryID != source_data.PrimaryCategoryID
        or
        (
            ((snapshotted_data.PrimaryCategoryID is null) and not (source_data.PrimaryCategoryID is null))
            or
            ((not snapshotted_data.PrimaryCategoryID is null) and (source_data.PrimaryCategoryID is null))
        ) or snapshotted_data.CurrentListingActionID != source_data.CurrentListingActionID
        or
        (
            ((snapshotted_data.CurrentListingActionID is null) and not (source_data.CurrentListingActionID is null))
            or
            ((not snapshotted_data.CurrentListingActionID is null) and (source_data.CurrentListingActionID is null))
        ) or snapshotted_data.OfferCount != source_data.OfferCount
        or
        (
            ((snapshotted_data.OfferCount is null) and not (source_data.OfferCount is null))
            or
            ((not snapshotted_data.OfferCount is null) and (source_data.OfferCount is null))
        ) or snapshotted_data.OriginalreListCount != source_data.OriginalreListCount
        or
        (
            ((snapshotted_data.OriginalreListCount is null) and not (source_data.OriginalreListCount is null))
            or
            ((not snapshotted_data.OriginalreListCount is null) and (source_data.OriginalreListCount is null))
        ) or snapshotted_data.Hits != source_data.Hits
        or
        (
            ((snapshotted_data.Hits is null) and not (source_data.Hits is null))
            or
            ((not snapshotted_data.Hits is null) and (source_data.Hits is null))
        ) or snapshotted_data.CurrentPrice != source_data.CurrentPrice
        or
        (
            ((snapshotted_data.CurrentPrice is null) and not (source_data.CurrentPrice is null))
            or
            ((not snapshotted_data.CurrentPrice is null) and (source_data.CurrentPrice is null))
        ) or snapshotted_data.Increment != source_data.Increment
        or
        (
            ((snapshotted_data.Increment is null) and not (source_data.Increment is null))
            or
            ((not snapshotted_data.Increment is null) and (source_data.Increment is null))
        ) or snapshotted_data.OriginalPrice != source_data.OriginalPrice
        or
        (
            ((snapshotted_data.OriginalPrice is null) and not (source_data.OriginalPrice is null))
            or
            ((not snapshotted_data.OriginalPrice is null) and (source_data.OriginalPrice is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Listings_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Listings_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listings_Incr__dbt_tmp_temp_view"
    end



    
21:24:52.837481 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.57 seconds
21:24:52.839203 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:52.839470 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:24:52.875569 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:52.878334 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:52.878619 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:24:53.180388 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:24:53.182794 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingTypeproperties_Incr"
21:24:53.183387 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:53.183558 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingTypeproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr" (
                  "ID", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "Scope", "DecimalnativeValue", "DeletedOn", "DateTimenativeValue", "CreatedOn", "UpdatedOn", "IntnativeValue", "CustomFieldID", "ListingTypeID", "BoolnativeValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "Scope", "DecimalnativeValue", "DeletedOn", "DateTimenativeValue", "CreatedOn", "UpdatedOn", "IntnativeValue", "CustomFieldID", "ListingTypeID", "BoolnativeValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:24:54.974827 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.79 seconds
21:24:54.976608 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingTypeproperties_Incr: COMMIT
21:24:54.977773 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:24:54.977934 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    end

21:24:55.018250 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:24:55.032898 [debug] [Thread-3  ]: finished collecting timing info
21:24:55.033294 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingTypeproperties_Incr: Close
21:24:55.034062 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc558405f40>]}
21:24:55.034608 [info ] [Thread-3  ]: 53 of 101 OK snapshotted stg.AH_ListingTypeproperties_Incr...................... [[32mOK[0m in 18.92s]
21:24:55.034999 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ListingTypeproperties_Incr
21:24:55.035180 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Locations_Incr
21:24:55.035554 [info ] [Thread-3  ]: 59 of 101 START snapshot stg.AH_Locations_Incr.................................. [RUN]
21:24:55.035982 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Locations_Incr"
21:24:55.036132 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Locations_Incr
21:24:55.036265 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Locations_Incr
21:24:55.039062 [debug] [Thread-3  ]: finished collecting timing info
21:24:55.039258 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Locations_Incr
21:24:55.042039 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:24:55.042215 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:24:55.042333 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:24:55.042460 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:24:55.186832 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:24:55.478445 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.44 seconds
21:24:55.501851 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:24:55.502250 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:24:55.532186 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:24:55.534428 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:24:55.535018 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Locations_InterView]
        ) as __dbt_sbq
    
21:24:55.597944 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:24:55.621178 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:24:55.621571 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Locations_Incr"
        ) as __dbt_sbq
    
21:24:55.994144 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.37 seconds
21:24:55.997648 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:24:55.997943 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr'
      and table_schema = 'stg'
  
21:24:56.099991 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:24:56.103991 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:24:56.104335 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
        
  
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Locations_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Locations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Locations_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Locations_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Locations_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Locations_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:55.518910'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:55.518910'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:24:55.518910''), CONVERT(DATETIME2, ''2022-09-18 21:24:55.518910'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:24:55.518910'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:24:55.518910'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:24:55.518910'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:24:55.518910'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Locations_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Locations_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Locations_Incr__dbt_tmp_temp_view"
    end



    
21:25:01.360299 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 10.82 seconds
21:25:01.364014 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:25:01.364284 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:01.415479 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:25:01.417127 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:25:01.417402 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    
21:25:02.887609 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.47 seconds
21:25:02.889247 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:25:02.889446 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:25:02.963192 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:25:02.965835 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:25:02.966100 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:03.485786 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.52 seconds
21:25:03.489038 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:25:03.489302 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr'
      and table_schema = 'stg'
  
21:25:03.538082 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:25:03.542389 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:25:03.542694 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:03.580312 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:25:03.581978 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:25:03.582223 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    
21:25:05.468600 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.89 seconds
21:25:05.470275 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:25:05.470472 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:25:05.538210 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:25:05.540776 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:25:05.541004 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:06.115570 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.57 seconds
21:25:06.118896 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:25:06.119222 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr'
      and table_schema = 'stg'
  
21:25:06.196682 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:25:06.201289 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:25:06.201633 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:06.446245 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:25:06.447950 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:25:06.448196 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    
21:25:09.164221 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.72 seconds
21:25:09.165944 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:25:09.166211 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:25:09.246903 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:25:09.249677 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:25:09.250021 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:09.450906 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 13.35 seconds
21:25:09.455917 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:25:09.456262 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:09.613420 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:25:09.615200 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:25:09.615480 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Locations_Incr__dbt_tmp"
    
21:25:09.715325 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.47 seconds
21:25:09.717701 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingsReserveHistory_Incr"
21:25:09.718361 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:25:09.718602 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr" (
                  "ID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "OldReserve", "NewReserve", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "OldReserve", "NewReserve", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:25:12.179687 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.56 seconds
21:25:12.181330 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:25:12.181534 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:25:12.336342 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:25:12.423161 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:25:12.423504 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:12.455910 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.74 seconds
21:25:12.457603 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: COMMIT
21:25:12.458483 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:25:12.458704 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    end

21:25:12.565656 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:25:12.577882 [debug] [Thread-4  ]: finished collecting timing info
21:25:12.578306 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: Close
21:25:12.579120 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559860d60>]}
21:25:12.579644 [info ] [Thread-4  ]: 57 of 101 OK snapshotted stg.AH_ListingsReserveHistory_Incr..................... [[32mOK[0m in 22.84s]
21:25:12.580023 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ListingsReserveHistory_Incr
21:25:12.580205 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_LogentriesBuffer_Incr
21:25:12.580569 [info ] [Thread-4  ]: 60 of 101 START snapshot stg.AH_LogentriesBuffer_Incr........................... [RUN]
21:25:12.580986 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr"
21:25:12.581137 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_LogentriesBuffer_Incr
21:25:12.581271 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_LogentriesBuffer_Incr
21:25:12.584080 [debug] [Thread-4  ]: finished collecting timing info
21:25:12.584336 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_LogentriesBuffer_Incr
21:25:12.587283 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:12.587462 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:25:12.587578 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:25:12.587703 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:25:12.707913 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:25:12.759146 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:25:12.782288 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:12.782690 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:25:12.845664 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:25:12.848233 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:12.848490 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_LogentriesBuffer_InterView]
        ) as __dbt_sbq
    
21:25:12.931229 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.51 seconds
21:25:12.934197 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:25:12.934476 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr'
      and table_schema = 'stg'
  
21:25:12.939789 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:25:12.961660 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:12.962047 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr"
        ) as __dbt_sbq
    
21:25:13.039644 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:25:13.043504 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:13.043857 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr'
      and table_schema = 'stg'
  
21:25:13.062773 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:25:13.067310 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:25:13.067614 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:13.181430 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:25:13.185230 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:13.185519 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
        
  
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_LogentriesBuffer_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_LogentriesBuffer_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:25:12.800417'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:25:12.800417'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:25:12.800417''), CONVERT(DATETIME2, ''2022-09-18 21:25:12.800417'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:25:12.800417'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:25:12.800417'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:25:12.800417'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:25:12.800417'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.Properties != source_data.Properties
        or
        (
            ((snapshotted_data.Properties is null) and not (source_data.Properties is null))
            or
            ((not snapshotted_data.Properties is null) and (source_data.Properties is null))
        ) or snapshotted_data.MachineName != source_data.MachineName
        or
        (
            ((snapshotted_data.MachineName is null) and not (source_data.MachineName is null))
            or
            ((not snapshotted_data.MachineName is null) and (source_data.MachineName is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.FunctionalArea != source_data.FunctionalArea
        or
        (
            ((snapshotted_data.FunctionalArea is null) and not (source_data.FunctionalArea is null))
            or
            ((not snapshotted_data.FunctionalArea is null) and (source_data.FunctionalArea is null))
        ) or snapshotted_data.Severity != source_data.Severity
        or
        (
            ((snapshotted_data.Severity is null) and not (source_data.Severity is null))
            or
            ((not snapshotted_data.Severity is null) and (source_data.Severity is null))
        ) or snapshotted_data.Actor != source_data.Actor
        or
        (
            ((snapshotted_data.Actor is null) and not (source_data.Actor is null))
            or
            ((not snapshotted_data.Actor is null) and (source_data.Actor is null))
        ) or snapshotted_data.ExceptionClass != source_data.ExceptionClass
        or
        (
            ((snapshotted_data.ExceptionClass is null) and not (source_data.ExceptionClass is null))
            or
            ((not snapshotted_data.ExceptionClass is null) and (source_data.ExceptionClass is null))
        ) or snapshotted_data.Stacktrace != source_data.Stacktrace
        or
        (
            ((snapshotted_data.Stacktrace is null) and not (source_data.Stacktrace is null))
            or
            ((not snapshotted_data.Stacktrace is null) and (source_data.Stacktrace is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.EntryDaTestamp != source_data.EntryDaTestamp
        or
        (
            ((snapshotted_data.EntryDaTestamp is null) and not (source_data.EntryDaTestamp is null))
            or
            ((not snapshotted_data.EntryDaTestamp is null) and (source_data.EntryDaTestamp is null))
        ) or snapshotted_data.Priority != source_data.Priority
        or
        (
            ((snapshotted_data.Priority is null) and not (source_data.Priority is null))
            or
            ((not snapshotted_data.Priority is null) and (source_data.Priority is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.Properties != source_data.Properties
        or
        (
            ((snapshotted_data.Properties is null) and not (source_data.Properties is null))
            or
            ((not snapshotted_data.Properties is null) and (source_data.Properties is null))
        ) or snapshotted_data.MachineName != source_data.MachineName
        or
        (
            ((snapshotted_data.MachineName is null) and not (source_data.MachineName is null))
            or
            ((not snapshotted_data.MachineName is null) and (source_data.MachineName is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.FunctionalArea != source_data.FunctionalArea
        or
        (
            ((snapshotted_data.FunctionalArea is null) and not (source_data.FunctionalArea is null))
            or
            ((not snapshotted_data.FunctionalArea is null) and (source_data.FunctionalArea is null))
        ) or snapshotted_data.Severity != source_data.Severity
        or
        (
            ((snapshotted_data.Severity is null) and not (source_data.Severity is null))
            or
            ((not snapshotted_data.Severity is null) and (source_data.Severity is null))
        ) or snapshotted_data.Actor != source_data.Actor
        or
        (
            ((snapshotted_data.Actor is null) and not (source_data.Actor is null))
            or
            ((not snapshotted_data.Actor is null) and (source_data.Actor is null))
        ) or snapshotted_data.ExceptionClass != source_data.ExceptionClass
        or
        (
            ((snapshotted_data.ExceptionClass is null) and not (source_data.ExceptionClass is null))
            or
            ((not snapshotted_data.ExceptionClass is null) and (source_data.ExceptionClass is null))
        ) or snapshotted_data.Stacktrace != source_data.Stacktrace
        or
        (
            ((snapshotted_data.Stacktrace is null) and not (source_data.Stacktrace is null))
            or
            ((not snapshotted_data.Stacktrace is null) and (source_data.Stacktrace is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.EntryDaTestamp != source_data.EntryDaTestamp
        or
        (
            ((snapshotted_data.EntryDaTestamp is null) and not (source_data.EntryDaTestamp is null))
            or
            ((not snapshotted_data.EntryDaTestamp is null) and (source_data.EntryDaTestamp is null))
        ) or snapshotted_data.Priority != source_data.Priority
        or
        (
            ((snapshotted_data.Priority is null) and not (source_data.Priority is null))
            or
            ((not snapshotted_data.Priority is null) and (source_data.Priority is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_LogentriesBuffer_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_temp_view"
    end



    
21:25:13.230465 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:25:13.232122 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:25:13.232378 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Locations_Incr__dbt_tmp"
    
21:25:16.464303 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.23 seconds
21:25:16.465931 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:25:16.466129 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:25:16.532191 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:25:16.534836 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:25:16.535026 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:17.198166 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.66 seconds
21:25:17.201380 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:25:17.201571 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr'
      and table_schema = 'stg'
  
21:25:17.264396 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:25:17.268540 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:25:17.268771 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:17.357107 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:25:17.358831 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:25:17.359089 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Locations_Incr__dbt_tmp"
    
21:25:18.672829 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.31 seconds
21:25:18.674452 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:25:18.674662 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:25:18.732894 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:25:18.735639 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:25:18.735824 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:18.992977 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:25:18.995224 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Locations_Incr"
21:25:18.995688 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:25:18.995824 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Locations_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Locations_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Locations_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Locations_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Locations_Incr" (
                  "ID", "Name", "Description", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "Amount", "PayToproceed", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Description", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "Amount", "PayToproceed", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Locations_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:25:20.633337 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.64 seconds
21:25:20.635121 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Locations_Incr: COMMIT
21:25:20.635907 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:25:20.636057 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."#AH_Locations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Locations_Incr__dbt_tmp"
    end

21:25:20.710516 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:25:20.724636 [debug] [Thread-3  ]: finished collecting timing info
21:25:20.725049 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Locations_Incr: Close
21:25:20.725829 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55854c280>]}
21:25:20.853214 [info ] [Thread-3  ]: 59 of 101 OK snapshotted stg.AH_Locations_Incr.................................. [[32mOK[0m in 25.69s]
21:25:20.854216 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Locations_Incr
21:25:20.854443 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Logentries_Incr
21:25:20.854895 [info ] [Thread-3  ]: 61 of 101 START snapshot stg.AH_Logentries_Incr................................. [RUN]
21:25:20.855447 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Logentries_Incr"
21:25:20.855650 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Logentries_Incr
21:25:20.855806 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Logentries_Incr
21:25:20.858897 [debug] [Thread-3  ]: finished collecting timing info
21:25:20.859096 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Logentries_Incr
21:25:20.862048 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:25:20.862226 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:25:20.862345 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:25:20.862475 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:25:20.988999 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:25:21.035698 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:25:21.058849 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:25:21.059248 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:25:21.098771 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:25:21.102713 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:25:21.103002 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Logentries_InterView]
        ) as __dbt_sbq
    
21:25:21.172189 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:25:21.194322 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:25:21.194723 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Logentries_Incr"
        ) as __dbt_sbq
    
21:25:21.605464 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
21:25:21.609147 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:25:21.609377 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr'
      and table_schema = 'stg'
  
21:25:21.713098 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:25:21.717111 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:25:21.717380 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
        
  
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Logentries_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Logentries_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Logentries_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Logentries_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Logentries_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Logentries_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:25:21.081781'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:25:21.081781'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:25:21.081781''), CONVERT(DATETIME2, ''2022-09-18 21:25:21.081781'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:25:21.081781'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:25:21.081781'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:25:21.081781'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:25:21.081781'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Priority != source_data.Priority
        or
        (
            ((snapshotted_data.Priority is null) and not (source_data.Priority is null))
            or
            ((not snapshotted_data.Priority is null) and (source_data.Priority is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.EntryDaTestamp != source_data.EntryDaTestamp
        or
        (
            ((snapshotted_data.EntryDaTestamp is null) and not (source_data.EntryDaTestamp is null))
            or
            ((not snapshotted_data.EntryDaTestamp is null) and (source_data.EntryDaTestamp is null))
        ) or snapshotted_data.MachineName != source_data.MachineName
        or
        (
            ((snapshotted_data.MachineName is null) and not (source_data.MachineName is null))
            or
            ((not snapshotted_data.MachineName is null) and (source_data.MachineName is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.FunctionalArea != source_data.FunctionalArea
        or
        (
            ((snapshotted_data.FunctionalArea is null) and not (source_data.FunctionalArea is null))
            or
            ((not snapshotted_data.FunctionalArea is null) and (source_data.FunctionalArea is null))
        ) or snapshotted_data.Severity != source_data.Severity
        or
        (
            ((snapshotted_data.Severity is null) and not (source_data.Severity is null))
            or
            ((not snapshotted_data.Severity is null) and (source_data.Severity is null))
        ) or snapshotted_data.Actor != source_data.Actor
        or
        (
            ((snapshotted_data.Actor is null) and not (source_data.Actor is null))
            or
            ((not snapshotted_data.Actor is null) and (source_data.Actor is null))
        ) or snapshotted_data.ExceptionClass != source_data.ExceptionClass
        or
        (
            ((snapshotted_data.ExceptionClass is null) and not (source_data.ExceptionClass is null))
            or
            ((not snapshotted_data.ExceptionClass is null) and (source_data.ExceptionClass is null))
        ) or snapshotted_data.Stacktrace != source_data.Stacktrace
        or
        (
            ((snapshotted_data.Stacktrace is null) and not (source_data.Stacktrace is null))
            or
            ((not snapshotted_data.Stacktrace is null) and (source_data.Stacktrace is null))
        ) or snapshotted_data.Properties != source_data.Properties
        or
        (
            ((snapshotted_data.Properties is null) and not (source_data.Properties is null))
            or
            ((not snapshotted_data.Properties is null) and (source_data.Properties is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Priority != source_data.Priority
        or
        (
            ((snapshotted_data.Priority is null) and not (source_data.Priority is null))
            or
            ((not snapshotted_data.Priority is null) and (source_data.Priority is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.EntryDaTestamp != source_data.EntryDaTestamp
        or
        (
            ((snapshotted_data.EntryDaTestamp is null) and not (source_data.EntryDaTestamp is null))
            or
            ((not snapshotted_data.EntryDaTestamp is null) and (source_data.EntryDaTestamp is null))
        ) or snapshotted_data.MachineName != source_data.MachineName
        or
        (
            ((snapshotted_data.MachineName is null) and not (source_data.MachineName is null))
            or
            ((not snapshotted_data.MachineName is null) and (source_data.MachineName is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.FunctionalArea != source_data.FunctionalArea
        or
        (
            ((snapshotted_data.FunctionalArea is null) and not (source_data.FunctionalArea is null))
            or
            ((not snapshotted_data.FunctionalArea is null) and (source_data.FunctionalArea is null))
        ) or snapshotted_data.Severity != source_data.Severity
        or
        (
            ((snapshotted_data.Severity is null) and not (source_data.Severity is null))
            or
            ((not snapshotted_data.Severity is null) and (source_data.Severity is null))
        ) or snapshotted_data.Actor != source_data.Actor
        or
        (
            ((snapshotted_data.Actor is null) and not (source_data.Actor is null))
            or
            ((not snapshotted_data.Actor is null) and (source_data.Actor is null))
        ) or snapshotted_data.ExceptionClass != source_data.ExceptionClass
        or
        (
            ((snapshotted_data.ExceptionClass is null) and not (source_data.ExceptionClass is null))
            or
            ((not snapshotted_data.ExceptionClass is null) and (source_data.ExceptionClass is null))
        ) or snapshotted_data.Stacktrace != source_data.Stacktrace
        or
        (
            ((snapshotted_data.Stacktrace is null) and not (source_data.Stacktrace is null))
            or
            ((not snapshotted_data.Stacktrace is null) and (source_data.Stacktrace is null))
        ) or snapshotted_data.Properties != source_data.Properties
        or
        (
            ((snapshotted_data.Properties is null) and not (source_data.Properties is null))
            or
            ((not snapshotted_data.Properties is null) and (source_data.Properties is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Logentries_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Logentries_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Logentries_Incr__dbt_tmp_temp_view"
    end



    
21:25:31.748989 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 18.56 seconds
21:25:31.753252 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:31.753504 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:31.796628 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:25:31.798306 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:31.798575 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    
21:25:32.843538 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 45.90 seconds
21:25:32.847247 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:25:32.847522 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:32.894678 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:25:32.896341 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:25:32.896611 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingproperties_Incr__dbt_tmp"
    
21:25:33.108615 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.31 seconds
21:25:33.110352 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:33.110642 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:25:33.260347 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:25:33.263220 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:33.263497 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:33.658227 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
21:25:33.661427 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:33.661657 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr'
      and table_schema = 'stg'
  
21:25:33.708515 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:25:33.713166 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:33.713540 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:33.776660 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:25:33.778204 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:33.778432 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    
21:25:34.249329 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.35 seconds
21:25:34.251106 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:25:34.251363 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:25:34.364773 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:25:34.367521 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:25:34.367810 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:34.633548 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:25:34.636738 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:25:34.636995 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr'
      and table_schema = 'stg'
  
21:25:34.747122 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:25:34.751651 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:25:34.751983 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:34.793604 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:25:34.795302 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:25:34.795564 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingproperties_Incr__dbt_tmp"
    
21:25:35.121624 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.34 seconds
21:25:35.123418 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:35.123674 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:25:35.208573 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:25:35.211503 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:35.211821 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:35.520911 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
21:25:35.524237 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:35.524521 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr'
      and table_schema = 'stg'
  
21:25:35.568843 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:25:35.573589 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:35.573954 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:35.611061 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:25:35.612665 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:35.612905 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    
21:25:35.756042 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
21:25:35.757766 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:25:35.758014 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:25:35.799403 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:25:35.802246 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:25:35.802584 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:36.615119 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.81 seconds
21:25:36.618334 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:25:36.618692 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr'
      and table_schema = 'stg'
  
21:25:36.655930 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:25:36.660792 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:25:36.661131 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:36.701970 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:25:36.703662 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:25:36.703909 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingproperties_Incr__dbt_tmp"
    
21:25:36.909571 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.30 seconds
21:25:36.911392 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:36.911664 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:25:37.084389 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:25:37.087333 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:37.087619 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:37.443718 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
21:25:37.446200 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_LogentriesBuffer_Incr"
21:25:37.446844 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:37.447037 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_LogentriesBuffer_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr" (
                  "ID", "Message", "Properties", "MachineName", "Title", "FunctionalArea", "Severity", "Actor", "ExceptionClass", "Stacktrace", "SqlDaTestamp", "EntryDaTestamp", "Priority", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Message", "Properties", "MachineName", "Title", "FunctionalArea", "Severity", "Actor", "ExceptionClass", "Stacktrace", "SqlDaTestamp", "EntryDaTestamp", "Priority", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:25:38.661083 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.96 seconds
21:25:38.662755 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:25:38.662947 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:25:38.710648 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:25:38.713232 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:25:38.714073 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:38.992433 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:25:38.995242 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Listingproperties_Incr"
21:25:38.995842 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:25:38.996028 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Listingproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr" (
                  "ID", "DecimalnativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "BoolnativeValue", "IntnativeValue", "ListingID", "CustomFieldID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DecimalnativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "BoolnativeValue", "IntnativeValue", "ListingID", "CustomFieldID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Listingproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:25:39.501576 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.05 seconds
21:25:39.503305 [debug] [Thread-4  ]: On snapshot.Shawn.AH_LogentriesBuffer_Incr: COMMIT
21:25:39.504087 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:25:39.504259 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    end

21:25:39.543498 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:25:39.557624 [debug] [Thread-4  ]: finished collecting timing info
21:25:39.558040 [debug] [Thread-4  ]: On snapshot.Shawn.AH_LogentriesBuffer_Incr: Close
21:25:39.558852 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559869190>]}
21:25:39.559384 [info ] [Thread-4  ]: 60 of 101 OK snapshotted stg.AH_LogentriesBuffer_Incr........................... [[32mOK[0m in 26.98s]
21:25:39.559789 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_LogentriesBuffer_Incr
21:25:39.559972 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Lots_Incr
21:25:39.560347 [info ] [Thread-4  ]: 62 of 101 START snapshot stg.AH_Lots_Incr....................................... [RUN]
21:25:39.560767 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Lots_Incr"
21:25:39.560916 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Lots_Incr
21:25:39.561048 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Lots_Incr
21:25:39.563841 [debug] [Thread-4  ]: finished collecting timing info
21:25:39.564088 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Lots_Incr
21:25:39.566885 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:25:39.567064 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:25:39.567180 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:25:39.567307 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:25:39.690950 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:25:39.743936 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:25:39.767048 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:25:39.767437 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:25:39.839722 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:25:39.841960 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:25:39.842517 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Lots_InterView]
        ) as __dbt_sbq
    
21:25:39.941863 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:25:39.964277 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:25:39.964663 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Lots_Incr"
        ) as __dbt_sbq
    
21:25:40.067665 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:25:40.071131 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:25:40.071394 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr'
      and table_schema = 'stg'
  
21:25:40.289569 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:25:40.293570 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:25:40.293897 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
        
  
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Lots_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Lots_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Lots_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Lots_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Lots_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Lots_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:25:39.800791'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:25:39.800791'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:25:39.800791''), CONVERT(DATETIME2, ''2022-09-18 21:25:39.800791'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:25:39.800791'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:25:39.800791'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:25:39.800791'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:25:39.800791'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LotNumber != source_data.LotNumber
        or
        (
            ((snapshotted_data.LotNumber is null) and not (source_data.LotNumber is null))
            or
            ((not snapshotted_data.LotNumber is null) and (source_data.LotNumber is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.IsSoftclosing != source_data.IsSoftclosing
        or
        (
            ((snapshotted_data.IsSoftclosing is null) and not (source_data.IsSoftclosing is null))
            or
            ((not snapshotted_data.IsSoftclosing is null) and (source_data.IsSoftclosing is null))
        ) or snapshotted_data.SoftclosingGroup != source_data.SoftclosingGroup
        or
        (
            ((snapshotted_data.SoftclosingGroup is null) and not (source_data.SoftclosingGroup is null))
            or
            ((not snapshotted_data.SoftclosingGroup is null) and (source_data.SoftclosingGroup is null))
        ) or snapshotted_data.LotOrder != source_data.LotOrder
        or
        (
            ((snapshotted_data.LotOrder is null) and not (source_data.LotOrder is null))
            or
            ((not snapshotted_data.LotOrder is null) and (source_data.LotOrder is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.ClosingGroup != source_data.ClosingGroup
        or
        (
            ((snapshotted_data.ClosingGroup is null) and not (source_data.ClosingGroup is null))
            or
            ((not snapshotted_data.ClosingGroup is null) and (source_data.ClosingGroup is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LotNumber != source_data.LotNumber
        or
        (
            ((snapshotted_data.LotNumber is null) and not (source_data.LotNumber is null))
            or
            ((not snapshotted_data.LotNumber is null) and (source_data.LotNumber is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.IsSoftclosing != source_data.IsSoftclosing
        or
        (
            ((snapshotted_data.IsSoftclosing is null) and not (source_data.IsSoftclosing is null))
            or
            ((not snapshotted_data.IsSoftclosing is null) and (source_data.IsSoftclosing is null))
        ) or snapshotted_data.SoftclosingGroup != source_data.SoftclosingGroup
        or
        (
            ((snapshotted_data.SoftclosingGroup is null) and not (source_data.SoftclosingGroup is null))
            or
            ((not snapshotted_data.SoftclosingGroup is null) and (source_data.SoftclosingGroup is null))
        ) or snapshotted_data.LotOrder != source_data.LotOrder
        or
        (
            ((snapshotted_data.LotOrder is null) and not (source_data.LotOrder is null))
            or
            ((not snapshotted_data.LotOrder is null) and (source_data.LotOrder is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.ClosingGroup != source_data.ClosingGroup
        or
        (
            ((snapshotted_data.ClosingGroup is null) and not (source_data.ClosingGroup is null))
            or
            ((not snapshotted_data.ClosingGroup is null) and (source_data.ClosingGroup is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Lots_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Lots_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Lots_Incr__dbt_tmp_temp_view"
    end



    
21:25:41.202274 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 48.39 seconds
21:25:41.205836 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:25:41.206025 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:41.311849 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:25:41.313488 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:25:41.313742 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listings_Incr__dbt_tmp"
    
21:25:42.365399 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.37 seconds
21:25:42.367308 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Listingproperties_Incr: COMMIT
21:25:42.368160 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:25:42.368354 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."#AH_Listingproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listingproperties_Incr__dbt_tmp"
    end

21:25:42.420613 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:25:42.433362 [debug] [Thread-2  ]: finished collecting timing info
21:25:42.433755 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Listingproperties_Incr: Close
21:25:42.434499 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc558356280>]}
21:25:42.435052 [info ] [Thread-2  ]: 56 of 101 OK snapshotted stg.AH_Listingproperties_Incr.......................... [[32mOK[0m in 56.00s]
21:25:42.435436 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Listingproperties_Incr
21:25:42.435614 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_MediaMetaData_Incr
21:25:42.435977 [info ] [Thread-2  ]: 63 of 101 START snapshot stg.AH_MediaMetaData_Incr.............................. [RUN]
21:25:42.436379 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr"
21:25:42.436527 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_MediaMetaData_Incr
21:25:42.436658 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_MediaMetaData_Incr
21:25:42.439912 [debug] [Thread-2  ]: finished collecting timing info
21:25:42.440153 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_MediaMetaData_Incr
21:25:42.442924 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:25:42.443100 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:25:42.443218 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:25:42.443345 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:25:42.576922 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:25:42.635000 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:25:42.657517 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:25:42.657881 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:25:42.756578 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:25:42.758844 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:25:42.759367 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_MediaMetaData_InterView]
        ) as __dbt_sbq
    
21:25:42.852062 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:25:42.875037 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:25:42.875396 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr"
        ) as __dbt_sbq
    
21:25:42.982683 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:25:42.986265 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:25:42.986570 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr'
      and table_schema = 'stg'
  
21:25:43.069212 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.76 seconds
21:25:43.071304 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:25:43.071562 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:25:43.072451 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:25:43.075313 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:25:43.075506 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
        
  
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_MediaMetaData_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_MediaMetaData_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_MediaMetaData_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_MediaMetaData_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:25:42.675837'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:25:42.675837'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:25:42.675837''), CONVERT(DATETIME2, ''2022-09-18 21:25:42.675837'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:25:42.675837'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:25:42.675837'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:25:42.675837'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:25:42.675837'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_MediaMetaData_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_MediaMetaData_Incr__dbt_tmp_temp_view"
    end



    
21:25:43.141915 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:25:43.145021 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:25:43.145281 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:43.464390 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
21:25:43.467836 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:25:43.468191 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr'
      and table_schema = 'stg'
  
21:25:43.590657 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:25:43.595631 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:25:43.595921 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:43.705380 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:25:43.707066 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:25:43.707309 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listings_Incr__dbt_tmp"
    
21:25:45.925678 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.22 seconds
21:25:45.927402 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:25:45.927618 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:25:45.963496 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:25:45.966831 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:25:45.967117 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:46.525784 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.56 seconds
21:25:46.529007 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:25:46.529208 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr'
      and table_schema = 'stg'
  
21:25:46.619383 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:25:46.624666 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:25:46.625017 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:46.751248 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:25:46.752865 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:25:46.753105 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listings_Incr__dbt_tmp"
    
21:25:49.338162 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.58 seconds
21:25:49.339824 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:25:49.340014 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:25:49.399525 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:25:49.402791 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:25:49.403036 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:49.875145 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.47 seconds
21:25:49.878156 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Listings_Incr"
21:25:49.878763 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:25:49.878929 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Listings_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Listings_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Listings_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Listings_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Listings_Incr" (
                  "ID", "LastUpdatedUser", "PrimaryImageURI", "OwnerUserName", "CurrentListingActionUserName", "Title", "Description", "SubTitle", "Location", "Status", "CreatedOn", "UpdatedOn", "DeletedOn", "Enddttm", "Startdttm", "AutoreListrEMAining", "CurrentQuantity", "OriginalQuantity", "ReListiteration", "LotID", "AcceptedActionCount", "OwnerID", "ListingTypeID", "Duration", "Version", "CurrencyID", "PrimaryCategoryID", "CurrentListingActionID", "OfferCount", "OriginalreListCount", "Hits", "CurrentPrice", "Increment", "OriginalPrice", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "LastUpdatedUser", "PrimaryImageURI", "OwnerUserName", "CurrentListingActionUserName", "Title", "Description", "SubTitle", "Location", "Status", "CreatedOn", "UpdatedOn", "DeletedOn", "Enddttm", "Startdttm", "AutoreListrEMAining", "CurrentQuantity", "OriginalQuantity", "ReListiteration", "LotID", "AcceptedActionCount", "OwnerID", "ListingTypeID", "Duration", "Version", "CurrencyID", "PrimaryCategoryID", "CurrentListingActionID", "OfferCount", "OriginalreListCount", "Hits", "CurrentPrice", "Increment", "OriginalPrice", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Listings_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:25:52.654323 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.78 seconds
21:25:52.656080 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Listings_Incr: COMMIT
21:25:52.656827 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:25:52.656968 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."#AH_Listings_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listings_Incr__dbt_tmp"
    end

21:25:52.717621 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:25:52.731038 [debug] [Thread-1  ]: finished collecting timing info
21:25:52.731438 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Listings_Incr: Close
21:25:52.732180 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559860eb0>]}
21:25:52.732695 [info ] [Thread-1  ]: 58 of 101 OK snapshotted stg.AH_Listings_Incr................................... [[32mOK[0m in 60.88s]
21:25:52.733116 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Listings_Incr
21:25:52.733296 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Media_Incr
21:25:52.733663 [info ] [Thread-1  ]: 64 of 101 START snapshot stg.AH_Media_Incr...................................... [RUN]
21:25:52.734080 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Media_Incr"
21:25:52.734233 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Media_Incr
21:25:52.734365 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Media_Incr
21:25:52.737177 [debug] [Thread-1  ]: finished collecting timing info
21:25:52.737375 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Media_Incr
21:25:52.740263 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:25:52.740441 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:25:52.740558 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:25:52.740684 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:25:52.917593 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:25:52.968659 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:25:52.991815 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:25:52.992194 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:25:53.069446 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:25:53.071732 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:25:53.072292 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Media_InterView]
        ) as __dbt_sbq
    
21:25:53.170380 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:25:53.193113 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:25:53.193486 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Media_Incr"
        ) as __dbt_sbq
    
21:25:53.371618 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:25:53.375395 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:25:53.375698 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr'
      and table_schema = 'stg'
  
21:25:53.475599 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:25:53.479685 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:25:53.480011 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
        
  
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Media_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Media_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Media_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Media_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Media_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Media_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:25:53.035371'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:25:53.035371'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:25:53.035371''), CONVERT(DATETIME2, ''2022-09-18 21:25:53.035371'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:25:53.035371'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:25:53.035371'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:25:53.035371'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:25:53.035371'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.GUID != source_data.GUID
        or
        (
            ((snapshotted_data.GUID is null) and not (source_data.GUID is null))
            or
            ((not snapshotted_data.GUID is null) and (source_data.GUID is null))
        ) or snapshotted_data.DefaultvariationName != source_data.DefaultvariationName
        or
        (
            ((snapshotted_data.DefaultvariationName is null) and not (source_data.DefaultvariationName is null))
            or
            ((not snapshotted_data.DefaultvariationName is null) and (source_data.DefaultvariationName is null))
        ) or snapshotted_data.Loader != source_data.Loader
        or
        (
            ((snapshotted_data.Loader is null) and not (source_data.Loader is null))
            or
            ((not snapshotted_data.Loader is null) and (source_data.Loader is null))
        ) or snapshotted_data.Saver != source_data.Saver
        or
        (
            ((snapshotted_data.Saver is null) and not (source_data.Saver is null))
            or
            ((not snapshotted_data.Saver is null) and (source_data.Saver is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.ConText != source_data.ConText
        or
        (
            ((snapshotted_data.ConText is null) and not (source_data.ConText is null))
            or
            ((not snapshotted_data.ConText is null) and (source_data.ConText is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.GUID != source_data.GUID
        or
        (
            ((snapshotted_data.GUID is null) and not (source_data.GUID is null))
            or
            ((not snapshotted_data.GUID is null) and (source_data.GUID is null))
        ) or snapshotted_data.DefaultvariationName != source_data.DefaultvariationName
        or
        (
            ((snapshotted_data.DefaultvariationName is null) and not (source_data.DefaultvariationName is null))
            or
            ((not snapshotted_data.DefaultvariationName is null) and (source_data.DefaultvariationName is null))
        ) or snapshotted_data.Loader != source_data.Loader
        or
        (
            ((snapshotted_data.Loader is null) and not (source_data.Loader is null))
            or
            ((not snapshotted_data.Loader is null) and (source_data.Loader is null))
        ) or snapshotted_data.Saver != source_data.Saver
        or
        (
            ((snapshotted_data.Saver is null) and not (source_data.Saver is null))
            or
            ((not snapshotted_data.Saver is null) and (source_data.Saver is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.ConText != source_data.ConText
        or
        (
            ((snapshotted_data.ConText is null) and not (source_data.ConText is null))
            or
            ((not snapshotted_data.ConText is null) and (source_data.ConText is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Media_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Media_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Media_Incr__dbt_tmp_temp_view"
    end



    
21:25:59.021415 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 18.73 seconds
21:25:59.024984 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:25:59.025209 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:25:59.653228 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.63 seconds
21:25:59.654815 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:25:59.654995 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Lots_Incr__dbt_tmp"
    
21:26:01.985326 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.33 seconds
21:26:01.987128 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:26:01.987381 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:26:02.076375 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:26:02.079140 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:26:02.079392 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:26:02.380204 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:26:02.383370 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:26:02.383637 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr'
      and table_schema = 'stg'
  
21:26:02.444086 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:26:02.448219 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:26:02.448534 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:26:03.336021 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.89 seconds
21:26:03.337674 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:26:03.337911 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Lots_Incr__dbt_tmp"
    
21:26:06.119118 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.78 seconds
21:26:06.120748 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:26:06.120932 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:26:06.168019 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:26:06.170764 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:26:06.171340 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:26:06.570574 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
21:26:06.573674 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:26:06.573916 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr'
      and table_schema = 'stg'
  
21:26:06.619827 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:26:06.624659 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:26:06.625035 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:26:06.672649 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:26:06.674295 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:26:06.674526 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Lots_Incr__dbt_tmp"
    
21:26:08.115804 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.44 seconds
21:26:08.117451 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:26:08.117641 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:26:08.154323 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:26:08.157095 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:26:08.157295 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:26:08.447581 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:26:08.449896 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Lots_Incr"
21:26:08.450467 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:26:08.450693 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Lots_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Lots_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Lots_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Lots_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Lots_Incr" (
                  "ID", "LotNumber", "LastUpdatedUser", "IsSoftclosing", "SoftclosingGroup", "LotOrder", "AuctionEventID", "ClosingGroup", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "LotNumber", "LastUpdatedUser", "IsSoftclosing", "SoftclosingGroup", "LotOrder", "AuctionEventID", "ClosingGroup", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Lots_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:26:10.899269 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.45 seconds
21:26:10.900943 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Lots_Incr: COMMIT
21:26:10.901990 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:26:10.902142 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."#AH_Lots_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Lots_Incr__dbt_tmp"
    end

21:26:11.084354 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:26:11.097671 [debug] [Thread-4  ]: finished collecting timing info
21:26:11.097993 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Lots_Incr: Close
21:26:11.098721 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559869580>]}
21:26:11.099195 [info ] [Thread-4  ]: 62 of 101 OK snapshotted stg.AH_Lots_Incr....................................... [[32mOK[0m in 31.54s]
21:26:11.099569 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Lots_Incr
21:26:11.099747 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_MediaassetMetaData_Incr
21:26:11.100095 [info ] [Thread-4  ]: 65 of 101 START snapshot stg.AH_MediaassetMetaData_Incr......................... [RUN]
21:26:11.100490 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr"
21:26:11.100641 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_MediaassetMetaData_Incr
21:26:11.100773 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_MediaassetMetaData_Incr
21:26:11.103450 [debug] [Thread-4  ]: finished collecting timing info
21:26:11.103643 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_MediaassetMetaData_Incr
21:26:11.106267 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:26:11.106443 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:26:11.106590 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:26:11.106731 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:26:11.273122 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:26:11.396855 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:26:11.419544 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:26:11.419925 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:26:11.536168 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:26:11.538384 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:26:11.539001 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_MediaassetMetaData_InterView]
        ) as __dbt_sbq
    
21:26:11.718609 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:26:11.740520 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:26:11.740913 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr"
        ) as __dbt_sbq
    
21:26:11.913015 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:26:11.916440 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:26:11.916663 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr'
      and table_schema = 'stg'
  
21:26:12.054035 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:26:12.057878 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:26:12.058162 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
        
  
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_MediaassetMetaData_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_MediaassetMetaData_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:26:11.486259'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:26:11.486259'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:26:11.486259''), CONVERT(DATETIME2, ''2022-09-18 21:26:11.486259'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:26:11.486259'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:26:11.486259'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:26:11.486259'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:26:11.486259'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.MediaassetID != source_data.MediaassetID
        or
        (
            ((snapshotted_data.MediaassetID is null) and not (source_data.MediaassetID is null))
            or
            ((not snapshotted_data.MediaassetID is null) and (source_data.MediaassetID is null))
        ) or snapshotted_data.MediaMetaDataID != source_data.MediaMetaDataID
        or
        (
            ((snapshotted_data.MediaMetaDataID is null) and not (source_data.MediaMetaDataID is null))
            or
            ((not snapshotted_data.MediaMetaDataID is null) and (source_data.MediaMetaDataID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.MediaassetID != source_data.MediaassetID
        or
        (
            ((snapshotted_data.MediaassetID is null) and not (source_data.MediaassetID is null))
            or
            ((not snapshotted_data.MediaassetID is null) and (source_data.MediaassetID is null))
        ) or snapshotted_data.MediaMetaDataID != source_data.MediaMetaDataID
        or
        (
            ((snapshotted_data.MediaMetaDataID is null) and not (source_data.MediaMetaDataID is null))
            or
            ((not snapshotted_data.MediaMetaDataID is null) and (source_data.MediaMetaDataID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_MediaassetMetaData_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_temp_view"
    end



    
21:26:33.216255 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 39.74 seconds
21:26:33.219851 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:26:33.220073 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:26:33.331023 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:26:33.332652 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:26:33.332889 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Media_Incr__dbt_tmp"
    
21:26:35.647002 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 73.93 seconds
21:26:35.651604 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:26:35.651814 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.32 seconds
21:26:35.653118 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:26:35.653321 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:26:35.652006 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:26:35.820378 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:26:35.822066 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:26:35.822331 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Logentries_Incr__dbt_tmp"
    
21:26:35.833554 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:26:35.836226 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:26:35.836548 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:26:36.454807 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.62 seconds
21:26:36.457935 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:26:36.458159 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr'
      and table_schema = 'stg'
  
21:26:36.592819 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:26:36.596907 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:26:36.597112 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:26:36.735366 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:26:36.736983 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:26:36.737218 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Media_Incr__dbt_tmp"
    
21:26:38.343339 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.52 seconds
21:26:38.345485 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:26:38.345689 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:26:38.530105 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:26:38.532835 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:26:38.533020 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:26:38.962465 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.23 seconds
21:26:38.964099 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:26:38.964272 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:26:39.048483 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:26:39.051526 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:26:39.051776 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:26:39.073452 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.54 seconds
21:26:39.076396 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:26:39.076665 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr'
      and table_schema = 'stg'
  
21:26:39.224861 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:26:39.229241 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:26:39.229506 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:26:39.326088 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:26:39.327818 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:26:39.328078 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Logentries_Incr__dbt_tmp"
    
21:26:39.805563 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.75 seconds
21:26:39.808704 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:26:39.808944 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr'
      and table_schema = 'stg'
  
21:26:39.903946 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:26:39.908489 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:26:39.908737 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:26:40.015518 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:26:40.017155 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:26:40.017408 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Media_Incr__dbt_tmp"
    
21:26:42.593002 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.26 seconds
21:26:42.594634 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:26:42.594809 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:26:42.727532 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:26:42.730233 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:26:42.730429 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:26:43.354789 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.62 seconds
21:26:43.358258 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:26:43.358503 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr'
      and table_schema = 'stg'
  
21:26:43.463918 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:26:43.468735 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:26:43.469060 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:26:43.690883 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:26:43.692489 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:26:43.692722 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Logentries_Incr__dbt_tmp"
    
21:26:44.296093 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 4.28 seconds
21:26:44.297795 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:26:44.298026 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:26:44.374852 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:26:44.377553 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:26:44.377782 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:26:45.027815 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.65 seconds
21:26:45.029997 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Media_Incr"
21:26:45.030413 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:26:45.030646 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Media_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Media_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Media_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Media_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Media_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "GUID", "DefaultvariationName", "Loader", "Saver", "LastUpdatedUser", "ConText", "Status", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "GUID", "DefaultvariationName", "Loader", "Saver", "LastUpdatedUser", "ConText", "Status", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Media_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:26:48.184237 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 4.49 seconds
21:26:48.185881 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:26:48.186066 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:26:48.332463 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:26:48.335221 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:26:48.335409 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:26:49.083591 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.75 seconds
21:26:49.085962 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Logentries_Incr"
21:26:49.086413 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:26:49.086700 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Logentries_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Logentries_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Logentries_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Logentries_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Logentries_Incr" (
                  "ID", "Priority", "EventID", "SqlDaTestamp", "EntryDaTestamp", "MachineName", "Message", "Title", "FunctionalArea", "Severity", "Actor", "ExceptionClass", "Stacktrace", "Properties", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Priority", "EventID", "SqlDaTestamp", "EntryDaTestamp", "MachineName", "Message", "Title", "FunctionalArea", "Severity", "Actor", "ExceptionClass", "Stacktrace", "Properties", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Logentries_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:26:49.422438 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 4.39 seconds
21:26:49.424552 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Media_Incr: COMMIT
21:26:49.425324 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:26:49.425464 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."#AH_Media_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Media_Incr__dbt_tmp"
    end

21:26:49.557395 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:26:49.571224 [debug] [Thread-1  ]: finished collecting timing info
21:26:49.571615 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Media_Incr: Close
21:26:49.572366 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5598692e0>]}
21:26:49.572871 [info ] [Thread-1  ]: 64 of 101 OK snapshotted stg.AH_Media_Incr...................................... [[32mOK[0m in 56.84s]
21:26:49.573254 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Media_Incr
21:26:49.573452 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Mediaassets_Incr
21:26:49.573829 [info ] [Thread-1  ]: 66 of 101 START snapshot stg.AH_Mediaassets_Incr................................ [RUN]
21:26:49.574242 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Mediaassets_Incr"
21:26:49.574397 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Mediaassets_Incr
21:26:49.574527 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Mediaassets_Incr
21:26:49.577219 [debug] [Thread-1  ]: finished collecting timing info
21:26:49.577416 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Mediaassets_Incr
21:26:49.580193 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:26:49.580372 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:26:49.580488 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:26:49.580614 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:26:49.775084 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:26:49.856817 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:26:49.879354 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:26:49.879745 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:26:49.951654 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:26:49.953982 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:26:49.954652 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Mediaassets_InterView]
        ) as __dbt_sbq
    
21:26:50.120493 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:26:50.142878 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:26:50.143300 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr"
        ) as __dbt_sbq
    
21:26:52.249809 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.11 seconds
21:26:52.253500 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:26:52.253793 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr'
      and table_schema = 'stg'
  
21:26:52.394696 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:26:52.398956 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:26:52.399262 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
        
  
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Mediaassets_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Mediaassets_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Mediaassets_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Mediaassets_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Mediaassets_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:26:49.908716'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:26:49.908716'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:26:49.908716''), CONVERT(DATETIME2, ''2022-09-18 21:26:49.908716'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:26:49.908716'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:26:49.908716'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:26:49.908716'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:26:49.908716'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.Reference != source_data.Reference
        or
        (
            ((snapshotted_data.Reference is null) and not (source_data.Reference is null))
            or
            ((not snapshotted_data.Reference is null) and (source_data.Reference is null))
        ) or snapshotted_data.Sha1 != source_data.Sha1
        or
        (
            ((snapshotted_data.Sha1 is null) and not (source_data.Sha1 is null))
            or
            ((not snapshotted_data.Sha1 is null) and (source_data.Sha1 is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.Reference != source_data.Reference
        or
        (
            ((snapshotted_data.Reference is null) and not (source_data.Reference is null))
            or
            ((not snapshotted_data.Reference is null) and (source_data.Reference is null))
        ) or snapshotted_data.Sha1 != source_data.Sha1
        or
        (
            ((snapshotted_data.Sha1 is null) and not (source_data.Sha1 is null))
            or
            ((not snapshotted_data.Sha1 is null) and (source_data.Sha1 is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Mediaassets_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Mediaassets_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Mediaassets_Incr__dbt_tmp_temp_view"
    end



    
21:26:53.401127 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 4.31 seconds
21:26:53.402920 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Logentries_Incr: COMMIT
21:26:53.403735 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:26:53.403890 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."#AH_Logentries_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Logentries_Incr__dbt_tmp"
    end

21:26:53.553830 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:26:53.566212 [debug] [Thread-3  ]: finished collecting timing info
21:26:53.566638 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Logentries_Incr: Close
21:26:53.567430 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559869430>]}
21:26:53.567938 [info ] [Thread-3  ]: 61 of 101 OK snapshotted stg.AH_Logentries_Incr................................. [[32mOK[0m in 92.71s]
21:26:53.568321 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Logentries_Incr
21:26:53.568503 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Mediavariations_Incr
21:26:53.568891 [info ] [Thread-3  ]: 67 of 101 START snapshot stg.AH_Mediavariations_Incr............................ [RUN]
21:26:53.569304 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Mediavariations_Incr"
21:26:53.569473 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Mediavariations_Incr
21:26:53.569611 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Mediavariations_Incr
21:26:53.572471 [debug] [Thread-3  ]: finished collecting timing info
21:26:53.572673 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Mediavariations_Incr
21:26:53.575641 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:26:53.575823 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:26:53.575941 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:26:53.576069 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:26:53.705711 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:26:53.757734 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:26:53.780684 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:26:53.781079 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:26:53.843163 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:26:53.845413 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:26:53.846021 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Mediavariations_InterView]
        ) as __dbt_sbq
    
21:26:53.978046 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:26:54.000538 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:26:54.000943 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr"
        ) as __dbt_sbq
    
21:26:54.101391 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:26:54.105077 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:26:54.105371 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr'
      and table_schema = 'stg'
  
21:26:54.238779 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:26:54.242534 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:26:54.242839 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
        
  
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Mediavariations_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Mediavariations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Mediavariations_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Mediavariations_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Mediavariations_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:26:53.799336'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:26:53.799336'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:26:53.799336''), CONVERT(DATETIME2, ''2022-09-18 21:26:53.799336'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:26:53.799336'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:26:53.799336'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:26:53.799336'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:26:53.799336'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaassetID != source_data.MediaassetID
        or
        (
            ((snapshotted_data.MediaassetID is null) and not (source_data.MediaassetID is null))
            or
            ((not snapshotted_data.MediaassetID is null) and (source_data.MediaassetID is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaassetID != source_data.MediaassetID
        or
        (
            ((snapshotted_data.MediaassetID is null) and not (source_data.MediaassetID is null))
            or
            ((not snapshotted_data.MediaassetID is null) and (source_data.MediaassetID is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Mediavariations_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Mediavariations_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Mediavariations_Incr__dbt_tmp_temp_view"
    end



    
21:26:58.072286 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 46.01 seconds
21:26:58.075996 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:26:58.076250 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:26:58.319802 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:26:58.321453 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:26:58.321703 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    
21:27:01.182287 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.86 seconds
21:27:01.183963 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:27:01.184150 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:27:01.431918 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:27:01.434721 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:27:01.435000 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:01.859220 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.42 seconds
21:27:01.862416 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:27:01.862729 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr'
      and table_schema = 'stg'
  
21:27:02.103454 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:27:02.107851 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:27:02.108159 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:02.220659 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:27:02.222326 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:27:02.222611 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    
21:27:05.082115 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.86 seconds
21:27:05.083790 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:27:05.083979 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:27:05.168960 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:27:05.171597 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:27:05.171835 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:05.621014 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.45 seconds
21:27:05.624352 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:27:05.624629 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr'
      and table_schema = 'stg'
  
21:27:05.701178 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:27:05.705780 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:27:05.706134 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:05.820946 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:27:05.822631 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:27:05.822886 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    
21:27:08.276822 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.45 seconds
21:27:08.278507 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:27:08.278765 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:27:08.374022 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:27:08.376755 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:27:08.377069 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:09.060692 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.68 seconds
21:27:09.062957 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_MediaassetMetaData_Incr"
21:27:09.063482 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:27:09.063633 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_MediaassetMetaData_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr" (
                  "ID", "MediaassetID", "MediaMetaDataID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "MediaassetID", "MediaMetaDataID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:27:13.202340 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 4.14 seconds
21:27:13.204090 [debug] [Thread-4  ]: On snapshot.Shawn.AH_MediaassetMetaData_Incr: COMMIT
21:27:13.205156 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:27:13.205312 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    end

21:27:13.450319 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:27:13.464433 [debug] [Thread-4  ]: finished collecting timing info
21:27:13.464845 [debug] [Thread-4  ]: On snapshot.Shawn.AH_MediaassetMetaData_Incr: Close
21:27:13.465611 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5585ae5e0>]}
21:27:13.466117 [info ] [Thread-4  ]: 65 of 101 OK snapshotted stg.AH_MediaassetMetaData_Incr......................... [[32mOK[0m in 62.37s]
21:27:13.466502 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_MediaassetMetaData_Incr
21:27:13.466721 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Model_Incr
21:27:13.467090 [info ] [Thread-4  ]: 68 of 101 START snapshot stg.AH_Model_Incr...................................... [RUN]
21:27:13.467509 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Model_Incr"
21:27:13.467661 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Model_Incr
21:27:13.467794 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Model_Incr
21:27:13.470585 [debug] [Thread-4  ]: finished collecting timing info
21:27:13.470780 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Model_Incr
21:27:13.473644 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:13.473823 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:27:13.473961 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:27:13.474095 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:27:13.665342 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:27:13.751053 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:27:13.774556 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:13.774953 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:27:13.844290 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:27:13.846580 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:13.847162 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Model_InterView]
        ) as __dbt_sbq
    
21:27:13.953669 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:27:13.976953 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:13.977347 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Model_Incr"
        ) as __dbt_sbq
    
21:27:14.405254 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
21:27:14.409022 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:14.409398 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr'
      and table_schema = 'stg'
  
21:27:14.563090 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:27:14.566949 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:14.567288 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
        
  
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Model_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Model_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Model_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Model_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Model_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Model_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:27:13.799692'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:27:13.799692'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:27:13.799692''), CONVERT(DATETIME2, ''2022-09-18 21:27:13.799692'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:27:13.799692'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:27:13.799692'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:27:13.799692'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:27:13.799692'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Model_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Model_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Model_Incr__dbt_tmp_temp_view"
    end



    
21:27:36.294919 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 21.73 seconds
21:27:36.299244 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:36.299553 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:36.519820 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:27:36.521387 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:36.521590 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Model_Incr__dbt_tmp"
    
21:27:41.235309 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 4.71 seconds
21:27:41.236966 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:41.237148 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:27:41.448057 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:27:41.450698 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:41.450949 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:42.414609 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
21:27:42.417705 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:42.417957 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr'
      and table_schema = 'stg'
  
21:27:42.565707 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:27:42.569677 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:42.569943 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:42.840113 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:27:42.841742 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:42.841996 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Model_Incr__dbt_tmp"
    
21:27:45.399183 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.56 seconds
21:27:45.400803 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:45.400981 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:27:45.458458 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:27:45.460733 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:45.460915 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:45.850276 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
21:27:45.853429 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:45.853704 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr'
      and table_schema = 'stg'
  
21:27:45.911869 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:27:45.916113 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:45.916347 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:45.995962 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:27:45.997566 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:45.997807 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Model_Incr__dbt_tmp"
    
21:27:47.643307 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 55.24 seconds
21:27:47.646926 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:27:47.647155 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:47.764631 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:27:47.766191 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:27:47.766401 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediaassets_Incr__dbt_tmp"
    
21:27:47.977849 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.98 seconds
21:27:47.979548 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:47.979779 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:27:48.024277 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:27:48.026800 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:48.027045 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:48.575482 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.55 seconds
21:27:48.577513 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Model_Incr"
21:27:48.577955 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:48.578093 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Model_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Model_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Model_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Model_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Model_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Model_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:27:49.416570 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.65 seconds
21:27:49.418273 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:27:49.418524 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:27:49.587483 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:27:49.590146 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:27:49.590392 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:50.134640 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.54 seconds
21:27:50.138057 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:27:50.138338 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr'
      and table_schema = 'stg'
  
21:27:50.284401 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:27:50.288817 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:27:50.289106 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:50.773562 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.20 seconds
21:27:50.775303 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Model_Incr: COMMIT
21:27:50.776323 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:27:50.776474 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."#AH_Model_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Model_Incr__dbt_tmp"
    end

21:27:50.776810 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.49 seconds
21:27:50.777858 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:27:50.778048 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediaassets_Incr__dbt_tmp"
    
21:27:50.817173 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:27:50.831059 [debug] [Thread-4  ]: finished collecting timing info
21:27:50.831432 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Model_Incr: Close
21:27:50.832179 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559869c10>]}
21:27:50.832672 [info ] [Thread-4  ]: 68 of 101 OK snapshotted stg.AH_Model_Incr...................................... [[32mOK[0m in 37.36s]
21:27:50.833079 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Model_Incr
21:27:50.833259 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_NewSalestoInvoice_Incr
21:27:50.833615 [info ] [Thread-4  ]: 69 of 101 START snapshot stg.AH_NewSalestoInvoice_Incr.......................... [RUN]
21:27:50.834019 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr"
21:27:50.834170 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_NewSalestoInvoice_Incr
21:27:50.834300 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_NewSalestoInvoice_Incr
21:27:50.837016 [debug] [Thread-4  ]: finished collecting timing info
21:27:50.837208 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_NewSalestoInvoice_Incr
21:27:50.839906 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:27:50.840082 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:27:50.840250 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:27:50.840400 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:27:50.951056 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:27:51.012508 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:27:51.035048 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:27:51.035412 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:27:51.093871 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:27:51.096013 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:27:51.096545 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_NewSalestoInvoice_InterView]
        ) as __dbt_sbq
    
21:27:51.197113 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:27:51.219165 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:27:51.219491 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr"
        ) as __dbt_sbq
    
21:27:51.301984 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:27:51.305750 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:27:51.306099 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr'
      and table_schema = 'stg'
  
21:27:51.420798 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:27:51.424570 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:27:51.424849 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
        
  
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_NewSalestoInvoice_InterView]

    ),

    snapshotted_data as (

        select *,
            LineItemID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LineItemID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:27:51.065967'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:27:51.065967'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:27:51.065967''), CONVERT(DATETIME2, ''2022-09-18 21:27:51.065967'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(LineItemID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:27:51.065967'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LineItemID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:27:51.065967'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:27:51.065967'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:27:51.065967'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.LineItemID != source_data.LineItemID
        or
        (
            ((snapshotted_data.LineItemID is null) and not (source_data.LineItemID is null))
            or
            ((not snapshotted_data.LineItemID is null) and (source_data.LineItemID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.LineItemID != source_data.LineItemID
        or
        (
            ((snapshotted_data.LineItemID is null) and not (source_data.LineItemID is null))
            or
            ((not snapshotted_data.LineItemID is null) and (source_data.LineItemID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view"
    end



    
21:27:52.139259 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.36 seconds
21:27:52.140964 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:27:52.141223 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:27:52.214434 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:27:52.217126 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:27:52.217381 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:52.467731 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:27:52.471339 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:27:52.471710 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr'
      and table_schema = 'stg'
  
21:27:52.550587 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:27:52.555975 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:27:52.556332 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:52.640803 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:27:52.642477 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:27:52.642740 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediaassets_Incr__dbt_tmp"
    
21:27:54.337121 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.69 seconds
21:27:54.338812 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:27:54.339008 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:27:54.386967 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:27:54.389716 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:27:54.389962 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:54.660312 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:27:54.662469 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Mediaassets_Incr"
21:27:54.663117 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:27:54.663297 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Mediaassets_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Type", "Reference", "Sha1", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Type", "Reference", "Sha1", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Mediaassets_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:27:56.478746 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.82 seconds
21:27:56.480463 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Mediaassets_Incr: COMMIT
21:27:56.481199 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:27:56.481330 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."#AH_Mediaassets_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Mediaassets_Incr__dbt_tmp"
    end

21:27:56.528889 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:27:56.541462 [debug] [Thread-1  ]: finished collecting timing info
21:27:56.541816 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Mediaassets_Incr: Close
21:27:56.542585 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559869ac0>]}
21:27:56.543094 [info ] [Thread-1  ]: 66 of 101 OK snapshotted stg.AH_Mediaassets_Incr................................ [[32mOK[0m in 66.97s]
21:27:56.543472 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Mediaassets_Incr
21:27:56.543658 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Notifications_Incr
21:27:56.544009 [info ] [Thread-1  ]: 70 of 101 START snapshot stg.AH_Notifications_Incr.............................. [RUN]
21:27:56.544425 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Notifications_Incr"
21:27:56.544576 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Notifications_Incr
21:27:56.544709 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Notifications_Incr
21:27:56.547571 [debug] [Thread-1  ]: finished collecting timing info
21:27:56.547760 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Notifications_Incr
21:27:56.550614 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:27:56.550790 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:27:56.550907 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:27:56.551036 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:27:56.675438 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:27:56.716485 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:27:56.739640 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:27:56.740003 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:27:56.783612 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:27:56.785751 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:27:56.786293 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Notifications_InterView]
        ) as __dbt_sbq
    
21:27:56.879569 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:27:56.902203 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:27:56.902523 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Notifications_Incr"
        ) as __dbt_sbq
    
21:27:57.065548 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:27:57.069306 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:27:57.069550 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr'
      and table_schema = 'stg'
  
21:27:57.175993 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:27:57.180095 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:27:57.180364 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
        
  
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Notifications_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Notifications_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Notifications_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Notifications_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Notifications_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Notifications_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:27:56.753386'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:27:56.753386'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:27:56.753386''), CONVERT(DATETIME2, ''2022-09-18 21:27:56.753386'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:27:56.753386'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:27:56.753386'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:27:56.753386'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:27:56.753386'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DetailID != source_data.DetailID
        or
        (
            ((snapshotted_data.DetailID is null) and not (source_data.DetailID is null))
            or
            ((not snapshotted_data.DetailID is null) and (source_data.DetailID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Queueddttm != source_data.Queueddttm
        or
        (
            ((snapshotted_data.Queueddttm is null) and not (source_data.Queueddttm is null))
            or
            ((not snapshotted_data.Queueddttm is null) and (source_data.Queueddttm is null))
        ) or snapshotted_data.Statusdttm != source_data.Statusdttm
        or
        (
            ((snapshotted_data.Statusdttm is null) and not (source_data.Statusdttm is null))
            or
            ((not snapshotted_data.Statusdttm is null) and (source_data.Statusdttm is null))
        ) or snapshotted_data.RecipientEmail != source_data.RecipientEmail
        or
        (
            ((snapshotted_data.RecipientEmail is null) and not (source_data.RecipientEmail is null))
            or
            ((not snapshotted_data.RecipientEmail is null) and (source_data.RecipientEmail is null))
        ) or snapshotted_data.CcEmail != source_data.CcEmail
        or
        (
            ((snapshotted_data.CcEmail is null) and not (source_data.CcEmail is null))
            or
            ((not snapshotted_data.CcEmail is null) and (source_data.CcEmail is null))
        ) or snapshotted_data.BCcEmail != source_data.BCcEmail
        or
        (
            ((snapshotted_data.BCcEmail is null) and not (source_data.BCcEmail is null))
            or
            ((not snapshotted_data.BCcEmail is null) and (source_data.BCcEmail is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.StatusMessage != source_data.StatusMessage
        or
        (
            ((snapshotted_data.StatusMessage is null) and not (source_data.StatusMessage is null))
            or
            ((not snapshotted_data.StatusMessage is null) and (source_data.StatusMessage is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.DetailType != source_data.DetailType
        or
        (
            ((snapshotted_data.DetailType is null) and not (source_data.DetailType is null))
            or
            ((not snapshotted_data.DetailType is null) and (source_data.DetailType is null))
        ) or snapshotted_data.ReplytoEmail != source_data.ReplytoEmail
        or
        (
            ((snapshotted_data.ReplytoEmail is null) and not (source_data.ReplytoEmail is null))
            or
            ((not snapshotted_data.ReplytoEmail is null) and (source_data.ReplytoEmail is null))
        ) or snapshotted_data.SEnderUserName != source_data.SEnderUserName
        or
        (
            ((snapshotted_data.SEnderUserName is null) and not (source_data.SEnderUserName is null))
            or
            ((not snapshotted_data.SEnderUserName is null) and (source_data.SEnderUserName is null))
        ) or snapshotted_data.ReceiverUserName != source_data.ReceiverUserName
        or
        (
            ((snapshotted_data.ReceiverUserName is null) and not (source_data.ReceiverUserName is null))
            or
            ((not snapshotted_data.ReceiverUserName is null) and (source_data.ReceiverUserName is null))
        ) or snapshotted_data.Template != source_data.Template
        or
        (
            ((snapshotted_data.Template is null) and not (source_data.Template is null))
            or
            ((not snapshotted_data.Template is null) and (source_data.Template is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DetailID != source_data.DetailID
        or
        (
            ((snapshotted_data.DetailID is null) and not (source_data.DetailID is null))
            or
            ((not snapshotted_data.DetailID is null) and (source_data.DetailID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Queueddttm != source_data.Queueddttm
        or
        (
            ((snapshotted_data.Queueddttm is null) and not (source_data.Queueddttm is null))
            or
            ((not snapshotted_data.Queueddttm is null) and (source_data.Queueddttm is null))
        ) or snapshotted_data.Statusdttm != source_data.Statusdttm
        or
        (
            ((snapshotted_data.Statusdttm is null) and not (source_data.Statusdttm is null))
            or
            ((not snapshotted_data.Statusdttm is null) and (source_data.Statusdttm is null))
        ) or snapshotted_data.RecipientEmail != source_data.RecipientEmail
        or
        (
            ((snapshotted_data.RecipientEmail is null) and not (source_data.RecipientEmail is null))
            or
            ((not snapshotted_data.RecipientEmail is null) and (source_data.RecipientEmail is null))
        ) or snapshotted_data.CcEmail != source_data.CcEmail
        or
        (
            ((snapshotted_data.CcEmail is null) and not (source_data.CcEmail is null))
            or
            ((not snapshotted_data.CcEmail is null) and (source_data.CcEmail is null))
        ) or snapshotted_data.BCcEmail != source_data.BCcEmail
        or
        (
            ((snapshotted_data.BCcEmail is null) and not (source_data.BCcEmail is null))
            or
            ((not snapshotted_data.BCcEmail is null) and (source_data.BCcEmail is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.StatusMessage != source_data.StatusMessage
        or
        (
            ((snapshotted_data.StatusMessage is null) and not (source_data.StatusMessage is null))
            or
            ((not snapshotted_data.StatusMessage is null) and (source_data.StatusMessage is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.DetailType != source_data.DetailType
        or
        (
            ((snapshotted_data.DetailType is null) and not (source_data.DetailType is null))
            or
            ((not snapshotted_data.DetailType is null) and (source_data.DetailType is null))
        ) or snapshotted_data.ReplytoEmail != source_data.ReplytoEmail
        or
        (
            ((snapshotted_data.ReplytoEmail is null) and not (source_data.ReplytoEmail is null))
            or
            ((not snapshotted_data.ReplytoEmail is null) and (source_data.ReplytoEmail is null))
        ) or snapshotted_data.SEnderUserName != source_data.SEnderUserName
        or
        (
            ((snapshotted_data.SEnderUserName is null) and not (source_data.SEnderUserName is null))
            or
            ((not snapshotted_data.SEnderUserName is null) and (source_data.SEnderUserName is null))
        ) or snapshotted_data.ReceiverUserName != source_data.ReceiverUserName
        or
        (
            ((snapshotted_data.ReceiverUserName is null) and not (source_data.ReceiverUserName is null))
            or
            ((not snapshotted_data.ReceiverUserName is null) and (source_data.ReceiverUserName is null))
        ) or snapshotted_data.Template != source_data.Template
        or
        (
            ((snapshotted_data.Template is null) and not (source_data.Template is null))
            or
            ((not snapshotted_data.Template is null) and (source_data.Template is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Notifications_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Notifications_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Notifications_Incr__dbt_tmp_temp_view"
    end



    
21:27:57.324146 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 5.90 seconds
21:27:57.327800 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:27:57.328056 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:57.402861 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:27:57.404450 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:27:57.404694 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    
21:27:58.233258 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.83 seconds
21:27:58.234975 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:27:58.235213 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:27:58.326137 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:27:58.328648 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:27:58.328897 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:58.580457 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:27:58.584291 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:27:58.584542 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr'
      and table_schema = 'stg'
  
21:27:58.628001 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:27:58.631909 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:27:58.632168 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:58.722842 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:27:58.724464 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:27:58.724704 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    
21:27:59.939248 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 65.70 seconds
21:27:59.942941 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:27:59.943215 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:27:59.965442 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.24 seconds
21:27:59.966950 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:27:59.967170 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:27:59.993961 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:27:59.995401 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:27:59.995632 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediavariations_Incr__dbt_tmp"
    
21:28:00.010114 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:00.012280 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:28:00.012508 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:00.224221 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:28:00.227412 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:28:00.227685 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr'
      and table_schema = 'stg'
  
21:28:00.267204 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:00.271434 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:28:00.271670 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:00.311590 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:00.313105 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:28:00.313423 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    
21:28:01.568733 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.57 seconds
21:28:01.570380 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:28:01.570592 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:01.619738 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.31 seconds
21:28:01.621332 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:28:01.621513 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:01.645700 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:01.648692 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:28:01.648969 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:01.694562 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:01.698213 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:28:01.698477 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:01.874165 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:28:01.877129 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:28:01.877640 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr'
      and table_schema = 'stg'
  
21:28:01.927519 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:01.934896 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:28:01.935255 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:01.975831 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:01.977469 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:28:01.977741 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediavariations_Incr__dbt_tmp"
    
21:28:02.043707 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
21:28:02.045849 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_NewSalestoInvoice_Incr"
21:28:02.046521 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:28:02.046772 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr" (
                  "LineItemID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "LineItemID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:28:03.522149 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.54 seconds
21:28:03.523805 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:28:03.523984 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:03.628897 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:28:03.631499 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:28:03.631687 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:03.633461 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 140.56 seconds
21:28:03.636275 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:28:03.636456 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:03.688053 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:03.689787 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:28:03.690027 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    
21:28:03.848601 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.80 seconds
21:28:03.850407 [debug] [Thread-4  ]: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: COMMIT
21:28:03.851292 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:28:03.851486 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    end

21:28:03.895838 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:03.909095 [debug] [Thread-4  ]: finished collecting timing info
21:28:03.909445 [debug] [Thread-4  ]: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: Close
21:28:03.910155 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559861040>]}
21:28:03.910674 [info ] [Thread-4  ]: 69 of 101 OK snapshotted stg.AH_NewSalestoInvoice_Incr.......................... [[32mOK[0m in 13.08s]
21:28:03.911061 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_NewSalestoInvoice_Incr
21:28:03.911242 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Offers_Incr
21:28:03.911590 [info ] [Thread-4  ]: 71 of 101 START snapshot stg.AH_Offers_Incr..................................... [RUN]
21:28:03.911994 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Offers_Incr"
21:28:03.912144 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Offers_Incr
21:28:03.912276 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Offers_Incr
21:28:03.915001 [debug] [Thread-4  ]: finished collecting timing info
21:28:03.915192 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Offers_Incr
21:28:03.989960 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
21:28:03.992373 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:28:03.992609 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr'
      and table_schema = 'stg'
  
21:28:03.995224 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:03.995411 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:28:03.995527 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:28:03.995659 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:28:04.031714 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:04.035958 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:28:04.037779 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:04.083567 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:04.085085 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:28:04.085340 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediavariations_Incr__dbt_tmp"
    
21:28:04.127305 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:28:04.158804 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:28:04.181875 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:04.182205 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:28:04.225898 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:04.228096 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:04.228334 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Offers_InterView]
        ) as __dbt_sbq
    
21:28:04.327757 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:28:04.350346 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:04.350737 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Offers_Incr"
        ) as __dbt_sbq
    
21:28:04.413092 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:04.416819 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:04.417068 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr'
      and table_schema = 'stg'
  
21:28:04.497471 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:28:04.501290 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:04.501533 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
        
  
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Offers_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Offers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Offers_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Offers_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Offers_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Offers_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:04.200091'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:04.200091'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:28:04.200091''), CONVERT(DATETIME2, ''2022-09-18 21:28:04.200091'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:28:04.200091'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:04.200091'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:04.200091'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:28:04.200091'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.OfferMessage != source_data.OfferMessage
        or
        (
            ((snapshotted_data.OfferMessage is null) and not (source_data.OfferMessage is null))
            or
            ((not snapshotted_data.OfferMessage is null) and (source_data.OfferMessage is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.DecLineMessage != source_data.DecLineMessage
        or
        (
            ((snapshotted_data.DecLineMessage is null) and not (source_data.DecLineMessage is null))
            or
            ((not snapshotted_data.DecLineMessage is null) and (source_data.DecLineMessage is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Expirationdttm != source_data.Expirationdttm
        or
        (
            ((snapshotted_data.Expirationdttm is null) and not (source_data.Expirationdttm is null))
            or
            ((not snapshotted_data.Expirationdttm is null) and (source_data.Expirationdttm is null))
        ) or snapshotted_data.SEndingUserID != source_data.SEndingUserID
        or
        (
            ((snapshotted_data.SEndingUserID is null) and not (source_data.SEndingUserID is null))
            or
            ((not snapshotted_data.SEndingUserID is null) and (source_data.SEndingUserID is null))
        ) or snapshotted_data.ReceivINgUserID != source_data.ReceivINgUserID
        or
        (
            ((snapshotted_data.ReceivINgUserID is null) and not (source_data.ReceivINgUserID is null))
            or
            ((not snapshotted_data.ReceivINgUserID is null) and (source_data.ReceivINgUserID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.OfferMessage != source_data.OfferMessage
        or
        (
            ((snapshotted_data.OfferMessage is null) and not (source_data.OfferMessage is null))
            or
            ((not snapshotted_data.OfferMessage is null) and (source_data.OfferMessage is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.DecLineMessage != source_data.DecLineMessage
        or
        (
            ((snapshotted_data.DecLineMessage is null) and not (source_data.DecLineMessage is null))
            or
            ((not snapshotted_data.DecLineMessage is null) and (source_data.DecLineMessage is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Expirationdttm != source_data.Expirationdttm
        or
        (
            ((snapshotted_data.Expirationdttm is null) and not (source_data.Expirationdttm is null))
            or
            ((not snapshotted_data.Expirationdttm is null) and (source_data.Expirationdttm is null))
        ) or snapshotted_data.SEndingUserID != source_data.SEndingUserID
        or
        (
            ((snapshotted_data.SEndingUserID is null) and not (source_data.SEndingUserID is null))
            or
            ((not snapshotted_data.SEndingUserID is null) and (source_data.SEndingUserID is null))
        ) or snapshotted_data.ReceivINgUserID != source_data.ReceivINgUserID
        or
        (
            ((snapshotted_data.ReceivINgUserID is null) and not (source_data.ReceivINgUserID is null))
            or
            ((not snapshotted_data.ReceivINgUserID is null) and (source_data.ReceivINgUserID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Offers_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Offers_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Offers_Incr__dbt_tmp_temp_view"
    end



    
21:28:05.168333 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.48 seconds
21:28:05.169958 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:28:05.170151 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:05.238278 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:05.241000 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:28:05.241291 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:05.325402 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.24 seconds
21:28:05.327116 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:28:05.327383 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:05.373951 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:05.376605 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:28:05.376869 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:05.479880 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:28:05.483096 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:28:05.483373 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr'
      and table_schema = 'stg'
  
21:28:05.558520 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:05.562587 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:28:05.562880 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:05.591483 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:28:05.593540 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Mediavariations_Incr"
21:28:05.594062 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:28:05.594230 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Mediavariations_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaassetID", "MediaID", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaassetID", "MediaID", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Mediavariations_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:28:05.611746 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:05.613343 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:28:05.613592 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    
21:28:07.007984 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.39 seconds
21:28:07.010126 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:28:07.010323 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:07.050105 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:07.052750 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:28:07.052986 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:07.456562 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.86 seconds
21:28:07.458913 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Mediavariations_Incr: COMMIT
21:28:07.459892 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:28:07.460101 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."#AH_Mediavariations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Mediavariations_Incr__dbt_tmp"
    end

21:28:07.496475 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:07.511288 [debug] [Thread-3  ]: finished collecting timing info
21:28:07.511728 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Mediavariations_Incr: Close
21:28:07.512559 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5598696d0>]}
21:28:07.513126 [info ] [Thread-3  ]: 67 of 101 OK snapshotted stg.AH_Mediavariations_Incr............................ [[32mOK[0m in 73.94s]
21:28:07.513531 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Mediavariations_Incr
21:28:07.513715 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_PaymentConfigurationTable_Incr
21:28:07.514076 [info ] [Thread-3  ]: 72 of 101 START snapshot stg.AH_PaymentConfigurationTable_Incr.................. [RUN]
21:28:07.514495 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr"
21:28:07.514689 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_PaymentConfigurationTable_Incr
21:28:07.514830 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_PaymentConfigurationTable_Incr
21:28:07.517711 [debug] [Thread-3  ]: finished collecting timing info
21:28:07.517909 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_PaymentConfigurationTable_Incr
21:28:07.520875 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:07.521068 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:28:07.521189 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:28:07.521321 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:28:07.635322 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:28:07.673330 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:28:07.696297 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:07.696733 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:28:07.724427 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:28:07.726797 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:07.727447 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_PaymentConfigurationTable_InterView]
        ) as __dbt_sbq
    
21:28:07.785156 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:07.807701 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:07.808112 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr"
        ) as __dbt_sbq
    
21:28:07.863306 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:07.867044 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:07.867363 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr'
      and table_schema = 'stg'
  
21:28:07.907401 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.85 seconds
21:28:07.910726 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:28:07.911041 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr'
      and table_schema = 'stg'
  
21:28:07.937583 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:07.942171 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:07.942466 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
        
  
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_PaymentConfigurationTable_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:07.700089'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:07.700089'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:28:07.700089''), CONVERT(DATETIME2, ''2022-09-18 21:28:07.700089'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:28:07.700089'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:07.700089'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:07.700089'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:28:07.700089'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Active != source_data.Active
        or
        (
            ((snapshotted_data.Active is null) and not (source_data.Active is null))
            or
            ((not snapshotted_data.Active is null) and (source_data.Active is null))
        ) or snapshotted_data.MinimumBidHold != source_data.MinimumBidHold
        or
        (
            ((snapshotted_data.MinimumBidHold is null) and not (source_data.MinimumBidHold is null))
            or
            ((not snapshotted_data.MinimumBidHold is null) and (source_data.MinimumBidHold is null))
        ) or snapshotted_data.BasicplanPrice != source_data.BasicplanPrice
        or
        (
            ((snapshotted_data.BasicplanPrice is null) and not (source_data.BasicplanPrice is null))
            or
            ((not snapshotted_data.BasicplanPrice is null) and (source_data.BasicplanPrice is null))
        ) or snapshotted_data.ProPhotographyPrice != source_data.ProPhotographyPrice
        or
        (
            ((snapshotted_data.ProPhotographyPrice is null) and not (source_data.ProPhotographyPrice is null))
            or
            ((not snapshotted_data.ProPhotographyPrice is null) and (source_data.ProPhotographyPrice is null))
        ) or snapshotted_data.ProMarketingPrice != source_data.ProMarketingPrice
        or
        (
            ((snapshotted_data.ProMarketingPrice is null) and not (source_data.ProMarketingPrice is null))
            or
            ((not snapshotted_data.ProMarketingPrice is null) and (source_data.ProMarketingPrice is null))
        ) or snapshotted_data.Minfraudscore != source_data.Minfraudscore
        or
        (
            ((snapshotted_data.Minfraudscore is null) and not (source_data.Minfraudscore is null))
            or
            ((not snapshotted_data.Minfraudscore is null) and (source_data.Minfraudscore is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.MaximumBidCharge != source_data.MaximumBidCharge
        or
        (
            ((snapshotted_data.MaximumBidCharge is null) and not (source_data.MaximumBidCharge is null))
            or
            ((not snapshotted_data.MaximumBidCharge is null) and (source_data.MaximumBidCharge is null))
        ) or snapshotted_data.BidHoldPercentage != source_data.BidHoldPercentage
        or
        (
            ((snapshotted_data.BidHoldPercentage is null) and not (source_data.BidHoldPercentage is null))
            or
            ((not snapshotted_data.BidHoldPercentage is null) and (source_data.BidHoldPercentage is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Active != source_data.Active
        or
        (
            ((snapshotted_data.Active is null) and not (source_data.Active is null))
            or
            ((not snapshotted_data.Active is null) and (source_data.Active is null))
        ) or snapshotted_data.MinimumBidHold != source_data.MinimumBidHold
        or
        (
            ((snapshotted_data.MinimumBidHold is null) and not (source_data.MinimumBidHold is null))
            or
            ((not snapshotted_data.MinimumBidHold is null) and (source_data.MinimumBidHold is null))
        ) or snapshotted_data.BasicplanPrice != source_data.BasicplanPrice
        or
        (
            ((snapshotted_data.BasicplanPrice is null) and not (source_data.BasicplanPrice is null))
            or
            ((not snapshotted_data.BasicplanPrice is null) and (source_data.BasicplanPrice is null))
        ) or snapshotted_data.ProPhotographyPrice != source_data.ProPhotographyPrice
        or
        (
            ((snapshotted_data.ProPhotographyPrice is null) and not (source_data.ProPhotographyPrice is null))
            or
            ((not snapshotted_data.ProPhotographyPrice is null) and (source_data.ProPhotographyPrice is null))
        ) or snapshotted_data.ProMarketingPrice != source_data.ProMarketingPrice
        or
        (
            ((snapshotted_data.ProMarketingPrice is null) and not (source_data.ProMarketingPrice is null))
            or
            ((not snapshotted_data.ProMarketingPrice is null) and (source_data.ProMarketingPrice is null))
        ) or snapshotted_data.Minfraudscore != source_data.Minfraudscore
        or
        (
            ((snapshotted_data.Minfraudscore is null) and not (source_data.Minfraudscore is null))
            or
            ((not snapshotted_data.Minfraudscore is null) and (source_data.Minfraudscore is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.MaximumBidCharge != source_data.MaximumBidCharge
        or
        (
            ((snapshotted_data.MaximumBidCharge is null) and not (source_data.MaximumBidCharge is null))
            or
            ((not snapshotted_data.MaximumBidCharge is null) and (source_data.MaximumBidCharge is null))
        ) or snapshotted_data.BidHoldPercentage != source_data.BidHoldPercentage
        or
        (
            ((snapshotted_data.BidHoldPercentage is null) and not (source_data.BidHoldPercentage is null))
            or
            ((not snapshotted_data.BidHoldPercentage is null) and (source_data.BidHoldPercentage is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view"
    end



    
21:28:07.945371 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:28:07.949204 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:28:07.949398 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:07.987611 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:07.989503 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:28:07.989782 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    
21:28:09.550213 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.56 seconds
21:28:09.551864 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:28:09.552049 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:09.587900 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:09.590428 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:28:09.590795 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:10.053882 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.46 seconds
21:28:10.056157 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_MediaMetaData_Incr"
21:28:10.056780 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:28:10.056971 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_MediaMetaData_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr" (
                  "ID", "Name", "Value", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Value", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_MediaMetaData_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:28:11.950336 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.89 seconds
21:28:11.952083 [debug] [Thread-2  ]: On snapshot.Shawn.AH_MediaMetaData_Incr: COMMIT
21:28:11.952858 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:28:11.953030 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."#AH_MediaMetaData_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    end

21:28:12.009955 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:12.023596 [debug] [Thread-2  ]: finished collecting timing info
21:28:12.024008 [debug] [Thread-2  ]: On snapshot.Shawn.AH_MediaMetaData_Incr: Close
21:28:12.024820 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559869040>]}
21:28:12.025328 [info ] [Thread-2  ]: 63 of 101 OK snapshotted stg.AH_MediaMetaData_Incr.............................. [[32mOK[0m in 149.59s]
21:28:12.025707 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_MediaMetaData_Incr
21:28:12.025890 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_PaymentResponses_Incr
21:28:12.026260 [info ] [Thread-2  ]: 73 of 101 START snapshot stg.AH_PaymentResponses_Incr........................... [RUN]
21:28:12.026705 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr"
21:28:12.026866 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_PaymentResponses_Incr
21:28:12.027000 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_PaymentResponses_Incr
21:28:12.029896 [debug] [Thread-2  ]: finished collecting timing info
21:28:12.030096 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_PaymentResponses_Incr
21:28:12.033099 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:12.033287 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:28:12.033410 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:28:12.033542 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:28:12.142750 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:28:12.189105 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:28:12.212323 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:12.212721 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:28:12.242368 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:28:12.245015 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:12.245358 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_PaymentResponses_InterView]
        ) as __dbt_sbq
    
21:28:12.313497 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:12.336508 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:12.336906 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr"
        ) as __dbt_sbq
    
21:28:12.386672 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:12.391582 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:12.391929 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr'
      and table_schema = 'stg'
  
21:28:12.469665 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:28:12.473963 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:12.474297 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
        
  
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentResponses_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_PaymentResponses_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_PaymentResponses_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_PaymentResponses_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:12.215777'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:12.215777'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:28:12.215777''), CONVERT(DATETIME2, ''2022-09-18 21:28:12.215777'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:28:12.215777'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:12.215777'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:12.215777'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:28:12.215777'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Approved != source_data.Approved
        or
        (
            ((snapshotted_data.Approved is null) and not (source_data.Approved is null))
            or
            ((not snapshotted_data.Approved is null) and (source_data.Approved is null))
        ) or snapshotted_data.InvoiceID != source_data.InvoiceID
        or
        (
            ((snapshotted_data.InvoiceID is null) and not (source_data.InvoiceID is null))
            or
            ((not snapshotted_data.InvoiceID is null) and (source_data.InvoiceID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.AuthorizationCode != source_data.AuthorizationCode
        or
        (
            ((snapshotted_data.AuthorizationCode is null) and not (source_data.AuthorizationCode is null))
            or
            ((not snapshotted_data.AuthorizationCode is null) and (source_data.AuthorizationCode is null))
        ) or snapshotted_data.AvsResponseCode != source_data.AvsResponseCode
        or
        (
            ((snapshotted_data.AvsResponseCode is null) and not (source_data.AvsResponseCode is null))
            or
            ((not snapshotted_data.AvsResponseCode is null) and (source_data.AvsResponseCode is null))
        ) or snapshotted_data.Cvv2ResponseCode != source_data.Cvv2ResponseCode
        or
        (
            ((snapshotted_data.Cvv2ResponseCode is null) and not (source_data.Cvv2ResponseCode is null))
            or
            ((not snapshotted_data.Cvv2ResponseCode is null) and (source_data.Cvv2ResponseCode is null))
        ) or snapshotted_data.CavResponseCode != source_data.CavResponseCode
        or
        (
            ((snapshotted_data.CavResponseCode is null) and not (source_data.CavResponseCode is null))
            or
            ((not snapshotted_data.CavResponseCode is null) and (source_data.CavResponseCode is null))
        ) or snapshotted_data.BuyerStreet != source_data.BuyerStreet
        or
        (
            ((snapshotted_data.BuyerStreet is null) and not (source_data.BuyerStreet is null))
            or
            ((not snapshotted_data.BuyerStreet is null) and (source_data.BuyerStreet is null))
        ) or snapshotted_data.BuyerCity != source_data.BuyerCity
        or
        (
            ((snapshotted_data.BuyerCity is null) and not (source_data.BuyerCity is null))
            or
            ((not snapshotted_data.BuyerCity is null) and (source_data.BuyerCity is null))
        ) or snapshotted_data.ResponseStatus != source_data.ResponseStatus
        or
        (
            ((snapshotted_data.ResponseStatus is null) and not (source_data.ResponseStatus is null))
            or
            ((not snapshotted_data.ResponseStatus is null) and (source_data.ResponseStatus is null))
        ) or snapshotted_data.ProvIDEr != source_data.ProvIDEr
        or
        (
            ((snapshotted_data.ProvIDEr is null) and not (source_data.ProvIDEr is null))
            or
            ((not snapshotted_data.ProvIDEr is null) and (source_data.ProvIDEr is null))
        ) or snapshotted_data.RawResponseCode != source_data.RawResponseCode
        or
        (
            ((snapshotted_data.RawResponseCode is null) and not (source_data.RawResponseCode is null))
            or
            ((not snapshotted_data.RawResponseCode is null) and (source_data.RawResponseCode is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Method != source_data.Method
        or
        (
            ((snapshotted_data.Method is null) and not (source_data.Method is null))
            or
            ((not snapshotted_data.Method is null) and (source_data.Method is null))
        ) or snapshotted_data.BuyerStateregion != source_data.BuyerStateregion
        or
        (
            ((snapshotted_data.BuyerStateregion is null) and not (source_data.BuyerStateregion is null))
            or
            ((not snapshotted_data.BuyerStateregion is null) and (source_data.BuyerStateregion is null))
        ) or snapshotted_data.BuyerzipPostal != source_data.BuyerzipPostal
        or
        (
            ((snapshotted_data.BuyerzipPostal is null) and not (source_data.BuyerzipPostal is null))
            or
            ((not snapshotted_data.BuyerzipPostal is null) and (source_data.BuyerzipPostal is null))
        ) or snapshotted_data.BuyerEmail != source_data.BuyerEmail
        or
        (
            ((snapshotted_data.BuyerEmail is null) and not (source_data.BuyerEmail is null))
            or
            ((not snapshotted_data.BuyerEmail is null) and (source_data.BuyerEmail is null))
        ) or snapshotted_data.AllFields != source_data.AllFields
        or
        (
            ((snapshotted_data.AllFields is null) and not (source_data.AllFields is null))
            or
            ((not snapshotted_data.AllFields is null) and (source_data.AllFields is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Approved != source_data.Approved
        or
        (
            ((snapshotted_data.Approved is null) and not (source_data.Approved is null))
            or
            ((not snapshotted_data.Approved is null) and (source_data.Approved is null))
        ) or snapshotted_data.InvoiceID != source_data.InvoiceID
        or
        (
            ((snapshotted_data.InvoiceID is null) and not (source_data.InvoiceID is null))
            or
            ((not snapshotted_data.InvoiceID is null) and (source_data.InvoiceID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.AuthorizationCode != source_data.AuthorizationCode
        or
        (
            ((snapshotted_data.AuthorizationCode is null) and not (source_data.AuthorizationCode is null))
            or
            ((not snapshotted_data.AuthorizationCode is null) and (source_data.AuthorizationCode is null))
        ) or snapshotted_data.AvsResponseCode != source_data.AvsResponseCode
        or
        (
            ((snapshotted_data.AvsResponseCode is null) and not (source_data.AvsResponseCode is null))
            or
            ((not snapshotted_data.AvsResponseCode is null) and (source_data.AvsResponseCode is null))
        ) or snapshotted_data.Cvv2ResponseCode != source_data.Cvv2ResponseCode
        or
        (
            ((snapshotted_data.Cvv2ResponseCode is null) and not (source_data.Cvv2ResponseCode is null))
            or
            ((not snapshotted_data.Cvv2ResponseCode is null) and (source_data.Cvv2ResponseCode is null))
        ) or snapshotted_data.CavResponseCode != source_data.CavResponseCode
        or
        (
            ((snapshotted_data.CavResponseCode is null) and not (source_data.CavResponseCode is null))
            or
            ((not snapshotted_data.CavResponseCode is null) and (source_data.CavResponseCode is null))
        ) or snapshotted_data.BuyerStreet != source_data.BuyerStreet
        or
        (
            ((snapshotted_data.BuyerStreet is null) and not (source_data.BuyerStreet is null))
            or
            ((not snapshotted_data.BuyerStreet is null) and (source_data.BuyerStreet is null))
        ) or snapshotted_data.BuyerCity != source_data.BuyerCity
        or
        (
            ((snapshotted_data.BuyerCity is null) and not (source_data.BuyerCity is null))
            or
            ((not snapshotted_data.BuyerCity is null) and (source_data.BuyerCity is null))
        ) or snapshotted_data.ResponseStatus != source_data.ResponseStatus
        or
        (
            ((snapshotted_data.ResponseStatus is null) and not (source_data.ResponseStatus is null))
            or
            ((not snapshotted_data.ResponseStatus is null) and (source_data.ResponseStatus is null))
        ) or snapshotted_data.ProvIDEr != source_data.ProvIDEr
        or
        (
            ((snapshotted_data.ProvIDEr is null) and not (source_data.ProvIDEr is null))
            or
            ((not snapshotted_data.ProvIDEr is null) and (source_data.ProvIDEr is null))
        ) or snapshotted_data.RawResponseCode != source_data.RawResponseCode
        or
        (
            ((snapshotted_data.RawResponseCode is null) and not (source_data.RawResponseCode is null))
            or
            ((not snapshotted_data.RawResponseCode is null) and (source_data.RawResponseCode is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Method != source_data.Method
        or
        (
            ((snapshotted_data.Method is null) and not (source_data.Method is null))
            or
            ((not snapshotted_data.Method is null) and (source_data.Method is null))
        ) or snapshotted_data.BuyerStateregion != source_data.BuyerStateregion
        or
        (
            ((snapshotted_data.BuyerStateregion is null) and not (source_data.BuyerStateregion is null))
            or
            ((not snapshotted_data.BuyerStateregion is null) and (source_data.BuyerStateregion is null))
        ) or snapshotted_data.BuyerzipPostal != source_data.BuyerzipPostal
        or
        (
            ((snapshotted_data.BuyerzipPostal is null) and not (source_data.BuyerzipPostal is null))
            or
            ((not snapshotted_data.BuyerzipPostal is null) and (source_data.BuyerzipPostal is null))
        ) or snapshotted_data.BuyerEmail != source_data.BuyerEmail
        or
        (
            ((snapshotted_data.BuyerEmail is null) and not (source_data.BuyerEmail is null))
            or
            ((not snapshotted_data.BuyerEmail is null) and (source_data.BuyerEmail is null))
        ) or snapshotted_data.AllFields != source_data.AllFields
        or
        (
            ((snapshotted_data.AllFields is null) and not (source_data.AllFields is null))
            or
            ((not snapshotted_data.AllFields is null) and (source_data.AllFields is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_PaymentResponses_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentResponses_Incr__dbt_tmp_temp_view"
    end



    
21:28:17.968620 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 13.47 seconds
21:28:17.972214 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:17.972430 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:18.010856 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:18.012492 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:18.012755 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Offers_Incr__dbt_tmp"
    
21:28:19.487437 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.47 seconds
21:28:19.489171 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:19.489400 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:19.564167 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:19.566962 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:19.567156 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:19.789040 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 11.85 seconds
21:28:19.792553 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:19.792755 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:19.825584 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:28:19.828829 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:19.829087 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr'
      and table_schema = 'stg'
  
21:28:19.847092 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:19.848706 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:19.848960 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    
21:28:19.865896 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:19.870428 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:19.870779 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:19.908799 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:19.910426 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:19.910694 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Offers_Incr__dbt_tmp"
    
21:28:20.756762 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.91 seconds
21:28:20.758413 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:20.758636 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:20.845034 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:28:20.847731 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:20.847919 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:21.100148 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:28:21.103398 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:21.103647 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr'
      and table_schema = 'stg'
  
21:28:21.142461 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:21.146820 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:21.147076 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:21.202630 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:21.204488 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:21.204742 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    
21:28:21.394033 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 24.21 seconds
21:28:21.400001 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:28:21.400364 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:21.453388 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:21.454999 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:28:21.455270 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Notifications_Incr__dbt_tmp"
    
21:28:21.456418 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.55 seconds
21:28:21.457607 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:21.457800 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:21.496169 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:21.499054 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:21.499308 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:21.747128 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:28:21.750072 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:21.750455 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr'
      and table_schema = 'stg'
  
21:28:21.795192 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:21.800002 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:21.800266 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:21.837595 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:21.839277 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:21.839518 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Offers_Incr__dbt_tmp"
    
21:28:22.293189 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.09 seconds
21:28:22.295016 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:22.295291 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:22.343523 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:22.346394 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:22.346687 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:22.537489 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:28:22.540752 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:22.541024 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr'
      and table_schema = 'stg'
  
21:28:22.575733 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:28:22.580423 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:22.580764 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:22.622399 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:22.623994 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:22.624221 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    
21:28:23.003171 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
21:28:23.004941 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:23.005208 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:23.019169 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.56 seconds
21:28:23.020800 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:28:23.021040 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:23.048238 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:23.051130 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:23.051427 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:23.102294 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:28:23.106174 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:28:23.106517 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:23.299037 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:28:23.301533 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Offers_Incr"
21:28:23.302125 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:23.302310 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Offers_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Offers_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Offers_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Offers_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Offers_Incr" (
                  "ID", "Amount", "LastUpdatedUser", "OfferMessage", "Status", "DecLineMessage", "CreatedOn", "UpdatedOn", "DeletedOn", "Expirationdttm", "SEndingUserID", "ReceivINgUserID", "BuyerID", "Quantity", "ListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Amount", "LastUpdatedUser", "OfferMessage", "Status", "DecLineMessage", "CreatedOn", "UpdatedOn", "DeletedOn", "Expirationdttm", "SEndingUserID", "ReceivINgUserID", "BuyerID", "Quantity", "ListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Offers_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:28:23.317492 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:28:23.320428 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:28:23.320688 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr'
      and table_schema = 'stg'
  
21:28:23.355744 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:28:23.360510 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:28:23.360777 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:23.406614 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:23.408394 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:28:23.408633 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Notifications_Incr__dbt_tmp"
    
21:28:23.574890 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
21:28:23.576604 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:23.576855 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:23.624880 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:23.627689 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:23.627945 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:23.857947 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:28:23.860320 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_PaymentConfigurationTable_Incr"
21:28:23.860915 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:23.861103 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr" (
                  "ID", "Active", "MinimumBidHold", "BasicplanPrice", "ProPhotographyPrice", "ProMarketingPrice", "Minfraudscore", "UpdatedOn", "CreatedOn", "MaximumBidCharge", "BidHoldPercentage", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Active", "MinimumBidHold", "BasicplanPrice", "ProPhotographyPrice", "ProMarketingPrice", "Minfraudscore", "UpdatedOn", "CreatedOn", "MaximumBidCharge", "BidHoldPercentage", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:28:24.988136 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.69 seconds
21:28:24.989844 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Offers_Incr: COMMIT
21:28:24.990514 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:28:24.990676 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."#AH_Offers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Offers_Incr__dbt_tmp"
    end

21:28:25.031770 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:25.046819 [debug] [Thread-4  ]: finished collecting timing info
21:28:25.047059 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.64 seconds
21:28:25.048488 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:28:25.048725 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:25.047325 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Offers_Incr: Close
21:28:25.049517 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559861190>]}
21:28:25.049997 [info ] [Thread-4  ]: 71 of 101 OK snapshotted stg.AH_Offers_Incr..................................... [[32mOK[0m in 21.14s]
21:28:25.050378 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Offers_Incr
21:28:25.050584 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_PaymentprovIDErs_Incr
21:28:25.050938 [info ] [Thread-4  ]: 74 of 101 START snapshot stg.AH_PaymentprovIDErs_Incr........................... [RUN]
21:28:25.051341 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr"
21:28:25.051489 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_PaymentprovIDErs_Incr
21:28:25.051619 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_PaymentprovIDErs_Incr
21:28:25.054495 [debug] [Thread-4  ]: finished collecting timing info
21:28:25.054711 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_PaymentprovIDErs_Incr
21:28:25.057392 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:25.057569 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:28:25.057688 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:28:25.057835 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:28:25.088470 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:25.091740 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:28:25.092408 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:25.199661 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:28:25.231930 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:28:25.254408 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:25.254810 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:28:25.284889 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.42 seconds
21:28:25.286690 [debug] [Thread-3  ]: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: COMMIT
21:28:25.287541 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:28:25.287739 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    end

21:28:25.291698 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:25.293456 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:25.293648 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_PaymentprovIDErs_InterView]
        ) as __dbt_sbq
    
21:28:25.326904 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:25.341240 [debug] [Thread-3  ]: finished collecting timing info
21:28:25.341650 [debug] [Thread-3  ]: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: Close
21:28:25.342422 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559869eb0>]}
21:28:25.342972 [info ] [Thread-3  ]: 72 of 101 OK snapshotted stg.AH_PaymentConfigurationTable_Incr.................. [[32mOK[0m in 17.83s]
21:28:25.343364 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_PaymentConfigurationTable_Incr
21:28:25.343541 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Properties_Incr
21:28:25.343891 [info ] [Thread-3  ]: 75 of 101 START snapshot stg.AH_Properties_Incr................................. [RUN]
21:28:25.344302 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Properties_Incr"
21:28:25.344451 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Properties_Incr
21:28:25.344586 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Properties_Incr
21:28:25.347438 [debug] [Thread-3  ]: finished collecting timing info
21:28:25.347632 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Properties_Incr
21:28:25.350307 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:25.350481 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:28:25.350625 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:28:25.350760 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:28:25.362775 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:28:25.365227 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:28:25.365428 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr'
      and table_schema = 'stg'
  
21:28:25.383364 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:28:25.404628 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:25.410289 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:28:25.412480 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:25.412185 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:25.412796 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr"
        ) as __dbt_sbq
    
21:28:25.452270 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:25.453864 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:28:25.454162 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Notifications_Incr__dbt_tmp"
    
21:28:25.458746 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:25.462135 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:25.462357 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr'
      and table_schema = 'stg'
  
21:28:25.470720 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:28:25.498665 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:28:25.520910 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:25.521284 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:28:25.531100 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:25.534308 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:25.534657 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
        
  
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_PaymentprovIDErs_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:25.262894'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:25.262894'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:28:25.262894''), CONVERT(DATETIME2, ''2022-09-18 21:28:25.262894'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:28:25.262894'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:25.262894'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:25.262894'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:28:25.262894'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.Batchcapable != source_data.Batchcapable
        or
        (
            ((snapshotted_data.Batchcapable is null) and not (source_data.Batchcapable is null))
            or
            ((not snapshotted_data.Batchcapable is null) and (source_data.Batchcapable is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.Batchcapable != source_data.Batchcapable
        or
        (
            ((snapshotted_data.Batchcapable is null) and not (source_data.Batchcapable is null))
            or
            ((not snapshotted_data.Batchcapable is null) and (source_data.Batchcapable is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view"
    end



    
21:28:25.550577 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:28:25.553025 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:25.553279 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Properties_InterView]
        ) as __dbt_sbq
    
21:28:25.606645 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:25.629098 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:25.629474 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Properties_Incr"
        ) as __dbt_sbq
    
21:28:25.679533 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:25.684582 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:25.684887 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr'
      and table_schema = 'stg'
  
21:28:25.757984 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:25.761839 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:25.762131 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
        
  
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Properties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Properties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Properties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Properties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Properties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Properties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:25.528469'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:25.528469'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:28:25.528469''), CONVERT(DATETIME2, ''2022-09-18 21:28:25.528469'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:28:25.528469'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:25.528469'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:25.528469'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:28:25.528469'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LineItemID != source_data.LineItemID
        or
        (
            ((snapshotted_data.LineItemID is null) and not (source_data.LineItemID is null))
            or
            ((not snapshotted_data.LineItemID is null) and (source_data.LineItemID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LineItemID != source_data.LineItemID
        or
        (
            ((snapshotted_data.LineItemID is null) and not (source_data.LineItemID is null))
            or
            ((not snapshotted_data.LineItemID is null) and (source_data.LineItemID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Properties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Properties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Properties_Incr__dbt_tmp_temp_view"
    end



    
21:28:26.415573 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
21:28:26.417455 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:28:26.417702 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:26.453460 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:26.456398 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:28:26.456652 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:26.687129 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:28:26.689555 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Notifications_Incr"
21:28:26.689995 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:28:26.690143 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Notifications_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Notifications_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Notifications_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Notifications_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Notifications_Incr" (
                  "ID", "DetailID", "CreatedOn", "UpdatedOn", "DeletedOn", "Queueddttm", "Statusdttm", "RecipientEmail", "CcEmail", "BCcEmail", "LastUpdatedUser", "Status", "StatusMessage", "Message", "DetailType", "ReplytoEmail", "SEnderUserName", "ReceiverUserName", "Template", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DetailID", "CreatedOn", "UpdatedOn", "DeletedOn", "Queueddttm", "Statusdttm", "RecipientEmail", "CcEmail", "BCcEmail", "LastUpdatedUser", "Status", "StatusMessage", "Message", "DetailType", "ReplytoEmail", "SEnderUserName", "ReceiverUserName", "Template", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Notifications_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:28:28.421907 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.73 seconds
21:28:28.423756 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Notifications_Incr: COMMIT
21:28:28.425014 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:28:28.425217 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."#AH_Notifications_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Notifications_Incr__dbt_tmp"
    end

21:28:28.464673 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:28.478099 [debug] [Thread-1  ]: finished collecting timing info
21:28:28.478487 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Notifications_Incr: Close
21:28:28.479267 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5584a7a00>]}
21:28:28.479763 [info ] [Thread-1  ]: 70 of 101 OK snapshotted stg.AH_Notifications_Incr.............................. [[32mOK[0m in 31.93s]
21:28:28.480144 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Notifications_Incr
21:28:28.480325 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_PropertybagItems_Incr
21:28:28.480673 [info ] [Thread-1  ]: 76 of 101 START snapshot stg.AH_PropertybagItems_Incr........................... [RUN]
21:28:28.481094 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr"
21:28:28.481242 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_PropertybagItems_Incr
21:28:28.481375 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_PropertybagItems_Incr
21:28:28.484138 [debug] [Thread-1  ]: finished collecting timing info
21:28:28.484394 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_PropertybagItems_Incr
21:28:28.487100 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:28.487277 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:28:28.487403 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:28:28.487534 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:28:28.610052 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:28:28.652261 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:28:28.675711 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:28.676076 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:28:28.712229 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:28.714450 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:28.715061 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_PropertybagItems_InterView]
        ) as __dbt_sbq
    
21:28:28.929331 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:28:28.951970 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:28.952343 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr"
        ) as __dbt_sbq
    
21:28:29.036133 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:28:29.039730 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:29.039971 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr'
      and table_schema = 'stg'
  
21:28:29.132869 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:28:29.136851 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:29.137114 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
        
  
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PropertybagItems_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_PropertybagItems_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_PropertybagItems_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_PropertybagItems_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:28.684766'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:28.684766'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:28:28.684766''), CONVERT(DATETIME2, ''2022-09-18 21:28:28.684766'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:28:28.684766'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:28.684766'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:28.684766'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:28:28.684766'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PropertybagID != source_data.PropertybagID
        or
        (
            ((snapshotted_data.PropertybagID is null) and not (source_data.PropertybagID is null))
            or
            ((not snapshotted_data.PropertybagID is null) and (source_data.PropertybagID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PropertybagID != source_data.PropertybagID
        or
        (
            ((snapshotted_data.PropertybagID is null) and not (source_data.PropertybagID is null))
            or
            ((not snapshotted_data.PropertybagID is null) and (source_data.PropertybagID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_PropertybagItems_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PropertybagItems_Incr__dbt_tmp_temp_view"
    end



    
21:28:30.695629 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 18.22 seconds
21:28:30.699453 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:30.699789 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:30.747435 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:30.749100 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:30.749356 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    
21:28:32.024204 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.27 seconds
21:28:32.025848 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:32.026035 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:32.115687 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:28:32.118672 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:32.118933 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:32.354243 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.59 seconds
21:28:32.358189 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:32.354753 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 6.82 seconds
21:28:32.361519 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:32.361772 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:32.358517 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:32.404345 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:32.405998 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:32.406258 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Properties_Incr__dbt_tmp"
    
21:28:32.411226 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:32.412723 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:32.412966 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    
21:28:32.490844 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.37 seconds
21:28:32.494038 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:32.494349 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr'
      and table_schema = 'stg'
  
21:28:32.551004 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:32.555735 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:32.556076 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:32.616419 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:32.618085 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:32.618351 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    
21:28:33.908923 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.50 seconds
21:28:33.910829 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:33.911130 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:33.928937 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.52 seconds
21:28:33.930802 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:33.931098 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:34.001519 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:34.006161 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:34.006507 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:34.026527 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:28:34.029272 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:34.029562 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:34.127823 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.51 seconds
21:28:34.129568 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:34.129821 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:34.210098 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:28:34.213368 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:34.213676 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr'
      and table_schema = 'stg'
  
21:28:34.223278 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:28:34.226417 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:34.226743 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:34.288257 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:34.292346 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:34.292660 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:34.332273 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:34.333926 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:34.334186 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    
21:28:34.387865 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
21:28:34.391016 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:34.391316 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr'
      and table_schema = 'stg'
  
21:28:34.461272 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:34.465679 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:34.466029 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:34.466729 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:28:34.469168 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:34.469388 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr'
      and table_schema = 'stg'
  
21:28:34.513895 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:34.515587 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:34.515885 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Properties_Incr__dbt_tmp"
    
21:28:34.567043 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:28:34.572648 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:34.573031 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:34.640298 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:34.641964 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:34.642229 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    
21:28:35.656539 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.52 seconds
21:28:35.660067 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:35.660334 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:35.707421 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:35.709091 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:35.709355 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    
21:28:35.716168 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
21:28:35.717737 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:35.717950 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:35.785950 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:35.788455 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:35.788713 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:35.923205 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.41 seconds
21:28:35.924689 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:35.924863 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:35.965020 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:35.968019 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:35.968319 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:36.153612 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:28:36.156449 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:36.156704 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr'
      and table_schema = 'stg'
  
21:28:36.157190 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.51 seconds
21:28:36.159060 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:36.159296 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:36.199629 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:36.202802 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:36.203041 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:36.203229 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:36.207309 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:36.207827 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:36.254139 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:36.256111 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:36.256405 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Properties_Incr__dbt_tmp"
    
21:28:36.345806 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.56 seconds
21:28:36.349092 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:36.349431 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr'
      and table_schema = 'stg'
  
21:28:36.390904 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:36.397635 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:36.398002 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:36.434590 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:36.436244 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:36.436509 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    
21:28:36.456646 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:28:36.459395 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_PaymentResponses_Incr"
21:28:36.460006 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:36.460214 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_PaymentResponses_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr" (
                  "ID", "Approved", "InvoiceID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Amount", "AuthorizationCode", "AvsResponseCode", "Cvv2ResponseCode", "CavResponseCode", "BuyerStreet", "BuyerCity", "ResponseStatus", "ProvIDEr", "RawResponseCode", "Description", "TransactionID", "Method", "BuyerStateregion", "BuyerzipPostal", "BuyerEmail", "AllFields", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Approved", "InvoiceID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Amount", "AuthorizationCode", "AvsResponseCode", "Cvv2ResponseCode", "CavResponseCode", "BuyerStreet", "BuyerCity", "ResponseStatus", "ProvIDEr", "RawResponseCode", "Description", "TransactionID", "Method", "BuyerStateregion", "BuyerzipPostal", "BuyerEmail", "AllFields", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_PaymentResponses_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:28:36.787402 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.08 seconds
21:28:36.789066 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:36.789267 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:36.859926 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:36.862671 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:36.862945 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:37.173884 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.92 seconds
21:28:37.175586 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:37.175810 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:37.225211 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
21:28:37.228658 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:37.228983 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr'
      and table_schema = 'stg'
  
21:28:37.230235 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:37.232364 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:37.232571 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:37.305326 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:28:37.309889 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:37.310218 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:37.361849 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:37.363993 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:37.364285 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    
21:28:37.397321 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
21:28:37.399143 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:37.399423 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:37.435786 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:37.438857 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:37.439184 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:37.460971 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:28:37.463286 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Properties_Incr"
21:28:37.463853 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:37.464028 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Properties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Properties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Properties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Properties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Properties_Incr" (
                  "ID", "Value", "Name", "CreatedOn", "UpdatedOn", "DeletedOn", "LineItemID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Value", "Name", "CreatedOn", "UpdatedOn", "DeletedOn", "LineItemID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Properties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:28:37.652722 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:28:37.655057 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_PaymentprovIDErs_Incr"
21:28:37.655680 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:37.655869 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr" (
                  "ID", "Name", "LastUpdatedUser", "DeletedOn", "CreatedOn", "UpdatedOn", "Batchcapable", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "LastUpdatedUser", "DeletedOn", "CreatedOn", "UpdatedOn", "Batchcapable", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:28:38.074723 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.61 seconds
21:28:38.076627 [debug] [Thread-2  ]: On snapshot.Shawn.AH_PaymentResponses_Incr: COMMIT
21:28:38.077625 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:28:38.077840 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."#AH_PaymentResponses_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    end

21:28:38.142143 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:38.156748 [debug] [Thread-2  ]: finished collecting timing info
21:28:38.157186 [debug] [Thread-2  ]: On snapshot.Shawn.AH_PaymentResponses_Incr: Close
21:28:38.157994 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559869970>]}
21:28:38.158525 [info ] [Thread-2  ]: 73 of 101 OK snapshotted stg.AH_PaymentResponses_Incr........................... [[32mOK[0m in 26.13s]
21:28:38.158970 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_PaymentResponses_Incr
21:28:38.159161 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Propertybags_Incr
21:28:38.159542 [info ] [Thread-2  ]: 77 of 101 START snapshot stg.AH_Propertybags_Incr............................... [RUN]
21:28:38.159987 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Propertybags_Incr"
21:28:38.160144 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Propertybags_Incr
21:28:38.160285 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Propertybags_Incr
21:28:38.163283 [debug] [Thread-2  ]: finished collecting timing info
21:28:38.163492 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Propertybags_Incr
21:28:38.166458 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:38.166728 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:28:38.166860 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:28:38.166998 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:28:38.285963 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.92 seconds
21:28:38.287784 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:38.288064 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:38.288469 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:28:38.315890 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:28:38.336004 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:38.338469 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:38.338810 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:38.342080 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:38.342323 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:28:38.372526 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:28:38.374862 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:38.375146 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Propertybags_InterView]
        ) as __dbt_sbq
    
21:28:38.428750 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:38.450987 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:38.451399 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr"
        ) as __dbt_sbq
    
21:28:38.516648 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:38.520227 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:38.520480 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr'
      and table_schema = 'stg'
  
21:28:38.589063 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:38.592685 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:38.593036 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
        
  
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Propertybags_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Propertybags_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Propertybags_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Propertybags_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Propertybags_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:38.356759'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:38.356759'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:28:38.356759''), CONVERT(DATETIME2, ''2022-09-18 21:28:38.356759'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:28:38.356759'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:38.356759'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:38.356759'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:28:38.356759'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Propertybags_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Propertybags_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Propertybags_Incr__dbt_tmp_temp_view"
    end



    
21:28:39.088559 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.75 seconds
21:28:39.091995 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:39.092326 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr'
      and table_schema = 'stg'
  
21:28:39.134923 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:39.139607 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:39.139949 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:39.144944 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.68 seconds
21:28:39.146462 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Properties_Incr: COMMIT
21:28:39.147261 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:28:39.147435 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."#AH_Properties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Properties_Incr__dbt_tmp"
    end

21:28:39.157799 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.50 seconds
21:28:39.159543 [debug] [Thread-4  ]: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: COMMIT
21:28:39.160344 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:28:39.160519 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    end

21:28:39.179483 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:39.181141 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:39.181401 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    
21:28:39.185606 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:39.200305 [debug] [Thread-3  ]: finished collecting timing info
21:28:39.200571 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:39.200942 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Properties_Incr: Close
21:28:39.301869 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559861580>]}
21:28:39.302467 [info ] [Thread-3  ]: 75 of 101 OK snapshotted stg.AH_Properties_Incr................................. [[32mOK[0m in 13.96s]
21:28:39.302899 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Properties_Incr
21:28:39.303106 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ReListHistory_Incr
21:28:39.303467 [info ] [Thread-3  ]: 78 of 101 START snapshot stg.AH_ReListHistory_Incr.............................. [RUN]
21:28:39.303962 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ReListHistory_Incr"
21:28:39.304128 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ReListHistory_Incr
21:28:39.304264 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ReListHistory_Incr
21:28:39.307163 [debug] [Thread-3  ]: finished collecting timing info
21:28:39.312363 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ReListHistory_Incr
21:28:39.315250 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:39.312045 [debug] [Thread-4  ]: finished collecting timing info
21:28:39.315683 [debug] [Thread-4  ]: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: Close
21:28:39.316343 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559861430>]}
21:28:39.316810 [info ] [Thread-4  ]: 74 of 101 OK snapshotted stg.AH_PaymentprovIDErs_Incr........................... [[32mOK[0m in 14.27s]
21:28:39.317182 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_PaymentprovIDErs_Incr
21:28:39.315497 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:28:39.317622 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:28:39.317770 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:28:39.317368 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Reports_Incr
21:28:39.318914 [info ] [Thread-4  ]: 79 of 101 START snapshot stg.AH_Reports_Incr.................................... [RUN]
21:28:39.319359 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Reports_Incr"
21:28:39.319830 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Reports_Incr
21:28:39.320013 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Reports_Incr
21:28:39.323303 [debug] [Thread-4  ]: finished collecting timing info
21:28:39.323511 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Reports_Incr
21:28:39.326343 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:39.326529 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:28:39.326707 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:28:39.326843 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:28:39.414391 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:28:39.452135 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:28:39.462783 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:28:39.485139 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:28:39.496251 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:39.496639 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:28:39.509288 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:39.509682 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:28:39.528581 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:28:39.530761 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:39.531047 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ReListHistory_InterView]
        ) as __dbt_sbq
    
21:28:39.540778 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:28:39.543049 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:39.543300 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Reports_InterView]
        ) as __dbt_sbq
    
21:28:39.597948 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:39.610487 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:39.630322 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:39.639882 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr"
        ) as __dbt_sbq
    
21:28:39.644445 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:39.644766 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Reports_Incr"
        ) as __dbt_sbq
    
21:28:39.699674 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:39.704739 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:39.705001 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:39.708045 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:39.708325 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr'
      and table_schema = 'stg'
  
21:28:39.705212 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr'
      and table_schema = 'stg'
  
21:28:39.812260 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:28:39.818842 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:39.819094 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:28:39.824376 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:39.824728 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
        
  
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ReListHistory_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ReListHistory_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ReListHistory_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ReListHistory_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ReListHistory_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:39.497400'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:39.497400'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:28:39.497400''), CONVERT(DATETIME2, ''2022-09-18 21:28:39.497400'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:28:39.497400'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:39.497400'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:39.497400'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:28:39.497400'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CurrentPrice_Old != source_data.CurrentPrice_Old
        or
        (
            ((snapshotted_data.CurrentPrice_Old is null) and not (source_data.CurrentPrice_Old is null))
            or
            ((not snapshotted_data.CurrentPrice_Old is null) and (source_data.CurrentPrice_Old is null))
        ) or snapshotted_data.CurrentPrice_New != source_data.CurrentPrice_New
        or
        (
            ((snapshotted_data.CurrentPrice_New is null) and not (source_data.CurrentPrice_New is null))
            or
            ((not snapshotted_data.CurrentPrice_New is null) and (source_data.CurrentPrice_New is null))
        ) or snapshotted_data.ReservePrice != source_data.ReservePrice
        or
        (
            ((snapshotted_data.ReservePrice is null) and not (source_data.ReservePrice is null))
            or
            ((not snapshotted_data.ReservePrice is null) and (source_data.ReservePrice is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.NewreListiteration != source_data.NewreListiteration
        or
        (
            ((snapshotted_data.NewreListiteration is null) and not (source_data.NewreListiteration is null))
            or
            ((not snapshotted_data.NewreListiteration is null) and (source_data.NewreListiteration is null))
        ) or snapshotted_data.Duration_Old != source_data.Duration_Old
        or
        (
            ((snapshotted_data.Duration_Old is null) and not (source_data.Duration_Old is null))
            or
            ((not snapshotted_data.Duration_Old is null) and (source_data.Duration_Old is null))
        ) or snapshotted_data.Duration_New != source_data.Duration_New
        or
        (
            ((snapshotted_data.Duration_New is null) and not (source_data.Duration_New is null))
            or
            ((not snapshotted_data.Duration_New is null) and (source_data.Duration_New is null))
        ) or snapshotted_data.HighBidderID != source_data.HighBidderID
        or
        (
            ((snapshotted_data.HighBidderID is null) and not (source_data.HighBidderID is null))
            or
            ((not snapshotted_data.HighBidderID is null) and (source_data.HighBidderID is null))
        ) or snapshotted_data.BidCount != source_data.BidCount
        or
        (
            ((snapshotted_data.BidCount is null) and not (source_data.BidCount is null))
            or
            ((not snapshotted_data.BidCount is null) and (source_data.BidCount is null))
        ) or snapshotted_data.Startdttm_New != source_data.Startdttm_New
        or
        (
            ((snapshotted_data.Startdttm_New is null) and not (source_data.Startdttm_New is null))
            or
            ((not snapshotted_data.Startdttm_New is null) and (source_data.Startdttm_New is null))
        ) or snapshotted_data.Enddttm_Old != source_data.Enddttm_Old
        or
        (
            ((snapshotted_data.Enddttm_Old is null) and not (source_data.Enddttm_Old is null))
            or
            ((not snapshotted_data.Enddttm_Old is null) and (source_data.Enddttm_Old is null))
        ) or snapshotted_data.Enddttm_New != source_data.Enddttm_New
        or
        (
            ((snapshotted_data.Enddttm_New is null) and not (source_data.Enddttm_New is null))
            or
            ((not snapshotted_data.Enddttm_New is null) and (source_data.Enddttm_New is null))
        ) or snapshotted_data.ReListdttm != source_data.ReListdttm
        or
        (
            ((snapshotted_data.ReListdttm is null) and not (source_data.ReListdttm is null))
            or
            ((not snapshotted_data.ReListdttm is null) and (source_data.ReListdttm is null))
        ) or snapshotted_data.Startdttm_Old != source_data.Startdttm_Old
        or
        (
            ((snapshotted_data.Startdttm_Old is null) and not (source_data.Startdttm_Old is null))
            or
            ((not snapshotted_data.Startdttm_Old is null) and (source_data.Startdttm_Old is null))
        ) or snapshotted_data.MaxBidAmount != source_data.MaxBidAmount
        or
        (
            ((snapshotted_data.MaxBidAmount is null) and not (source_data.MaxBidAmount is null))
            or
            ((not snapshotted_data.MaxBidAmount is null) and (source_data.MaxBidAmount is null))
        ) or snapshotted_data.ProxyBidAmount != source_data.ProxyBidAmount
        or
        (
            ((snapshotted_data.ProxyBidAmount is null) and not (source_data.ProxyBidAmount is null))
            or
            ((not snapshotted_data.ProxyBidAmount is null) and (source_data.ProxyBidAmount is null))
        ) or snapshotted_data.BidIncrement != source_data.BidIncrement
        or
        (
            ((snapshotted_data.BidIncrement is null) and not (source_data.BidIncrement is null))
            or
            ((not snapshotted_data.BidIncrement is null) and (source_data.BidIncrement is null))
        ) or snapshotted_data.ListingTitle != source_data.ListingTitle
        or
        (
            ((snapshotted_data.ListingTitle is null) and not (source_data.ListingTitle is null))
            or
            ((not snapshotted_data.ListingTitle is null) and (source_data.ListingTitle is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CurrentPrice_Old != source_data.CurrentPrice_Old
        or
        (
            ((snapshotted_data.CurrentPrice_Old is null) and not (source_data.CurrentPrice_Old is null))
            or
            ((not snapshotted_data.CurrentPrice_Old is null) and (source_data.CurrentPrice_Old is null))
        ) or snapshotted_data.CurrentPrice_New != source_data.CurrentPrice_New
        or
        (
            ((snapshotted_data.CurrentPrice_New is null) and not (source_data.CurrentPrice_New is null))
            or
            ((not snapshotted_data.CurrentPrice_New is null) and (source_data.CurrentPrice_New is null))
        ) or snapshotted_data.ReservePrice != source_data.ReservePrice
        or
        (
            ((snapshotted_data.ReservePrice is null) and not (source_data.ReservePrice is null))
            or
            ((not snapshotted_data.ReservePrice is null) and (source_data.ReservePrice is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.NewreListiteration != source_data.NewreListiteration
        or
        (
            ((snapshotted_data.NewreListiteration is null) and not (source_data.NewreListiteration is null))
            or
            ((not snapshotted_data.NewreListiteration is null) and (source_data.NewreListiteration is null))
        ) or snapshotted_data.Duration_Old != source_data.Duration_Old
        or
        (
            ((snapshotted_data.Duration_Old is null) and not (source_data.Duration_Old is null))
            or
            ((not snapshotted_data.Duration_Old is null) and (source_data.Duration_Old is null))
        ) or snapshotted_data.Duration_New != source_data.Duration_New
        or
        (
            ((snapshotted_data.Duration_New is null) and not (source_data.Duration_New is null))
            or
            ((not snapshotted_data.Duration_New is null) and (source_data.Duration_New is null))
        ) or snapshotted_data.HighBidderID != source_data.HighBidderID
        or
        (
            ((snapshotted_data.HighBidderID is null) and not (source_data.HighBidderID is null))
            or
            ((not snapshotted_data.HighBidderID is null) and (source_data.HighBidderID is null))
        ) or snapshotted_data.BidCount != source_data.BidCount
        or
        (
            ((snapshotted_data.BidCount is null) and not (source_data.BidCount is null))
            or
            ((not snapshotted_data.BidCount is null) and (source_data.BidCount is null))
        ) or snapshotted_data.Startdttm_New != source_data.Startdttm_New
        or
        (
            ((snapshotted_data.Startdttm_New is null) and not (source_data.Startdttm_New is null))
            or
            ((not snapshotted_data.Startdttm_New is null) and (source_data.Startdttm_New is null))
        ) or snapshotted_data.Enddttm_Old != source_data.Enddttm_Old
        or
        (
            ((snapshotted_data.Enddttm_Old is null) and not (source_data.Enddttm_Old is null))
            or
            ((not snapshotted_data.Enddttm_Old is null) and (source_data.Enddttm_Old is null))
        ) or snapshotted_data.Enddttm_New != source_data.Enddttm_New
        or
        (
            ((snapshotted_data.Enddttm_New is null) and not (source_data.Enddttm_New is null))
            or
            ((not snapshotted_data.Enddttm_New is null) and (source_data.Enddttm_New is null))
        ) or snapshotted_data.ReListdttm != source_data.ReListdttm
        or
        (
            ((snapshotted_data.ReListdttm is null) and not (source_data.ReListdttm is null))
            or
            ((not snapshotted_data.ReListdttm is null) and (source_data.ReListdttm is null))
        ) or snapshotted_data.Startdttm_Old != source_data.Startdttm_Old
        or
        (
            ((snapshotted_data.Startdttm_Old is null) and not (source_data.Startdttm_Old is null))
            or
            ((not snapshotted_data.Startdttm_Old is null) and (source_data.Startdttm_Old is null))
        ) or snapshotted_data.MaxBidAmount != source_data.MaxBidAmount
        or
        (
            ((snapshotted_data.MaxBidAmount is null) and not (source_data.MaxBidAmount is null))
            or
            ((not snapshotted_data.MaxBidAmount is null) and (source_data.MaxBidAmount is null))
        ) or snapshotted_data.ProxyBidAmount != source_data.ProxyBidAmount
        or
        (
            ((snapshotted_data.ProxyBidAmount is null) and not (source_data.ProxyBidAmount is null))
            or
            ((not snapshotted_data.ProxyBidAmount is null) and (source_data.ProxyBidAmount is null))
        ) or snapshotted_data.BidIncrement != source_data.BidIncrement
        or
        (
            ((snapshotted_data.BidIncrement is null) and not (source_data.BidIncrement is null))
            or
            ((not snapshotted_data.BidIncrement is null) and (source_data.BidIncrement is null))
        ) or snapshotted_data.ListingTitle != source_data.ListingTitle
        or
        (
            ((snapshotted_data.ListingTitle is null) and not (source_data.ListingTitle is null))
            or
            ((not snapshotted_data.ListingTitle is null) and (source_data.ListingTitle is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ReListHistory_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ReListHistory_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ReListHistory_Incr__dbt_tmp_temp_view"
    end



    
21:28:39.819325 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
        
  
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Reports_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Reports_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Reports_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Reports_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Reports_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Reports_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:39.513024'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:39.513024'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:28:39.513024''), CONVERT(DATETIME2, ''2022-09-18 21:28:39.513024'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:28:39.513024'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:39.513024'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:39.513024'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:28:39.513024'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SecondstogeneRate != source_data.SecondstogeneRate
        or
        (
            ((snapshotted_data.SecondstogeneRate is null) and not (source_data.SecondstogeneRate is null))
            or
            ((not snapshotted_data.SecondstogeneRate is null) and (source_data.SecondstogeneRate is null))
        ) or snapshotted_data.ReportName != source_data.ReportName
        or
        (
            ((snapshotted_data.ReportName is null) and not (source_data.ReportName is null))
            or
            ((not snapshotted_data.ReportName is null) and (source_data.ReportName is null))
        ) or snapshotted_data.Data != source_data.Data
        or
        (
            ((snapshotted_data.Data is null) and not (source_data.Data is null))
            or
            ((not snapshotted_data.Data is null) and (source_data.Data is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SecondstogeneRate != source_data.SecondstogeneRate
        or
        (
            ((snapshotted_data.SecondstogeneRate is null) and not (source_data.SecondstogeneRate is null))
            or
            ((not snapshotted_data.SecondstogeneRate is null) and (source_data.SecondstogeneRate is null))
        ) or snapshotted_data.ReportName != source_data.ReportName
        or
        (
            ((snapshotted_data.ReportName is null) and not (source_data.ReportName is null))
            or
            ((not snapshotted_data.ReportName is null) and (source_data.ReportName is null))
        ) or snapshotted_data.Data != source_data.Data
        or
        (
            ((snapshotted_data.Data is null) and not (source_data.Data is null))
            or
            ((not snapshotted_data.Data is null) and (source_data.Data is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Reports_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Reports_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Reports_Incr__dbt_tmp_temp_view"
    end



    
21:28:40.059626 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
21:28:40.061386 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:40.061656 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:40.108145 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:40.111457 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:40.111827 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:41.367975 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.26 seconds
21:28:41.370166 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_PropertybagItems_Incr"
21:28:41.370660 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:41.370807 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_PropertybagItems_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr" (
                  "ID", "PropertybagID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "Value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "PropertybagID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "Value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_PropertybagItems_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:28:42.124247 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.30 seconds
21:28:42.127873 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:42.128093 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:42.173308 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:42.174982 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:42.175244 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Reports_Incr__dbt_tmp"
    
21:28:42.876208 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.51 seconds
21:28:42.877982 [debug] [Thread-1  ]: On snapshot.Shawn.AH_PropertybagItems_Incr: COMMIT
21:28:42.878820 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:28:42.878980 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."#AH_PropertybagItems_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    end

21:28:42.936715 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:42.950534 [debug] [Thread-1  ]: finished collecting timing info
21:28:42.950994 [debug] [Thread-1  ]: On snapshot.Shawn.AH_PropertybagItems_Incr: Close
21:28:42.951768 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5598612e0>]}
21:28:42.952287 [info ] [Thread-1  ]: 76 of 101 OK snapshotted stg.AH_PropertybagItems_Incr........................... [[32mOK[0m in 14.47s]
21:28:42.952673 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_PropertybagItems_Incr
21:28:42.952852 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Roles_Incr
21:28:42.953216 [info ] [Thread-1  ]: 80 of 101 START snapshot stg.AH_Roles_Incr...................................... [RUN]
21:28:42.953647 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Roles_Incr"
21:28:42.953798 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Roles_Incr
21:28:42.953934 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Roles_Incr
21:28:42.956909 [debug] [Thread-1  ]: finished collecting timing info
21:28:42.957119 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Roles_Incr
21:28:42.960137 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:42.960325 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:28:42.960548 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:28:42.960706 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:28:43.078635 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:28:43.128788 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:28:43.153328 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:43.153735 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:28:43.198400 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:43.200684 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:43.201315 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Roles_InterView]
        ) as __dbt_sbq
    
21:28:43.259507 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:43.281742 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:43.282155 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Roles_Incr"
        ) as __dbt_sbq
    
21:28:43.334715 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:43.338350 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:43.338711 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr'
      and table_schema = 'stg'
  
21:28:43.408608 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:43.412607 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:43.412948 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
        
  
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Roles_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Roles_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Roles_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Roles_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Roles_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Roles_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:43.169323'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:43.169323'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:28:43.169323''), CONVERT(DATETIME2, ''2022-09-18 21:28:43.169323'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:28:43.169323'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:43.169323'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:43.169323'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:28:43.169323'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Roles_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Roles_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Roles_Incr__dbt_tmp_temp_view"
    end



    
21:28:43.618741 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.44 seconds
21:28:43.620451 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:43.620700 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:43.690789 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:43.693507 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:43.693752 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:43.939610 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:28:43.942972 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:43.943266 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr'
      and table_schema = 'stg'
  
21:28:43.982809 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:43.986987 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:43.987256 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:44.038686 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:44.040691 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:44.040962 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Reports_Incr__dbt_tmp"
    
21:28:44.620624 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.03 seconds
21:28:44.625824 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:44.626161 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:44.690391 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:44.692069 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:44.692320 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Propertybags_Incr__dbt_tmp"
    
21:28:45.146909 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.11 seconds
21:28:45.148647 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:45.148908 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:45.210645 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:45.213169 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:45.213435 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:45.622426 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.93 seconds
21:28:45.624702 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:45.624951 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:45.692246 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:45.695165 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:45.695429 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:45.737205 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.52 seconds
21:28:45.740160 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:45.740395 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr'
      and table_schema = 'stg'
  
21:28:45.773191 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:28:45.779711 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:45.780060 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:45.820125 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:45.821768 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:45.822024 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Reports_Incr__dbt_tmp"
    
21:28:46.198787 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.50 seconds
21:28:46.201680 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:46.201918 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr'
      and table_schema = 'stg'
  
21:28:46.248866 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:46.253190 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:46.253483 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:46.289335 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:46.291040 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:46.291286 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Propertybags_Incr__dbt_tmp"
    
21:28:46.869061 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
21:28:46.870762 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:46.870968 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:46.910989 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:46.914031 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:46.914316 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:47.229256 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
21:28:47.231599 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Reports_Incr"
21:28:47.232163 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:47.232334 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Reports_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Reports_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Reports_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Reports_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Reports_Incr" (
                  "ID", "SecondstogeneRate", "ReportName", "Data", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SecondstogeneRate", "ReportName", "Data", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Reports_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:28:47.430949 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.14 seconds
21:28:47.432707 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:47.432965 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:47.465594 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:28:47.468169 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:47.468420 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:47.715918 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:28:47.719266 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:47.719503 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr'
      and table_schema = 'stg'
  
21:28:47.756765 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:47.761294 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:47.761579 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:47.801315 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:47.803000 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:47.803253 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Propertybags_Incr__dbt_tmp"
    
21:28:49.207299 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.40 seconds
21:28:49.208959 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:49.209123 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:49.240974 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:28:49.243523 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:49.243705 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:49.274080 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.04 seconds
21:28:49.275890 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Reports_Incr: COMMIT
21:28:49.276748 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:28:49.276937 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."#AH_Reports_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Reports_Incr__dbt_tmp"
    end

21:28:49.319839 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:49.333240 [debug] [Thread-4  ]: finished collecting timing info
21:28:49.333649 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Reports_Incr: Close
21:28:49.334428 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5586b0160>]}
21:28:49.334973 [info ] [Thread-4  ]: 79 of 101 OK snapshotted stg.AH_Reports_Incr.................................... [[32mOK[0m in 10.02s]
21:28:49.335361 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Reports_Incr
21:28:49.335538 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_SMStemplatecontents_Incr
21:28:49.335891 [info ] [Thread-4  ]: 81 of 101 START snapshot stg.AH_SMStemplatecontents_Incr........................ [RUN]
21:28:49.336312 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr"
21:28:49.336463 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_SMStemplatecontents_Incr
21:28:49.336593 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_SMStemplatecontents_Incr
21:28:49.339429 [debug] [Thread-4  ]: finished collecting timing info
21:28:49.339692 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_SMStemplatecontents_Incr
21:28:49.342509 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:28:49.342713 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:28:49.342831 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:28:49.342959 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:28:49.458690 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:28:49.490017 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:28:49.499058 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.09 seconds
21:28:49.502296 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:49.511682 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:49.517076 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:28:49.517330 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:28:49.565371 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:49.567915 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:28:49.568177 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_SMStemplatecontents_InterView]
        ) as __dbt_sbq
    
21:28:49.572936 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:49.574207 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:49.574408 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Roles_Incr__dbt_tmp"
    
21:28:49.617945 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.37 seconds
21:28:49.620166 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Propertybags_Incr"
21:28:49.620944 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:49.621163 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Propertybags_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Propertybags_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:28:49.623680 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:49.646417 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:28:49.646808 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr"
        ) as __dbt_sbq
    
21:28:49.729101 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:28:49.732858 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:28:49.733149 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr'
      and table_schema = 'stg'
  
21:28:49.821948 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:28:49.825572 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:28:49.825857 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
        
  
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_SMStemplatecontents_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_SMStemplatecontents_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:49.544407'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:49.544407'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:28:49.544407''), CONVERT(DATETIME2, ''2022-09-18 21:28:49.544407'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:28:49.544407'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:49.544407'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:49.544407'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:28:49.544407'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SMStemplatecontents_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_temp_view"
    end



    
21:28:50.455221 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
21:28:50.456920 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:50.457162 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:50.524283 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:50.526798 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:50.527062 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:50.770432 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:28:50.773504 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:50.773681 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr'
      and table_schema = 'stg'
  
21:28:50.829826 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:50.833958 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:50.834206 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:50.875378 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:50.877035 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:50.877289 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Roles_Incr__dbt_tmp"
    
21:28:50.987505 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.37 seconds
21:28:50.989310 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Propertybags_Incr: COMMIT
21:28:50.990159 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:28:50.990357 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."#AH_Propertybags_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Propertybags_Incr__dbt_tmp"
    end

21:28:51.047099 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:51.061465 [debug] [Thread-2  ]: finished collecting timing info
21:28:51.061888 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Propertybags_Incr: Close
21:28:51.062715 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5598616d0>]}
21:28:51.063254 [info ] [Thread-2  ]: 77 of 101 OK snapshotted stg.AH_Propertybags_Incr............................... [[32mOK[0m in 12.90s]
21:28:51.063639 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Propertybags_Incr
21:28:51.063823 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_SMStemplates_Incr
21:28:51.064170 [info ] [Thread-2  ]: 82 of 101 START snapshot stg.AH_SMStemplates_Incr............................... [RUN]
21:28:51.064594 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_SMStemplates_Incr"
21:28:51.064743 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_SMStemplates_Incr
21:28:51.064875 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_SMStemplates_Incr
21:28:51.067710 [debug] [Thread-2  ]: finished collecting timing info
21:28:51.067970 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_SMStemplates_Incr
21:28:51.070830 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:28:51.071009 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:28:51.071127 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:28:51.071260 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:28:51.168859 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:28:51.198965 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:28:51.221719 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:28:51.222121 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:28:51.253105 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:28:51.255538 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:28:51.256318 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_SMStemplates_InterView]
        ) as __dbt_sbq
    
21:28:51.353878 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:28:51.375937 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:28:51.376328 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr"
        ) as __dbt_sbq
    
21:28:51.434359 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:51.438122 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:28:51.438411 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr'
      and table_schema = 'stg'
  
21:28:51.507404 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:51.511267 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:28:51.511556 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
        
  
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SMStemplates_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_SMStemplates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SMStemplates_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_SMStemplates_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_SMStemplates_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:51.232038'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:51.232038'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:28:51.232038''), CONVERT(DATETIME2, ''2022-09-18 21:28:51.232038'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:28:51.232038'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:51.232038'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:51.232038'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:28:51.232038'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_SMStemplates_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SMStemplates_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SMStemplates_Incr__dbt_tmp_temp_view"
    end



    
21:28:52.120337 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.24 seconds
21:28:52.122086 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:52.122329 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:52.164871 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:52.167550 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:52.167817 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:52.488940 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
21:28:52.492226 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:52.492475 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr'
      and table_schema = 'stg'
  
21:28:52.530930 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:52.535254 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:52.535521 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:52.573147 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:52.574846 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:52.575131 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Roles_Incr__dbt_tmp"
    
21:28:52.841746 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 13.02 seconds
21:28:52.845354 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:52.845627 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:52.884186 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:52.885823 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:52.886093 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ReListHistory_Incr__dbt_tmp"
    
21:28:53.624151 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
21:28:53.625795 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:53.625973 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:53.671338 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:53.674044 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:53.674360 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:53.977672 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:28:53.979907 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Roles_Incr"
21:28:53.980461 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:53.980639 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Roles_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Roles_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Roles_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Roles_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Roles_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "LastUpdatedUser", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "LastUpdatedUser", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Roles_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:28:54.597985 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.71 seconds
21:28:54.599719 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:54.599966 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:54.683470 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:28:54.686725 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:54.687004 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:54.960782 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:28:54.963738 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:54.964095 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr'
      and table_schema = 'stg'
  
21:28:55.004690 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:55.009450 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:55.009737 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:55.051798 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:55.053731 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:55.053994 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ReListHistory_Incr__dbt_tmp"
    
21:28:56.212269 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
21:28:56.213903 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:56.214088 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:56.254642 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:56.257529 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:56.257796 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:56.369248 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.39 seconds
21:28:56.371181 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Roles_Incr: COMMIT
21:28:56.372013 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:28:56.372196 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."#AH_Roles_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Roles_Incr__dbt_tmp"
    end

21:28:56.427652 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:56.442059 [debug] [Thread-1  ]: finished collecting timing info
21:28:56.442452 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Roles_Incr: Close
21:28:56.443265 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55846f9d0>]}
21:28:56.443780 [info ] [Thread-1  ]: 80 of 101 OK snapshotted stg.AH_Roles_Incr...................................... [[32mOK[0m in 13.49s]
21:28:56.444169 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Roles_Incr
21:28:56.444443 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_SalesTaxRates_Incr
21:28:56.444796 [info ] [Thread-1  ]: 83 of 101 START snapshot stg.AH_SalesTaxRates_Incr.............................. [RUN]
21:28:56.445202 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr"
21:28:56.445351 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_SalesTaxRates_Incr
21:28:56.445483 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_SalesTaxRates_Incr
21:28:56.448269 [debug] [Thread-1  ]: finished collecting timing info
21:28:56.448524 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_SalesTaxRates_Incr
21:28:56.451353 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:28:56.451531 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:28:56.451647 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:28:56.451774 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:28:56.562806 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:28:56.598493 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
21:28:56.601716 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:56.602012 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr'
      and table_schema = 'stg'
  
21:28:56.608920 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:28:56.631332 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:28:56.632274 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:28:56.676740 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:56.681706 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:56.682121 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:56.683917 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:28:56.684117 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_SalesTaxRates_InterView]
        ) as __dbt_sbq
    
21:28:56.682258 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:56.768097 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:28:56.789922 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:28:56.790318 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr"
        ) as __dbt_sbq
    
21:28:56.799730 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:28:56.801031 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:56.801223 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ReListHistory_Incr__dbt_tmp"
    
21:28:56.848612 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:56.852545 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:28:56.852788 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr'
      and table_schema = 'stg'
  
21:28:56.926291 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:56.931146 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:28:56.931436 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
        
  
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SalesTaxRates_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_SalesTaxRates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_SalesTaxRates_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_SalesTaxRates_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:56.653880'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:56.653880'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:28:56.653880''), CONVERT(DATETIME2, ''2022-09-18 21:28:56.653880'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:28:56.653880'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:56.653880'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:56.653880'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:28:56.653880'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Shipping != source_data.Shipping
        or
        (
            ((snapshotted_data.Shipping is null) and not (source_data.Shipping is null))
            or
            ((not snapshotted_data.Shipping is null) and (source_data.Shipping is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.StateID != source_data.StateID
        or
        (
            ((snapshotted_data.StateID is null) and not (source_data.StateID is null))
            or
            ((not snapshotted_data.StateID is null) and (source_data.StateID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.TaxRate != source_data.TaxRate
        or
        (
            ((snapshotted_data.TaxRate is null) and not (source_data.TaxRate is null))
            or
            ((not snapshotted_data.TaxRate is null) and (source_data.TaxRate is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Shipping != source_data.Shipping
        or
        (
            ((snapshotted_data.Shipping is null) and not (source_data.Shipping is null))
            or
            ((not snapshotted_data.Shipping is null) and (source_data.Shipping is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.StateID != source_data.StateID
        or
        (
            ((snapshotted_data.StateID is null) and not (source_data.StateID is null))
            or
            ((not snapshotted_data.StateID is null) and (source_data.StateID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.TaxRate != source_data.TaxRate
        or
        (
            ((snapshotted_data.TaxRate is null) and not (source_data.TaxRate is null))
            or
            ((not snapshotted_data.TaxRate is null) and (source_data.TaxRate is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SalesTaxRates_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SalesTaxRates_Incr__dbt_tmp_temp_view"
    end



    
21:28:57.306210 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 7.48 seconds
21:28:57.309872 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:28:57.310142 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:57.355812 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:57.357435 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:28:57.357681 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    
21:28:57.378702 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 5.87 seconds
21:28:57.382101 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:28:57.382333 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:57.429254 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:28:57.430916 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:28:57.431200 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplates_Incr__dbt_tmp"
    
21:28:58.037928 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.24 seconds
21:28:58.039677 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:58.039934 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:58.076494 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:58.079443 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:58.079710 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:58.303855 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:28:58.306385 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ReListHistory_Incr"
21:28:58.306982 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:58.307158 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ReListHistory_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr" (
                  "ID", "CurrentPrice_Old", "CurrentPrice_New", "ReservePrice", "ListingID", "NewreListiteration", "Duration_Old", "Duration_New", "HighBidderID", "BidCount", "Startdttm_New", "Enddttm_Old", "Enddttm_New", "ReListdttm", "Startdttm_Old", "MaxBidAmount", "ProxyBidAmount", "BidIncrement", "ListingTitle", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CurrentPrice_Old", "CurrentPrice_New", "ReservePrice", "ListingID", "NewreListiteration", "Duration_Old", "Duration_New", "HighBidderID", "BidCount", "Startdttm_New", "Enddttm_Old", "Enddttm_New", "ReListdttm", "Startdttm_Old", "MaxBidAmount", "ProxyBidAmount", "BidIncrement", "ListingTitle", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ReListHistory_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:28:58.561370 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.20 seconds
21:28:58.563156 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:28:58.561784 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.13 seconds
21:28:58.564516 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:28:58.564705 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:58.563406 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:28:58.634038 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:58.635812 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:28:58.638213 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:28:58.639173 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:58.639062 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:28:58.639461 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:58.891573 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:28:58.894906 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:28:58.895252 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:28:58.897618 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:28:58.897826 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr'
      and table_schema = 'stg'
  
21:28:58.895376 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr'
      and table_schema = 'stg'
  
21:28:58.936263 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:58.938164 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:58.942015 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:28:58.944503 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:58.944368 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:28:58.944841 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:28:59.000397 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:59.002227 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:28:59.002464 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    
21:28:59.003634 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:28:59.004635 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:28:59.004811 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplates_Incr__dbt_tmp"
    
21:28:59.657709 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.35 seconds
21:28:59.659568 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ReListHistory_Incr: COMMIT
21:28:59.660450 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:28:59.660648 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."#AH_ReListHistory_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ReListHistory_Incr__dbt_tmp"
    end

21:28:59.701868 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:28:59.716583 [debug] [Thread-3  ]: finished collecting timing info
21:28:59.716965 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ReListHistory_Incr: Close
21:28:59.717713 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559861970>]}
21:28:59.718212 [info ] [Thread-3  ]: 78 of 101 OK snapshotted stg.AH_ReListHistory_Incr.............................. [[32mOK[0m in 20.41s]
21:28:59.718607 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ReListHistory_Incr
21:28:59.718795 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ShippingMethods_Incr
21:28:59.719142 [info ] [Thread-3  ]: 84 of 101 START snapshot stg.AH_ShippingMethods_Incr............................ [RUN]
21:28:59.719556 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr"
21:28:59.719703 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ShippingMethods_Incr
21:28:59.719837 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ShippingMethods_Incr
21:28:59.722581 [debug] [Thread-3  ]: finished collecting timing info
21:28:59.722832 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ShippingMethods_Incr
21:28:59.725571 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:28:59.725747 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:28:59.725863 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:28:59.725992 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:28:59.850568 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:28:59.888886 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:28:59.912418 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:28:59.912776 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:28:59.941609 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:28:59.943876 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:28:59.944450 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ShippingMethods_InterView]
        ) as __dbt_sbq
    
21:29:00.006353 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:29:00.028262 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:29:00.028648 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr"
        ) as __dbt_sbq
    
21:29:00.091522 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:29:00.094963 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:29:00.095241 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr'
      and table_schema = 'stg'
  
21:29:00.192007 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:29:00.195943 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:29:00.196223 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
        
  
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ShippingMethods_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ShippingMethods_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ShippingMethods_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ShippingMethods_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:59.919605'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:59.919605'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:28:59.919605''), CONVERT(DATETIME2, ''2022-09-18 21:28:59.919605'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:28:59.919605'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:28:59.919605'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:28:59.919605'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:28:59.919605'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ShippingMethods_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ShippingMethods_Incr__dbt_tmp_temp_view"
    end



    
21:29:00.428827 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.42 seconds
21:29:00.430724 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:29:00.431042 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:00.468669 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:00.471728 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:29:00.472069 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:00.627736 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.63 seconds
21:29:00.629497 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:29:00.629762 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:00.668621 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:00.671599 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:29:00.671895 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:00.735472 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:29:00.738952 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:29:00.739261 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr'
      and table_schema = 'stg'
  
21:29:00.774673 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:00.779819 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:29:00.780154 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:00.835107 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:00.836735 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:29:00.836978 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplates_Incr__dbt_tmp"
    
21:29:00.946064 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:29:00.949302 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:29:00.949615 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr'
      and table_schema = 'stg'
  
21:29:00.996602 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:01.001047 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:29:01.001380 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:01.067138 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:29:01.068690 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:29:01.068926 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    
21:29:01.803315 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
21:29:01.805048 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:29:01.805272 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:01.859448 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:01.863034 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:29:01.863356 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:02.044250 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.98 seconds
21:29:02.046362 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:29:02.046658 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:02.097768 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:02.100860 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:29:02.101122 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:02.131798 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:29:02.134055 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_SMStemplates_Incr"
21:29:02.134656 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:29:02.134850 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_SMStemplates_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr" (
                  "ID", "Enabled", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Enabled", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_SMStemplates_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:29:02.532274 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
21:29:02.534526 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_SMStemplatecontents_Incr"
21:29:02.535127 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:29:02.535304 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_SMStemplatecontents_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr" (
                  "ID", "Name", "Body", "UpdatedOn", "DeletedOn", "CreatedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Body", "UpdatedOn", "DeletedOn", "CreatedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:29:04.188632 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.05 seconds
21:29:04.190467 [debug] [Thread-2  ]: On snapshot.Shawn.AH_SMStemplates_Incr: COMMIT
21:29:04.191358 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:29:04.191549 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."#AH_SMStemplates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SMStemplates_Incr__dbt_tmp"
    end

21:29:04.236271 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:04.251517 [debug] [Thread-2  ]: finished collecting timing info
21:29:04.251915 [debug] [Thread-2  ]: On snapshot.Shawn.AH_SMStemplates_Incr: Close
21:29:04.252674 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559861c10>]}
21:29:04.253163 [info ] [Thread-2  ]: 82 of 101 OK snapshotted stg.AH_SMStemplates_Incr............................... [[32mOK[0m in 13.19s]
21:29:04.253551 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_SMStemplates_Incr
21:29:04.253735 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ShippingOptions_Incr
21:29:04.254087 [info ] [Thread-2  ]: 85 of 101 START snapshot stg.AH_ShippingOptions_Incr............................ [RUN]
21:29:04.254519 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr"
21:29:04.254720 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ShippingOptions_Incr
21:29:04.254855 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ShippingOptions_Incr
21:29:04.257629 [debug] [Thread-2  ]: finished collecting timing info
21:29:04.257826 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ShippingOptions_Incr
21:29:04.260658 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:04.260841 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:29:04.260960 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:29:04.261090 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:29:04.351874 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.82 seconds
21:29:04.353593 [debug] [Thread-4  ]: On snapshot.Shawn.AH_SMStemplatecontents_Incr: COMMIT
21:29:04.354468 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:29:04.354670 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    end

21:29:04.389133 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:29:04.400201 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:04.413255 [debug] [Thread-4  ]: finished collecting timing info
21:29:04.413627 [debug] [Thread-4  ]: On snapshot.Shawn.AH_SMStemplatecontents_Incr: Close
21:29:04.414403 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559861eb0>]}
21:29:04.414938 [info ] [Thread-4  ]: 81 of 101 OK snapshotted stg.AH_SMStemplatecontents_Incr........................ [[32mOK[0m in 15.08s]
21:29:04.415329 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_SMStemplatecontents_Incr
21:29:04.415507 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Siteproperties_Incr
21:29:04.415858 [info ] [Thread-4  ]: 86 of 101 START snapshot stg.AH_Siteproperties_Incr............................. [RUN]
21:29:04.416274 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Siteproperties_Incr"
21:29:04.416428 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Siteproperties_Incr
21:29:04.416563 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Siteproperties_Incr
21:29:04.419444 [debug] [Thread-4  ]: finished collecting timing info
21:29:04.419639 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Siteproperties_Incr
21:29:04.422435 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:04.422644 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:29:04.422765 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:29:04.422892 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:29:04.429269 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:29:04.452084 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:04.452448 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:29:04.483562 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:29:04.485858 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:04.486097 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ShippingOptions_InterView]
        ) as __dbt_sbq
    
21:29:04.538795 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:29:04.556489 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:29:04.558270 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 7.63 seconds
21:29:04.561583 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:29:04.571744 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:04.583268 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:04.583648 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr"
        ) as __dbt_sbq
    
21:29:04.593956 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:29:04.616562 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:04.616965 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:04.618391 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:29:04.618652 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    
21:29:04.617230 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:29:04.642297 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:29:04.646192 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:04.646509 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr'
      and table_schema = 'stg'
  
21:29:04.661140 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:04.663314 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:04.663607 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Siteproperties_InterView]
        ) as __dbt_sbq
    
21:29:04.734814 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:29:04.738911 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:04.739236 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
        
  
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ShippingOptions_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ShippingOptions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ShippingOptions_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ShippingOptions_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:04.466494'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:04.466494'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:29:04.466494''), CONVERT(DATETIME2, ''2022-09-18 21:29:04.466494'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:29:04.466494'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:04.466494'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:04.466494'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:29:04.466494'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ShippingMethodID != source_data.ShippingMethodID
        or
        (
            ((snapshotted_data.ShippingMethodID is null) and not (source_data.ShippingMethodID is null))
            or
            ((not snapshotted_data.ShippingMethodID is null) and (source_data.ShippingMethodID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.FirstItEMAmount != source_data.FirstItEMAmount
        or
        (
            ((snapshotted_data.FirstItEMAmount is null) and not (source_data.FirstItEMAmount is null))
            or
            ((not snapshotted_data.FirstItEMAmount is null) and (source_data.FirstItEMAmount is null))
        ) or snapshotted_data.AdditionalItEMAmount != source_data.AdditionalItEMAmount
        or
        (
            ((snapshotted_data.AdditionalItEMAmount is null) and not (source_data.AdditionalItEMAmount is null))
            or
            ((not snapshotted_data.AdditionalItEMAmount is null) and (source_data.AdditionalItEMAmount is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ShippingMethodID != source_data.ShippingMethodID
        or
        (
            ((snapshotted_data.ShippingMethodID is null) and not (source_data.ShippingMethodID is null))
            or
            ((not snapshotted_data.ShippingMethodID is null) and (source_data.ShippingMethodID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.FirstItEMAmount != source_data.FirstItEMAmount
        or
        (
            ((snapshotted_data.FirstItEMAmount is null) and not (source_data.FirstItEMAmount is null))
            or
            ((not snapshotted_data.FirstItEMAmount is null) and (source_data.FirstItEMAmount is null))
        ) or snapshotted_data.AdditionalItEMAmount != source_data.AdditionalItEMAmount
        or
        (
            ((snapshotted_data.AdditionalItEMAmount is null) and not (source_data.AdditionalItEMAmount is null))
            or
            ((not snapshotted_data.AdditionalItEMAmount is null) and (source_data.AdditionalItEMAmount is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ShippingOptions_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ShippingOptions_Incr__dbt_tmp_temp_view"
    end



    
21:29:04.740895 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:29:04.763082 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:04.763453 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr"
        ) as __dbt_sbq
    
21:29:04.839783 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:29:04.843529 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:04.843870 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr'
      and table_schema = 'stg'
  
21:29:04.942914 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:29:04.946916 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:04.947229 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
        
  
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Siteproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Siteproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Siteproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Siteproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Siteproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:04.622747'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:04.622747'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:29:04.622747''), CONVERT(DATETIME2, ''2022-09-18 21:29:04.622747'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:29:04.622747'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:04.622747'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:04.622747'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:29:04.622747'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Siteproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Siteproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Siteproperties_Incr__dbt_tmp_temp_view"
    end



    
21:29:05.674216 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
21:29:05.675876 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:29:05.676064 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:05.761287 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:29:05.763941 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:29:05.764155 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:05.995684 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 5.80 seconds
21:29:05.999537 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:29:05.999931 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:29:06.003775 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:29:06.000063 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:06.004025 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr'
      and table_schema = 'stg'
  
21:29:06.039975 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:06.044409 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:29:06.044623 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:06.045935 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:29:06.046168 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    
21:29:06.044848 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:06.129393 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:29:06.131062 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:29:06.131311 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    
21:29:07.311164 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.26 seconds
21:29:07.312794 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:29:07.312981 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:07.337819 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.21 seconds
21:29:07.339541 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:29:07.339774 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:07.376731 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:07.379521 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:29:07.379821 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:07.387988 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:29:07.390786 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:29:07.391084 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:07.649030 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:29:07.652031 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:29:07.652310 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr'
      and table_schema = 'stg'
  
21:29:07.663475 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:29:07.666514 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:29:07.666840 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr'
      and table_schema = 'stg'
  
21:29:07.696883 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:07.701538 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:29:07.701811 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:07.703462 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:07.707196 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:29:07.707394 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:07.737059 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:07.738804 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:29:07.739091 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    
21:29:07.742844 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:07.744180 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:29:07.744409 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    
21:29:09.379325 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.63 seconds
21:29:09.380912 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:29:09.381121 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:09.453001 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:29:09.455878 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:29:09.456079 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:09.759942 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.02 seconds
21:29:09.762173 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:29:09.762389 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:09.959365 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:29:09.962139 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:29:09.962438 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:10.314971 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
21:29:10.317286 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_SalesTaxRates_Incr"
21:29:10.317887 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:29:10.318067 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_SalesTaxRates_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr" (
                  "ID", "LastUpdatedUser", "Shipping", "DeletedOn", "CreatedOn", "UpdatedOn", "StateID", "UserID", "TaxRate", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "LastUpdatedUser", "Shipping", "DeletedOn", "CreatedOn", "UpdatedOn", "StateID", "UserID", "TaxRate", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:29:10.335553 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
21:29:10.338674 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:29:10.338957 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr'
      and table_schema = 'stg'
  
21:29:10.372336 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:29:10.376885 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:29:10.377193 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:10.601480 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:29:10.603268 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:29:10.603552 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    
21:29:11.977839 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.37 seconds
21:29:11.979551 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:29:11.979756 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:12.018197 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:12.020761 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:29:12.020964 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:12.260028 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:29:12.262280 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ShippingMethods_Incr"
21:29:12.263016 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:29:12.263228 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ShippingMethods_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr" (
                  "ID", "DisplayOrder", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DisplayOrder", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ShippingMethods_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:29:12.552606 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.23 seconds
21:29:12.554437 [debug] [Thread-1  ]: On snapshot.Shawn.AH_SalesTaxRates_Incr: COMMIT
21:29:12.555656 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:29:12.555858 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."#AH_SalesTaxRates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    end

21:29:12.599090 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:12.613598 [debug] [Thread-1  ]: finished collecting timing info
21:29:12.614044 [debug] [Thread-1  ]: On snapshot.Shawn.AH_SalesTaxRates_Incr: Close
21:29:12.614879 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559806040>]}
21:29:12.615417 [info ] [Thread-1  ]: 83 of 101 OK snapshotted stg.AH_SalesTaxRates_Incr.............................. [[32mOK[0m in 16.17s]
21:29:12.615809 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_SalesTaxRates_Incr
21:29:12.615991 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_States_Incr
21:29:12.616344 [info ] [Thread-1  ]: 87 of 101 START snapshot stg.AH_States_Incr..................................... [RUN]
21:29:12.616753 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_States_Incr"
21:29:12.616908 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_States_Incr
21:29:12.617041 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_States_Incr
21:29:12.619859 [debug] [Thread-1  ]: finished collecting timing info
21:29:12.620055 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_States_Incr
21:29:12.622955 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:12.623134 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:29:12.623253 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:29:12.623379 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:29:12.718604 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.98 seconds
21:29:12.721969 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:12.722272 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:12.737195 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:29:12.765154 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:12.766839 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:12.767103 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    
21:29:12.768967 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:29:12.791533 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:12.791932 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:29:12.843658 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:12.846597 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:12.846863 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_States_InterView]
        ) as __dbt_sbq
    
21:29:12.911471 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:29:12.933345 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:12.933763 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_States_Incr"
        ) as __dbt_sbq
    
21:29:13.004682 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:29:13.008377 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:13.008735 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr'
      and table_schema = 'stg'
  
21:29:13.113722 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:29:13.118259 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:13.118649 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
        
  
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_States_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_States_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_States_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_States_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_States_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_States_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:12.826001'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:12.826001'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:29:12.826001''), CONVERT(DATETIME2, ''2022-09-18 21:29:12.826001'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:29:12.826001'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:12.826001'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:12.826001'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:29:12.826001'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CountryID != source_data.CountryID
        or
        (
            ((snapshotted_data.CountryID is null) and not (source_data.CountryID is null))
            or
            ((not snapshotted_data.CountryID is null) and (source_data.CountryID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CountryID != source_data.CountryID
        or
        (
            ((snapshotted_data.CountryID is null) and not (source_data.CountryID is null))
            or
            ((not snapshotted_data.CountryID is null) and (source_data.CountryID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_States_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_States_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_States_Incr__dbt_tmp_temp_view"
    end



    
21:29:13.640230 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
21:29:13.642067 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ShippingMethods_Incr: COMMIT
21:29:13.642997 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:29:13.643207 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."#AH_ShippingMethods_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    end

21:29:13.718731 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:29:13.824226 [debug] [Thread-3  ]: finished collecting timing info
21:29:13.824667 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ShippingMethods_Incr: Close
21:29:13.825476 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559861d60>]}
21:29:13.826013 [info ] [Thread-3  ]: 84 of 101 OK snapshotted stg.AH_ShippingMethods_Incr............................ [[32mOK[0m in 14.11s]
21:29:13.826408 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ShippingMethods_Incr
21:29:13.826623 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_StripeCustomers_Incr
21:29:13.826984 [info ] [Thread-3  ]: 88 of 101 START snapshot stg.AH_StripeCustomers_Incr............................ [RUN]
21:29:13.827411 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr"
21:29:13.827563 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_StripeCustomers_Incr
21:29:13.827702 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_StripeCustomers_Incr
21:29:13.830675 [debug] [Thread-3  ]: finished collecting timing info
21:29:13.830873 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_StripeCustomers_Incr
21:29:13.833661 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:13.833841 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:29:13.833959 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:29:13.834089 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:29:13.959540 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:29:13.988870 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.22 seconds
21:29:13.990683 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:13.991174 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:13.991534 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:29:14.014225 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:14.014657 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:29:14.042100 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:29:14.044396 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:14.044665 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_StripeCustomers_InterView]
        ) as __dbt_sbq
    
21:29:14.087006 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:29:14.090347 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:14.090705 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:14.115453 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:29:14.138184 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:14.138633 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr"
        ) as __dbt_sbq
    
21:29:14.240548 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:29:14.244220 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:14.244510 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr'
      and table_schema = 'stg'
  
21:29:14.324280 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:29:14.327948 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:14.328264 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
        
  
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_StripeCustomers_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_StripeCustomers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_StripeCustomers_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_StripeCustomers_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:14.029147'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:14.029147'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:29:14.029147''), CONVERT(DATETIME2, ''2022-09-18 21:29:14.029147'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:29:14.029147'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:14.029147'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:14.029147'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:29:14.029147'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SellerID != source_data.SellerID
        or
        (
            ((snapshotted_data.SellerID is null) and not (source_data.SellerID is null))
            or
            ((not snapshotted_data.SellerID is null) and (source_data.SellerID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CustomerID != source_data.CustomerID
        or
        (
            ((snapshotted_data.CustomerID is null) and not (source_data.CustomerID is null))
            or
            ((not snapshotted_data.CustomerID is null) and (source_data.CustomerID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SellerID != source_data.SellerID
        or
        (
            ((snapshotted_data.SellerID is null) and not (source_data.SellerID is null))
            or
            ((not snapshotted_data.SellerID is null) and (source_data.SellerID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CustomerID != source_data.CustomerID
        or
        (
            ((snapshotted_data.CustomerID is null) and not (source_data.CustomerID is null))
            or
            ((not snapshotted_data.CustomerID is null) and (source_data.CustomerID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_StripeCustomers_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_StripeCustomers_Incr__dbt_tmp_temp_view"
    end



    
21:29:14.330018 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:29:14.332624 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:14.332843 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr'
      and table_schema = 'stg'
  
21:29:14.367884 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:29:14.372325 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:14.372684 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:14.410831 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:14.412517 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:14.412802 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    
21:29:14.554275 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 9.61 seconds
21:29:14.557878 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:14.558190 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:14.596892 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:14.598601 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:14.598862 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Siteproperties_Incr__dbt_tmp"
    
21:29:15.632348 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
21:29:15.633992 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:15.634177 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:15.637732 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.22 seconds
21:29:15.639045 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:15.639246 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:15.675856 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:15.678519 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:15.678826 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:15.720531 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:29:15.723495 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:15.723788 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:15.960650 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:29:15.963623 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:15.963887 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr'
      and table_schema = 'stg'
  
21:29:15.999734 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:16.004567 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:16.004863 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:16.005211 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:29:16.007449 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:16.007652 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr'
      and table_schema = 'stg'
  
21:29:16.044882 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:16.049291 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:16.045371 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:16.050682 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:16.050858 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    
21:29:16.049542 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:16.103721 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:16.105273 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:16.105515 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Siteproperties_Incr__dbt_tmp"
    
21:29:17.214757 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.11 seconds
21:29:17.216463 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:17.216702 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:17.231463 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.18 seconds
21:29:17.232941 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:17.233158 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:17.256260 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:17.258991 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:17.259240 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:17.275855 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:17.278395 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:17.278671 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:17.534889 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:29:17.540289 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:17.540588 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr'
      and table_schema = 'stg'
  
21:29:17.547806 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:29:17.549593 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ShippingOptions_Incr"
21:29:17.550085 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:17.550245 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ShippingOptions_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "ShippingMethodID", "ListingID", "FirstItEMAmount", "AdditionalItEMAmount", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "ShippingMethodID", "ListingID", "FirstItEMAmount", "AdditionalItEMAmount", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ShippingOptions_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:29:17.591546 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:17.596238 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:17.596541 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:17.643304 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:17.645171 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:17.645421 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Siteproperties_Incr__dbt_tmp"
    
21:29:18.956332 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.31 seconds
21:29:18.957954 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:18.958130 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:19.008173 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:19.010902 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:19.011095 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:19.314753 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:29:19.317135 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Siteproperties_Incr"
21:29:19.317719 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:19.317903 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Siteproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr" (
                  "ID", "DecimalnativeValue", "BoolnativeValue", "IntnativeValue", "CustomFieldID", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DecimalnativeValue", "BoolnativeValue", "IntnativeValue", "CustomFieldID", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Siteproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:29:19.376207 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.83 seconds
21:29:19.378060 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ShippingOptions_Incr: COMMIT
21:29:19.378916 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:29:19.379103 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."#AH_ShippingOptions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    end

21:29:19.433173 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:19.446977 [debug] [Thread-2  ]: finished collecting timing info
21:29:19.447376 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ShippingOptions_Incr: Close
21:29:19.448140 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5598062e0>]}
21:29:19.448647 [info ] [Thread-2  ]: 85 of 101 OK snapshotted stg.AH_ShippingOptions_Incr............................ [[32mOK[0m in 15.19s]
21:29:19.449034 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ShippingOptions_Incr
21:29:19.449210 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_SubmittedListingPayment_Incr
21:29:19.449565 [info ] [Thread-2  ]: 89 of 101 START snapshot stg.AH_SubmittedListingPayment_Incr.................... [RUN]
21:29:19.449975 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr"
21:29:19.450141 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_SubmittedListingPayment_Incr
21:29:19.450278 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_SubmittedListingPayment_Incr
21:29:19.453198 [debug] [Thread-2  ]: finished collecting timing info
21:29:19.453402 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_SubmittedListingPayment_Incr
21:29:19.456575 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:19.456773 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:29:19.456899 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:29:19.457030 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:29:19.597555 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:29:19.643967 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:29:19.667602 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:19.667997 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:29:19.732015 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:29:19.734272 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:19.734889 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_SubmittedListingPayment_InterView]
        ) as __dbt_sbq
    
21:29:19.813841 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:29:19.836554 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:19.836925 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr"
        ) as __dbt_sbq
    
21:29:19.894136 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.78 seconds
21:29:19.897591 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:19.897824 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:19.909632 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:29:19.912714 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:19.912933 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr'
      and table_schema = 'stg'
  
21:29:19.936492 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:19.938337 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:19.938602 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_States_Incr__dbt_tmp"
    
21:29:19.991049 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:29:19.994619 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:19.994893 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
        
  
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_SubmittedListingPayment_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:19.716729'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:19.716729'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:29:19.716729''), CONVERT(DATETIME2, ''2022-09-18 21:29:19.716729'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:29:19.716729'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:19.716729'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:19.716729'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:29:19.716729'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.ConsignorID != source_data.ConsignorID
        or
        (
            ((snapshotted_data.ConsignorID is null) and not (source_data.ConsignorID is null))
            or
            ((not snapshotted_data.ConsignorID is null) and (source_data.ConsignorID is null))
        ) or snapshotted_data.HasproMarketing != source_data.HasproMarketing
        or
        (
            ((snapshotted_data.HasproMarketing is null) and not (source_data.HasproMarketing is null))
            or
            ((not snapshotted_data.HasproMarketing is null) and (source_data.HasproMarketing is null))
        ) or snapshotted_data.HasproPhotography != source_data.HasproPhotography
        or
        (
            ((snapshotted_data.HasproPhotography is null) and not (source_data.HasproPhotography is null))
            or
            ((not snapshotted_data.HasproPhotography is null) and (source_data.HasproPhotography is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.ConsignorID != source_data.ConsignorID
        or
        (
            ((snapshotted_data.ConsignorID is null) and not (source_data.ConsignorID is null))
            or
            ((not snapshotted_data.ConsignorID is null) and (source_data.ConsignorID is null))
        ) or snapshotted_data.HasproMarketing != source_data.HasproMarketing
        or
        (
            ((snapshotted_data.HasproMarketing is null) and not (source_data.HasproMarketing is null))
            or
            ((not snapshotted_data.HasproMarketing is null) and (source_data.HasproMarketing is null))
        ) or snapshotted_data.HasproPhotography != source_data.HasproPhotography
        or
        (
            ((snapshotted_data.HasproPhotography is null) and not (source_data.HasproPhotography is null))
            or
            ((not snapshotted_data.HasproPhotography is null) and (source_data.HasproPhotography is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view"
    end



    
21:29:20.440520 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.11 seconds
21:29:20.444276 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:20.444588 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:20.486734 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:20.488338 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:20.488577 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    
21:29:20.725164 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.41 seconds
21:29:20.726905 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Siteproperties_Incr: COMMIT
21:29:20.727650 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:29:20.727790 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."#AH_Siteproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Siteproperties_Incr__dbt_tmp"
    end

21:29:20.803689 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:29:20.818236 [debug] [Thread-4  ]: finished collecting timing info
21:29:20.818662 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Siteproperties_Incr: Close
21:29:20.819435 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55846c130>]}
21:29:20.819933 [info ] [Thread-4  ]: 86 of 101 OK snapshotted stg.AH_Siteproperties_Incr............................. [[32mOK[0m in 16.40s]
21:29:20.820306 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Siteproperties_Incr
21:29:20.820482 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_SysDiagrams_Incr
21:29:20.820825 [info ] [Thread-4  ]: 90 of 101 START snapshot stg.AH_SysDiagrams_Incr................................ [RUN]
21:29:20.821242 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr"
21:29:20.821388 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_SysDiagrams_Incr
21:29:20.821518 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_SysDiagrams_Incr
21:29:20.824295 [debug] [Thread-4  ]: finished collecting timing info
21:29:20.824497 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_SysDiagrams_Incr
21:29:20.827500 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:20.827687 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:29:20.827824 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:29:20.827957 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:29:20.874281 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
21:29:20.875883 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:20.876112 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:20.930090 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:29:20.949291 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:29:20.952084 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:20.952381 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:20.958481 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:29:20.981334 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:20.981802 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:29:21.023574 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:21.025820 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:21.026068 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_SysDiagrams_InterView]
        ) as __dbt_sbq
    
21:29:21.079347 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:21.101383 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:21.101749 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr"
        ) as __dbt_sbq
    
21:29:21.174342 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:29:21.177595 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:21.177873 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr'
      and table_schema = 'stg'
  
21:29:21.214531 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:21.214870 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:29:21.218524 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:21.222782 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr'
      and table_schema = 'stg'
  
21:29:21.222516 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:21.223065 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:21.269891 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:21.271539 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:21.271778 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_States_Incr__dbt_tmp"
    
21:29:21.301147 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:29:21.304480 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:21.304710 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
        
  
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SysDiagrams_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_SysDiagrams_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_SysDiagrams_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_SysDiagrams_InterView]

    ),

    snapshotted_data as (

        select *,
            Diagram_ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            Diagram_ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:20.997995'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:20.997995'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:29:20.997995''), CONVERT(DATETIME2, ''2022-09-18 21:29:20.997995'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(Diagram_ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:29:20.997995'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            Diagram_ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:20.997995'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:20.997995'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:29:20.997995'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.Diagram_ID != source_data.Diagram_ID
        or
        (
            ((snapshotted_data.Diagram_ID is null) and not (source_data.Diagram_ID is null))
            or
            ((not snapshotted_data.Diagram_ID is null) and (source_data.Diagram_ID is null))
        ) or snapshotted_data.Version != source_data.Version
        or
        (
            ((snapshotted_data.Version is null) and not (source_data.Version is null))
            or
            ((not snapshotted_data.Version is null) and (source_data.Version is null))
        ) or snapshotted_data.Principal_ID != source_data.Principal_ID
        or
        (
            ((snapshotted_data.Principal_ID is null) and not (source_data.Principal_ID is null))
            or
            ((not snapshotted_data.Principal_ID is null) and (source_data.Principal_ID is null))
        ) or snapshotted_data.Definition != source_data.Definition
        or
        (
            ((snapshotted_data.Definition is null) and not (source_data.Definition is null))
            or
            ((not snapshotted_data.Definition is null) and (source_data.Definition is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.Diagram_ID != source_data.Diagram_ID
        or
        (
            ((snapshotted_data.Diagram_ID is null) and not (source_data.Diagram_ID is null))
            or
            ((not snapshotted_data.Diagram_ID is null) and (source_data.Diagram_ID is null))
        ) or snapshotted_data.Version != source_data.Version
        or
        (
            ((snapshotted_data.Version is null) and not (source_data.Version is null))
            or
            ((not snapshotted_data.Version is null) and (source_data.Version is null))
        ) or snapshotted_data.Principal_ID != source_data.Principal_ID
        or
        (
            ((snapshotted_data.Principal_ID is null) and not (source_data.Principal_ID is null))
            or
            ((not snapshotted_data.Principal_ID is null) and (source_data.Principal_ID is null))
        ) or snapshotted_data.Definition != source_data.Definition
        or
        (
            ((snapshotted_data.Definition is null) and not (source_data.Definition is null))
            or
            ((not snapshotted_data.Definition is null) and (source_data.Definition is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SysDiagrams_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SysDiagrams_Incr__dbt_tmp_temp_view"
    end



    
21:29:21.425338 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
21:29:21.427127 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:21.427440 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:21.502350 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:29:21.505049 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:21.505348 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:21.756402 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:29:21.759679 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:21.759918 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr'
      and table_schema = 'stg'
  
21:29:21.793600 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:29:21.797964 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:21.798238 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:21.836283 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:21.837944 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:21.838195 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    
21:29:22.349636 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.08 seconds
21:29:22.351376 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:22.351618 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:22.387516 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:22.390176 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:22.390423 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:22.605546 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:29:22.608837 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:22.609154 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr'
      and table_schema = 'stg'
  
21:29:22.662516 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:22.667129 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:22.667493 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:22.720116 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:22.721696 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:22.721967 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_States_Incr__dbt_tmp"
    
21:29:22.741237 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.90 seconds
21:29:22.742985 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:22.743246 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:22.790740 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:22.793476 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:22.793772 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:23.033139 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:29:23.036428 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:23.036730 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr'
      and table_schema = 'stg'
  
21:29:23.078075 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:23.082492 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:23.082803 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:23.149426 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:29:23.150971 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:23.151194 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    
21:29:23.617000 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.89 seconds
21:29:23.618728 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:23.618987 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:23.679920 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:29:23.682950 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:23.683224 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:23.883797 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:29:23.886035 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_States_Incr"
21:29:23.886629 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:23.886807 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_States_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_States_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_States_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_States_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_States_Incr" (
                  "ID", "Name", "Code", "CreatedOn", "UpdatedOn", "DeletedOn", "Enabled", "CountryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Code", "CreatedOn", "UpdatedOn", "DeletedOn", "Enabled", "CountryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_States_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:29:24.037500 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.89 seconds
21:29:24.039311 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:24.039540 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:24.122799 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:29:24.125446 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:24.125704 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:24.408959 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:29:24.411213 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_StripeCustomers_Incr"
21:29:24.411749 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:24.411918 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_StripeCustomers_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr" (
                  "ID", "SellerID", "BuyerID", "CreatedOn", "UpdatedOn", "DeletedOn", "CustomerID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SellerID", "BuyerID", "CreatedOn", "UpdatedOn", "DeletedOn", "CustomerID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_StripeCustomers_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:29:25.348892 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.46 seconds
21:29:25.350661 [debug] [Thread-1  ]: On snapshot.Shawn.AH_States_Incr: COMMIT
21:29:25.351423 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:29:25.351564 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."#AH_States_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_States_Incr__dbt_tmp"
    end

21:29:25.437563 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:29:25.452633 [debug] [Thread-1  ]: finished collecting timing info
21:29:25.453063 [debug] [Thread-1  ]: On snapshot.Shawn.AH_States_Incr: Close
21:29:25.453885 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559806430>]}
21:29:25.580781 [info ] [Thread-1  ]: 87 of 101 OK snapshotted stg.AH_States_Incr..................................... [[32mOK[0m in 12.84s]
21:29:25.581794 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_States_Incr
21:29:25.582015 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ThReadTracking_Incr
21:29:25.582412 [info ] [Thread-1  ]: 91 of 101 START snapshot stg.AH_ThReadTracking_Incr............................. [RUN]
21:29:25.582966 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr"
21:29:25.583134 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ThReadTracking_Incr
21:29:25.583269 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ThReadTracking_Incr
21:29:25.586145 [debug] [Thread-1  ]: finished collecting timing info
21:29:25.586362 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ThReadTracking_Incr
21:29:25.589397 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:25.589607 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:29:25.589729 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:29:25.589860 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:29:25.707380 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:29:25.795787 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:29:25.819673 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:25.820063 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:29:25.853553 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:29:25.855872 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:25.856155 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ThReadTracking_InterView]
        ) as __dbt_sbq
    
21:29:26.223183 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.81 seconds
21:29:26.225016 [debug] [Thread-3  ]: On snapshot.Shawn.AH_StripeCustomers_Incr: COMMIT
21:29:26.225884 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:29:26.226079 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."#AH_StripeCustomers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    end

21:29:26.310806 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:29:26.324584 [debug] [Thread-3  ]: finished collecting timing info
21:29:26.325010 [debug] [Thread-3  ]: On snapshot.Shawn.AH_StripeCustomers_Incr: Close
21:29:26.325842 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559806580>]}
21:29:26.326400 [info ] [Thread-3  ]: 88 of 101 OK snapshotted stg.AH_StripeCustomers_Incr............................ [[32mOK[0m in 12.50s]
21:29:26.326858 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_StripeCustomers_Incr
21:29:26.327050 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Tiers_Incr
21:29:26.327425 [info ] [Thread-3  ]: 92 of 101 START snapshot stg.AH_Tiers_Incr...................................... [RUN]
21:29:26.327863 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Tiers_Incr"
21:29:26.328017 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Tiers_Incr
21:29:26.328149 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Tiers_Incr
21:29:26.331088 [debug] [Thread-3  ]: finished collecting timing info
21:29:26.331285 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Tiers_Incr
21:29:26.334056 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:26.334233 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:29:26.334350 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:29:26.334477 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:29:26.455701 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:29:26.485949 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:29:26.508491 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:26.508876 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:29:26.511056 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.65 seconds
21:29:26.532770 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:26.533180 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr"
        ) as __dbt_sbq
    
21:29:26.553172 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:26.555723 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:26.556012 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Tiers_InterView]
        ) as __dbt_sbq
    
21:29:26.607208 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:29:26.610692 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:26.610934 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr'
      and table_schema = 'stg'
  
21:29:26.662694 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:29:26.686106 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:26.686512 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Tiers_Incr"
        ) as __dbt_sbq
    
21:29:26.760904 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:29:26.764388 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:26.764670 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
        
  
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ThReadTracking_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ThReadTracking_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ThReadTracking_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ThReadTracking_InterView]

    ),

    snapshotted_data as (

        select *,
            ThReadGUID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ThReadGUID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:25.826231'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:25.826231'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:29:25.826231''), CONVERT(DATETIME2, ''2022-09-18 21:29:25.826231'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ThReadGUID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:29:25.826231'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ThReadGUID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:25.826231'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:25.826231'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:29:25.826231'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ThReadGUID != source_data.ThReadGUID
        or
        (
            ((snapshotted_data.ThReadGUID is null) and not (source_data.ThReadGUID is null))
            or
            ((not snapshotted_data.ThReadGUID is null) and (source_data.ThReadGUID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.PrimarythRead != source_data.PrimarythRead
        or
        (
            ((snapshotted_data.PrimarythRead is null) and not (source_data.PrimarythRead is null))
            or
            ((not snapshotted_data.PrimarythRead is null) and (source_data.PrimarythRead is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ThReadGUID != source_data.ThReadGUID
        or
        (
            ((snapshotted_data.ThReadGUID is null) and not (source_data.ThReadGUID is null))
            or
            ((not snapshotted_data.ThReadGUID is null) and (source_data.ThReadGUID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.PrimarythRead != source_data.PrimarythRead
        or
        (
            ((snapshotted_data.PrimarythRead is null) and not (source_data.PrimarythRead is null))
            or
            ((not snapshotted_data.PrimarythRead is null) and (source_data.PrimarythRead is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ThReadTracking_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ThReadTracking_Incr__dbt_tmp_temp_view"
    end



    
21:29:26.765954 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:29:26.769119 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:26.769308 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr'
      and table_schema = 'stg'
  
21:29:26.865790 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:29:26.869460 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:26.869723 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
        
  
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Tiers_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Tiers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Tiers_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Tiers_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Tiers_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Tiers_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:26.513693'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:26.513693'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:29:26.513693''), CONVERT(DATETIME2, ''2022-09-18 21:29:26.513693'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:29:26.513693'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:26.513693'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:26.513693'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:29:26.513693'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Upperboundexclusive != source_data.Upperboundexclusive
        or
        (
            ((snapshotted_data.Upperboundexclusive is null) and not (source_data.Upperboundexclusive is null))
            or
            ((not snapshotted_data.Upperboundexclusive is null) and (source_data.Upperboundexclusive is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.Lowerboundinclusive != source_data.Lowerboundinclusive
        or
        (
            ((snapshotted_data.Lowerboundinclusive is null) and not (source_data.Lowerboundinclusive is null))
            or
            ((not snapshotted_data.Lowerboundinclusive is null) and (source_data.Lowerboundinclusive is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.FeescheduleID != source_data.FeescheduleID
        or
        (
            ((snapshotted_data.FeescheduleID is null) and not (source_data.FeescheduleID is null))
            or
            ((not snapshotted_data.FeescheduleID is null) and (source_data.FeescheduleID is null))
        ) or snapshotted_data.ValueType != source_data.ValueType
        or
        (
            ((snapshotted_data.ValueType is null) and not (source_data.ValueType is null))
            or
            ((not snapshotted_data.ValueType is null) and (source_data.ValueType is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Upperboundexclusive != source_data.Upperboundexclusive
        or
        (
            ((snapshotted_data.Upperboundexclusive is null) and not (source_data.Upperboundexclusive is null))
            or
            ((not snapshotted_data.Upperboundexclusive is null) and (source_data.Upperboundexclusive is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.Lowerboundinclusive != source_data.Lowerboundinclusive
        or
        (
            ((snapshotted_data.Lowerboundinclusive is null) and not (source_data.Lowerboundinclusive is null))
            or
            ((not snapshotted_data.Lowerboundinclusive is null) and (source_data.Lowerboundinclusive is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.FeescheduleID != source_data.FeescheduleID
        or
        (
            ((snapshotted_data.FeescheduleID is null) and not (source_data.FeescheduleID is null))
            or
            ((not snapshotted_data.FeescheduleID is null) and (source_data.FeescheduleID is null))
        ) or snapshotted_data.ValueType != source_data.ValueType
        or
        (
            ((snapshotted_data.ValueType is null) and not (source_data.ValueType is null))
            or
            ((not snapshotted_data.ValueType is null) and (source_data.ValueType is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Tiers_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Tiers_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Tiers_Incr__dbt_tmp_temp_view"
    end



    
21:29:27.795953 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.80 seconds
21:29:27.799480 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:27.799690 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:27.850701 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:27.852723 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:27.852970 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    
21:29:28.406206 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 7.10 seconds
21:29:28.409761 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:28.410043 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:28.453538 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:28.455173 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:28.455420 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    
21:29:28.977804 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.12 seconds
21:29:28.979393 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:28.979569 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:29.057421 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:29:29.060075 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:29.060290 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:29.298596 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:29:29.301721 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:29.301983 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr'
      and table_schema = 'stg'
  
21:29:29.337650 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:29.342014 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:29.342298 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:29.381874 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:29.383469 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:29.383726 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    
21:29:29.773403 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.32 seconds
21:29:29.775178 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:29.775492 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:29.911688 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:29:29.914534 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:29.914826 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:30.187671 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:29:30.190873 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:30.191132 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr'
      and table_schema = 'stg'
  
21:29:30.229519 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:30.233700 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:30.234013 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:30.286252 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:30.287825 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:30.288076 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    
21:29:30.430609 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
21:29:30.432275 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:30.432521 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:30.473329 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:30.476348 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:30.476701 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:30.735804 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:29:30.740948 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:30.741231 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr'
      and table_schema = 'stg'
  
21:29:30.801707 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:29:30.806144 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:30.806487 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:30.850127 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:30.851768 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:30.852023 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    
21:29:31.127198 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 4.36 seconds
21:29:31.130766 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:31.131094 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:31.176161 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:31.177785 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:31.178060 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    
21:29:31.258158 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
21:29:31.259920 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:31.260172 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:31.346221 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:29:31.348943 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:31.349273 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:31.606320 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:29:31.611766 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:31.612135 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr'
      and table_schema = 'stg'
  
21:29:31.648246 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:31.652791 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:31.653108 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:31.705023 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:31.706682 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:31.706922 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    
21:29:31.753033 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.90 seconds
21:29:31.754787 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:31.755034 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:31.788591 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:29:31.791344 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:31.791639 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:32.118708 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
21:29:32.120959 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_SubmittedListingPayment_Incr"
21:29:32.121593 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:32.121786 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr" (
                  "ID", "TransactionID", "Amount", "CreatedOn", "UpdatedOn", "ListingID", "ConsignorID", "HasproMarketing", "HasproPhotography", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "TransactionID", "Amount", "CreatedOn", "UpdatedOn", "ListingID", "ConsignorID", "HasproMarketing", "HasproPhotography", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:29:32.411771 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.23 seconds
21:29:32.413545 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:32.413815 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:32.488298 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:29:32.491051 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:32.491360 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:32.897305 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
21:29:32.900527 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:32.900730 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr'
      and table_schema = 'stg'
  
21:29:32.934302 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.23 seconds
21:29:32.936001 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:32.936246 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:32.936578 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:32.940335 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:32.940533 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:32.990242 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:32.994075 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:32.994523 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:32.994410 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:32.995680 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:32.995863 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    
21:29:33.244218 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:29:33.246380 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_SysDiagrams_Incr"
21:29:33.246964 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:33.247126 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_SysDiagrams_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr" (
                  "Diagram_ID", "Version", "Principal_ID", "Definition", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "Diagram_ID", "Version", "Principal_ID", "Definition", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_SysDiagrams_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:29:33.672642 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.55 seconds
21:29:33.674307 [debug] [Thread-2  ]: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: COMMIT
21:29:33.675122 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:29:33.675274 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    end

21:29:33.723847 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:33.739384 [debug] [Thread-2  ]: finished collecting timing info
21:29:33.739810 [debug] [Thread-2  ]: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: Close
21:29:33.740605 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5598066d0>]}
21:29:33.741120 [info ] [Thread-2  ]: 89 of 101 OK snapshotted stg.AH_SubmittedListingPayment_Incr.................... [[32mOK[0m in 14.29s]
21:29:33.741511 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_SubmittedListingPayment_Incr
21:29:33.741696 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_UserAlerts_Incr
21:29:33.742027 [info ] [Thread-2  ]: 93 of 101 START snapshot stg.AH_UserAlerts_Incr................................. [RUN]
21:29:33.742439 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_UserAlerts_Incr"
21:29:33.742630 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_UserAlerts_Incr
21:29:33.742778 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_UserAlerts_Incr
21:29:33.745538 [debug] [Thread-2  ]: finished collecting timing info
21:29:33.745789 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_UserAlerts_Incr
21:29:33.748717 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:33.748906 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:29:33.749025 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:29:33.749151 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:29:33.874196 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:29:33.906632 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:29:33.929139 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:33.929545 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:29:33.936302 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
21:29:33.937798 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:33.938008 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:33.958771 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:29:33.961321 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:33.961561 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_UserAlerts_InterView]
        ) as __dbt_sbq
    
21:29:33.987292 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:33.990821 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:33.992243 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:34.059289 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:29:34.081178 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:34.081592 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr"
        ) as __dbt_sbq
    
21:29:34.176846 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:29:34.180781 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:34.181076 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr'
      and table_schema = 'stg'
  
21:29:34.230231 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:29:34.233463 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:34.233753 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr'
      and table_schema = 'stg'
  
21:29:34.253827 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:29:34.257531 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:34.257821 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
        
  
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserAlerts_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UserAlerts_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserAlerts_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UserAlerts_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_UserAlerts_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:33.935720'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:33.935720'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:29:33.935720''), CONVERT(DATETIME2, ''2022-09-18 21:29:33.935720'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:29:33.935720'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:33.935720'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:33.935720'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:29:33.935720'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.MakeID != source_data.MakeID
        or
        (
            ((snapshotted_data.MakeID is null) and not (source_data.MakeID is null))
            or
            ((not snapshotted_data.MakeID is null) and (source_data.MakeID is null))
        ) or snapshotted_data.ModelID != source_data.ModelID
        or
        (
            ((snapshotted_data.ModelID is null) and not (source_data.ModelID is null))
            or
            ((not snapshotted_data.ModelID is null) and (source_data.ModelID is null))
        ) or snapshotted_data.YearFrom != source_data.YearFrom
        or
        (
            ((snapshotted_data.YearFrom is null) and not (source_data.YearFrom is null))
            or
            ((not snapshotted_data.YearFrom is null) and (source_data.YearFrom is null))
        ) or snapshotted_data.Yearto != source_data.Yearto
        or
        (
            ((snapshotted_data.Yearto is null) and not (source_data.Yearto is null))
            or
            ((not snapshotted_data.Yearto is null) and (source_data.Yearto is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.MakeID != source_data.MakeID
        or
        (
            ((snapshotted_data.MakeID is null) and not (source_data.MakeID is null))
            or
            ((not snapshotted_data.MakeID is null) and (source_data.MakeID is null))
        ) or snapshotted_data.ModelID != source_data.ModelID
        or
        (
            ((snapshotted_data.ModelID is null) and not (source_data.ModelID is null))
            or
            ((not snapshotted_data.ModelID is null) and (source_data.ModelID is null))
        ) or snapshotted_data.YearFrom != source_data.YearFrom
        or
        (
            ((snapshotted_data.YearFrom is null) and not (source_data.YearFrom is null))
            or
            ((not snapshotted_data.YearFrom is null) and (source_data.YearFrom is null))
        ) or snapshotted_data.Yearto != source_data.Yearto
        or
        (
            ((snapshotted_data.Yearto is null) and not (source_data.Yearto is null))
            or
            ((not snapshotted_data.Yearto is null) and (source_data.Yearto is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_UserAlerts_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UserAlerts_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserAlerts_Incr__dbt_tmp_temp_view"
    end



    
21:29:34.269596 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:34.273738 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:34.274030 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:34.334279 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:29:34.335809 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:34.336029 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    
21:29:34.641594 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.39 seconds
21:29:34.643452 [debug] [Thread-4  ]: On snapshot.Shawn.AH_SysDiagrams_Incr: COMMIT
21:29:34.644314 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:29:34.644500 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."#AH_SysDiagrams_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    end

21:29:34.695446 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:34.711383 [debug] [Thread-4  ]: finished collecting timing info
21:29:34.711807 [debug] [Thread-4  ]: On snapshot.Shawn.AH_SysDiagrams_Incr: Close
21:29:34.712599 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559806820>]}
21:29:34.713143 [info ] [Thread-4  ]: 90 of 101 OK snapshotted stg.AH_SysDiagrams_Incr................................ [[32mOK[0m in 13.89s]
21:29:34.713543 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_SysDiagrams_Incr
21:29:34.713726 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_UserMessages_Incr
21:29:34.714062 [info ] [Thread-4  ]: 94 of 101 START snapshot stg.AH_UserMessages_Incr............................... [RUN]
21:29:34.714494 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_UserMessages_Incr"
21:29:34.714699 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_UserMessages_Incr
21:29:34.714843 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_UserMessages_Incr
21:29:34.717625 [debug] [Thread-4  ]: finished collecting timing info
21:29:34.717899 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_UserMessages_Incr
21:29:34.720801 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:29:34.720989 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:29:34.721110 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:29:34.721260 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:29:34.827549 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:29:34.857414 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:29:34.880072 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:29:34.880477 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:29:34.911994 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:29:34.914219 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:29:34.914505 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_UserMessages_InterView]
        ) as __dbt_sbq
    
21:29:34.984203 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:29:35.006646 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:29:35.007017 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr"
        ) as __dbt_sbq
    
21:29:35.248256 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.91 seconds
21:29:35.249939 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:35.250184 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:35.288346 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:35.291027 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:35.291415 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:29:35.291543 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:35.295388 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:29:35.295827 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr'
      and table_schema = 'stg'
  
21:29:35.313371 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 8.44 seconds
21:29:35.316889 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:35.317198 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:35.355467 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:35.357080 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:35.357322 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Tiers_Incr__dbt_tmp"
    
21:29:35.372316 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:29:35.376080 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:29:35.376390 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
        
  
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserMessages_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UserMessages_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserMessages_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UserMessages_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_UserMessages_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:34.888855'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:34.888855'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:29:34.888855''), CONVERT(DATETIME2, ''2022-09-18 21:29:34.888855'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:29:34.888855'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:34.888855'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:34.888855'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:29:34.888855'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SEnderID != source_data.SEnderID
        or
        (
            ((snapshotted_data.SEnderID is null) and not (source_data.SEnderID is null))
            or
            ((not snapshotted_data.SEnderID is null) and (source_data.SEnderID is null))
        ) or snapshotted_data.RecipientID != source_data.RecipientID
        or
        (
            ((snapshotted_data.RecipientID is null) and not (source_data.RecipientID is null))
            or
            ((not snapshotted_data.RecipientID is null) and (source_data.RecipientID is null))
        ) or snapshotted_data.MasTerMessageID != source_data.MasTerMessageID
        or
        (
            ((snapshotted_data.MasTerMessageID is null) and not (source_data.MasTerMessageID is null))
            or
            ((not snapshotted_data.MasTerMessageID is null) and (source_data.MasTerMessageID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Sent != source_data.Sent
        or
        (
            ((snapshotted_data.Sent is null) and not (source_data.Sent is null))
            or
            ((not snapshotted_data.Sent is null) and (source_data.Sent is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.SuBJect != source_data.SuBJect
        or
        (
            ((snapshotted_data.SuBJect is null) and not (source_data.SuBJect is null))
            or
            ((not snapshotted_data.SuBJect is null) and (source_data.SuBJect is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.SEnderStatus != source_data.SEnderStatus
        or
        (
            ((snapshotted_data.SEnderStatus is null) and not (source_data.SEnderStatus is null))
            or
            ((not snapshotted_data.SEnderStatus is null) and (source_data.SEnderStatus is null))
        ) or snapshotted_data.RecipientStatus != source_data.RecipientStatus
        or
        (
            ((snapshotted_data.RecipientStatus is null) and not (source_data.RecipientStatus is null))
            or
            ((not snapshotted_data.RecipientStatus is null) and (source_data.RecipientStatus is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SEnderID != source_data.SEnderID
        or
        (
            ((snapshotted_data.SEnderID is null) and not (source_data.SEnderID is null))
            or
            ((not snapshotted_data.SEnderID is null) and (source_data.SEnderID is null))
        ) or snapshotted_data.RecipientID != source_data.RecipientID
        or
        (
            ((snapshotted_data.RecipientID is null) and not (source_data.RecipientID is null))
            or
            ((not snapshotted_data.RecipientID is null) and (source_data.RecipientID is null))
        ) or snapshotted_data.MasTerMessageID != source_data.MasTerMessageID
        or
        (
            ((snapshotted_data.MasTerMessageID is null) and not (source_data.MasTerMessageID is null))
            or
            ((not snapshotted_data.MasTerMessageID is null) and (source_data.MasTerMessageID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Sent != source_data.Sent
        or
        (
            ((snapshotted_data.Sent is null) and not (source_data.Sent is null))
            or
            ((not snapshotted_data.Sent is null) and (source_data.Sent is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.SuBJect != source_data.SuBJect
        or
        (
            ((snapshotted_data.SuBJect is null) and not (source_data.SuBJect is null))
            or
            ((not snapshotted_data.SuBJect is null) and (source_data.SuBJect is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.SEnderStatus != source_data.SEnderStatus
        or
        (
            ((snapshotted_data.SEnderStatus is null) and not (source_data.SEnderStatus is null))
            or
            ((not snapshotted_data.SEnderStatus is null) and (source_data.SEnderStatus is null))
        ) or snapshotted_data.RecipientStatus != source_data.RecipientStatus
        or
        (
            ((snapshotted_data.RecipientStatus is null) and not (source_data.RecipientStatus is null))
            or
            ((not snapshotted_data.RecipientStatus is null) and (source_data.RecipientStatus is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_UserMessages_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UserMessages_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserMessages_Incr__dbt_tmp_temp_view"
    end



    
21:29:35.501382 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:29:35.503571 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ThReadTracking_Incr"
21:29:35.504217 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:35.504399 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ThReadTracking_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr" (
                  "ThReadGUID", "Name", "DaTestamp", "PrimarythRead", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ThReadGUID", "Name", "DaTestamp", "PrimarythRead", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ThReadTracking_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:29:36.657079 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.30 seconds
21:29:36.658748 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:36.658945 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:36.882922 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:29:36.885984 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:36.886214 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:37.312724 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
21:29:37.315658 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:37.315883 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr'
      and table_schema = 'stg'
  
21:29:37.352379 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:37.356775 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:37.357128 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:37.411135 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:37.412725 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:37.412955 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Tiers_Incr__dbt_tmp"
    
21:29:37.551926 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.05 seconds
21:29:37.553733 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ThReadTracking_Incr: COMMIT
21:29:37.554967 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:29:37.555194 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."#AH_ThReadTracking_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    end

21:29:37.593269 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:37.607739 [debug] [Thread-1  ]: finished collecting timing info
21:29:37.608185 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ThReadTracking_Incr: Close
21:29:37.608991 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559806970>]}
21:29:37.609517 [info ] [Thread-1  ]: 91 of 101 OK snapshotted stg.AH_ThReadTracking_Incr............................. [[32mOK[0m in 12.03s]
21:29:37.609904 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ThReadTracking_Incr
21:29:37.610088 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_UserOptOut_Incr
21:29:37.610429 [info ] [Thread-1  ]: 95 of 101 START snapshot stg.AH_UserOptOut_Incr................................. [RUN]
21:29:37.610921 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_UserOptOut_Incr"
21:29:37.611079 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_UserOptOut_Incr
21:29:37.611210 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_UserOptOut_Incr
21:29:37.614225 [debug] [Thread-1  ]: finished collecting timing info
21:29:37.614440 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_UserOptOut_Incr
21:29:37.617435 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:37.617625 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:29:37.617746 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:29:37.617874 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:29:37.747564 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:29:37.778077 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:29:37.800578 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:37.800970 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:29:37.831329 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:29:37.833784 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:37.834037 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_UserOptOut_InterView]
        ) as __dbt_sbq
    
21:29:37.894858 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:29:37.916321 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:37.916723 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr"
        ) as __dbt_sbq
    
21:29:37.981927 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:29:37.985250 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:37.985544 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr'
      and table_schema = 'stg'
  
21:29:38.057816 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:29:38.061665 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:38.062014 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
        
  
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserOptOut_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UserOptOut_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserOptOut_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UserOptOut_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_UserOptOut_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:37.810719'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:37.810719'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:29:37.810719''), CONVERT(DATETIME2, ''2022-09-18 21:29:37.810719'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:29:37.810719'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:37.810719'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:37.810719'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:29:37.810719'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.EmailName != source_data.EmailName
        or
        (
            ((snapshotted_data.EmailName is null) and not (source_data.EmailName is null))
            or
            ((not snapshotted_data.EmailName is null) and (source_data.EmailName is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.EmailName != source_data.EmailName
        or
        (
            ((snapshotted_data.EmailName is null) and not (source_data.EmailName is null))
            or
            ((not snapshotted_data.EmailName is null) and (source_data.EmailName is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_UserOptOut_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UserOptOut_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserOptOut_Incr__dbt_tmp_temp_view"
    end



    
21:29:39.418065 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.00 seconds
21:29:39.419690 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:39.419883 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:39.482228 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:29:39.484693 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:39.484876 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:39.804375 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
21:29:39.807582 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:39.807801 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr'
      and table_schema = 'stg'
  
21:29:39.877870 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:29:39.882476 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:39.882856 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:39.934672 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:39.936531 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:39.936753 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Tiers_Incr__dbt_tmp"
    
21:29:41.773348 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.84 seconds
21:29:41.774983 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:41.775167 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:41.984367 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:29:41.987174 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:41.987443 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:42.327168 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
21:29:42.329372 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Tiers_Incr"
21:29:42.329843 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:42.329974 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Tiers_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Tiers_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Tiers_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Tiers_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Tiers_Incr" (
                  "ID", "Upperboundexclusive", "Value", "Lowerboundinclusive", "CreatedOn", "UpdatedOn", "DeletedOn", "FeescheduleID", "ValueType", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Upperboundexclusive", "Value", "Lowerboundinclusive", "CreatedOn", "UpdatedOn", "DeletedOn", "FeescheduleID", "ValueType", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Tiers_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:29:44.011302 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.68 seconds
21:29:44.013269 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Tiers_Incr: COMMIT
21:29:44.014016 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:29:44.014152 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."#AH_Tiers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Tiers_Incr__dbt_tmp"
    end

21:29:44.053045 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:44.067606 [debug] [Thread-3  ]: finished collecting timing info
21:29:44.068044 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Tiers_Incr: Close
21:29:44.068816 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559806ac0>]}
21:29:44.069333 [info ] [Thread-3  ]: 92 of 101 OK snapshotted stg.AH_Tiers_Incr...................................... [[32mOK[0m in 17.74s]
21:29:44.069715 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Tiers_Incr
21:29:44.069895 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_UserRoles_Incr
21:29:44.070222 [info ] [Thread-3  ]: 96 of 101 START snapshot stg.AH_UserRoles_Incr.................................. [RUN]
21:29:44.070662 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_UserRoles_Incr"
21:29:44.070819 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_UserRoles_Incr
21:29:44.070949 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_UserRoles_Incr
21:29:44.073628 [debug] [Thread-3  ]: finished collecting timing info
21:29:44.073817 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_UserRoles_Incr
21:29:44.076610 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:44.076787 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:29:44.076902 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:29:44.077029 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:29:44.185970 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:29:44.220488 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:29:44.242637 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:44.242982 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:29:44.289517 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:44.291761 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:44.292286 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_UserRoles_InterView]
        ) as __dbt_sbq
    
21:29:44.397796 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:29:44.420295 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:44.420656 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr"
        ) as __dbt_sbq
    
21:29:44.473052 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:44.476501 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:44.476775 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr'
      and table_schema = 'stg'
  
21:29:44.559473 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:29:44.563053 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:44.563300 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
        
  
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserRoles_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UserRoles_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserRoles_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UserRoles_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_UserRoles_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:44.263936'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:44.263936'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:29:44.263936''), CONVERT(DATETIME2, ''2022-09-18 21:29:44.263936'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:29:44.263936'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:44.263936'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:44.263936'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:29:44.263936'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.RoleID != source_data.RoleID
        or
        (
            ((snapshotted_data.RoleID is null) and not (source_data.RoleID is null))
            or
            ((not snapshotted_data.RoleID is null) and (source_data.RoleID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.RoleID != source_data.RoleID
        or
        (
            ((snapshotted_data.RoleID is null) and not (source_data.RoleID is null))
            or
            ((not snapshotted_data.RoleID is null) and (source_data.RoleID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_UserRoles_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UserRoles_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserRoles_Incr__dbt_tmp_temp_view"
    end



    
21:29:47.285232 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 9.22 seconds
21:29:47.289348 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:47.289565 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:47.337790 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:47.339460 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:47.339708 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserOptOut_Incr__dbt_tmp"
    
21:29:48.564039 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.22 seconds
21:29:48.565541 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:48.565734 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:48.671453 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:29:48.673906 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:48.674100 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:49.131804 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.46 seconds
21:29:49.212204 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:49.212549 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr'
      and table_schema = 'stg'
  
21:29:49.253614 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:49.257641 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:49.257901 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:49.302239 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:49.303841 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:49.304072 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserOptOut_Incr__dbt_tmp"
    
21:29:50.913759 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.61 seconds
21:29:50.915363 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:50.915529 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:51.130420 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:29:51.133085 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:51.133268 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:51.718742 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.59 seconds
21:29:51.721459 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:51.721671 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr'
      and table_schema = 'stg'
  
21:29:51.763306 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:51.767793 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:51.768067 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:51.836253 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:29:51.837716 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:51.837946 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserOptOut_Incr__dbt_tmp"
    
21:29:51.938638 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 17.68 seconds
21:29:51.942098 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:51.942421 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:52.044197 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:29:52.045774 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:52.046026 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserAlerts_Incr__dbt_tmp"
    
21:29:52.994656 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
21:29:52.996209 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:52.996390 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:53.040608 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:53.043203 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:53.043448 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:53.195763 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
21:29:53.197405 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:53.197642 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:53.295170 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:29:53.298024 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:53.298292 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:53.329360 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:29:53.331481 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_UserOptOut_Incr"
21:29:53.332057 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:53.332229 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_UserOptOut_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr" (
                  "ID", "EmailName", "UpdatedOn", "DeletedOn", "CreatedOn", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "EmailName", "UpdatedOn", "DeletedOn", "CreatedOn", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_UserOptOut_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:29:53.724467 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
21:29:53.727290 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:53.727482 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr'
      and table_schema = 'stg'
  
21:29:53.771040 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:53.775372 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:53.775694 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:53.813930 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:53.815767 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:53.816020 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserAlerts_Incr__dbt_tmp"
    
21:29:53.868871 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 9.31 seconds
21:29:53.872236 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:53.872500 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:53.919390 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:53.920943 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:53.921181 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserRoles_Incr__dbt_tmp"
    
21:29:55.677171 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.34 seconds
21:29:55.678860 [debug] [Thread-1  ]: On snapshot.Shawn.AH_UserOptOut_Incr: COMMIT
21:29:55.679580 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:29:55.679724 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."#AH_UserOptOut_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserOptOut_Incr__dbt_tmp"
    end

21:29:55.753241 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:29:55.760193 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.84 seconds
21:29:55.761430 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:55.761644 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:55.761823 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.95 seconds
21:29:55.762897 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:55.763072 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:55.770668 [debug] [Thread-1  ]: finished collecting timing info
21:29:55.770926 [debug] [Thread-1  ]: On snapshot.Shawn.AH_UserOptOut_Incr: Close
21:29:55.771567 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5582bd880>]}
21:29:55.772025 [info ] [Thread-1  ]: 95 of 101 OK snapshotted stg.AH_UserOptOut_Incr................................. [[32mOK[0m in 18.16s]
21:29:55.772387 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_UserOptOut_Incr
21:29:55.772559 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Userclaims_Incr
21:29:55.772880 [info ] [Thread-1  ]: 97 of 101 START snapshot stg.AH_Userclaims_Incr................................. [RUN]
21:29:55.773271 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Userclaims_Incr"
21:29:55.773413 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Userclaims_Incr
21:29:55.773539 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Userclaims_Incr
21:29:55.776350 [debug] [Thread-1  ]: finished collecting timing info
21:29:55.776539 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Userclaims_Incr
21:29:55.779121 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:29:55.779293 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:29:55.779407 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:29:55.779532 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:29:55.802728 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:55.805092 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:55.805396 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:55.833105 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:29:55.835709 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:55.835969 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:55.906639 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:29:55.945276 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:29:55.967348 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:29:55.967711 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:29:56.014964 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:56.017158 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:29:56.017402 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Userclaims_InterView]
        ) as __dbt_sbq
    
21:29:56.044763 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:29:56.048632 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:56.048914 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr'
      and table_schema = 'stg'
  
21:29:56.051921 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:29:56.054278 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:56.054479 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr'
      and table_schema = 'stg'
  
21:29:56.070860 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:56.087713 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:56.091812 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:56.097374 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:56.097234 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:29:56.097711 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr"
        ) as __dbt_sbq
    
21:29:56.098517 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:56.101666 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:56.101854 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:56.147120 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:56.148565 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:56.148837 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:56.149080 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:56.153148 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:56.153316 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserAlerts_Incr__dbt_tmp"
    
21:29:56.149196 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserRoles_Incr__dbt_tmp"
    
21:29:56.152241 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:29:56.153663 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr'
      and table_schema = 'stg'
  
21:29:56.233787 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:29:56.237168 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:29:56.237439 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
        
  
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Userclaims_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Userclaims_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Userclaims_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Userclaims_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Userclaims_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:55.998490'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:55.998490'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:29:55.998490''), CONVERT(DATETIME2, ''2022-09-18 21:29:55.998490'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:29:55.998490'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:29:55.998490'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:29:55.998490'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:29:55.998490'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ClaimType != source_data.ClaimType
        or
        (
            ((snapshotted_data.ClaimType is null) and not (source_data.ClaimType is null))
            or
            ((not snapshotted_data.ClaimType is null) and (source_data.ClaimType is null))
        ) or snapshotted_data.ClaimValue != source_data.ClaimValue
        or
        (
            ((snapshotted_data.ClaimValue is null) and not (source_data.ClaimValue is null))
            or
            ((not snapshotted_data.ClaimValue is null) and (source_data.ClaimValue is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ClaimType != source_data.ClaimType
        or
        (
            ((snapshotted_data.ClaimType is null) and not (source_data.ClaimType is null))
            or
            ((not snapshotted_data.ClaimType is null) and (source_data.ClaimType is null))
        ) or snapshotted_data.ClaimValue != source_data.ClaimValue
        or
        (
            ((snapshotted_data.ClaimValue is null) and not (source_data.ClaimValue is null))
            or
            ((not snapshotted_data.ClaimValue is null) and (source_data.ClaimValue is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Userclaims_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Userclaims_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Userclaims_Incr__dbt_tmp_temp_view"
    end



    
21:29:56.402762 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 21.03 seconds
21:29:56.406227 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:29:56.406465 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:56.452094 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:56.453639 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:29:56.453871 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserMessages_Incr__dbt_tmp"
    
21:29:57.729994 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.58 seconds
21:29:57.731578 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:57.731763 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:57.736343 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.58 seconds
21:29:57.737723 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:57.737936 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:57.772826 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:57.775954 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:57.776166 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:57.778243 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:57.778469 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:57.776376 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:57.796572 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.34 seconds
21:29:57.797964 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:29:57.798170 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:57.901640 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:29:57.904337 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:29:57.904595 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:58.005914 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:29:58.009153 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:58.009436 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr'
      and table_schema = 'stg'
  
21:29:58.047972 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:29:58.050251 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_UserAlerts_Incr"
21:29:58.050880 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:58.051069 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_UserAlerts_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr" (
                  "ID", "Enabled", "UserID", "MakeID", "ModelID", "YearFrom", "Yearto", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Enabled", "UserID", "MakeID", "ModelID", "YearFrom", "Yearto", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_UserAlerts_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:29:58.054724 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:58.058579 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:58.058768 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:58.100337 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:58.101724 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:58.101941 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserRoles_Incr__dbt_tmp"
    
21:29:58.165254 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:29:58.168085 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:29:58.168325 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr'
      and table_schema = 'stg'
  
21:29:58.202335 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:29:58.206685 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:29:58.206959 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:58.256183 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:58.257783 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:29:58.258015 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserMessages_Incr__dbt_tmp"
    
21:29:59.692353 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.59 seconds
21:29:59.693818 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:59.693995 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:59.715872 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.46 seconds
21:29:59.717401 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:29:59.717576 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:29:59.733786 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:59.736030 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:59.736263 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:59.763833 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:29:59.767075 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:29:59.767335 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:29:59.767495 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.72 seconds
21:29:59.768628 [debug] [Thread-2  ]: On snapshot.Shawn.AH_UserAlerts_Incr: COMMIT
21:29:59.769266 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:29:59.769429 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."#AH_UserAlerts_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserAlerts_Incr__dbt_tmp"
    end

21:29:59.813296 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:29:59.827246 [debug] [Thread-2  ]: finished collecting timing info
21:29:59.827644 [debug] [Thread-2  ]: On snapshot.Shawn.AH_UserAlerts_Incr: Close
21:29:59.828374 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559806d00>]}
21:29:59.828877 [info ] [Thread-2  ]: 93 of 101 OK snapshotted stg.AH_UserAlerts_Incr................................. [[32mOK[0m in 26.09s]
21:29:59.829255 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_UserAlerts_Incr
21:29:59.829433 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Userproperties_Incr
21:29:59.829779 [info ] [Thread-2  ]: 98 of 101 START snapshot stg.AH_Userproperties_Incr............................. [RUN]
21:29:59.830177 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Userproperties_Incr"
21:29:59.830324 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Userproperties_Incr
21:29:59.830453 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Userproperties_Incr
21:29:59.833108 [debug] [Thread-2  ]: finished collecting timing info
21:29:59.833308 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Userproperties_Incr
21:29:59.836069 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:29:59.836252 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:29:59.836370 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:29:59.836500 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:29:59.937672 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:29:59.946568 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:29:59.948614 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_UserRoles_Incr"
21:29:59.949245 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:29:59.949434 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_UserRoles_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr" (
                  "ID", "RoleID", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "RoleID", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_UserRoles_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:30:00.008572 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:30:00.030316 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:00.030749 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:30:00.070027 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:30:00.072288 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:00.072591 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Userproperties_InterView]
        ) as __dbt_sbq
    
21:30:00.073269 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
21:30:00.075581 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:30:00.075782 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr'
      and table_schema = 'stg'
  
21:30:00.110602 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:30:00.115047 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:30:00.115358 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:00.136292 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:30:00.157993 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:00.158402 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr"
        ) as __dbt_sbq
    
21:30:00.161782 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:30:00.163095 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:30:00.163292 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserMessages_Incr__dbt_tmp"
    
21:30:00.316485 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:30:00.320462 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:00.320818 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr'
      and table_schema = 'stg'
  
21:30:00.413191 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:30:00.417187 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:00.417505 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
        
  
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Userproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Userproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Userproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Userproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Userproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:30:00.045432'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:30:00.045432'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:30:00.045432''), CONVERT(DATETIME2, ''2022-09-18 21:30:00.045432'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:30:00.045432'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:30:00.045432'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:30:00.045432'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:30:00.045432'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Userproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Userproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Userproperties_Incr__dbt_tmp_temp_view"
    end



    
21:30:00.858985 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 4.62 seconds
21:30:00.862403 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:30:00.862830 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:00.912661 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:30:00.915265 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:30:00.915564 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userclaims_Incr__dbt_tmp"
    
21:30:01.676403 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.51 seconds
21:30:01.677986 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:30:01.678182 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:30:01.791830 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:30:01.794489 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:30:01.794970 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:01.822842 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.87 seconds
21:30:01.824608 [debug] [Thread-3  ]: On snapshot.Shawn.AH_UserRoles_Incr: COMMIT
21:30:01.825483 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:30:01.825691 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."#AH_UserRoles_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserRoles_Incr__dbt_tmp"
    end

21:30:01.863975 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:30:01.877526 [debug] [Thread-3  ]: finished collecting timing info
21:30:01.877965 [debug] [Thread-3  ]: On snapshot.Shawn.AH_UserRoles_Incr: Close
21:30:01.878806 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55981a040>]}
21:30:01.879324 [info ] [Thread-3  ]: 96 of 101 OK snapshotted stg.AH_UserRoles_Incr.................................. [[32mOK[0m in 17.81s]
21:30:01.879703 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_UserRoles_Incr
21:30:01.879879 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Users_Incr
21:30:01.880208 [info ] [Thread-3  ]: 99 of 101 START snapshot stg.AH_Users_Incr...................................... [RUN]
21:30:01.880645 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Users_Incr"
21:30:01.880797 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Users_Incr
21:30:01.880931 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Users_Incr
21:30:01.883848 [debug] [Thread-3  ]: finished collecting timing info
21:30:01.884147 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Users_Incr
21:30:01.887236 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:30:01.887466 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:30:01.887586 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:30:01.887714 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:30:01.996372 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:30:02.033701 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:30:02.041745 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:30:02.043866 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_UserMessages_Incr"
21:30:02.044433 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:30:02.044606 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_UserMessages_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr" (
                  "ID", "SEnderID", "RecipientID", "MasTerMessageID", "ListingID", "Sent", "CreatedOn", "UpdatedOn", "DeletedOn", "SuBJect", "Body", "SEnderStatus", "RecipientStatus", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SEnderID", "RecipientID", "MasTerMessageID", "ListingID", "Sent", "CreatedOn", "UpdatedOn", "DeletedOn", "SuBJect", "Body", "SEnderStatus", "RecipientStatus", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_UserMessages_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:30:02.059584 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:30:02.059960 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:30:02.086625 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:30:02.088774 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:30:02.089432 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Users_InterView]
        ) as __dbt_sbq
    
21:30:02.090327 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.17 seconds
21:30:02.091574 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:30:02.091762 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:30:02.151971 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:30:02.173235 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:30:02.173639 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:30:02.175867 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:30:02.176110 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:02.173872 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Users_Incr"
        ) as __dbt_sbq
    
21:30:02.560778 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.38 seconds
21:30:02.563970 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:30:02.564299 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr'
      and table_schema = 'stg'
  
21:30:02.602804 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:30:02.607007 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:30:02.607351 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:02.956323 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
21:30:02.957816 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:30:02.957999 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userclaims_Incr__dbt_tmp"
    
21:30:02.988119 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.81 seconds
21:30:02.992150 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:30:02.992464 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr'
      and table_schema = 'stg'
  
21:30:03.119411 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:30:03.123633 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:30:03.123932 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
        
  
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Users_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Users_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Users_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Users_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Users_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Users_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:30:02.061090'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:30:02.061090'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:30:02.061090''), CONVERT(DATETIME2, ''2022-09-18 21:30:02.061090'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:30:02.061090'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:30:02.061090'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:30:02.061090'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:30:02.061090'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BillingAddressID != source_data.BillingAddressID
        or
        (
            ((snapshotted_data.BillingAddressID is null) and not (source_data.BillingAddressID is null))
            or
            ((not snapshotted_data.BillingAddressID is null) and (source_data.BillingAddressID is null))
        ) or snapshotted_data.BillingCreditCardID != source_data.BillingCreditCardID
        or
        (
            ((snapshotted_data.BillingCreditCardID is null) and not (source_data.BillingCreditCardID is null))
            or
            ((not snapshotted_data.BillingCreditCardID is null) and (source_data.BillingCreditCardID is null))
        ) or snapshotted_data.PrimaryAddressID != source_data.PrimaryAddressID
        or
        (
            ((snapshotted_data.PrimaryAddressID is null) and not (source_data.PrimaryAddressID is null))
            or
            ((not snapshotted_data.PrimaryAddressID is null) and (source_data.PrimaryAddressID is null))
        ) or snapshotted_data.AccessfailedCount != source_data.AccessfailedCount
        or
        (
            ((snapshotted_data.AccessfailedCount is null) and not (source_data.AccessfailedCount is null))
            or
            ((not snapshotted_data.AccessfailedCount is null) and (source_data.AccessfailedCount is null))
        ) or snapshotted_data.IsApproved != source_data.IsApproved
        or
        (
            ((snapshotted_data.IsApproved is null) and not (source_data.IsApproved is null))
            or
            ((not snapshotted_data.IsApproved is null) and (source_data.IsApproved is null))
        ) or snapshotted_data.IsLockedOut != source_data.IsLockedOut
        or
        (
            ((snapshotted_data.IsLockedOut is null) and not (source_data.IsLockedOut is null))
            or
            ((not snapshotted_data.IsLockedOut is null) and (source_data.IsLockedOut is null))
        ) or snapshotted_data.NewsLetter != source_data.NewsLetter
        or
        (
            ((snapshotted_data.NewsLetter is null) and not (source_data.NewsLetter is null))
            or
            ((not snapshotted_data.NewsLetter is null) and (source_data.NewsLetter is null))
        ) or snapshotted_data.IsVerified != source_data.IsVerified
        or
        (
            ((snapshotted_data.IsVerified is null) and not (source_data.IsVerified is null))
            or
            ((not snapshotted_data.IsVerified is null) and (source_data.IsVerified is null))
        ) or snapshotted_data.IsActive != source_data.IsActive
        or
        (
            ((snapshotted_data.IsActive is null) and not (source_data.IsActive is null))
            or
            ((not snapshotted_data.IsActive is null) and (source_data.IsActive is null))
        ) or snapshotted_data.EmailConfirmed != source_data.EmailConfirmed
        or
        (
            ((snapshotted_data.EmailConfirmed is null) and not (source_data.EmailConfirmed is null))
            or
            ((not snapshotted_data.EmailConfirmed is null) and (source_data.EmailConfirmed is null))
        ) or snapshotted_data.PhoneNumberConfirmed != source_data.PhoneNumberConfirmed
        or
        (
            ((snapshotted_data.PhoneNumberConfirmed is null) and not (source_data.PhoneNumberConfirmed is null))
            or
            ((not snapshotted_data.PhoneNumberConfirmed is null) and (source_data.PhoneNumberConfirmed is null))
        ) or snapshotted_data.TwoFactorEnabled != source_data.TwoFactorEnabled
        or
        (
            ((snapshotted_data.TwoFactorEnabled is null) and not (source_data.TwoFactorEnabled is null))
            or
            ((not snapshotted_data.TwoFactorEnabled is null) and (source_data.TwoFactorEnabled is null))
        ) or snapshotted_data.LockOutEnabled != source_data.LockOutEnabled
        or
        (
            ((snapshotted_data.LockOutEnabled is null) and not (source_data.LockOutEnabled is null))
            or
            ((not snapshotted_data.LockOutEnabled is null) and (source_data.LockOutEnabled is null))
        ) or snapshotted_data.WebapiEnabled != source_data.WebapiEnabled
        or
        (
            ((snapshotted_data.WebapiEnabled is null) and not (source_data.WebapiEnabled is null))
            or
            ((not snapshotted_data.WebapiEnabled is null) and (source_data.WebapiEnabled is null))
        ) or snapshotted_data.CreationDate != source_data.CreationDate
        or
        (
            ((snapshotted_data.CreationDate is null) and not (source_data.CreationDate is null))
            or
            ((not snapshotted_data.CreationDate is null) and (source_data.CreationDate is null))
        ) or snapshotted_data.LastLoginDate != source_data.LastLoginDate
        or
        (
            ((snapshotted_data.LastLoginDate is null) and not (source_data.LastLoginDate is null))
            or
            ((not snapshotted_data.LastLoginDate is null) and (source_data.LastLoginDate is null))
        ) or snapshotted_data.LastActivityDate != source_data.LastActivityDate
        or
        (
            ((snapshotted_data.LastActivityDate is null) and not (source_data.LastActivityDate is null))
            or
            ((not snapshotted_data.LastActivityDate is null) and (source_data.LastActivityDate is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LockOutEndDateUTC != source_data.LockOutEndDateUTC
        or
        (
            ((snapshotted_data.LockOutEndDateUTC is null) and not (source_data.LockOutEndDateUTC is null))
            or
            ((not snapshotted_data.LockOutEndDateUTC is null) and (source_data.LockOutEndDateUTC is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.Password != source_data.Password
        or
        (
            ((snapshotted_data.Password is null) and not (source_data.Password is null))
            or
            ((not snapshotted_data.Password is null) and (source_data.Password is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.Lastip != source_data.Lastip
        or
        (
            ((snapshotted_data.Lastip is null) and not (source_data.Lastip is null))
            or
            ((not snapshotted_data.Lastip is null) and (source_data.Lastip is null))
        ) or snapshotted_data.VerificationToken != source_data.VerificationToken
        or
        (
            ((snapshotted_data.VerificationToken is null) and not (source_data.VerificationToken is null))
            or
            ((not snapshotted_data.VerificationToken is null) and (source_data.VerificationToken is null))
        ) or snapshotted_data.PasswordResetToken != source_data.PasswordResetToken
        or
        (
            ((snapshotted_data.PasswordResetToken is null) and not (source_data.PasswordResetToken is null))
            or
            ((not snapshotted_data.PasswordResetToken is null) and (source_data.PasswordResetToken is null))
        ) or snapshotted_data.ServiceAuthorizationToken != source_data.ServiceAuthorizationToken
        or
        (
            ((snapshotted_data.ServiceAuthorizationToken is null) and not (source_data.ServiceAuthorizationToken is null))
            or
            ((not snapshotted_data.ServiceAuthorizationToken is null) and (source_data.ServiceAuthorizationToken is null))
        ) or snapshotted_data.PasswordHash != source_data.PasswordHash
        or
        (
            ((snapshotted_data.PasswordHash is null) and not (source_data.PasswordHash is null))
            or
            ((not snapshotted_data.PasswordHash is null) and (source_data.PasswordHash is null))
        ) or snapshotted_data.SecURItyStamp != source_data.SecURItyStamp
        or
        (
            ((snapshotted_data.SecURItyStamp is null) and not (source_data.SecURItyStamp is null))
            or
            ((not snapshotted_data.SecURItyStamp is null) and (source_data.SecURItyStamp is null))
        ) or snapshotted_data.PhoneNumber != source_data.PhoneNumber
        or
        (
            ((snapshotted_data.PhoneNumber is null) and not (source_data.PhoneNumber is null))
            or
            ((not snapshotted_data.PhoneNumber is null) and (source_data.PhoneNumber is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BillingAddressID != source_data.BillingAddressID
        or
        (
            ((snapshotted_data.BillingAddressID is null) and not (source_data.BillingAddressID is null))
            or
            ((not snapshotted_data.BillingAddressID is null) and (source_data.BillingAddressID is null))
        ) or snapshotted_data.BillingCreditCardID != source_data.BillingCreditCardID
        or
        (
            ((snapshotted_data.BillingCreditCardID is null) and not (source_data.BillingCreditCardID is null))
            or
            ((not snapshotted_data.BillingCreditCardID is null) and (source_data.BillingCreditCardID is null))
        ) or snapshotted_data.PrimaryAddressID != source_data.PrimaryAddressID
        or
        (
            ((snapshotted_data.PrimaryAddressID is null) and not (source_data.PrimaryAddressID is null))
            or
            ((not snapshotted_data.PrimaryAddressID is null) and (source_data.PrimaryAddressID is null))
        ) or snapshotted_data.AccessfailedCount != source_data.AccessfailedCount
        or
        (
            ((snapshotted_data.AccessfailedCount is null) and not (source_data.AccessfailedCount is null))
            or
            ((not snapshotted_data.AccessfailedCount is null) and (source_data.AccessfailedCount is null))
        ) or snapshotted_data.IsApproved != source_data.IsApproved
        or
        (
            ((snapshotted_data.IsApproved is null) and not (source_data.IsApproved is null))
            or
            ((not snapshotted_data.IsApproved is null) and (source_data.IsApproved is null))
        ) or snapshotted_data.IsLockedOut != source_data.IsLockedOut
        or
        (
            ((snapshotted_data.IsLockedOut is null) and not (source_data.IsLockedOut is null))
            or
            ((not snapshotted_data.IsLockedOut is null) and (source_data.IsLockedOut is null))
        ) or snapshotted_data.NewsLetter != source_data.NewsLetter
        or
        (
            ((snapshotted_data.NewsLetter is null) and not (source_data.NewsLetter is null))
            or
            ((not snapshotted_data.NewsLetter is null) and (source_data.NewsLetter is null))
        ) or snapshotted_data.IsVerified != source_data.IsVerified
        or
        (
            ((snapshotted_data.IsVerified is null) and not (source_data.IsVerified is null))
            or
            ((not snapshotted_data.IsVerified is null) and (source_data.IsVerified is null))
        ) or snapshotted_data.IsActive != source_data.IsActive
        or
        (
            ((snapshotted_data.IsActive is null) and not (source_data.IsActive is null))
            or
            ((not snapshotted_data.IsActive is null) and (source_data.IsActive is null))
        ) or snapshotted_data.EmailConfirmed != source_data.EmailConfirmed
        or
        (
            ((snapshotted_data.EmailConfirmed is null) and not (source_data.EmailConfirmed is null))
            or
            ((not snapshotted_data.EmailConfirmed is null) and (source_data.EmailConfirmed is null))
        ) or snapshotted_data.PhoneNumberConfirmed != source_data.PhoneNumberConfirmed
        or
        (
            ((snapshotted_data.PhoneNumberConfirmed is null) and not (source_data.PhoneNumberConfirmed is null))
            or
            ((not snapshotted_data.PhoneNumberConfirmed is null) and (source_data.PhoneNumberConfirmed is null))
        ) or snapshotted_data.TwoFactorEnabled != source_data.TwoFactorEnabled
        or
        (
            ((snapshotted_data.TwoFactorEnabled is null) and not (source_data.TwoFactorEnabled is null))
            or
            ((not snapshotted_data.TwoFactorEnabled is null) and (source_data.TwoFactorEnabled is null))
        ) or snapshotted_data.LockOutEnabled != source_data.LockOutEnabled
        or
        (
            ((snapshotted_data.LockOutEnabled is null) and not (source_data.LockOutEnabled is null))
            or
            ((not snapshotted_data.LockOutEnabled is null) and (source_data.LockOutEnabled is null))
        ) or snapshotted_data.WebapiEnabled != source_data.WebapiEnabled
        or
        (
            ((snapshotted_data.WebapiEnabled is null) and not (source_data.WebapiEnabled is null))
            or
            ((not snapshotted_data.WebapiEnabled is null) and (source_data.WebapiEnabled is null))
        ) or snapshotted_data.CreationDate != source_data.CreationDate
        or
        (
            ((snapshotted_data.CreationDate is null) and not (source_data.CreationDate is null))
            or
            ((not snapshotted_data.CreationDate is null) and (source_data.CreationDate is null))
        ) or snapshotted_data.LastLoginDate != source_data.LastLoginDate
        or
        (
            ((snapshotted_data.LastLoginDate is null) and not (source_data.LastLoginDate is null))
            or
            ((not snapshotted_data.LastLoginDate is null) and (source_data.LastLoginDate is null))
        ) or snapshotted_data.LastActivityDate != source_data.LastActivityDate
        or
        (
            ((snapshotted_data.LastActivityDate is null) and not (source_data.LastActivityDate is null))
            or
            ((not snapshotted_data.LastActivityDate is null) and (source_data.LastActivityDate is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LockOutEndDateUTC != source_data.LockOutEndDateUTC
        or
        (
            ((snapshotted_data.LockOutEndDateUTC is null) and not (source_data.LockOutEndDateUTC is null))
            or
            ((not snapshotted_data.LockOutEndDateUTC is null) and (source_data.LockOutEndDateUTC is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.Password != source_data.Password
        or
        (
            ((snapshotted_data.Password is null) and not (source_data.Password is null))
            or
            ((not snapshotted_data.Password is null) and (source_data.Password is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.Lastip != source_data.Lastip
        or
        (
            ((snapshotted_data.Lastip is null) and not (source_data.Lastip is null))
            or
            ((not snapshotted_data.Lastip is null) and (source_data.Lastip is null))
        ) or snapshotted_data.VerificationToken != source_data.VerificationToken
        or
        (
            ((snapshotted_data.VerificationToken is null) and not (source_data.VerificationToken is null))
            or
            ((not snapshotted_data.VerificationToken is null) and (source_data.VerificationToken is null))
        ) or snapshotted_data.PasswordResetToken != source_data.PasswordResetToken
        or
        (
            ((snapshotted_data.PasswordResetToken is null) and not (source_data.PasswordResetToken is null))
            or
            ((not snapshotted_data.PasswordResetToken is null) and (source_data.PasswordResetToken is null))
        ) or snapshotted_data.ServiceAuthorizationToken != source_data.ServiceAuthorizationToken
        or
        (
            ((snapshotted_data.ServiceAuthorizationToken is null) and not (source_data.ServiceAuthorizationToken is null))
            or
            ((not snapshotted_data.ServiceAuthorizationToken is null) and (source_data.ServiceAuthorizationToken is null))
        ) or snapshotted_data.PasswordHash != source_data.PasswordHash
        or
        (
            ((snapshotted_data.PasswordHash is null) and not (source_data.PasswordHash is null))
            or
            ((not snapshotted_data.PasswordHash is null) and (source_data.PasswordHash is null))
        ) or snapshotted_data.SecURItyStamp != source_data.SecURItyStamp
        or
        (
            ((snapshotted_data.SecURItyStamp is null) and not (source_data.SecURItyStamp is null))
            or
            ((not snapshotted_data.SecURItyStamp is null) and (source_data.SecURItyStamp is null))
        ) or snapshotted_data.PhoneNumber != source_data.PhoneNumber
        or
        (
            ((snapshotted_data.PhoneNumber is null) and not (source_data.PhoneNumber is null))
            or
            ((not snapshotted_data.PhoneNumber is null) and (source_data.PhoneNumber is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Users_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Users_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Users_Incr__dbt_tmp_temp_view"
    end



    
21:30:04.564788 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.52 seconds
21:30:04.566484 [debug] [Thread-4  ]: On snapshot.Shawn.AH_UserMessages_Incr: COMMIT
21:30:04.567288 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:30:04.567461 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."#AH_UserMessages_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserMessages_Incr__dbt_tmp"
    end

21:30:04.619048 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:30:04.626931 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.67 seconds
21:30:04.628380 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:30:04.628616 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:30:04.635067 [debug] [Thread-4  ]: finished collecting timing info
21:30:04.635362 [debug] [Thread-4  ]: On snapshot.Shawn.AH_UserMessages_Incr: Close
21:30:04.636075 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55859b7c0>]}
21:30:04.636555 [info ] [Thread-4  ]: 94 of 101 OK snapshotted stg.AH_UserMessages_Incr............................... [[32mOK[0m in 29.92s]
21:30:04.636922 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_UserMessages_Incr
21:30:04.637097 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Version_Incr
21:30:04.637416 [info ] [Thread-4  ]: 100 of 101 START snapshot stg.AH_Version_Incr................................... [RUN]
21:30:04.637825 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Version_Incr"
21:30:04.637970 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Version_Incr
21:30:04.638099 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Version_Incr
21:30:04.640834 [debug] [Thread-4  ]: finished collecting timing info
21:30:04.641023 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Version_Incr
21:30:04.643892 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:04.644088 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:30:04.644204 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:30:04.644329 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:30:04.707215 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:30:04.709501 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:30:04.709752 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:04.745717 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:30:04.778404 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:30:04.800870 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:04.801253 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:30:04.895924 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:30:04.898117 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:04.898374 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Version_InterView]
        ) as __dbt_sbq
    
21:30:05.044848 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:30:05.089810 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:05.091065 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Version_Incr"
        ) as __dbt_sbq
    
21:30:05.310810 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.60 seconds
21:30:05.313829 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:30:05.314070 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr'
      and table_schema = 'stg'
  
21:30:05.327724 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:30:05.330921 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:05.331213 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr'
      and table_schema = 'stg'
  
21:30:05.391982 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:30:05.396096 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:30:05.396420 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:05.415851 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:30:05.419594 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:05.419935 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
        
  
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Version_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Version_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Version_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Version_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Version_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Version_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:30:04.873688'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:30:04.873688'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:30:04.873688''), CONVERT(DATETIME2, ''2022-09-18 21:30:04.873688'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:30:04.873688'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:30:04.873688'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:30:04.873688'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:30:04.873688'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.VersionNumber != source_data.VersionNumber
        or
        (
            ((snapshotted_data.VersionNumber is null) and not (source_data.VersionNumber is null))
            or
            ((not snapshotted_data.VersionNumber is null) and (source_data.VersionNumber is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.VersionNumber != source_data.VersionNumber
        or
        (
            ((snapshotted_data.VersionNumber is null) and not (source_data.VersionNumber is null))
            or
            ((not snapshotted_data.VersionNumber is null) and (source_data.VersionNumber is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Version_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Version_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Version_Incr__dbt_tmp_temp_view"
    end



    
21:30:05.459387 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:30:05.460942 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:30:05.461188 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userclaims_Incr__dbt_tmp"
    
21:30:06.793752 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.33 seconds
21:30:06.795363 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:30:06.795560 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:30:06.834480 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:30:06.836932 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:30:06.837147 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:07.262506 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
21:30:07.264677 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Userclaims_Incr"
21:30:07.265327 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:30:07.265533 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Userclaims_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr" (
                  "ID", "UserID", "ClaimType", "ClaimValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UserID", "ClaimType", "ClaimValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Userclaims_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:30:09.036816 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.77 seconds
21:30:09.038466 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Userclaims_Incr: COMMIT
21:30:09.039634 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:30:09.039787 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."#AH_Userclaims_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Userclaims_Incr__dbt_tmp"
    end

21:30:09.134111 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:30:09.146783 [debug] [Thread-1  ]: finished collecting timing info
21:30:09.147196 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Userclaims_Incr: Close
21:30:09.147907 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55981a430>]}
21:30:09.148411 [info ] [Thread-1  ]: 97 of 101 OK snapshotted stg.AH_Userclaims_Incr................................. [[32mOK[0m in 13.37s]
21:30:09.148786 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Userclaims_Incr
21:30:09.148962 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Watches_Incr
21:30:09.149279 [info ] [Thread-1  ]: 101 of 101 START snapshot stg.AH_Watches_Incr................................... [RUN]
21:30:09.149684 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Watches_Incr"
21:30:09.149827 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Watches_Incr
21:30:09.149957 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Watches_Incr
21:30:09.152689 [debug] [Thread-1  ]: finished collecting timing info
21:30:09.152884 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Watches_Incr
21:30:09.155714 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:09.155897 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:30:09.156014 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:30:09.156139 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:30:09.285108 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:30:09.336414 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:30:09.358016 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:09.358408 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:30:09.394325 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:30:09.396479 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:09.397040 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Watches_InterView]
        ) as __dbt_sbq
    
21:30:09.477326 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:30:09.498190 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:09.498610 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Watches_Incr"
        ) as __dbt_sbq
    
21:30:09.595379 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:30:09.598909 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:09.599259 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr'
      and table_schema = 'stg'
  
21:30:09.690776 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:30:09.694495 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:09.694848 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
        
  
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Watches_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Watches_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Watches_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Watches_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Watches_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Watches_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:30:09.373686'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:30:09.373686'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-18 21:30:09.373686''), CONVERT(DATETIME2, ''2022-09-18 21:30:09.373686'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-18 21:30:09.373686'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-18 21:30:09.373686'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-18 21:30:09.373686'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-18 21:30:09.373686'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Watches_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Watches_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Watches_Incr__dbt_tmp_temp_view"
    end



    
21:30:12.633830 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 7.21 seconds
21:30:12.637427 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:12.637690 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:12.918429 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:30:12.919900 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:12.920114 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Version_Incr__dbt_tmp"
    
21:30:14.683144 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.76 seconds
21:30:14.684710 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:14.684888 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:30:14.812240 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:30:14.814752 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:14.814971 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:15.176525 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
21:30:15.179437 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:15.179632 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr'
      and table_schema = 'stg'
  
21:30:15.224576 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:30:15.228468 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:15.228733 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:15.285817 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:30:15.287352 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:15.287563 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Version_Incr__dbt_tmp"
    
21:30:17.349992 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.06 seconds
21:30:17.351550 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:17.351730 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:30:17.487471 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:30:17.489928 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:17.490188 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:18.138076 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.65 seconds
21:30:18.141002 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:18.141192 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr'
      and table_schema = 'stg'
  
21:30:18.178756 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:30:18.183010 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:18.183315 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:18.363435 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:30:18.364939 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:18.365174 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Version_Incr__dbt_tmp"
    
21:30:19.802118 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.44 seconds
21:30:19.803635 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:19.803808 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:30:19.839853 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:30:19.842108 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:19.842278 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:20.281952 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.44 seconds
21:30:20.283875 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Version_Incr"
21:30:20.284298 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:20.284427 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Version_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Version_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Version_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Version_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Version_Incr" (
                  "ID", "VersionNumber", "Status", "DaTestamp", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "VersionNumber", "Status", "DaTestamp", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Version_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:30:22.753096 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.47 seconds
21:30:22.754680 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Version_Incr: COMMIT
21:30:22.757225 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:30:22.757385 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."#AH_Version_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Version_Incr__dbt_tmp"
    end

21:30:22.855617 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:30:22.867574 [debug] [Thread-4  ]: finished collecting timing info
21:30:22.867969 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Version_Incr: Close
21:30:22.868676 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55981a2e0>]}
21:30:22.869152 [info ] [Thread-4  ]: 100 of 101 OK snapshotted stg.AH_Version_Incr................................... [[32mOK[0m in 18.23s]
21:30:22.869518 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Version_Incr
21:30:29.932447 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 20.24 seconds
21:30:29.935504 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:29.935677 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:30.080429 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:30:30.082041 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:30.082211 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Watches_Incr__dbt_tmp"
    
21:30:31.262691 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.18 seconds
21:30:31.264163 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:31.264336 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:30:31.349653 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:30:31.352099 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:31.352303 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:31.638891 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:30:31.641994 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:31.642244 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr'
      and table_schema = 'stg'
  
21:30:31.649194 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 31.23 seconds
21:30:31.652180 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:31.652432 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:31.679451 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:30:31.683491 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:31.683804 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:31.740100 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:30:31.741402 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:30:31.742533 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:31.742766 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userproperties_Incr__dbt_tmp"
    
21:30:31.743292 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:31.743469 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Watches_Incr__dbt_tmp"
    
21:30:33.080840 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.34 seconds
21:30:33.082340 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:33.082512 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:30:33.118243 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
21:30:33.119858 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:33.120106 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:30:33.120372 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:30:33.122363 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:33.122581 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:33.191279 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:30:33.193935 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:33.194208 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:33.375557 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:30:33.378633 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:33.378922 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr'
      and table_schema = 'stg'
  
21:30:33.415845 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:30:33.420074 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:33.420392 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:33.422955 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:30:33.425570 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:33.425775 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr'
      and table_schema = 'stg'
  
21:30:33.456231 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:30:33.457724 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:33.457957 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Watches_Incr__dbt_tmp"
    
21:30:33.459433 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:30:33.463257 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:33.463455 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:33.503334 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:30:33.504823 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:33.505059 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userproperties_Incr__dbt_tmp"
    
21:30:35.536961 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.08 seconds
21:30:35.538452 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:35.538651 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:30:35.556664 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.05 seconds
21:30:35.558117 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:35.558324 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:30:35.602598 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:30:35.605051 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:35.605313 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:35.618493 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:30:35.621080 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:35.621307 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:36.074876 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.47 seconds
21:30:36.076707 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Watches_Incr"
21:30:36.077096 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:36.077213 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Watches_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Watches_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Watches_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Watches_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Watches_Incr" (
                  "ID", "UserID", "ListingID", "DeletedOn", "CreatedOn", "UpdatedOn", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UserID", "ListingID", "DeletedOn", "CreatedOn", "UpdatedOn", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Watches_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:30:36.146506 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.53 seconds
21:30:36.148904 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:36.149074 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr'
      and table_schema = 'stg'
  
21:30:36.214596 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:30:36.218791 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:36.219051 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:36.270055 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:30:36.272255 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:36.272529 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userproperties_Incr__dbt_tmp"
    
21:30:37.425449 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
21:30:37.427010 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:37.427193 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:30:37.462998 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:30:37.465509 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:37.465707 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:37.718698 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:30:37.720877 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Userproperties_Incr"
21:30:37.721413 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:37.722178 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Userproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr" (
                  "ID", "IntnativeValue", "UserID", "CustomFieldID", "BoolnativeValue", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "DecimalnativeValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "IntnativeValue", "UserID", "CustomFieldID", "BoolnativeValue", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "DecimalnativeValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Userproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:30:37.951597 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.87 seconds
21:30:37.953246 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Watches_Incr: COMMIT
21:30:37.954020 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
21:30:37.954200 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."#AH_Watches_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Watches_Incr__dbt_tmp"
    end

21:30:38.094693 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:30:38.108791 [debug] [Thread-1  ]: finished collecting timing info
21:30:38.109176 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Watches_Incr: Close
21:30:38.109858 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55981a6d0>]}
21:30:38.110323 [info ] [Thread-1  ]: 101 of 101 OK snapshotted stg.AH_Watches_Incr................................... [[32mOK[0m in 28.96s]
21:30:38.110754 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Watches_Incr
21:30:39.718752 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.00 seconds
21:30:39.720340 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Userproperties_Incr: COMMIT
21:30:39.721039 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:30:39.721176 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."#AH_Userproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Userproperties_Incr__dbt_tmp"
    end

21:30:39.777221 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:30:39.789604 [debug] [Thread-2  ]: finished collecting timing info
21:30:39.790000 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Userproperties_Incr: Close
21:30:39.790735 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55981a190>]}
21:30:39.791210 [info ] [Thread-2  ]: 98 of 101 OK snapshotted stg.AH_Userproperties_Incr............................. [[32mOK[0m in 39.96s]
21:30:39.791567 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Userproperties_Incr
21:30:58.924582 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 55.80 seconds
21:30:58.927675 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:30:58.927869 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:30:58.980324 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:30:58.981957 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:30:58.982208 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Users_Incr__dbt_tmp"
    
21:30:59.977271 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.99 seconds
21:30:59.978791 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:30:59.978966 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:31:00.051621 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:31:00.054728 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:31:00.055019 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:31:00.289979 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:31:00.292809 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:31:00.293034 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr'
      and table_schema = 'stg'
  
21:31:00.344240 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:31:00.349334 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:31:00.349606 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:31:00.391877 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:31:00.393415 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:31:00.393657 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Users_Incr__dbt_tmp"
    
21:31:01.422748 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
21:31:01.424249 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:31:01.424435 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:31:01.477352 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:31:01.480460 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:31:01.480717 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:31:01.713760 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:31:01.716775 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:31:01.717047 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr'
      and table_schema = 'stg'
  
21:31:01.773789 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:31:01.779561 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:31:01.779924 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:31:01.865179 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:31:01.866725 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:31:01.866950 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Users_Incr__dbt_tmp"
    
21:31:03.216285 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.35 seconds
21:31:03.217790 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:31:03.217966 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:31:03.256273 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:31:03.259451 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:31:03.259709 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:31:03.502122 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:31:03.504833 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Users_Incr"
21:31:03.505367 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:31:03.505548 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Users_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Users_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Users_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Users_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Users_Incr" (
                  "ID", "BillingAddressID", "BillingCreditCardID", "PrimaryAddressID", "AccessfailedCount", "IsApproved", "IsLockedOut", "NewsLetter", "IsVerified", "IsActive", "EmailConfirmed", "PhoneNumberConfirmed", "TwoFactorEnabled", "LockOutEnabled", "WebapiEnabled", "CreationDate", "LastLoginDate", "LastActivityDate", "CreatedOn", "UpdatedOn", "DeletedOn", "LockOutEndDateUTC", "UserName", "Email", "Password", "Comment", "LastUpdatedUser", "Culture", "Lastip", "VerificationToken", "PasswordResetToken", "ServiceAuthorizationToken", "PasswordHash", "SecURItyStamp", "PhoneNumber", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "BillingAddressID", "BillingCreditCardID", "PrimaryAddressID", "AccessfailedCount", "IsApproved", "IsLockedOut", "NewsLetter", "IsVerified", "IsActive", "EmailConfirmed", "PhoneNumberConfirmed", "TwoFactorEnabled", "LockOutEnabled", "WebapiEnabled", "CreationDate", "LastLoginDate", "LastActivityDate", "CreatedOn", "UpdatedOn", "DeletedOn", "LockOutEndDateUTC", "UserName", "Email", "Password", "Comment", "LastUpdatedUser", "Culture", "Lastip", "VerificationToken", "PasswordResetToken", "ServiceAuthorizationToken", "PasswordHash", "SecURItyStamp", "PhoneNumber", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Users_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:31:04.939537 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.43 seconds
21:31:04.941155 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Users_Incr: COMMIT
21:31:04.942175 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:31:04.942350 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."#AH_Users_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Users_Incr__dbt_tmp"
    end

21:31:04.983794 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:31:05.015549 [debug] [Thread-3  ]: finished collecting timing info
21:31:05.017236 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Users_Incr: Close
21:31:05.019133 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40edc34f-cbec-4a38-9c84-8b24d68b9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559879ee0>]}
21:31:05.020706 [info ] [Thread-3  ]: 99 of 101 OK snapshotted stg.AH_Users_Incr...................................... [[32mOK[0m in 63.14s]
21:31:05.021627 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Users_Incr
21:31:05.026076 [debug] [MainThread]: Acquiring new synapse connection "master"
21:31:05.026897 [debug] [MainThread]: On master: COMMIT
21:31:05.029275 [info ] [MainThread]: 
21:31:05.030016 [info ] [MainThread]: Finished running 101 snapshots in 640.22s.
21:31:05.030650 [debug] [MainThread]: Connection 'master' was properly closed.
21:31:05.030966 [debug] [MainThread]: Connection 'snapshot.Shawn.AH_Userproperties_Incr' was properly closed.
21:31:05.031342 [debug] [MainThread]: Connection 'snapshot.Shawn.AH_Watches_Incr' was properly closed.
21:31:05.031660 [debug] [MainThread]: Connection 'snapshot.Shawn.AH_Users_Incr' was properly closed.
21:31:05.032136 [debug] [MainThread]: Connection 'snapshot.Shawn.AH_Version_Incr' was properly closed.
21:31:05.118507 [info ] [MainThread]: 
21:31:05.120059 [info ] [MainThread]: [32mCompleted successfully[0m
21:31:05.121455 [info ] [MainThread]: 
21:31:05.122165 [info ] [MainThread]: Done. PASS=101 WARN=0 ERROR=0 SKIP=0 TOTAL=101
21:31:05.123005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55983fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc558460fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55844b6d0>]}


============================== 2022-09-18 21:31:07.566379 | e0a24896-326c-40a3-b619-3a74c7aadc92 ==============================
21:31:07.566379 [info ] [MainThread]: Running with dbt=1.0.0
21:31:07.571197 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step4_dboSingle'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
21:31:07.571438 [debug] [MainThread]: Tracking: tracking
21:31:07.571786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b13d8f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b13d8fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b13d8be0>]}
21:31:07.775831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:31:07.776223 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:31:07.802423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b135d280>]}
21:31:07.851205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b339e850>]}
21:31:07.851711 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:31:07.864183 [info ] [MainThread]: 
21:31:07.864974 [debug] [MainThread]: Acquiring new synapse connection "master"
21:31:07.870715 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
21:31:07.880208 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
21:31:07.880516 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
21:31:07.880664 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:31:07.880820 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:08.171020 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:08.210298 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.33 seconds
21:31:08.212289 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
21:31:08.234799 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
21:31:08.240867 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
21:31:08.241295 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
21:31:08.243514 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
21:31:08.243735 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
21:31:08.243857 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:31:08.243996 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:08.241611 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
21:31:08.245344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:31:08.245518 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:08.470265 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:08.507835 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:08.568390 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.32 seconds
21:31:08.573897 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.33 seconds
21:31:08.615005 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
21:31:08.683198 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
21:31:08.771548 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
21:31:08.783696 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
21:31:29.995425 [debug] [MainThread]: On master: COMMIT
21:31:29.996123 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
21:31:29.996443 [info ] [MainThread]: 
21:31:30.000962 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Addresses
21:31:30.001601 [info ] [Thread-1  ]: 1 of 105 START table model dbo.AH_Addresses..................................... [RUN]
21:31:30.002080 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Addresses"
21:31:30.002246 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Addresses
21:31:30.002402 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Addresses
21:31:30.001293 [debug] [Thread-3  ]: Began running node model.Shawn.AH_AuctionEventMedias
21:31:30.005693 [info ] [Thread-3  ]: 3 of 105 START table model dbo.AH_AuctionEventMedias............................ [RUN]
21:31:30.006124 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_AuctionEventMedias"
21:31:30.006274 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_AuctionEventMedias
21:31:30.006398 [debug] [Thread-3  ]: Compiling model.Shawn.AH_AuctionEventMedias
21:31:30.008733 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_AuctionEventMedias"
21:31:30.001199 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Attributes
21:31:30.009082 [info ] [Thread-2  ]: 2 of 105 START table model dbo.AH_Attributes.................................... [RUN]
21:31:30.009499 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Attributes"
21:31:30.009647 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Attributes
21:31:30.009770 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Attributes
21:31:30.011828 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Attributes"
21:31:30.001370 [debug] [Thread-4  ]: Began running node model.Shawn.AH_AuctionEvents
21:31:30.012164 [info ] [Thread-4  ]: 4 of 105 START table model dbo.AH_AuctionEvents................................. [RUN]
21:31:30.012563 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_AuctionEvents"
21:31:30.012708 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_AuctionEvents
21:31:30.012825 [debug] [Thread-4  ]: Compiling model.Shawn.AH_AuctionEvents
21:31:30.015160 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_AuctionEvents"
21:31:30.005408 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Addresses"
21:31:30.016116 [debug] [Thread-1  ]: finished collecting timing info
21:31:30.016268 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Addresses
21:31:30.015788 [debug] [Thread-2  ]: finished collecting timing info
21:31:30.024021 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Attributes
21:31:30.023874 [debug] [Thread-4  ]: finished collecting timing info
21:31:30.051760 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_AuctionEvents
21:31:30.015683 [debug] [Thread-3  ]: finished collecting timing info
21:31:30.097909 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_AuctionEventMedias
21:31:30.207621 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Attributes"
21:31:30.209559 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Addresses"
21:31:30.219293 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Addresses".
21:31:30.219729 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Addresses: 
  
  if object_id ('"dbo"."AH_Addresses__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Addresses__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Addresses__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Addresses__dbt_tmp"
    end


   EXEC('create view dbo.AH_Addresses__dbt_tmp_temp_view as
    
Select
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UserID] as int) [UserId],
	cast([ID] as int) [Id],
	cast([CountryID] as int) [CountryId],
	cast([Street1] as varchar(128)) [Street1],
	cast([Street2] as varchar(128)) [Street2],
	cast([City] as nvarchar(100)) [City],
	cast([Stateregion] as nvarchar(50)) [StateRegion],
	cast([ZipPostal] as nvarchar(50)) [ZipPostal],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([Description] as nvarchar(4000)) [Description],
	cast([FirstName] as nvarchar(500)) [FirstName],
	cast([LastName] as nvarchar(500)) [LastName] 
From stg.[AH_Addresses_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Addresses__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Addresses__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Addresses__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Addresses__dbt_tmp_temp_view"
    end



21:31:30.219879 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:31:30.220040 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:30.219626 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Attributes".
21:31:30.221495 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Attributes: 
  
  if object_id ('"dbo"."AH_Attributes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Attributes__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Attributes__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Attributes__dbt_tmp"
    end


   EXEC('create view dbo.AH_Attributes__dbt_tmp_temp_view as
    
Select
	cast([ConText] as nvarchar(4000)) [Context],
	cast([Name] as nvarchar(4000)) [Name],
	cast([Value] as nvarchar(4000)) [Value],
	cast([EditMode] as nvarchar(4000)) [EditMode],
	cast([Type] as nvarchar(4000)) [Type],
	cast([ID] as int) [Id],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_Attributes_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Attributes__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Attributes__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Attributes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Attributes__dbt_tmp_temp_view"
    end



21:31:30.221660 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:31:30.221806 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:30.218431 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_AuctionEvents"
21:31:30.223284 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEvents".
21:31:30.223440 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_AuctionEvents: 
  
  if object_id ('"dbo"."AH_AuctionEvents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_AuctionEvents__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_AuctionEvents__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_AuctionEvents__dbt_tmp"
    end


   EXEC('create view dbo.AH_AuctionEvents__dbt_tmp_temp_view as
    
Select
	cast([SoftclosingGroupIncrementseconds] as int) [SoftClosingGroupIncrementSeconds],
	cast([LotCount] as int) [LotCount],
	cast([CategoryID] as int) [CategoryID],
	cast([CurrencyID] as int) [CurrencyId],
	cast([ID] as int) [Id],
	cast([ClosingGroupIncrementseconds] as int) [ClosingGroupIncrementSeconds],
	cast([CurrentclosingGroup] as int) [CurrentClosingGroup],
	cast([CurrentSoftclosingGroup] as int) [CurrentSoftClosingGroup],
	cast([CurrentLotOrder] as int) [CurrentLotOrder],
	cast([OwnerID] as int) [OwnerId],
	cast([ProxyBidding] as bit) [ProxyBidding],
	cast([Published] as bit) [Published],
	cast([PreviewLots] as bit) [PreviewLots],
	cast([LotsTaxable] as bit) [LotsTaxable],
	cast([FollowLiveEnabled] as bit) [FollowLiveEnabled],
	cast([BuyersPremiumPercent] as numeric(19,4)) [BuyersPremiumPercent],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Startdttm] as datetime) [StartDTTM],
	cast([Enddttm] as datetime) [EndDTTM],
	cast([EstimatedLastEnddttm] as datetime) [EstimatedLastEndDTTM],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Status] as nvarchar(4000)) [Status],
	cast([Timezone] as nvarchar(4000)) [TimeZone],
	cast([TermsandConditions] as nvarchar(4000)) [TermsAndConditions],
	cast([PrimaryImageURI] as nvarchar(4000)) [PrimaryImageURI],
	cast([Title] as nvarchar(4000)) [Title],
	cast([SecondaryImageURI] as nvarchar(4000)) [SecondaryImageURI],
	cast([OwnerUserName] as nvarchar(4000)) [OwnerUserName],
	cast([ShippingInfo] as nvarchar(4000)) [ShippingInfo],
	cast([SubTitle] as nvarchar(4000)) [Subtitle],
	cast([ManagedByName] as nvarchar(4000)) [ManagedByName] 
From stg.[AH_AuctionEvents_FinalView]
    ');

  CREATE TABLE "dbo"."AH_AuctionEvents__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_AuctionEvents__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_AuctionEvents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_AuctionEvents__dbt_tmp_temp_view"
    end



21:31:30.223575 [debug] [Thread-4  ]: Opening a new connection, currently in state init
21:31:30.223710 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:30.228891 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_AuctionEventMedias"
21:31:30.229946 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEventMedias".
21:31:30.230121 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_AuctionEventMedias: 
  
  if object_id ('"dbo"."AH_AuctionEventMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_AuctionEventMedias__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_AuctionEventMedias__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_AuctionEventMedias__dbt_tmp"
    end


   EXEC('create view dbo.AH_AuctionEventMedias__dbt_tmp_temp_view as
    
Select
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([DisplayOrder] as int) [DisplayOrder],
	cast([ID] as int) [Id],
	cast([MediaID] as int) [MediaId],
	cast([EventID] as int) [EventId] 
From stg.[AH_AuctionEventMedias_FinalView]
    ');

  CREATE TABLE "dbo"."AH_AuctionEventMedias__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_AuctionEventMedias__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_AuctionEventMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_AuctionEventMedias__dbt_tmp_temp_view"
    end



21:31:30.230241 [debug] [Thread-3  ]: Opening a new connection, currently in state init
21:31:30.230376 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:30.337544 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:30.339992 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:30.341194 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:30.345326 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:33.968480 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.75 seconds
21:31:33.988618 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Attributes".
21:31:33.988983 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Attributes: rename object "dbo"."AH_Attributes" to AH_Attributes__dbt_backup
21:31:34.032802 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.80 seconds
21:31:34.034160 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.81 seconds
21:31:34.049762 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEvents".
21:31:34.131399 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_AuctionEvents: rename object "dbo"."AH_AuctionEvents" to AH_AuctionEvents__dbt_backup
21:31:34.130993 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.91 seconds
21:31:34.147425 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEventMedias".
21:31:34.155433 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_AuctionEventMedias: rename object "dbo"."AH_AuctionEventMedias" to AH_AuctionEventMedias__dbt_backup
21:31:34.155000 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Addresses".
21:31:34.155754 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Addresses: rename object "dbo"."AH_Addresses" to AH_Addresses__dbt_backup
21:31:34.163522 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:31:34.177093 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Attributes".
21:31:34.177445 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Attributes: rename object "dbo"."AH_Attributes__dbt_tmp" to AH_Attributes
21:31:34.179509 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:31:34.192889 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEvents".
21:31:34.193252 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_AuctionEvents: rename object "dbo"."AH_AuctionEvents__dbt_tmp" to AH_AuctionEvents
21:31:34.197153 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:31:34.206086 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:31:34.212213 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEventMedias".
21:31:34.223880 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_AuctionEventMedias: rename object "dbo"."AH_AuctionEventMedias__dbt_tmp" to AH_AuctionEventMedias
21:31:34.212436 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:34.232230 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Addresses".
21:31:34.232442 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:31:34.232648 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Addresses: rename object "dbo"."AH_Addresses__dbt_tmp" to AH_Addresses
21:31:34.239633 [debug] [Thread-2  ]: On model.Shawn.AH_Attributes: COMMIT
21:31:34.239088 [debug] [Thread-4  ]: On model.Shawn.AH_AuctionEvents: COMMIT
21:31:34.250322 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEvents".
21:31:34.250660 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_AuctionEvents: 
    
  if object_id ('"dbo"."AH_AuctionEvents__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_AuctionEvents__dbt_backup"
    end

21:31:34.246418 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Attributes".
21:31:34.251009 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Attributes: 
    
  if object_id ('"dbo"."AH_Attributes__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Attributes__dbt_backup"
    end

21:31:34.255796 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:34.257219 [debug] [Thread-3  ]: On model.Shawn.AH_AuctionEventMedias: COMMIT
21:31:34.261057 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEventMedias".
21:31:34.261264 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_AuctionEventMedias: 
    
  if object_id ('"dbo"."AH_AuctionEventMedias__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_AuctionEventMedias__dbt_backup"
    end

21:31:34.276752 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:31:34.278406 [debug] [Thread-1  ]: On model.Shawn.AH_Addresses: COMMIT
21:31:34.282352 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Addresses".
21:31:34.282587 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Addresses: 
    
  if object_id ('"dbo"."AH_Addresses__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Addresses__dbt_backup"
    end

21:31:34.489391 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:31:34.503414 [debug] [Thread-4  ]: finished collecting timing info
21:31:34.503848 [debug] [Thread-4  ]: On model.Shawn.AH_AuctionEvents: Close
21:31:34.504643 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae5cdc0>]}
21:31:34.505143 [info ] [Thread-4  ]: 4 of 105 OK created table model dbo.AH_AuctionEvents............................ [[32mOK[0m in 4.49s]
21:31:34.505527 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_AuctionEvents
21:31:34.505717 [debug] [Thread-4  ]: Began running node model.Shawn.AH_BannedUsers
21:31:34.506133 [info ] [Thread-4  ]: 5 of 105 START table model dbo.AH_BannedUsers................................... [RUN]
21:31:34.506598 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_BannedUsers"
21:31:34.506771 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_BannedUsers
21:31:34.506904 [debug] [Thread-4  ]: Compiling model.Shawn.AH_BannedUsers
21:31:34.509458 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_BannedUsers"
21:31:34.509938 [debug] [Thread-4  ]: finished collecting timing info
21:31:34.510094 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_BannedUsers
21:31:34.529402 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:31:34.539719 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:31:34.549168 [debug] [Thread-3  ]: finished collecting timing info
21:31:34.569840 [debug] [Thread-3  ]: On model.Shawn.AH_AuctionEventMedias: Close
21:31:34.574761 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae791f0>]}
21:31:34.575265 [info ] [Thread-3  ]: 3 of 105 OK created table model dbo.AH_AuctionEventMedias....................... [[32mOK[0m in 4.57s]
21:31:34.574050 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:31:34.569549 [debug] [Thread-2  ]: finished collecting timing info
21:31:34.582663 [debug] [Thread-2  ]: On model.Shawn.AH_Attributes: Close
21:31:34.583351 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae792e0>]}
21:31:34.583796 [info ] [Thread-2  ]: 2 of 105 OK created table model dbo.AH_Attributes............................... [[32mOK[0m in 4.57s]
21:31:34.582413 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_AuctionEventMedias
21:31:34.584231 [debug] [Thread-3  ]: Began running node model.Shawn.AH_BannerCategories
21:31:34.584633 [info ] [Thread-3  ]: 6 of 105 START table model dbo.AH_BannerCategories.............................. [RUN]
21:31:34.573832 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_BannedUsers"
21:31:34.585185 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannedUsers".
21:31:34.585333 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_BannedUsers: 
  
  if object_id ('"dbo"."AH_BannedUsers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_BannedUsers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_BannedUsers__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_BannedUsers__dbt_tmp"
    end


   EXEC('create view dbo.AH_BannedUsers__dbt_tmp_temp_view as
    
Select
	cast([Lastip] as nvarchar(4000)) [LastIP],
	cast([UserName] as nvarchar(4000)) [UserName],
	cast([FName] as nvarchar(4000)) [FName],
	cast([LName] as nvarchar(4000)) [LName],
	cast([IsLockedOut] as bit) [IsLockedOut],
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId] 
From stg.[AH_BannedUsers_FinalView]
    ');

  CREATE TABLE "dbo"."AH_BannedUsers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_BannedUsers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_BannedUsers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_BannedUsers__dbt_tmp_temp_view"
    end



21:31:34.585450 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:31:34.585589 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:34.586877 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Attributes
21:31:34.587294 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_BannerCategories"
21:31:34.587783 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_BannerCategories
21:31:34.587932 [debug] [Thread-3  ]: Compiling model.Shawn.AH_BannerCategories
21:31:34.587495 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Banners
21:31:34.591402 [info ] [Thread-2  ]: 7 of 105 START table model dbo.AH_Banners....................................... [RUN]
21:31:34.591825 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Banners"
21:31:34.591977 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Banners
21:31:34.592108 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Banners
21:31:34.591110 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_BannerCategories"
21:31:34.594689 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Banners"
21:31:34.602190 [debug] [Thread-2  ]: finished collecting timing info
21:31:34.602403 [debug] [Thread-3  ]: finished collecting timing info
21:31:34.602676 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_BannerCategories
21:31:34.602505 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Banners
21:31:34.601602 [debug] [Thread-1  ]: finished collecting timing info
21:31:34.634839 [debug] [Thread-1  ]: On model.Shawn.AH_Addresses: Close
21:31:34.635732 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae71250>]}
21:31:34.644035 [info ] [Thread-1  ]: 1 of 105 OK created table model dbo.AH_Addresses................................ [[32mOK[0m in 4.63s]
21:31:34.662222 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Addresses
21:31:34.671794 [debug] [Thread-1  ]: Began running node model.Shawn.AH_BiddingTransactions
21:31:34.675854 [info ] [Thread-1  ]: 8 of 105 START table model dbo.AH_BiddingTransactions........................... [RUN]
21:31:34.676429 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_BiddingTransactions"
21:31:34.676598 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_BiddingTransactions
21:31:34.676736 [debug] [Thread-1  ]: Compiling model.Shawn.AH_BiddingTransactions
21:31:34.679340 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_BiddingTransactions"
21:31:34.675558 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_BannerCategories"
21:31:34.686859 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannerCategories".
21:31:34.687146 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_BannerCategories: 
  
  if object_id ('"dbo"."AH_BannerCategories__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_BannerCategories__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_BannerCategories__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_BannerCategories__dbt_tmp"
    end


   EXEC('create view dbo.AH_BannerCategories__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([BannerID] as int) [BannerId],
	cast([CategoryID] as int) [CategoryId] 
From stg.[AH_BannerCategories_FinalView]
    ');

  CREATE TABLE "dbo"."AH_BannerCategories__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_BannerCategories__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_BannerCategories__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_BannerCategories__dbt_tmp_temp_view"
    end



21:31:34.687269 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:31:34.687415 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:34.687059 [debug] [Thread-1  ]: finished collecting timing info
21:31:34.688439 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_BiddingTransactions
21:31:34.686197 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Banners"
21:31:34.698902 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Banners".
21:31:34.699246 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Banners: 
  
  if object_id ('"dbo"."AH_Banners__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Banners__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Banners__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Banners__dbt_tmp"
    end


   EXEC('create view dbo.AH_Banners__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([MediaID] as int) [MediaId],
	cast([LinkURI] as nvarchar(4000)) [LinkURI],
	cast([BannerLocation] as nvarchar(4000)) [BannerLocation] 
From stg.[AH_Banners_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Banners__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Banners__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Banners__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Banners__dbt_tmp_temp_view"
    end



21:31:34.699428 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:31:34.699592 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:34.736229 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_BiddingTransactions"
21:31:34.736892 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BiddingTransactions".
21:31:34.737094 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_BiddingTransactions: 
  
  if object_id ('"dbo"."AH_BiddingTransactions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_BiddingTransactions__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_BiddingTransactions__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_BiddingTransactions__dbt_tmp"
    end


   EXEC('create view dbo.AH_BiddingTransactions__dbt_tmp_temp_view as
    
Select
	cast([TransactionID] as nvarchar(30)) [TransactionId],
	cast([Maxmindscore] as decimal(5,2)) [MaxMindScore],
	cast([Amount] as decimal(24,2)) [Amount],
	cast([ID] as int) [Id],
	cast([ListingActionID] as int) [ListingActionId],
	cast([CreditCardID] as int) [CreditCardId],
	cast([Active] as bit) [Active] 
From stg.[AH_BiddingTransactions_FinalView]
    ');

  CREATE TABLE "dbo"."AH_BiddingTransactions__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_BiddingTransactions__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_BiddingTransactions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_BiddingTransactions__dbt_tmp_temp_view"
    end



21:31:34.737220 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:31:34.737366 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:34.811207 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:34.812445 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:34.812760 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:34.883731 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:37.774970 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.19 seconds
21:31:37.786670 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.10 seconds
21:31:37.792481 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannedUsers".
21:31:37.803885 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_BannedUsers: rename object "dbo"."AH_BannedUsers" to AH_BannedUsers__dbt_backup
21:31:37.806044 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannerCategories".
21:31:37.806292 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_BannerCategories: rename object "dbo"."AH_BannerCategories" to AH_BannerCategories__dbt_backup
21:31:37.827675 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.09 seconds
21:31:37.913189 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:31:37.913564 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.21 seconds
21:31:37.913660 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:31:37.920579 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BiddingTransactions".
21:31:37.935797 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_BiddingTransactions: rename object "dbo"."AH_BiddingTransactions" to AH_BiddingTransactions__dbt_backup
21:31:37.942316 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannerCategories".
21:31:37.955709 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_BannerCategories: rename object "dbo"."AH_BannerCategories__dbt_tmp" to AH_BannerCategories
21:31:37.949467 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Banners".
21:31:37.956232 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Banners: rename object "dbo"."AH_Banners" to AH_Banners__dbt_backup
21:31:37.957189 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannedUsers".
21:31:37.957387 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_BannedUsers: rename object "dbo"."AH_BannedUsers__dbt_tmp" to AH_BannedUsers
21:31:37.976341 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:37.988960 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:37.990611 [debug] [Thread-3  ]: On model.Shawn.AH_BannerCategories: COMMIT
21:31:37.994345 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannerCategories".
21:31:37.995272 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BiddingTransactions".
21:31:37.995531 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_BiddingTransactions: rename object "dbo"."AH_BiddingTransactions__dbt_tmp" to AH_BiddingTransactions
21:31:37.995390 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_BannerCategories: 
    
  if object_id ('"dbo"."AH_BannerCategories__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_BannerCategories__dbt_backup"
    end

21:31:38.002839 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:31:38.015567 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Banners".
21:31:38.015800 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:31:38.017695 [debug] [Thread-4  ]: On model.Shawn.AH_BannedUsers: COMMIT
21:31:38.021285 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannedUsers".
21:31:38.016022 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Banners: rename object "dbo"."AH_Banners__dbt_tmp" to AH_Banners
21:31:38.021501 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_BannedUsers: 
    
  if object_id ('"dbo"."AH_BannedUsers__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_BannedUsers__dbt_backup"
    end

21:31:38.023696 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:38.025025 [debug] [Thread-1  ]: On model.Shawn.AH_BiddingTransactions: COMMIT
21:31:38.028608 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BiddingTransactions".
21:31:38.028796 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_BiddingTransactions: 
    
  if object_id ('"dbo"."AH_BiddingTransactions__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_BiddingTransactions__dbt_backup"
    end

21:31:38.050708 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:38.052474 [debug] [Thread-2  ]: On model.Shawn.AH_Banners: COMMIT
21:31:38.056744 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Banners".
21:31:38.056998 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Banners: 
    
  if object_id ('"dbo"."AH_Banners__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Banners__dbt_backup"
    end

21:31:38.250849 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:31:38.263963 [debug] [Thread-3  ]: finished collecting timing info
21:31:38.264389 [debug] [Thread-3  ]: On model.Shawn.AH_BannerCategories: Close
21:31:38.265148 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaf917c0>]}
21:31:38.265633 [info ] [Thread-3  ]: 6 of 105 OK created table model dbo.AH_BannerCategories......................... [[32mOK[0m in 3.68s]
21:31:38.266006 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_BannerCategories
21:31:38.266186 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Categories
21:31:38.266528 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:31:38.266858 [info ] [Thread-3  ]: 9 of 105 START table model dbo.AH_Categories.................................... [RUN]
21:31:38.276363 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Categories"
21:31:38.276566 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Categories
21:31:38.276738 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Categories
21:31:38.279553 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Categories"
21:31:38.283147 [debug] [Thread-3  ]: finished collecting timing info
21:31:38.283319 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Categories
21:31:38.282750 [debug] [Thread-1  ]: finished collecting timing info
21:31:38.292208 [debug] [Thread-1  ]: On model.Shawn.AH_BiddingTransactions: Close
21:31:38.292996 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a85a1eb0>]}
21:31:38.293492 [info ] [Thread-1  ]: 8 of 105 OK created table model dbo.AH_BiddingTransactions...................... [[32mOK[0m in 3.62s]
21:31:38.291742 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:31:38.303870 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_BiddingTransactions
21:31:38.308631 [debug] [Thread-1  ]: Began running node model.Shawn.AH_CategoryCount
21:31:38.309174 [info ] [Thread-1  ]: 10 of 105 START table model dbo.AH_CategoryCount................................ [RUN]
21:31:38.309709 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_CategoryCount"
21:31:38.309871 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_CategoryCount
21:31:38.310006 [debug] [Thread-1  ]: Compiling model.Shawn.AH_CategoryCount
21:31:38.312684 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_CategoryCount"
21:31:38.315425 [debug] [Thread-4  ]: finished collecting timing info
21:31:38.324097 [debug] [Thread-4  ]: On model.Shawn.AH_BannedUsers: Close
21:31:38.325144 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a8573e20>]}
21:31:38.325611 [info ] [Thread-4  ]: 5 of 105 OK created table model dbo.AH_BannedUsers.............................. [[32mOK[0m in 3.82s]
21:31:38.324428 [debug] [Thread-1  ]: finished collecting timing info
21:31:38.325994 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_CategoryCount
21:31:38.341002 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_BannedUsers
21:31:38.352046 [debug] [Thread-4  ]: Began running node model.Shawn.AH_CategoryCustomFields
21:31:38.370216 [info ] [Thread-4  ]: 11 of 105 START table model dbo.AH_CategoryCustomFields......................... [RUN]
21:31:38.371644 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_CategoryCustomFields"
21:31:38.371835 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_CategoryCustomFields
21:31:38.351739 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:31:38.371156 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Categories"
21:31:38.373524 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories".
21:31:38.373683 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Categories: 
  
  if object_id ('"dbo"."AH_Categories__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Categories__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Categories__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Categories__dbt_tmp"
    end


   EXEC('create view dbo.AH_Categories__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([ParentCategoryID] as int) [ParentCategoryId],
	cast([DisplayOrder] as int) [DisplayOrder],
	cast([Lft] as int) [lft],
	cast([Rgt] as int) [rgt],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([RolesAllowed] as nvarchar(100)) [RolesAllowed],
	cast([EnabledCustomProperty] as nvarchar(100)) [EnabledCustomProperty],
	cast([MetaKeyWords] as nvarchar(4000)) [MetaKeywords],
	cast([MetaDescription] as nvarchar(4000)) [MetaDescription],
	cast([PageTitle] as nvarchar(4000)) [PageTitle],
	cast([Pagecontent] as nvarchar(4000)) [PageContent],
	cast([Name] as nvarchar(500)) [Name],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([Type] as nvarchar(50)) [Type],
	cast([MvcAction] as nvarchar(100)) [MVCAction] 
From stg.[AH_Categories_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Categories__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Categories__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Categories__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Categories__dbt_tmp_temp_view"
    end



21:31:38.373821 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:31:38.373973 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:38.371989 [debug] [Thread-4  ]: Compiling model.Shawn.AH_CategoryCustomFields
21:31:38.377430 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_CategoryCustomFields"
21:31:38.396147 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_CategoryCount"
21:31:38.396649 [debug] [Thread-4  ]: finished collecting timing info
21:31:38.400613 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_CategoryCustomFields
21:31:38.400131 [debug] [Thread-2  ]: finished collecting timing info
21:31:38.411060 [debug] [Thread-2  ]: On model.Shawn.AH_Banners: Close
21:31:38.412029 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a8560cd0>]}
21:31:38.412496 [info ] [Thread-2  ]: 7 of 105 OK created table model dbo.AH_Banners.................................. [[32mOK[0m in 3.82s]
21:31:38.411369 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCount".
21:31:38.413036 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryCount: 
  
  if object_id ('"dbo"."AH_CategoryCount__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryCount__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CategoryCount__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CategoryCount__dbt_tmp"
    end


   EXEC('create view dbo.AH_CategoryCount__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([Count] as int) [Count],
	cast([CategoryID] as int) [CategoryId] 
From stg.[AH_CategoryCount_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CategoryCount__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CategoryCount__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CategoryCount__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryCount__dbt_tmp_temp_view"
    end



21:31:38.413216 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:31:38.413363 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:38.414602 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Banners
21:31:38.414835 [debug] [Thread-2  ]: Began running node model.Shawn.AH_CategoryListingTypes
21:31:38.415258 [info ] [Thread-2  ]: 12 of 105 START table model dbo.AH_CategoryListingTypes......................... [RUN]
21:31:38.415719 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_CategoryListingTypes"
21:31:38.415872 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_CategoryListingTypes
21:31:38.416010 [debug] [Thread-2  ]: Compiling model.Shawn.AH_CategoryListingTypes
21:31:38.419874 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_CategoryListingTypes"
21:31:38.432154 [debug] [Thread-2  ]: finished collecting timing info
21:31:38.432420 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_CategoryListingTypes
21:31:38.481367 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_CategoryCustomFields"
21:31:38.482380 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCustomFields".
21:31:38.482624 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CategoryCustomFields: 
  
  if object_id ('"dbo"."AH_CategoryCustomFields__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryCustomFields__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CategoryCustomFields__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CategoryCustomFields__dbt_tmp"
    end


   EXEC('create view dbo.AH_CategoryCustomFields__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([CategoryID] as int) [CategoryId],
	cast([CustomFieldID] as int) [CustomFieldId],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_CategoryCustomFields_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CategoryCustomFields__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CategoryCustomFields__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CategoryCustomFields__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryCustomFields__dbt_tmp_temp_view"
    end



21:31:38.482764 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:31:38.482915 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:38.499083 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:38.502842 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_CategoryListingTypes"
21:31:38.503372 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListingTypes".
21:31:38.503547 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CategoryListingTypes: 
  
  if object_id ('"dbo"."AH_CategoryListingTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryListingTypes__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CategoryListingTypes__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CategoryListingTypes__dbt_tmp"
    end


   EXEC('create view dbo.AH_CategoryListingTypes__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([CategoryID] as int) [CategoryId],
	cast([ListingTypeID] as int) [ListingTypeId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_CategoryListingTypes_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CategoryListingTypes__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CategoryListingTypes__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CategoryListingTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryListingTypes__dbt_tmp_temp_view"
    end



21:31:38.503667 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:31:38.503807 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:38.527263 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:38.582085 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:38.612667 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:41.010920 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.64 seconds
21:31:41.026583 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories".
21:31:41.026932 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Categories: rename object "dbo"."AH_Categories" to AH_Categories__dbt_backup
21:31:41.072718 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:31:41.163661 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.75 seconds
21:31:41.177449 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories".
21:31:41.177814 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Categories: rename object "dbo"."AH_Categories__dbt_tmp" to AH_Categories
21:31:41.179607 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCount".
21:31:41.179860 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryCount: rename object "dbo"."AH_CategoryCount" to AH_CategoryCount__dbt_backup
21:31:41.213237 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:31:41.215308 [debug] [Thread-3  ]: On model.Shawn.AH_Categories: COMMIT
21:31:41.219848 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories".
21:31:41.220240 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:31:41.220375 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Categories: 
    
  if object_id ('"dbo"."AH_Categories__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Categories__dbt_backup"
    end

21:31:41.234508 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCount".
21:31:41.234887 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryCount: rename object "dbo"."AH_CategoryCount__dbt_tmp" to AH_CategoryCount
21:31:41.262442 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:41.264299 [debug] [Thread-1  ]: On model.Shawn.AH_CategoryCount: COMMIT
21:31:41.268955 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCount".
21:31:41.269272 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryCount: 
    
  if object_id ('"dbo"."AH_CategoryCount__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CategoryCount__dbt_backup"
    end

21:31:41.390730 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.89 seconds
21:31:41.405496 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListingTypes".
21:31:41.405882 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CategoryListingTypes: rename object "dbo"."AH_CategoryListingTypes" to AH_CategoryListingTypes__dbt_backup
21:31:41.440924 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:31:41.451760 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:31:41.454968 [debug] [Thread-3  ]: finished collecting timing info
21:31:41.468914 [debug] [Thread-3  ]: On model.Shawn.AH_Categories: Close
21:31:41.469753 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a85640d0>]}
21:31:41.472417 [info ] [Thread-3  ]: 9 of 105 OK created table model dbo.AH_Categories............................... [[32mOK[0m in 3.19s]
21:31:41.472836 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Categories
21:31:41.474209 [debug] [Thread-3  ]: Began running node model.Shawn.AH_CategoryListings
21:31:41.474839 [info ] [Thread-3  ]: 13 of 105 START table model dbo.AH_CategoryListings............................. [RUN]
21:31:41.475352 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_CategoryListings"
21:31:41.485752 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_CategoryListings
21:31:41.486007 [debug] [Thread-3  ]: Compiling model.Shawn.AH_CategoryListings
21:31:41.488844 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_CategoryListings"
21:31:41.484805 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListingTypes".
21:31:41.489235 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CategoryListingTypes: rename object "dbo"."AH_CategoryListingTypes__dbt_tmp" to AH_CategoryListingTypes
21:31:41.489614 [debug] [Thread-3  ]: finished collecting timing info
21:31:41.489791 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_CategoryListings
21:31:41.523877 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:41.525647 [debug] [Thread-2  ]: On model.Shawn.AH_CategoryListingTypes: COMMIT
21:31:41.529958 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListingTypes".
21:31:41.530248 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:31:41.531654 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_CategoryListings"
21:31:41.531885 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CategoryListingTypes: 
    
  if object_id ('"dbo"."AH_CategoryListingTypes__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CategoryListingTypes__dbt_backup"
    end

21:31:41.540296 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListings".
21:31:41.540481 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CategoryListings: 
  
  if object_id ('"dbo"."AH_CategoryListings__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryListings__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CategoryListings__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CategoryListings__dbt_tmp"
    end


   EXEC('create view dbo.AH_CategoryListings__dbt_tmp_temp_view as
    
Select
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([ID] as int) [Id],
	cast([ListingID] as int) [ListingId],
	cast([CategoryID] as int) [CategoryId] 
From stg.[AH_CategoryListings_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CategoryListings__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CategoryListings__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CategoryListings__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryListings__dbt_tmp_temp_view"
    end



21:31:41.540624 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:31:41.540770 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:41.545758 [debug] [Thread-1  ]: finished collecting timing info
21:31:41.546020 [debug] [Thread-1  ]: On model.Shawn.AH_CategoryCount: Close
21:31:41.546743 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae6bf40>]}
21:31:41.547192 [info ] [Thread-1  ]: 10 of 105 OK created table model dbo.AH_CategoryCount........................... [[32mOK[0m in 3.24s]
21:31:41.547548 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_CategoryCount
21:31:41.547726 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Contactus
21:31:41.548108 [info ] [Thread-1  ]: 14 of 105 START table model dbo.AH_Contactus.................................... [RUN]
21:31:41.548543 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Contactus"
21:31:41.548696 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Contactus
21:31:41.548850 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Contactus
21:31:41.551742 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Contactus"
21:31:41.552217 [debug] [Thread-1  ]: finished collecting timing info
21:31:41.552376 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Contactus
21:31:41.592185 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Contactus"
21:31:41.592887 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contactus".
21:31:41.593085 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Contactus: 
  
  if object_id ('"dbo"."AH_Contactus__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Contactus__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Contactus__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Contactus__dbt_tmp"
    end


   EXEC('create view dbo.AH_Contactus__dbt_tmp_temp_view as
    
Select
	cast([Email] as nvarchar(4000)) [Email],
	cast([FirstName] as nvarchar(4000)) [FirstName],
	cast([LastName] as nvarchar(4000)) [LastName],
	cast([Message] as nvarchar(4000)) [Message],
	cast([ID] as int) [Id] 
From stg.[AH_Contactus_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Contactus__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Contactus__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Contactus__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Contactus__dbt_tmp_temp_view"
    end



21:31:41.593207 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:31:41.593358 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:41.667668 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:41.692675 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:41.972181 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
21:31:41.984791 [debug] [Thread-2  ]: finished collecting timing info
21:31:41.985211 [debug] [Thread-2  ]: On model.Shawn.AH_CategoryListingTypes: Close
21:31:41.985976 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaeb7eb0>]}
21:31:41.986485 [info ] [Thread-2  ]: 12 of 105 OK created table model dbo.AH_CategoryListingTypes.................... [[32mOK[0m in 3.57s]
21:31:41.986898 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_CategoryListingTypes
21:31:41.987081 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Contents
21:31:41.987465 [info ] [Thread-2  ]: 15 of 105 START table model dbo.AH_Contents..................................... [RUN]
21:31:41.987881 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Contents"
21:31:41.988032 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Contents
21:31:41.988167 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Contents
21:31:41.990775 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Contents"
21:31:41.991194 [debug] [Thread-2  ]: finished collecting timing info
21:31:41.991348 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Contents
21:31:42.026297 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Contents"
21:31:42.027010 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contents".
21:31:42.027203 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Contents: 
  
  if object_id ('"dbo"."AH_Contents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Contents__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Contents__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Contents__dbt_tmp"
    end


   EXEC('create view dbo.AH_Contents__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([DisplayOrder] as int) [DisplayOrder],
	cast([Usehtmleditor] as bit) [UseHTMLEditor],
	cast([Userdefined] as bit) [UserDefined],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Text] as nvarchar(4000)) [Text],
	cast([Name] as nvarchar(4000)) [Name],
	cast([Culture] as nvarchar(4000)) [Culture],
	cast([PageTitle] as nvarchar(4000)) [PageTitle] 
From stg.[AH_Contents_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Contents__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Contents__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Contents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Contents__dbt_tmp_temp_view"
    end



21:31:42.027336 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:31:42.027487 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:42.124368 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:45.307858 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.71 seconds
21:31:45.322398 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contactus".
21:31:45.322785 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Contactus: rename object "dbo"."AH_Contactus" to AH_Contactus__dbt_backup
21:31:45.366894 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:31:45.381234 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contactus".
21:31:45.381612 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Contactus: rename object "dbo"."AH_Contactus__dbt_tmp" to AH_Contactus
21:31:45.430474 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.40 seconds
21:31:45.445208 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contents".
21:31:45.445438 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:31:45.447163 [debug] [Thread-1  ]: On model.Shawn.AH_Contactus: COMMIT
21:31:45.450329 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contactus".
21:31:45.445668 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Contents: rename object "dbo"."AH_Contents" to AH_Contents__dbt_backup
21:31:45.450529 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Contactus: 
    
  if object_id ('"dbo"."AH_Contactus__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Contactus__dbt_backup"
    end

21:31:45.482885 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:45.496841 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contents".
21:31:45.497205 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Contents: rename object "dbo"."AH_Contents__dbt_tmp" to AH_Contents
21:31:45.526856 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:45.528856 [debug] [Thread-2  ]: On model.Shawn.AH_Contents: COMMIT
21:31:45.532870 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contents".
21:31:45.533075 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Contents: 
    
  if object_id ('"dbo"."AH_Contents__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Contents__dbt_backup"
    end

21:31:45.660716 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:31:45.672763 [debug] [Thread-1  ]: finished collecting timing info
21:31:45.673188 [debug] [Thread-1  ]: On model.Shawn.AH_Contactus: Close
21:31:45.673954 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae932e0>]}
21:31:45.674462 [info ] [Thread-1  ]: 14 of 105 OK created table model dbo.AH_Contactus............................... [[32mOK[0m in 4.13s]
21:31:45.674872 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Contactus
21:31:45.675051 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Countries
21:31:45.675441 [info ] [Thread-1  ]: 16 of 105 START table model dbo.AH_Countries.................................... [RUN]
21:31:45.675862 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Countries"
21:31:45.676019 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Countries
21:31:45.676155 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Countries
21:31:45.678722 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Countries"
21:31:45.679133 [debug] [Thread-1  ]: finished collecting timing info
21:31:45.679354 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Countries
21:31:45.714876 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Countries"
21:31:45.715582 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Countries".
21:31:45.715785 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Countries: 
  
  if object_id ('"dbo"."AH_Countries__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Countries__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Countries__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Countries__dbt_tmp"
    end


   EXEC('create view dbo.AH_Countries__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(500)) [Name],
	cast([Code] as char(5)) [Code],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([Enabled] as bit) [Enabled],
	cast([StateRequired] as bit) [StateRequired] 
From stg.[AH_Countries_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Countries__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Countries__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Countries__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Countries__dbt_tmp_temp_view"
    end



21:31:45.715907 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:31:45.716051 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:45.749370 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:31:45.762809 [debug] [Thread-2  ]: finished collecting timing info
21:31:45.763133 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 4.22 seconds
21:31:45.763410 [debug] [Thread-2  ]: On model.Shawn.AH_Contents: Close
21:31:45.772730 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae93580>]}
21:31:45.773260 [info ] [Thread-2  ]: 15 of 105 OK created table model dbo.AH_Contents................................ [[32mOK[0m in 3.78s]
21:31:45.773638 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Contents
21:31:45.773820 [debug] [Thread-2  ]: Began running node model.Shawn.AH_CreditCardTypes
21:31:45.774202 [info ] [Thread-2  ]: 17 of 105 START table model dbo.AH_CreditCardTypes.............................. [RUN]
21:31:45.774678 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_CreditCardTypes"
21:31:45.774845 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_CreditCardTypes
21:31:45.774980 [debug] [Thread-2  ]: Compiling model.Shawn.AH_CreditCardTypes
21:31:45.777660 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_CreditCardTypes"
21:31:45.782447 [debug] [Thread-2  ]: finished collecting timing info
21:31:45.782658 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_CreditCardTypes
21:31:45.782057 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListings".
21:31:45.790294 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CategoryListings: rename object "dbo"."AH_CategoryListings" to AH_CategoryListings__dbt_backup
21:31:45.820889 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_CreditCardTypes"
21:31:45.821262 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:45.831721 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:45.832292 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardTypes".
21:31:45.832636 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CreditCardTypes: 
  
  if object_id ('"dbo"."AH_CreditCardTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CreditCardTypes__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CreditCardTypes__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CreditCardTypes__dbt_tmp"
    end


   EXEC('create view dbo.AH_CreditCardTypes__dbt_tmp_temp_view as
    
Select
	cast([Enabled] as bit) [Enabled],
	cast([ID] as int) [Id],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_CreditCardTypes_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CreditCardTypes__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CreditCardTypes__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CreditCardTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CreditCardTypes__dbt_tmp_temp_view"
    end



21:31:45.832800 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:31:45.832961 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:45.837060 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListings".
21:31:45.837286 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CategoryListings: rename object "dbo"."AH_CategoryListings__dbt_tmp" to AH_CategoryListings
21:31:45.867712 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:45.870297 [debug] [Thread-3  ]: On model.Shawn.AH_CategoryListings: COMMIT
21:31:45.874498 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListings".
21:31:45.874740 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CategoryListings: 
    
  if object_id ('"dbo"."AH_CategoryListings__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CategoryListings__dbt_backup"
    end

21:31:45.929398 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:46.066130 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:31:46.078482 [debug] [Thread-3  ]: finished collecting timing info
21:31:46.078909 [debug] [Thread-3  ]: On model.Shawn.AH_CategoryListings: Close
21:31:46.079651 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae93190>]}
21:31:46.080138 [info ] [Thread-3  ]: 13 of 105 OK created table model dbo.AH_CategoryListings........................ [[32mOK[0m in 4.60s]
21:31:46.080491 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_CategoryListings
21:31:46.080672 [debug] [Thread-3  ]: Began running node model.Shawn.AH_CreditCards
21:31:46.081077 [info ] [Thread-3  ]: 18 of 105 START table model dbo.AH_CreditCards.................................. [RUN]
21:31:46.081497 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_CreditCards"
21:31:46.081650 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_CreditCards
21:31:46.081784 [debug] [Thread-3  ]: Compiling model.Shawn.AH_CreditCards
21:31:46.084336 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_CreditCards"
21:31:46.084808 [debug] [Thread-3  ]: finished collecting timing info
21:31:46.084968 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_CreditCards
21:31:46.119358 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_CreditCards"
21:31:46.120027 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards".
21:31:46.120213 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CreditCards: 
  
  if object_id ('"dbo"."AH_CreditCards__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CreditCards__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CreditCards__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CreditCards__dbt_tmp"
    end


   EXEC('create view dbo.AH_CreditCards__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([ExpirationMonth] as nvarchar(4000)) [ExpirationMonth],
	cast([ExpirationYear] as nvarchar(4000)) [ExpirationYear],
	cast([CreditCardTypeID] as int) [CreditCardTypeId],
	cast([UserID] as int) [UserId],
	cast([AddressID] as int) [AddressId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CardNumber] as nvarchar(4000)) [CardNumber],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([LastFourdigits] as nvarchar(4000)) [LastFourDigits],
	cast([Description] as nvarchar(4000)) [Description] 
From stg.[AH_CreditCards_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CreditCards__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CreditCards__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CreditCards__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CreditCards__dbt_tmp_temp_view"
    end



21:31:46.120335 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:31:46.120476 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:46.224189 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:48.202018 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.49 seconds
21:31:48.216670 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Countries".
21:31:48.217014 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Countries: rename object "dbo"."AH_Countries" to AH_Countries__dbt_backup
21:31:48.251887 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:48.265625 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Countries".
21:31:48.265940 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Countries: rename object "dbo"."AH_Countries__dbt_tmp" to AH_Countries
21:31:48.304741 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:31:48.306793 [debug] [Thread-1  ]: On model.Shawn.AH_Countries: COMMIT
21:31:48.311296 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Countries".
21:31:48.311567 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Countries: 
    
  if object_id ('"dbo"."AH_Countries__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Countries__dbt_backup"
    end

21:31:48.544819 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:31:48.558761 [debug] [Thread-1  ]: finished collecting timing info
21:31:48.559219 [debug] [Thread-1  ]: On model.Shawn.AH_Countries: Close
21:31:48.560032 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae93820>]}
21:31:48.560518 [info ] [Thread-1  ]: 16 of 105 OK created table model dbo.AH_Countries............................... [[32mOK[0m in 2.88s]
21:31:48.560884 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Countries
21:31:48.561066 [debug] [Thread-1  ]: Began running node model.Shawn.AH_CreditCardsExtraInFormation
21:31:48.561458 [info ] [Thread-1  ]: 19 of 105 START table model dbo.AH_CreditCardsExtraInFormation.................. [RUN]
21:31:48.561878 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_CreditCardsExtraInFormation"
21:31:48.562034 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_CreditCardsExtraInFormation
21:31:48.562171 [debug] [Thread-1  ]: Compiling model.Shawn.AH_CreditCardsExtraInFormation
21:31:48.564801 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_CreditCardsExtraInFormation"
21:31:48.565299 [debug] [Thread-1  ]: finished collecting timing info
21:31:48.565459 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_CreditCardsExtraInFormation
21:31:48.602066 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_CreditCardsExtraInFormation"
21:31:48.602808 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardsExtraInFormation".
21:31:48.603017 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCardsExtraInFormation: 
  
  if object_id ('"dbo"."AH_CreditCardsExtraInFormation__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CreditCardsExtraInFormation__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CreditCardsExtraInFormation__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CreditCardsExtraInFormation__dbt_tmp"
    end


   EXEC('create view dbo.AH_CreditCardsExtraInFormation__dbt_tmp_temp_view as
    
Select
	cast([Cvv] as nvarchar(4000)) [CVV],
	cast([ID] as int) [Id],
	cast([CreditCardID] as int) [CreditCardId] 
From stg.[AH_CreditCardsExtraInFormation_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CreditCardsExtraInFormation__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CreditCardsExtraInFormation__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CreditCardsExtraInFormation__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CreditCardsExtraInFormation__dbt_tmp_temp_view"
    end



21:31:48.603142 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:31:48.603289 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:48.666158 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.83 seconds
21:31:48.743793 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:48.752933 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardTypes".
21:31:48.753828 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CreditCardTypes: rename object "dbo"."AH_CreditCardTypes" to AH_CreditCardTypes__dbt_backup
21:31:48.786936 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:48.799813 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardTypes".
21:31:48.800111 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CreditCardTypes: rename object "dbo"."AH_CreditCardTypes__dbt_tmp" to AH_CreditCardTypes
21:31:48.827832 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:48.829541 [debug] [Thread-2  ]: On model.Shawn.AH_CreditCardTypes: COMMIT
21:31:48.833668 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardTypes".
21:31:48.833896 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CreditCardTypes: 
    
  if object_id ('"dbo"."AH_CreditCardTypes__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CreditCardTypes__dbt_backup"
    end

21:31:49.074050 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.95 seconds
21:31:49.088889 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards".
21:31:49.089193 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CreditCards: rename object "dbo"."AH_CreditCards" to AH_CreditCards__dbt_backup
21:31:49.121896 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:49.134768 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards".
21:31:49.135061 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CreditCards: rename object "dbo"."AH_CreditCards__dbt_tmp" to AH_CreditCards
21:31:49.167017 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:49.168900 [debug] [Thread-3  ]: On model.Shawn.AH_CreditCards: COMMIT
21:31:49.173223 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards".
21:31:49.173455 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CreditCards: 
    
  if object_id ('"dbo"."AH_CreditCards__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CreditCards__dbt_backup"
    end

21:31:49.354988 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:31:49.366913 [debug] [Thread-3  ]: finished collecting timing info
21:31:49.367233 [debug] [Thread-3  ]: On model.Shawn.AH_CreditCards: Close
21:31:49.367894 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae936d0>]}
21:31:49.368343 [info ] [Thread-3  ]: 18 of 105 OK created table model dbo.AH_CreditCards............................. [[32mOK[0m in 3.29s]
21:31:49.368685 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_CreditCards
21:31:49.368854 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Currencies
21:31:49.369220 [info ] [Thread-3  ]: 20 of 105 START table model dbo.AH_Currencies................................... [RUN]
21:31:49.369613 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Currencies"
21:31:49.369758 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Currencies
21:31:49.369885 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Currencies
21:31:49.370061 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.54 seconds
21:31:49.372622 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Currencies"
21:31:49.381888 [debug] [Thread-3  ]: finished collecting timing info
21:31:49.382060 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Currencies
21:31:49.385381 [debug] [Thread-2  ]: finished collecting timing info
21:31:49.395779 [debug] [Thread-2  ]: On model.Shawn.AH_CreditCardTypes: Close
21:31:49.396408 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae93970>]}
21:31:49.396822 [info ] [Thread-2  ]: 17 of 105 OK created table model dbo.AH_CreditCardTypes......................... [[32mOK[0m in 3.62s]
21:31:49.397162 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_CreditCardTypes
21:31:49.397330 [debug] [Thread-2  ]: Began running node model.Shawn.AH_CustomFieldenums
21:31:49.397673 [info ] [Thread-2  ]: 21 of 105 START table model dbo.AH_CustomFieldenums............................. [RUN]
21:31:49.398066 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_CustomFieldenums"
21:31:49.398215 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_CustomFieldenums
21:31:49.398362 [debug] [Thread-2  ]: Compiling model.Shawn.AH_CustomFieldenums
21:31:49.400962 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_CustomFieldenums"
21:31:49.411906 [debug] [Thread-2  ]: finished collecting timing info
21:31:49.412076 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_CustomFieldenums
21:31:49.435588 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Currencies"
21:31:49.448182 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies".
21:31:49.448349 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Currencies: 
  
  if object_id ('"dbo"."AH_Currencies__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Currencies__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Currencies__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Currencies__dbt_tmp"
    end


   EXEC('create view dbo.AH_Currencies__dbt_tmp_temp_view as
    
Select
	cast([Code] as nvarchar(4000)) [Code],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([ConVersiontousd] as numeric(19,4)) [ConversionToUSD] 
From stg.[AH_Currencies_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Currencies__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Currencies__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Currencies__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Currencies__dbt_tmp_temp_view"
    end



21:31:49.448471 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:31:49.448608 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:49.459767 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_CustomFieldenums"
21:31:49.460198 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFieldenums".
21:31:49.460353 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CustomFieldenums: 
  
  if object_id ('"dbo"."AH_CustomFieldenums__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CustomFieldenums__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CustomFieldenums__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CustomFieldenums__dbt_tmp"
    end


   EXEC('create view dbo.AH_CustomFieldenums__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([Value] as nvarchar(4000)) [Value],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([CustomFieldID] as int) [CustomFieldId],
	cast([Enabled] as bit) [Enabled] 
From stg.[AH_CustomFieldenums_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CustomFieldenums__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CustomFieldenums__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CustomFieldenums__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CustomFieldenums__dbt_tmp_temp_view"
    end



21:31:49.460470 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:31:49.460602 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:49.552150 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:49.557127 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:51.211881 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.61 seconds
21:31:51.226826 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardsExtraInFormation".
21:31:51.227171 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCardsExtraInFormation: rename object "dbo"."AH_CreditCardsExtraInFormation" to AH_CreditCardsExtraInFormation__dbt_backup
21:31:51.262219 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:51.276007 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardsExtraInFormation".
21:31:51.276373 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCardsExtraInFormation: rename object "dbo"."AH_CreditCardsExtraInFormation__dbt_tmp" to AH_CreditCardsExtraInFormation
21:31:51.307051 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:51.308965 [debug] [Thread-1  ]: On model.Shawn.AH_CreditCardsExtraInFormation: COMMIT
21:31:51.313023 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardsExtraInFormation".
21:31:51.313241 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCardsExtraInFormation: 
    
  if object_id ('"dbo"."AH_CreditCardsExtraInFormation__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CreditCardsExtraInFormation__dbt_backup"
    end

21:31:51.522148 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:31:51.534716 [debug] [Thread-1  ]: finished collecting timing info
21:31:51.535156 [debug] [Thread-1  ]: On model.Shawn.AH_CreditCardsExtraInFormation: Close
21:31:51.535942 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae93ac0>]}
21:31:51.536437 [info ] [Thread-1  ]: 19 of 105 OK created table model dbo.AH_CreditCardsExtraInFormation............. [[32mOK[0m in 2.97s]
21:31:51.536803 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_CreditCardsExtraInFormation
21:31:51.536981 [debug] [Thread-1  ]: Began running node model.Shawn.AH_CustomFields
21:31:51.537364 [info ] [Thread-1  ]: 22 of 105 START table model dbo.AH_CustomFields................................. [RUN]
21:31:51.537787 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_CustomFields"
21:31:51.537937 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_CustomFields
21:31:51.538068 [debug] [Thread-1  ]: Compiling model.Shawn.AH_CustomFields
21:31:51.540777 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_CustomFields"
21:31:51.541273 [debug] [Thread-1  ]: finished collecting timing info
21:31:51.541435 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_CustomFields
21:31:51.577238 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_CustomFields"
21:31:51.577931 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFields".
21:31:51.578119 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CustomFields: 
  
  if object_id ('"dbo"."AH_CustomFields__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CustomFields__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CustomFields__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CustomFields__dbt_tmp"
    end


   EXEC('create view dbo.AH_CustomFields__dbt_tmp_temp_view as
    
Select
	cast([Required] as bit) [Required],
	cast([Deferred] as bit) [Deferred],
	cast([Encrypted] as bit) [Encrypted],
	cast([IncludeonInvoice] as bit) [IncludeOnInvoice],
	cast([IncludeinSalesReport] as bit) [IncludeInSalesReport],
	cast([IncludeonInvoiceasSeller] as bit) [IncludeOnInvoiceAsSeller],
	cast([IncludeonInvoiceasBuyer] as bit) [IncludeOnInvoiceAsBuyer],
	cast([IncludeinSalesReportasSeller] as bit) [IncludeInSalesReportAsSeller],
	cast([IncludeinSalesReportasBuyer] as bit) [IncludeInSalesReportAsBuyer],
	cast([ID] as int) [Id],
	cast([Type] as int) [Type],
	cast([DisplayOrder] as int) [DisplayOrder],
	cast([VisiBIlity] as int) [Visibility],
	cast([MutaBIlity] as int) [Mutability],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(500)) [Name],
	cast([DefaultValue] as nvarchar(300)) [DefaultValue],
	cast([GroupName] as nvarchar(500)) [GroupName],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser] 
From stg.[AH_CustomFields_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CustomFields__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CustomFields__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CustomFields__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CustomFields__dbt_tmp_temp_view"
    end



21:31:51.578254 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:31:51.578400 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:51.720932 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:52.247386 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.80 seconds
21:31:52.261532 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies".
21:31:52.261879 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Currencies: rename object "dbo"."AH_Currencies" to AH_Currencies__dbt_backup
21:31:52.308835 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:31:52.321948 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies".
21:31:52.322277 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Currencies: rename object "dbo"."AH_Currencies__dbt_tmp" to AH_Currencies
21:31:52.356641 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:52.358583 [debug] [Thread-3  ]: On model.Shawn.AH_Currencies: COMMIT
21:31:52.363119 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies".
21:31:52.363363 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Currencies: 
    
  if object_id ('"dbo"."AH_Currencies__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Currencies__dbt_backup"
    end

21:31:52.603524 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.14 seconds
21:31:52.617912 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFieldenums".
21:31:52.618255 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CustomFieldenums: rename object "dbo"."AH_CustomFieldenums" to AH_CustomFieldenums__dbt_backup
21:31:52.648910 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:52.661752 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFieldenums".
21:31:52.662083 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CustomFieldenums: rename object "dbo"."AH_CustomFieldenums__dbt_tmp" to AH_CustomFieldenums
21:31:52.678886 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
21:31:52.690877 [debug] [Thread-3  ]: finished collecting timing info
21:31:52.691124 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:52.692804 [debug] [Thread-2  ]: On model.Shawn.AH_CustomFieldenums: COMMIT
21:31:52.696335 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFieldenums".
21:31:52.691393 [debug] [Thread-3  ]: On model.Shawn.AH_Currencies: Close
21:31:52.697426 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae93d60>]}
21:31:52.697865 [info ] [Thread-3  ]: 20 of 105 OK created table model dbo.AH_Currencies.............................. [[32mOK[0m in 3.33s]
21:31:52.698235 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Currencies
21:31:52.698409 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Customcurrencies
21:31:52.698828 [info ] [Thread-3  ]: 23 of 105 START table model dbo.AH_Customcurrencies............................. [RUN]
21:31:52.699235 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Customcurrencies"
21:31:52.699390 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Customcurrencies
21:31:52.699524 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Customcurrencies
21:31:52.701981 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Customcurrencies"
21:31:52.696562 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CustomFieldenums: 
    
  if object_id ('"dbo"."AH_CustomFieldenums__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CustomFieldenums__dbt_backup"
    end

21:31:52.702671 [debug] [Thread-3  ]: finished collecting timing info
21:31:52.702833 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Customcurrencies
21:31:52.738035 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Customcurrencies"
21:31:52.738717 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Customcurrencies".
21:31:52.738898 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Customcurrencies: 
  
  if object_id ('"dbo"."AH_Customcurrencies__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Customcurrencies__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Customcurrencies__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Customcurrencies__dbt_tmp"
    end


   EXEC('create view dbo.AH_Customcurrencies__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Isocurrencysymbol] as nvarchar(4000)) [ISOCurrencySymbol],
	cast([Currencysymbol] as nvarchar(4000)) [CurrencySymbol],
	cast([CurrencyenglishName] as nvarchar(4000)) [CurrencyEnglishName],
	cast([CurrencynativeName] as nvarchar(4000)) [CurrencyNativeName] 
From stg.[AH_Customcurrencies_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Customcurrencies__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Customcurrencies__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Customcurrencies__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Customcurrencies__dbt_tmp_temp_view"
    end



21:31:52.739019 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:31:52.739157 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:52.854782 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:52.918772 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:31:52.931512 [debug] [Thread-2  ]: finished collecting timing info
21:31:52.931873 [debug] [Thread-2  ]: On model.Shawn.AH_CustomFieldenums: Close
21:31:52.932550 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae93c10>]}
21:31:52.933005 [info ] [Thread-2  ]: 21 of 105 OK created table model dbo.AH_CustomFieldenums........................ [[32mOK[0m in 3.53s]
21:31:52.933362 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_CustomFieldenums
21:31:52.933533 [debug] [Thread-2  ]: Began running node model.Shawn.AH_DailyhuntEmailSubscribers
21:31:52.933919 [info ] [Thread-2  ]: 24 of 105 START table model dbo.AH_DailyhuntEmailSubscribers.................... [RUN]
21:31:52.934347 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_DailyhuntEmailSubscribers"
21:31:52.934495 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_DailyhuntEmailSubscribers
21:31:52.934662 [debug] [Thread-2  ]: Compiling model.Shawn.AH_DailyhuntEmailSubscribers
21:31:52.937240 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_DailyhuntEmailSubscribers"
21:31:52.937655 [debug] [Thread-2  ]: finished collecting timing info
21:31:52.937806 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_DailyhuntEmailSubscribers
21:31:52.972651 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_DailyhuntEmailSubscribers"
21:31:52.973321 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_DailyhuntEmailSubscribers".
21:31:52.973515 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_DailyhuntEmailSubscribers: 
  
  if object_id ('"dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp"
    end


   EXEC('create view dbo.AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view as
    
Select
	cast([Email] as nvarchar(4000)) [Email],
	cast([FirstName] as nvarchar(4000)) [FirstName],
	cast([LastName] as nvarchar(4000)) [LastName],
	cast([ID] as int) [Id],
	cast([ZipCode] as int) [ZipCode],
	cast([ASenthusiast] as bit) [AsEnthusiast],
	cast([AsBidder] as bit) [AsBidder],
	cast([AsConsignor] as bit) [AsConsignor] 
From stg.[AH_DailyhuntEmailSubscribers_FinalView]
    ');

  CREATE TABLE "dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view"
    end



21:31:52.973634 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:31:52.973777 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:53.070317 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:55.386595 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.81 seconds
21:31:55.394733 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.66 seconds
21:31:55.408047 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Customcurrencies".
21:31:55.480785 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Customcurrencies: rename object "dbo"."AH_Customcurrencies" to AH_Customcurrencies__dbt_backup
21:31:55.480586 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 17.00 seconds
21:31:55.484050 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFields".
21:31:55.495973 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CustomFields: rename object "dbo"."AH_CustomFields" to AH_CustomFields__dbt_backup
21:31:55.496396 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCustomFields".
21:31:55.496571 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CategoryCustomFields: rename object "dbo"."AH_CategoryCustomFields" to AH_CategoryCustomFields__dbt_backup
21:31:55.516978 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:31:55.528747 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Customcurrencies".
21:31:55.528933 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:55.529118 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Customcurrencies: rename object "dbo"."AH_Customcurrencies__dbt_tmp" to AH_Customcurrencies
21:31:55.539692 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:31:55.550909 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFields".
21:31:55.552061 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCustomFields".
21:31:55.552407 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CategoryCustomFields: rename object "dbo"."AH_CategoryCustomFields__dbt_tmp" to AH_CategoryCustomFields
21:31:55.552274 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CustomFields: rename object "dbo"."AH_CustomFields__dbt_tmp" to AH_CustomFields
21:31:55.576014 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.60 seconds
21:31:55.585144 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:55.586772 [debug] [Thread-4  ]: On model.Shawn.AH_CategoryCustomFields: COMMIT
21:31:55.585392 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:31:55.588153 [debug] [Thread-3  ]: On model.Shawn.AH_Customcurrencies: COMMIT
21:31:55.592709 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_DailyhuntEmailSubscribers".
21:31:55.598842 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_DailyhuntEmailSubscribers: rename object "dbo"."AH_DailyhuntEmailSubscribers" to AH_DailyhuntEmailSubscribers__dbt_backup
21:31:55.595732 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Customcurrencies".
21:31:55.599126 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Customcurrencies: 
    
  if object_id ('"dbo"."AH_Customcurrencies__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Customcurrencies__dbt_backup"
    end

21:31:55.598653 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCustomFields".
21:31:55.599391 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CategoryCustomFields: 
    
  if object_id ('"dbo"."AH_CategoryCustomFields__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CategoryCustomFields__dbt_backup"
    end

21:31:55.600734 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:31:55.602314 [debug] [Thread-1  ]: On model.Shawn.AH_CustomFields: COMMIT
21:31:55.605408 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFields".
21:31:55.605579 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CustomFields: 
    
  if object_id ('"dbo"."AH_CustomFields__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CustomFields__dbt_backup"
    end

21:31:55.630521 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:31:55.644196 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_DailyhuntEmailSubscribers".
21:31:55.644523 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_DailyhuntEmailSubscribers: rename object "dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp" to AH_DailyhuntEmailSubscribers
21:31:55.691147 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:31:55.693022 [debug] [Thread-2  ]: On model.Shawn.AH_DailyhuntEmailSubscribers: COMMIT
21:31:55.697542 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_DailyhuntEmailSubscribers".
21:31:55.697746 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_DailyhuntEmailSubscribers: 
    
  if object_id ('"dbo"."AH_DailyhuntEmailSubscribers__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_DailyhuntEmailSubscribers__dbt_backup"
    end

21:31:55.926436 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
21:31:55.939011 [debug] [Thread-3  ]: finished collecting timing info
21:31:55.939402 [debug] [Thread-3  ]: On model.Shawn.AH_Customcurrencies: Close
21:31:55.940155 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaeb6040>]}
21:31:55.940662 [info ] [Thread-3  ]: 23 of 105 OK created table model dbo.AH_Customcurrencies........................ [[32mOK[0m in 3.24s]
21:31:55.941031 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Customcurrencies
21:31:55.941212 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Decorations
21:31:55.941594 [info ] [Thread-3  ]: 25 of 105 START table model dbo.AH_Decorations.................................. [RUN]
21:31:55.942019 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Decorations"
21:31:55.942167 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Decorations
21:31:55.942297 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Decorations
21:31:55.945066 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Decorations"
21:31:55.945217 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
21:31:55.952728 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:31:55.953014 [debug] [Thread-3  ]: finished collecting timing info
21:31:55.954082 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Decorations
21:31:55.959694 [debug] [Thread-1  ]: finished collecting timing info
21:31:55.976164 [debug] [Thread-1  ]: On model.Shawn.AH_CustomFields: Close
21:31:55.976830 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae93eb0>]}
21:31:55.977241 [info ] [Thread-1  ]: 22 of 105 OK created table model dbo.AH_CustomFields............................ [[32mOK[0m in 4.44s]
21:31:55.977588 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_CustomFields
21:31:55.977759 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Emailtemplatecontents
21:31:55.983829 [info ] [Thread-1  ]: 26 of 105 START table model dbo.AH_Emailtemplatecontents........................ [RUN]
21:31:55.984260 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Emailtemplatecontents"
21:31:55.984411 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Emailtemplatecontents
21:31:55.984543 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Emailtemplatecontents
21:31:55.975878 [debug] [Thread-2  ]: finished collecting timing info
21:31:55.987396 [debug] [Thread-2  ]: On model.Shawn.AH_DailyhuntEmailSubscribers: Close
21:31:55.987929 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaeb6190>]}
21:31:55.988305 [info ] [Thread-2  ]: 24 of 105 OK created table model dbo.AH_DailyhuntEmailSubscribers............... [[32mOK[0m in 3.05s]
21:31:55.988613 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_DailyhuntEmailSubscribers
21:31:55.988776 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Emailtemplates
21:31:55.989092 [info ] [Thread-2  ]: 27 of 105 START table model dbo.AH_Emailtemplates............................... [RUN]
21:31:55.989456 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Emailtemplates"
21:31:55.989598 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Emailtemplates
21:31:55.989719 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Emailtemplates
21:31:55.991967 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Emailtemplates"
21:31:55.987171 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Emailtemplatecontents"
21:31:56.000045 [debug] [Thread-1  ]: finished collecting timing info
21:31:56.000352 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Emailtemplatecontents
21:31:56.000255 [debug] [Thread-2  ]: finished collecting timing info
21:31:56.027710 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Emailtemplates
21:31:56.031396 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Decorations"
21:31:56.066906 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Emailtemplatecontents"
21:31:56.076282 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplatecontents".
21:31:56.076463 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplatecontents: 
  
  if object_id ('"dbo"."AH_Emailtemplatecontents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Emailtemplatecontents__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Emailtemplatecontents__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Emailtemplatecontents__dbt_tmp"
    end


   EXEC('create view dbo.AH_Emailtemplatecontents__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([Culture] as nvarchar(4000)) [Culture],
	cast([SuBJect] as nvarchar(4000)) [Subject],
	cast([Body] as nvarchar(4000)) [Body],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id] 
From stg.[AH_Emailtemplatecontents_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Emailtemplatecontents__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Emailtemplatecontents__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Emailtemplatecontents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Emailtemplatecontents__dbt_tmp_temp_view"
    end



21:31:56.076588 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:31:56.076740 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:56.075753 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Decorations".
21:31:56.077751 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Decorations: 
  
  if object_id ('"dbo"."AH_Decorations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Decorations__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Decorations__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Decorations__dbt_tmp"
    end


   EXEC('create view dbo.AH_Decorations__dbt_tmp_temp_view as
    
Select
	cast([PayToproceed] as bit) [PayToProceed],
	cast([ID] as int) [Id],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ValIDFields] as nvarchar(4000)) [ValidFields],
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Name] as nvarchar(4000)) [Name],
	cast([FormatString] as nvarchar(4000)) [FormatString],
	cast([Amount] as numeric(19,4)) [Amount] 
From stg.[AH_Decorations_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Decorations__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Decorations__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Decorations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Decorations__dbt_tmp_temp_view"
    end



21:31:56.077914 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:31:56.078051 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:56.087014 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Emailtemplates"
21:31:56.087446 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplates".
21:31:56.087605 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplates: 
  
  if object_id ('"dbo"."AH_Emailtemplates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Emailtemplates__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Emailtemplates__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Emailtemplates__dbt_tmp"
    end


   EXEC('create view dbo.AH_Emailtemplates__dbt_tmp_temp_view as
    
Select
	cast([Enabled] as bit) [Enabled],
	cast([ID] as int) [Id],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_Emailtemplates_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Emailtemplates__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Emailtemplates__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Emailtemplates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Emailtemplates__dbt_tmp_temp_view"
    end



21:31:56.087733 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:31:56.087868 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:56.095735 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.50 seconds
21:31:56.118083 [debug] [Thread-4  ]: finished collecting timing info
21:31:56.118448 [debug] [Thread-4  ]: On model.Shawn.AH_CategoryCustomFields: Close
21:31:56.119110 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaeb7c10>]}
21:31:56.119549 [info ] [Thread-4  ]: 11 of 105 OK created table model dbo.AH_CategoryCustomFields.................... [[32mOK[0m in 17.75s]
21:31:56.120136 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_CategoryCustomFields
21:31:56.120324 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Eventproperties
21:31:56.120691 [info ] [Thread-4  ]: 28 of 105 START table model dbo.AH_Eventproperties.............................. [RUN]
21:31:56.121090 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Eventproperties"
21:31:56.121249 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Eventproperties
21:31:56.121384 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Eventproperties
21:31:56.124706 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Eventproperties"
21:31:56.125110 [debug] [Thread-4  ]: finished collecting timing info
21:31:56.125262 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Eventproperties
21:31:56.171444 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Eventproperties"
21:31:56.172087 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Eventproperties".
21:31:56.172277 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Eventproperties: 
  
  if object_id ('"dbo"."AH_Eventproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Eventproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Eventproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Eventproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_Eventproperties__dbt_tmp_temp_view as
    
Select
	cast([StringnativeValue] as nvarchar(4000)) [StringNativeValue],
	cast([EnumnativeValue] as nvarchar(4000)) [EnumNativeValue],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([DecimalnativeValue] as numeric(19,4)) [DecimalNativeValue],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DateTimenativeValue] as datetime) [DateTimeNativeValue],
	cast([BoolnativeValue] as bit) [BoolNativeValue],
	cast([ID] as int) [Id],
	cast([IntnativeValue] as int) [IntNativeValue],
	cast([AuctionEventID] as int) [AuctionEventId],
	cast([CustomFieldID] as int) [CustomFieldId] 
From stg.[AH_Eventproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Eventproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Eventproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Eventproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Eventproperties__dbt_tmp_temp_view"
    end



21:31:56.172409 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:31:56.172560 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:56.181306 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:56.183902 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:56.185424 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:56.273697 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:58.962432 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.87 seconds
21:31:58.977269 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplates".
21:31:58.977576 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplates: rename object "dbo"."AH_Emailtemplates" to AH_Emailtemplates__dbt_backup
21:31:59.022602 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:31:59.036800 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplates".
21:31:59.037126 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplates: rename object "dbo"."AH_Emailtemplates__dbt_tmp" to AH_Emailtemplates
21:31:59.085431 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:31:59.087395 [debug] [Thread-2  ]: On model.Shawn.AH_Emailtemplates: COMMIT
21:31:59.091775 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplates".
21:31:59.091988 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplates: 
    
  if object_id ('"dbo"."AH_Emailtemplates__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Emailtemplates__dbt_backup"
    end

21:31:59.209388 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.04 seconds
21:31:59.223970 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Eventproperties".
21:31:59.224299 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Eventproperties: rename object "dbo"."AH_Eventproperties" to AH_Eventproperties__dbt_backup
21:31:59.271626 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:31:59.285777 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Eventproperties".
21:31:59.286121 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Eventproperties: rename object "dbo"."AH_Eventproperties__dbt_tmp" to AH_Eventproperties
21:31:59.307992 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.23 seconds
21:31:59.322582 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Decorations".
21:31:59.322785 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:31:59.324371 [debug] [Thread-4  ]: On model.Shawn.AH_Eventproperties: COMMIT
21:31:59.322986 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Decorations: rename object "dbo"."AH_Decorations" to AH_Decorations__dbt_backup
21:31:59.327609 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Eventproperties".
21:31:59.327962 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Eventproperties: 
    
  if object_id ('"dbo"."AH_Eventproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Eventproperties__dbt_backup"
    end

21:31:59.362718 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.29 seconds
21:31:59.371743 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:31:59.379418 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplatecontents".
21:31:59.391207 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplatecontents: rename object "dbo"."AH_Emailtemplatecontents" to AH_Emailtemplatecontents__dbt_backup
21:31:59.390878 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Decorations".
21:31:59.391538 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Decorations: rename object "dbo"."AH_Decorations__dbt_tmp" to AH_Decorations
21:31:59.427880 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:31:59.429912 [debug] [Thread-3  ]: On model.Shawn.AH_Decorations: COMMIT
21:31:59.433798 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Decorations".
21:31:59.434001 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Decorations: 
    
  if object_id ('"dbo"."AH_Decorations__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Decorations__dbt_backup"
    end

21:31:59.444208 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:31:59.457307 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplatecontents".
21:31:59.457545 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplatecontents: rename object "dbo"."AH_Emailtemplatecontents__dbt_tmp" to AH_Emailtemplatecontents
21:31:59.508581 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:31:59.510917 [debug] [Thread-1  ]: On model.Shawn.AH_Emailtemplatecontents: COMMIT
21:31:59.514821 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplatecontents".
21:31:59.515021 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplatecontents: 
    
  if object_id ('"dbo"."AH_Emailtemplatecontents__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Emailtemplatecontents__dbt_backup"
    end

21:31:59.616290 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.52 seconds
21:31:59.616753 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:31:59.630789 [debug] [Thread-2  ]: finished collecting timing info
21:31:59.702072 [debug] [Thread-2  ]: On model.Shawn.AH_Emailtemplates: Close
21:31:59.702918 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaeb6670>]}
21:31:59.703386 [info ] [Thread-2  ]: 27 of 105 OK created table model dbo.AH_Emailtemplates.......................... [[32mOK[0m in 3.71s]
21:31:59.703751 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Emailtemplates
21:31:59.703927 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Events
21:31:59.704283 [info ] [Thread-2  ]: 29 of 105 START table model dbo.AH_Events....................................... [RUN]
21:31:59.704690 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Events"
21:31:59.704840 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Events
21:31:59.704969 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Events
21:31:59.707491 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Events"
21:31:59.713840 [debug] [Thread-2  ]: finished collecting timing info
21:31:59.713990 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Events
21:31:59.713424 [debug] [Thread-4  ]: finished collecting timing info
21:31:59.722015 [debug] [Thread-4  ]: On model.Shawn.AH_Eventproperties: Close
21:31:59.721852 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:31:59.722632 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58ab21af40>]}
21:31:59.736477 [info ] [Thread-4  ]: 28 of 105 OK created table model dbo.AH_Eventproperties......................... [[32mOK[0m in 3.60s]
21:31:59.736913 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Eventproperties
21:31:59.737084 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ExternalUserIDs
21:31:59.737443 [info ] [Thread-4  ]: 30 of 105 START table model dbo.AH_ExternalUserIDs.............................. [RUN]
21:31:59.737885 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ExternalUserIDs"
21:31:59.738032 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ExternalUserIDs
21:31:59.740399 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ExternalUserIDs
21:31:59.743013 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ExternalUserIDs"
21:31:59.740263 [debug] [Thread-3  ]: finished collecting timing info
21:31:59.751981 [debug] [Thread-3  ]: On model.Shawn.AH_Decorations: Close
21:31:59.752755 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaeb6430>]}
21:31:59.752979 [debug] [Thread-4  ]: finished collecting timing info
21:31:59.755964 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ExternalUserIDs
21:31:59.763705 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:31:59.800660 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Events"
21:31:59.827909 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Events".
21:31:59.828167 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Events: 
  
  if object_id ('"dbo"."AH_Events__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Events__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Events__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Events__dbt_tmp"
    end


   EXEC('create view dbo.AH_Events__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_Events_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Events__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Events__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Events__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Events__dbt_tmp_temp_view"
    end



21:31:59.828458 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:31:59.828643 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:59.831965 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ExternalUserIDs"
21:31:59.827200 [debug] [Thread-1  ]: finished collecting timing info
21:31:59.832629 [debug] [Thread-1  ]: On model.Shawn.AH_Emailtemplatecontents: Close
21:31:59.833289 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaeb63d0>]}
21:31:59.833594 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ExternalUserIDs".
21:31:59.833901 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ExternalUserIDs: 
  
  if object_id ('"dbo"."AH_ExternalUserIDs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ExternalUserIDs__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ExternalUserIDs__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ExternalUserIDs__dbt_tmp"
    end


   EXEC('create view dbo.AH_ExternalUserIDs__dbt_tmp_temp_view as
    
Select
	cast([ProvIDErName] as nvarchar(4000)) [ProviderName],
	cast([ProvIDErUserID] as nvarchar(4000)) [ProviderUserId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([LocalUserID] as int) [LocalUserId] 
From stg.[AH_ExternalUserIDs_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ExternalUserIDs__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ExternalUserIDs__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ExternalUserIDs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ExternalUserIDs__dbt_tmp_temp_view"
    end



21:31:59.834041 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:31:59.834178 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:59.872669 [info ] [Thread-3  ]: 25 of 105 OK created table model dbo.AH_Decorations............................. [[32mOK[0m in 3.81s]
21:31:59.873274 [info ] [Thread-1  ]: 26 of 105 OK created table model dbo.AH_Emailtemplatecontents................... [[32mOK[0m in 3.85s]
21:31:59.873828 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Decorations
21:31:59.873982 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Emailtemplatecontents
21:31:59.875115 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Feeproperties
21:31:59.875453 [info ] [Thread-1  ]: 32 of 105 START table model dbo.AH_Feeproperties................................ [RUN]
21:31:59.875966 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Feeproperties"
21:31:59.876124 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Feeproperties
21:31:59.876262 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Feeproperties
21:31:59.874168 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Feedbacks
21:31:59.879910 [info ] [Thread-3  ]: 31 of 105 START table model dbo.AH_Feedbacks.................................... [RUN]
21:31:59.880557 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Feedbacks"
21:31:59.880740 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Feedbacks
21:31:59.880873 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Feedbacks
21:31:59.879614 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Feeproperties"
21:31:59.884284 [debug] [Thread-1  ]: finished collecting timing info
21:31:59.884439 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Feeproperties
21:31:59.883868 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Feedbacks"
21:31:59.891988 [debug] [Thread-3  ]: finished collecting timing info
21:31:59.892167 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Feedbacks
21:31:59.933502 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:59.941494 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:31:59.958488 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Feeproperties"
21:31:59.964599 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeproperties".
21:31:59.964819 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Feeproperties: 
  
  if object_id ('"dbo"."AH_Feeproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Feeproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Feeproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Feeproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_Feeproperties__dbt_tmp_temp_view as
    
Select
	cast([Processor] as nvarchar(4000)) [Processor],
	cast([Name] as nvarchar(4000)) [Name],
	cast([Description] as nvarchar(4000)) [Description],
	cast([Amount] as numeric(19,4)) [Amount],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([ListingTypeID] as int) [ListingTypeId],
	cast([EventID] as int) [EventId] 
From stg.[AH_Feeproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Feeproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Feeproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Feeproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Feeproperties__dbt_tmp_temp_view"
    end



21:31:59.964968 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:31:59.965118 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:31:59.963945 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Feedbacks"
21:31:59.966682 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feedbacks".
21:31:59.966851 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Feedbacks: 
  
  if object_id ('"dbo"."AH_Feedbacks__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Feedbacks__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Feedbacks__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Feedbacks__dbt_tmp"
    end


   EXEC('create view dbo.AH_Feedbacks__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([SEndingUserID] as int) [SendingUserId],
	cast([ReceivINgUserID] as int) [ReceivingUserId],
	cast([Rating] as int) [Rating],
	cast([ListingID] as int) [ListingId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DaTestamp] as datetime) [DateStamp],
	cast([Comment] as nvarchar(4000)) [Comment],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([ListingOwnerUserName] as nvarchar(4000)) [ListingOwnerUsername] 
From stg.[AH_Feedbacks_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Feedbacks__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Feedbacks__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Feedbacks__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Feedbacks__dbt_tmp_temp_view"
    end



21:31:59.966972 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:31:59.967110 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:00.062592 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:00.098521 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:03.575179 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.61 seconds
21:32:03.589496 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.76 seconds
21:32:03.600014 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feedbacks".
21:32:03.600304 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Feedbacks: rename object "dbo"."AH_Feedbacks" to AH_Feedbacks__dbt_backup
21:32:03.602318 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ExternalUserIDs".
21:32:03.602574 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ExternalUserIDs: rename object "dbo"."AH_ExternalUserIDs" to AH_ExternalUserIDs__dbt_backup
21:32:03.630068 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:03.644032 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feedbacks".
21:32:03.644244 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:32:03.644453 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Feedbacks: rename object "dbo"."AH_Feedbacks__dbt_tmp" to AH_Feedbacks
21:32:03.656169 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ExternalUserIDs".
21:32:03.656401 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ExternalUserIDs: rename object "dbo"."AH_ExternalUserIDs__dbt_tmp" to AH_ExternalUserIDs
21:32:03.697163 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:32:03.699333 [debug] [Thread-3  ]: On model.Shawn.AH_Feedbacks: COMMIT
21:32:03.703298 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feedbacks".
21:32:03.703584 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Feedbacks: 
    
  if object_id ('"dbo"."AH_Feedbacks__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Feedbacks__dbt_backup"
    end

21:32:03.712977 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:32:03.715064 [debug] [Thread-4  ]: On model.Shawn.AH_ExternalUserIDs: COMMIT
21:32:03.719142 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ExternalUserIDs".
21:32:03.719422 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ExternalUserIDs: 
    
  if object_id ('"dbo"."AH_ExternalUserIDs__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ExternalUserIDs__dbt_backup"
    end

21:32:03.723098 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.89 seconds
21:32:03.730973 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.77 seconds
21:32:03.744015 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeproperties".
21:32:03.750682 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Feeproperties: rename object "dbo"."AH_Feeproperties" to AH_Feeproperties__dbt_backup
21:32:03.750226 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Events".
21:32:03.751031 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Events: rename object "dbo"."AH_Events" to AH_Events__dbt_backup
21:32:03.792970 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:32:03.807944 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeproperties".
21:32:03.808215 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:32:03.808456 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Feeproperties: rename object "dbo"."AH_Feeproperties__dbt_tmp" to AH_Feeproperties
21:32:03.821751 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Events".
21:32:03.822058 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Events: rename object "dbo"."AH_Events__dbt_tmp" to AH_Events
21:32:03.857956 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:32:03.860053 [debug] [Thread-1  ]: On model.Shawn.AH_Feeproperties: COMMIT
21:32:03.864153 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeproperties".
21:32:03.864421 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:32:03.865953 [debug] [Thread-2  ]: On model.Shawn.AH_Events: COMMIT
21:32:03.869652 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Events".
21:32:03.864525 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Feeproperties: 
    
  if object_id ('"dbo"."AH_Feeproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Feeproperties__dbt_backup"
    end

21:32:03.869849 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Events: 
    
  if object_id ('"dbo"."AH_Events__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Events__dbt_backup"
    end

21:32:04.636159 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.93 seconds
21:32:04.720374 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.00 seconds
21:32:04.720772 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.85 seconds
21:32:04.720875 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.85 seconds
21:32:04.728324 [debug] [Thread-3  ]: finished collecting timing info
21:32:04.743029 [debug] [Thread-3  ]: On model.Shawn.AH_Feedbacks: Close
21:32:04.749020 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b0006ac0>]}
21:32:04.754808 [info ] [Thread-3  ]: 31 of 105 OK created table model dbo.AH_Feedbacks............................... [[32mOK[0m in 4.87s]
21:32:04.760227 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Feedbacks
21:32:04.760453 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Feeschedules
21:32:04.760872 [info ] [Thread-3  ]: 33 of 105 START table model dbo.AH_Feeschedules................................. [RUN]
21:32:04.761387 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Feeschedules"
21:32:04.748086 [debug] [Thread-4  ]: finished collecting timing info
21:32:04.761733 [debug] [Thread-4  ]: On model.Shawn.AH_ExternalUserIDs: Close
21:32:04.762348 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a855b550>]}
21:32:04.762773 [info ] [Thread-4  ]: 30 of 105 OK created table model dbo.AH_ExternalUserIDs......................... [[32mOK[0m in 5.02s]
21:32:04.763125 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ExternalUserIDs
21:32:04.754281 [debug] [Thread-1  ]: finished collecting timing info
21:32:04.763591 [debug] [Thread-1  ]: On model.Shawn.AH_Feeproperties: Close
21:32:04.764121 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b0006a60>]}
21:32:04.764468 [info ] [Thread-1  ]: 32 of 105 OK created table model dbo.AH_Feeproperties........................... [[32mOK[0m in 4.89s]
21:32:04.764765 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Feeproperties
21:32:04.761564 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Feeschedules
21:32:04.765186 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Feeschedules
21:32:04.763312 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ImportedCategoryMap
21:32:04.768748 [info ] [Thread-4  ]: 34 of 105 START table model dbo.AH_ImportedCategoryMap.......................... [RUN]
21:32:04.769206 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ImportedCategoryMap"
21:32:04.769370 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ImportedCategoryMap
21:32:04.769563 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ImportedCategoryMap
21:32:04.764928 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ImportedListingsMap
21:32:04.772692 [info ] [Thread-1  ]: 35 of 105 START table model dbo.AH_ImportedListingsMap.......................... [RUN]
21:32:04.773133 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ImportedListingsMap"
21:32:04.773296 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ImportedListingsMap
21:32:04.773431 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ImportedListingsMap
21:32:04.776041 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ImportedListingsMap"
21:32:04.759859 [debug] [Thread-2  ]: finished collecting timing info
21:32:04.776552 [debug] [Thread-2  ]: On model.Shawn.AH_Events: Close
21:32:04.777195 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58ab0109d0>]}
21:32:04.777582 [info ] [Thread-2  ]: 29 of 105 OK created table model dbo.AH_Events.................................. [[32mOK[0m in 5.07s]
21:32:04.777935 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Events
21:32:04.768450 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Feeschedules"
21:32:04.778648 [debug] [Thread-3  ]: finished collecting timing info
21:32:04.778808 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Feeschedules
21:32:04.778117 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ImportedUserMap
21:32:04.788136 [info ] [Thread-2  ]: 36 of 105 START table model dbo.AH_ImportedUserMap.............................. [RUN]
21:32:04.788822 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ImportedUserMap"
21:32:04.788998 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ImportedUserMap
21:32:04.789136 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ImportedUserMap
21:32:04.788412 [debug] [Thread-1  ]: finished collecting timing info
21:32:04.792107 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ImportedListingsMap
21:32:04.772379 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ImportedCategoryMap"
21:32:04.791869 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ImportedUserMap"
21:32:04.833882 [debug] [Thread-4  ]: finished collecting timing info
21:32:04.834693 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ImportedCategoryMap
21:32:04.834514 [debug] [Thread-2  ]: finished collecting timing info
21:32:04.836326 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ImportedUserMap
21:32:04.865154 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ImportedListingsMap"
21:32:04.885457 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Feeschedules"
21:32:04.922419 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ImportedCategoryMap"
21:32:04.922785 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedListingsMap".
21:32:04.932027 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ImportedListingsMap: 
  
  if object_id ('"dbo"."AH_ImportedListingsMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedListingsMap__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ImportedListingsMap__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ImportedListingsMap__dbt_tmp"
    end


   EXEC('create view dbo.AH_ImportedListingsMap__dbt_tmp_temp_view as
    
Select
	cast([ForeignListingID] as int) [foreignListingId],
	cast([LoCallistingID] as int) [localListingId] 
From stg.[AH_ImportedListingsMap_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ImportedListingsMap__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ImportedListingsMap__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ImportedListingsMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedListingsMap__dbt_tmp_temp_view"
    end



21:32:04.932181 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:32:04.932555 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:04.932445 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedCategoryMap".
21:32:04.933866 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ImportedCategoryMap: 
  
  if object_id ('"dbo"."AH_ImportedCategoryMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedCategoryMap__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ImportedCategoryMap__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ImportedCategoryMap__dbt_tmp"
    end


   EXEC('create view dbo.AH_ImportedCategoryMap__dbt_tmp_temp_view as
    
Select
	cast([LocalCategoryID] as int) [localCategoryId],
	cast([ForeignCategoryID] as int) [foreignCategoryId] 
From stg.[AH_ImportedCategoryMap_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ImportedCategoryMap__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ImportedCategoryMap__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ImportedCategoryMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedCategoryMap__dbt_tmp_temp_view"
    end



21:32:04.934053 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:32:04.934231 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:04.931566 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeschedules".
21:32:04.934648 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Feeschedules: 
  
  if object_id ('"dbo"."AH_Feeschedules__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Feeschedules__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Feeschedules__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Feeschedules__dbt_tmp"
    end


   EXEC('create view dbo.AH_Feeschedules__dbt_tmp_temp_view as
    
Select
	cast([PayToproceed] as bit) [PayToProceed],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([EventID] as int) [EventId],
	cast([ListingTypeID] as int) [ListingTypeId],
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_Feeschedules_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Feeschedules__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Feeschedules__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Feeschedules__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Feeschedules__dbt_tmp_temp_view"
    end



21:32:04.934782 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:32:04.934907 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:04.931274 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ImportedUserMap"
21:32:04.936779 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedUserMap".
21:32:04.936960 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ImportedUserMap: 
  
  if object_id ('"dbo"."AH_ImportedUserMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedUserMap__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ImportedUserMap__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ImportedUserMap__dbt_tmp"
    end


   EXEC('create view dbo.AH_ImportedUserMap__dbt_tmp_temp_view as
    
Select
	cast([LocalUserID] as int) [localUserId],
	cast([ForeignUserID] as int) [foreignUserId],
	cast([ImportedUserName] as nvarchar(4000)) [importedUsername] 
From stg.[AH_ImportedUserMap_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ImportedUserMap__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ImportedUserMap__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ImportedUserMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedUserMap__dbt_tmp_temp_view"
    end



21:32:04.937078 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:32:04.937207 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:05.080844 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:05.081970 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:05.082590 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:05.083198 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:07.339983 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.40 seconds
21:32:07.355973 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedUserMap".
21:32:07.356357 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ImportedUserMap: rename object "dbo"."AH_ImportedUserMap" to AH_ImportedUserMap__dbt_backup
21:32:07.394739 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:32:07.408392 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedUserMap".
21:32:07.408755 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ImportedUserMap: rename object "dbo"."AH_ImportedUserMap__dbt_tmp" to AH_ImportedUserMap
21:32:07.456185 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:32:07.458139 [debug] [Thread-2  ]: On model.Shawn.AH_ImportedUserMap: COMMIT
21:32:07.462506 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedUserMap".
21:32:07.462767 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ImportedUserMap: 
    
  if object_id ('"dbo"."AH_ImportedUserMap__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ImportedUserMap__dbt_backup"
    end

21:32:07.742762 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:32:07.755782 [debug] [Thread-2  ]: finished collecting timing info
21:32:07.756246 [debug] [Thread-2  ]: On model.Shawn.AH_ImportedUserMap: Close
21:32:07.757051 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a8608460>]}
21:32:07.757548 [info ] [Thread-2  ]: 36 of 105 OK created table model dbo.AH_ImportedUserMap......................... [[32mOK[0m in 2.97s]
21:32:07.757907 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ImportedUserMap
21:32:07.758088 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ImportedregionMap
21:32:07.758470 [info ] [Thread-2  ]: 37 of 105 START table model dbo.AH_ImportedregionMap............................ [RUN]
21:32:07.758941 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ImportedregionMap"
21:32:07.759094 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ImportedregionMap
21:32:07.759228 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ImportedregionMap
21:32:07.761843 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ImportedregionMap"
21:32:07.762358 [debug] [Thread-2  ]: finished collecting timing info
21:32:07.762518 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ImportedregionMap
21:32:07.798816 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ImportedregionMap"
21:32:07.799519 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedregionMap".
21:32:07.799722 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ImportedregionMap: 
  
  if object_id ('"dbo"."AH_ImportedregionMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedregionMap__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ImportedregionMap__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ImportedregionMap__dbt_tmp"
    end


   EXEC('create view dbo.AH_ImportedregionMap__dbt_tmp_temp_view as
    
Select
	cast([LocalregionID] as int) [localRegionId],
	cast([ForeignregionID] as int) [foreignRegionId],
	cast([Foreignregiontier] as int) [foreignRegionTier] 
From stg.[AH_ImportedregionMap_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ImportedregionMap__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ImportedregionMap__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ImportedregionMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedregionMap__dbt_tmp_temp_view"
    end



21:32:07.799860 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:32:07.800008 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:07.906059 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:07.946500 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.01 seconds
21:32:07.960975 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedCategoryMap".
21:32:07.961345 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ImportedCategoryMap: rename object "dbo"."AH_ImportedCategoryMap" to AH_ImportedCategoryMap__dbt_backup
21:32:07.991825 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:08.006299 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedCategoryMap".
21:32:08.006526 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.07 seconds
21:32:08.006777 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ImportedCategoryMap: rename object "dbo"."AH_ImportedCategoryMap__dbt_tmp" to AH_ImportedCategoryMap
21:32:08.020270 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedListingsMap".
21:32:08.020593 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ImportedListingsMap: rename object "dbo"."AH_ImportedListingsMap" to AH_ImportedListingsMap__dbt_backup
21:32:08.052880 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:08.061411 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.13 seconds
21:32:08.068967 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedListingsMap".
21:32:08.079901 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ImportedListingsMap: rename object "dbo"."AH_ImportedListingsMap__dbt_tmp" to AH_ImportedListingsMap
21:32:08.082088 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeschedules".
21:32:08.082366 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Feeschedules: rename object "dbo"."AH_Feeschedules" to AH_Feeschedules__dbt_backup
21:32:08.096751 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:32:08.098801 [debug] [Thread-4  ]: On model.Shawn.AH_ImportedCategoryMap: COMMIT
21:32:08.102777 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedCategoryMap".
21:32:08.103020 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ImportedCategoryMap: 
    
  if object_id ('"dbo"."AH_ImportedCategoryMap__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ImportedCategoryMap__dbt_backup"
    end

21:32:08.109133 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:08.110748 [debug] [Thread-1  ]: On model.Shawn.AH_ImportedListingsMap: COMMIT
21:32:08.114698 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedListingsMap".
21:32:08.114853 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:08.115014 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ImportedListingsMap: 
    
  if object_id ('"dbo"."AH_ImportedListingsMap__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ImportedListingsMap__dbt_backup"
    end

21:32:08.128237 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeschedules".
21:32:08.128507 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Feeschedules: rename object "dbo"."AH_Feeschedules__dbt_tmp" to AH_Feeschedules
21:32:08.160866 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:08.162858 [debug] [Thread-3  ]: On model.Shawn.AH_Feeschedules: COMMIT
21:32:08.167179 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeschedules".
21:32:08.167397 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Feeschedules: 
    
  if object_id ('"dbo"."AH_Feeschedules__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Feeschedules__dbt_backup"
    end

21:32:08.428765 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:32:08.441304 [debug] [Thread-3  ]: finished collecting timing info
21:32:08.441729 [debug] [Thread-3  ]: On model.Shawn.AH_Feeschedules: Close
21:32:08.442492 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a8608f40>]}
21:32:08.442998 [info ] [Thread-3  ]: 33 of 105 OK created table model dbo.AH_Feeschedules............................ [[32mOK[0m in 3.68s]
21:32:08.443359 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Feeschedules
21:32:08.443539 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Increments
21:32:08.443916 [info ] [Thread-3  ]: 38 of 105 START table model dbo.AH_Increments................................... [RUN]
21:32:08.444327 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Increments"
21:32:08.444478 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Increments
21:32:08.444612 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Increments
21:32:08.447251 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Increments"
21:32:08.447752 [debug] [Thread-3  ]: finished collecting timing info
21:32:08.447917 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Increments
21:32:08.483911 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Increments"
21:32:08.484183 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.38 seconds
21:32:08.572920 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.45 seconds
21:32:08.573569 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Increments".
21:32:08.574963 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Increments: 
  
  if object_id ('"dbo"."AH_Increments__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Increments__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Increments__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Increments__dbt_tmp"
    end


   EXEC('create view dbo.AH_Increments__dbt_tmp_temp_view as
    
Select
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([PriceLevel] as numeric(19,4)) [PriceLevel],
	cast([Amount] as numeric(19,4)) [Amount],
	cast([ID] as int) [Id],
	cast([ListingTypeID] as int) [ListingTypeId],
	cast([AuctionEventID] as int) [AuctionEventId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_Increments_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Increments__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Increments__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Increments__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Increments__dbt_tmp_temp_view"
    end



21:32:08.575134 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:32:08.575285 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:08.577475 [debug] [Thread-4  ]: finished collecting timing info
21:32:08.587345 [debug] [Thread-4  ]: On model.Shawn.AH_ImportedCategoryMap: Close
21:32:08.588168 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a85eff10>]}
21:32:08.588652 [info ] [Thread-4  ]: 34 of 105 OK created table model dbo.AH_ImportedCategoryMap..................... [[32mOK[0m in 3.82s]
21:32:08.589017 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ImportedCategoryMap
21:32:08.589195 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Invoices
21:32:08.589571 [info ] [Thread-4  ]: 39 of 105 START table model dbo.AH_Invoices..................................... [RUN]
21:32:08.590378 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Invoices"
21:32:08.590584 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Invoices
21:32:08.590738 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Invoices
21:32:08.593788 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Invoices"
21:32:08.595751 [debug] [Thread-1  ]: finished collecting timing info
21:32:08.596015 [debug] [Thread-1  ]: On model.Shawn.AH_ImportedListingsMap: Close
21:32:08.599621 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a84cb130>]}
21:32:08.600090 [info ] [Thread-1  ]: 35 of 105 OK created table model dbo.AH_ImportedListingsMap..................... [[32mOK[0m in 3.83s]
21:32:08.600635 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ImportedListingsMap
21:32:08.600790 [debug] [Thread-4  ]: finished collecting timing info
21:32:08.601214 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Invoices
21:32:08.600928 [debug] [Thread-1  ]: Began running node model.Shawn.AH_KeyTable
21:32:08.607907 [info ] [Thread-1  ]: 40 of 105 START table model dbo.AH_KeyTable..................................... [RUN]
21:32:08.608421 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_KeyTable"
21:32:08.608585 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_KeyTable
21:32:08.608720 [debug] [Thread-1  ]: Compiling model.Shawn.AH_KeyTable
21:32:08.612389 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_KeyTable"
21:32:08.619490 [debug] [Thread-1  ]: finished collecting timing info
21:32:08.619704 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_KeyTable
21:32:08.677805 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Invoices"
21:32:08.678079 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:08.678848 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices".
21:32:08.679118 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Invoices: 
  
  if object_id ('"dbo"."AH_Invoices__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Invoices__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Invoices__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Invoices__dbt_tmp"
    end


   EXEC('create view dbo.AH_Invoices__dbt_tmp_temp_view as
    
Select
	cast([Paiddttm] as datetime) [PaidDTTM],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Createddttm] as datetime) [CreatedDTTM],
	cast([Fulfilleddttm] as datetime) [FulfilledDTTM],
	cast([PropertybagID] as int) [PropertyBagId],
	cast([ID] as int) [Id],
	cast([ShippingOptionID] as int) [ShippingOptionId],
	cast([PayerID] as int) [PayerId],
	cast([OwnerID] as int) [OwnerId],
	cast([AuctionEventID] as int) [AuctionEventId],
	cast([SalesTax] as decimal(24,2)) [SalesTax],
	cast([BuyersPremiumPercent] as numeric(24,2)) [BuyersPremiumPercent],
	cast([BuyersPremiumAmount] as decimal(24,2)) [BuyersPremiumAmount],
	cast([ShippingAmount] as decimal(24,2)) [ShippingAmount],
	cast([SubTotal] as decimal(24,2)) [Subtotal],
	cast([Total] as decimal(24,2)) [Total],
	cast([IsPayerLocked] as bit) [IsPayerLocked],
	cast([Shipped] as bit) [Shipped],
	cast([IsArchived] as bit) [IsArchived],
	cast([Status] as nvarchar(100)) [Status],
	cast([ShippingLastName] as nvarchar(500)) [ShippingLastName],
	cast([BillingLastName] as nvarchar(500)) [BillingLastName],
	cast([OwnerName] as nvarchar(200)) [OwnerName],
	cast([Shippingdetails] as nvarchar(500)) [ShippingDetails],
	cast([OwnerCity] as nvarchar(200)) [OwnerCity],
	cast([OwnerStateregion] as nvarchar(200)) [OwnerStateRegion],
	cast([OwnerzipPostal] as varchar(128)) [OwnerZipPostal],
	cast([OwnerCountry] as nvarchar(200)) [OwnerCountry],
	cast([ShippingFirstName] as nvarchar(500)) [ShippingFirstName],
	cast([BillingFirstName] as nvarchar(500)) [BillingFirstName],
	cast([BillingCity] as nvarchar(40)) [BillingCity],
	cast([BillingStateregion] as nvarchar(40)) [BillingStateRegion],
	cast([BillingzipPostal] as varchar(128)) [BillingZipPostal],
	cast([BillingCountry] as nvarchar(40)) [BillingCountry],
	cast([OwnerStreet1] as varchar(128)) [OwnerStreet1],
	cast([OwnerStreet2] as varchar(128)) [OwnerStreet2],
	cast([ShippingCity] as nvarchar(100)) [ShippingCity],
	cast([ShippingStateregion] as nvarchar(50)) [ShippingStateRegion],
	cast([ShippingzipPostal] as varchar(128)) [ShippingZipPostal],
	cast([ShippingCountry] as nvarchar(100)) [ShippingCountry],
	cast([BillingStreet1] as varchar(128)) [BillingStreet1],
	cast([BillingStreet2] as varchar(128)) [BillingStreet2],
	cast([Comments] as nvarchar(4000)) [Comments],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([Currency] as nvarchar(10)) [Currency],
	cast([Type] as nvarchar(50)) [Type],
	cast([ShippingStreet1] as varchar(128)) [ShippingStreet1],
	cast([ShippingStreet2] as varchar(128)) [ShippingStreet2] 
From stg.[AH_Invoices_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Invoices__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Invoices__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Invoices__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Invoices__dbt_tmp_temp_view"
    end



21:32:08.686471 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:32:08.686728 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:08.686285 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_KeyTable"
21:32:08.688329 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_KeyTable".
21:32:08.688524 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_KeyTable: 
  
  if object_id ('"dbo"."AH_KeyTable__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_KeyTable__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_KeyTable__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_KeyTable__dbt_tmp"
    end


   EXEC('create view dbo.AH_KeyTable__dbt_tmp_temp_view as
    
Select
	cast([NextID] as int) [NextId] 
From stg.[AH_KeyTable_FinalView]
    ');

  CREATE TABLE "dbo"."AH_KeyTable__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_KeyTable__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_KeyTable__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_KeyTable__dbt_tmp_temp_view"
    end



21:32:08.688644 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:32:08.688782 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:08.792732 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:08.805031 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:09.834699 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.03 seconds
21:32:09.849365 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedregionMap".
21:32:09.849722 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ImportedregionMap: rename object "dbo"."AH_ImportedregionMap" to AH_ImportedregionMap__dbt_backup
21:32:09.896992 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:32:09.910770 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedregionMap".
21:32:09.911135 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ImportedregionMap: rename object "dbo"."AH_ImportedregionMap__dbt_tmp" to AH_ImportedregionMap
21:32:09.942023 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:09.944017 [debug] [Thread-2  ]: On model.Shawn.AH_ImportedregionMap: COMMIT
21:32:09.948544 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedregionMap".
21:32:09.948814 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ImportedregionMap: 
    
  if object_id ('"dbo"."AH_ImportedregionMap__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ImportedregionMap__dbt_backup"
    end

21:32:10.164182 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:32:10.177881 [debug] [Thread-2  ]: finished collecting timing info
21:32:10.178321 [debug] [Thread-2  ]: On model.Shawn.AH_ImportedregionMap: Close
21:32:10.179147 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae85580>]}
21:32:10.179639 [info ] [Thread-2  ]: 37 of 105 OK created table model dbo.AH_ImportedregionMap....................... [[32mOK[0m in 2.42s]
21:32:10.180009 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ImportedregionMap
21:32:10.180191 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Languages
21:32:10.180577 [info ] [Thread-2  ]: 41 of 105 START table model dbo.AH_Languages.................................... [RUN]
21:32:10.181009 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Languages"
21:32:10.181163 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Languages
21:32:10.181300 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Languages
21:32:10.183935 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Languages"
21:32:10.184587 [debug] [Thread-2  ]: finished collecting timing info
21:32:10.184764 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Languages
21:32:10.220252 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Languages"
21:32:10.220967 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Languages".
21:32:10.221160 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Languages: 
  
  if object_id ('"dbo"."AH_Languages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Languages__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Languages__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Languages__dbt_tmp"
    end


   EXEC('create view dbo.AH_Languages__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Code] as nvarchar(4000)) [Code],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_Languages_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Languages__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Languages__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Languages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Languages__dbt_tmp_temp_view"
    end



21:32:10.221297 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:32:10.221451 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:10.331832 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:10.982411 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.41 seconds
21:32:10.998355 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Increments".
21:32:10.998748 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Increments: rename object "dbo"."AH_Increments" to AH_Increments__dbt_backup
21:32:11.040432 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:32:11.054143 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Increments".
21:32:11.054505 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Increments: rename object "dbo"."AH_Increments__dbt_tmp" to AH_Increments
21:32:11.104262 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:32:11.107302 [debug] [Thread-3  ]: On model.Shawn.AH_Increments: COMMIT
21:32:11.111835 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Increments".
21:32:11.112107 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Increments: 
    
  if object_id ('"dbo"."AH_Increments__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Increments__dbt_backup"
    end

21:32:11.213640 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.52 seconds
21:32:11.228069 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_KeyTable".
21:32:11.228431 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_KeyTable: rename object "dbo"."AH_KeyTable" to AH_KeyTable__dbt_backup
21:32:11.267339 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:32:11.282013 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_KeyTable".
21:32:11.282405 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_KeyTable: rename object "dbo"."AH_KeyTable__dbt_tmp" to AH_KeyTable
21:32:11.316587 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:32:11.329204 [debug] [Thread-3  ]: finished collecting timing info
21:32:11.329468 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:32:11.331250 [debug] [Thread-1  ]: On model.Shawn.AH_KeyTable: COMMIT
21:32:11.329769 [debug] [Thread-3  ]: On model.Shawn.AH_Increments: Close
21:32:11.336013 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae85190>]}
21:32:11.336467 [info ] [Thread-3  ]: 38 of 105 OK created table model dbo.AH_Increments.............................. [[32mOK[0m in 2.89s]
21:32:11.336828 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Increments
21:32:11.337011 [debug] [Thread-3  ]: Began running node model.Shawn.AH_LineItems
21:32:11.337389 [info ] [Thread-3  ]: 42 of 105 START table model dbo.AH_LineItems.................................... [RUN]
21:32:11.337802 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_LineItems"
21:32:11.337968 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_LineItems
21:32:11.338110 [debug] [Thread-3  ]: Compiling model.Shawn.AH_LineItems
21:32:11.334968 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_KeyTable".
21:32:11.341052 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_KeyTable: 
    
  if object_id ('"dbo"."AH_KeyTable__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_KeyTable__dbt_backup"
    end

21:32:11.340842 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_LineItems"
21:32:11.341712 [debug] [Thread-3  ]: finished collecting timing info
21:32:11.341872 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_LineItems
21:32:11.378285 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_LineItems"
21:32:11.379025 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems".
21:32:11.379234 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_LineItems: 
  
  if object_id ('"dbo"."AH_LineItems__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_LineItems__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_LineItems__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_LineItems__dbt_tmp"
    end


   EXEC('create view dbo.AH_LineItems__dbt_tmp_temp_view as
    
Select
	cast([Currency] as nvarchar(10)) [Currency],
	cast([Status] as nvarchar(100)) [Status],
	cast([Type] as nvarchar(50)) [Type],
	cast([LotNumber] as nvarchar(4000)) [LotNumber],
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DaTestamp] as datetime) [DateStamp],
	cast([ID] as int) [Id],
	cast([InvoiceID] as int) [InvoiceId],
	cast([ListingID] as int) [ListingId],
	cast([Quantity] as int) [Quantity],
	cast([OwnerID] as int) [OwnerId],
	cast([PayerID] as int) [PayerId],
	cast([ReListiteration] as int) [RelistIteration],
	cast([AuctionEventID] as int) [AuctionEventId],
	cast([TotalAmount] as decimal(24,2)) [TotalAmount],
	cast([PeRunitAmount] as decimal(24,2)) [PerUnitAmount],
	cast([Taxable] as bit) [Taxable],
	cast([IsArchived] as bit) [IsArchived],
	cast([BuyersPremiuMapplies] as bit) [BuyersPremiumApplies],
	cast([IsPayerArchived] as bit) [IsPayerArchived] 
From stg.[AH_LineItems_FinalView]
    ');

  CREATE TABLE "dbo"."AH_LineItems__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_LineItems__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_LineItems__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_LineItems__dbt_tmp_temp_view"
    end



21:32:11.379358 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:32:11.379503 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:11.480486 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:12.442729 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
21:32:12.451939 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.77 seconds
21:32:12.457451 [debug] [Thread-1  ]: finished collecting timing info
21:32:12.467970 [debug] [Thread-1  ]: On model.Shawn.AH_KeyTable: Close
21:32:12.468903 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaeb6ca0>]}
21:32:12.469419 [info ] [Thread-1  ]: 40 of 105 OK created table model dbo.AH_KeyTable................................ [[32mOK[0m in 3.86s]
21:32:12.469797 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_KeyTable
21:32:12.469981 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ListingActionproperties
21:32:12.470382 [info ] [Thread-1  ]: 43 of 105 START table model dbo.AH_ListingActionproperties...................... [RUN]
21:32:12.470894 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ListingActionproperties"
21:32:12.471049 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ListingActionproperties
21:32:12.474023 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ListingActionproperties
21:32:12.477022 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ListingActionproperties"
21:32:12.473876 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices".
21:32:12.477408 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Invoices: rename object "dbo"."AH_Invoices" to AH_Invoices__dbt_backup
21:32:12.477803 [debug] [Thread-1  ]: finished collecting timing info
21:32:12.477980 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ListingActionproperties
21:32:12.512163 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:12.525734 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ListingActionproperties"
21:32:12.526434 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActionproperties".
21:32:12.526667 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingActionproperties: 
  
  if object_id ('"dbo"."AH_ListingActionproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingActionproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingActionproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingActionproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingActionproperties__dbt_tmp_temp_view as
    
Select
	cast([BoolnativeValue] as bit) [BoolNativeValue],
	cast([DecimalnativeValue] as numeric(19,4)) [DecimalNativeValue],
	cast([CustomFieldID] as int) [CustomFieldId],
	cast([ID] as int) [Id],
	cast([IntnativeValue] as int) [IntNativeValue],
	cast([ListingActionID] as int) [ListingActionId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DateTimenativeValue] as datetime) [DateTimeNativeValue],
	cast([StringnativeValue] as nvarchar(4000)) [StringNativeValue],
	cast([EnumnativeValue] as nvarchar(4000)) [EnumNativeValue],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_ListingActionproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingActionproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingActionproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingActionproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingActionproperties__dbt_tmp_temp_view"
    end



21:32:12.526793 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:32:12.529635 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:12.529473 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices".
21:32:12.531148 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Invoices: rename object "dbo"."AH_Invoices__dbt_tmp" to AH_Invoices
21:32:12.566239 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:12.568182 [debug] [Thread-4  ]: On model.Shawn.AH_Invoices: COMMIT
21:32:12.573687 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices".
21:32:12.574025 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Invoices: 
    
  if object_id ('"dbo"."AH_Invoices__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Invoices__dbt_backup"
    end

21:32:12.628046 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:12.649912 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.43 seconds
21:32:12.664412 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Languages".
21:32:12.664785 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Languages: rename object "dbo"."AH_Languages" to AH_Languages__dbt_backup
21:32:12.693687 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:12.708086 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Languages".
21:32:12.708485 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Languages: rename object "dbo"."AH_Languages__dbt_tmp" to AH_Languages
21:32:12.742943 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:12.744926 [debug] [Thread-2  ]: On model.Shawn.AH_Languages: COMMIT
21:32:12.748993 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Languages".
21:32:12.749212 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Languages: 
    
  if object_id ('"dbo"."AH_Languages__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Languages__dbt_backup"
    end

21:32:12.842562 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:32:12.855157 [debug] [Thread-4  ]: finished collecting timing info
21:32:12.855598 [debug] [Thread-4  ]: On model.Shawn.AH_Invoices: Close
21:32:12.856403 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae852e0>]}
21:32:12.856928 [info ] [Thread-4  ]: 39 of 105 OK created table model dbo.AH_Invoices................................ [[32mOK[0m in 4.27s]
21:32:12.857329 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Invoices
21:32:12.857521 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingActions
21:32:12.857929 [info ] [Thread-4  ]: 44 of 105 START table model dbo.AH_ListingActions............................... [RUN]
21:32:12.858371 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingActions"
21:32:12.858535 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingActions
21:32:12.858713 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingActions
21:32:12.861484 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingActions"
21:32:12.862017 [debug] [Thread-4  ]: finished collecting timing info
21:32:12.862193 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingActions
21:32:12.898619 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingActions"
21:32:12.899313 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions".
21:32:12.899511 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingActions: 
  
  if object_id ('"dbo"."AH_ListingActions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingActions__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingActions__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingActions__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingActions__dbt_tmp_temp_view as
    
Select
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([Reason] as nvarchar(4000)) [Reason],
	cast([Status] as nvarchar(100)) [Status],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Actiondttm] as datetime) [ActionDTTM],
	cast([Amount] as decimal(24,2)) [Amount],
	cast([ProxyAmount] as decimal(24,2)) [ProxyAmount],
	cast([Userentered] as bit) [UserEntered],
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId],
	cast([ListingID] as int) [ListingId],
	cast([Quantity] as int) [Quantity] 
From stg.[AH_ListingActions_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingActions__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingActions__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingActions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingActions__dbt_tmp_temp_view"
    end



21:32:12.899634 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:32:12.899776 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:12.977980 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:32:12.990620 [debug] [Thread-2  ]: finished collecting timing info
21:32:12.991020 [debug] [Thread-2  ]: On model.Shawn.AH_Languages: Close
21:32:12.991774 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaf8ca60>]}
21:32:12.992266 [info ] [Thread-2  ]: 41 of 105 OK created table model dbo.AH_Languages............................... [[32mOK[0m in 2.81s]
21:32:12.992669 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Languages
21:32:12.992854 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ListingComments
21:32:12.993242 [info ] [Thread-2  ]: 45 of 105 START table model dbo.AH_ListingComments.............................. [RUN]
21:32:12.993660 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ListingComments"
21:32:12.993812 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ListingComments
21:32:12.993947 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ListingComments
21:32:12.996580 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ListingComments"
21:32:12.996904 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:12.997515 [debug] [Thread-2  ]: finished collecting timing info
21:32:12.997680 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ListingComments
21:32:13.033424 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ListingComments"
21:32:13.034131 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingComments".
21:32:13.034328 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingComments: 
  
  if object_id ('"dbo"."AH_ListingComments__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingComments__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingComments__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingComments__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingComments__dbt_tmp_temp_view as
    
Select
	cast([IsBID] as bit) [IsBid],
	cast([Approved] as bit) [Approved],
	cast([ParentID] as int) [parentId],
	cast([ReportCount] as int) [ReportCount],
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId],
	cast([ListingID] as int) [ListingId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([UserName] as nvarchar(500)) [UserName],
	cast([Comment] as nvarchar(4000)) [Comment] 
From stg.[AH_ListingComments_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingComments__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingComments__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingComments__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingComments__dbt_tmp_temp_view"
    end



21:32:13.034453 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:32:13.034639 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:13.154326 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:14.499628 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.12 seconds
21:32:14.514375 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems".
21:32:14.514768 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_LineItems: rename object "dbo"."AH_LineItems" to AH_LineItems__dbt_backup
21:32:14.586042 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:32:14.600436 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems".
21:32:14.600792 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_LineItems: rename object "dbo"."AH_LineItems__dbt_tmp" to AH_LineItems
21:32:14.632546 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:14.634491 [debug] [Thread-3  ]: On model.Shawn.AH_LineItems: COMMIT
21:32:14.638617 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems".
21:32:14.638859 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_LineItems: 
    
  if object_id ('"dbo"."AH_LineItems__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_LineItems__dbt_backup"
    end

21:32:14.844613 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:32:14.857020 [debug] [Thread-3  ]: finished collecting timing info
21:32:14.857407 [debug] [Thread-3  ]: On model.Shawn.AH_LineItems: Close
21:32:14.858162 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae85820>]}
21:32:14.858684 [info ] [Thread-3  ]: 42 of 105 OK created table model dbo.AH_LineItems............................... [[32mOK[0m in 3.52s]
21:32:14.859056 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_LineItems
21:32:14.859234 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingCommentsMedias
21:32:14.859586 [info ] [Thread-3  ]: 46 of 105 START table model dbo.AH_ListingCommentsMedias........................ [RUN]
21:32:14.860001 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingCommentsMedias"
21:32:14.860152 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingCommentsMedias
21:32:14.860282 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingCommentsMedias
21:32:14.862848 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingCommentsMedias"
21:32:14.863322 [debug] [Thread-3  ]: finished collecting timing info
21:32:14.863477 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingCommentsMedias
21:32:14.898127 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingCommentsMedias"
21:32:14.898795 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingCommentsMedias".
21:32:14.898997 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingCommentsMedias: 
  
  if object_id ('"dbo"."AH_ListingCommentsMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingCommentsMedias__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingCommentsMedias__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingCommentsMedias__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingCommentsMedias__dbt_tmp_temp_view as
    
Select
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([ID] as int) [Id],
	cast([MediaID] as int) [MediaId],
	cast([CommentID] as int) [CommentId],
	cast([DisplayOrder] as int) [DisplayOrder] 
From stg.[AH_ListingCommentsMedias_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingCommentsMedias__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingCommentsMedias__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingCommentsMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingCommentsMedias__dbt_tmp_temp_view"
    end



21:32:14.899115 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:32:14.899258 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:15.017242 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:17.680195 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.78 seconds
21:32:17.768541 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingCommentsMedias".
21:32:17.768898 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingCommentsMedias: rename object "dbo"."AH_ListingCommentsMedias" to AH_ListingCommentsMedias__dbt_backup
21:32:17.801562 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:17.816049 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingCommentsMedias".
21:32:17.816415 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingCommentsMedias: rename object "dbo"."AH_ListingCommentsMedias__dbt_tmp" to AH_ListingCommentsMedias
21:32:17.845722 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:17.847536 [debug] [Thread-3  ]: On model.Shawn.AH_ListingCommentsMedias: COMMIT
21:32:17.852055 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingCommentsMedias".
21:32:17.852309 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingCommentsMedias: 
    
  if object_id ('"dbo"."AH_ListingCommentsMedias__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingCommentsMedias__dbt_backup"
    end

21:32:18.025038 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:32:18.038853 [debug] [Thread-3  ]: finished collecting timing info
21:32:18.039270 [debug] [Thread-3  ]: On model.Shawn.AH_ListingCommentsMedias: Close
21:32:18.040021 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b0bd96a0>]}
21:32:18.040540 [info ] [Thread-3  ]: 46 of 105 OK created table model dbo.AH_ListingCommentsMedias................... [[32mOK[0m in 3.18s]
21:32:18.040916 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingCommentsMedias
21:32:18.041095 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingEnddttmAudit
21:32:18.041476 [info ] [Thread-3  ]: 47 of 105 START table model dbo.AH_ListingEnddttmAudit.......................... [RUN]
21:32:18.041901 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingEnddttmAudit"
21:32:18.042051 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingEnddttmAudit
21:32:18.042182 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingEnddttmAudit
21:32:18.044828 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingEnddttmAudit"
21:32:18.045237 [debug] [Thread-3  ]: finished collecting timing info
21:32:18.045460 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingEnddttmAudit
21:32:18.081769 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingEnddttmAudit"
21:32:18.082477 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingEnddttmAudit".
21:32:18.082717 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingEnddttmAudit: 
  
  if object_id ('"dbo"."AH_ListingEnddttmAudit__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingEnddttmAudit__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingEnddttmAudit__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingEnddttmAudit__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingEnddttmAudit__dbt_tmp_temp_view as
    
Select
	cast([SqlDaTestamp] as datetime) [SQLDateStamp],
	cast([Enddttm] as datetime) [EndDTTM],
	cast([SourceListingID] as int) [SourceListingID],
	cast([ID] as int) [Id],
	cast([ListingID] as int) [ListingID],
	cast([Origin] as nvarchar(4000)) [Origin] 
From stg.[AH_ListingEnddttmAudit_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingEnddttmAudit__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingEnddttmAudit__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingEnddttmAudit__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingEnddttmAudit__dbt_tmp_temp_view"
    end



21:32:18.082856 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:32:18.083005 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:18.182276 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:20.209920 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 7.68 seconds
21:32:20.224479 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActionproperties".
21:32:20.224818 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingActionproperties: rename object "dbo"."AH_ListingActionproperties" to AH_ListingActionproperties__dbt_backup
21:32:20.242869 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.21 seconds
21:32:20.258265 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingComments".
21:32:20.258496 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:20.258738 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingComments: rename object "dbo"."AH_ListingComments" to AH_ListingComments__dbt_backup
21:32:20.270814 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActionproperties".
21:32:20.271094 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingActionproperties: rename object "dbo"."AH_ListingActionproperties__dbt_tmp" to AH_ListingActionproperties
21:32:20.298929 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.22 seconds
21:32:20.313342 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingEnddttmAudit".
21:32:20.313689 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingEnddttmAudit: rename object "dbo"."AH_ListingEnddttmAudit" to AH_ListingEnddttmAudit__dbt_backup
21:32:20.320113 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:32:20.321930 [debug] [Thread-1  ]: On model.Shawn.AH_ListingActionproperties: COMMIT
21:32:20.320421 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:32:20.325587 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActionproperties".
21:32:20.335777 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingActionproperties: 
    
  if object_id ('"dbo"."AH_ListingActionproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingActionproperties__dbt_backup"
    end

21:32:20.337889 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingComments".
21:32:20.338083 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingComments: rename object "dbo"."AH_ListingComments__dbt_tmp" to AH_ListingComments
21:32:20.347467 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:20.359767 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingEnddttmAudit".
21:32:20.360082 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingEnddttmAudit: rename object "dbo"."AH_ListingEnddttmAudit__dbt_tmp" to AH_ListingEnddttmAudit
21:32:20.377813 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:32:20.379672 [debug] [Thread-2  ]: On model.Shawn.AH_ListingComments: COMMIT
21:32:20.383409 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingComments".
21:32:20.383606 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingComments: 
    
  if object_id ('"dbo"."AH_ListingComments__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingComments__dbt_backup"
    end

21:32:20.408866 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:32:20.411035 [debug] [Thread-3  ]: On model.Shawn.AH_ListingEnddttmAudit: COMMIT
21:32:20.415316 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingEnddttmAudit".
21:32:20.415550 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingEnddttmAudit: 
    
  if object_id ('"dbo"."AH_ListingEnddttmAudit__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingEnddttmAudit__dbt_backup"
    end

21:32:20.600256 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:32:20.614055 [debug] [Thread-1  ]: finished collecting timing info
21:32:20.614457 [debug] [Thread-1  ]: On model.Shawn.AH_ListingActionproperties: Close
21:32:20.615195 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a84fd310>]}
21:32:20.615690 [info ] [Thread-1  ]: 43 of 105 OK created table model dbo.AH_ListingActionproperties................. [[32mOK[0m in 8.14s]
21:32:20.616043 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ListingActionproperties
21:32:20.616222 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ListingLocations
21:32:20.616591 [info ] [Thread-1  ]: 48 of 105 START table model dbo.AH_ListingLocations............................. [RUN]
21:32:20.616990 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ListingLocations"
21:32:20.617143 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ListingLocations
21:32:20.617277 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ListingLocations
21:32:20.619847 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ListingLocations"
21:32:20.620263 [debug] [Thread-1  ]: finished collecting timing info
21:32:20.620414 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ListingLocations
21:32:20.655731 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ListingLocations"
21:32:20.656409 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingLocations".
21:32:20.656605 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingLocations: 
  
  if object_id ('"dbo"."AH_ListingLocations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingLocations__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingLocations__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingLocations__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingLocations__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([LocationID] as int) [LocationId],
	cast([ListingID] as int) [ListingId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_ListingLocations_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingLocations__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingLocations__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingLocations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingLocations__dbt_tmp_temp_view"
    end



21:32:20.656726 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:32:20.656868 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:20.658191 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:32:20.670098 [debug] [Thread-2  ]: finished collecting timing info
21:32:20.670398 [debug] [Thread-2  ]: On model.Shawn.AH_ListingComments: Close
21:32:20.671076 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae85c10>]}
21:32:20.671524 [info ] [Thread-2  ]: 45 of 105 OK created table model dbo.AH_ListingComments......................... [[32mOK[0m in 7.68s]
21:32:20.671874 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ListingComments
21:32:20.672051 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ListingMedias
21:32:20.672417 [info ] [Thread-2  ]: 49 of 105 START table model dbo.AH_ListingMedias................................ [RUN]
21:32:20.672817 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ListingMedias"
21:32:20.672968 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ListingMedias
21:32:20.673100 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ListingMedias
21:32:20.676025 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ListingMedias"
21:32:20.676476 [debug] [Thread-2  ]: finished collecting timing info
21:32:20.676635 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ListingMedias
21:32:20.695403 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:32:20.717612 [debug] [Thread-3  ]: finished collecting timing info
21:32:20.732288 [debug] [Thread-3  ]: On model.Shawn.AH_ListingEnddttmAudit: Close
21:32:20.733085 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaea72e0>]}
21:32:20.733571 [info ] [Thread-3  ]: 47 of 105 OK created table model dbo.AH_ListingEnddttmAudit..................... [[32mOK[0m in 2.69s]
21:32:20.734089 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingEnddttmAudit
21:32:20.734315 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingPaymentCharge
21:32:20.734741 [info ] [Thread-3  ]: 50 of 105 START table model dbo.AH_ListingPaymentCharge......................... [RUN]
21:32:20.735164 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingPaymentCharge"
21:32:20.735317 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingPaymentCharge
21:32:20.735456 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingPaymentCharge
21:32:20.738070 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingPaymentCharge"
21:32:20.739636 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ListingMedias"
21:32:20.740162 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingMedias".
21:32:20.740321 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingMedias: 
  
  if object_id ('"dbo"."AH_ListingMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingMedias__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingMedias__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingMedias__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingMedias__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([MediaID] as int) [MediaId],
	cast([ListingID] as int) [ListingId],
	cast([DisplayOrder] as int) [DisplayOrder] 
From stg.[AH_ListingMedias_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingMedias__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingMedias__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingMedias__dbt_tmp_temp_view"
    end



21:32:20.740449 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:32:20.740590 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:20.741695 [debug] [Thread-3  ]: finished collecting timing info
21:32:20.742161 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingPaymentCharge
21:32:20.769851 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:20.784319 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingPaymentCharge"
21:32:20.784968 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge".
21:32:20.785170 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge: 
  
  if object_id ('"dbo"."AH_ListingPaymentCharge__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingPaymentCharge__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingPaymentCharge__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingPaymentCharge__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingPaymentCharge__dbt_tmp_temp_view as
    
Select
	cast([BuyerID] as int) [BuyerId],
	cast([ListingID] as int) [ListingId],
	cast([ID] as int) [Id],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([TransactionID] as nvarchar(30)) [TransactionId],
	cast([ChargeAmount] as decimal(24,2)) [ChargeAmount],
	cast([TotalBID] as decimal(24,2)) [TotalBid],
	cast([BidHoldPercentage] as decimal(24,3)) [BidHoldPercentage],
	cast([MaximumBidCharge] as decimal(24,2)) [MaximumBidCharge] 
From stg.[AH_ListingPaymentCharge_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingPaymentCharge__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingPaymentCharge__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingPaymentCharge__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingPaymentCharge__dbt_tmp_temp_view"
    end



21:32:20.785293 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:32:20.785561 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:20.838151 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:20.893300 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:21.002937 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 8.10 seconds
21:32:21.017557 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions".
21:32:21.017907 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingActions: rename object "dbo"."AH_ListingActions" to AH_ListingActions__dbt_backup
21:32:21.070261 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:32:21.084098 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions".
21:32:21.084430 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingActions: rename object "dbo"."AH_ListingActions__dbt_tmp" to AH_ListingActions
21:32:21.116331 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:21.118256 [debug] [Thread-4  ]: On model.Shawn.AH_ListingActions: COMMIT
21:32:21.122614 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions".
21:32:21.122833 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingActions: 
    
  if object_id ('"dbo"."AH_ListingActions__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingActions__dbt_backup"
    end

21:32:21.584860 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.46 seconds
21:32:21.598092 [debug] [Thread-4  ]: finished collecting timing info
21:32:21.598520 [debug] [Thread-4  ]: On model.Shawn.AH_ListingActions: Close
21:32:21.599328 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58ab1f8af0>]}
21:32:21.599842 [info ] [Thread-4  ]: 44 of 105 OK created table model dbo.AH_ListingActions.......................... [[32mOK[0m in 8.74s]
21:32:21.600204 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingActions
21:32:21.600385 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingQuestions
21:32:21.600773 [info ] [Thread-4  ]: 51 of 105 START table model dbo.AH_ListingQuestions............................. [RUN]
21:32:21.601215 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingQuestions"
21:32:21.601371 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingQuestions
21:32:21.601696 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingQuestions
21:32:21.604537 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingQuestions"
21:32:21.604973 [debug] [Thread-4  ]: finished collecting timing info
21:32:21.605134 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingQuestions
21:32:21.641098 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingQuestions"
21:32:21.641776 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingQuestions".
21:32:21.641969 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingQuestions: 
  
  if object_id ('"dbo"."AH_ListingQuestions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingQuestions__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingQuestions__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingQuestions__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingQuestions__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId],
	cast([ListingID] as int) [ListingId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([UserName] as nvarchar(4000)) [UserName],
	cast([Question] as nvarchar(4000)) [Question],
	cast([Answer] as nvarchar(4000)) [Answer] 
From stg.[AH_ListingQuestions_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingQuestions__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingQuestions__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingQuestions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingQuestions__dbt_tmp_temp_view"
    end



21:32:21.642090 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:32:21.642234 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:21.764916 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:23.202048 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.55 seconds
21:32:23.288608 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingLocations".
21:32:23.288974 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingLocations: rename object "dbo"."AH_ListingLocations" to AH_ListingLocations__dbt_backup
21:32:23.325443 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:32:23.339814 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingLocations".
21:32:23.340151 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingLocations: rename object "dbo"."AH_ListingLocations__dbt_tmp" to AH_ListingLocations
21:32:23.369402 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:23.371383 [debug] [Thread-1  ]: On model.Shawn.AH_ListingLocations: COMMIT
21:32:23.375766 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingLocations".
21:32:23.376026 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingLocations: 
    
  if object_id ('"dbo"."AH_ListingLocations__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingLocations__dbt_backup"
    end

21:32:23.884438 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.10 seconds
21:32:23.899282 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge".
21:32:23.899627 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge: rename object "dbo"."AH_ListingPaymentCharge" to AH_ListingPaymentCharge__dbt_backup
21:32:23.960780 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:32:23.974507 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge".
21:32:23.974890 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge: rename object "dbo"."AH_ListingPaymentCharge__dbt_tmp" to AH_ListingPaymentCharge
21:32:24.008234 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:24.008611 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.63 seconds
21:32:24.020360 [debug] [Thread-3  ]: On model.Shawn.AH_ListingPaymentCharge: COMMIT
21:32:24.023641 [debug] [Thread-1  ]: finished collecting timing info
21:32:24.027460 [debug] [Thread-1  ]: On model.Shawn.AH_ListingLocations: Close
21:32:24.028161 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae6bb80>]}
21:32:24.028608 [info ] [Thread-1  ]: 48 of 105 OK created table model dbo.AH_ListingLocations........................ [[32mOK[0m in 3.41s]
21:32:24.028991 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ListingLocations
21:32:24.027140 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge".
21:32:24.029465 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge: 
    
  if object_id ('"dbo"."AH_ListingPaymentCharge__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingPaymentCharge__dbt_backup"
    end

21:32:24.029182 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ListingTypeFeeprovIDErs
21:32:24.029893 [info ] [Thread-1  ]: 52 of 105 START table model dbo.AH_ListingTypeFeeprovIDErs...................... [RUN]
21:32:24.030313 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ListingTypeFeeprovIDErs"
21:32:24.030461 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ListingTypeFeeprovIDErs
21:32:24.030630 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ListingTypeFeeprovIDErs
21:32:24.033587 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ListingTypeFeeprovIDErs"
21:32:24.033987 [debug] [Thread-1  ]: finished collecting timing info
21:32:24.034135 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ListingTypeFeeprovIDErs
21:32:24.070820 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ListingTypeFeeprovIDErs"
21:32:24.071502 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeFeeprovIDErs".
21:32:24.071693 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeFeeprovIDErs: 
  
  if object_id ('"dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view as
    
Select
	cast([ProvIDErName] as nvarchar(4000)) [ProviderName],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([ListingTypeID] as int) [ListingTypeId],
	cast([Enabled] as bit) [Enabled] 
From stg.[AH_ListingTypeFeeprovIDErs_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view"
    end



21:32:24.071822 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:32:24.071967 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:24.168208 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.53 seconds
21:32:24.182208 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingQuestions".
21:32:24.182590 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingQuestions: rename object "dbo"."AH_ListingQuestions" to AH_ListingQuestions__dbt_backup
21:32:24.197129 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:24.256957 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:32:24.269793 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingQuestions".
21:32:24.270117 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingQuestions: rename object "dbo"."AH_ListingQuestions__dbt_tmp" to AH_ListingQuestions
21:32:24.288500 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:32:24.300439 [debug] [Thread-3  ]: finished collecting timing info
21:32:24.300843 [debug] [Thread-3  ]: On model.Shawn.AH_ListingPaymentCharge: Close
21:32:24.301593 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaea7430>]}
21:32:24.302081 [info ] [Thread-3  ]: 50 of 105 OK created table model dbo.AH_ListingPaymentCharge.................... [[32mOK[0m in 3.57s]
21:32:24.302443 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingPaymentCharge
21:32:24.302660 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingTypeMedia
21:32:24.303035 [info ] [Thread-3  ]: 53 of 105 START table model dbo.AH_ListingTypeMedia............................. [RUN]
21:32:24.303440 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingTypeMedia"
21:32:24.303588 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingTypeMedia
21:32:24.303720 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingTypeMedia
21:32:24.306251 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingTypeMedia"
21:32:24.306733 [debug] [Thread-3  ]: finished collecting timing info
21:32:24.306890 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingTypeMedia
21:32:24.312647 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:32:24.314004 [debug] [Thread-4  ]: On model.Shawn.AH_ListingQuestions: COMMIT
21:32:24.317707 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingQuestions".
21:32:24.327663 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingQuestions: 
    
  if object_id ('"dbo"."AH_ListingQuestions__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingQuestions__dbt_backup"
    end

21:32:24.348076 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingTypeMedia"
21:32:24.348708 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeMedia".
21:32:24.348888 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeMedia: 
  
  if object_id ('"dbo"."AH_ListingTypeMedia__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypeMedia__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingTypeMedia__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypeMedia__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingTypeMedia__dbt_tmp_temp_view as
    
Select
	cast([Enabled] as bit) [Enabled],
	cast([ID] as int) [Id],
	cast([ListingTypeID] as int) [ListingTypeId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([MediaassetName] as nvarchar(4000)) [MediaAssetName],
	cast([Scope] as nvarchar(4000)) [Scope] 
From stg.[AH_ListingTypeMedia_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingTypeMedia__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingTypeMedia__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingTypeMedia__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypeMedia__dbt_tmp_temp_view"
    end



21:32:24.349020 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:32:24.349163 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:24.531636 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:24.738017 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 4.00 seconds
21:32:24.751890 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingMedias".
21:32:24.752235 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingMedias: rename object "dbo"."AH_ListingMedias" to AH_ListingMedias__dbt_backup
21:32:24.798120 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:32:24.811567 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingMedias".
21:32:24.811889 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingMedias: rename object "dbo"."AH_ListingMedias__dbt_tmp" to AH_ListingMedias
21:32:24.839504 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:24.841617 [debug] [Thread-2  ]: On model.Shawn.AH_ListingMedias: COMMIT
21:32:24.845810 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingMedias".
21:32:24.846062 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingMedias: 
    
  if object_id ('"dbo"."AH_ListingMedias__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingMedias__dbt_backup"
    end

21:32:25.083563 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:32:25.095789 [debug] [Thread-2  ]: finished collecting timing info
21:32:25.096173 [debug] [Thread-2  ]: On model.Shawn.AH_ListingMedias: Close
21:32:25.096935 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaea7190>]}
21:32:25.097279 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.77 seconds
21:32:25.108018 [info ] [Thread-2  ]: 49 of 105 OK created table model dbo.AH_ListingMedias........................... [[32mOK[0m in 4.42s]
21:32:25.108481 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ListingMedias
21:32:25.108666 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ListingTypeproperties
21:32:25.109034 [info ] [Thread-2  ]: 54 of 105 START table model dbo.AH_ListingTypeproperties........................ [RUN]
21:32:25.109497 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ListingTypeproperties"
21:32:25.109655 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ListingTypeproperties
21:32:25.109794 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ListingTypeproperties
21:32:25.112482 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ListingTypeproperties"
21:32:25.112735 [debug] [Thread-4  ]: finished collecting timing info
21:32:25.112962 [debug] [Thread-4  ]: On model.Shawn.AH_ListingQuestions: Close
21:32:25.113558 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaf893a0>]}
21:32:25.113948 [info ] [Thread-4  ]: 51 of 105 OK created table model dbo.AH_ListingQuestions........................ [[32mOK[0m in 3.51s]
21:32:25.114266 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingQuestions
21:32:25.114435 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingTypes
21:32:25.114883 [info ] [Thread-4  ]: 55 of 105 START table model dbo.AH_ListingTypes................................. [RUN]
21:32:25.115473 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingTypes"
21:32:25.115628 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingTypes
21:32:25.115768 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingTypes
21:32:25.118364 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingTypes"
21:32:25.115141 [debug] [Thread-2  ]: finished collecting timing info
21:32:25.118686 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ListingTypeproperties
21:32:25.127909 [debug] [Thread-4  ]: finished collecting timing info
21:32:25.128106 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingTypes
21:32:25.187577 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingTypes"
21:32:25.192267 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypes".
21:32:25.192442 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingTypes: 
  
  if object_id ('"dbo"."AH_ListingTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypes__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingTypes__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypes__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingTypes__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_ListingTypes_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingTypes__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingTypes__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypes__dbt_tmp_temp_view"
    end



21:32:25.192562 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:32:25.192697 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:25.191774 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ListingTypeproperties"
21:32:25.194123 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeproperties".
21:32:25.194278 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeproperties: 
  
  if object_id ('"dbo"."AH_ListingTypeproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypeproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingTypeproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypeproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingTypeproperties__dbt_tmp_temp_view as
    
Select
	cast([StringnativeValue] as nvarchar(4000)) [StringNativeValue],
	cast([EnumnativeValue] as nvarchar(4000)) [EnumNativeValue],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Scope] as nvarchar(4000)) [Scope],
	cast([DecimalnativeValue] as numeric(19,4)) [DecimalNativeValue],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DateTimenativeValue] as datetime) [DateTimeNativeValue],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([ID] as int) [Id],
	cast([IntnativeValue] as int) [IntNativeValue],
	cast([CustomFieldID] as int) [CustomFieldId],
	cast([ListingTypeID] as int) [ListingTypeId],
	cast([BoolnativeValue] as bit) [BoolNativeValue] 
From stg.[AH_ListingTypeproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingTypeproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingTypeproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingTypeproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypeproperties__dbt_tmp_temp_view"
    end



21:32:25.194428 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:32:25.194596 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:25.297530 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:25.298262 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:27.117007 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.77 seconds
21:32:27.124420 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.05 seconds
21:32:27.137277 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeFeeprovIDErs".
21:32:27.144220 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeFeeprovIDErs: rename object "dbo"."AH_ListingTypeFeeprovIDErs" to AH_ListingTypeFeeprovIDErs__dbt_backup
21:32:27.143946 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeMedia".
21:32:27.144523 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeMedia: rename object "dbo"."AH_ListingTypeMedia" to AH_ListingTypeMedia__dbt_backup
21:32:27.176663 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:27.178201 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:27.191106 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeFeeprovIDErs".
21:32:27.199820 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeFeeprovIDErs: rename object "dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp" to AH_ListingTypeFeeprovIDErs
21:32:27.201962 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeMedia".
21:32:27.202172 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeMedia: rename object "dbo"."AH_ListingTypeMedia__dbt_tmp" to AH_ListingTypeMedia
21:32:27.233342 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:27.235560 [debug] [Thread-1  ]: On model.Shawn.AH_ListingTypeFeeprovIDErs: COMMIT
21:32:27.239860 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeFeeprovIDErs".
21:32:27.240129 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:32:27.241445 [debug] [Thread-3  ]: On model.Shawn.AH_ListingTypeMedia: COMMIT
21:32:27.245003 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeMedia".
21:32:27.240251 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeFeeprovIDErs: 
    
  if object_id ('"dbo"."AH_ListingTypeFeeprovIDErs__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypeFeeprovIDErs__dbt_backup"
    end

21:32:27.245190 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeMedia: 
    
  if object_id ('"dbo"."AH_ListingTypeMedia__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypeMedia__dbt_backup"
    end

21:32:27.317904 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.12 seconds
21:32:27.332834 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeproperties".
21:32:27.333186 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeproperties: rename object "dbo"."AH_ListingTypeproperties" to AH_ListingTypeproperties__dbt_backup
21:32:27.365397 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:27.374695 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.18 seconds
21:32:27.380415 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeproperties".
21:32:27.457275 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeproperties: rename object "dbo"."AH_ListingTypeproperties__dbt_tmp" to AH_ListingTypeproperties
21:32:27.465410 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypes".
21:32:27.465713 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingTypes: rename object "dbo"."AH_ListingTypes" to AH_ListingTypes__dbt_backup
21:32:27.488610 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:27.490294 [debug] [Thread-2  ]: On model.Shawn.AH_ListingTypeproperties: COMMIT
21:32:27.494489 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeproperties".
21:32:27.494724 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeproperties: 
    
  if object_id ('"dbo"."AH_ListingTypeproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypeproperties__dbt_backup"
    end

21:32:27.506564 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:32:27.519537 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypes".
21:32:27.519808 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingTypes: rename object "dbo"."AH_ListingTypes__dbt_tmp" to AH_ListingTypes
21:32:27.547890 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:27.549872 [debug] [Thread-4  ]: On model.Shawn.AH_ListingTypes: COMMIT
21:32:27.554403 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypes".
21:32:27.554683 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingTypes: 
    
  if object_id ('"dbo"."AH_ListingTypes__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypes__dbt_backup"
    end

21:32:27.625769 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.38 seconds
21:32:27.626265 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.38 seconds
21:32:27.640060 [debug] [Thread-3  ]: finished collecting timing info
21:32:27.649765 [debug] [Thread-3  ]: On model.Shawn.AH_ListingTypeMedia: Close
21:32:27.650507 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaea7820>]}
21:32:27.651025 [info ] [Thread-3  ]: 53 of 105 OK created table model dbo.AH_ListingTypeMedia........................ [[32mOK[0m in 3.35s]
21:32:27.651385 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingTypeMedia
21:32:27.651562 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Listingdecorations
21:32:27.651923 [info ] [Thread-3  ]: 56 of 105 START table model dbo.AH_Listingdecorations........................... [RUN]
21:32:27.652344 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Listingdecorations"
21:32:27.652492 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Listingdecorations
21:32:27.652618 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Listingdecorations
21:32:27.649403 [debug] [Thread-1  ]: finished collecting timing info
21:32:27.655472 [debug] [Thread-1  ]: On model.Shawn.AH_ListingTypeFeeprovIDErs: Close
21:32:27.656075 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaea75b0>]}
21:32:27.656434 [info ] [Thread-1  ]: 52 of 105 OK created table model dbo.AH_ListingTypeFeeprovIDErs................. [[32mOK[0m in 3.63s]
21:32:27.656742 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ListingTypeFeeprovIDErs
21:32:27.656909 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Listingproperties
21:32:27.657208 [info ] [Thread-1  ]: 57 of 105 START table model dbo.AH_Listingproperties............................ [RUN]
21:32:27.657579 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Listingproperties"
21:32:27.657722 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Listingproperties
21:32:27.657844 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Listingproperties
21:32:27.655214 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Listingdecorations"
21:32:27.661020 [debug] [Thread-3  ]: finished collecting timing info
21:32:27.661210 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Listingdecorations
21:32:27.660594 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Listingproperties"
21:32:27.671996 [debug] [Thread-1  ]: finished collecting timing info
21:32:27.672178 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Listingproperties
21:32:27.728148 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:32:27.731896 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Listingproperties"
21:32:27.741467 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingproperties".
21:32:27.741640 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listingproperties: 
  
  if object_id ('"dbo"."AH_Listingproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listingproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Listingproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Listingproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_Listingproperties__dbt_tmp_temp_view as
    
Select
	cast([DecimalnativeValue] as decimal(29,14)) [DecimalnativeValue],
	cast([StringnativeValue] as nvarchar(4000)) [StringnativeValue],
	cast([EnumnativeValue] as nvarchar(200)) [EnumnativeValue],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([CreatedOn] as datetime) [Createdon],
	cast([UpdatedOn] as datetime) [Updatedon],
	cast([DeletedOn] as datetime) [Deletedon],
	cast([DateTimenativeValue] as datetime) [DateTimenativeValue],
	cast([BoolnativeValue] as bit) [BoolnativeValue],
	cast([ID] as int) [ID],
	cast([IntnativeValue] as int) [IntnativeValue],
	cast([ListingID] as int) [ListingID],
	cast([CustomFieldID] as int) [CustomFieldID] 
From stg.[AH_Listingproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Listingproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Listingproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Listingproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listingproperties__dbt_tmp_temp_view"
    end



21:32:27.741761 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:32:27.741904 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:27.740985 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Listingdecorations"
21:32:27.743391 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingdecorations".
21:32:27.743560 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Listingdecorations: 
  
  if object_id ('"dbo"."AH_Listingdecorations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listingdecorations__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Listingdecorations__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Listingdecorations__dbt_tmp"
    end


   EXEC('create view dbo.AH_Listingdecorations__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([DecorationID] as int) [DecorationId],
	cast([ListingID] as int) [ListingId] 
From stg.[AH_Listingdecorations_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Listingdecorations__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Listingdecorations__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Listingdecorations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listingdecorations__dbt_tmp_temp_view"
    end



21:32:27.743677 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:32:27.743803 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:27.749362 [debug] [Thread-2  ]: finished collecting timing info
21:32:27.749578 [debug] [Thread-2  ]: On model.Shawn.AH_ListingTypeproperties: Close
21:32:27.750200 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a8543cd0>]}
21:32:27.750634 [info ] [Thread-2  ]: 54 of 105 OK created table model dbo.AH_ListingTypeproperties................... [[32mOK[0m in 2.64s]
21:32:27.750979 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ListingTypeproperties
21:32:27.751147 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Listings
21:32:27.751675 [info ] [Thread-2  ]: 58 of 105 START table model dbo.AH_Listings..................................... [RUN]
21:32:27.752121 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Listings"
21:32:27.752271 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Listings
21:32:27.752401 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Listings
21:32:27.755110 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Listings"
21:32:27.755509 [debug] [Thread-2  ]: finished collecting timing info
21:32:27.755673 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Listings
21:32:27.785527 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:32:27.800996 [debug] [Thread-4  ]: finished collecting timing info
21:32:27.816209 [debug] [Thread-4  ]: On model.Shawn.AH_ListingTypes: Close
21:32:27.817058 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaea7a00>]}
21:32:27.817690 [info ] [Thread-4  ]: 55 of 105 OK created table model dbo.AH_ListingTypes............................ [[32mOK[0m in 2.70s]
21:32:27.818081 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingTypes
21:32:27.818259 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingsReserveHistory
21:32:27.818648 [info ] [Thread-4  ]: 59 of 105 START table model dbo.AH_ListingsReserveHistory....................... [RUN]
21:32:27.819072 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingsReserveHistory"
21:32:27.819224 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingsReserveHistory
21:32:27.819358 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingsReserveHistory
21:32:27.822110 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingsReserveHistory"
21:32:27.826012 [debug] [Thread-4  ]: finished collecting timing info
21:32:27.826169 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingsReserveHistory
21:32:27.825592 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Listings"
21:32:27.836016 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings".
21:32:27.836185 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Listings: 
  
  if object_id ('"dbo"."AH_Listings__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listings__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Listings__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Listings__dbt_tmp"
    end


   EXEC('create view dbo.AH_Listings__dbt_tmp_temp_view as
    
Select
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([PrimaryImageURI] as nvarchar(2048)) [PrimaryImageURI],
	cast([OwnerUserName] as nvarchar(500)) [OwnerUserName],
	cast([CurrentListingActionUserName] as nvarchar(500)) [CurrentListingActionUserName],
	cast([Title] as nvarchar(4000)) [Title],
	cast([Description] as nvarchar(4000)) [Description],
	cast([SubTitle] as nvarchar(4000)) [Subtitle],
	cast([Location] as nvarchar(4000)) [Location],
	cast([Status] as nvarchar(100)) [Status],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Enddttm] as datetime) [EndDTTM],
	cast([Startdttm] as datetime) [StartDTTM],
	cast([AutoreListrEMAining] as int) [AutoRelistRemaining],
	cast([CurrentQuantity] as int) [CurrentQuantity],
	cast([OriginalQuantity] as int) [OriginalQuantity],
	cast([ReListiteration] as int) [RelistIteration],
	cast([LotID] as int) [LotId],
	cast([AcceptedActionCount] as int) [AcceptedActionCount],
	cast([OwnerID] as int) [OwnerId],
	cast([ListingTypeID] as int) [ListingTypeId],
	cast([Duration] as int) [Duration],
	cast([Version] as int) [Version],
	cast([CurrencyID] as money) [CurrencyId],
	cast([PrimaryCategoryID] as int) [PrimaryCategoryId],
	cast([CurrentListingActionID] as int) [CurrentListingActionID],
	cast([OfferCount] as int) [OfferCount],
	cast([ID] as int) [Id],
	cast([OriginalreListCount] as int) [OriginalRelistCount],
	cast([Hits] as int) [Hits],
	cast([CurrentPrice] as decimal(24,2)) [CurrentPrice],
	cast([Increment] as decimal(24,2)) [Increment],
	cast([OriginalPrice] as money) [OriginalPrice] 
From stg.[AH_Listings_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Listings__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Listings__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Listings__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listings__dbt_tmp_temp_view"
    end



21:32:27.836309 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:32:27.836445 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:27.861416 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:27.861752 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:27.868265 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingsReserveHistory"
21:32:27.868794 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingsReserveHistory".
21:32:27.868963 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingsReserveHistory: 
  
  if object_id ('"dbo"."AH_ListingsReserveHistory__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingsReserveHistory__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingsReserveHistory__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingsReserveHistory__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingsReserveHistory__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([ListingID] as int) [ListingId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([OldReserve] as numeric(19,4)) [OldReserve],
	cast([NewReserve] as numeric(19,4)) [NewReserve] 
From stg.[AH_ListingsReserveHistory_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingsReserveHistory__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingsReserveHistory__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingsReserveHistory__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingsReserveHistory__dbt_tmp_temp_view"
    end



21:32:27.869093 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:32:27.869430 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:27.934894 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:27.969486 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:30.808416 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.06 seconds
21:32:30.824121 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingdecorations".
21:32:30.824468 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Listingdecorations: rename object "dbo"."AH_Listingdecorations" to AH_Listingdecorations__dbt_backup
21:32:30.879962 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:32:30.894209 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingdecorations".
21:32:30.894621 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Listingdecorations: rename object "dbo"."AH_Listingdecorations__dbt_tmp" to AH_Listingdecorations
21:32:30.928651 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.09 seconds
21:32:30.939778 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:32:30.941453 [debug] [Thread-3  ]: On model.Shawn.AH_Listingdecorations: COMMIT
21:32:30.946027 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings".
21:32:30.949740 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Listings: rename object "dbo"."AH_Listings" to AH_Listings__dbt_backup
21:32:30.949487 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingdecorations".
21:32:30.950052 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Listingdecorations: 
    
  if object_id ('"dbo"."AH_Listingdecorations__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Listingdecorations__dbt_backup"
    end

21:32:31.001096 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:32:31.015976 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings".
21:32:31.016348 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Listings: rename object "dbo"."AH_Listings__dbt_tmp" to AH_Listings
21:32:31.069661 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:32:31.071533 [debug] [Thread-2  ]: On model.Shawn.AH_Listings: COMMIT
21:32:31.075600 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings".
21:32:31.075831 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Listings: 
    
  if object_id ('"dbo"."AH_Listings__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Listings__dbt_backup"
    end

21:32:31.213950 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:32:31.227658 [debug] [Thread-3  ]: finished collecting timing info
21:32:31.228078 [debug] [Thread-3  ]: On model.Shawn.AH_Listingdecorations: Close
21:32:31.228884 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaea7c10>]}
21:32:31.229363 [info ] [Thread-3  ]: 56 of 105 OK created table model dbo.AH_Listingdecorations...................... [[32mOK[0m in 3.58s]
21:32:31.229724 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Listingdecorations
21:32:31.229900 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Locations
21:32:31.230267 [info ] [Thread-3  ]: 60 of 105 START table model dbo.AH_Locations.................................... [RUN]
21:32:31.230728 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Locations"
21:32:31.230890 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Locations
21:32:31.231023 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Locations
21:32:31.233600 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Locations"
21:32:31.234087 [debug] [Thread-3  ]: finished collecting timing info
21:32:31.234253 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Locations
21:32:31.269674 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.40 seconds
21:32:31.280615 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Locations"
21:32:31.281279 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Locations".
21:32:31.281468 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Locations: 
  
  if object_id ('"dbo"."AH_Locations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Locations__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Locations__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Locations__dbt_tmp"
    end


   EXEC('create view dbo.AH_Locations__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Amount] as numeric(19,4)) [Amount],
	cast([PayToproceed] as bit) [PayToProceed],
	cast([ID] as int) [Id] 
From stg.[AH_Locations_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Locations__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Locations__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Locations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Locations__dbt_tmp_temp_view"
    end



21:32:31.281584 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:32:31.281727 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:31.287445 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingsReserveHistory".
21:32:31.287707 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingsReserveHistory: rename object "dbo"."AH_ListingsReserveHistory" to AH_ListingsReserveHistory__dbt_backup
21:32:31.318491 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:31.410125 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:31.416585 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingsReserveHistory".
21:32:31.416936 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingsReserveHistory: rename object "dbo"."AH_ListingsReserveHistory__dbt_tmp" to AH_ListingsReserveHistory
21:32:31.443269 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.37 seconds
21:32:31.455776 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:32:31.457484 [debug] [Thread-4  ]: On model.Shawn.AH_ListingsReserveHistory: COMMIT
21:32:31.458635 [debug] [Thread-2  ]: finished collecting timing info
21:32:31.462473 [debug] [Thread-2  ]: On model.Shawn.AH_Listings: Close
21:32:31.463204 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58ab012250>]}
21:32:31.462200 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingsReserveHistory".
21:32:31.465635 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingsReserveHistory: 
    
  if object_id ('"dbo"."AH_ListingsReserveHistory__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingsReserveHistory__dbt_backup"
    end

21:32:31.590944 [info ] [Thread-2  ]: 58 of 105 OK created table model dbo.AH_Listings................................ [[32mOK[0m in 3.71s]
21:32:31.591905 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Listings
21:32:31.592123 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Logentries
21:32:31.592541 [info ] [Thread-2  ]: 61 of 105 START table model dbo.AH_Logentries................................... [RUN]
21:32:31.593051 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Logentries"
21:32:31.593213 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Logentries
21:32:31.593351 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Logentries
21:32:31.596083 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Logentries"
21:32:31.596530 [debug] [Thread-2  ]: finished collecting timing info
21:32:31.596694 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Logentries
21:32:31.633128 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Logentries"
21:32:31.633828 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logentries".
21:32:31.634024 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logentries: 
  
  if object_id ('"dbo"."AH_Logentries__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Logentries__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Logentries__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Logentries__dbt_tmp"
    end


   EXEC('create view dbo.AH_Logentries__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([Priority] as int) [Priority],
	cast([EventID] as int) [EventID],
	cast([SqlDaTestamp] as datetime) [SQLDateStamp],
	cast([EntryDaTestamp] as datetime) [EntryDateStamp],
	cast([MachineName] as nvarchar(4000)) [MachineName],
	cast([Message] as nvarchar(4000)) [Message],
	cast([Title] as nvarchar(4000)) [Title],
	cast([FunctionalArea] as nvarchar(4000)) [FunctionalArea],
	cast([Severity] as nvarchar(4000)) [Severity],
	cast([Actor] as nvarchar(4000)) [Actor],
	cast([ExceptionClass] as nvarchar(4000)) [ExceptionClass],
	cast([Stacktrace] as nvarchar(4000)) [StackTrace],
	cast([Properties] as nvarchar(4000)) [Properties] 
From stg.[AH_Logentries_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Logentries__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Logentries__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Logentries__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Logentries__dbt_tmp_temp_view"
    end



21:32:31.634148 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:32:31.634297 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:31.680116 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:32:31.697146 [debug] [Thread-4  ]: finished collecting timing info
21:32:31.697598 [debug] [Thread-4  ]: On model.Shawn.AH_ListingsReserveHistory: Close
21:32:31.698379 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58ab21e8e0>]}
21:32:31.698909 [info ] [Thread-4  ]: 59 of 105 OK created table model dbo.AH_ListingsReserveHistory.................. [[32mOK[0m in 3.88s]
21:32:31.699275 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingsReserveHistory
21:32:31.699455 [debug] [Thread-4  ]: Began running node model.Shawn.AH_LogentriesBuffer
21:32:31.699831 [info ] [Thread-4  ]: 62 of 105 START table model dbo.AH_LogentriesBuffer............................. [RUN]
21:32:31.700271 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_LogentriesBuffer"
21:32:31.700426 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_LogentriesBuffer
21:32:31.700562 [debug] [Thread-4  ]: Compiling model.Shawn.AH_LogentriesBuffer
21:32:31.703583 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_LogentriesBuffer"
21:32:31.704046 [debug] [Thread-4  ]: finished collecting timing info
21:32:31.704208 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_LogentriesBuffer
21:32:31.741064 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_LogentriesBuffer"
21:32:31.741358 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:31.742184 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LogentriesBuffer".
21:32:31.742374 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_LogentriesBuffer: 
  
  if object_id ('"dbo"."AH_LogentriesBuffer__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_LogentriesBuffer__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_LogentriesBuffer__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_LogentriesBuffer__dbt_tmp"
    end


   EXEC('create view dbo.AH_LogentriesBuffer__dbt_tmp_temp_view as
    
Select
	cast([Message] as nvarchar(4000)) [Message],
	cast([Properties] as nvarchar(4000)) [Properties],
	cast([MachineName] as nvarchar(4000)) [MachineName],
	cast([Title] as nvarchar(4000)) [Title],
	cast([FunctionalArea] as nvarchar(4000)) [FunctionalArea],
	cast([Severity] as nvarchar(4000)) [Severity],
	cast([Actor] as nvarchar(4000)) [Actor],
	cast([ExceptionClass] as nvarchar(4000)) [ExceptionClass],
	cast([Stacktrace] as nvarchar(4000)) [StackTrace],
	cast([SqlDaTestamp] as datetime) [SQLDateStamp],
	cast([EntryDaTestamp] as datetime) [EntryDateStamp],
	cast([ID] as int) [Id],
	cast([Priority] as int) [Priority],
	cast([EventID] as int) [EventID] 
From stg.[AH_LogentriesBuffer_FinalView]
    ');

  CREATE TABLE "dbo"."AH_LogentriesBuffer__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_LogentriesBuffer__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_LogentriesBuffer__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_LogentriesBuffer__dbt_tmp_temp_view"
    end



21:32:31.742499 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:32:31.742699 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:31.863219 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:33.465406 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.18 seconds
21:32:33.480407 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Locations".
21:32:33.480766 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Locations: rename object "dbo"."AH_Locations" to AH_Locations__dbt_backup
21:32:33.515640 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:33.529631 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Locations".
21:32:33.529983 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Locations: rename object "dbo"."AH_Locations__dbt_tmp" to AH_Locations
21:32:33.559471 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:33.561391 [debug] [Thread-3  ]: On model.Shawn.AH_Locations: COMMIT
21:32:33.565650 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Locations".
21:32:33.565861 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Locations: 
    
  if object_id ('"dbo"."AH_Locations__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Locations__dbt_backup"
    end

21:32:33.870913 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:32:33.884428 [debug] [Thread-3  ]: finished collecting timing info
21:32:33.884870 [debug] [Thread-3  ]: On model.Shawn.AH_Locations: Close
21:32:33.885676 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58ab1e9ee0>]}
21:32:33.886177 [info ] [Thread-3  ]: 60 of 105 OK created table model dbo.AH_Locations............................... [[32mOK[0m in 2.66s]
21:32:33.886589 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Locations
21:32:33.886788 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Logstats
21:32:33.887186 [info ] [Thread-3  ]: 63 of 105 START table model dbo.AH_Logstats..................................... [RUN]
21:32:33.887629 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Logstats"
21:32:33.887783 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Logstats
21:32:33.887917 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Logstats
21:32:33.890627 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Logstats"
21:32:33.891054 [debug] [Thread-3  ]: finished collecting timing info
21:32:33.891206 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Logstats
21:32:33.927085 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Logstats"
21:32:33.927754 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats".
21:32:33.927946 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Logstats: 
  
  if object_id ('"dbo"."AH_Logstats__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Logstats__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Logstats__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Logstats__dbt_tmp"
    end


   EXEC('create view dbo.AH_Logstats__dbt_tmp_temp_view as
    
Select
	cast([FromDate] as datetime) [FromDate],
	cast([RangeMinutes] as int) [RangeMinutes],
	cast([EntryCount] as int) [EntryCount],
	cast([IsArchived] as bit) [IsArchived],
	cast([Severity] as nvarchar(4000)) [Severity] 
From stg.[AH_Logstats_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Logstats__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Logstats__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Logstats__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Logstats__dbt_tmp_temp_view"
    end



21:32:33.928065 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:32:33.928204 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:34.037000 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:34.903625 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.16 seconds
21:32:34.918700 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LogentriesBuffer".
21:32:34.919064 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_LogentriesBuffer: rename object "dbo"."AH_LogentriesBuffer" to AH_LogentriesBuffer__dbt_backup
21:32:34.965467 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:32:34.979898 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LogentriesBuffer".
21:32:34.980258 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_LogentriesBuffer: rename object "dbo"."AH_LogentriesBuffer__dbt_tmp" to AH_LogentriesBuffer
21:32:35.046298 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:32:35.048229 [debug] [Thread-4  ]: On model.Shawn.AH_LogentriesBuffer: COMMIT
21:32:35.052686 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LogentriesBuffer".
21:32:35.052910 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_LogentriesBuffer: 
    
  if object_id ('"dbo"."AH_LogentriesBuffer__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_LogentriesBuffer__dbt_backup"
    end

21:32:35.390529 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
21:32:35.403797 [debug] [Thread-4  ]: finished collecting timing info
21:32:35.404228 [debug] [Thread-4  ]: On model.Shawn.AH_LogentriesBuffer: Close
21:32:35.404997 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae60e80>]}
21:32:35.405475 [info ] [Thread-4  ]: 62 of 105 OK created table model dbo.AH_LogentriesBuffer........................ [[32mOK[0m in 3.70s]
21:32:35.405831 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_LogentriesBuffer
21:32:35.406022 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Lots
21:32:35.406392 [info ] [Thread-4  ]: 64 of 105 START table model dbo.AH_Lots......................................... [RUN]
21:32:35.406843 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Lots"
21:32:35.406999 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Lots
21:32:35.407132 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Lots
21:32:35.409733 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Lots"
21:32:35.410230 [debug] [Thread-4  ]: finished collecting timing info
21:32:35.410394 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Lots
21:32:35.446729 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Lots"
21:32:35.447413 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Lots".
21:32:35.447606 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Lots: 
  
  if object_id ('"dbo"."AH_Lots__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Lots__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Lots__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Lots__dbt_tmp"
    end


   EXEC('create view dbo.AH_Lots__dbt_tmp_temp_view as
    
Select
	cast([LotNumber] as nvarchar(4000)) [LotNumber],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([IsSoftclosing] as bit) [IsSoftClosing],
	cast([SoftclosingGroup] as int) [SoftClosingGroup],
	cast([LotOrder] as int) [LotOrder],
	cast([AuctionEventID] as int) [AuctionEventID],
	cast([ID] as int) [Id],
	cast([ClosingGroup] as int) [ClosingGroup],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_Lots_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Lots__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Lots__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Lots__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Lots__dbt_tmp_temp_view"
    end



21:32:35.447733 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:32:35.447880 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:35.553962 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:37.091579 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.16 seconds
21:32:37.107181 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats".
21:32:37.107550 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Logstats: rename object "dbo"."AH_Logstats" to AH_Logstats__dbt_backup
21:32:37.139083 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:37.152948 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats".
21:32:37.153301 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Logstats: rename object "dbo"."AH_Logstats__dbt_tmp" to AH_Logstats
21:32:37.181430 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:37.183443 [debug] [Thread-3  ]: On model.Shawn.AH_Logstats: COMMIT
21:32:37.187485 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats".
21:32:37.187717 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Logstats: 
    
  if object_id ('"dbo"."AH_Logstats__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Logstats__dbt_backup"
    end

21:32:37.599209 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
21:32:37.611963 [debug] [Thread-3  ]: finished collecting timing info
21:32:37.612392 [debug] [Thread-3  ]: On model.Shawn.AH_Logstats: Close
21:32:37.613148 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaeae580>]}
21:32:37.613618 [info ] [Thread-3  ]: 63 of 105 OK created table model dbo.AH_Logstats................................ [[32mOK[0m in 3.73s]
21:32:37.613985 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Logstats
21:32:37.614163 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Media
21:32:37.614517 [info ] [Thread-3  ]: 65 of 105 START table model dbo.AH_Media........................................ [RUN]
21:32:37.614971 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Media"
21:32:37.615119 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Media
21:32:37.615251 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Media
21:32:37.617871 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Media"
21:32:37.618289 [debug] [Thread-3  ]: finished collecting timing info
21:32:37.618441 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Media
21:32:37.655221 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Media"
21:32:37.655924 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Media".
21:32:37.656118 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Media: 
  
  if object_id ('"dbo"."AH_Media__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Media__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Media__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Media__dbt_tmp"
    end


   EXEC('create view dbo.AH_Media__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([GUID] as uniqueidentifier) [GUID],
	cast([DefaultvariationName] as nvarchar(500)) [DefaultVariationName],
	cast([Loader] as nvarchar(500)) [Loader],
	cast([Saver] as nvarchar(500)) [Saver],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([ConText] as nvarchar(4000)) [Context],
	cast([Status] as nvarchar(100)) [Status] 
From stg.[AH_Media_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Media__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Media__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Media__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Media__dbt_tmp_temp_view"
    end



21:32:37.656248 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:32:37.656396 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:37.751321 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:38.003331 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.37 seconds
21:32:38.018352 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logentries".
21:32:38.018733 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logentries: rename object "dbo"."AH_Logentries" to AH_Logentries__dbt_backup
21:32:38.056211 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:32:38.070332 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logentries".
21:32:38.070737 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logentries: rename object "dbo"."AH_Logentries__dbt_tmp" to AH_Logentries
21:32:38.100130 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:38.102063 [debug] [Thread-2  ]: On model.Shawn.AH_Logentries: COMMIT
21:32:38.106448 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logentries".
21:32:38.106722 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logentries: 
    
  if object_id ('"dbo"."AH_Logentries__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Logentries__dbt_backup"
    end

21:32:38.768572 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.66 seconds
21:32:38.781626 [debug] [Thread-2  ]: finished collecting timing info
21:32:38.782039 [debug] [Thread-2  ]: On model.Shawn.AH_Logentries: Close
21:32:38.782858 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a85a6c70>]}
21:32:38.783364 [info ] [Thread-2  ]: 61 of 105 OK created table model dbo.AH_Logentries.............................. [[32mOK[0m in 7.19s]
21:32:38.783725 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Logentries
21:32:38.783907 [debug] [Thread-2  ]: Began running node model.Shawn.AH_MediaMetaData
21:32:38.784268 [info ] [Thread-2  ]: 66 of 105 START table model dbo.AH_MediaMetaData................................ [RUN]
21:32:38.784685 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_MediaMetaData"
21:32:38.784839 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_MediaMetaData
21:32:38.784971 [debug] [Thread-2  ]: Compiling model.Shawn.AH_MediaMetaData
21:32:38.787630 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_MediaMetaData"
21:32:38.788076 [debug] [Thread-2  ]: finished collecting timing info
21:32:38.788304 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_MediaMetaData
21:32:38.824411 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_MediaMetaData"
21:32:38.825113 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaMetaData".
21:32:38.825314 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_MediaMetaData: 
  
  if object_id ('"dbo"."AH_MediaMetaData__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_MediaMetaData__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_MediaMetaData__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_MediaMetaData__dbt_tmp"
    end


   EXEC('create view dbo.AH_MediaMetaData__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(500)) [Name],
	cast([Value] as nvarchar(4000)) [Value],
	cast([ID] as int) [Id],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_MediaMetaData_FinalView]
    ');

  CREATE TABLE "dbo"."AH_MediaMetaData__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_MediaMetaData__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_MediaMetaData__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_MediaMetaData__dbt_tmp_temp_view"
    end



21:32:38.825447 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:32:38.825597 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:38.935943 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:38.939791 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.49 seconds
21:32:38.954388 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Lots".
21:32:38.954767 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Lots: rename object "dbo"."AH_Lots" to AH_Lots__dbt_backup
21:32:38.988812 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:39.081160 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Lots".
21:32:39.081534 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Lots: rename object "dbo"."AH_Lots__dbt_tmp" to AH_Lots
21:32:39.114489 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:39.116326 [debug] [Thread-4  ]: On model.Shawn.AH_Lots: COMMIT
21:32:39.120970 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Lots".
21:32:39.121212 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Lots: 
    
  if object_id ('"dbo"."AH_Lots__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Lots__dbt_backup"
    end

21:32:39.374205 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:32:39.387463 [debug] [Thread-4  ]: finished collecting timing info
21:32:39.387934 [debug] [Thread-4  ]: On model.Shawn.AH_Lots: Close
21:32:39.388722 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58ab234460>]}
21:32:39.389218 [info ] [Thread-4  ]: 64 of 105 OK created table model dbo.AH_Lots.................................... [[32mOK[0m in 3.98s]
21:32:39.389579 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Lots
21:32:39.389760 [debug] [Thread-4  ]: Began running node model.Shawn.AH_MediaassetMetaData
21:32:39.390128 [info ] [Thread-4  ]: 67 of 105 START table model dbo.AH_MediaassetMetaData........................... [RUN]
21:32:39.390590 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_MediaassetMetaData"
21:32:39.390760 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_MediaassetMetaData
21:32:39.390898 [debug] [Thread-4  ]: Compiling model.Shawn.AH_MediaassetMetaData
21:32:39.393479 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_MediaassetMetaData"
21:32:39.393901 [debug] [Thread-4  ]: finished collecting timing info
21:32:39.394055 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_MediaassetMetaData
21:32:39.430307 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_MediaassetMetaData"
21:32:39.431030 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaassetMetaData".
21:32:39.431222 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_MediaassetMetaData: 
  
  if object_id ('"dbo"."AH_MediaassetMetaData__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_MediaassetMetaData__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_MediaassetMetaData__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_MediaassetMetaData__dbt_tmp"
    end


   EXEC('create view dbo.AH_MediaassetMetaData__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([MediaassetID] as int) [MediaAssetId],
	cast([MediaMetaDataID] as int) [MediaMetaDataId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_MediaassetMetaData_FinalView]
    ');

  CREATE TABLE "dbo"."AH_MediaassetMetaData__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_MediaassetMetaData__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_MediaassetMetaData__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_MediaassetMetaData__dbt_tmp_temp_view"
    end



21:32:39.431354 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:32:39.431501 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:39.531129 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:32:51.449645 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 12.02 seconds
21:32:51.464007 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaassetMetaData".
21:32:51.464303 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_MediaassetMetaData: rename object "dbo"."AH_MediaassetMetaData" to AH_MediaassetMetaData__dbt_backup
21:32:51.498218 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:51.511646 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaassetMetaData".
21:32:51.511931 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_MediaassetMetaData: rename object "dbo"."AH_MediaassetMetaData__dbt_tmp" to AH_MediaassetMetaData
21:32:51.540718 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:32:51.542437 [debug] [Thread-4  ]: On model.Shawn.AH_MediaassetMetaData: COMMIT
21:32:51.546697 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaassetMetaData".
21:32:51.546925 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_MediaassetMetaData: 
    
  if object_id ('"dbo"."AH_MediaassetMetaData__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_MediaassetMetaData__dbt_backup"
    end

21:32:51.737774 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:32:51.750005 [debug] [Thread-4  ]: finished collecting timing info
21:32:51.750362 [debug] [Thread-4  ]: On model.Shawn.AH_MediaassetMetaData: Close
21:32:51.751079 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a852f9a0>]}
21:32:51.751526 [info ] [Thread-4  ]: 67 of 105 OK created table model dbo.AH_MediaassetMetaData...................... [[32mOK[0m in 12.36s]
21:32:51.751881 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_MediaassetMetaData
21:32:51.752051 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Mediaassets
21:32:51.752400 [info ] [Thread-4  ]: 68 of 105 START table model dbo.AH_Mediaassets.................................. [RUN]
21:32:51.752800 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Mediaassets"
21:32:51.752947 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Mediaassets
21:32:51.753077 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Mediaassets
21:32:51.755610 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Mediaassets"
21:32:51.756006 [debug] [Thread-4  ]: finished collecting timing info
21:32:51.756153 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Mediaassets
21:32:51.791014 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Mediaassets"
21:32:51.791646 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediaassets".
21:32:51.791843 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Mediaassets: 
  
  if object_id ('"dbo"."AH_Mediaassets__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Mediaassets__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Mediaassets__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Mediaassets__dbt_tmp"
    end


   EXEC('create view dbo.AH_Mediaassets__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DaTestamp] as datetime) [DateStamp],
	cast([ID] as int) [Id],
	cast([Type] as nvarchar(500)) [Type],
	cast([Reference] as nvarchar(4000)) [Reference],
	cast([Sha1] as nvarchar(4000)) [SHA1] 
From stg.[AH_Mediaassets_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Mediaassets__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Mediaassets__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Mediaassets__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Mediaassets__dbt_tmp_temp_view"
    end



21:32:51.791963 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:32:51.792105 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:32:51.931987 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:33:18.122358 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 40.47 seconds
21:33:18.136616 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Media".
21:33:18.136951 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Media: rename object "dbo"."AH_Media" to AH_Media__dbt_backup
21:33:18.254273 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:33:18.267657 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Media".
21:33:18.267965 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Media: rename object "dbo"."AH_Media__dbt_tmp" to AH_Media
21:33:18.297722 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:33:18.299626 [debug] [Thread-3  ]: On model.Shawn.AH_Media: COMMIT
21:33:18.303588 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Media".
21:33:18.303782 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Media: 
    
  if object_id ('"dbo"."AH_Media__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Media__dbt_backup"
    end

21:33:18.479174 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:33:18.491450 [debug] [Thread-3  ]: finished collecting timing info
21:33:18.491808 [debug] [Thread-3  ]: On model.Shawn.AH_Media: Close
21:33:18.492504 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaeae970>]}
21:33:18.492955 [info ] [Thread-3  ]: 65 of 105 OK created table model dbo.AH_Media................................... [[32mOK[0m in 40.88s]
21:33:18.493306 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Media
21:33:18.493475 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Mediavariations
21:33:18.493823 [info ] [Thread-3  ]: 69 of 105 START table model dbo.AH_Mediavariations.............................. [RUN]
21:33:18.494220 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Mediavariations"
21:33:18.494366 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Mediavariations
21:33:18.494494 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Mediavariations
21:33:18.497004 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Mediavariations"
21:33:18.497582 [debug] [Thread-3  ]: finished collecting timing info
21:33:18.497765 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Mediavariations
21:33:18.531760 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Mediavariations"
21:33:18.532375 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediavariations".
21:33:18.532559 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Mediavariations: 
  
  if object_id ('"dbo"."AH_Mediavariations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Mediavariations__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Mediavariations__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Mediavariations__dbt_tmp"
    end


   EXEC('create view dbo.AH_Mediavariations__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([MediaassetID] as int) [MediaAssetId],
	cast([MediaID] as int) [MediaId],
	cast([Name] as nvarchar(500)) [Name] 
From stg.[AH_Mediavariations_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Mediavariations__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Mediavariations__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Mediavariations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Mediavariations__dbt_tmp_temp_view"
    end



21:33:18.532676 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:33:18.532814 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:33:18.647682 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:33:33.507826 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 14.98 seconds
21:33:33.522990 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediavariations".
21:33:33.523323 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Mediavariations: rename object "dbo"."AH_Mediavariations" to AH_Mediavariations__dbt_backup
21:33:33.555571 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:33:33.568728 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediavariations".
21:33:33.569061 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Mediavariations: rename object "dbo"."AH_Mediavariations__dbt_tmp" to AH_Mediavariations
21:33:33.597130 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:33:33.603755 [debug] [Thread-3  ]: On model.Shawn.AH_Mediavariations: COMMIT
21:33:33.612206 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediavariations".
21:33:33.613890 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Mediavariations: 
    
  if object_id ('"dbo"."AH_Mediavariations__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Mediavariations__dbt_backup"
    end

21:33:33.787206 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:33:33.799808 [debug] [Thread-3  ]: finished collecting timing info
21:33:33.800213 [debug] [Thread-3  ]: On model.Shawn.AH_Mediavariations: Close
21:33:33.800955 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaeaec10>]}
21:33:33.801419 [info ] [Thread-3  ]: 69 of 105 OK created table model dbo.AH_Mediavariations......................... [[32mOK[0m in 15.31s]
21:33:33.801787 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Mediavariations
21:33:33.801961 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Model
21:33:33.802317 [info ] [Thread-3  ]: 70 of 105 START table model dbo.AH_Model........................................ [RUN]
21:33:33.802788 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Model"
21:33:33.802942 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Model
21:33:33.803072 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Model
21:33:33.805604 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Model"
21:33:33.806074 [debug] [Thread-3  ]: finished collecting timing info
21:33:33.806238 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Model
21:33:33.841558 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Model"
21:33:33.842240 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Model".
21:33:33.842422 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Model: 
  
  if object_id ('"dbo"."AH_Model__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Model__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Model__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Model__dbt_tmp"
    end


   EXEC('create view dbo.AH_Model__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_Model_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Model__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Model__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Model__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Model__dbt_tmp_temp_view"
    end



21:33:33.842564 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:33:33.842714 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:33:33.979911 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:33:36.293814 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.45 seconds
21:33:36.309432 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Model".
21:33:36.309792 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Model: rename object "dbo"."AH_Model" to AH_Model__dbt_backup
21:33:36.342345 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:33:36.355911 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Model".
21:33:36.356274 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Model: rename object "dbo"."AH_Model__dbt_tmp" to AH_Model
21:33:36.386234 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:33:36.388239 [debug] [Thread-3  ]: On model.Shawn.AH_Model: COMMIT
21:33:36.392778 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Model".
21:33:36.393036 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Model: 
    
  if object_id ('"dbo"."AH_Model__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Model__dbt_backup"
    end

21:33:36.589675 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:33:36.602901 [debug] [Thread-3  ]: finished collecting timing info
21:33:36.603325 [debug] [Thread-3  ]: On model.Shawn.AH_Model: Close
21:33:36.604097 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaeac190>]}
21:33:36.604577 [info ] [Thread-3  ]: 70 of 105 OK created table model dbo.AH_Model................................... [[32mOK[0m in 2.80s]
21:33:36.604950 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Model
21:33:36.605127 [debug] [Thread-3  ]: Began running node model.Shawn.AH_NewSalestoInvoice
21:33:36.605495 [info ] [Thread-3  ]: 71 of 105 START table model dbo.AH_NewSalestoInvoice............................ [RUN]
21:33:36.605948 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_NewSalestoInvoice"
21:33:36.606098 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_NewSalestoInvoice
21:33:36.606228 [debug] [Thread-3  ]: Compiling model.Shawn.AH_NewSalestoInvoice
21:33:36.608888 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_NewSalestoInvoice"
21:33:36.609413 [debug] [Thread-3  ]: finished collecting timing info
21:33:36.609572 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_NewSalestoInvoice
21:33:36.646104 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_NewSalestoInvoice"
21:33:36.646819 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_NewSalestoInvoice".
21:33:36.647020 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_NewSalestoInvoice: 
  
  if object_id ('"dbo"."AH_NewSalestoInvoice__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_NewSalestoInvoice__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_NewSalestoInvoice__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_NewSalestoInvoice__dbt_tmp"
    end


   EXEC('create view dbo.AH_NewSalestoInvoice__dbt_tmp_temp_view as
    
Select
	cast([LineItemID] as int) [LineItemId] 
From stg.[AH_NewSalestoInvoice_FinalView]
    ');

  CREATE TABLE "dbo"."AH_NewSalestoInvoice__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_NewSalestoInvoice__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_NewSalestoInvoice__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_NewSalestoInvoice__dbt_tmp_temp_view"
    end



21:33:36.647138 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:33:36.647281 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:33:36.765372 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:33:39.247510 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.60 seconds
21:33:39.262531 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_NewSalestoInvoice".
21:33:39.262910 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_NewSalestoInvoice: rename object "dbo"."AH_NewSalestoInvoice" to AH_NewSalestoInvoice__dbt_backup
21:33:39.299133 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:33:39.313476 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_NewSalestoInvoice".
21:33:39.313815 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_NewSalestoInvoice: rename object "dbo"."AH_NewSalestoInvoice__dbt_tmp" to AH_NewSalestoInvoice
21:33:39.343896 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:33:39.345797 [debug] [Thread-3  ]: On model.Shawn.AH_NewSalestoInvoice: COMMIT
21:33:39.350200 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_NewSalestoInvoice".
21:33:39.350431 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_NewSalestoInvoice: 
    
  if object_id ('"dbo"."AH_NewSalestoInvoice__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_NewSalestoInvoice__dbt_backup"
    end

21:33:39.540323 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:33:39.552894 [debug] [Thread-3  ]: finished collecting timing info
21:33:39.553296 [debug] [Thread-3  ]: On model.Shawn.AH_NewSalestoInvoice: Close
21:33:39.554024 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaeac2e0>]}
21:33:39.554530 [info ] [Thread-3  ]: 71 of 105 OK created table model dbo.AH_NewSalestoInvoice....................... [[32mOK[0m in 2.95s]
21:33:39.554967 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_NewSalestoInvoice
21:33:39.555145 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Notifications
21:33:39.555499 [info ] [Thread-3  ]: 72 of 105 START table model dbo.AH_Notifications................................ [RUN]
21:33:39.555918 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Notifications"
21:33:39.556070 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Notifications
21:33:39.556207 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Notifications
21:33:39.558846 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Notifications"
21:33:39.559315 [debug] [Thread-3  ]: finished collecting timing info
21:33:39.559476 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Notifications
21:33:39.594913 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Notifications"
21:33:39.595615 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Notifications".
21:33:39.595802 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Notifications: 
  
  if object_id ('"dbo"."AH_Notifications__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Notifications__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Notifications__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Notifications__dbt_tmp"
    end


   EXEC('create view dbo.AH_Notifications__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([DetailID] as int) [DetailID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Queueddttm] as datetime) [QueuedDTTM],
	cast([Statusdttm] as datetime) [StatusDTTM],
	cast([RecipientEmail] as nvarchar(4000)) [RecipientEmail],
	cast([CcEmail] as nvarchar(4000)) [CCEmail],
	cast([BCcEmail] as nvarchar(4000)) [BCCEmail],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Status] as nvarchar(4000)) [Status],
	cast([StatusMessage] as nvarchar(4000)) [StatusMessage],
	cast([Message] as nvarchar(4000)) [Message],
	cast([DetailType] as nvarchar(4000)) [DetailType],
	cast([ReplytoEmail] as nvarchar(4000)) [ReplyToEmail],
	cast([SEnderUserName] as nvarchar(4000)) [SenderUserName],
	cast([ReceiverUserName] as nvarchar(4000)) [ReceiverUserName],
	cast([Template] as nvarchar(4000)) [Template] 
From stg.[AH_Notifications_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Notifications__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Notifications__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Notifications__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Notifications__dbt_tmp_temp_view"
    end



21:33:39.595927 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:33:39.596074 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:33:39.708955 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:33:42.511626 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.92 seconds
21:33:42.599525 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Notifications".
21:33:42.599877 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Notifications: rename object "dbo"."AH_Notifications" to AH_Notifications__dbt_backup
21:33:42.633562 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:33:42.647839 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Notifications".
21:33:42.648202 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Notifications: rename object "dbo"."AH_Notifications__dbt_tmp" to AH_Notifications
21:33:42.677759 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:33:42.679729 [debug] [Thread-3  ]: On model.Shawn.AH_Notifications: COMMIT
21:33:42.684148 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Notifications".
21:33:42.684378 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Notifications: 
    
  if object_id ('"dbo"."AH_Notifications__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Notifications__dbt_backup"
    end

21:33:42.877243 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:33:42.889865 [debug] [Thread-3  ]: finished collecting timing info
21:33:42.890293 [debug] [Thread-3  ]: On model.Shawn.AH_Notifications: Close
21:33:42.891101 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58ab17f040>]}
21:33:42.891598 [info ] [Thread-3  ]: 72 of 105 OK created table model dbo.AH_Notifications........................... [[32mOK[0m in 3.34s]
21:33:42.891960 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Notifications
21:33:42.892137 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Offers
21:33:42.892492 [info ] [Thread-3  ]: 73 of 105 START table model dbo.AH_Offers....................................... [RUN]
21:33:42.892918 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Offers"
21:33:42.893066 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Offers
21:33:42.893195 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Offers
21:33:42.895833 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Offers"
21:33:42.896320 [debug] [Thread-3  ]: finished collecting timing info
21:33:42.896477 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Offers
21:33:42.932117 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Offers"
21:33:42.932834 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Offers".
21:33:42.933028 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Offers: 
  
  if object_id ('"dbo"."AH_Offers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Offers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Offers__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Offers__dbt_tmp"
    end


   EXEC('create view dbo.AH_Offers__dbt_tmp_temp_view as
    
Select
	cast([Amount] as numeric(19,4)) [Amount],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([OfferMessage] as nvarchar(4000)) [OfferMessage],
	cast([Status] as nvarchar(4000)) [Status],
	cast([DecLineMessage] as nvarchar(4000)) [DeclineMessage],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Expirationdttm] as datetime) [ExpirationDTTM],
	cast([ID] as int) [Id],
	cast([SEndingUserID] as int) [SendingUserId],
	cast([ReceivINgUserID] as int) [ReceivingUserId],
	cast([BuyerID] as int) [BuyerId],
	cast([Quantity] as int) [Quantity],
	cast([ListingID] as int) [ListingId] 
From stg.[AH_Offers_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Offers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Offers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Offers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Offers__dbt_tmp_temp_view"
    end



21:33:42.933147 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:33:42.933288 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:33:43.038456 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:33:46.316900 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.38 seconds
21:33:46.331999 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Offers".
21:33:46.332336 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Offers: rename object "dbo"."AH_Offers" to AH_Offers__dbt_backup
21:33:46.369121 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:33:46.383361 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Offers".
21:33:46.383695 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Offers: rename object "dbo"."AH_Offers__dbt_tmp" to AH_Offers
21:33:46.412232 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:33:46.414162 [debug] [Thread-3  ]: On model.Shawn.AH_Offers: COMMIT
21:33:46.418585 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Offers".
21:33:46.418810 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Offers: 
    
  if object_id ('"dbo"."AH_Offers__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Offers__dbt_backup"
    end

21:33:46.609922 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:33:46.622904 [debug] [Thread-3  ]: finished collecting timing info
21:33:46.623308 [debug] [Thread-3  ]: On model.Shawn.AH_Offers: Close
21:33:46.624039 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a84fdee0>]}
21:33:46.624500 [info ] [Thread-3  ]: 73 of 105 OK created table model dbo.AH_Offers.................................. [[32mOK[0m in 3.73s]
21:33:46.624865 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Offers
21:33:46.625040 [debug] [Thread-3  ]: Began running node model.Shawn.AH_PaymentConfigurationTable
21:33:46.625386 [info ] [Thread-3  ]: 74 of 105 START table model dbo.AH_PaymentConfigurationTable.................... [RUN]
21:33:46.625790 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_PaymentConfigurationTable"
21:33:46.625938 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_PaymentConfigurationTable
21:33:46.626069 [debug] [Thread-3  ]: Compiling model.Shawn.AH_PaymentConfigurationTable
21:33:46.628732 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_PaymentConfigurationTable"
21:33:46.629201 [debug] [Thread-3  ]: finished collecting timing info
21:33:46.629355 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_PaymentConfigurationTable
21:33:46.664431 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_PaymentConfigurationTable"
21:33:46.665095 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentConfigurationTable".
21:33:46.665285 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_PaymentConfigurationTable: 
  
  if object_id ('"dbo"."AH_PaymentConfigurationTable__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PaymentConfigurationTable__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_PaymentConfigurationTable__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_PaymentConfigurationTable__dbt_tmp"
    end


   EXEC('create view dbo.AH_PaymentConfigurationTable__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([Active] as bit) [Active],
	cast([MinimumBidHold] as numeric(19,4)) [MinimumBidHold],
	cast([BasicplanPrice] as numeric(19,4)) [BasicPlanPrice],
	cast([ProPhotographyPrice] as numeric(19,4)) [ProPhotographyPrice],
	cast([ProMarketingPrice] as numeric(19,4)) [ProMarketingPrice],
	cast([Minfraudscore] as numeric(19,4)) [minFraudScore],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([MaximumBidCharge] as numeric(19,4)) [MaximumBidCharge],
	cast([BidHoldPercentage] as numeric(19,4)) [BidHoldPercentage] 
From stg.[AH_PaymentConfigurationTable_FinalView]
    ');

  CREATE TABLE "dbo"."AH_PaymentConfigurationTable__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_PaymentConfigurationTable__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_PaymentConfigurationTable__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PaymentConfigurationTable__dbt_tmp_temp_view"
    end



21:33:46.665418 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:33:46.665564 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:33:46.779549 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:33:49.140552 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.48 seconds
21:33:49.155283 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentConfigurationTable".
21:33:49.155633 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_PaymentConfigurationTable: rename object "dbo"."AH_PaymentConfigurationTable" to AH_PaymentConfigurationTable__dbt_backup
21:33:49.189188 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:33:49.202697 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentConfigurationTable".
21:33:49.203040 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_PaymentConfigurationTable: rename object "dbo"."AH_PaymentConfigurationTable__dbt_tmp" to AH_PaymentConfigurationTable
21:33:49.232021 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:33:49.233989 [debug] [Thread-3  ]: On model.Shawn.AH_PaymentConfigurationTable: COMMIT
21:33:49.238156 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentConfigurationTable".
21:33:49.238383 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_PaymentConfigurationTable: 
    
  if object_id ('"dbo"."AH_PaymentConfigurationTable__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_PaymentConfigurationTable__dbt_backup"
    end

21:33:49.434495 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:33:49.447739 [debug] [Thread-3  ]: finished collecting timing info
21:33:49.448163 [debug] [Thread-3  ]: On model.Shawn.AH_PaymentConfigurationTable: Close
21:33:49.448918 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaeac6d0>]}
21:33:49.449411 [info ] [Thread-3  ]: 74 of 105 OK created table model dbo.AH_PaymentConfigurationTable............... [[32mOK[0m in 2.82s]
21:33:49.449776 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_PaymentConfigurationTable
21:33:49.449955 [debug] [Thread-3  ]: Began running node model.Shawn.AH_PaymentResponses
21:33:49.450324 [info ] [Thread-3  ]: 75 of 105 START table model dbo.AH_PaymentResponses............................. [RUN]
21:33:49.450779 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_PaymentResponses"
21:33:49.450932 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_PaymentResponses
21:33:49.451063 [debug] [Thread-3  ]: Compiling model.Shawn.AH_PaymentResponses
21:33:49.453780 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_PaymentResponses"
21:33:49.454207 [debug] [Thread-3  ]: finished collecting timing info
21:33:49.454437 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_PaymentResponses
21:33:49.490618 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_PaymentResponses"
21:33:49.491313 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentResponses".
21:33:49.491504 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_PaymentResponses: 
  
  if object_id ('"dbo"."AH_PaymentResponses__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PaymentResponses__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_PaymentResponses__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_PaymentResponses__dbt_tmp"
    end


   EXEC('create view dbo.AH_PaymentResponses__dbt_tmp_temp_view as
    
Select
	cast([Approved] as bit) [Approved],
	cast([ID] as int) [Id],
	cast([InvoiceID] as int) [InvoiceId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DaTestamp] as datetime) [DateStamp],
	cast([Amount] as numeric(19,4)) [Amount],
	cast([AuthorizationCode] as nvarchar(4000)) [AuthorizationCode],
	cast([AvsResponseCode] as nvarchar(4000)) [AVSResponseCode],
	cast([Cvv2ResponseCode] as nvarchar(4000)) [CVV2ResponseCode],
	cast([CavResponseCode] as nvarchar(4000)) [CAVResponseCode],
	cast([BuyerStreet] as nvarchar(4000)) [BuyerStreet],
	cast([BuyerCity] as nvarchar(4000)) [BuyerCity],
	cast([ResponseStatus] as nvarchar(4000)) [ResponseStatus],
	cast([ProvIDEr] as nvarchar(4000)) [Provider],
	cast([RawResponseCode] as nvarchar(4000)) [RawResponseCode],
	cast([Description] as nvarchar(4000)) [Description],
	cast([TransactionID] as nvarchar(4000)) [TransactionID],
	cast([Method] as nvarchar(4000)) [Method],
	cast([BuyerStateregion] as nvarchar(4000)) [BuyerStateRegion],
	cast([BuyerzipPostal] as nvarchar(4000)) [BuyerZipPostal],
	cast([BuyerEmail] as nvarchar(4000)) [BuyerEmail],
	cast([AllFields] as nvarchar(4000)) [AllFields],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_PaymentResponses_FinalView]
    ');

  CREATE TABLE "dbo"."AH_PaymentResponses__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_PaymentResponses__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_PaymentResponses__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PaymentResponses__dbt_tmp_temp_view"
    end



21:33:49.491641 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:33:49.491792 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:33:49.601726 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:33:52.213483 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.72 seconds
21:33:52.228592 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentResponses".
21:33:52.228961 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_PaymentResponses: rename object "dbo"."AH_PaymentResponses" to AH_PaymentResponses__dbt_backup
21:33:52.259903 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:33:52.274593 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentResponses".
21:33:52.274965 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_PaymentResponses: rename object "dbo"."AH_PaymentResponses__dbt_tmp" to AH_PaymentResponses
21:33:52.304399 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:33:52.306341 [debug] [Thread-3  ]: On model.Shawn.AH_PaymentResponses: COMMIT
21:33:52.310689 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentResponses".
21:33:52.310930 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_PaymentResponses: 
    
  if object_id ('"dbo"."AH_PaymentResponses__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_PaymentResponses__dbt_backup"
    end

21:33:52.487171 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:33:52.500274 [debug] [Thread-3  ]: finished collecting timing info
21:33:52.500694 [debug] [Thread-3  ]: On model.Shawn.AH_PaymentResponses: Close
21:33:52.501452 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaeac820>]}
21:33:52.501942 [info ] [Thread-3  ]: 75 of 105 OK created table model dbo.AH_PaymentResponses........................ [[32mOK[0m in 3.05s]
21:33:52.502303 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_PaymentResponses
21:33:52.502483 [debug] [Thread-3  ]: Began running node model.Shawn.AH_PaymentprovIDErs
21:33:52.502875 [info ] [Thread-3  ]: 76 of 105 START table model dbo.AH_PaymentprovIDErs............................. [RUN]
21:33:52.503290 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_PaymentprovIDErs"
21:33:52.503436 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_PaymentprovIDErs
21:33:52.503564 [debug] [Thread-3  ]: Compiling model.Shawn.AH_PaymentprovIDErs
21:33:52.506103 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_PaymentprovIDErs"
21:33:52.506501 [debug] [Thread-3  ]: finished collecting timing info
21:33:52.506747 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_PaymentprovIDErs
21:33:52.541506 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_PaymentprovIDErs"
21:33:52.542170 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentprovIDErs".
21:33:52.542351 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_PaymentprovIDErs: 
  
  if object_id ('"dbo"."AH_PaymentprovIDErs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PaymentprovIDErs__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_PaymentprovIDErs__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_PaymentprovIDErs__dbt_tmp"
    end


   EXEC('create view dbo.AH_PaymentprovIDErs__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([Batchcapable] as bit) [BatchCapable],
	cast([ID] as int) [Id] 
From stg.[AH_PaymentprovIDErs_FinalView]
    ');

  CREATE TABLE "dbo"."AH_PaymentprovIDErs__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_PaymentprovIDErs__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_PaymentprovIDErs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PaymentprovIDErs__dbt_tmp_temp_view"
    end



21:33:52.542470 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:33:52.542646 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:33:52.657324 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:33:54.995212 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.45 seconds
21:33:55.010420 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentprovIDErs".
21:33:55.010803 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_PaymentprovIDErs: rename object "dbo"."AH_PaymentprovIDErs" to AH_PaymentprovIDErs__dbt_backup
21:33:55.044428 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:33:55.058074 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentprovIDErs".
21:33:55.058429 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_PaymentprovIDErs: rename object "dbo"."AH_PaymentprovIDErs__dbt_tmp" to AH_PaymentprovIDErs
21:33:55.087958 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:33:55.089865 [debug] [Thread-3  ]: On model.Shawn.AH_PaymentprovIDErs: COMMIT
21:33:55.094292 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentprovIDErs".
21:33:55.094514 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_PaymentprovIDErs: 
    
  if object_id ('"dbo"."AH_PaymentprovIDErs__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_PaymentprovIDErs__dbt_backup"
    end

21:33:55.579843 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.49 seconds
21:33:55.592583 [debug] [Thread-3  ]: finished collecting timing info
21:33:55.592991 [debug] [Thread-3  ]: On model.Shawn.AH_PaymentprovIDErs: Close
21:33:55.593754 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaeac970>]}
21:33:55.594239 [info ] [Thread-3  ]: 76 of 105 OK created table model dbo.AH_PaymentprovIDErs........................ [[32mOK[0m in 3.09s]
21:33:55.594622 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_PaymentprovIDErs
21:33:55.594809 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Properties
21:33:55.595156 [info ] [Thread-3  ]: 77 of 105 START table model dbo.AH_Properties................................... [RUN]
21:33:55.595568 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Properties"
21:33:55.595718 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Properties
21:33:55.595848 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Properties
21:33:55.598426 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Properties"
21:33:55.598959 [debug] [Thread-3  ]: finished collecting timing info
21:33:55.599138 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Properties
21:33:55.634686 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Properties"
21:33:55.635342 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Properties".
21:33:55.635529 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Properties: 
  
  if object_id ('"dbo"."AH_Properties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Properties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Properties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Properties__dbt_tmp"
    end


   EXEC('create view dbo.AH_Properties__dbt_tmp_temp_view as
    
Select
	cast([Value] as nvarchar(4000)) [Value],
	cast([Name] as nvarchar(4000)) [Name],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([LineItemID] as int) [LineItemId] 
From stg.[AH_Properties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Properties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Properties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Properties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Properties__dbt_tmp_temp_view"
    end



21:33:55.635645 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:33:55.635785 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:33:55.732335 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:33:58.500630 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.86 seconds
21:33:58.514481 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Properties".
21:33:58.514833 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Properties: rename object "dbo"."AH_Properties" to AH_Properties__dbt_backup
21:33:58.546425 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:33:58.560052 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Properties".
21:33:58.560363 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Properties: rename object "dbo"."AH_Properties__dbt_tmp" to AH_Properties
21:33:58.593392 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:33:58.595207 [debug] [Thread-3  ]: On model.Shawn.AH_Properties: COMMIT
21:33:58.599141 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Properties".
21:33:58.599341 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Properties: 
    
  if object_id ('"dbo"."AH_Properties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Properties__dbt_backup"
    end

21:33:58.815728 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:33:58.827595 [debug] [Thread-3  ]: finished collecting timing info
21:33:58.827946 [debug] [Thread-3  ]: On model.Shawn.AH_Properties: Close
21:33:58.828641 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a85da6d0>]}
21:33:58.829083 [info ] [Thread-3  ]: 77 of 105 OK created table model dbo.AH_Properties.............................. [[32mOK[0m in 3.23s]
21:33:58.829426 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Properties
21:33:58.829599 [debug] [Thread-3  ]: Began running node model.Shawn.AH_PropertybagItems
21:33:58.829947 [info ] [Thread-3  ]: 78 of 105 START table model dbo.AH_PropertybagItems............................. [RUN]
21:33:58.830339 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_PropertybagItems"
21:33:58.830485 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_PropertybagItems
21:33:58.830646 [debug] [Thread-3  ]: Compiling model.Shawn.AH_PropertybagItems
21:33:58.833115 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_PropertybagItems"
21:33:58.833557 [debug] [Thread-3  ]: finished collecting timing info
21:33:58.833717 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_PropertybagItems
21:33:58.869016 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_PropertybagItems"
21:33:58.869624 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PropertybagItems".
21:33:58.869805 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_PropertybagItems: 
  
  if object_id ('"dbo"."AH_PropertybagItems__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PropertybagItems__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_PropertybagItems__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_PropertybagItems__dbt_tmp"
    end


   EXEC('create view dbo.AH_PropertybagItems__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([PropertybagID] as int) [PropertyBagId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name],
	cast([Value] as nvarchar(4000)) [Value] 
From stg.[AH_PropertybagItems_FinalView]
    ');

  CREATE TABLE "dbo"."AH_PropertybagItems__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_PropertybagItems__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_PropertybagItems__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PropertybagItems__dbt_tmp_temp_view"
    end



21:33:58.869925 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:33:58.870067 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:33:58.985212 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:01.532179 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.66 seconds
21:34:01.547189 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PropertybagItems".
21:34:01.547546 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_PropertybagItems: rename object "dbo"."AH_PropertybagItems" to AH_PropertybagItems__dbt_backup
21:34:01.579991 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:01.669750 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PropertybagItems".
21:34:01.670120 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_PropertybagItems: rename object "dbo"."AH_PropertybagItems__dbt_tmp" to AH_PropertybagItems
21:34:01.707597 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:34:01.709392 [debug] [Thread-3  ]: On model.Shawn.AH_PropertybagItems: COMMIT
21:34:01.713535 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PropertybagItems".
21:34:01.713762 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_PropertybagItems: 
    
  if object_id ('"dbo"."AH_PropertybagItems__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_PropertybagItems__dbt_backup"
    end

21:34:01.929871 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:34:01.942480 [debug] [Thread-3  ]: finished collecting timing info
21:34:01.942928 [debug] [Thread-3  ]: On model.Shawn.AH_PropertybagItems: Close
21:34:01.943726 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58ab1f8490>]}
21:34:01.944223 [info ] [Thread-3  ]: 78 of 105 OK created table model dbo.AH_PropertybagItems........................ [[32mOK[0m in 3.11s]
21:34:01.944591 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_PropertybagItems
21:34:01.944765 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Propertybags
21:34:01.945124 [info ] [Thread-3  ]: 79 of 105 START table model dbo.AH_Propertybags................................. [RUN]
21:34:01.945537 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Propertybags"
21:34:01.945684 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Propertybags
21:34:01.945814 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Propertybags
21:34:01.948424 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Propertybags"
21:34:01.948905 [debug] [Thread-3  ]: finished collecting timing info
21:34:01.949064 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Propertybags
21:34:01.985559 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Propertybags"
21:34:01.986277 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Propertybags".
21:34:01.986470 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Propertybags: 
  
  if object_id ('"dbo"."AH_Propertybags__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Propertybags__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Propertybags__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Propertybags__dbt_tmp"
    end


   EXEC('create view dbo.AH_Propertybags__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id] 
From stg.[AH_Propertybags_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Propertybags__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Propertybags__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Propertybags__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Propertybags__dbt_tmp_temp_view"
    end



21:34:01.986632 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:34:01.986781 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:02.100434 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:04.688006 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.70 seconds
21:34:04.702882 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Propertybags".
21:34:04.703237 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Propertybags: rename object "dbo"."AH_Propertybags" to AH_Propertybags__dbt_backup
21:34:04.740929 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:34:04.755164 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Propertybags".
21:34:04.755543 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Propertybags: rename object "dbo"."AH_Propertybags__dbt_tmp" to AH_Propertybags
21:34:04.788222 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:04.790160 [debug] [Thread-3  ]: On model.Shawn.AH_Propertybags: COMMIT
21:34:04.794627 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Propertybags".
21:34:04.794864 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Propertybags: 
    
  if object_id ('"dbo"."AH_Propertybags__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Propertybags__dbt_backup"
    end

21:34:05.038780 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:34:05.057837 [debug] [Thread-3  ]: finished collecting timing info
21:34:05.059314 [debug] [Thread-3  ]: On model.Shawn.AH_Propertybags: Close
21:34:05.060640 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a852f280>]}
21:34:05.062211 [info ] [Thread-3  ]: 79 of 105 OK created table model dbo.AH_Propertybags............................ [[32mOK[0m in 3.12s]
21:34:05.063533 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Propertybags
21:34:05.064175 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ReListHistory
21:34:05.065456 [info ] [Thread-3  ]: 80 of 105 START table model dbo.AH_ReListHistory................................ [RUN]
21:34:05.066285 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ReListHistory"
21:34:05.066719 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ReListHistory
21:34:05.067609 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ReListHistory
21:34:05.072130 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ReListHistory"
21:34:05.074157 [debug] [Thread-3  ]: finished collecting timing info
21:34:05.074358 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ReListHistory
21:34:05.159506 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ReListHistory"
21:34:05.162762 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ReListHistory".
21:34:05.163424 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ReListHistory: 
  
  if object_id ('"dbo"."AH_ReListHistory__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ReListHistory__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ReListHistory__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ReListHistory__dbt_tmp"
    end


   EXEC('create view dbo.AH_ReListHistory__dbt_tmp_temp_view as
    
Select
	cast([CurrentPrice_Old] as numeric(19,4)) [CurrentPrice_Old],
	cast([CurrentPrice_New] as numeric(19,4)) [CurrentPrice_New],
	cast([ReservePrice] as numeric(19,4)) [ReservePrice],
	cast([ID] as int) [Id],
	cast([ListingID] as int) [ListingId],
	cast([NewreListiteration] as int) [NewRelistIteration],
	cast([Duration_Old] as int) [Duration_Old],
	cast([Duration_New] as int) [Duration_New],
	cast([HighBidderID] as int) [HighBidderId],
	cast([BidCount] as int) [BidCount],
	cast([Startdttm_New] as datetime) [StartDTTM_New],
	cast([Enddttm_Old] as datetime) [EndDTTM_Old],
	cast([Enddttm_New] as datetime) [EndDTTM_New],
	cast([ReListdttm] as datetime) [RelistDTTM],
	cast([Startdttm_Old] as datetime) [StartDTTM_Old],
	cast([MaxBidAmount] as numeric(19,4)) [MaxBidAmount],
	cast([ProxyBidAmount] as numeric(19,4)) [ProxyBidAmount],
	cast([BidIncrement] as numeric(19,4)) [BidIncrement],
	cast([ListingTitle] as nvarchar(4000)) [ListingTitle] 
From stg.[AH_ReListHistory_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ReListHistory__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ReListHistory__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ReListHistory__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ReListHistory__dbt_tmp_temp_view"
    end



21:34:05.164247 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:34:05.165075 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:05.281081 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:07.910691 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.75 seconds
21:34:07.926818 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ReListHistory".
21:34:07.927192 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ReListHistory: rename object "dbo"."AH_ReListHistory" to AH_ReListHistory__dbt_backup
21:34:07.960917 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:07.976234 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ReListHistory".
21:34:07.976631 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ReListHistory: rename object "dbo"."AH_ReListHistory__dbt_tmp" to AH_ReListHistory
21:34:08.009663 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:08.011724 [debug] [Thread-3  ]: On model.Shawn.AH_ReListHistory: COMMIT
21:34:08.016465 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ReListHistory".
21:34:08.016737 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ReListHistory: 
    
  if object_id ('"dbo"."AH_ReListHistory__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ReListHistory__dbt_backup"
    end

21:34:08.254849 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:34:08.268653 [debug] [Thread-3  ]: finished collecting timing info
21:34:08.269096 [debug] [Thread-3  ]: On model.Shawn.AH_ReListHistory: Close
21:34:08.269864 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aae60370>]}
21:34:08.270370 [info ] [Thread-3  ]: 80 of 105 OK created table model dbo.AH_ReListHistory........................... [[32mOK[0m in 3.20s]
21:34:08.270797 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ReListHistory
21:34:08.270982 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Reports
21:34:08.271341 [info ] [Thread-3  ]: 81 of 105 START table model dbo.AH_Reports...................................... [RUN]
21:34:08.271764 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Reports"
21:34:08.271912 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Reports
21:34:08.272043 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Reports
21:34:08.274701 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Reports"
21:34:08.275118 [debug] [Thread-3  ]: finished collecting timing info
21:34:08.275341 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Reports
21:34:08.311350 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Reports"
21:34:08.312052 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Reports".
21:34:08.312242 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Reports: 
  
  if object_id ('"dbo"."AH_Reports__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Reports__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Reports__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Reports__dbt_tmp"
    end


   EXEC('create view dbo.AH_Reports__dbt_tmp_temp_view as
    
Select
	cast([SecondstogeneRate] as numeric(19,4)) [SecondsToGenerate],
	cast([ReportName] as nvarchar(4000)) [ReportName],
	cast([Data] as nvarchar(4000)) [Data],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId] 
From stg.[AH_Reports_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Reports__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Reports__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Reports__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Reports__dbt_tmp_temp_view"
    end



21:34:08.312370 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:34:08.312520 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:08.442617 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:10.347878 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 102.61 seconds
21:34:10.363200 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingproperties".
21:34:10.363555 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listingproperties: rename object "dbo"."AH_Listingproperties" to AH_Listingproperties__dbt_backup
21:34:10.400642 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:34:10.414955 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingproperties".
21:34:10.415308 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listingproperties: rename object "dbo"."AH_Listingproperties__dbt_tmp" to AH_Listingproperties
21:34:10.447556 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:10.449529 [debug] [Thread-1  ]: On model.Shawn.AH_Listingproperties: COMMIT
21:34:10.453957 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingproperties".
21:34:10.454208 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listingproperties: 
    
  if object_id ('"dbo"."AH_Listingproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Listingproperties__dbt_backup"
    end

21:34:10.667379 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:34:10.680803 [debug] [Thread-1  ]: finished collecting timing info
21:34:10.681252 [debug] [Thread-1  ]: On model.Shawn.AH_Listingproperties: Close
21:34:10.682062 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaea7ac0>]}
21:34:10.682591 [info ] [Thread-1  ]: 57 of 105 OK created table model dbo.AH_Listingproperties....................... [[32mOK[0m in 103.02s]
21:34:10.682991 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Listingproperties
21:34:10.683170 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Roles
21:34:10.683531 [info ] [Thread-1  ]: 82 of 105 START table model dbo.AH_Roles........................................ [RUN]
21:34:10.683965 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Roles"
21:34:10.684118 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Roles
21:34:10.684250 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Roles
21:34:10.686945 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Roles"
21:34:10.687444 [debug] [Thread-1  ]: finished collecting timing info
21:34:10.687603 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Roles
21:34:10.723774 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Roles"
21:34:10.724478 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Roles".
21:34:10.724669 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Roles: 
  
  if object_id ('"dbo"."AH_Roles__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Roles__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Roles__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Roles__dbt_tmp"
    end


   EXEC('create view dbo.AH_Roles__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([Name] as nvarchar(500)) [Name] 
From stg.[AH_Roles_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Roles__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Roles__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Roles__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Roles__dbt_tmp_temp_view"
    end



21:34:10.724791 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:34:10.724937 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:10.872488 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:11.930395 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.62 seconds
21:34:11.945563 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Reports".
21:34:11.945921 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Reports: rename object "dbo"."AH_Reports" to AH_Reports__dbt_backup
21:34:11.976620 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:11.991475 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Reports".
21:34:11.991818 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Reports: rename object "dbo"."AH_Reports__dbt_tmp" to AH_Reports
21:34:12.027522 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:34:12.029460 [debug] [Thread-3  ]: On model.Shawn.AH_Reports: COMMIT
21:34:12.033906 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Reports".
21:34:12.034146 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Reports: 
    
  if object_id ('"dbo"."AH_Reports__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Reports__dbt_backup"
    end

21:34:12.453652 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.42 seconds
21:34:12.466310 [debug] [Thread-3  ]: finished collecting timing info
21:34:12.466758 [debug] [Thread-3  ]: On model.Shawn.AH_Reports: Close
21:34:12.467544 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aafa8040>]}
21:34:12.468022 [info ] [Thread-3  ]: 81 of 105 OK created table model dbo.AH_Reports................................. [[32mOK[0m in 4.20s]
21:34:12.468393 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Reports
21:34:12.468572 [debug] [Thread-3  ]: Began running node model.Shawn.AH_SMStemplatecontents
21:34:12.468937 [info ] [Thread-3  ]: 83 of 105 START table model dbo.AH_SMStemplatecontents.......................... [RUN]
21:34:12.469371 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_SMStemplatecontents"
21:34:12.469520 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_SMStemplatecontents
21:34:12.469650 [debug] [Thread-3  ]: Compiling model.Shawn.AH_SMStemplatecontents
21:34:12.472355 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_SMStemplatecontents"
21:34:12.472880 [debug] [Thread-3  ]: finished collecting timing info
21:34:12.473044 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_SMStemplatecontents
21:34:12.508634 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_SMStemplatecontents"
21:34:12.509328 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplatecontents".
21:34:12.509509 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_SMStemplatecontents: 
  
  if object_id ('"dbo"."AH_SMStemplatecontents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SMStemplatecontents__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_SMStemplatecontents__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_SMStemplatecontents__dbt_tmp"
    end


   EXEC('create view dbo.AH_SMStemplatecontents__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([Body] as nvarchar(4000)) [Body],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([ID] as int) [Id] 
From stg.[AH_SMStemplatecontents_FinalView]
    ');

  CREATE TABLE "dbo"."AH_SMStemplatecontents__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_SMStemplatecontents__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_SMStemplatecontents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SMStemplatecontents__dbt_tmp_temp_view"
    end



21:34:12.509628 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:34:12.509767 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:12.623062 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:13.444995 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.72 seconds
21:34:13.541143 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Roles".
21:34:13.541521 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Roles: rename object "dbo"."AH_Roles" to AH_Roles__dbt_backup
21:34:13.572127 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:13.587499 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Roles".
21:34:13.587862 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Roles: rename object "dbo"."AH_Roles__dbt_tmp" to AH_Roles
21:34:13.623396 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:34:13.625368 [debug] [Thread-1  ]: On model.Shawn.AH_Roles: COMMIT
21:34:13.629881 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Roles".
21:34:13.630130 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Roles: 
    
  if object_id ('"dbo"."AH_Roles__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Roles__dbt_backup"
    end

21:34:13.997035 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.37 seconds
21:34:14.010083 [debug] [Thread-1  ]: finished collecting timing info
21:34:14.010483 [debug] [Thread-1  ]: On model.Shawn.AH_Roles: Close
21:34:14.011221 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58ab22e790>]}
21:34:14.011686 [info ] [Thread-1  ]: 82 of 105 OK created table model dbo.AH_Roles................................... [[32mOK[0m in 3.33s]
21:34:14.012044 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Roles
21:34:14.012219 [debug] [Thread-1  ]: Began running node model.Shawn.AH_SMStemplates
21:34:14.012558 [info ] [Thread-1  ]: 84 of 105 START table model dbo.AH_SMStemplates................................. [RUN]
21:34:14.012977 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_SMStemplates"
21:34:14.013123 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_SMStemplates
21:34:14.013253 [debug] [Thread-1  ]: Compiling model.Shawn.AH_SMStemplates
21:34:14.015815 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_SMStemplates"
21:34:14.016204 [debug] [Thread-1  ]: finished collecting timing info
21:34:14.016396 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_SMStemplates
21:34:14.050661 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_SMStemplates"
21:34:14.051267 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplates".
21:34:14.051446 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SMStemplates: 
  
  if object_id ('"dbo"."AH_SMStemplates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SMStemplates__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_SMStemplates__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_SMStemplates__dbt_tmp"
    end


   EXEC('create view dbo.AH_SMStemplates__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([Enabled] as bit) [Enabled],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_SMStemplates_FinalView]
    ');

  CREATE TABLE "dbo"."AH_SMStemplates__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_SMStemplates__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_SMStemplates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SMStemplates__dbt_tmp_temp_view"
    end



21:34:14.051562 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:34:14.051703 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:14.166955 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:15.507128 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.00 seconds
21:34:15.521847 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplatecontents".
21:34:15.522161 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_SMStemplatecontents: rename object "dbo"."AH_SMStemplatecontents" to AH_SMStemplatecontents__dbt_backup
21:34:15.553918 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:15.566981 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplatecontents".
21:34:15.567302 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_SMStemplatecontents: rename object "dbo"."AH_SMStemplatecontents__dbt_tmp" to AH_SMStemplatecontents
21:34:15.596380 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:15.598281 [debug] [Thread-3  ]: On model.Shawn.AH_SMStemplatecontents: COMMIT
21:34:15.602311 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplatecontents".
21:34:15.602518 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_SMStemplatecontents: 
    
  if object_id ('"dbo"."AH_SMStemplatecontents__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_SMStemplatecontents__dbt_backup"
    end

21:34:15.833018 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:34:15.846508 [debug] [Thread-3  ]: finished collecting timing info
21:34:15.846935 [debug] [Thread-3  ]: On model.Shawn.AH_SMStemplatecontents: Close
21:34:15.847691 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aafa8190>]}
21:34:15.848148 [info ] [Thread-3  ]: 83 of 105 OK created table model dbo.AH_SMStemplatecontents..................... [[32mOK[0m in 3.38s]
21:34:15.848536 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_SMStemplatecontents
21:34:15.848711 [debug] [Thread-3  ]: Began running node model.Shawn.AH_SalesTaxRates
21:34:15.849064 [info ] [Thread-3  ]: 85 of 105 START table model dbo.AH_SalesTaxRates................................ [RUN]
21:34:15.849488 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_SalesTaxRates"
21:34:15.849637 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_SalesTaxRates
21:34:15.849783 [debug] [Thread-3  ]: Compiling model.Shawn.AH_SalesTaxRates
21:34:15.852400 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_SalesTaxRates"
21:34:15.852880 [debug] [Thread-3  ]: finished collecting timing info
21:34:15.853041 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_SalesTaxRates
21:34:15.889402 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_SalesTaxRates"
21:34:15.890090 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SalesTaxRates".
21:34:15.890291 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_SalesTaxRates: 
  
  if object_id ('"dbo"."AH_SalesTaxRates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SalesTaxRates__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_SalesTaxRates__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_SalesTaxRates__dbt_tmp"
    end


   EXEC('create view dbo.AH_SalesTaxRates__dbt_tmp_temp_view as
    
Select
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Shipping] as nvarchar(4000)) [Shipping],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([StateID] as int) [StateId],
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId],
	cast([TaxRate] as numeric(19,4)) [TaxRate] 
From stg.[AH_SalesTaxRates_FinalView]
    ');

  CREATE TABLE "dbo"."AH_SalesTaxRates__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_SalesTaxRates__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_SalesTaxRates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SalesTaxRates__dbt_tmp_temp_view"
    end



21:34:15.890415 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:34:15.890581 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:16.008244 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:17.076027 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.02 seconds
21:34:17.090685 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplates".
21:34:17.091051 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SMStemplates: rename object "dbo"."AH_SMStemplates" to AH_SMStemplates__dbt_backup
21:34:17.135813 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:34:17.149784 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplates".
21:34:17.150148 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SMStemplates: rename object "dbo"."AH_SMStemplates__dbt_tmp" to AH_SMStemplates
21:34:17.188597 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:34:17.190575 [debug] [Thread-1  ]: On model.Shawn.AH_SMStemplates: COMMIT
21:34:17.194647 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplates".
21:34:17.194863 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SMStemplates: 
    
  if object_id ('"dbo"."AH_SMStemplates__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_SMStemplates__dbt_backup"
    end

21:34:17.656085 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.46 seconds
21:34:17.669003 [debug] [Thread-1  ]: finished collecting timing info
21:34:17.669436 [debug] [Thread-1  ]: On model.Shawn.AH_SMStemplates: Close
21:34:17.670196 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aafa82e0>]}
21:34:17.670730 [info ] [Thread-1  ]: 84 of 105 OK created table model dbo.AH_SMStemplates............................ [[32mOK[0m in 3.66s]
21:34:17.671105 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_SMStemplates
21:34:17.671285 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ShippingMethods
21:34:17.671637 [info ] [Thread-1  ]: 86 of 105 START table model dbo.AH_ShippingMethods.............................. [RUN]
21:34:17.672052 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ShippingMethods"
21:34:17.672204 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ShippingMethods
21:34:17.672335 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ShippingMethods
21:34:17.674980 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ShippingMethods"
21:34:17.675463 [debug] [Thread-1  ]: finished collecting timing info
21:34:17.675620 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ShippingMethods
21:34:17.710830 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ShippingMethods"
21:34:17.711497 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingMethods".
21:34:17.711697 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ShippingMethods: 
  
  if object_id ('"dbo"."AH_ShippingMethods__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ShippingMethods__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ShippingMethods__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ShippingMethods__dbt_tmp"
    end


   EXEC('create view dbo.AH_ShippingMethods__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([DisplayOrder] as int) [DisplayOrder],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_ShippingMethods_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ShippingMethods__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ShippingMethods__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ShippingMethods__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ShippingMethods__dbt_tmp_temp_view"
    end



21:34:17.711815 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:34:17.711956 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:17.825460 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:19.331252 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.44 seconds
21:34:19.345577 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SalesTaxRates".
21:34:19.345894 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_SalesTaxRates: rename object "dbo"."AH_SalesTaxRates" to AH_SalesTaxRates__dbt_backup
21:34:19.376916 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:19.390869 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SalesTaxRates".
21:34:19.391174 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_SalesTaxRates: rename object "dbo"."AH_SalesTaxRates__dbt_tmp" to AH_SalesTaxRates
21:34:19.422871 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:19.424740 [debug] [Thread-3  ]: On model.Shawn.AH_SalesTaxRates: COMMIT
21:34:19.428901 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SalesTaxRates".
21:34:19.429097 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_SalesTaxRates: 
    
  if object_id ('"dbo"."AH_SalesTaxRates__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_SalesTaxRates__dbt_backup"
    end

21:34:19.662925 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:34:19.675990 [debug] [Thread-3  ]: finished collecting timing info
21:34:19.676349 [debug] [Thread-3  ]: On model.Shawn.AH_SalesTaxRates: Close
21:34:19.677053 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aafa8430>]}
21:34:19.677497 [info ] [Thread-3  ]: 85 of 105 OK created table model dbo.AH_SalesTaxRates........................... [[32mOK[0m in 3.83s]
21:34:19.677846 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_SalesTaxRates
21:34:19.678020 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ShippingOptions
21:34:19.678361 [info ] [Thread-3  ]: 87 of 105 START table model dbo.AH_ShippingOptions.............................. [RUN]
21:34:19.678791 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ShippingOptions"
21:34:19.678941 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ShippingOptions
21:34:19.679069 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ShippingOptions
21:34:19.681685 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ShippingOptions"
21:34:19.682079 [debug] [Thread-3  ]: finished collecting timing info
21:34:19.682226 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ShippingOptions
21:34:19.717062 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ShippingOptions"
21:34:19.717757 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions".
21:34:19.717957 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions: 
  
  if object_id ('"dbo"."AH_ShippingOptions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ShippingOptions__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ShippingOptions__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ShippingOptions__dbt_tmp"
    end


   EXEC('create view dbo.AH_ShippingOptions__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([ShippingMethodID] as int) [ShippingMethodId],
	cast([ListingID] as int) [ListingId],
	cast([FirstItEMAmount] as decimal(24,2)) [FirstItemAmount],
	cast([AdditionalItEMAmount] as decimal(24,2)) [AdditionalItemAmount] 
From stg.[AH_ShippingOptions_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ShippingOptions__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ShippingOptions__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ShippingOptions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ShippingOptions__dbt_tmp_temp_view"
    end



21:34:19.718076 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:34:19.718216 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:19.902960 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:21.172854 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.46 seconds
21:34:21.189266 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingMethods".
21:34:21.189609 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ShippingMethods: rename object "dbo"."AH_ShippingMethods" to AH_ShippingMethods__dbt_backup
21:34:21.223308 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:21.237842 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingMethods".
21:34:21.238181 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ShippingMethods: rename object "dbo"."AH_ShippingMethods__dbt_tmp" to AH_ShippingMethods
21:34:21.333607 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:34:21.335580 [debug] [Thread-1  ]: On model.Shawn.AH_ShippingMethods: COMMIT
21:34:21.339654 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingMethods".
21:34:21.339850 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ShippingMethods: 
    
  if object_id ('"dbo"."AH_ShippingMethods__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ShippingMethods__dbt_backup"
    end

21:34:21.702655 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
21:34:21.714757 [debug] [Thread-1  ]: finished collecting timing info
21:34:21.715143 [debug] [Thread-1  ]: On model.Shawn.AH_ShippingMethods: Close
21:34:21.715880 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aafa8580>]}
21:34:21.716354 [info ] [Thread-1  ]: 86 of 105 OK created table model dbo.AH_ShippingMethods......................... [[32mOK[0m in 4.04s]
21:34:21.716721 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ShippingMethods
21:34:21.716899 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Siteproperties
21:34:21.717245 [info ] [Thread-1  ]: 88 of 105 START table model dbo.AH_Siteproperties............................... [RUN]
21:34:21.717648 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Siteproperties"
21:34:21.717795 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Siteproperties
21:34:21.717923 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Siteproperties
21:34:21.720549 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Siteproperties"
21:34:21.720941 [debug] [Thread-1  ]: finished collecting timing info
21:34:21.721088 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Siteproperties
21:34:21.755928 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Siteproperties"
21:34:21.756617 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Siteproperties".
21:34:21.756811 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Siteproperties: 
  
  if object_id ('"dbo"."AH_Siteproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Siteproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Siteproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Siteproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_Siteproperties__dbt_tmp_temp_view as
    
Select
	cast([DecimalnativeValue] as numeric(19,4)) [DecimalNativeValue],
	cast([BoolnativeValue] as bit) [BoolNativeValue],
	cast([ID] as int) [Id],
	cast([IntnativeValue] as int) [IntNativeValue],
	cast([CustomFieldID] as int) [CustomFieldId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DateTimenativeValue] as datetime) [DateTimeNativeValue],
	cast([StringnativeValue] as nvarchar(4000)) [StringNativeValue],
	cast([EnumnativeValue] as nvarchar(4000)) [EnumNativeValue],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_Siteproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Siteproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Siteproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Siteproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Siteproperties__dbt_tmp_temp_view"
    end



21:34:21.756945 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:34:21.757090 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:21.869783 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:22.490781 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.77 seconds
21:34:22.505100 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions".
21:34:22.505402 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions: rename object "dbo"."AH_ShippingOptions" to AH_ShippingOptions__dbt_backup
21:34:22.540645 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:34:22.554656 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions".
21:34:22.554963 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions: rename object "dbo"."AH_ShippingOptions__dbt_tmp" to AH_ShippingOptions
21:34:22.588101 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:22.590017 [debug] [Thread-3  ]: On model.Shawn.AH_ShippingOptions: COMMIT
21:34:22.594095 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions".
21:34:22.594286 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions: 
    
  if object_id ('"dbo"."AH_ShippingOptions__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ShippingOptions__dbt_backup"
    end

21:34:22.902247 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
21:34:22.914775 [debug] [Thread-3  ]: finished collecting timing info
21:34:22.915190 [debug] [Thread-3  ]: On model.Shawn.AH_ShippingOptions: Close
21:34:22.915976 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aafa86d0>]}
21:34:22.916462 [info ] [Thread-3  ]: 87 of 105 OK created table model dbo.AH_ShippingOptions......................... [[32mOK[0m in 3.24s]
21:34:22.916830 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ShippingOptions
21:34:22.917012 [debug] [Thread-3  ]: Began running node model.Shawn.AH_States
21:34:22.917369 [info ] [Thread-3  ]: 89 of 105 START table model dbo.AH_States....................................... [RUN]
21:34:22.917790 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_States"
21:34:22.917940 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_States
21:34:22.918076 [debug] [Thread-3  ]: Compiling model.Shawn.AH_States
21:34:22.920703 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_States"
21:34:22.921177 [debug] [Thread-3  ]: finished collecting timing info
21:34:22.921349 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_States
21:34:22.956817 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_States"
21:34:22.957507 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_States".
21:34:22.957704 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_States: 
  
  if object_id ('"dbo"."AH_States__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_States__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_States__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_States__dbt_tmp"
    end


   EXEC('create view dbo.AH_States__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([Code] as nvarchar(4000)) [Code],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Enabled] as bit) [Enabled],
	cast([ID] as int) [Id],
	cast([CountryID] as int) [CountryId] 
From stg.[AH_States_FinalView]
    ');

  CREATE TABLE "dbo"."AH_States__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_States__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_States__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_States__dbt_tmp_temp_view"
    end



21:34:22.957834 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:34:22.957980 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:23.062256 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:24.612644 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.86 seconds
21:34:24.627104 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Siteproperties".
21:34:24.627396 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Siteproperties: rename object "dbo"."AH_Siteproperties" to AH_Siteproperties__dbt_backup
21:34:24.667167 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:34:24.745933 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Siteproperties".
21:34:24.746266 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Siteproperties: rename object "dbo"."AH_Siteproperties__dbt_tmp" to AH_Siteproperties
21:34:24.776740 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:24.778340 [debug] [Thread-1  ]: On model.Shawn.AH_Siteproperties: COMMIT
21:34:24.782326 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Siteproperties".
21:34:24.782531 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Siteproperties: 
    
  if object_id ('"dbo"."AH_Siteproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Siteproperties__dbt_backup"
    end

21:34:25.163275 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.38 seconds
21:34:25.176268 [debug] [Thread-1  ]: finished collecting timing info
21:34:25.176654 [debug] [Thread-1  ]: On model.Shawn.AH_Siteproperties: Close
21:34:25.177373 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaf91ee0>]}
21:34:25.177840 [info ] [Thread-1  ]: 88 of 105 OK created table model dbo.AH_Siteproperties.......................... [[32mOK[0m in 3.46s]
21:34:25.178195 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Siteproperties
21:34:25.178373 [debug] [Thread-1  ]: Began running node model.Shawn.AH_StripeCustomers
21:34:25.178754 [info ] [Thread-1  ]: 90 of 105 START table model dbo.AH_StripeCustomers.............................. [RUN]
21:34:25.179168 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_StripeCustomers"
21:34:25.179317 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_StripeCustomers
21:34:25.179445 [debug] [Thread-1  ]: Compiling model.Shawn.AH_StripeCustomers
21:34:25.181950 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_StripeCustomers"
21:34:25.182398 [debug] [Thread-1  ]: finished collecting timing info
21:34:25.182575 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_StripeCustomers
21:34:25.216930 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_StripeCustomers"
21:34:25.217486 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_StripeCustomers".
21:34:25.217650 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_StripeCustomers: 
  
  if object_id ('"dbo"."AH_StripeCustomers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_StripeCustomers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_StripeCustomers__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_StripeCustomers__dbt_tmp"
    end


   EXEC('create view dbo.AH_StripeCustomers__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([SellerID] as int) [SellerId],
	cast([BuyerID] as int) [BuyerId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CustomerID] as nvarchar(4000)) [CustomerId] 
From stg.[AH_StripeCustomers_FinalView]
    ');

  CREATE TABLE "dbo"."AH_StripeCustomers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_StripeCustomers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_StripeCustomers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_StripeCustomers__dbt_tmp_temp_view"
    end



21:34:25.217777 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:34:25.217917 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:25.319051 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.36 seconds
21:34:25.333238 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_States".
21:34:25.333442 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:25.333635 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_States: rename object "dbo"."AH_States" to AH_States__dbt_backup
21:34:25.371653 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:34:25.384306 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_States".
21:34:25.384604 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_States: rename object "dbo"."AH_States__dbt_tmp" to AH_States
21:34:25.419891 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:34:25.421642 [debug] [Thread-3  ]: On model.Shawn.AH_States: COMMIT
21:34:25.425821 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_States".
21:34:25.426039 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_States: 
    
  if object_id ('"dbo"."AH_States__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_States__dbt_backup"
    end

21:34:25.625143 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:34:25.637405 [debug] [Thread-3  ]: finished collecting timing info
21:34:25.637747 [debug] [Thread-3  ]: On model.Shawn.AH_States: Close
21:34:25.638458 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58ab1df970>]}
21:34:25.766003 [info ] [Thread-3  ]: 89 of 105 OK created table model dbo.AH_States.................................. [[32mOK[0m in 2.72s]
21:34:25.766957 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_States
21:34:25.767171 [debug] [Thread-3  ]: Began running node model.Shawn.AH_SubmittedListingPayment
21:34:25.767545 [info ] [Thread-3  ]: 91 of 105 START table model dbo.AH_SubmittedListingPayment...................... [RUN]
21:34:25.768072 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_SubmittedListingPayment"
21:34:25.768244 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_SubmittedListingPayment
21:34:25.768392 [debug] [Thread-3  ]: Compiling model.Shawn.AH_SubmittedListingPayment
21:34:25.771272 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_SubmittedListingPayment"
21:34:25.771707 [debug] [Thread-3  ]: finished collecting timing info
21:34:25.771875 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_SubmittedListingPayment
21:34:25.806614 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_SubmittedListingPayment"
21:34:25.807161 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment".
21:34:25.807337 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment: 
  
  if object_id ('"dbo"."AH_SubmittedListingPayment__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SubmittedListingPayment__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_SubmittedListingPayment__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_SubmittedListingPayment__dbt_tmp"
    end


   EXEC('create view dbo.AH_SubmittedListingPayment__dbt_tmp_temp_view as
    
Select
	cast([TransactionID] as nvarchar(30)) [TransactionId],
	cast([Amount] as decimal(24,2)) [Amount],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([ListingID] as int) [ListingId],
	cast([ID] as int) [Id],
	cast([ConsignorID] as int) [ConsignorId],
	cast([HasproMarketing] as bit) [HasProMarketing],
	cast([HasproPhotography] as bit) [HasProPhotography] 
From stg.[AH_SubmittedListingPayment_FinalView]
    ');

  CREATE TABLE "dbo"."AH_SubmittedListingPayment__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_SubmittedListingPayment__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_SubmittedListingPayment__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SubmittedListingPayment__dbt_tmp_temp_view"
    end



21:34:25.807457 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:34:25.807594 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:25.906899 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:28.046115 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.83 seconds
21:34:28.061166 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_StripeCustomers".
21:34:28.061485 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_StripeCustomers: rename object "dbo"."AH_StripeCustomers" to AH_StripeCustomers__dbt_backup
21:34:28.093006 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:28.106397 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_StripeCustomers".
21:34:28.106725 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_StripeCustomers: rename object "dbo"."AH_StripeCustomers__dbt_tmp" to AH_StripeCustomers
21:34:28.137031 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:28.138987 [debug] [Thread-1  ]: On model.Shawn.AH_StripeCustomers: COMMIT
21:34:28.143367 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_StripeCustomers".
21:34:28.143571 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_StripeCustomers: 
    
  if object_id ('"dbo"."AH_StripeCustomers__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_StripeCustomers__dbt_backup"
    end

21:34:28.426490 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:34:28.439967 [debug] [Thread-1  ]: finished collecting timing info
21:34:28.440397 [debug] [Thread-1  ]: On model.Shawn.AH_StripeCustomers: Close
21:34:28.441170 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a852fa00>]}
21:34:28.441668 [info ] [Thread-1  ]: 90 of 105 OK created table model dbo.AH_StripeCustomers......................... [[32mOK[0m in 3.26s]
21:34:28.442030 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_StripeCustomers
21:34:28.442205 [debug] [Thread-1  ]: Began running node model.Shawn.AH_SysDiagrams
21:34:28.442568 [info ] [Thread-1  ]: 92 of 105 START table model dbo.AH_SysDiagrams.................................. [RUN]
21:34:28.443014 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_SysDiagrams"
21:34:28.443177 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_SysDiagrams
21:34:28.443312 [debug] [Thread-1  ]: Compiling model.Shawn.AH_SysDiagrams
21:34:28.445968 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_SysDiagrams"
21:34:28.446455 [debug] [Thread-1  ]: finished collecting timing info
21:34:28.446646 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_SysDiagrams
21:34:28.482357 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_SysDiagrams"
21:34:28.483086 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SysDiagrams".
21:34:28.483280 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SysDiagrams: 
  
  if object_id ('"dbo"."AH_SysDiagrams__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SysDiagrams__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_SysDiagrams__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_SysDiagrams__dbt_tmp"
    end


   EXEC('create view dbo.AH_SysDiagrams__dbt_tmp_temp_view as
    
Select
	cast([Diagram_ID] as int) [diagram_id],
	cast([Version] as int) [version],
	cast([Principal_ID] as int) [principal_id],
	cast([Definition] as varbinary(8000)) [definition],
	cast([Name] as nvarchar(4000)) [name] 
From stg.[AH_SysDiagrams_FinalView]
    ');

  CREATE TABLE "dbo"."AH_SysDiagrams__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_SysDiagrams__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_SysDiagrams__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SysDiagrams__dbt_tmp_temp_view"
    end



21:34:28.483400 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:34:28.483546 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:28.581094 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:28.604557 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.80 seconds
21:34:28.618788 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment".
21:34:28.619085 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment: rename object "dbo"."AH_SubmittedListingPayment" to AH_SubmittedListingPayment__dbt_backup
21:34:28.666014 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:34:28.679182 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment".
21:34:28.679478 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment: rename object "dbo"."AH_SubmittedListingPayment__dbt_tmp" to AH_SubmittedListingPayment
21:34:28.725274 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:34:28.727198 [debug] [Thread-3  ]: On model.Shawn.AH_SubmittedListingPayment: COMMIT
21:34:28.731402 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment".
21:34:28.731596 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment: 
    
  if object_id ('"dbo"."AH_SubmittedListingPayment__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_SubmittedListingPayment__dbt_backup"
    end

21:34:29.002043 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:34:29.014272 [debug] [Thread-3  ]: finished collecting timing info
21:34:29.014617 [debug] [Thread-3  ]: On model.Shawn.AH_SubmittedListingPayment: Close
21:34:29.015323 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a85fbeb0>]}
21:34:29.015774 [info ] [Thread-3  ]: 91 of 105 OK created table model dbo.AH_SubmittedListingPayment................. [[32mOK[0m in 3.25s]
21:34:29.016148 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_SubmittedListingPayment
21:34:29.016327 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ThReadTracking
21:34:29.016668 [info ] [Thread-3  ]: 93 of 105 START table model dbo.AH_ThReadTracking............................... [RUN]
21:34:29.017074 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ThReadTracking"
21:34:29.017382 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ThReadTracking
21:34:29.017536 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ThReadTracking
21:34:29.020063 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ThReadTracking"
21:34:29.020512 [debug] [Thread-3  ]: finished collecting timing info
21:34:29.020669 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ThReadTracking
21:34:29.054894 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ThReadTracking"
21:34:29.055542 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ThReadTracking".
21:34:29.055729 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ThReadTracking: 
  
  if object_id ('"dbo"."AH_ThReadTracking__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ThReadTracking__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ThReadTracking__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ThReadTracking__dbt_tmp"
    end


   EXEC('create view dbo.AH_ThReadTracking__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([ThReadGUID] as nvarchar(4000)) [ThreadGUID],
	cast([DaTestamp] as datetime) [DateStamp],
	cast([PrimarythRead] as bit) [PrimaryThread] 
From stg.[AH_ThReadTracking_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ThReadTracking__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ThReadTracking__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ThReadTracking__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ThReadTracking__dbt_tmp_temp_view"
    end



21:34:29.055846 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:34:29.055987 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:29.156519 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:30.818881 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.34 seconds
21:34:30.835522 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SysDiagrams".
21:34:30.835886 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SysDiagrams: rename object "dbo"."AH_SysDiagrams" to AH_SysDiagrams__dbt_backup
21:34:30.879879 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:34:30.894244 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SysDiagrams".
21:34:30.895132 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SysDiagrams: rename object "dbo"."AH_SysDiagrams__dbt_tmp" to AH_SysDiagrams
21:34:30.949134 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:34:30.951126 [debug] [Thread-1  ]: On model.Shawn.AH_SysDiagrams: COMMIT
21:34:30.955751 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SysDiagrams".
21:34:30.956095 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SysDiagrams: 
    
  if object_id ('"dbo"."AH_SysDiagrams__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_SysDiagrams__dbt_backup"
    end

21:34:31.198934 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.14 seconds
21:34:31.215330 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ThReadTracking".
21:34:31.215701 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ThReadTracking: rename object "dbo"."AH_ThReadTracking" to AH_ThReadTracking__dbt_backup
21:34:31.257823 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:34:31.272232 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ThReadTracking".
21:34:31.272603 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ThReadTracking: rename object "dbo"."AH_ThReadTracking__dbt_tmp" to AH_ThReadTracking
21:34:31.313108 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:34:31.315129 [debug] [Thread-3  ]: On model.Shawn.AH_ThReadTracking: COMMIT
21:34:31.319893 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ThReadTracking".
21:34:31.320264 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ThReadTracking: 
    
  if object_id ('"dbo"."AH_ThReadTracking__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ThReadTracking__dbt_backup"
    end

21:34:31.789471 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.83 seconds
21:34:31.800648 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.48 seconds
21:34:31.804189 [debug] [Thread-1  ]: finished collecting timing info
21:34:31.896051 [debug] [Thread-1  ]: On model.Shawn.AH_SysDiagrams: Close
21:34:31.896915 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a8505760>]}
21:34:31.897395 [info ] [Thread-1  ]: 92 of 105 OK created table model dbo.AH_SysDiagrams............................. [[32mOK[0m in 3.45s]
21:34:31.897838 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_SysDiagrams
21:34:31.898032 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Tiers
21:34:31.898376 [info ] [Thread-1  ]: 94 of 105 START table model dbo.AH_Tiers........................................ [RUN]
21:34:31.898840 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Tiers"
21:34:31.898997 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Tiers
21:34:31.899130 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Tiers
21:34:31.895768 [debug] [Thread-3  ]: finished collecting timing info
21:34:31.902356 [debug] [Thread-3  ]: On model.Shawn.AH_ThReadTracking: Close
21:34:31.903071 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaf8c040>]}
21:34:31.903473 [info ] [Thread-3  ]: 93 of 105 OK created table model dbo.AH_ThReadTracking.......................... [[32mOK[0m in 2.89s]
21:34:31.903809 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ThReadTracking
21:34:31.903980 [debug] [Thread-3  ]: Began running node model.Shawn.AH_UnProcessedQueueMessages
21:34:31.904294 [info ] [Thread-3  ]: 95 of 105 START table model dbo.AH_UnProcessedQueueMessages..................... [RUN]
21:34:31.904700 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_UnProcessedQueueMessages"
21:34:31.904848 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_UnProcessedQueueMessages
21:34:31.904976 [debug] [Thread-3  ]: Compiling model.Shawn.AH_UnProcessedQueueMessages
21:34:31.902098 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Tiers"
21:34:31.908228 [debug] [Thread-1  ]: finished collecting timing info
21:34:31.908381 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Tiers
21:34:31.907786 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_UnProcessedQueueMessages"
21:34:31.916165 [debug] [Thread-3  ]: finished collecting timing info
21:34:31.916427 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_UnProcessedQueueMessages
21:34:31.979191 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Tiers"
21:34:31.984162 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Tiers".
21:34:31.984348 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Tiers: 
  
  if object_id ('"dbo"."AH_Tiers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Tiers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Tiers__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Tiers__dbt_tmp"
    end


   EXEC('create view dbo.AH_Tiers__dbt_tmp_temp_view as
    
Select
	cast([Upperboundexclusive] as numeric(26,4)) [UpperBoundExclusive],
	cast([Value] as numeric(19,4)) [Value],
	cast([Lowerboundinclusive] as numeric(19,4)) [LowerBoundInclusive],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([FeescheduleID] as int) [FeeScheduleId],
	cast([ValueType] as nvarchar(4000)) [ValueType],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_Tiers_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Tiers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Tiers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Tiers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Tiers__dbt_tmp_temp_view"
    end



21:34:31.984469 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:34:31.984611 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:31.983551 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_UnProcessedQueueMessages"
21:34:31.986043 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages".
21:34:31.986224 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages: 
  
  if object_id ('"dbo"."AH_UnProcessedQueueMessages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UnProcessedQueueMessages__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_UnProcessedQueueMessages__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_UnProcessedQueueMessages__dbt_tmp"
    end


   EXEC('create view dbo.AH_UnProcessedQueueMessages__dbt_tmp_temp_view as
    
Select
	cast([QueueName] as nvarchar(4000)) [QueueName],
	cast([QueueData] as nvarchar(4000)) [QueueData],
	cast([QueueOrder] as int) [QueueOrder] 
From stg.[AH_UnProcessedQueueMessages_FinalView]
    ');

  CREATE TABLE "dbo"."AH_UnProcessedQueueMessages__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_UnProcessedQueueMessages__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_UnProcessedQueueMessages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UnProcessedQueueMessages__dbt_tmp_temp_view"
    end



21:34:31.986342 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:34:31.986474 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:32.111659 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:32.112179 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:35.796804 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.81 seconds
21:34:35.812418 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages".
21:34:35.812769 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages: rename object "dbo"."AH_UnProcessedQueueMessages" to AH_UnProcessedQueueMessages__dbt_backup
21:34:35.849511 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:34:35.863494 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.88 seconds
21:34:35.876443 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages".
21:34:35.876800 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages: rename object "dbo"."AH_UnProcessedQueueMessages__dbt_tmp" to AH_UnProcessedQueueMessages
21:34:35.878653 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Tiers".
21:34:35.878867 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Tiers: rename object "dbo"."AH_Tiers" to AH_Tiers__dbt_backup
21:34:35.909588 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:35.911492 [debug] [Thread-3  ]: On model.Shawn.AH_UnProcessedQueueMessages: COMMIT
21:34:35.915718 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages".
21:34:35.916053 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:34:35.916162 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages: 
    
  if object_id ('"dbo"."AH_UnProcessedQueueMessages__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_UnProcessedQueueMessages__dbt_backup"
    end

21:34:35.932309 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Tiers".
21:34:35.932639 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Tiers: rename object "dbo"."AH_Tiers__dbt_tmp" to AH_Tiers
21:34:35.960603 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:35.962584 [debug] [Thread-1  ]: On model.Shawn.AH_Tiers: COMMIT
21:34:35.967056 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Tiers".
21:34:35.967318 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Tiers: 
    
  if object_id ('"dbo"."AH_Tiers__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Tiers__dbt_backup"
    end

21:34:36.104522 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:34:36.128286 [debug] [Thread-3  ]: finished collecting timing info
21:34:36.128718 [debug] [Thread-3  ]: On model.Shawn.AH_UnProcessedQueueMessages: Close
21:34:36.131391 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aafae190>]}
21:34:36.131863 [info ] [Thread-3  ]: 95 of 105 OK created table model dbo.AH_UnProcessedQueueMessages................ [[32mOK[0m in 4.23s]
21:34:36.132193 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_UnProcessedQueueMessages
21:34:36.133030 [debug] [Thread-3  ]: Began running node model.Shawn.AH_UserAlerts
21:34:36.133574 [info ] [Thread-3  ]: 96 of 105 START table model dbo.AH_UserAlerts................................... [RUN]
21:34:36.134050 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_UserAlerts"
21:34:36.134202 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_UserAlerts
21:34:36.134337 [debug] [Thread-3  ]: Compiling model.Shawn.AH_UserAlerts
21:34:36.137269 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_UserAlerts"
21:34:36.137677 [debug] [Thread-3  ]: finished collecting timing info
21:34:36.137830 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_UserAlerts
21:34:36.179606 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_UserAlerts"
21:34:36.180320 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserAlerts".
21:34:36.180521 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UserAlerts: 
  
  if object_id ('"dbo"."AH_UserAlerts__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserAlerts__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_UserAlerts__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_UserAlerts__dbt_tmp"
    end


   EXEC('create view dbo.AH_UserAlerts__dbt_tmp_temp_view as
    
Select
	cast([Enabled] as bit) [Enabled],
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId],
	cast([MakeID] as int) [MakeId],
	cast([ModelID] as int) [ModelId],
	cast([YearFrom] as int) [YearFrom],
	cast([Yearto] as int) [YearTo],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_UserAlerts_FinalView]
    ');

  CREATE TABLE "dbo"."AH_UserAlerts__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_UserAlerts__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_UserAlerts__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserAlerts__dbt_tmp_temp_view"
    end



21:34:36.180655 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:34:36.180801 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:36.184883 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:34:36.198847 [debug] [Thread-1  ]: finished collecting timing info
21:34:36.199226 [debug] [Thread-1  ]: On model.Shawn.AH_Tiers: Close
21:34:36.199929 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aafae040>]}
21:34:36.200405 [info ] [Thread-1  ]: 94 of 105 OK created table model dbo.AH_Tiers................................... [[32mOK[0m in 4.30s]
21:34:36.200764 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Tiers
21:34:36.200937 [debug] [Thread-1  ]: Began running node model.Shawn.AH_UserLogins
21:34:36.204362 [info ] [Thread-1  ]: 97 of 105 START table model dbo.AH_UserLogins................................... [RUN]
21:34:36.205075 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_UserLogins"
21:34:36.205330 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_UserLogins
21:34:36.205475 [debug] [Thread-1  ]: Compiling model.Shawn.AH_UserLogins
21:34:36.208226 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_UserLogins"
21:34:36.208636 [debug] [Thread-1  ]: finished collecting timing info
21:34:36.208789 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_UserLogins
21:34:36.253008 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_UserLogins"
21:34:36.253683 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins".
21:34:36.253876 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_UserLogins: 
  
  if object_id ('"dbo"."AH_UserLogins__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserLogins__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_UserLogins__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_UserLogins__dbt_tmp"
    end


   EXEC('create view dbo.AH_UserLogins__dbt_tmp_temp_view as
    
Select
	cast([LoginprovIDEr] as nvarchar(4000)) [LoginProvider],
	cast([ProvIDErKey] as nvarchar(4000)) [ProviderKey],
	cast([UserID] as int) [UserId] 
From stg.[AH_UserLogins_FinalView]
    ');

  CREATE TABLE "dbo"."AH_UserLogins__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_UserLogins__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_UserLogins__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserLogins__dbt_tmp_temp_view"
    end



21:34:36.253996 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:34:36.254139 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:36.276957 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:36.368991 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:39.121879 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.94 seconds
21:34:39.137384 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserAlerts".
21:34:39.137737 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UserAlerts: rename object "dbo"."AH_UserAlerts" to AH_UserAlerts__dbt_backup
21:34:39.169246 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:39.184013 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserAlerts".
21:34:39.184373 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UserAlerts: rename object "dbo"."AH_UserAlerts__dbt_tmp" to AH_UserAlerts
21:34:39.214437 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.96 seconds
21:34:39.223750 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:34:39.225387 [debug] [Thread-3  ]: On model.Shawn.AH_UserAlerts: COMMIT
21:34:39.232283 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins".
21:34:39.236193 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_UserLogins: rename object "dbo"."AH_UserLogins" to AH_UserLogins__dbt_backup
21:34:39.235871 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserAlerts".
21:34:39.236535 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UserAlerts: 
    
  if object_id ('"dbo"."AH_UserAlerts__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_UserAlerts__dbt_backup"
    end

21:34:39.271363 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:39.286623 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins".
21:34:39.286978 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_UserLogins: rename object "dbo"."AH_UserLogins__dbt_tmp" to AH_UserLogins
21:34:39.319642 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:39.321504 [debug] [Thread-1  ]: On model.Shawn.AH_UserLogins: COMMIT
21:34:39.325554 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins".
21:34:39.325781 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_UserLogins: 
    
  if object_id ('"dbo"."AH_UserLogins__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_UserLogins__dbt_backup"
    end

21:34:39.508119 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:34:39.521957 [debug] [Thread-3  ]: finished collecting timing info
21:34:39.522386 [debug] [Thread-3  ]: On model.Shawn.AH_UserAlerts: Close
21:34:39.523175 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aafae430>]}
21:34:39.523667 [info ] [Thread-3  ]: 96 of 105 OK created table model dbo.AH_UserAlerts.............................. [[32mOK[0m in 3.39s]
21:34:39.524043 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_UserAlerts
21:34:39.524223 [debug] [Thread-3  ]: Began running node model.Shawn.AH_UserMessages
21:34:39.524569 [info ] [Thread-3  ]: 98 of 105 START table model dbo.AH_UserMessages................................. [RUN]
21:34:39.524997 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_UserMessages"
21:34:39.525150 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_UserMessages
21:34:39.525287 [debug] [Thread-3  ]: Compiling model.Shawn.AH_UserMessages
21:34:39.527988 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_UserMessages"
21:34:39.528500 [debug] [Thread-3  ]: finished collecting timing info
21:34:39.528667 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_UserMessages
21:34:39.565211 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_UserMessages"
21:34:39.565989 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserMessages".
21:34:39.566197 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UserMessages: 
  
  if object_id ('"dbo"."AH_UserMessages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserMessages__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_UserMessages__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_UserMessages__dbt_tmp"
    end


   EXEC('create view dbo.AH_UserMessages__dbt_tmp_temp_view as
    
Select
	cast([SEnderID] as int) [SenderId],
	cast([RecipientID] as int) [RecipientId],
	cast([MasTerMessageID] as int) [MasterMessageId],
	cast([ID] as int) [Id],
	cast([ListingID] as int) [ListingId],
	cast([Sent] as datetime) [Sent],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([SuBJect] as nvarchar(4000)) [Subject],
	cast([Body] as nvarchar(4000)) [Body],
	cast([SEnderStatus] as nvarchar(4000)) [SenderStatus],
	cast([RecipientStatus] as nvarchar(4000)) [RecipientStatus],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_UserMessages_FinalView]
    ');

  CREATE TABLE "dbo"."AH_UserMessages__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_UserMessages__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_UserMessages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserMessages__dbt_tmp_temp_view"
    end



21:34:39.566325 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:34:39.566476 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:39.690414 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:40.093211 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.77 seconds
21:34:40.106931 [debug] [Thread-1  ]: finished collecting timing info
21:34:40.107361 [debug] [Thread-1  ]: On model.Shawn.AH_UserLogins: Close
21:34:40.108149 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a8593dc0>]}
21:34:40.108655 [info ] [Thread-1  ]: 97 of 105 OK created table model dbo.AH_UserLogins.............................. [[32mOK[0m in 3.90s]
21:34:40.109021 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_UserLogins
21:34:40.109204 [debug] [Thread-1  ]: Began running node model.Shawn.AH_UserOptOut
21:34:40.109556 [info ] [Thread-1  ]: 99 of 105 START table model dbo.AH_UserOptOut................................... [RUN]
21:34:40.109994 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_UserOptOut"
21:34:40.110150 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_UserOptOut
21:34:40.110285 [debug] [Thread-1  ]: Compiling model.Shawn.AH_UserOptOut
21:34:40.112978 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_UserOptOut"
21:34:40.113492 [debug] [Thread-1  ]: finished collecting timing info
21:34:40.113655 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_UserOptOut
21:34:40.230503 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_UserOptOut"
21:34:40.231240 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserOptOut".
21:34:40.231441 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_UserOptOut: 
  
  if object_id ('"dbo"."AH_UserOptOut__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserOptOut__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_UserOptOut__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_UserOptOut__dbt_tmp"
    end


   EXEC('create view dbo.AH_UserOptOut__dbt_tmp_temp_view as
    
Select
	cast([EmailName] as nvarchar(4000)) [EmailName],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId] 
From stg.[AH_UserOptOut_FinalView]
    ');

  CREATE TABLE "dbo"."AH_UserOptOut__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_UserOptOut__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_UserOptOut__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserOptOut__dbt_tmp_temp_view"
    end



21:34:40.231580 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:34:40.231731 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:40.338673 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:42.604694 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.04 seconds
21:34:42.619801 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserMessages".
21:34:42.620152 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UserMessages: rename object "dbo"."AH_UserMessages" to AH_UserMessages__dbt_backup
21:34:42.653991 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:42.668825 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserMessages".
21:34:42.669214 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UserMessages: rename object "dbo"."AH_UserMessages__dbt_tmp" to AH_UserMessages
21:34:42.700097 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:42.702108 [debug] [Thread-3  ]: On model.Shawn.AH_UserMessages: COMMIT
21:34:42.706282 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserMessages".
21:34:42.706567 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UserMessages: 
    
  if object_id ('"dbo"."AH_UserMessages__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_UserMessages__dbt_backup"
    end

21:34:42.915046 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:34:42.928446 [debug] [Thread-3  ]: finished collecting timing info
21:34:42.928862 [debug] [Thread-3  ]: On model.Shawn.AH_UserMessages: Close
21:34:42.929633 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aafae580>]}
21:34:42.930114 [info ] [Thread-3  ]: 98 of 105 OK created table model dbo.AH_UserMessages............................ [[32mOK[0m in 3.40s]
21:34:42.930490 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_UserMessages
21:34:42.930709 [debug] [Thread-3  ]: Began running node model.Shawn.AH_UserRoles
21:34:42.931058 [info ] [Thread-3  ]: 100 of 105 START table model dbo.AH_UserRoles................................... [RUN]
21:34:42.931471 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_UserRoles"
21:34:42.931617 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_UserRoles
21:34:42.931748 [debug] [Thread-3  ]: Compiling model.Shawn.AH_UserRoles
21:34:42.934477 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_UserRoles"
21:34:42.934657 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.70 seconds
21:34:42.943962 [debug] [Thread-3  ]: finished collecting timing info
21:34:42.944210 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_UserRoles
21:34:42.950996 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserOptOut".
21:34:42.959874 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_UserOptOut: rename object "dbo"."AH_UserOptOut" to AH_UserOptOut__dbt_backup
21:34:42.986789 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_UserRoles"
21:34:42.987473 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserRoles".
21:34:42.987661 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UserRoles: 
  
  if object_id ('"dbo"."AH_UserRoles__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserRoles__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_UserRoles__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_UserRoles__dbt_tmp"
    end


   EXEC('create view dbo.AH_UserRoles__dbt_tmp_temp_view as
    
Select
	cast([RoleID] as int) [RoleId],
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId] 
From stg.[AH_UserRoles_FinalView]
    ');

  CREATE TABLE "dbo"."AH_UserRoles__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_UserRoles__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_UserRoles__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserRoles__dbt_tmp_temp_view"
    end



21:34:42.987777 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:34:42.987915 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:42.995178 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:43.009177 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserOptOut".
21:34:43.009535 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_UserOptOut: rename object "dbo"."AH_UserOptOut__dbt_tmp" to AH_UserOptOut
21:34:43.038336 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:43.040137 [debug] [Thread-1  ]: On model.Shawn.AH_UserOptOut: COMMIT
21:34:43.044760 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserOptOut".
21:34:43.045004 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_UserOptOut: 
    
  if object_id ('"dbo"."AH_UserOptOut__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_UserOptOut__dbt_backup"
    end

21:34:43.107975 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:43.264942 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:34:43.278428 [debug] [Thread-1  ]: finished collecting timing info
21:34:43.278884 [debug] [Thread-1  ]: On model.Shawn.AH_UserOptOut: Close
21:34:43.279671 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aafae6d0>]}
21:34:43.280172 [info ] [Thread-1  ]: 99 of 105 OK created table model dbo.AH_UserOptOut.............................. [[32mOK[0m in 3.17s]
21:34:43.280548 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_UserOptOut
21:34:43.280726 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Userclaims
21:34:43.281063 [info ] [Thread-1  ]: 101 of 105 START table model dbo.AH_Userclaims.................................. [RUN]
21:34:43.281483 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Userclaims"
21:34:43.281636 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Userclaims
21:34:43.281770 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Userclaims
21:34:43.284465 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Userclaims"
21:34:43.284968 [debug] [Thread-1  ]: finished collecting timing info
21:34:43.285123 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Userclaims
21:34:43.321442 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Userclaims"
21:34:43.322147 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userclaims".
21:34:43.322342 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Userclaims: 
  
  if object_id ('"dbo"."AH_Userclaims__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Userclaims__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Userclaims__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Userclaims__dbt_tmp"
    end


   EXEC('create view dbo.AH_Userclaims__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId],
	cast([ClaimType] as nvarchar(4000)) [ClaimType],
	cast([ClaimValue] as nvarchar(4000)) [ClaimValue] 
From stg.[AH_Userclaims_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Userclaims__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Userclaims__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Userclaims__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Userclaims__dbt_tmp_temp_view"
    end



21:34:43.322472 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:34:43.322654 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:43.443056 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:46.338221 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.35 seconds
21:34:46.352354 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserRoles".
21:34:46.352688 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UserRoles: rename object "dbo"."AH_UserRoles" to AH_UserRoles__dbt_backup
21:34:46.439595 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:34:46.453519 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserRoles".
21:34:46.453855 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UserRoles: rename object "dbo"."AH_UserRoles__dbt_tmp" to AH_UserRoles
21:34:46.485678 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:46.487666 [debug] [Thread-3  ]: On model.Shawn.AH_UserRoles: COMMIT
21:34:46.492112 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserRoles".
21:34:46.492349 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UserRoles: 
    
  if object_id ('"dbo"."AH_UserRoles__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_UserRoles__dbt_backup"
    end

21:34:46.724034 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:34:46.736920 [debug] [Thread-3  ]: finished collecting timing info
21:34:46.737359 [debug] [Thread-3  ]: On model.Shawn.AH_UserRoles: Close
21:34:46.738128 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a841a1c0>]}
21:34:46.738636 [info ] [Thread-3  ]: 100 of 105 OK created table model dbo.AH_UserRoles.............................. [[32mOK[0m in 3.81s]
21:34:46.739004 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_UserRoles
21:34:46.739182 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Userproperties
21:34:46.739522 [info ] [Thread-3  ]: 102 of 105 START table model dbo.AH_Userproperties.............................. [RUN]
21:34:46.739925 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Userproperties"
21:34:46.740072 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Userproperties
21:34:46.740202 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Userproperties
21:34:46.742865 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Userproperties"
21:34:46.743327 [debug] [Thread-3  ]: finished collecting timing info
21:34:46.743483 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Userproperties
21:34:46.778951 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Userproperties"
21:34:46.779655 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userproperties".
21:34:46.779848 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Userproperties: 
  
  if object_id ('"dbo"."AH_Userproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Userproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Userproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Userproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_Userproperties__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([IntnativeValue] as int) [IntNativeValue],
	cast([UserID] as int) [UserId],
	cast([CustomFieldID] as int) [CustomFieldId],
	cast([BoolnativeValue] as bit) [BoolNativeValue],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DateTimenativeValue] as datetime) [DateTimeNativeValue],
	cast([StringnativeValue] as nvarchar(4000)) [StringNativeValue],
	cast([EnumnativeValue] as nvarchar(4000)) [EnumNativeValue],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([DecimalnativeValue] as numeric(19,4)) [DecimalNativeValue] 
From stg.[AH_Userproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Userproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Userproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Userproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Userproperties__dbt_tmp_temp_view"
    end



21:34:46.779970 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:34:46.780111 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:46.876825 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.55 seconds
21:34:46.888998 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:46.892435 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userclaims".
21:34:46.892689 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Userclaims: rename object "dbo"."AH_Userclaims" to AH_Userclaims__dbt_backup
21:34:46.932333 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:34:46.945713 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userclaims".
21:34:46.946050 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Userclaims: rename object "dbo"."AH_Userclaims__dbt_tmp" to AH_Userclaims
21:34:46.987849 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:34:46.989804 [debug] [Thread-1  ]: On model.Shawn.AH_Userclaims: COMMIT
21:34:46.994311 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userclaims".
21:34:46.994573 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Userclaims: 
    
  if object_id ('"dbo"."AH_Userclaims__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Userclaims__dbt_backup"
    end

21:34:47.186110 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:34:47.198712 [debug] [Thread-1  ]: finished collecting timing info
21:34:47.199071 [debug] [Thread-1  ]: On model.Shawn.AH_Userclaims: Close
21:34:47.199806 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aafae970>]}
21:34:47.200277 [info ] [Thread-1  ]: 101 of 105 OK created table model dbo.AH_Userclaims............................. [[32mOK[0m in 3.92s]
21:34:47.200643 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Userclaims
21:34:47.200816 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Users
21:34:47.201171 [info ] [Thread-1  ]: 103 of 105 START table model dbo.AH_Users....................................... [RUN]
21:34:47.201573 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Users"
21:34:47.201720 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Users
21:34:47.201850 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Users
21:34:47.204547 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Users"
21:34:47.205002 [debug] [Thread-1  ]: finished collecting timing info
21:34:47.205157 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Users
21:34:47.239799 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Users"
21:34:47.240452 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Users".
21:34:47.240637 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Users: 
  
  if object_id ('"dbo"."AH_Users__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Users__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Users__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Users__dbt_tmp"
    end


   EXEC('create view dbo.AH_Users__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([BillingAddressID] as int) [BillingAddressID],
	cast([BillingCreditCardID] as int) [BillingCreditCardID],
	cast([PrimaryAddressID] as int) [PrimaryAddressID],
	cast([AccessfailedCount] as int) [AccessFailedCount],
	cast([IsApproved] as bit) [IsApproved],
	cast([IsLockedOut] as bit) [IsLockedOut],
	cast([NewsLetter] as bit) [Newsletter],
	cast([IsVerified] as bit) [IsVerified],
	cast([IsActive] as bit) [IsActive],
	cast([EmailConfirmed] as bit) [EmailConfirmed],
	cast([PhoneNumberConfirmed] as bit) [PhoneNumberConfirmed],
	cast([TwoFactorEnabled] as bit) [TwoFactorEnabled],
	cast([LockOutEnabled] as bit) [LockoutEnabled],
	cast([WebapiEnabled] as bit) [WebAPIEnabled],
	cast([CreationDate] as datetime) [CreationDate],
	cast([LastLoginDate] as datetime) [LastLoginDate],
	cast([LastActivityDate] as datetime) [LastActivityDate],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([LockOutEndDateUTC] as datetime) [LockoutEndDateUtc],
	cast([UserName] as nvarchar(500)) [UserName],
	cast([Email] as nvarchar(320)) [Email],
	cast([Password] as varchar(128)) [Password],
	cast([Comment] as nvarchar(4000)) [Comment],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([Culture] as nvarchar(10)) [Culture],
	cast([Lastip] as nvarchar(50)) [LastIP],
	cast([VerificationToken] as nvarchar(100)) [VerificationToken],
	cast([PasswordResetToken] as varchar(128)) [PasswordResetToken],
	cast([ServiceAuthorizationToken] as nvarchar(100)) [ServiceAuthorizationToken],
	cast([PasswordHash] as nvarchar(4000)) [PasswordHash],
	cast([SecURItyStamp] as nvarchar(4000)) [SecurityStamp],
	cast([PhoneNumber] as nvarchar(40)) [PhoneNumber] 
From stg.[AH_Users_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Users__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Users__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Users__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Users__dbt_tmp_temp_view"
    end



21:34:47.240753 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:34:47.240895 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:47.335422 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:56.270533 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 9.03 seconds
21:34:56.285077 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Users".
21:34:56.285418 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Users: rename object "dbo"."AH_Users" to AH_Users__dbt_backup
21:34:56.330150 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:34:56.344313 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Users".
21:34:56.344684 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Users: rename object "dbo"."AH_Users__dbt_tmp" to AH_Users
21:34:56.376060 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:56.377990 [debug] [Thread-1  ]: On model.Shawn.AH_Users: COMMIT
21:34:56.382495 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Users".
21:34:56.382792 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Users: 
    
  if object_id ('"dbo"."AH_Users__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Users__dbt_backup"
    end

21:34:57.250406 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.87 seconds
21:34:57.263497 [debug] [Thread-1  ]: finished collecting timing info
21:34:57.263908 [debug] [Thread-1  ]: On model.Shawn.AH_Users: Close
21:34:57.264677 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a849a160>]}
21:34:57.265157 [info ] [Thread-1  ]: 103 of 105 OK created table model dbo.AH_Users.................................. [[32mOK[0m in 10.06s]
21:34:57.265528 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Users
21:34:57.265709 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Version
21:34:57.266049 [info ] [Thread-1  ]: 104 of 105 START table model dbo.AH_Version..................................... [RUN]
21:34:57.266498 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Version"
21:34:57.266701 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Version
21:34:57.266843 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Version
21:34:57.269709 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Version"
21:34:57.270130 [debug] [Thread-1  ]: finished collecting timing info
21:34:57.270286 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Version
21:34:57.305832 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Version"
21:34:57.306506 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Version".
21:34:57.306756 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Version: 
  
  if object_id ('"dbo"."AH_Version__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Version__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Version__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Version__dbt_tmp"
    end


   EXEC('create view dbo.AH_Version__dbt_tmp_temp_view as
    
Select
	cast([VersionNumber] as nvarchar(4000)) [VersionNumber],
	cast([Status] as nvarchar(4000)) [Status],
	cast([DaTestamp] as datetime) [DateStamp],
	cast([ID] as int) [ID] 
From stg.[AH_Version_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Version__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Version__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Version__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Version__dbt_tmp_temp_view"
    end



21:34:57.306881 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:34:57.307026 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:34:57.417024 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:34:59.708649 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.40 seconds
21:34:59.723952 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Version".
21:34:59.724315 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Version: rename object "dbo"."AH_Version" to AH_Version__dbt_backup
21:34:59.771428 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:34:59.785576 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Version".
21:34:59.785911 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Version: rename object "dbo"."AH_Version__dbt_tmp" to AH_Version
21:34:59.815380 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:34:59.817317 [debug] [Thread-1  ]: On model.Shawn.AH_Version: COMMIT
21:34:59.821529 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Version".
21:34:59.821734 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Version: 
    
  if object_id ('"dbo"."AH_Version__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Version__dbt_backup"
    end

21:35:00.032197 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:35:00.045060 [debug] [Thread-1  ]: finished collecting timing info
21:35:00.045440 [debug] [Thread-1  ]: On model.Shawn.AH_Version: Close
21:35:00.046188 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aafaeeb0>]}
21:35:00.046686 [info ] [Thread-1  ]: 104 of 105 OK created table model dbo.AH_Version................................ [[32mOK[0m in 2.78s]
21:35:00.047059 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Version
21:35:00.047231 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Watches
21:35:00.047566 [info ] [Thread-1  ]: 105 of 105 START table model dbo.AH_Watches..................................... [RUN]
21:35:00.047978 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Watches"
21:35:00.048127 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Watches
21:35:00.048256 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Watches
21:35:00.050848 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Watches"
21:35:00.051256 [debug] [Thread-1  ]: finished collecting timing info
21:35:00.051408 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Watches
21:35:00.087221 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Watches"
21:35:00.087876 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches".
21:35:00.088071 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Watches: 
  
  if object_id ('"dbo"."AH_Watches__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Watches__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Watches__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Watches__dbt_tmp"
    end


   EXEC('create view dbo.AH_Watches__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId],
	cast([ListingID] as int) [ListingId],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser] 
From stg.[AH_Watches_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Watches__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Watches__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Watches__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Watches__dbt_tmp_temp_view"
    end



21:35:00.088191 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:35:00.088333 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:35:00.189285 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:35:05.076732 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 4.99 seconds
21:35:05.114361 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches".
21:35:05.115404 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Watches: rename object "dbo"."AH_Watches" to AH_Watches__dbt_backup
21:35:05.169240 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:35:05.196954 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches".
21:35:05.197591 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Watches: rename object "dbo"."AH_Watches__dbt_tmp" to AH_Watches
21:35:05.244055 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:35:05.245935 [debug] [Thread-1  ]: On model.Shawn.AH_Watches: COMMIT
21:35:05.250767 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches".
21:35:05.251077 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Watches: 
    
  if object_id ('"dbo"."AH_Watches__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Watches__dbt_backup"
    end

21:35:05.677731 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
21:35:05.691548 [debug] [Thread-1  ]: finished collecting timing info
21:35:05.691962 [debug] [Thread-1  ]: On model.Shawn.AH_Watches: Close
21:35:05.692740 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaf91040>]}
21:35:05.693225 [info ] [Thread-1  ]: 105 of 105 OK created table model dbo.AH_Watches................................ [[32mOK[0m in 5.64s]
21:35:05.693592 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Watches
21:36:07.414990 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 80.63 seconds
21:36:07.430468 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userproperties".
21:36:07.430871 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Userproperties: rename object "dbo"."AH_Userproperties" to AH_Userproperties__dbt_backup
21:36:07.467141 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:36:07.481423 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userproperties".
21:36:07.481792 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Userproperties: rename object "dbo"."AH_Userproperties__dbt_tmp" to AH_Userproperties
21:36:07.511352 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:36:07.513332 [debug] [Thread-3  ]: On model.Shawn.AH_Userproperties: COMMIT
21:36:07.517957 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userproperties".
21:36:07.518229 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Userproperties: 
    
  if object_id ('"dbo"."AH_Userproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Userproperties__dbt_backup"
    end

21:36:07.699383 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:36:07.712671 [debug] [Thread-3  ]: finished collecting timing info
21:36:07.713098 [debug] [Thread-3  ]: On model.Shawn.AH_Userproperties: Close
21:36:07.713869 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a858c520>]}
21:36:07.714343 [info ] [Thread-3  ]: 102 of 105 OK created table model dbo.AH_Userproperties......................... [[32mOK[0m in 80.97s]
21:36:07.714750 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Userproperties
21:36:44.420622 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 232.63 seconds
21:36:44.509543 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediaassets".
21:36:44.509897 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Mediaassets: rename object "dbo"."AH_Mediaassets" to AH_Mediaassets__dbt_backup
21:36:44.545784 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:36:44.559083 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediaassets".
21:36:44.559397 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Mediaassets: rename object "dbo"."AH_Mediaassets__dbt_tmp" to AH_Mediaassets
21:36:44.589841 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:36:44.592117 [debug] [Thread-4  ]: On model.Shawn.AH_Mediaassets: COMMIT
21:36:44.596060 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediaassets".
21:36:44.596274 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Mediaassets: 
    
  if object_id ('"dbo"."AH_Mediaassets__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Mediaassets__dbt_backup"
    end

21:36:44.794886 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:36:44.808062 [debug] [Thread-4  ]: finished collecting timing info
21:36:44.808454 [debug] [Thread-4  ]: On model.Shawn.AH_Mediaassets: Close
21:36:44.809207 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a84f6340>]}
21:36:44.809683 [info ] [Thread-4  ]: 68 of 105 OK created table model dbo.AH_Mediaassets............................. [[32mOK[0m in 233.06s]
21:36:44.810060 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Mediaassets
21:37:15.743190 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 276.92 seconds
21:37:15.758037 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaMetaData".
21:37:15.758361 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_MediaMetaData: rename object "dbo"."AH_MediaMetaData" to AH_MediaMetaData__dbt_backup
21:37:15.789515 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:37:15.803639 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaMetaData".
21:37:15.803994 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_MediaMetaData: rename object "dbo"."AH_MediaMetaData__dbt_tmp" to AH_MediaMetaData
21:37:15.839464 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:37:15.841408 [debug] [Thread-2  ]: On model.Shawn.AH_MediaMetaData: COMMIT
21:37:15.845761 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaMetaData".
21:37:15.845969 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_MediaMetaData: 
    
  if object_id ('"dbo"."AH_MediaMetaData__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_MediaMetaData__dbt_backup"
    end

21:37:16.073355 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:37:16.086368 [debug] [Thread-2  ]: finished collecting timing info
21:37:16.086771 [debug] [Thread-2  ]: On model.Shawn.AH_MediaMetaData: Close
21:37:16.087570 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a24896-326c-40a3-b619-3a74c7aadc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58ab1e7850>]}
21:37:16.088037 [info ] [Thread-2  ]: 66 of 105 OK created table model dbo.AH_MediaMetaData........................... [[32mOK[0m in 277.30s]
21:37:16.088397 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_MediaMetaData
21:37:16.090184 [debug] [MainThread]: Acquiring new synapse connection "master"
21:37:16.090490 [debug] [MainThread]: On master: COMMIT
21:37:16.091188 [info ] [MainThread]: 
21:37:16.091453 [info ] [MainThread]: Finished running 105 table models in 368.23s.
21:37:16.091654 [debug] [MainThread]: Connection 'master' was properly closed.
21:37:16.091761 [debug] [MainThread]: Connection 'model.Shawn.AH_Watches' was properly closed.
21:37:16.091856 [debug] [MainThread]: Connection 'model.Shawn.AH_MediaMetaData' was properly closed.
21:37:16.091962 [debug] [MainThread]: Connection 'model.Shawn.AH_Userproperties' was properly closed.
21:37:16.092052 [debug] [MainThread]: Connection 'model.Shawn.AH_Mediaassets' was properly closed.
21:37:16.123916 [info ] [MainThread]: 
21:37:16.124299 [info ] [MainThread]: [32mCompleted successfully[0m
21:37:16.124713 [info ] [MainThread]: 
21:37:16.124905 [info ] [MainThread]: Done. PASS=105 WARN=0 ERROR=0 SKIP=0 TOTAL=105
21:37:16.125204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b0c56d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b33c87c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58aaefcee0>]}


============================== 2022-09-18 21:37:18.454514 | 5a85326d-5386-419f-90c0-da3e30100d73 ==============================
21:37:18.454514 [info ] [MainThread]: Running with dbt=1.0.0
21:37:18.459248 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step5_DM'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
21:37:18.459479 [debug] [MainThread]: Tracking: tracking
21:37:18.459806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd248108d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd248108fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd248108f10>]}
21:37:18.654943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:37:18.655345 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:37:18.681510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a85326d-5386-419f-90c0-da3e30100d73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd24808a340>]}
21:37:18.729573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a85326d-5386-419f-90c0-da3e30100d73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd24a109910>]}
21:37:18.730127 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:37:18.738085 [info ] [MainThread]: 
21:37:18.738719 [debug] [MainThread]: Acquiring new synapse connection "master"
21:37:18.739946 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
21:37:18.748969 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
21:37:18.749175 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
21:37:18.749301 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:37:18.749440 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:37:19.119410 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:37:19.164905 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.42 seconds
21:37:19.166984 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
21:37:19.189473 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
21:37:19.195636 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
21:37:19.196088 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
21:37:19.197971 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
21:37:19.198196 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
21:37:19.198319 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:37:19.198451 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:37:19.196415 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
21:37:19.200036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:37:19.200212 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:37:19.349326 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:37:19.350005 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:37:19.416580 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:37:19.422037 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:37:19.470192 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
21:37:19.470640 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
21:37:19.621931 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
21:37:19.622393 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
21:37:41.866926 [debug] [MainThread]: On master: COMMIT
21:37:41.867658 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
21:37:41.867997 [info ] [MainThread]: 
21:37:41.871877 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Buyers_DM
21:37:41.872598 [info ] [Thread-1  ]: 1 of 5 START table model dbo.AH_Buyers_DM....................................... [RUN]
21:37:41.873165 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Buyers_DM"
21:37:41.872346 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Currencies_DM
21:37:41.873601 [info ] [Thread-4  ]: 4 of 5 START table model dbo.AH_Currencies_DM................................... [RUN]
21:37:41.874159 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Currencies_DM"
21:37:41.874322 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Currencies_DM
21:37:41.874480 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Currencies_DM
21:37:41.872164 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Categories_DM
21:37:41.877813 [info ] [Thread-2  ]: 2 of 5 START table model dbo.AH_Categories_DM................................... [RUN]
21:37:41.878289 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Categories_DM"
21:37:41.878449 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Categories_DM
21:37:41.878638 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Categories_DM
21:37:41.881415 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Categories_DM"
21:37:41.873354 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Buyers_DM
21:37:41.881781 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Buyers_DM
21:37:41.885245 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Buyers_DM"
21:37:41.872267 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Consignors_DM
21:37:41.886461 [info ] [Thread-3  ]: 3 of 5 START table model dbo.AH_Consignors_DM................................... [RUN]
21:37:41.887074 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Consignors_DM"
21:37:41.887237 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Consignors_DM
21:37:41.887366 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Consignors_DM
21:37:41.877468 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Currencies_DM"
21:37:41.891026 [debug] [Thread-4  ]: finished collecting timing info
21:37:41.891215 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Currencies_DM
21:37:41.885880 [debug] [Thread-2  ]: finished collecting timing info
21:37:41.900188 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Categories_DM
21:37:41.890455 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Consignors_DM"
21:37:41.900505 [debug] [Thread-1  ]: finished collecting timing info
21:37:41.935627 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Buyers_DM
21:37:41.953886 [debug] [Thread-3  ]: finished collecting timing info
21:37:41.997928 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Consignors_DM
21:37:42.058191 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Categories_DM"
21:37:42.061463 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Currencies_DM"
21:37:42.069895 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Buyers_DM"
21:37:42.077423 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies_DM".
21:37:42.078048 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Currencies_DM: 
  
  if object_id ('"dbo"."AH_Currencies_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Currencies_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Currencies_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Currencies_DM__dbt_tmp"
    end


   EXEC('create view dbo.AH_Currencies_DM__dbt_tmp_temp_view as
    
SELECT
	[Id] AS [CurrencyId],
	[ConversionToUSD],
	[Code],
	[LastUpdatedUser],
	[CreatedOn] AS [CreatedDate],
	[UpdatedOn] AS [UpdatedDate],
	[DeletedOn] AS [DeletedDate]
FROM [stg].[AH_Currencies_FinalView];
    ');

  CREATE TABLE "dbo"."AH_Currencies_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Currencies_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Currencies_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Currencies_DM__dbt_tmp_temp_view"
    end



21:37:42.078180 [debug] [Thread-4  ]: Opening a new connection, currently in state init
21:37:42.078337 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:37:42.077943 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories_DM".
21:37:42.078688 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories_DM: 
  
  if object_id ('"dbo"."AH_Categories_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Categories_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Categories_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Categories_DM__dbt_tmp"
    end


   EXEC('create view dbo.AH_Categories_DM__dbt_tmp_temp_view as
    
SELECT
	Id,
	Name,
	ParentCategoryId,
	DisplayOrder,
	LastUpdatedUser,
	Type,
	MVCAction,
	RolesAllowed,
	EnabledCustomProperty,
	lft,
	rgt,
	CreatedOn,
	UpdatedOn,
	DeletedOn
FROM stg.AH_Categories_FinalView;
    ');

  CREATE TABLE "dbo"."AH_Categories_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Categories_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Categories_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Categories_DM__dbt_tmp_temp_view"
    end



21:37:42.078839 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:37:42.078979 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:37:42.077703 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Buyers_DM".
21:37:42.079685 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Buyers_DM: 
  
  if object_id ('"dbo"."AH_Buyers_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Buyers_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Buyers_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Buyers_DM__dbt_tmp"
    end


   EXEC('create view dbo.AH_Buyers_DM__dbt_tmp_temp_view as
    

with UserProperties_temp as (
    select 
        t1.UserID,
        max(case Name when ''FirstName'' then StringNativeValue else NULL end) as FirstName,
        max(case Name when ''LastName'' then StringNativeValue else NULL end) as LastName,
        max(case Name when ''UserPhone'' then StringNativeValue else NULL end) as Phone,
        max(case Name when ''IsInternational'' then cast(EnumNativeValue as varchar(200)) else NULL end) as IsInternational,
        max(case Name when ''Reg_Reference'' then cast(EnumNativeValue as varchar(200)) else NULL end) as Reg_Reference,
        max(case Name when ''Reg_Referral'' then cast(EnumNativeValue as varchar(200)) else NULL end) as Reg_Referral
    from
        (SELECT
            up.*,
            cf.Name
        FROM [stg].[AH_UserProperties_FinalView] AS up
        left JOIN [stg].[AH_CustomFields_FinalView] as cf
            ON cf.[Id] = up.[CustomFieldId]
        where CustomFieldID=''5''
            or CustomFieldID=''6''
            or CustomFieldID=''161098''
            or CustomFieldID=''2407692''
            or CustomFieldID=''2694978''
            or CustomFieldID=''2708864''
        ) t1
    group by UserID
), part1 as (
    SELECT
        HASHBYTES(''SHA2_256'', COALESCE(CAST(u.[ID] AS VARCHAR(200)), '''')) AS [Buyer_SKey],
        u.[ID] AS [UserID],
        u.[UserName],
        u.[Email],
        u.[Comment],
        upt.[FirstName],
        upt.[LastName],
        u.[PhoneNumber] AS [Phone],
        upt.[Phone] AS [UserPhone],
        upt.[IsInternational],
        upt.[Reg_Reference],
        upt.[Reg_Referral],
        u.[BillingAddressID],
        badd.[Street1] + '' '' + badd.[Street2] AS [BillingAddress],
        badd.[City] AS [BillingCity],
        badd.[StateRegion] AS [BillingState],
        badd.[ZipPostal] AS [BillingPostalCode],
        bc.[Name] AS [BillingCountry],
        u.[PrimaryAddressID],
        padd.[Street1] + '' '' + padd.[Street2] AS [PrimaryAddress],
        padd.[City] AS [PrimaryCity],
        padd.[StateRegion] AS [PrimaryState],
        padd.[ZipPostal] AS [PrimaryPostalCode],
        pc.[Name] AS [PrimaryCountry],
        u.[BillingCreditCardID],
        c.[ExpirationMonth] AS [CreditCardExpirationMonth],
        c.[ExpirationYear] AS [CreditCardExpirationYear],
        c.[LastFourDigits] AS [CreditCardLastFourDigits],
        c.[AddressID] AS [CreditCardAddressID],
        cadd.[Street1] + '' '' + cadd.[Street2] AS [CreditCardAddress],
        cadd.[City] AS [CreditCardCity],
        cadd.[StateRegion] AS [CreditCardState],
        cadd.[ZipPostal] AS [CreditCardPostalCode],
        cc.[Name] AS [CreditCardCountry],
        u.[Culture],
        u.[IsApproved],
        u.[IsLockedOut],
        u.[Newsletter],
        u.[IsVerified],
        u.[IsActive],
        u.[EmailConfirmed],
        u.[LastLoginDate],
        u.[LastActivityDate],
        u.[CreatedOn] AS [CreatedDate],
        u.[UpdatedOn] AS [UpdatedDate],
        u.[DeletedOn] AS [DeletedDate]
    from [stg].[AH_Users_FinalView] u
    left join UserProperties_temp upt on u.ID=upt.UserID
    left join [stg].[AH_CreditCards_FinalView] c on u.BillingCreditCardID=c.ID
    left join [stg].[AH_Addresses_FinalView] badd on badd.ID=u.BillingAddressID
    left join [stg].[AH_Addresses_FinalView] padd on padd.ID=u.PrimaryAddressID
    left join [stg].[AH_Addresses_FinalView] cadd on cadd.ID=c.AddressID
    left join [stg].[AH_Countries_FinalView] bc on  badd.CountryID=bc.ID
    left join [stg].[AH_Countries_FinalView] pc on  padd.CountryID=pc.ID
    left join [stg].[AH_Countries_FinalView] cc on  cadd.CountryID=cc.ID
    where u.ID not in(
        select distinct(OwnerID) from [stg].[AH_Listings_FinalView]
    )
),
part2 as (
    SELECT
        HASHBYTES(''SHA2_256'', COALESCE(CAST(u.[ID] AS VARCHAR(200)), '''')) AS [Buyer_SKey],
        u.[ID] AS [UserID],
        u.[UserName],
        u.[Email],
        u.[Comment],
        upt.[FirstName],
        upt.[LastName],
        u.[PhoneNumber] AS [Phone],
        upt.[Phone] AS [UserPhone],
        upt.[IsInternational],
        upt.[Reg_Reference],
        upt.[Reg_Referral],
        u.[BillingAddressID],
        badd.[Street1] + '' '' + badd.[Street2] AS [BillingAddress],
        badd.[City] AS [BillingCity],
        badd.[StateRegion] AS [BillingState],
        badd.[ZipPostal] AS [BillingPostalCode],
        bc.[Name] AS [BillingCountry],
        u.[PrimaryAddressID],
        padd.[Street1] + '' '' + padd.[Street2] AS [PrimaryAddress],
        padd.[City] AS [PrimaryCity],
        padd.[StateRegion] AS [PrimaryState],
        padd.[ZipPostal] AS [PrimaryPostalCode],
        pc.[Name] AS [PrimaryCountry],
        u.[BillingCreditCardID],
        c.[ExpirationMonth] AS [CreditCardExpirationMonth],
        c.[ExpirationYear] AS [CreditCardExpirationYear],
        c.[LastFourDigits] AS [CreditCardLastFourDigits],
        c.[AddressID] AS [CreditCardAddressID],
        cadd.[Street1] + '' '' + cadd.[Street2] AS [CreditCardAddress],
        cadd.[City] AS [CreditCardCity],
        cadd.[StateRegion] AS [CreditCardState],
        cadd.[ZipPostal] AS [CreditCardPostalCode],
        cc.[Name] AS [CreditCardCountry],
        u.[Culture],
        u.[IsApproved],
        u.[IsLockedOut],
        u.[Newsletter],
        u.[IsVerified],
        u.[IsActive],
        u.[EmailConfirmed],
        u.[LastLoginDate],
        u.[LastActivityDate],
        u.[CreatedOn] AS [CreatedDate],
        u.[UpdatedOn] AS [UpdatedDate],
        u.[DeletedOn] AS [DeletedDate]
    from [stg].[AH_Users_FinalView] u
    left join UserProperties_temp upt on u.ID=upt.UserID
    left join [stg].[AH_CreditCards_FinalView] c on u.BillingCreditCardID=c.ID
    left join [stg].[AH_Addresses_FinalView] badd on badd.ID=u.BillingAddressID
    left join [stg].[AH_Addresses_FinalView] padd on padd.ID=u.PrimaryAddressID
    left join [stg].[AH_Addresses_FinalView] cadd on cadd.ID=c.AddressID
    left join [stg].[AH_Countries_FinalView] bc on  badd.CountryID=bc.ID
    left join [stg].[AH_Countries_FinalView] pc on  padd.CountryID=pc.ID
    left join [stg].[AH_Countries_FinalView] cc on  cadd.CountryID=cc.ID
    where u.ID in(
        select distinct(UserID) from [stg].[AH_ListingActions_FinalView]
        union
        select distinct(UserID) from [stg].[AH_Watches_FinalView]
        union
        select distinct(UserID) from [stg].[AH_ListingComments_FinalView]
    )
)

select
	[Buyer_SKey],
	[UserID],
	[UserName],
	[Email],
	[Comment],
	[FirstName],
	[LastName],
	[Phone],
	[UserPhone],
	[IsInternational],
	[Reg_Reference],
	[Reg_Referral],
	[BillingAddressID],
	[BillingAddress],
	[BillingCity],
	[BillingState],
	[BillingPostalCode],
	[BillingCountry],
	[PrimaryAddressID],
	[PrimaryAddress],
	[PrimaryCity],
	[PrimaryState],
	[PrimaryPostalCode],
	[PrimaryCountry],
	[BillingCreditCardID],
	[CreditCardExpirationMonth],
	[CreditCardExpirationYear],
	[CreditCardLastFourDigits],
	[CreditCardAddressID],
	[CreditCardAddress],
	[CreditCardCity],
	[CreditCardState],
	[CreditCardPostalCode],
	[CreditCardCountry],
	[Culture],
	[IsApproved],
	[IsLockedOut],
	[Newsletter],
	[IsVerified],
	[IsActive],
	[EmailConfirmed],
	[LastLoginDate],
	[LastActivityDate],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from part1 
union all 
select 
	[Buyer_SKey],
	[UserID],
	[UserName],
	[Email],
	[Comment],
	[FirstName],
	[LastName],
	[Phone],
	[UserPhone],
	[IsInternational],
	[Reg_Reference],
	[Reg_Referral],
	[BillingAddressID],
	[BillingAddress],
	[BillingCity],
	[BillingState],
	[BillingPostalCode],
	[BillingCountry],
	[PrimaryAddressID],
	[PrimaryAddress],
	[PrimaryCity],
	[PrimaryState],
	[PrimaryPostalCode],
	[PrimaryCountry],
	[BillingCreditCardID],
	[CreditCardExpirationMonth],
	[CreditCardExpirationYear],
	[CreditCardLastFourDigits],
	[CreditCardAddressID],
	[CreditCardAddress],
	[CreditCardCity],
	[CreditCardState],
	[CreditCardPostalCode],
	[CreditCardCountry],
	[Culture],
	[IsApproved],
	[IsLockedOut],
	[Newsletter],
	[IsVerified],
	[IsActive],
	[EmailConfirmed],
	[LastLoginDate],
	[LastActivityDate],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from part2
    ');

  CREATE TABLE "dbo"."AH_Buyers_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Buyers_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Buyers_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Buyers_DM__dbt_tmp_temp_view"
    end



21:37:42.079889 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:37:42.080028 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:37:42.100558 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Consignors_DM"
21:37:42.101219 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Consignors_DM".
21:37:42.101422 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Consignors_DM: 
  
  if object_id ('"dbo"."AH_Consignors_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Consignors_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Consignors_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Consignors_DM__dbt_tmp"
    end


   EXEC('create view dbo.AH_Consignors_DM__dbt_tmp_temp_view as
    
with UserProperties_temp as (
    select 
        t1.UserID,
        max(case Name when ''FirstName'' then StringNativeValue else NULL end) as FirstName,
        max(case Name when ''LastName'' then StringNativeValue else NULL end) as LastName,
        max(case Name when ''UserPhone'' then StringNativeValue else NULL end) as Phone,
        max(case Name when ''IsInternational'' then cast(EnumNativeValue as varchar(200)) else NULL end) as IsInternational,
        max(case Name when ''Reg_Reference'' then cast(EnumNativeValue as varchar(200)) else NULL end) as Reg_Reference,
        max(case Name when ''Reg_Referral'' then cast(EnumNativeValue as varchar(200)) else NULL end) as Reg_Referral
    from
        (SELECT
            up.*,
            cf.Name
        FROM [stg].[AH_UserProperties_FinalView] AS up
        left JOIN [stg].[AH_CustomFields_FinalView] as cf
            ON cf.[Id] = up.[CustomFieldId]
        where CustomFieldID=''5''
            or CustomFieldID=''6''
            or CustomFieldID=''161098''
            or CustomFieldID=''2407692''
            or CustomFieldID=''2694978''
            or CustomFieldID=''2708864''
        ) t1
    group by UserID
),
DMstg as (
    SELECT
        HASHBYTES(''SHA2_256'', COALESCE(CAST(u.[ID] AS VARCHAR(200)), '''')) as [Consignor_SKey],
        u.[ID] AS [UserID],
        u.[UserName],
        u.[Email],
        u.[Comment],
        upt.[FirstName],
        upt.[LastName],
        u.[PhoneNumber] AS [Phone],
        upt.[Phone] AS [UserPhone],
        upt.[IsInternational],
        upt.[Reg_Reference],
        upt.[Reg_Referral],
        u.[BillingAddressID],
        badd.[Street1] + '' '' + badd.[Street2] AS [BillingAddress],
        badd.[City] AS [BillingCity],
        badd.[StateRegion] AS [BillingState],
        badd.[ZipPostal] AS [BillingPostalCode],
        bc.[Name] AS [BillingCountry],
        u.[PrimaryAddressID],
        padd.[Street1] + '' '' + padd.[Street2] AS [PrimaryAddress],
        padd.[City] AS [PrimaryCity],
        padd.[StateRegion] AS [PrimaryState],
        padd.[ZipPostal] AS [PrimaryPostalCode],
        pc.[Name] AS [PrimaryCountry],
        u.[BillingCreditCardID],
        c.[ExpirationMonth] AS [CreditCardExpirationMonth],
        c.[ExpirationYear] AS [CreditCardExpirationYear],
        c.[LastFourDigits] AS [CreditCardLastFourDigits],
        c.[AddressID] AS [CreditCardAddressID],
        cadd.[Street1] + '' '' + cadd.[Street2] AS [CreditCardAddress],
        cadd.[City] AS [CreditCardCity],
        cadd.[StateRegion] AS [CreditCardState],
        cadd.[ZipPostal] AS [CreditCardPostalCode],
        cc.[Name] AS [CreditCardCountry],
        u.[Culture],
        u.[IsApproved],
        u.[IsLockedOut],
        u.[Newsletter],
        u.[IsVerified],
        u.[IsActive],
        u.[EmailConfirmed],
        u.[LastLoginDate],
        u.[LastActivityDate],
        u.[CreatedOn] AS [CreatedDate],
        u.[UpdatedOn] AS [UpdatedDate],
        u.[DeletedOn] AS [DeletedDate]
    from [stg].[AH_Users_FinalView] u
    left join UserProperties_temp upt on u.ID=upt.UserID
    left join [stg].[AH_CreditCards_FinalView] c on u.BillingCreditCardID=c.ID
    left join [stg].[AH_Addresses_FinalView] badd on badd.ID=u.BillingAddressID
    left join [stg].[AH_Addresses_FinalView] padd on padd.ID=u.PrimaryAddressID
    left join [stg].[AH_Addresses_FinalView] cadd on cadd.ID=c.AddressID
    left join [stg].[AH_Countries_FinalView] bc on  badd.CountryID=bc.ID
    left join [stg].[AH_Countries_FinalView] pc on  padd.CountryID=pc.ID
    left join [stg].[AH_Countries_FinalView] cc on  cadd.CountryID=cc.ID
    where u.ID in(
        select distinct(OwnerID) from [stg].[AH_Listings_FinalView]
    )
)
SELECT
	[Consignor_SKey],
    [UserID],
	[UserName],
	[Email],
	[Comment],
	[FirstName],
	[LastName],
	[Phone],
	[UserPhone],
	[IsInternational],
	[Reg_Reference],
	[Reg_Referral],
	[BillingAddressID],
	[BillingAddress],
	[BillingCity],
	[BillingState],
	[BillingPostalCode],
	[BillingCountry],
	[PrimaryAddressID],
	[PrimaryAddress],
	[PrimaryCity],
	[PrimaryState],
	[PrimaryPostalCode],
	[PrimaryCountry],
	[BillingCreditCardID],
	[CreditCardExpirationMonth],
	[CreditCardExpirationYear],
	[CreditCardLastFourDigits],
	[CreditCardAddressID],
	[CreditCardAddress],
	[CreditCardCity],
	[CreditCardState],
	[CreditCardPostalCode],
	[CreditCardCountry],
	[Culture],
	[IsApproved],
	[IsLockedOut],
	[Newsletter],
	[IsVerified],
	[IsActive],
	[EmailConfirmed],
	[LastLoginDate],
	[LastActivityDate],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from DMstg
    ');

  CREATE TABLE "dbo"."AH_Consignors_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Consignors_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Consignors_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Consignors_DM__dbt_tmp_temp_view"
    end



21:37:42.101586 [debug] [Thread-3  ]: Opening a new connection, currently in state init
21:37:42.101738 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:37:42.218313 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:37:42.222528 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:37:42.225216 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:37:42.226251 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:37:44.085057 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.01 seconds
21:37:44.104401 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies_DM".
21:37:44.104738 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Currencies_DM: rename object "dbo"."AH_Currencies_DM" to AH_Currencies_DM__dbt_backup
21:37:44.217561 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:37:44.231692 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies_DM".
21:37:44.232034 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Currencies_DM: rename object "dbo"."AH_Currencies_DM__dbt_tmp" to AH_Currencies_DM
21:37:44.264825 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:37:44.276414 [debug] [Thread-4  ]: On model.Shawn.AH_Currencies_DM: COMMIT
21:37:44.283287 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies_DM".
21:37:44.283623 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Currencies_DM: 
    
  if object_id ('"dbo"."AH_Currencies_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Currencies_DM__dbt_backup"
    end

21:37:44.607929 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.53 seconds
21:37:44.623604 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories_DM".
21:37:44.623969 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories_DM: rename object "dbo"."AH_Categories_DM" to AH_Categories_DM__dbt_backup
21:37:44.661679 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:37:44.675898 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories_DM".
21:37:44.676243 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories_DM: rename object "dbo"."AH_Categories_DM__dbt_tmp" to AH_Categories_DM
21:37:44.694346 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
21:37:44.707404 [debug] [Thread-4  ]: finished collecting timing info
21:37:44.707658 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:37:44.709356 [debug] [Thread-2  ]: On model.Shawn.AH_Categories_DM: COMMIT
21:37:44.712934 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories_DM".
21:37:44.707936 [debug] [Thread-4  ]: On model.Shawn.AH_Currencies_DM: Close
21:37:44.714039 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a85326d-5386-419f-90c0-da3e30100d73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd245bb1b80>]}
21:37:44.714479 [info ] [Thread-4  ]: 4 of 5 OK created table model dbo.AH_Currencies_DM.............................. [[32mOK[0m in 2.84s]
21:37:44.714894 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Currencies_DM
21:37:44.715080 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ShippingOptions_DM
21:37:44.715406 [info ] [Thread-4  ]: 5 of 5 START table model dbo.AH_ShippingOptions_DM.............................. [RUN]
21:37:44.715836 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ShippingOptions_DM"
21:37:44.716002 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ShippingOptions_DM
21:37:44.716140 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ShippingOptions_DM
21:37:44.713157 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories_DM: 
    
  if object_id ('"dbo"."AH_Categories_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Categories_DM__dbt_backup"
    end

21:37:44.718594 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ShippingOptions_DM"
21:37:44.719260 [debug] [Thread-4  ]: finished collecting timing info
21:37:44.719422 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ShippingOptions_DM
21:37:44.754916 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ShippingOptions_DM"
21:37:44.755574 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions_DM".
21:37:44.755769 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions_DM: 
  
  if object_id ('"dbo"."AH_ShippingOptions_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ShippingOptions_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ShippingOptions_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ShippingOptions_DM__dbt_tmp"
    end


   EXEC('create view dbo.AH_ShippingOptions_DM__dbt_tmp_temp_view as
    
SELECT
	so.[Id] AS [ShippingOptionID],
	so.[ShippingMethodId] AS [ShippingMethodID],
	sm.[Name] AS [ShippingMethod],
	so.[FirstItemAmount],
	so.[ListingId] AS [ListingID],
	so.[AdditionalItemAmount],
	so.[CreatedOn] AS [CreatedDate],
	so.[UpdatedOn] AS [UpdatedDate],
	so.[DeletedOn] AS [DeletedDate]
From
	[stg].[AH_ShippingOptions_FinalView] AS so
left JOIN [stg].[AH_ShippingMethods_FinalView] AS sm 
on so.ShippingMethodID=sm.ID
    ');

  CREATE TABLE "dbo"."AH_ShippingOptions_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ShippingOptions_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ShippingOptions_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ShippingOptions_DM__dbt_tmp_temp_view"
    end



21:37:44.755889 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:37:44.756029 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:37:44.858188 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:37:44.925458 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:37:44.939634 [debug] [Thread-2  ]: finished collecting timing info
21:37:44.940027 [debug] [Thread-2  ]: On model.Shawn.AH_Categories_DM: Close
21:37:44.940744 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a85326d-5386-419f-90c0-da3e30100d73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd245c10070>]}
21:37:44.941213 [info ] [Thread-2  ]: 2 of 5 OK created table model dbo.AH_Categories_DM.............................. [[32mOK[0m in 3.06s]
21:37:44.941588 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Categories_DM
21:37:47.063651 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.31 seconds
21:37:47.079041 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions_DM".
21:37:47.079396 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions_DM: rename object "dbo"."AH_ShippingOptions_DM" to AH_ShippingOptions_DM__dbt_backup
21:37:47.114702 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:37:47.129544 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions_DM".
21:37:47.129903 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions_DM: rename object "dbo"."AH_ShippingOptions_DM__dbt_tmp" to AH_ShippingOptions_DM
21:37:47.181639 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:37:47.183934 [debug] [Thread-4  ]: On model.Shawn.AH_ShippingOptions_DM: COMMIT
21:37:47.188006 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions_DM".
21:37:47.188233 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions_DM: 
    
  if object_id ('"dbo"."AH_ShippingOptions_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ShippingOptions_DM__dbt_backup"
    end

21:37:47.485808 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:37:47.499669 [debug] [Thread-4  ]: finished collecting timing info
21:37:47.500092 [debug] [Thread-4  ]: On model.Shawn.AH_ShippingOptions_DM: Close
21:37:47.500811 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a85326d-5386-419f-90c0-da3e30100d73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd24434bfa0>]}
21:37:47.501305 [info ] [Thread-4  ]: 5 of 5 OK created table model dbo.AH_ShippingOptions_DM......................... [[32mOK[0m in 2.79s]
21:37:47.501672 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ShippingOptions_DM
21:37:49.157939 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 7.06 seconds
21:37:49.173943 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Consignors_DM".
21:37:49.174300 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Consignors_DM: rename object "dbo"."AH_Consignors_DM" to AH_Consignors_DM__dbt_backup
21:37:49.211829 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:37:49.227095 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Consignors_DM".
21:37:49.227452 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Consignors_DM: rename object "dbo"."AH_Consignors_DM__dbt_tmp" to AH_Consignors_DM
21:37:49.272203 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:37:49.274147 [debug] [Thread-3  ]: On model.Shawn.AH_Consignors_DM: COMMIT
21:37:49.278620 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Consignors_DM".
21:37:49.278858 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Consignors_DM: 
    
  if object_id ('"dbo"."AH_Consignors_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Consignors_DM__dbt_backup"
    end

21:37:49.531603 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:37:49.544694 [debug] [Thread-3  ]: finished collecting timing info
21:37:49.545091 [debug] [Thread-3  ]: On model.Shawn.AH_Consignors_DM: Close
21:37:49.545858 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a85326d-5386-419f-90c0-da3e30100d73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd245b81970>]}
21:37:49.546338 [info ] [Thread-3  ]: 3 of 5 OK created table model dbo.AH_Consignors_DM.............................. [[32mOK[0m in 7.66s]
21:37:49.546733 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Consignors_DM
21:37:54.205425 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 12.13 seconds
21:37:54.220199 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Buyers_DM".
21:37:54.220538 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Buyers_DM: rename object "dbo"."AH_Buyers_DM" to AH_Buyers_DM__dbt_backup
21:37:54.315043 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:37:54.329561 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Buyers_DM".
21:37:54.329923 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Buyers_DM: rename object "dbo"."AH_Buyers_DM__dbt_tmp" to AH_Buyers_DM
21:37:54.361836 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:37:54.363802 [debug] [Thread-1  ]: On model.Shawn.AH_Buyers_DM: COMMIT
21:37:54.368517 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Buyers_DM".
21:37:54.368760 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Buyers_DM: 
    
  if object_id ('"dbo"."AH_Buyers_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Buyers_DM__dbt_backup"
    end

21:37:54.628411 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:37:54.642216 [debug] [Thread-1  ]: finished collecting timing info
21:37:54.642653 [debug] [Thread-1  ]: On model.Shawn.AH_Buyers_DM: Close
21:37:54.643441 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a85326d-5386-419f-90c0-da3e30100d73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd245b98f40>]}
21:37:54.643932 [info ] [Thread-1  ]: 1 of 5 OK created table model dbo.AH_Buyers_DM.................................. [[32mOK[0m in 12.77s]
21:37:54.644298 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Buyers_DM
21:37:54.645789 [debug] [MainThread]: Acquiring new synapse connection "master"
21:37:54.646095 [debug] [MainThread]: On master: COMMIT
21:37:54.646439 [info ] [MainThread]: 
21:37:54.646736 [info ] [MainThread]: Finished running 5 table models in 35.91s.
21:37:54.646939 [debug] [MainThread]: Connection 'master' was properly closed.
21:37:54.647043 [debug] [MainThread]: Connection 'model.Shawn.AH_Buyers_DM' was properly closed.
21:37:54.647136 [debug] [MainThread]: Connection 'model.Shawn.AH_Categories_DM' was properly closed.
21:37:54.647224 [debug] [MainThread]: Connection 'model.Shawn.AH_ShippingOptions_DM' was properly closed.
21:37:54.647309 [debug] [MainThread]: Connection 'model.Shawn.AH_Consignors_DM' was properly closed.
21:37:54.748671 [info ] [MainThread]: 
21:37:54.749096 [info ] [MainThread]: [32mCompleted successfully[0m
21:37:54.749393 [info ] [MainThread]: 
21:37:54.749579 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
21:37:54.749980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd245c6cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd245ca2fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2479fcc70>]}


============================== 2022-09-18 21:37:57.022993 | 2ffb2b79-fdaf-43fb-8803-9ec6ddb2a209 ==============================
21:37:57.022993 [info ] [MainThread]: Running with dbt=1.0.0
21:37:57.023655 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step6_FT_1_stg'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
21:37:57.023885 [debug] [MainThread]: Tracking: tracking
21:37:57.024218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133aa81dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133aa81d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133aa81f10>]}
21:37:57.220476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:37:57.220853 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:37:57.246723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ffb2b79-fdaf-43fb-8803-9ec6ddb2a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133aa07370>]}
21:37:57.294456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ffb2b79-fdaf-43fb-8803-9ec6ddb2a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133ca49940>]}
21:37:57.294960 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:37:57.303223 [info ] [MainThread]: 
21:37:57.303896 [debug] [MainThread]: Acquiring new synapse connection "master"
21:37:57.305200 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
21:37:57.314366 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
21:37:57.314651 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
21:37:57.314797 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:37:57.314943 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:37:57.600867 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:37:57.628777 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.31 seconds
21:37:57.630810 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
21:37:57.652631 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
21:37:57.658767 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
21:37:57.659216 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
21:37:57.661038 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
21:37:57.661250 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
21:37:57.661372 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:37:57.661503 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:37:57.659522 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
21:37:57.663117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:37:57.663291 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:37:57.760554 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:37:57.761745 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:37:57.802330 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:37:57.806007 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:37:57.852326 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
21:37:57.918860 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
21:37:58.001822 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
21:37:58.015695 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
21:38:19.717289 [debug] [MainThread]: On master: COMMIT
21:38:19.717921 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
21:38:19.718244 [info ] [MainThread]: 
21:38:19.721865 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Invoices_FT_stg
21:38:19.722104 [debug] [Thread-2  ]: Began running node model.Shawn.AH_LineItems_FT_stg
21:38:19.722779 [info ] [Thread-2  ]: 2 of 6 START table model stg.AH_LineItems_FT_stg................................ [RUN]
21:38:19.723233 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_LineItems_FT_stg"
21:38:19.723400 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_LineItems_FT_stg
21:38:19.723567 [debug] [Thread-2  ]: Compiling model.Shawn.AH_LineItems_FT_stg
21:38:19.726362 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_LineItems_FT_stg"
21:38:19.722489 [info ] [Thread-1  ]: 1 of 6 START table model stg.AH_Invoices_FT_stg................................. [RUN]
21:38:19.726981 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Invoices_FT_stg"
21:38:19.727139 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Invoices_FT_stg
21:38:19.727268 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Invoices_FT_stg
21:38:19.729667 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Invoices_FT_stg"
21:38:19.722200 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingActions_FT_stg
21:38:19.730162 [info ] [Thread-3  ]: 3 of 6 START table model stg.AH_ListingActions_FT_stg........................... [RUN]
21:38:19.730614 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingActions_FT_stg"
21:38:19.730774 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingActions_FT_stg
21:38:19.730896 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingActions_FT_stg
21:38:19.733072 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingActions_FT_stg"
21:38:19.722273 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingPaymentCharge_FT_stg
21:38:19.733634 [info ] [Thread-4  ]: 4 of 6 START table model stg.AH_ListingPaymentCharge_FT_stg..................... [RUN]
21:38:19.734052 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_stg"
21:38:19.734199 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingPaymentCharge_FT_stg
21:38:19.734315 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingPaymentCharge_FT_stg
21:38:19.736926 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingPaymentCharge_FT_stg"
21:38:19.737154 [debug] [Thread-1  ]: finished collecting timing info
21:38:19.737710 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Invoices_FT_stg
21:38:19.737479 [debug] [Thread-3  ]: finished collecting timing info
21:38:19.743962 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingActions_FT_stg
21:38:19.743839 [debug] [Thread-4  ]: finished collecting timing info
21:38:19.766438 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingPaymentCharge_FT_stg
21:38:19.737250 [debug] [Thread-2  ]: finished collecting timing info
21:38:19.767994 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_LineItems_FT_stg
21:38:20.014388 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingActions_FT_stg"
21:38:20.020143 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_LineItems_FT_stg"
21:38:20.030413 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_stg".
21:38:20.030838 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_stg: 
  
  if object_id ('"stg"."AH_LineItems_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LineItems_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_LineItems_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_LineItems_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_LineItems_FT_stg__dbt_tmp_temp_view as
    
SELECT
		[Id] AS [LineItemsID],
		[OwnerId] AS [OwnerID],
		[PayerId] AS [PayerID],
		[InvoiceId] AS [InvoiceID],
		[ListingId] AS [ListingID],
		[Description],
		[LastUpdatedUser],
		[Currency],
		[Status],
		[Type],
		[TotalAmount],
		[Quantity] AS [QTY],
		[PerUnitAmount],
		[Taxable] AS [IsTaxable],
		[IsArchived],
		[Relistiteration],
		[BuyersPremiumApplies] AS [HasBuyerPremiumApplies],
		[IsPayerArchived],
		[DateStamp],
		[CreatedOn] AS [CreatedDate],
		[UpdatedOn] AS [UpdatedDate],
		[DeletedOn] AS [DeletedDate]
FROM [stg].[AH_LineItems_FinalView];
    ');

  CREATE TABLE "stg"."AH_LineItems_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_LineItems_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_LineItems_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LineItems_FT_stg__dbt_tmp_temp_view"
    end



21:38:20.030977 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:38:20.031119 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:38:20.030736 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_stg".
21:38:20.032602 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_stg: 
  
  if object_id ('"stg"."AH_ListingActions_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActions_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_ListingActions_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingActions_FT_stg__dbt_tmp_temp_view as
    
SELECT
		[Id] AS [ListingActionID],
		[UserId] AS [UserID],
		[ListingId] AS [ListingID],
		[ActionDTTM],
		[Description],
		[LastUpdatedUser],
		[Amount],
		[ProxyAmount],
		[Quantity] AS [QTY],
		[Reason],
		[Status],
		[UserEntered] AS [HasUserEntered],
		[CreatedOn] AS [CreatedDate],
		[UpdatedOn] AS [UpdatedDate],
		[DeletedOn] AS [DeletedDate]
FROM [stg].[AH_ListingActions_FinalView];
    ');

  CREATE TABLE "stg"."AH_ListingActions_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingActions_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingActions_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActions_FT_stg__dbt_tmp_temp_view"
    end



21:38:20.032748 [debug] [Thread-3  ]: Opening a new connection, currently in state init
21:38:20.032875 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:38:20.025236 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Invoices_FT_stg"
21:38:20.034281 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_stg".
21:38:20.034434 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_stg: 
  
  if object_id ('"stg"."AH_Invoices_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Invoices_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_Invoices_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_Invoices_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_Invoices_FT_stg__dbt_tmp_temp_view as
    
SELECT
	[Id] AS [InvoiceID],
	[PayerId] AS [PayerID],
	[OwnerId] AS [OwnerID],
	[CreatedOn] AS [CreatedDate],
	[UpdatedOn] AS [UpdatedDate],
	[DeletedOn] AS [DeletedDate],
	[Status],
	[CreatedDTTM],
	[FulfilledDTTM],
	[Comments] AS [Comment],
	[LastUpdatedUser],
	[Currency],
	[Type],
	[ShippingAmount],
	[Subtotal],
	[Total],
	[ShippingFirstName],
	[ShippingLastName],
	[ShippingStreet1],
	[ShippingStreet2],
	[ShippingCity],
	[ShippingStateRegion] AS [ShippingState],
	[ShippingZipPostal] AS [ShippingPostalCode],
	[ShippingCountry],
	[BIllingFIrstName] AS [BillingFIrstName],
	[BillingLastName],
	[BillingStreet1],
	[BillingStreet2],
	[BillingCity],
	[BillingStateRegion] AS [BillingState],
	[BillingZIpPostal] AS [BillingPostalCode],
	[BillingCountry],
	[SalesTax],
	[PaidDTTM],
	[IsPayerLocked],
	[Shipped] AS [HasShipped],
	[ShippingDetails],
	[BuyersPremiumPercent] AS [BuyerPremiumPct],
	[BuyersPremiumAmount] AS [BuyerPremiumAmount],
	[IsArchived]
FROM [stg].[AH_Invoices_FinalView];
    ');

  CREATE TABLE "stg"."AH_Invoices_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Invoices_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Invoices_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Invoices_FT_stg__dbt_tmp_temp_view"
    end



21:38:20.034585 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:38:20.034727 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:38:20.029696 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingPaymentCharge_FT_stg"
21:38:20.036023 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_stg".
21:38:20.036178 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_stg: 
  
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view as
    
SELECT
		[Id] AS [ListingPaymentChargeID],
		[BuyerId],
		[ListingId] AS [ListingID],
		[ChargeAmount],
		[TotalBid],
		[BidHoldPercentage],
		[MaximumBidCharge],
		[TransactionId] AS [TransactionID],
		[CreatedOn] AS [CreatedDate],
		[UpdatedOn] AS [UpdatedDate]
FROM stg.AH_ListingPaymentCharge_FinalView;
    ');

  CREATE TABLE "stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view"
    end



21:38:20.036291 [debug] [Thread-4  ]: Opening a new connection, currently in state init
21:38:20.036413 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:38:20.157655 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:38:20.158874 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:38:20.166299 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:38:20.168297 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:38:23.435386 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.40 seconds
21:38:23.454758 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_stg".
21:38:23.455095 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_stg: rename object "stg"."AH_LineItems_FT_stg" to AH_LineItems_FT_stg__dbt_backup
21:38:23.496677 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:38:23.511292 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_stg".
21:38:23.511623 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_stg: rename object "stg"."AH_LineItems_FT_stg__dbt_tmp" to AH_LineItems_FT_stg
21:38:23.564051 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:38:23.575093 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT_stg: COMMIT
21:38:23.581981 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_stg".
21:38:23.582326 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_stg: 
    
  if object_id ('"stg"."AH_LineItems_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_LineItems_FT_stg__dbt_backup"
    end

21:38:23.603973 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.57 seconds
21:38:23.619447 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_stg".
21:38:23.619809 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_stg: rename object "stg"."AH_Invoices_FT_stg" to AH_Invoices_FT_stg__dbt_backup
21:38:23.636412 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.60 seconds
21:38:23.651290 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_stg".
21:38:23.651523 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:38:23.651749 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_stg: rename object "stg"."AH_ListingPaymentCharge_FT_stg" to AH_ListingPaymentCharge_FT_stg__dbt_backup
21:38:23.664581 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_stg".
21:38:23.664884 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_stg: rename object "stg"."AH_Invoices_FT_stg__dbt_tmp" to AH_Invoices_FT_stg
21:38:23.694742 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:38:23.696028 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:38:23.708339 [debug] [Thread-1  ]: On model.Shawn.AH_Invoices_FT_stg: COMMIT
21:38:23.710780 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_stg".
21:38:23.714493 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_stg: rename object "stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp" to AH_ListingPaymentCharge_FT_stg
21:38:23.714247 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_stg".
21:38:23.714856 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_stg: 
    
  if object_id ('"stg"."AH_Invoices_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_Invoices_FT_stg__dbt_backup"
    end

21:38:23.759757 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:38:23.761697 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT_stg: COMMIT
21:38:23.765871 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_stg".
21:38:23.766067 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_stg: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_FT_stg__dbt_backup"
    end

21:38:23.779024 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:38:23.791666 [debug] [Thread-2  ]: finished collecting timing info
21:38:23.792036 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT_stg: Close
21:38:23.792744 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ffb2b79-fdaf-43fb-8803-9ec6ddb2a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1338543e50>]}
21:38:23.793216 [info ] [Thread-2  ]: 2 of 6 OK created table model stg.AH_LineItems_FT_stg........................... [[32mOK[0m in 4.07s]
21:38:23.793586 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_LineItems_FT_stg
21:38:23.793772 [debug] [Thread-2  ]: Began running node model.Shawn.AH_SubmittedListingPayment_FT_stg
21:38:23.794103 [info ] [Thread-2  ]: 5 of 6 START table model stg.AH_SubmittedListingPayment_FT_stg.................. [RUN]
21:38:23.794518 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_stg"
21:38:23.794704 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_SubmittedListingPayment_FT_stg
21:38:23.794842 [debug] [Thread-2  ]: Compiling model.Shawn.AH_SubmittedListingPayment_FT_stg
21:38:23.797412 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_SubmittedListingPayment_FT_stg"
21:38:23.797822 [debug] [Thread-2  ]: finished collecting timing info
21:38:23.797976 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_SubmittedListingPayment_FT_stg
21:38:23.860238 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_SubmittedListingPayment_FT_stg"
21:38:23.860940 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_stg".
21:38:23.861146 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_stg: 
  
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view as
    
SELECT
		[Id] AS [SubmittedListingPaymentID],
		[ConsignorId] AS [UserID],
		[ListingId] AS [ListingID],
		[Amount],
		[HasProPhotography],
		[HasProMarketing],
		[TransactionId] AS [TransactionID],
		[CreatedOn] AS [CreatedDate],
		[UpdatedOn] AS [UpdatedDate]
FROM [stg].[AH_SubmittedListingPayment_FinalView];
    ');

  CREATE TABLE "stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view"
    end



21:38:23.861269 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:38:23.861414 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:38:23.934528 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:38:23.950484 [debug] [Thread-1  ]: finished collecting timing info
21:38:23.950926 [debug] [Thread-1  ]: On model.Shawn.AH_Invoices_FT_stg: Close
21:38:23.951640 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ffb2b79-fdaf-43fb-8803-9ec6ddb2a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1338610820>]}
21:38:23.952137 [info ] [Thread-1  ]: 1 of 6 OK created table model stg.AH_Invoices_FT_stg............................ [[32mOK[0m in 4.22s]
21:38:23.952503 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Invoices_FT_stg
21:38:23.952683 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Watches_FT_stg
21:38:23.953022 [info ] [Thread-1  ]: 6 of 6 START table model stg.AH_Watches_FT_stg.................................. [RUN]
21:38:23.953440 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Watches_FT_stg"
21:38:23.953594 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Watches_FT_stg
21:38:23.953728 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Watches_FT_stg
21:38:23.956303 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Watches_FT_stg"
21:38:23.956717 [debug] [Thread-1  ]: finished collecting timing info
21:38:23.956874 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Watches_FT_stg
21:38:23.978295 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:38:23.978690 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:38:24.010741 [debug] [Thread-4  ]: finished collecting timing info
21:38:24.011139 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT_stg: Close
21:38:24.011901 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ffb2b79-fdaf-43fb-8803-9ec6ddb2a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1338545bb0>]}
21:38:24.012393 [info ] [Thread-4  ]: 4 of 6 OK created table model stg.AH_ListingPaymentCharge_FT_stg................ [[32mOK[0m in 4.28s]
21:38:24.012762 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingPaymentCharge_FT_stg
21:38:24.034206 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Watches_FT_stg"
21:38:24.035010 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_stg".
21:38:24.035235 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_stg: 
  
  if object_id ('"stg"."AH_Watches_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Watches_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_Watches_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_Watches_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_Watches_FT_stg__dbt_tmp_temp_view as
    
SELECT
		[Id] AS [WatchID],
		[UserId] AS [UserID],
		[ListingId] AS [ListingID],
		[LastUpdatedUser],
		[CreatedOn] AS [CreatedDate],
		[UpdatedOn] AS [UpdatedDate],
		[DeletedOn] AS [DeletedDate]
From [stg].[AH_Watches_FinalView]
    ');

  CREATE TABLE "stg"."AH_Watches_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Watches_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Watches_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Watches_FT_stg__dbt_tmp_temp_view"
    end



21:38:24.035365 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:38:24.035511 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:38:24.148478 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:38:26.011681 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.15 seconds
21:38:26.026058 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_stg".
21:38:26.026400 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_stg: rename object "stg"."AH_SubmittedListingPayment_FT_stg" to AH_SubmittedListingPayment_FT_stg__dbt_backup
21:38:26.057234 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:38:26.072041 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_stg".
21:38:26.072370 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_stg: rename object "stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp" to AH_SubmittedListingPayment_FT_stg
21:38:26.104653 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:38:26.106589 [debug] [Thread-2  ]: On model.Shawn.AH_SubmittedListingPayment_FT_stg: COMMIT
21:38:26.110622 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_stg".
21:38:26.110832 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_stg: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_FT_stg__dbt_backup"
    end

21:38:26.312714 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:38:26.386899 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.35 seconds
21:38:26.389612 [debug] [Thread-2  ]: finished collecting timing info
21:38:26.399683 [debug] [Thread-2  ]: On model.Shawn.AH_SubmittedListingPayment_FT_stg: Close
21:38:26.400384 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ffb2b79-fdaf-43fb-8803-9ec6ddb2a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13384e0850>]}
21:38:26.400842 [info ] [Thread-2  ]: 5 of 6 OK created table model stg.AH_SubmittedListingPayment_FT_stg............. [[32mOK[0m in 2.61s]
21:38:26.401192 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_SubmittedListingPayment_FT_stg
21:38:26.402753 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_stg".
21:38:26.402937 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_stg: rename object "stg"."AH_ListingActions_FT_stg" to AH_ListingActions_FT_stg__dbt_backup
21:38:26.435707 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:38:26.449148 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_stg".
21:38:26.449489 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_stg: rename object "stg"."AH_ListingActions_FT_stg__dbt_tmp" to AH_ListingActions_FT_stg
21:38:26.481513 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:38:26.483662 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT_stg: COMMIT
21:38:26.487437 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_stg".
21:38:26.487633 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_stg: 
    
  if object_id ('"stg"."AH_ListingActions_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_FT_stg__dbt_backup"
    end

21:38:26.720048 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:38:26.732634 [debug] [Thread-3  ]: finished collecting timing info
21:38:26.733021 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT_stg: Close
21:38:26.733778 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ffb2b79-fdaf-43fb-8803-9ec6ddb2a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13387a5160>]}
21:38:26.734242 [info ] [Thread-3  ]: 3 of 6 OK created table model stg.AH_ListingActions_FT_stg...................... [[32mOK[0m in 7.00s]
21:38:26.734628 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingActions_FT_stg
21:38:27.326462 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.29 seconds
21:38:27.340336 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_stg".
21:38:27.340667 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_stg: rename object "stg"."AH_Watches_FT_stg" to AH_Watches_FT_stg__dbt_backup
21:38:27.373903 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:38:27.387536 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_stg".
21:38:27.387893 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_stg: rename object "stg"."AH_Watches_FT_stg__dbt_tmp" to AH_Watches_FT_stg
21:38:27.431551 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:38:27.433528 [debug] [Thread-1  ]: On model.Shawn.AH_Watches_FT_stg: COMMIT
21:38:27.437952 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_stg".
21:38:27.438179 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_stg: 
    
  if object_id ('"stg"."AH_Watches_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_Watches_FT_stg__dbt_backup"
    end

21:38:27.679012 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:38:27.691498 [debug] [Thread-1  ]: finished collecting timing info
21:38:27.691890 [debug] [Thread-1  ]: On model.Shawn.AH_Watches_FT_stg: Close
21:38:27.692647 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ffb2b79-fdaf-43fb-8803-9ec6ddb2a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13383ebf10>]}
21:38:27.693109 [info ] [Thread-1  ]: 6 of 6 OK created table model stg.AH_Watches_FT_stg............................. [[32mOK[0m in 3.74s]
21:38:27.693495 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Watches_FT_stg
21:38:27.694982 [debug] [MainThread]: Acquiring new synapse connection "master"
21:38:27.695279 [debug] [MainThread]: On master: COMMIT
21:38:27.695622 [info ] [MainThread]: 
21:38:27.695869 [info ] [MainThread]: Finished running 6 table models in 30.39s.
21:38:27.696067 [debug] [MainThread]: Connection 'master' was properly closed.
21:38:27.696174 [debug] [MainThread]: Connection 'model.Shawn.AH_Watches_FT_stg' was properly closed.
21:38:27.696271 [debug] [MainThread]: Connection 'model.Shawn.AH_SubmittedListingPayment_FT_stg' was properly closed.
21:38:27.696361 [debug] [MainThread]: Connection 'model.Shawn.AH_ListingActions_FT_stg' was properly closed.
21:38:27.696450 [debug] [MainThread]: Connection 'model.Shawn.AH_ListingPaymentCharge_FT_stg' was properly closed.
21:38:27.723858 [info ] [MainThread]: 
21:38:27.724220 [info ] [MainThread]: [32mCompleted successfully[0m
21:38:27.724515 [info ] [MainThread]: 
21:38:27.724701 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
21:38:27.724998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133ca49cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133aa07700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1338578f10>]}


============================== 2022-09-18 21:38:30.157434 | d7ed67b9-456f-467a-8573-e04eae1e72b7 ==============================
21:38:30.157434 [info ] [MainThread]: Running with dbt=1.0.0
21:38:30.162838 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step6_FT_2_tmp'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
21:38:30.163119 [debug] [MainThread]: Tracking: tracking
21:38:30.163459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57e079ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57e079aeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57e079af10>]}
21:38:30.355601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:38:30.355981 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:38:30.381830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7ed67b9-456f-467a-8573-e04eae1e72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57e071e2b0>]}
21:38:30.431147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7ed67b9-456f-467a-8573-e04eae1e72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57e2764880>]}
21:38:30.431653 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:38:30.440300 [info ] [MainThread]: 
21:38:30.441072 [debug] [MainThread]: Acquiring new synapse connection "master"
21:38:30.442421 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
21:38:30.451579 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
21:38:30.451903 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
21:38:30.452047 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:38:30.452196 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:38:30.734162 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:38:30.763453 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.31 seconds
21:38:30.765693 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
21:38:30.788123 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
21:38:30.794369 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
21:38:30.795019 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
21:38:30.796971 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
21:38:30.797192 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
21:38:30.797312 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:38:30.797444 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:38:30.795367 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
21:38:30.798834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:38:30.799339 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:38:30.901993 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:38:30.902795 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:38:30.946993 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:38:30.956572 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:38:31.102247 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
21:38:31.112353 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
21:38:31.131066 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
21:38:31.139842 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
21:38:52.731518 [debug] [MainThread]: On master: COMMIT
21:38:52.732177 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
21:38:52.732514 [info ] [MainThread]: 
21:38:52.736720 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Invoices_FT_tmp
21:38:52.737356 [info ] [Thread-1  ]: 1 of 6 START table model stg.AH_Invoices_FT_tmp................................. [RUN]
21:38:52.737853 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Invoices_FT_tmp"
21:38:52.738023 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Invoices_FT_tmp
21:38:52.738177 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Invoices_FT_tmp
21:38:52.737054 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingActions_FT_tmp
21:38:52.741392 [info ] [Thread-3  ]: 3 of 6 START table model stg.AH_ListingActions_FT_tmp........................... [RUN]
21:38:52.741843 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingActions_FT_tmp"
21:38:52.741999 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingActions_FT_tmp
21:38:52.742127 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingActions_FT_tmp
21:38:52.744497 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingActions_FT_tmp"
21:38:52.736961 [debug] [Thread-2  ]: Began running node model.Shawn.AH_LineItems_FT_tmp
21:38:52.744858 [info ] [Thread-2  ]: 2 of 6 START table model stg.AH_LineItems_FT_tmp................................ [RUN]
21:38:52.745263 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_LineItems_FT_tmp"
21:38:52.745410 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_LineItems_FT_tmp
21:38:52.745534 [debug] [Thread-2  ]: Compiling model.Shawn.AH_LineItems_FT_tmp
21:38:52.737127 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingPaymentCharge_FT_tmp
21:38:52.748090 [info ] [Thread-4  ]: 4 of 6 START table model stg.AH_ListingPaymentCharge_FT_tmp..................... [RUN]
21:38:52.748505 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_tmp"
21:38:52.748653 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingPaymentCharge_FT_tmp
21:38:52.748769 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingPaymentCharge_FT_tmp
21:38:52.751435 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingPaymentCharge_FT_tmp"
21:38:52.741079 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Invoices_FT_tmp"
21:38:52.752258 [debug] [Thread-1  ]: finished collecting timing info
21:38:52.752411 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Invoices_FT_tmp
21:38:52.747793 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_LineItems_FT_tmp"
21:38:52.751904 [debug] [Thread-3  ]: finished collecting timing info
21:38:52.760174 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingActions_FT_tmp
21:38:52.759871 [debug] [Thread-4  ]: finished collecting timing info
21:38:52.793881 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingPaymentCharge_FT_tmp
21:38:52.777905 [debug] [Thread-2  ]: finished collecting timing info
21:38:52.835173 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_LineItems_FT_tmp
21:38:53.017095 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingActions_FT_tmp"
21:38:53.030379 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingPaymentCharge_FT_tmp"
21:38:53.041426 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_tmp".
21:38:53.041806 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: 
  
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		lpc.[ListingPaymentChargeID],
		b.[Buyer_Skey],
		lpc.[BuyerId],
		lpc.[ListingID],
		lpc.[ChargeAmount],
		lpc.[TotalBid],
		lpc.[BidHoldPercentage],
		lpc.[MaximumBidCharge],
		lpc.[TransactionID],
		lpc.[CreatedDate],
		lpc.[UpdatedDate]
FROM 	[stg].[AH_ListingPaymentCharge_FT_stg] lpc
left join [dbo].[AH_Buyers_DM] b on lpc.BuyerId=b.UserID
    ');

  CREATE TABLE "stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view"
    end



21:38:53.041943 [debug] [Thread-4  ]: Opening a new connection, currently in state init
21:38:53.042091 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:38:53.041709 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_tmp".
21:38:53.042669 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_tmp: 
  
  if object_id ('"stg"."AH_ListingActions_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActions_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_ListingActions_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingActions_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		la.[ListingActionID],
		b.[Buyer_Skey],
		la.[UserID],
		la.[ListingID],
		la.[ActionDTTM],
		la.[Description],
		la.[LastUpdatedUser],
		la.[Amount],
		la.[ProxyAmount],
		la.[QTY],
		la.[Reason],
		la.[Status],
		la.[HasUserEntered],
		la.[CreatedDate],
		la.[UpdatedDate],
		la.[DeletedDate]
FROM	[stg].[AH_ListingActions_FT_stg] la
left join [dbo].[AH_Buyers_DM] b on la.UserID=b.UserID
    ');

  CREATE TABLE "stg"."AH_ListingActions_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingActions_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingActions_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActions_FT_tmp__dbt_tmp_temp_view"
    end



21:38:53.042811 [debug] [Thread-3  ]: Opening a new connection, currently in state init
21:38:53.042940 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:38:53.040563 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Invoices_FT_tmp"
21:38:53.045092 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_tmp".
21:38:53.045482 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_tmp: 
  
  if object_id ('"stg"."AH_Invoices_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Invoices_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_Invoices_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_Invoices_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_Invoices_FT_tmp__dbt_tmp_temp_view as
    
SELECT
	i.[InvoiceID],
	
    c.[Consignor_Skey],
    b.[Buyer_Skey],
	
    i.[PayerID],
    i.[OwnerID],
	
    i.[CreatedDate],
    i.[UpdatedDate],
    i.[DeletedDate],
    i.[Status],
    i.[CreatedDTTM],
    i.[FulfilledDTTM],
    i.[Comment],
    i.[LastUpdatedUser],
    i.[Currency],
    i.[Type],
    i.[ShippingAmount],
    i.[Subtotal],
    i.[Total],
	
    i.[ShippingFirstName],
    i.[ShippingLastName],
    i.[ShippingStreet1],
    i.[ShippingStreet2],
    i.[ShippingCity],
    i.[ShippingState],
    i.[ShippingPostalCode],
    i.[ShippingCountry],
	
    i.[BillingFIrstName],
    i.[BillingLastName],
    i.[BillingStreet1],
    i.[BillingStreet2],
    i.[BillingCity],
    i.[BillingState],
    i.[BillingPostalCode],
    i.[BillingCountry],
	
    i.[SalesTax],
    
    i.[PaidDTTM],
    i.[IsPayerLocked],
    i.[HasShipped],
    i.[ShippingDetails],
    i.[BuyerPremiumPct],
    i.[BuyerPremiumAmount],
    i.[IsArchived]
FROM
	[stg].[AH_Invoices_FT_stg] i
left join [dbo].[AH_Buyers_DM] b on i.PayerID=b.UserID
left join [dbo].[AH_Consignors_DM] c on i.OwnerID=c.UserID
    ');

  CREATE TABLE "stg"."AH_Invoices_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Invoices_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Invoices_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Invoices_FT_tmp__dbt_tmp_temp_view"
    end



21:38:53.045666 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:38:53.045971 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:38:53.054715 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_LineItems_FT_tmp"
21:38:53.055176 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_tmp".
21:38:53.055340 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_tmp: 
  
  if object_id ('"stg"."AH_LineItems_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LineItems_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_LineItems_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_LineItems_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_LineItems_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		li.[LineItemsID],
		c.[Consignor_Skey],
		b.[Buyer_Skey],
		li.[OwnerID],
		li.[PayerID],
		li.[InvoiceID],
		li.[ListingID],
		li.[Description],
		li.[LastUpdatedUser],
		li.[Currency],
		li.[Status],
		li.[Type],
		li.[TotalAmount],
		li.[QTY],
		li.[PerUnitAmount],
		li.[IsTaxable],
		li.[IsArchived],
		li.[Relistiteration],
		li.[HasBuyerPremiumApplies],
		li.[IsPayerArchived],
		li.[DateStamp],
		li.[CreatedDate],
		li.[UpdatedDate],
		li.[DeletedDate]
FROM
	[stg].[AH_LineItems_FT_stg] li
left join [dbo].[AH_Buyers_DM] b on li.PayerID=b.UserID
left join [dbo].[AH_Consignors_DM] c on li.OwnerID=c.UserID
    ');

  CREATE TABLE "stg"."AH_LineItems_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_LineItems_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_LineItems_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LineItems_FT_tmp__dbt_tmp_temp_view"
    end



21:38:53.055455 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:38:53.055581 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:38:53.191474 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:38:53.192062 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:38:53.193207 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:38:53.200723 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:38:58.566495 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 5.52 seconds
21:38:58.585225 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_tmp".
21:38:58.585572 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: rename object "stg"."AH_ListingPaymentCharge_FT_tmp" to AH_ListingPaymentCharge_FT_tmp__dbt_backup
21:38:58.630055 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:38:58.645382 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_tmp".
21:38:58.645777 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: rename object "stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp" to AH_ListingPaymentCharge_FT_tmp
21:38:58.682442 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:38:58.694116 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: COMMIT
21:38:58.701266 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_tmp".
21:38:58.701581 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_FT_tmp__dbt_backup"
    end

21:38:58.943994 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:38:58.956900 [debug] [Thread-4  ]: finished collecting timing info
21:38:58.957320 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: Close
21:38:58.958102 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ed67b9-456f-467a-8573-e04eae1e72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57de2fdd90>]}
21:38:58.958641 [info ] [Thread-4  ]: 4 of 6 OK created table model stg.AH_ListingPaymentCharge_FT_tmp................ [[32mOK[0m in 6.21s]
21:38:58.959048 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingPaymentCharge_FT_tmp
21:38:58.959238 [debug] [Thread-4  ]: Began running node model.Shawn.AH_SubmittedListingPayment_FT_tmp
21:38:58.959586 [info ] [Thread-4  ]: 5 of 6 START table model stg.AH_SubmittedListingPayment_FT_tmp.................. [RUN]
21:38:58.960009 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_tmp"
21:38:58.960160 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_SubmittedListingPayment_FT_tmp
21:38:58.960290 [debug] [Thread-4  ]: Compiling model.Shawn.AH_SubmittedListingPayment_FT_tmp
21:38:58.962851 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_SubmittedListingPayment_FT_tmp"
21:38:58.963249 [debug] [Thread-4  ]: finished collecting timing info
21:38:58.963396 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_SubmittedListingPayment_FT_tmp
21:38:59.026106 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_SubmittedListingPayment_FT_tmp"
21:38:59.026828 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_tmp".
21:38:59.027033 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: 
  
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		slp.[SubmittedListingPaymentID],
		c.[Consignor_Skey],
		slp.[UserID],
		slp.[ListingID],
		slp.[Amount],
		slp.[HasProPhotography],
		slp.[HasProMarketing],
		slp.[TransactionID],
		slp.[CreatedDate],
		slp.[UpdatedDate]
FROM
	[stg].[AH_SubmittedListingPayment_FT_stg] slp
left join [dbo].[AH_Consignors_DM] c on slp.UserID=c.UserID
    ');

  CREATE TABLE "stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view"
    end



21:38:59.027156 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:38:59.027293 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:38:59.139411 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:38:59.502770 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.45 seconds
21:38:59.517668 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_tmp".
21:38:59.518025 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_tmp: rename object "stg"."AH_LineItems_FT_tmp" to AH_LineItems_FT_tmp__dbt_backup
21:38:59.932703 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
21:38:59.946872 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_tmp".
21:38:59.947245 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_tmp: rename object "stg"."AH_LineItems_FT_tmp__dbt_tmp" to AH_LineItems_FT_tmp
21:38:59.979600 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:38:59.981554 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT_tmp: COMMIT
21:38:59.985961 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_tmp".
21:38:59.986201 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_tmp: 
    
  if object_id ('"stg"."AH_LineItems_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_LineItems_FT_tmp__dbt_backup"
    end

21:39:01.031132 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.04 seconds
21:39:01.045052 [debug] [Thread-2  ]: finished collecting timing info
21:39:01.045488 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT_tmp: Close
21:39:01.046263 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ed67b9-456f-467a-8573-e04eae1e72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57de27a6a0>]}
21:39:01.046784 [info ] [Thread-2  ]: 2 of 6 OK created table model stg.AH_LineItems_FT_tmp........................... [[32mOK[0m in 8.30s]
21:39:01.047173 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_LineItems_FT_tmp
21:39:01.047359 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Watches_FT_tmp
21:39:01.047704 [info ] [Thread-2  ]: 6 of 6 START table model stg.AH_Watches_FT_tmp.................................. [RUN]
21:39:01.048149 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Watches_FT_tmp"
21:39:01.048301 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Watches_FT_tmp
21:39:01.048434 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Watches_FT_tmp
21:39:01.051078 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Watches_FT_tmp"
21:39:01.051566 [debug] [Thread-2  ]: finished collecting timing info
21:39:01.051718 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Watches_FT_tmp
21:39:01.114790 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Watches_FT_tmp"
21:39:01.115495 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_tmp".
21:39:01.115692 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_tmp: 
  
  if object_id ('"stg"."AH_Watches_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Watches_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_Watches_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_Watches_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_Watches_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		w.[WatchID],
		b.[Buyer_Skey],
		w.[UserID],
		w.[ListingID],
		w.[LastUpdatedUser],
		w.[CreatedDate],
		w.[UpdatedDate],
		w.[DeletedDate]
FROM [stg].[AH_Watches_FT_stg] w
left join [dbo].[AH_Buyers_DM] b on w.UserID=b.UserID
    ');

  CREATE TABLE "stg"."AH_Watches_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Watches_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Watches_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Watches_FT_tmp__dbt_tmp_temp_view"
    end



21:39:01.115809 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:39:01.115944 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:39:01.230987 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:39:02.204658 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 9.16 seconds
21:39:02.220103 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_tmp".
21:39:02.220468 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_tmp: rename object "stg"."AH_ListingActions_FT_tmp" to AH_ListingActions_FT_tmp__dbt_backup
21:39:02.358715 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:39:02.373042 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_tmp".
21:39:02.373413 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_tmp: rename object "stg"."AH_ListingActions_FT_tmp__dbt_tmp" to AH_ListingActions_FT_tmp
21:39:02.403746 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:39:02.405672 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT_tmp: COMMIT
21:39:02.410004 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_tmp".
21:39:02.410247 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_tmp: 
    
  if object_id ('"stg"."AH_ListingActions_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_FT_tmp__dbt_backup"
    end

21:39:02.665036 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:39:02.678882 [debug] [Thread-3  ]: finished collecting timing info
21:39:02.679327 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT_tmp: Close
21:39:02.680140 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ed67b9-456f-467a-8573-e04eae1e72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57de20ec40>]}
21:39:02.680627 [info ] [Thread-3  ]: 3 of 6 OK created table model stg.AH_ListingActions_FT_tmp...................... [[32mOK[0m in 9.94s]
21:39:02.681010 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingActions_FT_tmp
21:39:03.757617 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 4.73 seconds
21:39:03.767838 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 10.72 seconds
21:39:03.774066 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_tmp".
21:39:03.783845 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: rename object "stg"."AH_SubmittedListingPayment_FT_tmp" to AH_SubmittedListingPayment_FT_tmp__dbt_backup
21:39:03.786890 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_tmp".
21:39:03.787149 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_tmp: rename object "stg"."AH_Invoices_FT_tmp" to AH_Invoices_FT_tmp__dbt_backup
21:39:03.823381 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:39:03.835779 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:39:03.838796 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_tmp".
21:39:03.847876 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: rename object "stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp" to AH_SubmittedListingPayment_FT_tmp
21:39:03.851004 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_tmp".
21:39:03.851314 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_tmp: rename object "stg"."AH_Invoices_FT_tmp__dbt_tmp" to AH_Invoices_FT_tmp
21:39:03.880823 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:39:03.883030 [debug] [Thread-1  ]: On model.Shawn.AH_Invoices_FT_tmp: COMMIT
21:39:03.883266 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:39:03.888970 [debug] [Thread-4  ]: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: COMMIT
21:39:03.892913 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_tmp".
21:39:03.887429 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_tmp".
21:39:03.893329 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_tmp: 
    
  if object_id ('"stg"."AH_Invoices_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_Invoices_FT_tmp__dbt_backup"
    end

21:39:03.893190 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_FT_tmp__dbt_backup"
    end

21:39:04.140954 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:39:04.152755 [debug] [Thread-4  ]: finished collecting timing info
21:39:04.153173 [debug] [Thread-4  ]: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: Close
21:39:04.153911 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ed67b9-456f-467a-8573-e04eae1e72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57de2769d0>]}
21:39:04.154388 [info ] [Thread-4  ]: 5 of 6 OK created table model stg.AH_SubmittedListingPayment_FT_tmp............. [[32mOK[0m in 5.19s]
21:39:04.154808 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_SubmittedListingPayment_FT_tmp
21:39:04.186228 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:39:04.198729 [debug] [Thread-1  ]: finished collecting timing info
21:39:04.199169 [debug] [Thread-1  ]: On model.Shawn.AH_Invoices_FT_tmp: Close
21:39:04.199932 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ed67b9-456f-467a-8573-e04eae1e72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57de20d8b0>]}
21:39:04.200446 [info ] [Thread-1  ]: 1 of 6 OK created table model stg.AH_Invoices_FT_tmp............................ [[32mOK[0m in 11.46s]
21:39:04.200827 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Invoices_FT_tmp
21:39:10.429161 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 9.31 seconds
21:39:10.518727 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_tmp".
21:39:10.519108 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_tmp: rename object "stg"."AH_Watches_FT_tmp" to AH_Watches_FT_tmp__dbt_backup
21:39:10.553251 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:39:10.567255 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_tmp".
21:39:10.567612 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_tmp: rename object "stg"."AH_Watches_FT_tmp__dbt_tmp" to AH_Watches_FT_tmp
21:39:10.601713 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:39:10.603701 [debug] [Thread-2  ]: On model.Shawn.AH_Watches_FT_tmp: COMMIT
21:39:10.607835 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_tmp".
21:39:10.608078 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_tmp: 
    
  if object_id ('"stg"."AH_Watches_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_Watches_FT_tmp__dbt_backup"
    end

21:39:10.832986 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:39:10.846096 [debug] [Thread-2  ]: finished collecting timing info
21:39:10.846630 [debug] [Thread-2  ]: On model.Shawn.AH_Watches_FT_tmp: Close
21:39:10.847503 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ed67b9-456f-467a-8573-e04eae1e72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57de410430>]}
21:39:10.848033 [info ] [Thread-2  ]: 6 of 6 OK created table model stg.AH_Watches_FT_tmp............................. [[32mOK[0m in 9.80s]
21:39:10.848420 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Watches_FT_tmp
21:39:10.850061 [debug] [MainThread]: Acquiring new synapse connection "master"
21:39:10.850374 [debug] [MainThread]: On master: COMMIT
21:39:10.850806 [info ] [MainThread]: 
21:39:10.851079 [info ] [MainThread]: Finished running 6 table models in 40.41s.
21:39:10.851276 [debug] [MainThread]: Connection 'master' was properly closed.
21:39:10.851384 [debug] [MainThread]: Connection 'model.Shawn.AH_Watches_FT_tmp' was properly closed.
21:39:10.851478 [debug] [MainThread]: Connection 'model.Shawn.AH_Invoices_FT_tmp' was properly closed.
21:39:10.851567 [debug] [MainThread]: Connection 'model.Shawn.AH_ListingActions_FT_tmp' was properly closed.
21:39:10.851655 [debug] [MainThread]: Connection 'model.Shawn.AH_SubmittedListingPayment_FT_tmp' was properly closed.
21:39:10.881928 [info ] [MainThread]: 
21:39:10.882328 [info ] [MainThread]: [32mCompleted successfully[0m
21:39:10.882670 [info ] [MainThread]: 
21:39:10.882911 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
21:39:10.883226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57de5050a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57e0692490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57de29adc0>]}


============================== 2022-09-18 21:39:13.228960 | cb264a74-2dd8-4624-803c-654c2e89b59b ==============================
21:39:13.228960 [info ] [MainThread]: Running with dbt=1.0.0
21:39:13.234913 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step6_FT_3'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
21:39:13.235242 [debug] [MainThread]: Tracking: tracking
21:39:13.235616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe776f6fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe776f6d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe776f6fa0>]}
21:39:13.441013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:39:13.441423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:39:13.467873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb264a74-2dd8-4624-803c-654c2e89b59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7767c2e0>]}
21:39:13.518833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb264a74-2dd8-4624-803c-654c2e89b59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe796ba8b0>]}
21:39:13.519417 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:39:13.528089 [info ] [MainThread]: 
21:39:13.528852 [debug] [MainThread]: Acquiring new synapse connection "master"
21:39:13.530263 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
21:39:13.539869 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
21:39:13.540233 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
21:39:13.540382 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:39:13.540540 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:39:13.833103 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:39:13.867231 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.33 seconds
21:39:13.869229 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
21:39:13.891815 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
21:39:13.897906 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
21:39:13.898552 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
21:39:13.900342 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
21:39:13.900542 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
21:39:13.900669 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:39:13.900803 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:39:13.898762 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
21:39:13.902369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:39:13.902576 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:39:14.011788 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:39:14.014726 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:39:14.053064 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:39:14.053588 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:39:14.186765 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
21:39:14.187185 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
21:39:14.247561 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
21:39:14.259828 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
21:39:35.729891 [debug] [MainThread]: On master: COMMIT
21:39:35.730602 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
21:39:35.730946 [info ] [MainThread]: 
21:39:35.734638 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Invoice_FT
21:39:35.735273 [info ] [Thread-1  ]: 1 of 6 START table model dbo.AH_Invoice_FT...................................... [RUN]
21:39:35.735786 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Invoice_FT"
21:39:35.735968 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Invoice_FT
21:39:35.734870 [debug] [Thread-2  ]: Began running node model.Shawn.AH_LineItems_FT
21:39:35.736486 [info ] [Thread-2  ]: 2 of 6 START table model dbo.AH_LineItems_FT.................................... [RUN]
21:39:35.736916 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_LineItems_FT"
21:39:35.737070 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_LineItems_FT
21:39:35.737198 [debug] [Thread-2  ]: Compiling model.Shawn.AH_LineItems_FT
21:39:35.734963 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingActions_FT
21:39:35.740547 [info ] [Thread-3  ]: 3 of 6 START table model dbo.AH_ListingActions_FT............................... [RUN]
21:39:35.740995 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingActions_FT"
21:39:35.741152 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingActions_FT
21:39:35.741277 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingActions_FT
21:39:35.735040 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingPaymentCharge_FT
21:39:35.744226 [info ] [Thread-4  ]: 4 of 6 START table model dbo.AH_ListingPaymentCharge_FT......................... [RUN]
21:39:35.744647 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingPaymentCharge_FT"
21:39:35.744796 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingPaymentCharge_FT
21:39:35.744919 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingPaymentCharge_FT
21:39:35.736133 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Invoice_FT
21:39:35.749937 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Invoice_FT"
21:39:35.743945 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingActions_FT"
21:39:35.740253 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_LineItems_FT"
21:39:35.750746 [debug] [Thread-2  ]: finished collecting timing info
21:39:35.750912 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_LineItems_FT
21:39:35.747425 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingPaymentCharge_FT"
21:39:35.760226 [debug] [Thread-3  ]: finished collecting timing info
21:39:35.760544 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingActions_FT
21:39:35.759734 [debug] [Thread-1  ]: finished collecting timing info
21:39:35.787765 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Invoice_FT
21:39:35.760434 [debug] [Thread-4  ]: finished collecting timing info
21:39:35.847767 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingPaymentCharge_FT
21:39:35.933279 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_LineItems_FT"
21:39:35.935257 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Invoice_FT"
21:39:35.934715 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingActions_FT"
21:39:35.944555 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT".
21:39:35.945140 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT: 
  
  if object_id ('"dbo"."AH_ListingActions_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingActions_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingActions_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingActions_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingActions_FT__dbt_tmp_temp_view as
    
with updateData as (
    select 
        FTstg.[ListingActionID],
		FTtmp.[Buyer_Skey],
		FTstg.[ListingID],
		FTstg.[ActionDTTM],
		FTstg.[Description],
		FTstg.[LastUpdatedUser],
		FTstg.[Amount],
		FTstg.[ProxyAmount],
		FTstg.[QTY],
		FTstg.[Reason],
		FTstg.[Status],
		FTstg.[HasUserEntered],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate],
		FTstg.[DeletedDate]
    from stg.AH_ListingActions_FT_tmp as FTtmp 
    join stg.AH_ListingActions_FT_stg as FTstg 
    on FTstg.ListingActionID=FTtmp.ListingActionID
)
,
insertData as (
    select 
       	[ListingActionID],
        [Buyer_Skey],
        [ListingID],
        [ActionDTTM],
        [Description],
        [LastUpdatedUser],
        [Amount],
        [ProxyAmount],
        [QTY],
        [Reason],
        [Status],
        [HasUserEntered],
        [CreatedDate],
        [UpdatedDate],
        [DeletedDate]
    from stg.AH_ListingActions_FT_tmp
    where ListingActionID not in (select  ListingActionID from stg.AH_ListingActions_FT_stg)
)
SELECT
	[ListingActionID],
	[Buyer_Skey],
	[ListingID],
	[ActionDTTM],
	[Description],
	[LastUpdatedUser],
	[Amount],
	[ProxyAmount],
	[QTY],
	[Reason],
	[Status],
	[HasUserEntered],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from updateData

union all

SELECT
	[ListingActionID],
	[Buyer_Skey],
	[ListingID],
	[ActionDTTM],
	[Description],
	[LastUpdatedUser],
	[Amount],
	[ProxyAmount],
	[QTY],
	[Reason],
	[Status],
	[HasUserEntered],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from insertData
    ');

  CREATE TABLE "dbo"."AH_ListingActions_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingActions_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingActions_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingActions_FT__dbt_tmp_temp_view"
    end



21:39:35.945277 [debug] [Thread-3  ]: Opening a new connection, currently in state init
21:39:35.945430 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:39:35.945036 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT".
21:39:35.946981 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT: 
  
  if object_id ('"dbo"."AH_LineItems_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_LineItems_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_LineItems_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_LineItems_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_LineItems_FT__dbt_tmp_temp_view as
    

with updateData as (
    select 
     	FTstg.[LineItemsID],
		FTtmp.[Consignor_Skey],
		FTtmp.[Buyer_Skey],
		FTstg.[InvoiceID],
		FTstg.[ListingID],
		FTstg.[Description],
		FTstg.[LastUpdatedUser],
		FTstg.[Currency],
		FTstg.[Status],
		FTstg.[Type],
		FTstg.[TotalAmount],
		FTstg.[QTY],
		FTstg.[PerUnitAmount],
		FTstg.[IsTaxable],
		FTstg.[IsArchived],
		FTstg.[Relistiteration],
		FTstg.[HasBuyerPremiumApplies],
		FTstg.[IsPayerArchived],
		FTstg.[DateStamp],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate],
		FTstg.[DeletedDate]
    from stg.AH_LineItems_FT_tmp as FTtmp 
    join stg.AH_LineItems_FT_stg as FTstg 
    on FTstg.LineItemsID=FTtmp.LineItemsID
),
insertData as (
    select 
        [LineItemsID],
        [Consignor_Skey],
        [Buyer_Skey],
        [InvoiceID],
        [ListingID],
        [Description],
        [LastUpdatedUser],
        [Currency],
        [Status],
        [Type],
        [TotalAmount],
        [QTY],
        [PerUnitAmount],
        [IsTaxable],
        [IsArchived],
        [Relistiteration],
        [HasBuyerPremiumApplies],
        [IsPayerArchived],
        [DateStamp],
        [CreatedDate],
        [UpdatedDate],
        [DeletedDate]
    from stg.AH_LineItems_FT_tmp
    where LineItemsID not in (select  LineItemsID from stg.AH_LineItems_FT_stg)
)
SELECT
	[LineItemsID],
	[Consignor_Skey],
	[Buyer_Skey],
	[InvoiceID],
	[ListingID],
	[Description],
	[LastUpdatedUser],
	[Currency],
	[Status],
	[Type],
	[TotalAmount],
	[QTY],
	[PerUnitAmount],
	[IsTaxable],
	[IsArchived],
	[Relistiteration],
	[HasBuyerPremiumApplies],
	[IsPayerArchived],
	[DateStamp],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from updateData

union all

SELECT
	[LineItemsID],
	[Consignor_Skey],
	[Buyer_Skey],
	[InvoiceID],
	[ListingID],
	[Description],
	[LastUpdatedUser],
	[Currency],
	[Status],
	[Type],
	[TotalAmount],
	[QTY],
	[PerUnitAmount],
	[IsTaxable],
	[IsArchived],
	[Relistiteration],
	[HasBuyerPremiumApplies],
	[IsPayerArchived],
	[DateStamp],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from insertData
    ');

  CREATE TABLE "dbo"."AH_LineItems_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_LineItems_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_LineItems_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_LineItems_FT__dbt_tmp_temp_view"
    end



21:39:35.947162 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:39:35.947328 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:39:35.944805 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoice_FT".
21:39:35.948234 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoice_FT: 
  
  if object_id ('"dbo"."AH_Invoice_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Invoice_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Invoice_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Invoice_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_Invoice_FT__dbt_tmp_temp_view as
    

with updateData as (
    select 
        FTstg.[InvoiceID],
		FTtmp.[Consignor_Skey],
		FTtmp.[Buyer_Skey],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate],
		FTstg.[DeletedDate],
		FTstg.[Status],
		FTstg.[CreatedDTTM],
		FTstg.[FulfilledDTTM],
		FTstg.[Comment],
		FTstg.[LastUpdatedUser],
		FTstg.[Currency],
		FTstg.[Type],
		FTstg.[ShippingAmount],
		FTstg.[Subtotal],
		FTstg.[Total],
		FTstg.[ShippingFirstName],
		FTstg.[ShippingLastName],
		FTstg.[ShippingStreet1],
		FTstg.[ShippingStreet2],
		FTstg.[ShippingCity],
		FTstg.[ShippingState],
		FTstg.[ShippingPostalCode],
		FTstg.[ShippingCountry],
		FTstg.[BillingFIrstName],
		FTstg.[BillingLastName],
		FTstg.[BillingStreet1],
		FTstg.[BillingStreet2],
		FTstg.[BillingCity],
		FTstg.[BillingState],
		FTstg.[BillingPostalCode],
		FTstg.[BillingCountry],
		FTstg.[SalesTax],
		FTstg.[PaidDTTM],
		FTstg.[IsPayerLocked],
		FTstg.[HasShipped],
		FTstg.[ShippingDetails],
		FTstg.[BuyerPremiumPct],
		FTstg.[BuyerPremiumAmount],
		FTstg.[IsArchived]
    from stg.AH_Invoices_FT_tmp as FTtmp 
    join stg.AH_Invoices_FT_stg as FTstg 
    on FTstg.InvoiceID=FTtmp.InvoiceID
),
insertData as (
    select 
        [InvoiceID],
        [Consignor_Skey],
        [Buyer_Skey],
        [CreatedDate],
        [UpdatedDate],
        [DeletedDate],
        [Status],
        [CreatedDTTM],
        [FulfilledDTTM],
        [Comment],
        [LastUpdatedUser],
        [Currency],
        [Type],
        [ShippingAmount],
        [Subtotal],
        [Total],
        [ShippingFirstName],
        [ShippingLastName],
        [ShippingStreet1],
        [ShippingStreet2],
        [ShippingCity],
        [ShippingState],
        [ShippingPostalCode],
        [ShippingCountry],
        [BillingFIrstName],
        [BillingLastName],
        [BillingStreet1],
        [BillingStreet2],
        [BillingCity],
        [BillingState],
        [BillingPostalCode],
        [BillingCountry],
        [SalesTax],
        [PaidDTTM],
        [IsPayerLocked],
        [HasShipped],
        [ShippingDetails],
        [BuyerPremiumPct],
        [BuyerPremiumAmount],
        [IsArchived]
    from stg.AH_Invoices_FT_tmp
    where InvoiceID not in (select  InvoiceID from stg.AH_Invoices_FT_stg)
)
SELECT
	[InvoiceID],
	[Consignor_Skey],
	[Buyer_Skey],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate],
	[Status],
	[CreatedDTTM],
	[FulfilledDTTM],
	[Comment],
	[LastUpdatedUser],
	[Currency],
	[Type],
	[ShippingAmount],
	[Subtotal],
	[Total],
	[ShippingFirstName],
	[ShippingLastName],
	[ShippingStreet1],
	[ShippingStreet2],
	[ShippingCity],
	[ShippingState],
	[ShippingPostalCode],
	[ShippingCountry],
	[BillingFIrstName],
	[BillingLastName],
	[BillingStreet1],
	[BillingStreet2],
	[BillingCity],
	[BillingState],
	[BillingPostalCode],
	[BillingCountry],
	[SalesTax],
	[PaidDTTM],
	[IsPayerLocked],
	[HasShipped],
	[ShippingDetails],
	[BuyerPremiumPct],
	[BuyerPremiumAmount],
	[IsArchived]
from updateData

union all

SELECT
	[InvoiceID],
	[Consignor_Skey],
	[Buyer_Skey],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate],
	[Status],
	[CreatedDTTM],
	[FulfilledDTTM],
	[Comment],
	[LastUpdatedUser],
	[Currency],
	[Type],
	[ShippingAmount],
	[Subtotal],
	[Total],
	[ShippingFirstName],
	[ShippingLastName],
	[ShippingStreet1],
	[ShippingStreet2],
	[ShippingCity],
	[ShippingState],
	[ShippingPostalCode],
	[ShippingCountry],
	[BillingFIrstName],
	[BillingLastName],
	[BillingStreet1],
	[BillingStreet2],
	[BillingCity],
	[BillingState],
	[BillingPostalCode],
	[BillingCountry],
	[SalesTax],
	[PaidDTTM],
	[IsPayerLocked],
	[HasShipped],
	[ShippingDetails],
	[BuyerPremiumPct],
	[BuyerPremiumAmount],
	[IsArchived]
from insertData
    ');

  CREATE TABLE "dbo"."AH_Invoice_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Invoice_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Invoice_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Invoice_FT__dbt_tmp_temp_view"
    end



21:39:35.948396 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:39:35.948529 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:39:35.962964 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingPaymentCharge_FT"
21:39:35.963619 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT".
21:39:35.963816 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT: 
  
  if object_id ('"dbo"."AH_ListingPaymentCharge_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingPaymentCharge_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingPaymentCharge_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingPaymentCharge_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingPaymentCharge_FT__dbt_tmp_temp_view as
    
with updateData as (
    select 
		FTstg.[ListingPaymentChargeID],
		FTtmp.[Buyer_Skey],
		FTstg.[ListingID],
		FTstg.[ChargeAmount],
		FTstg.[TotalBid],
		FTstg.[BidHoldPercentage],
		FTstg.[MaximumBidCharge],
		FTstg.[TransactionID],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate]
    from stg.AH_ListingPaymentCharge_FT_tmp as FTtmp 
    join stg.AH_ListingPaymentCharge_FT_stg as FTstg 
    on FTstg.ListingPaymentChargeID=FTtmp.ListingPaymentChargeID
)
,
insertData as (
    select 
        [ListingPaymentChargeID],
        [Buyer_Skey],
        [ListingID],
        [ChargeAmount],
        [TotalBid],
        [BidHoldPercentage],
        [MaximumBidCharge],
        [TransactionID],
        [CreatedDate],
        [UpdatedDate]
    from stg.AH_ListingPaymentCharge_FT_tmp
    where ListingPaymentChargeID not in (select  ListingPaymentChargeID from stg.AH_ListingPaymentCharge_FT_stg)
)
SELECT
	[ListingPaymentChargeID],
	[Buyer_Skey],
	[ListingID],
	[ChargeAmount],
	[TotalBid],
	[BidHoldPercentage],
	[MaximumBidCharge],
	[TransactionID],
	[CreatedDate],
	[UpdatedDate]
from updateData

union all

SELECT
	[ListingPaymentChargeID],
	[Buyer_Skey],
	[ListingID],
	[ChargeAmount],
	[TotalBid],
	[BidHoldPercentage],
	[MaximumBidCharge],
	[TransactionID],
	[CreatedDate],
	[UpdatedDate]
from insertData
    ');

  CREATE TABLE "dbo"."AH_ListingPaymentCharge_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingPaymentCharge_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingPaymentCharge_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingPaymentCharge_FT__dbt_tmp_temp_view"
    end



21:39:35.963949 [debug] [Thread-4  ]: Opening a new connection, currently in state init
21:39:35.964093 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:39:36.090220 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:39:36.091071 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:39:36.091705 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:39:36.103548 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:39:42.182743 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 6.22 seconds
21:39:42.209701 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT".
21:39:42.210050 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT: rename object "dbo"."AH_ListingPaymentCharge_FT" to AH_ListingPaymentCharge_FT__dbt_backup
21:39:42.245499 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:39:42.259659 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT".
21:39:42.260039 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT: rename object "dbo"."AH_ListingPaymentCharge_FT__dbt_tmp" to AH_ListingPaymentCharge_FT
21:39:42.293368 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:39:42.305046 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT: COMMIT
21:39:42.312106 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT".
21:39:42.312455 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT: 
    
  if object_id ('"dbo"."AH_ListingPaymentCharge_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingPaymentCharge_FT__dbt_backup"
    end

21:39:42.322653 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.37 seconds
21:39:42.336979 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoice_FT".
21:39:42.337395 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoice_FT: rename object "dbo"."AH_Invoice_FT" to AH_Invoice_FT__dbt_backup
21:39:42.370721 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:39:42.385184 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoice_FT".
21:39:42.385623 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoice_FT: rename object "dbo"."AH_Invoice_FT__dbt_tmp" to AH_Invoice_FT
21:39:42.412393 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.47 seconds
21:39:42.424543 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:39:42.426270 [debug] [Thread-1  ]: On model.Shawn.AH_Invoice_FT: COMMIT
21:39:42.430141 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT".
21:39:42.433735 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT: rename object "dbo"."AH_LineItems_FT" to AH_LineItems_FT__dbt_backup
21:39:42.433501 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoice_FT".
21:39:42.434055 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoice_FT: 
    
  if object_id ('"dbo"."AH_Invoice_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Invoice_FT__dbt_backup"
    end

21:39:42.474995 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:39:42.489388 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT".
21:39:42.489747 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT: rename object "dbo"."AH_LineItems_FT__dbt_tmp" to AH_LineItems_FT
21:39:42.515713 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:39:42.526214 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:39:42.527986 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT: COMMIT
21:39:42.531466 [debug] [Thread-4  ]: finished collecting timing info
21:39:42.535447 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT: Close
21:39:42.536246 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb264a74-2dd8-4624-803c-654c2e89b59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe751ca850>]}
21:39:42.536754 [info ] [Thread-4  ]: 4 of 6 OK created table model dbo.AH_ListingPaymentCharge_FT.................... [[32mOK[0m in 6.79s]
21:39:42.537164 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingPaymentCharge_FT
21:39:42.535112 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT".
21:39:42.537638 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT: 
    
  if object_id ('"dbo"."AH_LineItems_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_LineItems_FT__dbt_backup"
    end

21:39:42.537366 [debug] [Thread-4  ]: Began running node model.Shawn.AH_SubmittedListingPayment_FT
21:39:42.538077 [info ] [Thread-4  ]: 5 of 6 START table model dbo.AH_SubmittedListingPayment_FT...................... [RUN]
21:39:42.538587 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_SubmittedListingPayment_FT"
21:39:42.538757 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_SubmittedListingPayment_FT
21:39:42.538893 [debug] [Thread-4  ]: Compiling model.Shawn.AH_SubmittedListingPayment_FT
21:39:42.541792 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_SubmittedListingPayment_FT"
21:39:42.542278 [debug] [Thread-4  ]: finished collecting timing info
21:39:42.542439 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_SubmittedListingPayment_FT
21:39:42.578344 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_SubmittedListingPayment_FT"
21:39:42.579051 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT".
21:39:42.579247 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT: 
  
  if object_id ('"dbo"."AH_SubmittedListingPayment_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SubmittedListingPayment_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_SubmittedListingPayment_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_SubmittedListingPayment_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_SubmittedListingPayment_FT__dbt_tmp_temp_view as
    
with updateData as (
    select 
		FTstg.[SubmittedListingPaymentID],
		FTtmp.[Consignor_Skey],
		FTstg.[ListingID],
		FTstg.[Amount],
		FTstg.[HasProPhotography],
		FTstg.[HasProMarketing],
		FTstg.[TransactionID],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate]
    from stg.AH_SubmittedListingPayment_FT_tmp as FTtmp 
    join stg.AH_SubmittedListingPayment_FT_stg as FTstg 
    on FTstg.SubmittedListingPaymentID=FTtmp.SubmittedListingPaymentID
)
,
insertData as (
    select 
        [SubmittedListingPaymentID],
        [Consignor_Skey],
        [ListingID],
        [Amount],
        [HasProPhotography],
        [HasProMarketing],
        [TransactionID],
        [CreatedDate],
        [UpdatedDate]
    from stg.AH_SubmittedListingPayment_FT_tmp
    where SubmittedListingPaymentID not in (select  SubmittedListingPaymentID from stg.AH_SubmittedListingPayment_FT_stg)
)
SELECT
	[SubmittedListingPaymentID],
	[Consignor_Skey],
	[ListingID],
	[Amount],
	[HasProPhotography],
	[HasProMarketing],
	[TransactionID],
	[CreatedDate],
	[UpdatedDate]
from updateData

union all

SELECT
	[SubmittedListingPaymentID],
	[Consignor_Skey],
	[ListingID],
	[Amount],
	[HasProPhotography],
	[HasProMarketing],
	[TransactionID],
	[CreatedDate],
	[UpdatedDate]
from insertData
    ');

  CREATE TABLE "dbo"."AH_SubmittedListingPayment_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_SubmittedListingPayment_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_SubmittedListingPayment_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SubmittedListingPayment_FT__dbt_tmp_temp_view"
    end



21:39:42.579380 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:39:42.579523 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:39:42.664285 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:39:42.750256 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:39:42.750632 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:39:42.754977 [debug] [Thread-1  ]: finished collecting timing info
21:39:42.764136 [debug] [Thread-1  ]: On model.Shawn.AH_Invoice_FT: Close
21:39:42.764909 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb264a74-2dd8-4624-803c-654c2e89b59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7516d160>]}
21:39:42.765394 [info ] [Thread-1  ]: 1 of 6 OK created table model dbo.AH_Invoice_FT................................. [[32mOK[0m in 7.03s]
21:39:42.763722 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.82 seconds
21:39:42.766701 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Invoice_FT
21:39:42.766932 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Watches_FT
21:39:42.767291 [info ] [Thread-1  ]: 6 of 6 START table model dbo.AH_Watches_FT...................................... [RUN]
21:39:42.767708 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Watches_FT"
21:39:42.767862 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Watches_FT
21:39:42.767996 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Watches_FT
21:39:42.770665 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Watches_FT"
21:39:42.772893 [debug] [Thread-2  ]: finished collecting timing info
21:39:42.784119 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT: Close
21:39:42.785003 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb264a74-2dd8-4624-803c-654c2e89b59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe752377f0>]}
21:39:42.785597 [info ] [Thread-2  ]: 2 of 6 OK created table model dbo.AH_LineItems_FT............................... [[32mOK[0m in 7.05s]
21:39:42.785255 [debug] [Thread-1  ]: finished collecting timing info
21:39:42.785968 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Watches_FT
21:39:42.795831 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_LineItems_FT
21:39:42.797355 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT".
21:39:42.797759 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT: rename object "dbo"."AH_ListingActions_FT" to AH_ListingActions_FT__dbt_backup
21:39:42.824147 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Watches_FT"
21:39:42.824858 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT".
21:39:42.825077 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT: 
  
  if object_id ('"dbo"."AH_Watches_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Watches_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Watches_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Watches_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_Watches_FT__dbt_tmp_temp_view as
    
with updateData as (
    select 
		FTstg.[WatchID],
		FTtmp.[Buyer_Skey],
		FTstg.[ListingID],
		FTstg.[LastUpdatedUser],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate],
		FTstg.[DeletedDate]
    from stg.AH_Watches_FT_tmp as FTtmp 
    join stg.AH_Watches_FT_stg as FTstg 
    on FTstg.WatchID=FTtmp.WatchID
)
,
insertData as (
    select 
        [WatchID],
        [Buyer_Skey],
        [ListingID],
        [LastUpdatedUser],
        [CreatedDate],
        [UpdatedDate],
        [DeletedDate]
    from stg.AH_Watches_FT_tmp
    where WatchID not in (select  WatchID from stg.AH_Watches_FT_stg)
)
SELECT
	[WatchID],
	[Buyer_Skey],
	[ListingID],
	[LastUpdatedUser],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from updateData

union all

SELECT
	[WatchID],
	[Buyer_Skey],
	[ListingID],
	[LastUpdatedUser],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from insertData
    ');

  CREATE TABLE "dbo"."AH_Watches_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Watches_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Watches_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Watches_FT__dbt_tmp_temp_view"
    end



21:39:42.825210 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:39:42.825356 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:39:42.832182 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:39:42.845792 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT".
21:39:42.846155 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT: rename object "dbo"."AH_ListingActions_FT__dbt_tmp" to AH_ListingActions_FT
21:39:42.877589 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:39:42.879578 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT: COMMIT
21:39:42.884201 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT".
21:39:42.884567 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT: 
    
  if object_id ('"dbo"."AH_ListingActions_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingActions_FT__dbt_backup"
    end

21:39:42.943656 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:39:44.130592 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.25 seconds
21:39:44.142938 [debug] [Thread-3  ]: finished collecting timing info
21:39:44.143331 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT: Close
21:39:44.144117 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb264a74-2dd8-4624-803c-654c2e89b59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe75236310>]}
21:39:44.144587 [info ] [Thread-3  ]: 3 of 6 OK created table model dbo.AH_ListingActions_FT.......................... [[32mOK[0m in 8.40s]
21:39:44.144961 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingActions_FT
21:39:48.345265 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 5.77 seconds
21:39:48.359854 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT".
21:39:48.360202 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT: rename object "dbo"."AH_SubmittedListingPayment_FT" to AH_SubmittedListingPayment_FT__dbt_backup
21:39:48.397807 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:39:48.411628 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT".
21:39:48.411979 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT: rename object "dbo"."AH_SubmittedListingPayment_FT__dbt_tmp" to AH_SubmittedListingPayment_FT
21:39:48.443077 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:39:48.445034 [debug] [Thread-4  ]: On model.Shawn.AH_SubmittedListingPayment_FT: COMMIT
21:39:48.449044 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT".
21:39:48.449241 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT: 
    
  if object_id ('"dbo"."AH_SubmittedListingPayment_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_SubmittedListingPayment_FT__dbt_backup"
    end

21:39:48.661072 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:39:48.674116 [debug] [Thread-4  ]: finished collecting timing info
21:39:48.674561 [debug] [Thread-4  ]: On model.Shawn.AH_SubmittedListingPayment_FT: Close
21:39:48.675343 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb264a74-2dd8-4624-803c-654c2e89b59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe74113e50>]}
21:39:48.675843 [info ] [Thread-4  ]: 5 of 6 OK created table model dbo.AH_SubmittedListingPayment_FT................. [[32mOK[0m in 6.14s]
21:39:48.676225 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_SubmittedListingPayment_FT
21:39:53.811471 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 10.99 seconds
21:39:53.825502 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT".
21:39:53.825838 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT: rename object "dbo"."AH_Watches_FT" to AH_Watches_FT__dbt_backup
21:39:53.860001 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:39:53.874133 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT".
21:39:53.874487 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT: rename object "dbo"."AH_Watches_FT__dbt_tmp" to AH_Watches_FT
21:39:53.906951 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:39:53.908846 [debug] [Thread-1  ]: On model.Shawn.AH_Watches_FT: COMMIT
21:39:53.913080 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT".
21:39:53.913293 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT: 
    
  if object_id ('"dbo"."AH_Watches_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Watches_FT__dbt_backup"
    end

21:39:54.164122 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:39:54.176396 [debug] [Thread-1  ]: finished collecting timing info
21:39:54.176782 [debug] [Thread-1  ]: On model.Shawn.AH_Watches_FT: Close
21:39:54.177554 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb264a74-2dd8-4624-803c-654c2e89b59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7523c3a0>]}
21:39:54.178014 [info ] [Thread-1  ]: 6 of 6 OK created table model dbo.AH_Watches_FT................................. [[32mOK[0m in 11.41s]
21:39:54.178377 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Watches_FT
21:39:54.179855 [debug] [MainThread]: Acquiring new synapse connection "master"
21:39:54.180142 [debug] [MainThread]: On master: COMMIT
21:39:54.180479 [info ] [MainThread]: 
21:39:54.180725 [info ] [MainThread]: Finished running 6 table models in 40.65s.
21:39:54.180920 [debug] [MainThread]: Connection 'master' was properly closed.
21:39:54.181024 [debug] [MainThread]: Connection 'model.Shawn.AH_LineItems_FT' was properly closed.
21:39:54.181117 [debug] [MainThread]: Connection 'model.Shawn.AH_Watches_FT' was properly closed.
21:39:54.181204 [debug] [MainThread]: Connection 'model.Shawn.AH_ListingActions_FT' was properly closed.
21:39:54.181289 [debug] [MainThread]: Connection 'model.Shawn.AH_SubmittedListingPayment_FT' was properly closed.
21:39:54.209097 [info ] [MainThread]: 
21:39:54.209453 [info ] [MainThread]: [32mCompleted successfully[0m
21:39:54.209744 [info ] [MainThread]: 
21:39:54.209928 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
21:39:54.210238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe76e79040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe76e794c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe77409100>]}


============================== 2022-09-18 21:39:56.471677 | 5217f2b8-98e2-464f-8ad7-e2839e9521b1 ==============================
21:39:56.471677 [info ] [MainThread]: Running with dbt=1.0.0
21:39:56.475078 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step7_1'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
21:39:56.475318 [debug] [MainThread]: Tracking: tracking
21:39:56.475632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91c62c1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91c62c1d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91c62c1cd0>]}
21:39:56.669040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:39:56.669459 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:39:56.695355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5217f2b8-98e2-464f-8ad7-e2839e9521b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91c6247310>]}
21:39:56.742675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5217f2b8-98e2-464f-8ad7-e2839e9521b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91c82868e0>]}
21:39:56.743208 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:39:56.751012 [info ] [MainThread]: 
21:39:56.751644 [debug] [MainThread]: Acquiring new synapse connection "master"
21:39:56.752751 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
21:39:56.761747 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
21:39:56.761960 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
21:39:56.762088 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:39:56.762230 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:39:57.038098 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:39:57.067142 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.31 seconds
21:39:57.069306 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
21:39:57.090714 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
21:39:57.096572 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
21:39:57.096924 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
21:39:57.098589 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
21:39:57.098767 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
21:39:57.098898 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:39:57.099031 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:39:57.097171 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
21:39:57.100524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:39:57.100686 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:39:57.210148 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:39:57.212170 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:39:57.254955 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:39:57.256035 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:39:57.388503 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
21:39:57.388899 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
21:39:57.446492 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
21:39:57.446881 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
21:40:19.067894 [debug] [MainThread]: On master: COMMIT
21:40:19.068584 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
21:40:19.068913 [info ] [MainThread]: 
21:40:19.072015 [debug] [Thread-1  ]: Began running node model.Shawn.SZ_AH_Properties_FieldIDs
21:40:19.072483 [info ] [Thread-1  ]: 1 of 2 START table model stg.SZ_AH_Properties_FieldIDs.......................... [RUN]
21:40:19.072968 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.SZ_AH_Properties_FieldIDs"
21:40:19.073135 [debug] [Thread-1  ]: Began compiling node model.Shawn.SZ_AH_Properties_FieldIDs
21:40:19.073289 [debug] [Thread-1  ]: Compiling model.Shawn.SZ_AH_Properties_FieldIDs
21:40:19.072237 [debug] [Thread-2  ]: Began running node model.Shawn.SZ_AH_Properties_FieldType
21:40:19.076362 [info ] [Thread-2  ]: 2 of 2 START table model stg.SZ_AH_Properties_FieldType......................... [RUN]
21:40:19.076791 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.SZ_AH_Properties_FieldType"
21:40:19.076942 [debug] [Thread-2  ]: Began compiling node model.Shawn.SZ_AH_Properties_FieldType
21:40:19.077065 [debug] [Thread-2  ]: Compiling model.Shawn.SZ_AH_Properties_FieldType
21:40:19.079547 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.SZ_AH_Properties_FieldType"
21:40:19.076060 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.SZ_AH_Properties_FieldIDs"
21:40:19.080111 [debug] [Thread-1  ]: finished collecting timing info
21:40:19.080269 [debug] [Thread-1  ]: Began executing node model.Shawn.SZ_AH_Properties_FieldIDs
21:40:19.087851 [debug] [Thread-2  ]: finished collecting timing info
21:40:19.088025 [debug] [Thread-2  ]: Began executing node model.Shawn.SZ_AH_Properties_FieldType
21:40:19.255129 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.SZ_AH_Properties_FieldType"
21:40:19.256149 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.SZ_AH_Properties_FieldIDs"
21:40:19.256812 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldType".
21:40:19.257147 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldType: 
  
  if object_id ('"stg"."SZ_AH_Properties_FieldType__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."SZ_AH_Properties_FieldType__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."SZ_AH_Properties_FieldType__dbt_tmp"','U') is not null
    begin
    drop table "stg"."SZ_AH_Properties_FieldType__dbt_tmp"
    end


   EXEC('create view stg.SZ_AH_Properties_FieldType__dbt_tmp_temp_view as
    

select ''BoolNativeValue'' as column_name, ''bit'' as data_type union all
select ''StringNativeValue'' as column_name, ''nvarchar(4000)'' as data_type union all
select ''IntNativeValue'' as column_name, ''int'' as data_type union all
select ''DecimalNativeValue'' as column_name, ''decimal(10,2)'' as data_type union all
select ''DateTimeNativeValue'' as column_name, ''datetime'' as data_type union all
select ''EnumNativeValue'' as column_name, ''nvarchar(200)'' as data_type
    ');

  CREATE TABLE "stg"."SZ_AH_Properties_FieldType__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.SZ_AH_Properties_FieldType__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."SZ_AH_Properties_FieldType__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."SZ_AH_Properties_FieldType__dbt_tmp_temp_view"
    end



21:40:19.257270 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:40:19.257408 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:40:19.257055 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldIDs".
21:40:19.258827 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldIDs: 
  
  if object_id ('"stg"."SZ_AH_Properties_FieldIDs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."SZ_AH_Properties_FieldIDs__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."SZ_AH_Properties_FieldIDs__dbt_tmp"','U') is not null
    begin
    drop table "stg"."SZ_AH_Properties_FieldIDs__dbt_tmp"
    end


   EXEC('create view stg.SZ_AH_Properties_FieldIDs__dbt_tmp_temp_view as
    

select ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS Sequence,
            cf.name, 
            cf.id, 
            count(*) as cnt
        from stg.AH_Listingproperties_FinalView lp 
            inner join stg.AH_CustomFields_FinalView cf 
            on lp.CustomFieldID = cf.id
        group by cf.Name, cf.id
    ');

  CREATE TABLE "stg"."SZ_AH_Properties_FieldIDs__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.SZ_AH_Properties_FieldIDs__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."SZ_AH_Properties_FieldIDs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."SZ_AH_Properties_FieldIDs__dbt_tmp_temp_view"
    end



21:40:19.258974 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:40:19.259103 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:40:19.384887 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:40:19.385415 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:40:20.638686 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
21:40:20.657310 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldType".
21:40:20.657665 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldType: rename object "stg"."SZ_AH_Properties_FieldType" to SZ_AH_Properties_FieldType__dbt_backup
21:40:20.704687 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:40:20.718490 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldType".
21:40:20.718873 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldType: rename object "stg"."SZ_AH_Properties_FieldType__dbt_tmp" to SZ_AH_Properties_FieldType
21:40:20.762699 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:40:20.774484 [debug] [Thread-2  ]: On model.Shawn.SZ_AH_Properties_FieldType: COMMIT
21:40:20.782204 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldType".
21:40:20.782501 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldType: 
    
  if object_id ('"stg"."SZ_AH_Properties_FieldType__dbt_backup"','U') is not null
    begin
    drop table "stg"."SZ_AH_Properties_FieldType__dbt_backup"
    end

21:40:21.216342 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
21:40:21.228901 [debug] [Thread-2  ]: finished collecting timing info
21:40:21.229282 [debug] [Thread-2  ]: On model.Shawn.SZ_AH_Properties_FieldType: Close
21:40:21.230015 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5217f2b8-98e2-464f-8ad7-e2839e9521b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91bfd7d850>]}
21:40:21.230519 [info ] [Thread-2  ]: 2 of 2 OK created table model stg.SZ_AH_Properties_FieldType.................... [[32mOK[0m in 2.15s]
21:40:21.230942 [debug] [Thread-2  ]: Finished running node model.Shawn.SZ_AH_Properties_FieldType
21:40:22.110064 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.85 seconds
21:40:22.125187 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldIDs".
21:40:22.125508 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldIDs: rename object "stg"."SZ_AH_Properties_FieldIDs" to SZ_AH_Properties_FieldIDs__dbt_backup
21:40:22.165222 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:40:22.179333 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldIDs".
21:40:22.179676 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldIDs: rename object "stg"."SZ_AH_Properties_FieldIDs__dbt_tmp" to SZ_AH_Properties_FieldIDs
21:40:22.210477 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:40:22.212475 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_Properties_FieldIDs: COMMIT
21:40:22.216905 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldIDs".
21:40:22.217143 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldIDs: 
    
  if object_id ('"stg"."SZ_AH_Properties_FieldIDs__dbt_backup"','U') is not null
    begin
    drop table "stg"."SZ_AH_Properties_FieldIDs__dbt_backup"
    end

21:40:22.445442 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:40:22.458973 [debug] [Thread-1  ]: finished collecting timing info
21:40:22.459389 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_Properties_FieldIDs: Close
21:40:22.460153 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5217f2b8-98e2-464f-8ad7-e2839e9521b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91bfd38f40>]}
21:40:22.460626 [info ] [Thread-1  ]: 1 of 2 OK created table model stg.SZ_AH_Properties_FieldIDs..................... [[32mOK[0m in 3.39s]
21:40:22.460979 [debug] [Thread-1  ]: Finished running node model.Shawn.SZ_AH_Properties_FieldIDs
21:40:22.462288 [debug] [MainThread]: Acquiring new synapse connection "master"
21:40:22.462614 [debug] [MainThread]: On master: COMMIT
21:40:22.462973 [info ] [MainThread]: 
21:40:22.463246 [info ] [MainThread]: Finished running 2 table models in 25.71s.
21:40:22.463440 [debug] [MainThread]: Connection 'master' was properly closed.
21:40:22.463550 [debug] [MainThread]: Connection 'model.Shawn.SZ_AH_Properties_FieldIDs' was properly closed.
21:40:22.463650 [debug] [MainThread]: Connection 'model.Shawn.SZ_AH_Properties_FieldType' was properly closed.
21:40:22.491696 [info ] [MainThread]: 
21:40:22.492096 [info ] [MainThread]: [32mCompleted successfully[0m
21:40:22.492379 [info ] [MainThread]: 
21:40:22.492559 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
21:40:22.492851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91c6247790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91c8286c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91bfda8e20>]}


============================== 2022-09-18 21:40:24.846243 | 194aa7d9-237f-4d46-98e9-260007607b2d ==============================
21:40:24.846243 [info ] [MainThread]: Running with dbt=1.0.0
21:40:24.851125 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step7_2'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
21:40:24.851359 [debug] [MainThread]: Tracking: tracking
21:40:24.851676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9567671e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9567671ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9567671f40>]}
21:40:25.047906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:40:25.048280 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:40:25.074382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '194aa7d9-237f-4d46-98e9-260007607b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95675f52e0>]}
21:40:25.123535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '194aa7d9-237f-4d46-98e9-260007607b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95696368b0>]}
21:40:25.124087 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:40:25.132098 [info ] [MainThread]: 
21:40:25.132812 [debug] [MainThread]: Acquiring new synapse connection "master"
21:40:25.133878 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
21:40:25.142845 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
21:40:25.143075 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
21:40:25.143204 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:40:25.143349 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:40:25.436225 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:40:25.465536 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.32 seconds
21:40:25.467777 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
21:40:25.489588 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
21:40:25.495625 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
21:40:25.496029 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
21:40:25.497800 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
21:40:25.497998 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
21:40:25.498121 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:40:25.498255 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:40:25.496322 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
21:40:25.499822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:40:25.499990 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:40:25.630497 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:40:25.631148 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:40:25.667553 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:40:25.671355 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:40:25.800180 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
21:40:25.800582 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
21:40:25.850507 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
21:40:25.857916 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
21:40:47.652074 [debug] [MainThread]: On master: COMMIT
21:40:47.652791 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
21:40:47.653116 [info ] [MainThread]: 
21:40:47.656778 [debug] [Thread-1  ]: Began running node model.Shawn.SZ_AH_Properties_Value_ColumnMapping
21:40:47.657158 [info ] [Thread-1  ]: 1 of 1 START table model stg.SZ_AH_Properties_Value_ColumnMapping............... [RUN]
21:40:47.657646 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.SZ_AH_Properties_Value_ColumnMapping"
21:40:47.657811 [debug] [Thread-1  ]: Began compiling node model.Shawn.SZ_AH_Properties_Value_ColumnMapping
21:40:47.657957 [debug] [Thread-1  ]: Compiling model.Shawn.SZ_AH_Properties_Value_ColumnMapping
21:40:47.664686 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Value_ColumnMapping".
21:40:47.664891 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: 
    
    
SELECT distinct customfieldid FROM stg.AH_Listingproperties_FinalView where  customfieldid is not null
    

  
21:40:47.665010 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:40:47.665139 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:40:47.800370 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:40:48.055250 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
21:40:48.058160 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.SZ_AH_Properties_Value_ColumnMapping"
21:40:48.059054 [debug] [Thread-1  ]: finished collecting timing info
21:40:48.059257 [debug] [Thread-1  ]: Began executing node model.Shawn.SZ_AH_Properties_Value_ColumnMapping
21:40:48.151313 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.SZ_AH_Properties_Value_ColumnMapping"
21:40:48.152305 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Value_ColumnMapping".
21:40:48.152527 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: 
  
  if object_id ('"stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp"','U') is not null
    begin
    drop table "stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp"
    end


   EXEC('create view stg.SZ_AH_Properties_Value_ColumnMapping__dbt_tmp_temp_view as
    





    

    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161245,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',16575279,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',2533219,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19310753,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3723813,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673475,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19367902,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161225,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',14959150,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161205,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673478,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161242,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',1250225,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161202,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161016,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',9895950,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3744978,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161222,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',21259499,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',21806654,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',14589344,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',15658044,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161214,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673487,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673481,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',13549467,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161732,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',25897193,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161231,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161211,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673484,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',11102056,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161234,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161228,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',10045187,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161208,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161271,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',840228,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161237,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3760788,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',810052,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',26254668,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161243,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3737940,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673473,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19353344,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19310748,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19289629,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161217,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161240,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161008,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161735,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161014,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19310751,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19289626,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673490,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3901735,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',7052946,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161220,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',4507814,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673479,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161203,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',6529375,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',5282840,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161229,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161209,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161223,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',14589345,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',9888915,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673482,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161246,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19360781,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',2694977,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',1250223,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19367903,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',10045185,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161226,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673476,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161206,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161020,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673485,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3716724,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161235,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161736,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',810050,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',6557150,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161215,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161238,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673488,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',4016506,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',2080452,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161733,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161275,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',25897194,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161232,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',26431196,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161212,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',633102,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161241,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19310752,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673477,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161221,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',21833162,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',840229,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161244,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673474,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161204,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161012,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',2694972,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161224,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161218,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3752016,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673483,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',13724070,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161247,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19338647,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',1043518,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',1250224,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',23362439,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19367904,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',25897195,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161227,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161207,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',11102055,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',17214902,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673486,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',7635382,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673480,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3730851,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161230,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',26431194,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161210,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161018,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3708441,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161216,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161239,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161233,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161734,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19289625,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673489,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161219,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161213,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19346144,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',15658043,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161737,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161236,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',810051,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',2545215,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161010,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',21817611,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
    select ''''  as customfieldid, '''' as value_columnname  where 1=2

    ');

  CREATE TABLE "stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.SZ_AH_Properties_Value_ColumnMapping__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp_temp_view"
    end



21:41:39.042689 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 50.89 seconds
21:41:39.060878 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Value_ColumnMapping".
21:41:39.061232 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: rename object "stg"."SZ_AH_Properties_Value_ColumnMapping" to SZ_AH_Properties_Value_ColumnMapping__dbt_backup
21:41:39.102113 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:41:39.115296 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Value_ColumnMapping".
21:41:39.115638 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: rename object "stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp" to SZ_AH_Properties_Value_ColumnMapping
21:41:39.150394 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:41:39.161222 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: COMMIT
21:41:39.167897 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Value_ColumnMapping".
21:41:39.168242 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: 
    
  if object_id ('"stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_backup"','U') is not null
    begin
    drop table "stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_backup"
    end

21:41:39.630652 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.46 seconds
21:41:39.642393 [debug] [Thread-1  ]: finished collecting timing info
21:41:39.642809 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: Close
21:41:39.643598 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '194aa7d9-237f-4d46-98e9-260007607b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9565227dc0>]}
21:41:39.644114 [info ] [Thread-1  ]: 1 of 1 OK created table model stg.SZ_AH_Properties_Value_ColumnMapping.......... [[32mOK[0m in 51.99s]
21:41:39.644510 [debug] [Thread-1  ]: Finished running node model.Shawn.SZ_AH_Properties_Value_ColumnMapping
21:41:39.645868 [debug] [MainThread]: Acquiring new synapse connection "master"
21:41:39.646174 [debug] [MainThread]: On master: COMMIT
21:41:39.646505 [info ] [MainThread]: 
21:41:39.646802 [info ] [MainThread]: Finished running 1 table model in 74.51s.
21:41:39.646995 [debug] [MainThread]: Connection 'master' was properly closed.
21:41:39.647096 [debug] [MainThread]: Connection 'model.Shawn.SZ_AH_Properties_Value_ColumnMapping' was properly closed.
21:41:39.647204 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
21:41:39.676274 [info ] [MainThread]: 
21:41:39.676678 [info ] [MainThread]: [32mCompleted successfully[0m
21:41:39.676960 [info ] [MainThread]: 
21:41:39.677142 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
21:41:39.677429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f956518df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95676246d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f956737e460>]}


============================== 2022-09-18 21:41:42.048618 | a03dc86f-b4fd-4821-8051-46a26f3cafbb ==============================
21:41:42.048618 [info ] [MainThread]: Running with dbt=1.0.0
21:41:42.054893 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step7_3'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
21:41:42.055197 [debug] [MainThread]: Tracking: tracking
21:41:42.055549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5879cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5879cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5879cfa0>]}
21:41:42.260761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:41:42.261186 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:41:42.288057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a03dc86f-b4fd-4821-8051-46a26f3cafbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac587222e0>]}
21:41:42.339575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a03dc86f-b4fd-4821-8051-46a26f3cafbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5a75d8b0>]}
21:41:42.340088 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:41:42.348781 [info ] [MainThread]: 
21:41:42.349499 [debug] [MainThread]: Acquiring new synapse connection "master"
21:41:42.350707 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
21:41:42.359931 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
21:41:42.360221 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
21:41:42.360364 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:41:42.360511 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:41:42.666762 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:41:42.695730 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.34 seconds
21:41:42.697901 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
21:41:42.720629 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
21:41:42.726526 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
21:41:42.726943 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
21:41:42.728624 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
21:41:42.728803 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
21:41:42.728924 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:41:42.729051 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:41:42.727207 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
21:41:42.730603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:41:42.730776 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:41:42.838172 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:41:42.839406 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:41:42.876346 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:41:42.880935 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:41:43.026856 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
21:41:43.035887 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
21:41:43.069809 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
21:41:43.070231 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
21:42:05.115311 [debug] [MainThread]: On master: COMMIT
21:42:05.117647 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
21:42:05.119078 [info ] [MainThread]: 
21:42:05.131231 [debug] [Thread-1  ]: Began running node model.Shawn.SZ_AH_AllProperties_One_Column
21:42:05.132769 [debug] [Thread-2  ]: Began running node model.Shawn.SZ_AH_Properties_CustomFields_Lookup
21:42:05.134245 [info ] [Thread-2  ]: 2 of 2 START table model stg.SZ_AH_Properties_CustomFields_Lookup............... [RUN]
21:42:05.135558 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.SZ_AH_Properties_CustomFields_Lookup"
21:42:05.133435 [info ] [Thread-1  ]: 1 of 2 START table model stg.SZ_AH_AllProperties_One_Column..................... [RUN]
21:42:05.137358 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column"
21:42:05.135972 [debug] [Thread-2  ]: Began compiling node model.Shawn.SZ_AH_Properties_CustomFields_Lookup
21:42:05.137741 [debug] [Thread-1  ]: Began compiling node model.Shawn.SZ_AH_AllProperties_One_Column
21:42:05.139225 [debug] [Thread-1  ]: Compiling model.Shawn.SZ_AH_AllProperties_One_Column
21:42:05.138617 [debug] [Thread-2  ]: Compiling model.Shawn.SZ_AH_Properties_CustomFields_Lookup
21:42:05.153289 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.SZ_AH_Properties_CustomFields_Lookup"
21:42:05.160939 [debug] [Thread-2  ]: finished collecting timing info
21:42:05.161173 [debug] [Thread-2  ]: Began executing node model.Shawn.SZ_AH_Properties_CustomFields_Lookup
21:42:05.160295 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:05.171901 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
    SELECT id FROM stg.SZ_AH_Properties_FieldIDs 

  
21:42:05.172140 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:42:05.172300 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:42:05.270111 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.SZ_AH_Properties_CustomFields_Lookup"
21:42:05.270955 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_CustomFields_Lookup".
21:42:05.271155 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_CustomFields_Lookup: 
  
  if object_id ('"stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp"','U') is not null
    begin
    drop table "stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp"
    end


   EXEC('create view stg.SZ_AH_Properties_CustomFields_Lookup__dbt_tmp_temp_view as
    
select 
    a.*, 
    c.name,
    b.data_type,
           case when b.data_type = ''nvarchar(4000)'' then c.name + '' nvarchar(4000)''
                when b.data_type = ''nvarchar(200)'' then c.name + '' nvarchar(200)''
                when b.data_type = ''decimal(10,2)'' then c.name + '' decimal(11,2)''
                when b.data_type = ''bit'' then c.name + '' bit''
                when b.data_type = ''int'' then c.name + '' bigint''
                when b.data_type = ''datetime'' then c.name + '' datetime''
           end  as col_definition_str,       
           case when b.data_type = ''nvarchar(4000)'' then ''cast('' + c.name + '' as nvarchar(4000)) as '' + c.name 
                when b.data_type = ''nvarchar(200)'' then ''cast('' + c.name + '' as nvarchar(200)) as '' + c.name 
                when b.data_type = ''decimal(10,2)'' then ''cast(cast('' + c.name + '' as nvarchar(10)) as decimal(11,2)) as '' + c.name
                when b.data_type = ''bit'' then ''cast(cast('' + c.name + '' as nvarchar(1)) as bit) as '' + c.name 
                when b.data_type = ''int'' then ''cast(cast('' + c.name + '' as nvarchar(9)) as bigint) as '' + c.name 
                when b.data_type = ''datetime'' then ''cast(cast('' + c.name + '' as nvarchar(23)) as datetime) as '' + c.name 
            end  as col_type_cast
from stg.SZ_AH_Properties_Value_ColumnMapping a
            left join stg.SZ_AH_Properties_FieldType b 
                on a.value_columnname = b.column_name
            left join stg.SZ_AH_Properties_FieldIDs c
                on a.customfieldid = c.id
where a.customfieldid not in (9895950, 9888915, 6529375) -- remove duplicates
    ');

  CREATE TABLE "stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.SZ_AH_Properties_CustomFields_Lookup__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp_temp_view"
    end



21:42:05.271277 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:42:05.271418 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:42:05.292586 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:42:05.392236 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:42:05.408382 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:42:05.411612 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:05.411955 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3752016
        
  
21:42:06.935119 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.52 seconds
21:42:06.937036 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:06.937277 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 4507814
        
  
21:42:07.050877 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:07.052794 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:07.053032 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 7052946
        
  
21:42:07.184586 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:42:07.186524 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:07.187492 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 10045185
        
  
21:42:07.307886 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:07.309862 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:07.310137 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 13549467
        
  
21:42:07.417149 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:07.419149 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:07.419411 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 14959150
        
  
21:42:07.560421 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:42:07.562382 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:07.562681 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 17214902
        
  
21:42:07.679305 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:07.681267 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:07.681525 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19310748
        
  
21:42:07.793782 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:07.795763 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:07.796008 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19338647
        
  
21:42:07.924983 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:42:07.926999 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:07.927253 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19367902
        
  
21:42:08.047373 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:08.049641 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:08.049866 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 21806654
        
  
21:42:08.165464 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:08.167434 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:08.167696 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 25897193
        
  
21:42:08.285518 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:08.287514 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:08.287788 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 26431194
        
  
21:42:08.399831 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:08.401867 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:08.402195 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161008
        
  
21:42:08.547239 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:42:08.549165 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:08.549409 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161016
        
  
21:42:08.682436 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:42:08.684419 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:08.684688 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161203
        
  
21:42:08.802510 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:08.804432 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:08.804684 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161207
        
  
21:42:08.933618 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:42:08.935630 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:08.935890 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161211
        
  
21:42:09.059307 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:09.061303 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:09.061566 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161215
        
  
21:42:09.183360 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:09.185342 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:09.185624 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161219
        
  
21:42:09.316729 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:42:09.318792 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:09.319476 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161223
        
  
21:42:09.471691 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:42:09.473643 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:09.473894 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161227
        
  
21:42:09.600669 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:42:09.602637 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:09.602898 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161231
        
  
21:42:09.728719 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:42:09.730704 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:09.730997 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161235
        
  
21:42:10.576609 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.85 seconds
21:42:10.578476 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:10.578690 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161239
        
  
21:42:10.663076 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 5.39 seconds
21:42:10.682722 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_CustomFields_Lookup".
21:42:10.682967 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:42:10.684676 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:10.684904 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161243
        
  
21:42:10.683194 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_CustomFields_Lookup: rename object "stg"."SZ_AH_Properties_CustomFields_Lookup" to SZ_AH_Properties_CustomFields_Lookup__dbt_backup
21:42:10.808118 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:10.822103 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:42:10.823695 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:10.823921 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161247
        
  
21:42:10.824526 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_CustomFields_Lookup".
21:42:10.824700 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_CustomFields_Lookup: rename object "stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp" to SZ_AH_Properties_CustomFields_Lookup
21:42:10.854146 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:42:10.864976 [debug] [Thread-2  ]: On model.Shawn.SZ_AH_Properties_CustomFields_Lookup: COMMIT
21:42:10.871677 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_CustomFields_Lookup".
21:42:10.871970 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_CustomFields_Lookup: 
    
  if object_id ('"stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_backup"','U') is not null
    begin
    drop table "stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_backup"
    end

21:42:10.926989 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:42:10.928774 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:10.929011 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161733
        
  
21:42:11.046655 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:11.048586 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:11.048831 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161737
        
  
21:42:11.086775 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:42:11.099570 [debug] [Thread-2  ]: finished collecting timing info
21:42:11.099965 [debug] [Thread-2  ]: On model.Shawn.SZ_AH_Properties_CustomFields_Lookup: Close
21:42:11.100708 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a03dc86f-b4fd-4821-8051-46a26f3cafbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac565da340>]}
21:42:11.101206 [info ] [Thread-2  ]: 2 of 2 OK created table model stg.SZ_AH_Properties_CustomFields_Lookup.......... [[32mOK[0m in 5.97s]
21:42:11.101581 [debug] [Thread-2  ]: Finished running node model.Shawn.SZ_AH_Properties_CustomFields_Lookup
21:42:11.165826 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:11.167673 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:11.167910 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673475
        
  
21:42:11.291254 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:11.293301 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:11.293542 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673479
        
  
21:42:11.414209 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:11.416189 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:11.416432 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673483
        
  
21:42:11.533034 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:11.534998 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:11.535257 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673487
        
  
21:42:11.682440 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:42:11.684341 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:11.684583 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 810050
        
  
21:42:11.806201 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:11.808201 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:11.808455 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 840229
        
  
21:42:11.925589 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:11.927565 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:11.927816 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 1250225
        
  
21:42:12.054413 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:42:12.056394 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:12.056648 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 2694972
        
  
21:42:12.164668 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:12.166666 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:12.166925 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3723813
        
  
21:42:12.275119 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:12.277147 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:12.277392 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3760788
        
  
21:42:12.387525 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:12.389497 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:12.389744 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 5282840
        
  
21:42:12.514123 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:12.516081 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:12.516359 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 7635382
        
  
21:42:12.626979 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:12.628881 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:12.629113 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 10045187
        
  
21:42:12.830461 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:42:12.832410 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:12.832661 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 13724070
        
  
21:42:12.941529 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:12.943478 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:12.943720 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 15658043
        
  
21:42:13.049150 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:13.051080 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:13.051323 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19289625
        
  
21:42:13.164955 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:13.166916 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:13.167165 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19310751
        
  
21:42:13.275656 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:13.277556 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:13.277785 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19346144
        
  
21:42:13.384590 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:13.386496 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:13.386767 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19367903
        
  
21:42:13.500910 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:13.502869 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:13.503112 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 21817611
        
  
21:42:13.613415 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:13.615220 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:13.615446 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 25897194
        
  
21:42:13.725730 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:13.727726 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:13.727976 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 26431196
        
  
21:42:13.839378 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:13.841859 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:13.842167 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161010
        
  
21:42:13.950931 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:13.952876 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:13.953150 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161018
        
  
21:42:14.103030 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:42:14.104940 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:14.105180 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161204
        
  
21:42:14.219173 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:14.221078 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:14.221317 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161208
        
  
21:42:14.329229 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:14.331161 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:14.331398 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161212
        
  
21:42:14.474973 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:42:14.476875 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:14.477122 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161216
        
  
21:42:14.606753 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:42:14.608657 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:14.608910 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161220
        
  
21:42:14.726240 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:14.728200 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:14.728442 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161224
        
  
21:42:14.837335 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:14.839288 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:14.839527 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161228
        
  
21:42:14.958249 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:14.960222 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:14.960457 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161232
        
  
21:42:15.156920 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:42:15.159017 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:15.159264 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161236
        
  
21:42:15.285322 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:42:15.287735 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:15.287982 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161240
        
  
21:42:15.407414 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:15.409335 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:15.409564 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161244
        
  
21:42:15.520073 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:15.522010 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:15.522252 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161271
        
  
21:42:15.627065 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:42:15.628987 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:15.629224 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161734
        
  
21:42:15.735208 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:15.737153 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:15.737409 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 633102
        
  
21:42:15.849200 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:15.851129 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:15.851378 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673476
        
  
21:42:16.043761 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:42:16.045679 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:16.045918 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673480
        
  
21:42:16.202701 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:42:16.204557 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:16.204811 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673484
        
  
21:42:16.397131 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:42:16.399075 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:16.399316 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673488
        
  
21:42:16.566223 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:42:16.568156 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:16.568402 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 810051
        
  
21:42:16.683710 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:16.685685 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:16.685932 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 1043518
        
  
21:42:16.863372 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:42:16.865666 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:16.865932 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 2080452
        
  
21:42:17.032218 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:42:17.034143 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:17.034367 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 2694977
        
  
21:42:17.175886 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:42:17.177786 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:17.178036 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3730851
        
  
21:42:17.300702 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:17.302638 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:17.302880 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3901735
        
  
21:42:17.430673 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:42:17.432540 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:17.432765 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 6529375
        
  
21:42:17.580841 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:42:17.582809 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:17.583067 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 9888915
        
  
21:42:17.721739 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:42:17.723695 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:17.723943 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 11102055
        
  
21:42:17.830749 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:17.832691 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:17.832942 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 14589344
        
  
21:42:17.941878 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:17.943815 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:17.944059 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 15658044
        
  
21:42:18.071102 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:42:18.073045 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:18.073288 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19289626
        
  
21:42:18.195278 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:18.197260 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:18.197502 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19310752
        
  
21:42:18.312466 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:18.314792 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:18.315024 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19353344
        
  
21:42:18.419912 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:42:18.421840 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:18.422089 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19367904
        
  
21:42:18.528668 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:18.530640 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:18.530882 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 21833162
        
  
21:42:18.647015 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:18.648927 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:18.649160 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 25897195
        
  
21:42:18.759099 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:18.760971 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:18.761217 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161012
        
  
21:42:19.071383 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
21:42:19.073286 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:19.073534 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161020
        
  
21:42:19.200759 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:42:19.203333 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:19.203590 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161205
        
  
21:42:19.318856 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:19.320766 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:19.321012 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161209
        
  
21:42:19.426534 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:19.428459 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:19.428715 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161213
        
  
21:42:19.552120 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:19.554078 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:19.554314 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161217
        
  
21:42:19.677410 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:19.679362 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:19.679596 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161221
        
  
21:42:19.786207 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:19.788473 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:19.788712 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161225
        
  
21:42:20.269295 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.48 seconds
21:42:20.271142 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:20.271323 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161229
        
  
21:42:20.410948 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:42:20.412850 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:20.413078 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161233
        
  
21:42:20.565628 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:42:20.567577 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:20.567819 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161237
        
  
21:42:20.705512 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:42:20.707463 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:20.707693 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161241
        
  
21:42:20.843236 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:42:20.845146 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:20.845382 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161245
        
  
21:42:20.960527 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:20.962437 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:20.962692 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161275
        
  
21:42:21.070616 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:21.072512 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:21.072740 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161735
        
  
21:42:21.192276 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:21.194186 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:21.194407 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673473
        
  
21:42:21.304956 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:21.306899 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:21.307170 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673477
        
  
21:42:21.423411 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:21.425364 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:21.425602 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673481
        
  
21:42:21.532674 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:21.534979 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:21.535210 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673485
        
  
21:42:21.667115 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:42:21.669024 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:21.669260 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673489
        
  
21:42:21.799113 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:42:21.801292 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:21.801535 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 810052
        
  
21:42:22.103168 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:42:22.105104 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:22.105353 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 1250223
        
  
21:42:22.226611 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:22.228497 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:22.228739 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 2533219
        
  
21:42:22.333244 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:42:22.335192 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:22.335424 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3708441
        
  
21:42:22.450890 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:22.452806 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:22.453038 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3737940
        
  
21:42:22.565595 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:22.567554 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:22.567813 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 4016506
        
  
21:42:22.712404 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:42:22.714321 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:22.714580 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 6557150
        
  
21:42:22.828880 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:22.830878 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:22.831117 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 9895950
        
  
21:42:22.942622 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:22.944581 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:22.944847 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 11102056
        
  
21:42:23.320406 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.38 seconds
21:42:23.322789 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:23.323013 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 14589345
        
  
21:42:23.453236 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:42:23.455198 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:23.455450 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 16575279
        
  
21:42:23.609344 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:42:23.611303 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:23.611578 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19289629
        
  
21:42:23.739671 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:42:23.741592 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:23.741828 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19310753
        
  
21:42:23.851310 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:23.853232 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:23.853466 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19360781
        
  
21:42:23.972601 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:23.974757 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:23.975015 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 21259499
        
  
21:42:24.100333 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:42:24.102235 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:24.102483 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 23362439
        
  
21:42:24.219576 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:24.221487 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:24.221745 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 26254668
        
  
21:42:24.339740 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:24.341680 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:24.341956 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161014
        
  
21:42:24.461857 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:24.463831 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:24.464076 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161202
        
  
21:42:24.577404 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:24.579381 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:24.579631 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161206
        
  
21:42:24.700192 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:24.702673 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:24.702903 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161210
        
  
21:42:24.960705 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:42:24.962643 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:24.962883 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161214
        
  
21:42:25.103317 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:42:25.105216 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:25.105473 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161218
        
  
21:42:25.241499 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:42:25.243456 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:25.243705 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161222
        
  
21:42:25.350351 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:25.352311 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:25.352544 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161226
        
  
21:42:25.458021 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:25.459960 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:25.460201 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161230
        
  
21:42:25.580641 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:25.582587 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:25.582823 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161234
        
  
21:42:25.691594 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:25.693522 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:25.693779 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161238
        
  
21:42:25.804267 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:25.806173 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:25.806434 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161242
        
  
21:42:25.915217 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:25.917131 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:25.917366 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161246
        
  
21:42:26.041732 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:26.043754 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:26.044032 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161732
        
  
21:42:26.360454 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
21:42:26.362830 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:26.363057 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161736
        
  
21:42:26.561979 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:42:26.563915 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:26.564158 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673474
        
  
21:42:26.727570 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:42:26.729510 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:26.729747 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673478
        
  
21:42:26.852867 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:42:26.855192 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:26.855449 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673482
        
  
21:42:26.965273 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:26.967227 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:26.967470 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673486
        
  
21:42:27.078619 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:27.080510 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:27.080758 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673490
        
  
21:42:27.186885 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:27.188753 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:27.188976 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 840228
        
  
21:42:27.294929 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:27.296837 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:27.297071 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 1250224
        
  
21:42:27.402384 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:27.404302 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:27.404546 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 2545215
        
  
21:42:27.514694 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:42:27.516585 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:27.516823 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3716724
        
  
21:42:27.794696 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:42:27.796586 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:27.796838 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3744978
        
  
21:42:27.953615 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:42:27.955948 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.SZ_AH_AllProperties_One_Column"
21:42:27.956645 [debug] [Thread-1  ]: finished collecting timing info
21:42:27.956842 [debug] [Thread-1  ]: Began executing node model.Shawn.SZ_AH_AllProperties_One_Column
21:42:28.020852 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.SZ_AH_AllProperties_One_Column"
21:42:28.021649 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:42:28.021856 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
  
  if object_id ('"stg"."SZ_AH_AllProperties_One_Column__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."SZ_AH_AllProperties_One_Column__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."SZ_AH_AllProperties_One_Column__dbt_tmp"','U') is not null
    begin
    drop table "stg"."SZ_AH_AllProperties_One_Column__dbt_tmp"
    end


   EXEC('create view stg.SZ_AH_AllProperties_One_Column__dbt_tmp_temp_view as
    





    

    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3752016

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 4507814

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 7052946

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 10045185

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 13549467

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 14959150

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 17214902

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19310748

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19338647

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19367902

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 21806654

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 25897193

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DateTimeNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 26431194

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161008

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161016

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161203

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161207

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161211

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161215

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161219

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161223

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161227

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161231

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161235

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161239

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161243

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161247

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161733

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161737

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673475

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673479

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673483

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673487

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 810050

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 840229

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 1250225

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 2694972

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3723813

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3760788

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 5282840

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 7635382

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 10045187

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 13724070

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 15658043

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19289625

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19310751

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19346144

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19367903

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 21817611

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 25897194

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 26431196

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161010

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161018

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161204

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161208

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161212

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161216

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161220

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161224

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161228

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161232

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161236

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161240

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161244

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161271

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161734

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 633102

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673476

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673480

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673484

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673488

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 810051

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 1043518

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 2080452

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 2694977

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3730851

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3901735

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 6529375

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 9888915

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 11102055

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 14589344

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(IntNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 15658044

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19289626

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19310752

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19353344

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19367904

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 21833162

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 25897195

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161012

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161020

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161205

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161209

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161213

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161217

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161221

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161225

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161229

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161233

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161237

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(IntNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161241

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161245

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161275

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161735

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673473

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673477

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673481

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673485

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673489

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 810052

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 1250223

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 2533219

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3708441

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3737940

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 4016506

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 6557150

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 9895950

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 11102056

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 14589345

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 16575279

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19289629

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19310753

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19360781

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 21259499

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 23362439

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 26254668

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161014

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161202

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161206

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161210

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161214

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161218

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161222

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161226

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161230

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161234

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161238

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161242

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161246

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161732

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161736

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673474

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673478

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673482

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673486

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673490

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(IntNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 840228

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 1250224

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 2545215

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3716724

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3744978

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
    select 
        '''' as listingid, '''' as customfieldid, '''' as customfieldname, '''' as customfieldvalue 
    where 2=1

    ');

  CREATE TABLE "stg"."SZ_AH_AllProperties_One_Column__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.SZ_AH_AllProperties_One_Column__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."SZ_AH_AllProperties_One_Column__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."SZ_AH_AllProperties_One_Column__dbt_tmp_temp_view"
    end



21:43:21.964848 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 53.94 seconds
21:43:21.979231 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:43:21.979555 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: rename object "stg"."SZ_AH_AllProperties_One_Column" to SZ_AH_AllProperties_One_Column__dbt_backup
21:43:22.059482 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:43:22.074051 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:43:22.074577 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: rename object "stg"."SZ_AH_AllProperties_One_Column__dbt_tmp" to SZ_AH_AllProperties_One_Column
21:43:22.109237 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:43:22.111167 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_AllProperties_One_Column: COMMIT
21:43:22.115110 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
21:43:22.115310 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
  if object_id ('"stg"."SZ_AH_AllProperties_One_Column__dbt_backup"','U') is not null
    begin
    drop table "stg"."SZ_AH_AllProperties_One_Column__dbt_backup"
    end

21:43:22.445356 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
21:43:22.458430 [debug] [Thread-1  ]: finished collecting timing info
21:43:22.458836 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_AllProperties_One_Column: Close
21:43:22.459601 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a03dc86f-b4fd-4821-8051-46a26f3cafbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac56257d60>]}
21:43:22.460069 [info ] [Thread-1  ]: 1 of 2 OK created table model stg.SZ_AH_AllProperties_One_Column................ [[32mOK[0m in 77.32s]
21:43:22.460442 [debug] [Thread-1  ]: Finished running node model.Shawn.SZ_AH_AllProperties_One_Column
21:43:22.461874 [debug] [MainThread]: Acquiring new synapse connection "master"
21:43:22.462169 [debug] [MainThread]: On master: COMMIT
21:43:22.462493 [info ] [MainThread]: 
21:43:22.462778 [info ] [MainThread]: Finished running 2 table models in 100.11s.
21:43:22.462972 [debug] [MainThread]: Connection 'master' was properly closed.
21:43:22.463076 [debug] [MainThread]: Connection 'model.Shawn.SZ_AH_AllProperties_One_Column' was properly closed.
21:43:22.463176 [debug] [MainThread]: Connection 'model.Shawn.SZ_AH_Properties_CustomFields_Lookup' was properly closed.
21:43:22.492348 [info ] [MainThread]: 
21:43:22.492767 [info ] [MainThread]: [32mCompleted successfully[0m
21:43:22.493051 [info ] [MainThread]: 
21:43:22.493244 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
21:43:22.493548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac58722640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5a75dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac562ffdf0>]}


============================== 2022-09-18 21:43:24.746749 | aa77f7f7-dac4-4728-a22c-74f6d1bba70a ==============================
21:43:24.746749 [info ] [MainThread]: Running with dbt=1.0.0
21:43:24.747447 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step7_4'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
21:43:24.747680 [debug] [MainThread]: Tracking: tracking
21:43:24.748020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29ec144a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29ec144d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29ec144cd0>]}
21:43:24.937869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:43:24.938257 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:43:24.964359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa77f7f7-dac4-4728-a22c-74f6d1bba70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29ec0ca310>]}
21:43:25.017315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa77f7f7-dac4-4728-a22c-74f6d1bba70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29ee10c8e0>]}
21:43:25.017789 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:43:25.025491 [info ] [MainThread]: 
21:43:25.026089 [debug] [MainThread]: Acquiring new synapse connection "master"
21:43:25.027102 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
21:43:25.035944 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
21:43:25.036139 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
21:43:25.036264 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:43:25.036401 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:43:25.373569 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:43:25.399970 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.36 seconds
21:43:25.402103 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
21:43:25.423897 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
21:43:25.429683 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
21:43:25.430171 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
21:43:25.431798 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
21:43:25.431978 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
21:43:25.432097 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:43:25.432223 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:43:25.430347 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
21:43:25.433731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:43:25.433892 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:43:25.552872 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:43:25.553533 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:43:25.591946 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:43:25.593542 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:43:25.642123 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
21:43:25.707180 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
21:43:25.789023 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
21:43:25.799684 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
21:43:47.167654 [debug] [MainThread]: On master: COMMIT
21:43:47.168276 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
21:43:47.168591 [info ] [MainThread]: 
21:43:47.172134 [debug] [Thread-1  ]: Began running node model.Shawn.SZ_AH_Properties_Pivot
21:43:47.172508 [info ] [Thread-1  ]: 1 of 1 START table model dbo.SZ_AH_Properties_Pivot............................. [RUN]
21:43:47.172976 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.SZ_AH_Properties_Pivot"
21:43:47.173141 [debug] [Thread-1  ]: Began compiling node model.Shawn.SZ_AH_Properties_Pivot
21:43:47.173291 [debug] [Thread-1  ]: Compiling model.Shawn.SZ_AH_Properties_Pivot
21:43:47.182297 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Pivot".
21:43:47.182529 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Pivot: 
    
    select name from stg.SZ_AH_Properties_CustomFields_Lookup where name != 'listingid'

  
21:43:47.182683 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:43:47.182821 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:43:47.317424 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:43:48.052473 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.87 seconds
21:43:48.069793 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Pivot".
21:43:48.070150 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Pivot: 
    
    select col_type_cast  from stg.SZ_AH_Properties_CustomFields_Lookup

  
21:43:48.161438 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:43:48.180726 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.SZ_AH_Properties_Pivot"
21:43:48.181472 [debug] [Thread-1  ]: finished collecting timing info
21:43:48.181680 [debug] [Thread-1  ]: Began executing node model.Shawn.SZ_AH_Properties_Pivot
21:43:48.247697 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.SZ_AH_Properties_Pivot"
21:43:48.248430 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Pivot".
21:43:48.248628 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Pivot: 
  
  if object_id ('"dbo"."SZ_AH_Properties_Pivot__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."SZ_AH_Properties_Pivot__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."SZ_AH_Properties_Pivot__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."SZ_AH_Properties_Pivot__dbt_tmp"
    end


   EXEC('create view dbo.SZ_AH_Properties_Pivot__dbt_tmp_temp_view as
    









    

    

 







    
    

 

WITH pivot_data_input AS
(
    SELECT 
        listingid, -- Grouping Column
        customfieldname, -- Spreading Column
        customfieldvalue -- Aggregate Column
    FROM [stg].[SZ_AH_AllProperties_One_Column] 
        -- [TEST] where listingid = 10023682
),
pivoted_data AS
(
    SELECT 
        listingid, [IsPromoVehicle], [Specialist_Section_Comp2_Info], [CarfaxPassFailError], [LeadSource], [MakeWholeAmount], [Photo_Plan_Status], [VehicleStoryDescriptionInterior], [UI_ListingStateHold], [VehicleStoryDescriptionCarFax], [Acct_Rep_Phone], [OriginalEngineText], [HasProMarketing], [BeenListed], [Copy_Writer], [CarfaxPassFail], [Specialist_Section_Comp1_Info], [CaliforniaSmogCheck], [Modifications], [ListingState], [HideListing], [Specialist_Section_Notes], [Era], [VehicleStoryDescriptionUndercarriage], [CarfaxLink], [ListingNotes], [IsPaid], [AddressLine2], [PremiumListing], [DealerName], [Mileage], [VehicleStoryDescriptionInterior2], [VehicleStoryDescriptionInteriorPictures], [Rust], [VehicleStoryDescriptionEngineTransmissionPictures], [BuyItNow], [LockUsername], [Curated], [VehicleStoryOpeningStatementPictures], [NoReserveCheck], [MagicBoxSection4], [CCID], [OdometerUnits], [VehicleStoryDescriptionInterior2Pictures], [VehicleStoryDescriptionUndercarriagePictures], [WGL_Public_Report], [MakeOfferAvailable], [Utm_Medium_Listing_Submission], [ListingProgress], [IsEdited], [TransmissionText], [EstimatedMarketValue], [StateProvinceRegion], [PaintWorkText], [ReservePriceCL], [VehicleStoryDescriptionExterior], [Decade], [Specialist_Section_Comp5_Price], [ReservePrice], [VehicleStoryDescriptionExteriorPictures], [HaveAllPhotos], [Address], [Specialist_Section_Comp3_Info], [IsTaxable], [IsApproved], [CounterReserve], [VehicleStoryDescriptionExterior2], [TargetReserve], [PersonalMileage], [VehicleStoryDescriptionEngineTransmission], [SnapprPackage], [DraftEmailNotificationSent], [Specialist_Section_Comp5_Info], [BuyItNowUsed], [Acct_Rep], [Taxonomy], [Copy_Writer_Feedback], [Comped], [WhereDidYouHearAboutUsListingOther], [HasMagicBox], [HasDealerFee], [Specialist_Section_Comp2_Price], [SchedulingComplete], [MagicBoxSection6], [ReserveReviewEmailDate], [MagicBoxSection5], [LastServiceInformation], [BeenListedText], [VIN], [Zip], [ServiceRecords], [MagicBoxSection3], [Acct_Rep_Email], [MarketValue], [VehicleStory], [VehicleColor], [SpinCarLink], [MagicBoxSection2], [UserComments], [PackageTransactionId], [Transmission], [Specialist_Section_Comp4_Info], [Copy_Writer_Status], [Commission], [MagicBoxSection1], [StartingBid], [MakeOfferAllowed], [FixedPrice], [HasProPhotography], [Model], [EngineSize], [OriginalEngine], [IsFeaturedVehicle], [Utm_Source_Listing_Submission], [Year], [PhotoPlanId], [DealerURL], [ExpertVideoReview], [HowLongOwned], [Specialist_Section_Comp4_Price], [AnythingElseWeShouldKnow], [Photo_Plan], [BeenModified], [CurrentIssues], [VehicleStoryDescriptionCarFaxPictures], [Specialist], [Utm_Campaign_Listing_Submission], [CountryOfOrigin], [Specialist_Section_Original_Reserve], [VehicleTitle], [PaintWork], [Make], [CityCL], [WhereDidYouHearAboutUsListing], [TransactionId], [MileageAccurate], [CommissionOverrideReason], [Acct_Rep_Name], [VehicleStoryDescriptionExterior2Pictures], [DealerFees], [Dealer], [CarTitleInYourName], [CountryCL], [WhereDidYouHearAboutUsListingReferral], [VehicleStoryOpeningStatement], [MaxReserve], [Specialist_Section_Comp3_Price], [Specialist_Section_Comp1_Price]
    FROM pivot_data_input
    PIVOT (
        max(customfieldvalue) for customfieldname in ( [IsPromoVehicle], [Specialist_Section_Comp2_Info], [CarfaxPassFailError], [LeadSource], [MakeWholeAmount], [Photo_Plan_Status], [VehicleStoryDescriptionInterior], [UI_ListingStateHold], [VehicleStoryDescriptionCarFax], [Acct_Rep_Phone], [OriginalEngineText], [HasProMarketing], [BeenListed], [Copy_Writer], [CarfaxPassFail], [Specialist_Section_Comp1_Info], [CaliforniaSmogCheck], [Modifications], [ListingState], [HideListing], [Specialist_Section_Notes], [Era], [VehicleStoryDescriptionUndercarriage], [CarfaxLink], [ListingNotes], [IsPaid], [AddressLine2], [PremiumListing], [DealerName], [Mileage], [VehicleStoryDescriptionInterior2], [VehicleStoryDescriptionInteriorPictures], [Rust], [VehicleStoryDescriptionEngineTransmissionPictures], [BuyItNow], [LockUsername], [Curated], [VehicleStoryOpeningStatementPictures], [NoReserveCheck], [MagicBoxSection4], [CCID], [OdometerUnits], [VehicleStoryDescriptionInterior2Pictures], [VehicleStoryDescriptionUndercarriagePictures], [WGL_Public_Report], [MakeOfferAvailable], [Utm_Medium_Listing_Submission], [ListingProgress], [IsEdited], [TransmissionText], [EstimatedMarketValue], [StateProvinceRegion], [PaintWorkText], [ReservePriceCL], [VehicleStoryDescriptionExterior], [Decade], [Specialist_Section_Comp5_Price], [ReservePrice], [VehicleStoryDescriptionExteriorPictures], [HaveAllPhotos], [Address], [Specialist_Section_Comp3_Info], [IsTaxable], [IsApproved], [CounterReserve], [VehicleStoryDescriptionExterior2], [TargetReserve], [PersonalMileage], [VehicleStoryDescriptionEngineTransmission], [SnapprPackage], [DraftEmailNotificationSent], [Specialist_Section_Comp5_Info], [BuyItNowUsed], [Acct_Rep], [Taxonomy], [Copy_Writer_Feedback], [Comped], [WhereDidYouHearAboutUsListingOther], [HasMagicBox], [HasDealerFee], [Specialist_Section_Comp2_Price], [SchedulingComplete], [MagicBoxSection6], [ReserveReviewEmailDate], [MagicBoxSection5], [LastServiceInformation], [BeenListedText], [VIN], [Zip], [ServiceRecords], [MagicBoxSection3], [Acct_Rep_Email], [MarketValue], [VehicleStory], [VehicleColor], [SpinCarLink], [MagicBoxSection2], [UserComments], [PackageTransactionId], [Transmission], [Specialist_Section_Comp4_Info], [Copy_Writer_Status], [Commission], [MagicBoxSection1], [StartingBid], [MakeOfferAllowed], [FixedPrice], [HasProPhotography], [Model], [EngineSize], [OriginalEngine], [IsFeaturedVehicle], [Utm_Source_Listing_Submission], [Year], [PhotoPlanId], [DealerURL], [ExpertVideoReview], [HowLongOwned], [Specialist_Section_Comp4_Price], [AnythingElseWeShouldKnow], [Photo_Plan], [BeenModified], [CurrentIssues], [VehicleStoryDescriptionCarFaxPictures], [Specialist], [Utm_Campaign_Listing_Submission], [CountryOfOrigin], [Specialist_Section_Original_Reserve], [VehicleTitle], [PaintWork], [Make], [CityCL], [WhereDidYouHearAboutUsListing], [TransactionId], [MileageAccurate], [CommissionOverrideReason], [Acct_Rep_Name], [VehicleStoryDescriptionExterior2Pictures], [DealerFees], [Dealer], [CarTitleInYourName], [CountryCL], [WhereDidYouHearAboutUsListingReferral], [VehicleStoryOpeningStatement], [MaxReserve], [Specialist_Section_Comp3_Price], [Specialist_Section_Comp1_Price])
    )as pvt
)


select 
    listingid, [IsPromoVehicle], [Specialist_Section_Comp2_Info], [CarfaxPassFailError], [LeadSource], [MakeWholeAmount], [Photo_Plan_Status], [VehicleStoryDescriptionInterior], [UI_ListingStateHold], [VehicleStoryDescriptionCarFax], [Acct_Rep_Phone], [OriginalEngineText], [HasProMarketing], [BeenListed], [Copy_Writer], [CarfaxPassFail], [Specialist_Section_Comp1_Info], [CaliforniaSmogCheck], [Modifications], [ListingState], [HideListing], [Specialist_Section_Notes], [Era], [VehicleStoryDescriptionUndercarriage], [CarfaxLink], [ListingNotes], [IsPaid], [AddressLine2], [PremiumListing], [DealerName], [Mileage], [VehicleStoryDescriptionInterior2], [VehicleStoryDescriptionInteriorPictures], [Rust], [VehicleStoryDescriptionEngineTransmissionPictures], [BuyItNow], [LockUsername], [Curated], [VehicleStoryOpeningStatementPictures], [NoReserveCheck], [MagicBoxSection4], [CCID], [OdometerUnits], [VehicleStoryDescriptionInterior2Pictures], [VehicleStoryDescriptionUndercarriagePictures], [WGL_Public_Report], [MakeOfferAvailable], [Utm_Medium_Listing_Submission], [ListingProgress], [IsEdited], [TransmissionText], [EstimatedMarketValue], [StateProvinceRegion], [PaintWorkText], [ReservePriceCL], [VehicleStoryDescriptionExterior], [Decade], [Specialist_Section_Comp5_Price], [ReservePrice], [VehicleStoryDescriptionExteriorPictures], [HaveAllPhotos], [Address], [Specialist_Section_Comp3_Info], [IsTaxable], [IsApproved], [CounterReserve], [VehicleStoryDescriptionExterior2], [TargetReserve], [PersonalMileage], [VehicleStoryDescriptionEngineTransmission], [SnapprPackage], [DraftEmailNotificationSent], [Specialist_Section_Comp5_Info], [BuyItNowUsed], [Acct_Rep], [Taxonomy], [Copy_Writer_Feedback], [Comped], [WhereDidYouHearAboutUsListingOther], [HasMagicBox], [HasDealerFee], [Specialist_Section_Comp2_Price], [SchedulingComplete], [MagicBoxSection6], [ReserveReviewEmailDate], [MagicBoxSection5], [LastServiceInformation], [BeenListedText], [VIN], [Zip], [ServiceRecords], [MagicBoxSection3], [Acct_Rep_Email], [MarketValue], [VehicleStory], [VehicleColor], [SpinCarLink], [MagicBoxSection2], [UserComments], [PackageTransactionId], [Transmission], [Specialist_Section_Comp4_Info], [Copy_Writer_Status], [Commission], [MagicBoxSection1], [StartingBid], [MakeOfferAllowed], [FixedPrice], [HasProPhotography], [Model], [EngineSize], [OriginalEngine], [IsFeaturedVehicle], [Utm_Source_Listing_Submission], [Year], [PhotoPlanId], [DealerURL], [ExpertVideoReview], [HowLongOwned], [Specialist_Section_Comp4_Price], [AnythingElseWeShouldKnow], [Photo_Plan], [BeenModified], [CurrentIssues], [VehicleStoryDescriptionCarFaxPictures], [Specialist], [Utm_Campaign_Listing_Submission], [CountryOfOrigin], [Specialist_Section_Original_Reserve], [VehicleTitle], [PaintWork], [Make], [CityCL], [WhereDidYouHearAboutUsListing], [TransactionId], [MileageAccurate], [CommissionOverrideReason], [Acct_Rep_Name], [VehicleStoryDescriptionExterior2Pictures], [DealerFees], [Dealer], [CarTitleInYourName], [CountryCL], [WhereDidYouHearAboutUsListingReferral], [VehicleStoryOpeningStatement], [MaxReserve], [Specialist_Section_Comp3_Price], [Specialist_Section_Comp1_Price]
from pivoted_data
    ');

  CREATE TABLE "dbo"."SZ_AH_Properties_Pivot__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.SZ_AH_Properties_Pivot__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."SZ_AH_Properties_Pivot__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."SZ_AH_Properties_Pivot__dbt_tmp_temp_view"
    end



21:43:54.233319 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.98 seconds
21:43:54.251414 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Pivot".
21:43:54.251741 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Pivot: rename object "dbo"."SZ_AH_Properties_Pivot" to SZ_AH_Properties_Pivot__dbt_backup
21:43:54.323186 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:43:54.337047 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Pivot".
21:43:54.337403 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Pivot: rename object "dbo"."SZ_AH_Properties_Pivot__dbt_tmp" to SZ_AH_Properties_Pivot
21:43:54.370890 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:43:54.382688 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_Properties_Pivot: COMMIT
21:43:54.389498 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Pivot".
21:43:54.389811 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Pivot: 
    
  if object_id ('"dbo"."SZ_AH_Properties_Pivot__dbt_backup"','U') is not null
    begin
    drop table "dbo"."SZ_AH_Properties_Pivot__dbt_backup"
    end

21:43:54.664567 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:43:54.678062 [debug] [Thread-1  ]: finished collecting timing info
21:43:54.678505 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_Properties_Pivot: Close
21:43:54.679320 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa77f7f7-dac4-4728-a22c-74f6d1bba70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e9c1fee0>]}
21:43:54.679855 [info ] [Thread-1  ]: 1 of 1 OK created table model dbo.SZ_AH_Properties_Pivot........................ [[32mOK[0m in 7.51s]
21:43:54.680248 [debug] [Thread-1  ]: Finished running node model.Shawn.SZ_AH_Properties_Pivot
21:43:54.681560 [debug] [MainThread]: Acquiring new synapse connection "master"
21:43:54.681861 [debug] [MainThread]: On master: COMMIT
21:43:54.682189 [info ] [MainThread]: 
21:43:54.682435 [info ] [MainThread]: Finished running 1 table model in 29.66s.
21:43:54.682684 [debug] [MainThread]: Connection 'master' was properly closed.
21:43:54.682808 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
21:43:54.682904 [debug] [MainThread]: Connection 'model.Shawn.SZ_AH_Properties_Pivot' was properly closed.
21:43:54.711435 [info ] [MainThread]: 
21:43:54.711856 [info ] [MainThread]: [32mCompleted successfully[0m
21:43:54.712156 [info ] [MainThread]: 
21:43:54.712337 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
21:43:54.712639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29eb8b02b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29ebe33490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e9c16a30>]}


============================== 2022-09-18 21:43:56.992951 | edd9bba9-b8b2-4a55-b29e-dd53d16a00fa ==============================
21:43:56.992951 [info ] [MainThread]: Running with dbt=1.0.0
21:43:56.998842 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step8_1_DM'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
21:43:56.999145 [debug] [MainThread]: Tracking: tracking
21:43:56.999479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efecc6c7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efecc6c7eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efecc6c7f10>]}
21:43:57.191083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:43:57.191460 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:43:57.216776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edd9bba9-b8b2-4a55-b29e-dd53d16a00fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efecc64b2b0>]}
21:43:57.261538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edd9bba9-b8b2-4a55-b29e-dd53d16a00fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efece68d880>]}
21:43:57.261962 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:43:57.269315 [info ] [MainThread]: 
21:43:57.269909 [debug] [MainThread]: Acquiring new synapse connection "master"
21:43:57.270892 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
21:43:57.280294 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
21:43:57.280489 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
21:43:57.280616 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:43:57.280757 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:43:57.566863 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:43:57.599853 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.32 seconds
21:43:57.601986 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
21:43:57.624071 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
21:43:57.629939 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
21:43:57.630455 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
21:43:57.632094 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
21:43:57.632271 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
21:43:57.632392 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:43:57.632526 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:43:57.630651 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
21:43:57.634042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:43:57.634207 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:43:57.745086 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:43:57.748569 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:43:57.842990 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:43:57.846985 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:43:57.982036 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
21:43:57.982439 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
21:43:58.042026 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
21:43:58.051686 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
21:44:19.662398 [debug] [MainThread]: On master: COMMIT
21:44:19.663136 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
21:44:19.663478 [info ] [MainThread]: 
21:44:19.667050 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Cars_DM
21:44:19.667420 [info ] [Thread-1  ]: 1 of 1 START table model dbo.AH_Cars_DM......................................... [RUN]
21:44:19.667885 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Cars_DM"
21:44:19.668051 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Cars_DM
21:44:19.668201 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Cars_DM
21:44:19.671030 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Cars_DM"
21:44:19.671531 [debug] [Thread-1  ]: finished collecting timing info
21:44:19.671698 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Cars_DM
21:44:19.735584 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Cars_DM"
21:44:19.736291 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Cars_DM".
21:44:19.736482 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Cars_DM: 
  
  if object_id ('"dbo"."AH_Cars_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Cars_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Cars_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Cars_DM__dbt_tmp"
    end


   EXEC('create view dbo.AH_Cars_DM__dbt_tmp_temp_view as
    
with DMStg as (
    SELECT
        HASHBYTES(''SHA2_256'',
            CONCAT(
                COALESCE(CAST(lpp.[ListingId] AS VARCHAR(200)), ''''), ''|'',
                COALESCE(CAST(lpp.[VIN] AS VARCHAR(200)), ''''), ''|'',
                COALESCE(CAST(lpp.[Year] AS VARCHAR(200)), ''''), ''|'',
                COALESCE(CAST(lpp.[Make] AS VARCHAR(200)), ''''), ''|'',
                COALESCE(CAST(lpp.[Model] AS VARCHAR(200)), '''')
            )
        ) as [Car_Skey],
		lpp.[ListingId] AS [ListingID],
		lpp.[VIN],
		lpp.[Year],
		lpp.[Make],
		lpp.[Model],
		lpp.[VehicleColor],
		lpp.[EngineSize],
		l.[CreatedOn] AS [CreatedDate],
		l.[UpdatedOn] AS [UpdatedDate],
		l.[DeletedOn] AS [DeletedDate]
    from dbo.SZ_AH_Properties_Pivot as lpp
    inner join [stg].[AH_Listings_FinalView] as l 
    on lpp.ListingID=l.ID
)
select 
	[ListingID],	
    [Car_Skey],
	[VIN],
	[Year],
	[Make],
	[Model],
	[VehicleColor],
	[EngineSize],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from DMStg
    ');

  CREATE TABLE "dbo"."AH_Cars_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Cars_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Cars_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Cars_DM__dbt_tmp_temp_view"
    end



21:44:19.736613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:44:19.736757 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:44:19.881339 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:44:24.919604 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.18 seconds
21:44:24.937349 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Cars_DM".
21:44:24.937689 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Cars_DM: rename object "dbo"."AH_Cars_DM" to AH_Cars_DM__dbt_backup
21:44:24.978446 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:44:24.993205 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Cars_DM".
21:44:24.993551 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Cars_DM: rename object "dbo"."AH_Cars_DM__dbt_tmp" to AH_Cars_DM
21:44:25.027358 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:44:25.038922 [debug] [Thread-1  ]: On model.Shawn.AH_Cars_DM: COMMIT
21:44:25.045616 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Cars_DM".
21:44:25.045912 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Cars_DM: 
    
  if object_id ('"dbo"."AH_Cars_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Cars_DM__dbt_backup"
    end

21:44:25.257297 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:44:25.269784 [debug] [Thread-1  ]: finished collecting timing info
21:44:25.270191 [debug] [Thread-1  ]: On model.Shawn.AH_Cars_DM: Close
21:44:25.270974 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edd9bba9-b8b2-4a55-b29e-dd53d16a00fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeca31e910>]}
21:44:25.271455 [info ] [Thread-1  ]: 1 of 1 OK created table model dbo.AH_Cars_DM.................................... [[32mOK[0m in 5.60s]
21:44:25.271839 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Cars_DM
21:44:25.273140 [debug] [MainThread]: Acquiring new synapse connection "master"
21:44:25.273431 [debug] [MainThread]: On master: COMMIT
21:44:25.273740 [info ] [MainThread]: 
21:44:25.273980 [info ] [MainThread]: Finished running 1 table model in 28.00s.
21:44:25.274172 [debug] [MainThread]: Connection 'master' was properly closed.
21:44:25.274276 [debug] [MainThread]: Connection 'model.Shawn.AH_Cars_DM' was properly closed.
21:44:25.274370 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
21:44:25.302786 [info ] [MainThread]: 
21:44:25.303216 [info ] [MainThread]: [32mCompleted successfully[0m
21:44:25.303502 [info ] [MainThread]: 
21:44:25.303681 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
21:44:25.303978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efecc3d0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efecc67d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeca1eaf40>]}


============================== 2022-09-18 21:44:27.597668 | f21d5c77-5ad0-40a8-b0eb-b369f6ae35d5 ==============================
21:44:27.597668 [info ] [MainThread]: Running with dbt=1.0.0
21:44:27.602825 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step8_2_FT_stg'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
21:44:27.603099 [debug] [MainThread]: Tracking: tracking
21:44:27.603434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21b3e7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21b3e7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21b3e7f40>]}
21:44:27.804636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:44:27.805018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:44:27.831311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f21d5c77-5ad0-40a8-b0eb-b369f6ae35d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21b36d340>]}
21:44:27.879479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f21d5c77-5ad0-40a8-b0eb-b369f6ae35d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21d3ec910>]}
21:44:27.879999 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:44:27.887982 [info ] [MainThread]: 
21:44:27.888690 [debug] [MainThread]: Acquiring new synapse connection "master"
21:44:27.889735 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
21:44:27.898500 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
21:44:27.898713 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
21:44:27.898838 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:44:27.898982 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:44:28.150401 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:44:28.178133 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:44:28.180293 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
21:44:28.203002 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
21:44:28.208925 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
21:44:28.209282 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
21:44:28.210948 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
21:44:28.211127 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
21:44:28.211245 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:44:28.211392 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:44:28.209538 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
21:44:28.212908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:44:28.213070 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:44:28.334963 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:44:28.338445 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:44:28.375097 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:44:28.375671 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:44:28.489414 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
21:44:28.489783 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
21:44:28.567505 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
21:44:28.579686 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
21:44:50.062145 [debug] [MainThread]: On master: COMMIT
21:44:50.062862 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
21:44:50.063200 [info ] [MainThread]: 
21:44:50.066903 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Listings_FT_stg
21:44:50.067301 [info ] [Thread-1  ]: 1 of 1 START table model stg.AH_Listings_FT_stg................................. [RUN]
21:44:50.067820 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Listings_FT_stg"
21:44:50.067993 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Listings_FT_stg
21:44:50.068146 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Listings_FT_stg
21:44:50.071394 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Listings_FT_stg"
21:44:50.071913 [debug] [Thread-1  ]: finished collecting timing info
21:44:50.072082 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Listings_FT_stg
21:44:50.163616 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Listings_FT_stg"
21:44:50.164418 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_stg".
21:44:50.164641 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_stg: 
  
  if object_id ('"stg"."AH_Listings_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listings_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_Listings_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_Listings_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_Listings_FT_stg__dbt_tmp_temp_view as
    
SELECT
		l.[ID] AS [ListingID],
		l.[OwnerID],
		l.[PrimaryCategoryId],
		l.[CurrencyID],
		l.[ListingTypeID],
		lt.[Name] AS [ListingType],
		l.[CreatedOn] AS [CreatedDate],
		l.[UpdatedOn] AS [UpdatedDate],
		l.[DeletedOn] AS [DeletedDate],
		l.[Title],
		l.[OriginalRelistCount],
		l.[Hits],
		l.[EndDTTM],
		l.[StartDTTM],
		l.[Subtitle],
		l.[Location],
		l.[Status],
		l.[CurrentPrice],
		l.[LastUpdatedUser],
		l.[Duration],
		l.[Version],
		l.[Increment],
		l.[OriginalPrice],
		l.[AutoRelistRemaining],
		l.[CurrentQuantity],
		l.[OriginalQuantity],
		l.[RelistIteration],
		l.[PrimaryImageURI],
		l.[AcceptedActionCount],
		l.[OwnerUserName],
		l.[CurrentListingActionId],
		l.[CurrentListingActionUserName],
		l.[OfferCount],
		lp.[VehicleStoryOpeningStatement],
		lp.[VehicleStoryDescriptionCarFax],
		lp.[Acct_Rep_Phone],
		lp.[HasMagicBox],
		lp.[HasDealerFee],
		lp.[VehicleStory],
		lp.[CarfaxPassFailError],
		lp.[LeadSource],
		lp.[VehicleStoryDescriptionInterior2Pictures],
		lp.[Decade],
		lp.[PaintWork],
		lp.[Specialist_Section_Comp2_Info],
		lp.[Curated],
		lp.[VehicleStoryDescriptionUndercarriagePictures],
		lp.[IsFeaturedVehicle],
		lp.[VehicleStoryOpeningStatementPictures],
		lp.[Copy_Writer_Status],
		lp.[FixedPrice],
		lp.[LockUsername],
		lp.[NoReserveCheck],
		lp.[VehicleStoryDescriptionCarFaxPictures],
		lp.[BeenListed],
		lp.[Acct_Rep],
		lp.[MagicBoxSection4],
		lp.[Copy_Writer],
		lp.[Taxonomy],
		lp.[PersonalMileage],
		lp.[Specialist_Section_Comp2_Price],
		lp.[VehicleStoryDescriptionInterior2],
		lp.[VehicleStoryDescriptionUndercarriage],
		lp.[VehicleStoryDescriptionInteriorPictures],
		lp.[Acct_Rep_Name],
		lp.[CarfaxLink],
		lp.[HideListing],
		lp.[CurrentIssues],
		lp.[TargetReserve],
		lp.[TransactionId],
		lp.[Specialist],
		lp.[BuyItNow],
		lp.[VehicleStoryDescriptionEngineTransmission],
		lp.[CountryOfOrigin],
		lp.[CommissionOverrideReason],
		lp.[WhereDidYouHearAboutUsListingReferral],
		lp.[CaliforniaSmogCheck],
		lp.[Modifications],
		lp.[Zip],
		lp.[ListingState],
		lp.[AnythingElseWeShouldKnow],
		lp.[VehicleTitle],
		lp.[Specialist_Section_Notes],
		lp.[VehicleStoryDescriptionExterior2],
		lp.[Photo_Plan],
		lp.[VehicleStoryDescriptionExterior2Pictures],
		lp.[Era],
		lp.[Commission],
		lp.[MakeOfferAvailable],
		lp.[IsEdited],
		lp.[WhereDidYouHearAboutUsListingOther],
		lp.[MagicBoxSection1],
		lp.[VehicleStoryDescriptionExteriorPictures],
		lp.[Specialist_Section_Original_Reserve],
		lp.[Specialist_Section_Comp1_Info],
		lp.[UI_ListingStateHold],
		lp.[AddressLine2],
		lp.[Specialist_Section_Comp5_Price],
		lp.[WGL_Public_Report],
		lp.[PremiumListing],
		lp.[ReservePrice],
		lp.[DealerURL],
		lp.[IsPaid],
		lp.[OriginalEngineText],
		lp.[HasProMarketing],
		lp.[PhotoPlanId],
		lp.[TransmissionText],
		lp.[MakeOfferAllowed],
		lp.[SchedulingComplete],
		lp.[ServiceRecords],
		lp.[CountryCL],
		lp.[OdometerUnits],
		lp.[BuyItNowUsed],
		lp.[MagicBoxSection3],
		lp.[SnapprPackage],
		lp.[CarfaxPassFail],
		lp.[CCID],
		lp.[StateProvinceRegion],
		lp.[DealerName],
		lp.[ListingProgress],
		lp.[StartingBid],
		lp.[EstimatedMarketValue],
		lp.[Mileage],
		lp.[IsPromoVehicle],
		lp.[MagicBoxSection2],
		lp.[SpinCarLink],
		lp.[MagicBoxSection5],
		lp.[Photo_Plan_Status],
		lp.[Address],
		lp.[HaveAllPhotos],
		lp.[MagicBoxSection6],
		lp.[OriginalEngine],
		lp.[VehicleStoryDescriptionInterior],
		lp.[UserComments],
		lp.[CarTitleInYourName],
		lp.[MarketValue],
		lp.[PackageTransactionId],
		lp.[Specialist_Section_Comp1_Price],
		lp.[Rust],
		lp.[MakeWholeAmount],
		lp.[Specialist_Section_Comp3_Price],
		lp.[VehicleStoryDescriptionEngineTransmissionPictures],
		lp.[WhereDidYouHearAboutUsListing],
		lp.[HasProPhotography],
		lp.[IsApproved],
		lp.[ListingNotes],
		lp.[Specialist_Section_Comp4_Info],
		lp.[HowLongOwned],
		lp.[DraftEmailNotificationSent],
		lp.[Copy_Writer_Feedback],
		lp.[ExpertVideoReview],
		lp.[Specialist_Section_Comp5_Info],
		lp.[Comped],
		lp.[BeenListedText],
		lp.[IsTaxable],
		lp.[Transmission],
		lp.[BeenModified],
		lp.[Specialist_Section_Comp3_Info],
		lp.[CityCL],
		lp.[PaintWorkText],
		lp.[Dealer],
		lp.[ReservePriceCL],
		lp.[MileageAccurate],
		lp.[Acct_Rep_Email],
		lp.[LastServiceInformation],
		lp.[DealerFees],
		lp.[Specialist_Section_Comp4_Price],
		lp.[VehicleStoryDescriptionExterior]
from [stg].[AH_Listings_FinalView] l
left join dbo.SZ_AH_Properties_Pivot lp on l.ID=lp.ListingID
left join [stg].[AH_ListingTypes_FinalView] lt on l.ListingTypeID=lt.ID
    ');

  CREATE TABLE "stg"."AH_Listings_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Listings_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Listings_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listings_FT_stg__dbt_tmp_temp_view"
    end



21:44:50.164780 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:44:50.164927 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:44:50.287827 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:44:55.060855 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 4.90 seconds
21:44:55.079617 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_stg".
21:44:55.079964 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_stg: rename object "stg"."AH_Listings_FT_stg" to AH_Listings_FT_stg__dbt_backup
21:44:55.128984 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:44:55.143917 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_stg".
21:44:55.144258 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_stg: rename object "stg"."AH_Listings_FT_stg__dbt_tmp" to AH_Listings_FT_stg
21:44:55.185725 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:44:55.196762 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT_stg: COMMIT
21:44:55.203625 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_stg".
21:44:55.203952 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_stg: 
    
  if object_id ('"stg"."AH_Listings_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_Listings_FT_stg__dbt_backup"
    end

21:44:55.524772 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
21:44:55.537434 [debug] [Thread-1  ]: finished collecting timing info
21:44:55.537818 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT_stg: Close
21:44:55.538611 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f21d5c77-5ad0-40a8-b0eb-b369f6ae35d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe218ece7f0>]}
21:44:55.539113 [info ] [Thread-1  ]: 1 of 1 OK created table model stg.AH_Listings_FT_stg............................ [[32mOK[0m in 5.47s]
21:44:55.539502 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Listings_FT_stg
21:44:55.540748 [debug] [MainThread]: Acquiring new synapse connection "master"
21:44:55.541049 [debug] [MainThread]: On master: COMMIT
21:44:55.541363 [info ] [MainThread]: 
21:44:55.541609 [info ] [MainThread]: Finished running 1 table model in 27.65s.
21:44:55.541801 [debug] [MainThread]: Connection 'master' was properly closed.
21:44:55.541906 [debug] [MainThread]: Connection 'model.Shawn.AH_Listings_FT_stg' was properly closed.
21:44:55.541999 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
21:44:55.569819 [info ] [MainThread]: 
21:44:55.570192 [info ] [MainThread]: [32mCompleted successfully[0m
21:44:55.570510 [info ] [MainThread]: 
21:44:55.570743 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
21:44:55.571042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe218ef0ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21b0e6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe218f06fd0>]}


============================== 2022-09-18 21:44:57.828408 | ad1eae1b-70af-4897-b535-2000c336f34b ==============================
21:44:57.828408 [info ] [MainThread]: Running with dbt=1.0.0
21:44:57.834872 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step8_3_FT_tmp'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
21:44:57.835183 [debug] [MainThread]: Tracking: tracking
21:44:57.835539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2075751df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2075751e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2075751eb0>]}
21:44:58.029820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:44:58.030205 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:44:58.056240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad1eae1b-70af-4897-b535-2000c336f34b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20756d5250>]}
21:44:58.103850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad1eae1b-70af-4897-b535-2000c336f34b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f207775b820>]}
21:44:58.104387 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:44:58.112219 [info ] [MainThread]: 
21:44:58.112873 [debug] [MainThread]: Acquiring new synapse connection "master"
21:44:58.113882 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
21:44:58.122739 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
21:44:58.122940 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
21:44:58.123065 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:44:58.123205 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:44:58.397892 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:44:58.426017 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:44:58.428155 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
21:44:58.450921 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
21:44:58.456815 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
21:44:58.457170 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
21:44:58.458837 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
21:44:58.459012 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
21:44:58.459129 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:44:58.459259 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:44:58.457421 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
21:44:58.460761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:44:58.460936 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:44:58.584736 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:44:58.586212 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:44:58.622662 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:44:58.626107 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:44:58.752339 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
21:44:58.752737 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
21:44:58.810581 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
21:44:58.810953 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
21:45:20.487212 [debug] [MainThread]: On master: COMMIT
21:45:20.487888 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
21:45:20.488219 [info ] [MainThread]: 
21:45:20.491275 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Listings_FT_tmp
21:45:20.491645 [info ] [Thread-1  ]: 1 of 1 START table model stg.AH_Listings_FT_tmp................................. [RUN]
21:45:20.492129 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Listings_FT_tmp"
21:45:20.492292 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Listings_FT_tmp
21:45:20.492443 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Listings_FT_tmp
21:45:20.495569 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Listings_FT_tmp"
21:45:20.496063 [debug] [Thread-1  ]: finished collecting timing info
21:45:20.496229 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Listings_FT_tmp
21:45:20.588226 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Listings_FT_tmp"
21:45:20.589059 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_tmp".
21:45:20.589264 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_tmp: 
  
  if object_id ('"stg"."AH_Listings_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listings_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_Listings_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_Listings_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_Listings_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		l.[ListingID],
		condm.[Consignor_SKey],
		cardm.[Car_Skey],
		l.[OwnerID],
		l.[PrimaryCategoryId],
		l.[CurrencyID],
		l.[ListingTypeID],
		l.[ListingType],
		l.[CreatedDate],
		l.[UpdatedDate],
		l.[DeletedDate],
		l.[Title],
		l.[OriginalRelistCount],
		l.[Hits],
		l.[EndDTTM],
		l.[StartDTTM],
		l.[Subtitle],
		l.[Location],
		l.[Status],
		l.[CurrentPrice],
		l.[LastUpdatedUser],
		l.[Duration],
		l.[Version],
		l.[Increment],
		l.[OriginalPrice],
		l.[AutoRelistRemaining],
		l.[CurrentQuantity],
		l.[OriginalQuantity],
		l.[RelistIteration],
		l.[PrimaryImageURI],
		l.[AcceptedActionCount],
		l.[OwnerUserName],
		l.[CurrentListingActionId],
		l.[CurrentListingActionUserName],
		l.[OfferCount],
		l.[VehicleStoryOpeningStatement],
		l.[VehicleStoryDescriptionCarFax],
		l.[Acct_Rep_Phone],
		l.[HasMagicBox],
		l.[HasDealerFee],
		l.[VehicleStory],
		l.[CarfaxPassFailError],
		l.[LeadSource],
		l.[VehicleStoryDescriptionInterior2Pictures],
		l.[Decade],
		l.[PaintWork],
		l.[Specialist_Section_Comp2_Info],
		l.[Curated],
		l.[VehicleStoryDescriptionUndercarriagePictures],
		l.[IsFeaturedVehicle],
		l.[VehicleStoryOpeningStatementPictures],
		l.[Copy_Writer_Status],
		l.[FixedPrice],
		l.[LockUsername],
		l.[NoReserveCheck],
		l.[VehicleStoryDescriptionCarFaxPictures],
		l.[BeenListed],
		l.[Acct_Rep],
		l.[MagicBoxSection4],
		l.[Copy_Writer],
		l.[Taxonomy],
		l.[PersonalMileage],
		l.[Specialist_Section_Comp2_Price],
		l.[VehicleStoryDescriptionInterior2],
		l.[VehicleStoryDescriptionUndercarriage],
		l.[VehicleStoryDescriptionInteriorPictures],
		l.[Acct_Rep_Name],
		l.[CarfaxLink],
		l.[HideListing],
		l.[CurrentIssues],
		l.[TargetReserve],
		l.[TransactionId],
		l.[Specialist],
		l.[BuyItNow],
		l.[VehicleStoryDescriptionEngineTransmission],
		l.[CountryOfOrigin],
		l.[CommissionOverrideReason],
		l.[WhereDidYouHearAboutUsListingReferral],
		l.[CaliforniaSmogCheck],
		l.[Modifications],
		l.[Zip],
		l.[ListingState],
		l.[AnythingElseWeShouldKnow],
		l.[VehicleTitle],
		l.[Specialist_Section_Notes],
		l.[VehicleStoryDescriptionExterior2],
		l.[Photo_Plan],
		l.[VehicleStoryDescriptionExterior2Pictures],
		l.[Era],
		l.[Commission],
		l.[MakeOfferAvailable],
		l.[IsEdited],
		l.[WhereDidYouHearAboutUsListingOther],
		l.[MagicBoxSection1],
		l.[VehicleStoryDescriptionExteriorPictures],
		l.[Specialist_Section_Original_Reserve],
		l.[Specialist_Section_Comp1_Info],
		l.[UI_ListingStateHold],
		l.[AddressLine2],
		l.[Specialist_Section_Comp5_Price],
		l.[WGL_Public_Report],
		l.[PremiumListing],
		l.[ReservePrice],
		l.[DealerURL],
		l.[IsPaid],
		l.[OriginalEngineText],
		l.[HasProMarketing],
		l.[PhotoPlanId],
		l.[TransmissionText],
		l.[MakeOfferAllowed],
		l.[SchedulingComplete],
		l.[ServiceRecords],
		l.[CountryCL],
		l.[OdometerUnits],
		l.[BuyItNowUsed],
		l.[MagicBoxSection3],
		l.[SnapprPackage],
		l.[CarfaxPassFail],
		l.[CCID],
		l.[StateProvinceRegion],
		l.[DealerName],
		l.[ListingProgress],
		l.[StartingBid],
		l.[EstimatedMarketValue],
		l.[Mileage],
		l.[IsPromoVehicle],
		l.[MagicBoxSection2],
		l.[SpinCarLink],
		l.[MagicBoxSection5],
		l.[Photo_Plan_Status],
		l.[Address],
		l.[HaveAllPhotos],
		l.[MagicBoxSection6],
		l.[OriginalEngine],
		l.[VehicleStoryDescriptionInterior],
		l.[UserComments],
		l.[CarTitleInYourName],
		l.[MarketValue],
		l.[PackageTransactionId],
		l.[Specialist_Section_Comp1_Price],
		l.[Rust],
		l.[MakeWholeAmount],
		l.[Specialist_Section_Comp3_Price],
		l.[VehicleStoryDescriptionEngineTransmissionPictures],
		l.[WhereDidYouHearAboutUsListing],
		l.[HasProPhotography],
		l.[IsApproved],
		l.[ListingNotes],
		l.[Specialist_Section_Comp4_Info],
		l.[HowLongOwned],
		l.[DraftEmailNotificationSent],
		l.[Copy_Writer_Feedback],
		l.[ExpertVideoReview],
		l.[Specialist_Section_Comp5_Info],
		l.[Comped],
		l.[BeenListedText],
		l.[IsTaxable],
		l.[Transmission],
		l.[BeenModified],
		l.[Specialist_Section_Comp3_Info],
		l.[CityCL],
		l.[PaintWorkText],
		l.[Dealer],
		l.[ReservePriceCL],
		l.[MileageAccurate],
		l.[Acct_Rep_Email],
		l.[LastServiceInformation],
		l.[DealerFees],
		l.[Specialist_Section_Comp4_Price],
		l.[VehicleStoryDescriptionExterior]
from [stg].[AH_Listings_FT_stg] l
left join [dbo].[AH_Cars_DM] cardm on l.ListingID=cardm.ListingID
left join [dbo].[AH_Consignors_DM] condm on l.OwnerID=condm.UserID
    ');

  CREATE TABLE "stg"."AH_Listings_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Listings_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Listings_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listings_FT_tmp__dbt_tmp_temp_view"
    end



21:45:20.589398 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:45:20.589539 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:45:20.725083 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:45:25.572245 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 4.98 seconds
21:45:25.590339 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_tmp".
21:45:25.590700 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_tmp: rename object "stg"."AH_Listings_FT_tmp" to AH_Listings_FT_tmp__dbt_backup
21:45:25.720195 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:45:25.734671 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_tmp".
21:45:25.735011 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_tmp: rename object "stg"."AH_Listings_FT_tmp__dbt_tmp" to AH_Listings_FT_tmp
21:45:25.793537 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:45:25.804149 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT_tmp: COMMIT
21:45:25.810852 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_tmp".
21:45:25.811181 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_tmp: 
    
  if object_id ('"stg"."AH_Listings_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_Listings_FT_tmp__dbt_backup"
    end

21:45:26.158015 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
21:45:26.171306 [debug] [Thread-1  ]: finished collecting timing info
21:45:26.171695 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT_tmp: Close
21:45:26.172573 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad1eae1b-70af-4897-b535-2000c336f34b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f206f310040>]}
21:45:26.173064 [info ] [Thread-1  ]: 1 of 1 OK created table model stg.AH_Listings_FT_tmp............................ [[32mOK[0m in 5.68s]
21:45:26.173441 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Listings_FT_tmp
21:45:26.174672 [debug] [MainThread]: Acquiring new synapse connection "master"
21:45:26.174967 [debug] [MainThread]: On master: COMMIT
21:45:26.175273 [info ] [MainThread]: 
21:45:26.175518 [info ] [MainThread]: Finished running 1 table model in 28.06s.
21:45:26.175708 [debug] [MainThread]: Connection 'master' was properly closed.
21:45:26.175812 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
21:45:26.175903 [debug] [MainThread]: Connection 'model.Shawn.AH_Listings_FT_tmp' was properly closed.
21:45:26.203763 [info ] [MainThread]: 
21:45:26.204191 [info ] [MainThread]: [32mCompleted successfully[0m
21:45:26.204484 [info ] [MainThread]: 
21:45:26.204664 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
21:45:26.204959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f206f254eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2075047fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f207570b5e0>]}


============================== 2022-09-18 21:45:28.809164 | d75a3582-1126-494d-aefc-035d2577dbc1 ==============================
21:45:28.809164 [info ] [MainThread]: Running with dbt=1.0.0
21:45:28.814843 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step8_4_FT'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
21:45:28.815118 [debug] [MainThread]: Tracking: tracking
21:45:28.815448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d1c74ec40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d1c74ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d1c74edc0>]}
21:45:29.006212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:45:29.006655 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:45:29.032364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd75a3582-1126-494d-aefc-035d2577dbc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d1c6d42e0>]}
21:45:29.080017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd75a3582-1126-494d-aefc-035d2577dbc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d1e7128b0>]}
21:45:29.080557 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:45:29.088499 [info ] [MainThread]: 
21:45:29.089104 [debug] [MainThread]: Acquiring new synapse connection "master"
21:45:29.090098 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
21:45:29.098954 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
21:45:29.099154 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
21:45:29.099277 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:45:29.099416 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:45:29.606190 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:45:29.635547 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.54 seconds
21:45:29.637663 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
21:45:29.659652 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
21:45:29.665481 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
21:45:29.665842 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
21:45:29.667542 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
21:45:29.667722 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
21:45:29.667839 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:45:29.667969 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:45:29.666094 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
21:45:29.669479 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:45:29.669646 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:45:29.791029 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:45:29.791671 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:45:29.831134 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:45:29.831648 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:45:29.944345 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
21:45:29.944722 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
21:45:30.025887 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
21:45:30.026351 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
21:45:51.461378 [debug] [MainThread]: On master: COMMIT
21:45:51.462040 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
21:45:51.462371 [info ] [MainThread]: 
21:45:51.465935 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Listings_FT
21:45:51.466320 [info ] [Thread-1  ]: 1 of 1 START table model dbo.AH_Listings_FT..................................... [RUN]
21:45:51.466847 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Listings_FT"
21:45:51.467018 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Listings_FT
21:45:51.467171 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Listings_FT
21:45:51.471775 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Listings_FT"
21:45:51.472306 [debug] [Thread-1  ]: finished collecting timing info
21:45:51.472477 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Listings_FT
21:45:51.537350 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Listings_FT"
21:45:51.538088 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT".
21:45:51.538284 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT: 
  
  if object_id ('"dbo"."AH_Listings_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listings_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Listings_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Listings_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_Listings_FT__dbt_tmp_temp_view as
    
with updateData as (
    select 
    	FTstg.[ListingID],
		FTtmp.[Consignor_SKey],
		FTtmp.[Car_Skey],
		FTstg.[PrimaryCategoryId],
		FTstg.[CurrencyID],
		FTstg.[ListingTypeID],
		FTstg.[ListingType],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate],
		FTstg.[DeletedDate],
		FTstg.[Title],
		FTstg.[OriginalRelistCount],
		FTstg.[Hits],
		FTstg.[EndDTTM],
		FTstg.[StartDTTM],
		FTstg.[Subtitle],
		FTstg.[Location],
		FTstg.[Status],
		FTstg.[CurrentPrice],
		FTstg.[LastUpdatedUser],
		FTstg.[Duration],
		FTstg.[Version],
		FTstg.[Increment],
		FTstg.[OriginalPrice],
		FTstg.[AutoRelistRemaining],
		FTstg.[CurrentQuantity],
		FTstg.[OriginalQuantity],
		FTstg.[RelistIteration],
		FTstg.[PrimaryImageURI],
		FTstg.[AcceptedActionCount],
		FTstg.[OwnerUserName],
		FTstg.[CurrentListingActionId],
		FTstg.[CurrentListingActionUserName],
		FTstg.[OfferCount],
		FTstg.[VehicleStoryOpeningStatement],
		FTstg.[VehicleStoryDescriptionCarFax],
		FTstg.[Acct_Rep_Phone],
		FTstg.[HasMagicBox],
		FTstg.[HasDealerFee],
		FTstg.[VehicleStory],
		FTstg.[CarfaxPassFailError],
		FTstg.[LeadSource],
		FTstg.[VehicleStoryDescriptionInterior2Pictures],
		FTstg.[Decade],
		FTstg.[PaintWork],
		FTstg.[Specialist_Section_Comp2_Info],
		FTstg.[Curated],
		FTstg.[VehicleStoryDescriptionUndercarriagePictures],
		FTstg.[IsFeaturedVehicle],
		FTstg.[VehicleStoryOpeningStatementPictures],
		FTstg.[Copy_Writer_Status],
		FTstg.[FixedPrice],
		FTstg.[LockUsername],
		FTstg.[NoReserveCheck],
		FTstg.[VehicleStoryDescriptionCarFaxPictures],
		FTstg.[BeenListed],
		FTstg.[Acct_Rep],
		FTstg.[MagicBoxSection4],
		FTstg.[Copy_Writer],
		FTstg.[Taxonomy],
		FTstg.[PersonalMileage],
		FTstg.[Specialist_Section_Comp2_Price],
		FTstg.[VehicleStoryDescriptionInterior2],
		FTstg.[VehicleStoryDescriptionUndercarriage],
		FTstg.[VehicleStoryDescriptionInteriorPictures],
		FTstg.[Acct_Rep_Name],
		FTstg.[CarfaxLink],
		FTstg.[HideListing],
		FTstg.[CurrentIssues],
		FTstg.[TargetReserve],
		FTstg.[TransactionId],
		FTstg.[Specialist],
		FTstg.[BuyItNow],
		FTstg.[VehicleStoryDescriptionEngineTransmission],
		FTstg.[CountryOfOrigin],
		FTstg.[CommissionOverrideReason],
		FTstg.[WhereDidYouHearAboutUsListingReferral],
		FTstg.[CaliforniaSmogCheck],
		FTstg.[Modifications],
		FTstg.[Zip],
		FTstg.[ListingState],
		FTstg.[AnythingElseWeShouldKnow],
		FTstg.[VehicleTitle],
		FTstg.[Specialist_Section_Notes],
		FTstg.[VehicleStoryDescriptionExterior2],
		FTstg.[Photo_Plan],
		FTstg.[VehicleStoryDescriptionExterior2Pictures],
		FTstg.[Era],
		FTstg.[Commission],
		FTstg.[MakeOfferAvailable],
		FTstg.[IsEdited],
		FTstg.[WhereDidYouHearAboutUsListingOther],
		FTstg.[MagicBoxSection1],
		FTstg.[VehicleStoryDescriptionExteriorPictures],
		FTstg.[Specialist_Section_Original_Reserve],
		FTstg.[Specialist_Section_Comp1_Info],
		FTstg.[UI_ListingStateHold],
		FTstg.[AddressLine2],
		FTstg.[Specialist_Section_Comp5_Price],
		FTstg.[WGL_Public_Report],
		FTstg.[PremiumListing],
		FTstg.[ReservePrice],
		FTstg.[DealerURL],
		FTstg.[IsPaid],
		FTstg.[OriginalEngineText],
		FTstg.[HasProMarketing],
		FTstg.[PhotoPlanId],
		FTstg.[TransmissionText],
		FTstg.[MakeOfferAllowed],
		FTstg.[SchedulingComplete],
		FTstg.[ServiceRecords],
		FTstg.[CountryCL],
		FTstg.[OdometerUnits],
		FTstg.[BuyItNowUsed],
		FTstg.[MagicBoxSection3],
		FTstg.[SnapprPackage],
		FTstg.[CarfaxPassFail],
		FTstg.[CCID],
		FTstg.[StateProvinceRegion],
		FTstg.[DealerName],
		FTstg.[ListingProgress],
		FTstg.[StartingBid],
		FTstg.[EstimatedMarketValue],
		FTstg.[Mileage],
		FTstg.[IsPromoVehicle],
		FTstg.[MagicBoxSection2],
		FTstg.[SpinCarLink],
		FTstg.[MagicBoxSection5],
		FTstg.[Photo_Plan_Status],
		FTstg.[Address],
		FTstg.[HaveAllPhotos],
		FTstg.[MagicBoxSection6],
		FTstg.[OriginalEngine],
		FTstg.[VehicleStoryDescriptionInterior],
		FTstg.[UserComments],
		FTstg.[CarTitleInYourName],
		FTstg.[MarketValue],
		FTstg.[PackageTransactionId],
		FTstg.[Specialist_Section_Comp1_Price],
		FTstg.[Rust],
		FTstg.[MakeWholeAmount],
		FTstg.[Specialist_Section_Comp3_Price],
		FTstg.[VehicleStoryDescriptionEngineTransmissionPictures],
		FTstg.[WhereDidYouHearAboutUsListing],
		FTstg.[HasProPhotography],
		FTstg.[IsApproved],
		FTstg.[ListingNotes],
		FTstg.[Specialist_Section_Comp4_Info],
		FTstg.[HowLongOwned],
		FTstg.[DraftEmailNotificationSent],
		FTstg.[Copy_Writer_Feedback],
		FTstg.[ExpertVideoReview],
		FTstg.[Specialist_Section_Comp5_Info],
		FTstg.[Comped],
		FTstg.[BeenListedText],
		FTstg.[IsTaxable],
		FTstg.[Transmission],
		FTstg.[BeenModified],
		FTstg.[Specialist_Section_Comp3_Info],
		FTstg.[CityCL],
		FTstg.[PaintWorkText],
		FTstg.[Dealer],
		FTstg.[ReservePriceCL],
		FTstg.[MileageAccurate],
		FTstg.[Acct_Rep_Email],
		FTstg.[LastServiceInformation],
		FTstg.[DealerFees],
		FTstg.[Specialist_Section_Comp4_Price],
		FTstg.[VehicleStoryDescriptionExterior]
    from stg.AH_Listings_FT_tmp as FTtmp 
    join stg.AH_Listings_FT_stg as FTstg 
    on FTstg.ListingID=FTtmp.ListingID
)
,
insertData as (
    select 
        [ListingID],
        [Consignor_SKey],
        [Car_Skey],
        [PrimaryCategoryId],
        [CurrencyID],
        [ListingTypeID],
        [ListingType],
        [CreatedDate],
        [UpdatedDate],
        [DeletedDate],
        [Title],
        [OriginalRelistCount],
        [Hits],
        [EndDTTM],
        [StartDTTM],
        [Subtitle],
        [Location],
        [Status],
        [CurrentPrice],
        [LastUpdatedUser],
        [Duration],
        [Version],
        [Increment],
        [OriginalPrice],
        [AutoRelistRemaining],
        [CurrentQuantity],
        [OriginalQuantity],
        [RelistIteration],
        [PrimaryImageURI],
        [AcceptedActionCount],
        [OwnerUserName],
        [CurrentListingActionId],
        [CurrentListingActionUserName],
        [OfferCount],
        [VehicleStoryOpeningStatement],
        [VehicleStoryDescriptionCarFax],
        [Acct_Rep_Phone],
        [HasMagicBox],
        [HasDealerFee],
        [VehicleStory],
        [CarfaxPassFailError],
        [LeadSource],
        [VehicleStoryDescriptionInterior2Pictures],
        [Decade],
        [PaintWork],
        [Specialist_Section_Comp2_Info],
        [Curated],
        [VehicleStoryDescriptionUndercarriagePictures],
        [IsFeaturedVehicle],
        [VehicleStoryOpeningStatementPictures],
        [Copy_Writer_Status],
        [FixedPrice],
        [LockUsername],
        [NoReserveCheck],
        [VehicleStoryDescriptionCarFaxPictures],
        [BeenListed],
        [Acct_Rep],
        [MagicBoxSection4],
        [Copy_Writer],
        [Taxonomy],
        [PersonalMileage],
        [Specialist_Section_Comp2_Price],
        [VehicleStoryDescriptionInterior2],
        [VehicleStoryDescriptionUndercarriage],
        [VehicleStoryDescriptionInteriorPictures],
        [Acct_Rep_Name],
        [CarfaxLink],
        [HideListing],
        [CurrentIssues],
        [TargetReserve],
        [TransactionId],
        [Specialist],
        [BuyItNow],
        [VehicleStoryDescriptionEngineTransmission],
        [CountryOfOrigin],
        [CommissionOverrideReason],
        [WhereDidYouHearAboutUsListingReferral],
        [CaliforniaSmogCheck],
        [Modifications],
        [Zip],
        [ListingState],
        [AnythingElseWeShouldKnow],
        [VehicleTitle],
        [Specialist_Section_Notes],
        [VehicleStoryDescriptionExterior2],
        [Photo_Plan],
        [VehicleStoryDescriptionExterior2Pictures],
        [Era],
        [Commission],
        [MakeOfferAvailable],
        [IsEdited],
        [WhereDidYouHearAboutUsListingOther],
        [MagicBoxSection1],
        [VehicleStoryDescriptionExteriorPictures],
        [Specialist_Section_Original_Reserve],
        [Specialist_Section_Comp1_Info],
        [UI_ListingStateHold],
        [AddressLine2],
        [Specialist_Section_Comp5_Price],
        [WGL_Public_Report],
        [PremiumListing],
        [ReservePrice],
        [DealerURL],
        [IsPaid],
        [OriginalEngineText],
        [HasProMarketing],
        [PhotoPlanId],
        [TransmissionText],
        [MakeOfferAllowed],
        [SchedulingComplete],
        [ServiceRecords],
        [CountryCL],
        [OdometerUnits],
        [BuyItNowUsed],
        [MagicBoxSection3],
        [SnapprPackage],
        [CarfaxPassFail],
        [CCID],
        [StateProvinceRegion],
        [DealerName],
        [ListingProgress],
        [StartingBid],
        [EstimatedMarketValue],
        [Mileage],
        [IsPromoVehicle],
        [MagicBoxSection2],
        [SpinCarLink],
        [MagicBoxSection5],
        [Photo_Plan_Status],
        [Address],
        [HaveAllPhotos],
        [MagicBoxSection6],
        [OriginalEngine],
        [VehicleStoryDescriptionInterior],
        [UserComments],
        [CarTitleInYourName],
        [MarketValue],
        [PackageTransactionId],
        [Specialist_Section_Comp1_Price],
        [Rust],
        [MakeWholeAmount],
        [Specialist_Section_Comp3_Price],
        [VehicleStoryDescriptionEngineTransmissionPictures],
        [WhereDidYouHearAboutUsListing],
        [HasProPhotography],
        [IsApproved],
        [ListingNotes],
        [Specialist_Section_Comp4_Info],
        [HowLongOwned],
        [DraftEmailNotificationSent],
        [Copy_Writer_Feedback],
        [ExpertVideoReview],
        [Specialist_Section_Comp5_Info],
        [Comped],
        [BeenListedText],
        [IsTaxable],
        [Transmission],
        [BeenModified],
        [Specialist_Section_Comp3_Info],
        [CityCL],
        [PaintWorkText],
        [Dealer],
        [ReservePriceCL],
        [MileageAccurate],
        [Acct_Rep_Email],
        [LastServiceInformation],
        [DealerFees],
        [Specialist_Section_Comp4_Price],
        [VehicleStoryDescriptionExterior]
    from stg.AH_Listings_FT_tmp
    where ListingID not in (select  ListingID from stg.AH_Listings_FT_stg)
)
SELECT
	[ListingID],
	[Consignor_SKey],
	[Car_Skey],
	[PrimaryCategoryId],
	[CurrencyID],
	[ListingTypeID],
	[ListingType],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate],
	[Title],
	[OriginalRelistCount],
	[Hits],
	[EndDTTM],
	[StartDTTM],
	[Subtitle],
	[Location],
	[Status],
	[CurrentPrice],
	[LastUpdatedUser],
	[Duration],
	[Version],
	[Increment],
	[OriginalPrice],
	[AutoRelistRemaining],
	[CurrentQuantity],
	[OriginalQuantity],
	[RelistIteration],
	[PrimaryImageURI],
	[AcceptedActionCount],
	[OwnerUserName],
	[CurrentListingActionId],
	[CurrentListingActionUserName],
	[OfferCount],
	[VehicleStoryOpeningStatement],
	[VehicleStoryDescriptionCarFax],
	[Acct_Rep_Phone],
	[HasMagicBox],
	[HasDealerFee],
	[VehicleStory],
	[CarfaxPassFailError],
	[LeadSource],
	[VehicleStoryDescriptionInterior2Pictures],
	[Decade],
	[PaintWork],
	[Specialist_Section_Comp2_Info],
	[Curated],
	[VehicleStoryDescriptionUndercarriagePictures],
	[IsFeaturedVehicle],
	[VehicleStoryOpeningStatementPictures],
	[Copy_Writer_Status],
	[FixedPrice],
	[LockUsername],
	[NoReserveCheck],
	[VehicleStoryDescriptionCarFaxPictures],
	[BeenListed],
	[Acct_Rep],
	[MagicBoxSection4],
	[Copy_Writer],
	[Taxonomy],
	[PersonalMileage],
	[Specialist_Section_Comp2_Price],
	[VehicleStoryDescriptionInterior2],
	[VehicleStoryDescriptionUndercarriage],
	[VehicleStoryDescriptionInteriorPictures],
	[Acct_Rep_Name],
	[CarfaxLink],
	[HideListing],
	[CurrentIssues],
	[TargetReserve],
	[TransactionId],
	[Specialist],
	[BuyItNow],
	[VehicleStoryDescriptionEngineTransmission],
	[CountryOfOrigin],
	[CommissionOverrideReason],
	[WhereDidYouHearAboutUsListingReferral],
	[CaliforniaSmogCheck],
	[Modifications],
	[Zip],
	[ListingState],
	[AnythingElseWeShouldKnow],
	[VehicleTitle],
	[Specialist_Section_Notes],
	[VehicleStoryDescriptionExterior2],
	[Photo_Plan],
	[VehicleStoryDescriptionExterior2Pictures],
	[Era],
	[Commission],
	[MakeOfferAvailable],
	[IsEdited],
	[WhereDidYouHearAboutUsListingOther],
	[MagicBoxSection1],
	[VehicleStoryDescriptionExteriorPictures],
	[Specialist_Section_Original_Reserve],
	[Specialist_Section_Comp1_Info],
	[UI_ListingStateHold],
	[AddressLine2],
	[Specialist_Section_Comp5_Price],
	[WGL_Public_Report],
	[PremiumListing],
	[ReservePrice],
	[DealerURL],
	[IsPaid],
	[OriginalEngineText],
	[HasProMarketing],
	[PhotoPlanId],
	[TransmissionText],
	[MakeOfferAllowed],
	[SchedulingComplete],
	[ServiceRecords],
	[CountryCL],
	[OdometerUnits],
	[BuyItNowUsed],
	[MagicBoxSection3],
	[SnapprPackage],
	[CarfaxPassFail],
	[CCID],
	[StateProvinceRegion],
	[DealerName],
	[ListingProgress],
	[StartingBid],
	[EstimatedMarketValue],
	[Mileage],
	[IsPromoVehicle],
	[MagicBoxSection2],
	[SpinCarLink],
	[MagicBoxSection5],
	[Photo_Plan_Status],
	[Address],
	[HaveAllPhotos],
	[MagicBoxSection6],
	[OriginalEngine],
	[VehicleStoryDescriptionInterior],
	[UserComments],
	[CarTitleInYourName],
	[MarketValue],
	[PackageTransactionId],
	[Specialist_Section_Comp1_Price],
	[Rust],
	[MakeWholeAmount],
	[Specialist_Section_Comp3_Price],
	[VehicleStoryDescriptionEngineTransmissionPictures],
	[WhereDidYouHearAboutUsListing],
	[HasProPhotography],
	[IsApproved],
	[ListingNotes],
	[Specialist_Section_Comp4_Info],
	[HowLongOwned],
	[DraftEmailNotificationSent],
	[Copy_Writer_Feedback],
	[ExpertVideoReview],
	[Specialist_Section_Comp5_Info],
	[Comped],
	[BeenListedText],
	[IsTaxable],
	[Transmission],
	[BeenModified],
	[Specialist_Section_Comp3_Info],
	[CityCL],
	[PaintWorkText],
	[Dealer],
	[ReservePriceCL],
	[MileageAccurate],
	[Acct_Rep_Email],
	[LastServiceInformation],
	[DealerFees],
	[Specialist_Section_Comp4_Price],
	[VehicleStoryDescriptionExterior]
from updateData

union all

SELECT
	[ListingID],
	[Consignor_SKey],
	[Car_Skey],
	[PrimaryCategoryId],
	[CurrencyID],
	[ListingTypeID],
	[ListingType],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate],
	[Title],
	[OriginalRelistCount],
	[Hits],
	[EndDTTM],
	[StartDTTM],
	[Subtitle],
	[Location],
	[Status],
	[CurrentPrice],
	[LastUpdatedUser],
	[Duration],
	[Version],
	[Increment],
	[OriginalPrice],
	[AutoRelistRemaining],
	[CurrentQuantity],
	[OriginalQuantity],
	[RelistIteration],
	[PrimaryImageURI],
	[AcceptedActionCount],
	[OwnerUserName],
	[CurrentListingActionId],
	[CurrentListingActionUserName],
	[OfferCount],
	[VehicleStoryOpeningStatement],
	[VehicleStoryDescriptionCarFax],
	[Acct_Rep_Phone],
	[HasMagicBox],
	[HasDealerFee],
	[VehicleStory],
	[CarfaxPassFailError],
	[LeadSource],
	[VehicleStoryDescriptionInterior2Pictures],
	[Decade],
	[PaintWork],
	[Specialist_Section_Comp2_Info],
	[Curated],
	[VehicleStoryDescriptionUndercarriagePictures],
	[IsFeaturedVehicle],
	[VehicleStoryOpeningStatementPictures],
	[Copy_Writer_Status],
	[FixedPrice],
	[LockUsername],
	[NoReserveCheck],
	[VehicleStoryDescriptionCarFaxPictures],
	[BeenListed],
	[Acct_Rep],
	[MagicBoxSection4],
	[Copy_Writer],
	[Taxonomy],
	[PersonalMileage],
	[Specialist_Section_Comp2_Price],
	[VehicleStoryDescriptionInterior2],
	[VehicleStoryDescriptionUndercarriage],
	[VehicleStoryDescriptionInteriorPictures],
	[Acct_Rep_Name],
	[CarfaxLink],
	[HideListing],
	[CurrentIssues],
	[TargetReserve],
	[TransactionId],
	[Specialist],
	[BuyItNow],
	[VehicleStoryDescriptionEngineTransmission],
	[CountryOfOrigin],
	[CommissionOverrideReason],
	[WhereDidYouHearAboutUsListingReferral],
	[CaliforniaSmogCheck],
	[Modifications],
	[Zip],
	[ListingState],
	[AnythingElseWeShouldKnow],
	[VehicleTitle],
	[Specialist_Section_Notes],
	[VehicleStoryDescriptionExterior2],
	[Photo_Plan],
	[VehicleStoryDescriptionExterior2Pictures],
	[Era],
	[Commission],
	[MakeOfferAvailable],
	[IsEdited],
	[WhereDidYouHearAboutUsListingOther],
	[MagicBoxSection1],
	[VehicleStoryDescriptionExteriorPictures],
	[Specialist_Section_Original_Reserve],
	[Specialist_Section_Comp1_Info],
	[UI_ListingStateHold],
	[AddressLine2],
	[Specialist_Section_Comp5_Price],
	[WGL_Public_Report],
	[PremiumListing],
	[ReservePrice],
	[DealerURL],
	[IsPaid],
	[OriginalEngineText],
	[HasProMarketing],
	[PhotoPlanId],
	[TransmissionText],
	[MakeOfferAllowed],
	[SchedulingComplete],
	[ServiceRecords],
	[CountryCL],
	[OdometerUnits],
	[BuyItNowUsed],
	[MagicBoxSection3],
	[SnapprPackage],
	[CarfaxPassFail],
	[CCID],
	[StateProvinceRegion],
	[DealerName],
	[ListingProgress],
	[StartingBid],
	[EstimatedMarketValue],
	[Mileage],
	[IsPromoVehicle],
	[MagicBoxSection2],
	[SpinCarLink],
	[MagicBoxSection5],
	[Photo_Plan_Status],
	[Address],
	[HaveAllPhotos],
	[MagicBoxSection6],
	[OriginalEngine],
	[VehicleStoryDescriptionInterior],
	[UserComments],
	[CarTitleInYourName],
	[MarketValue],
	[PackageTransactionId],
	[Specialist_Section_Comp1_Price],
	[Rust],
	[MakeWholeAmount],
	[Specialist_Section_Comp3_Price],
	[VehicleStoryDescriptionEngineTransmissionPictures],
	[WhereDidYouHearAboutUsListing],
	[HasProPhotography],
	[IsApproved],
	[ListingNotes],
	[Specialist_Section_Comp4_Info],
	[HowLongOwned],
	[DraftEmailNotificationSent],
	[Copy_Writer_Feedback],
	[ExpertVideoReview],
	[Specialist_Section_Comp5_Info],
	[Comped],
	[BeenListedText],
	[IsTaxable],
	[Transmission],
	[BeenModified],
	[Specialist_Section_Comp3_Info],
	[CityCL],
	[PaintWorkText],
	[Dealer],
	[ReservePriceCL],
	[MileageAccurate],
	[Acct_Rep_Email],
	[LastServiceInformation],
	[DealerFees],
	[Specialist_Section_Comp4_Price],
	[VehicleStoryDescriptionExterior]
from insertData
    ');

  CREATE TABLE "dbo"."AH_Listings_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Listings_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Listings_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listings_FT__dbt_tmp_temp_view"
    end



21:45:51.538450 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:45:51.538632 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:45:51.699696 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:45:57.838124 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.30 seconds
21:45:57.920622 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT".
21:45:57.920987 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT: rename object "dbo"."AH_Listings_FT" to AH_Listings_FT__dbt_backup
21:45:57.970772 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:45:57.985166 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT".
21:45:57.985537 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT: rename object "dbo"."AH_Listings_FT__dbt_tmp" to AH_Listings_FT
21:45:58.019117 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:45:58.030898 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT: COMMIT
21:45:58.037658 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT".
21:45:58.037959 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT: 
    
  if object_id ('"dbo"."AH_Listings_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Listings_FT__dbt_backup"
    end

21:45:58.512252 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.47 seconds
21:45:58.525701 [debug] [Thread-1  ]: finished collecting timing info
21:45:58.526101 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT: Close
21:45:58.526923 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd75a3582-1126-494d-aefc-035d2577dbc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d1a22ef40>]}
21:45:58.527422 [info ] [Thread-1  ]: 1 of 1 OK created table model dbo.AH_Listings_FT................................ [[32mOK[0m in 7.06s]
21:45:58.527800 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Listings_FT
21:45:58.529052 [debug] [MainThread]: Acquiring new synapse connection "master"
21:45:58.529345 [debug] [MainThread]: On master: COMMIT
21:45:58.529658 [info ] [MainThread]: 
21:45:58.529901 [info ] [MainThread]: Finished running 1 table model in 29.44s.
21:45:58.530092 [debug] [MainThread]: Connection 'master' was properly closed.
21:45:58.530196 [debug] [MainThread]: Connection 'model.Shawn.AH_Listings_FT' was properly closed.
21:45:58.530289 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
21:45:58.557806 [info ] [MainThread]: 
21:45:58.558171 [info ] [MainThread]: [32mCompleted successfully[0m
21:45:58.558449 [info ] [MainThread]: 
21:45:58.558680 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
21:45:58.558977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d1e712c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d1c7037f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d1a250fa0>]}
