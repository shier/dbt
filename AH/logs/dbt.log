

============================== 2022-09-26 20:16:06.122707 | 2382ab44-75ac-44c4-9c2f-cf329a8ae50b ==============================
20:16:06.122707 [info ] [MainThread]: Running with dbt=1.0.0
20:16:06.123339 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step2_Incr'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
20:16:06.123542 [debug] [MainThread]: Tracking: tracking
20:16:06.123882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30ac39dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30ac39e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30ac39e80>]}
20:16:06.163537 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
20:16:06.163919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2382ab44-75ac-44c4-9c2f-cf329a8ae50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30abf32e0>]}
20:16:06.298827 [debug] [MainThread]: Parsing ../macros/generate_schema_name.sql
20:16:06.300330 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
20:16:06.305906 [debug] [MainThread]: Parsing macros/materializations/seeds/str_replace.sql
20:16:06.306825 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
20:16:06.312403 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
20:16:06.313934 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
20:16:06.316656 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
20:16:06.317338 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
20:16:06.319289 [debug] [MainThread]: Parsing macros/adapters/columns.sql
20:16:06.323725 [debug] [MainThread]: Parsing macros/adapters/relation.sql
20:16:06.326633 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
20:16:06.332672 [debug] [MainThread]: Parsing macros/adapters/schema.sql
20:16:06.333642 [debug] [MainThread]: Parsing macros/adapters.sql
20:16:06.333820 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
20:16:06.338776 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
20:16:06.340106 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
20:16:06.347285 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
20:16:06.349170 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
20:16:06.349851 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
20:16:06.351265 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
20:16:06.355496 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
20:16:06.357979 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
20:16:06.359413 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
20:16:06.359839 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
20:16:06.359979 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
20:16:06.364585 [debug] [MainThread]: Parsing macros/adapters/columns.sql
20:16:06.369143 [debug] [MainThread]: Parsing macros/adapters/relation.sql
20:16:06.374668 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
20:16:06.384303 [debug] [MainThread]: Parsing macros/adapters/schema.sql
20:16:06.387863 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
20:16:06.392269 [debug] [MainThread]: Parsing macros/materializations/configs.sql
20:16:06.394860 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
20:16:06.396839 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
20:16:06.401375 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
20:16:06.403329 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
20:16:06.409750 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
20:16:06.426510 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
20:16:06.438879 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
20:16:06.440927 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
20:16:06.458673 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
20:16:06.470508 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
20:16:06.475386 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
20:16:06.487388 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
20:16:06.497904 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
20:16:06.499803 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
20:16:06.515933 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
20:16:06.523736 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
20:16:06.526995 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
20:16:06.529528 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
20:16:06.532291 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
20:16:06.539580 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
20:16:06.541069 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
20:16:06.541809 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
20:16:06.543194 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
20:16:06.543761 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
20:16:06.544618 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
20:16:06.547558 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
20:16:06.552024 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
20:16:06.559918 [debug] [MainThread]: Parsing macros/adapters/columns.sql
20:16:06.569782 [debug] [MainThread]: Parsing macros/adapters/relation.sql
20:16:06.579683 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
20:16:06.582599 [debug] [MainThread]: Parsing macros/adapters/schema.sql
20:16:06.584916 [debug] [MainThread]: Parsing macros/etc/datetime.sql
20:16:06.593519 [debug] [MainThread]: Parsing macros/etc/statement.sql
20:16:06.598077 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
20:16:06.599874 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
20:16:06.602422 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
20:16:06.604054 [debug] [MainThread]: Parsing tests/generic/builtin.sql
20:16:06.825658 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Tiers.sql
20:16:06.836970 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Categories.sql
20:16:06.839272 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Events.sql
20:16:06.841373 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Locations.sql
20:16:06.843521 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingsReserveHistory.sql
20:16:06.845676 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingPaymentCharge.sql
20:16:06.847633 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserMessages.sql
20:16:06.849534 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ReListHistory.sql
20:16:06.851481 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypeproperties.sql
20:16:06.853388 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UnProcessedQueueMessages.sql
20:16:06.855589 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryCustomFields.sql
20:16:06.857466 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Feeschedules.sql
20:16:06.859373 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryListings.sql
20:16:06.861267 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_LogentriesBuffer.sql
20:16:06.863191 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_DailyhuntEmailSubscribers.sql
20:16:06.865074 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Languages.sql
20:16:06.867309 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Reports.sql
20:16:06.869231 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserAlerts.sql
20:16:06.871203 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Propertybags.sql
20:16:06.873225 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingQuestions.sql
20:16:06.875173 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Countries.sql
20:16:06.877364 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingMedias.sql
20:16:06.879268 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Feedbacks.sql
20:16:06.881188 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Invoices.sql
20:16:06.883102 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ExternalUserIDs.sql
20:16:06.885023 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Listings.sql
20:16:06.886940 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_MediaassetMetaData.sql
20:16:06.889614 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ShippingOptions.sql
20:16:06.891552 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingLocations.sql
20:16:06.893410 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Siteproperties.sql
20:16:06.895303 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SMStemplates.sql
20:16:06.897182 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedCategoryMap.sql
20:16:06.899373 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PaymentprovIDErs.sql
20:16:06.901283 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_States.sql
20:16:06.903196 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Increments.sql
20:16:06.905084 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ThReadTracking.sql
20:16:06.906998 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserOptOut.sql
20:16:06.908890 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Attributes.sql
20:16:06.911081 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingEnddttmAudit.sql
20:16:06.912976 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ShippingMethods.sql
20:16:06.914893 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingActions.sql
20:16:06.916807 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_BannerCategories.sql
20:16:06.918734 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Logentries.sql
20:16:06.920905 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Properties.sql
20:16:06.922811 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_BiddingTransactions.sql
20:16:06.924705 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Banners.sql
20:16:06.926624 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Contents.sql
20:16:06.928568 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedUserMap.sql
20:16:06.930478 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SalesTaxRates.sql
20:16:06.932691 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Notifications.sql
20:16:06.934597 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Feeproperties.sql
20:16:06.936481 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypeFeeprovIDErs.sql
20:16:06.938358 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_AuctionEventMedias.sql
20:16:06.940319 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_AuctionEvents.sql
20:16:06.942486 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Emailtemplates.sql
20:16:06.944434 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Addresses.sql
20:16:06.946325 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Media.sql
20:16:06.948255 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SubmittedListingPayment.sql
20:16:06.950140 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CustomFields.sql
20:16:06.952183 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_MediaMetaData.sql
20:16:06.954361 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SysDiagrams.sql
20:16:06.956284 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Lots.sql
20:16:06.958163 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CreditCardTypes.sql
20:16:06.960084 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Listingdecorations.sql
20:16:06.961980 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_KeyTable.sql
20:16:06.964181 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Watches.sql
20:16:06.966045 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_StripeCustomers.sql
20:16:06.967947 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PropertybagItems.sql
20:16:06.969839 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Version.sql
20:16:06.971737 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserLogins.sql
20:16:06.973618 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Userclaims.sql
20:16:06.975797 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Logstats.sql
20:16:06.977676 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Customcurrencies.sql
20:16:06.979601 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Userproperties.sql
20:16:06.981488 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_LineItems.sql
20:16:06.983394 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingActionproperties.sql
20:16:06.985533 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryCount.sql
20:16:06.987437 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedregionMap.sql
20:16:06.989278 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_NewSalestoInvoice.sql
20:16:06.991188 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Offers.sql
20:16:06.993061 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Mediaassets.sql
20:16:06.994975 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Currencies.sql
20:16:06.997114 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Users.sql
20:16:06.998993 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserRoles.sql
20:16:07.000872 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryListingTypes.sql
20:16:07.002758 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingCommentsMedias.sql
20:16:07.004639 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypeMedia.sql
20:16:07.006902 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SMStemplatecontents.sql
20:16:07.008771 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PaymentResponses.sql
20:16:07.010659 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CustomFieldenums.sql
20:16:07.012553 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Decorations.sql
20:16:07.014424 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypes.sql
20:16:07.016376 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Emailtemplatecontents.sql
20:16:07.018833 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CreditCards.sql
20:16:07.020700 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Mediavariations.sql
20:16:07.022588 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Roles.sql
20:16:07.024466 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingComments.sql
20:16:07.026352 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Contactus.sql
20:16:07.028579 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Model.sql
20:16:07.030469 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PaymentConfigurationTable.sql
20:16:07.032377 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedListingsMap.sql
20:16:07.034249 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Listingproperties.sql
20:16:07.036163 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Eventproperties.sql
20:16:07.038036 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CreditCardsExtraInFormation.sql
20:16:07.040222 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_BannedUsers.sql
20:16:07.042386 [debug] [MainThread]: 1603: static parser failed on tmp/SZ_AH_Properties_Pivot_Full.sql
20:16:07.059609 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/SZ_AH_Properties_Pivot_Full.sql
20:16:07.061252 [debug] [MainThread]: 1699: static parser successfully parsed step8_4_FT/AH_Listings_FT.sql
20:16:07.063697 [debug] [MainThread]: 1603: static parser failed on step7_3/AH_SZ_AllProperties_One_Column.sql
20:16:07.071063 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step7_3/AH_SZ_AllProperties_One_Column.sql
20:16:07.072471 [debug] [MainThread]: 1699: static parser successfully parsed step7_3/AH_SZ_Properties_CustomFields_Lookup.sql
20:16:07.075008 [debug] [MainThread]: 1699: static parser successfully parsed step8_2_FT_stg/AH_Listings_FT_stg.sql
20:16:07.077228 [debug] [MainThread]: 1603: static parser failed on step7_2/AH_SZ_Properties_Value_ColumnMapping.sql
20:16:07.083050 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step7_2/AH_SZ_Properties_Value_ColumnMapping.sql
20:16:07.084339 [debug] [MainThread]: 1699: static parser successfully parsed step7_1/AH_SZ_Properties_FieldIDs.sql
20:16:07.086426 [debug] [MainThread]: 1699: static parser successfully parsed step7_1/AH_SZ_Properties_FieldType.sql
20:16:07.088624 [debug] [MainThread]: 1603: static parser failed on step2_Incr/AH_UserLogins_Incr.sql
20:16:07.097036 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step2_Incr/AH_UserLogins_Incr.sql
20:16:07.098442 [debug] [MainThread]: 1603: static parser failed on step2_Incr/AH_CreditCards_Incr.sql
20:16:07.103282 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step2_Incr/AH_CreditCards_Incr.sql
20:16:07.104599 [debug] [MainThread]: 1603: static parser failed on step2_Incr/AH_Logstats_Incr.sql
20:16:07.108927 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step2_Incr/AH_Logstats_Incr.sql
20:16:07.110224 [debug] [MainThread]: 1603: static parser failed on step2_Incr/AH_UnProcessedQueueMessages_Incr.sql
20:16:07.114517 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step2_Incr/AH_UnProcessedQueueMessages_Incr.sql
20:16:07.115979 [debug] [MainThread]: 1603: static parser failed on step7_4/AH_SZ_Properties_Pivot.sql
20:16:07.124544 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step7_4/AH_SZ_Properties_Pivot.sql
20:16:07.125975 [debug] [MainThread]: 1699: static parser successfully parsed step8_1_DM/AH_Cars_DM.sql
20:16:07.128278 [debug] [MainThread]: 1699: static parser successfully parsed step8_3_FT_tmp/AH_Listings_FT_tmp.sql
20:16:07.131925 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_ListingActions_FT_stg.sql
20:16:07.134090 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_Watches_FT_stg.sql
20:16:07.136225 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_Invoices_FT_stg.sql
20:16:07.138264 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_LineItems_FT_stg.sql
20:16:07.140324 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_ListingPaymentCharge_FT_stg.sql
20:16:07.142338 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_SubmittedListingPayment_FT_stg.sql
20:16:07.144628 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_LineItems_FT_tmp.sql
20:16:07.146632 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_SubmittedListingPayment_FT_tmp.sql
20:16:07.148613 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_Invoices_FT_tmp.sql
20:16:07.150587 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_Watches_FT_tmp.sql
20:16:07.152554 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_ListingActions_FT_tmp.sql
20:16:07.154839 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_ListingPaymentCharge_FT_tmp.sql
20:16:07.156764 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Users_InterView.sql
20:16:07.158731 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_BannerCategories_InterView.sql
20:16:07.160638 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Events_InterView.sql
20:16:07.162534 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Logstats_InterView.sql
20:16:07.164437 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Attributes_InterView.sql
20:16:07.166617 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserRoles_InterView.sql
20:16:07.168507 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Locations_InterView.sql
20:16:07.170414 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Mediavariations_InterView.sql
20:16:07.172341 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SalesTaxRates_InterView.sql
20:16:07.174223 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CustomFieldenums_InterView.sql
20:16:07.176418 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ImportedUserMap_InterView.sql
20:16:07.178303 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Increments_InterView.sql
20:16:07.180211 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Customcurrencies_InterView.sql
20:16:07.182104 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Lots_InterView.sql
20:16:07.184036 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Contactus_InterView.sql
20:16:07.185906 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SMStemplates_InterView.sql
20:16:07.188130 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_BannedUsers_InterView.sql
20:16:07.190094 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Userproperties_InterView.sql
20:16:07.192094 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CreditCards_InterView.sql
20:16:07.194017 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Offers_InterView.sql
20:16:07.196081 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_PropertybagItems_InterView.sql
20:16:07.198298 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingActionproperties_InterView.sql
20:16:07.200222 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_States_InterView.sql
20:16:07.202110 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CategoryCustomFields_InterView.sql
20:16:07.204037 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingComments_InterView.sql
20:16:07.205918 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CustomFields_InterView.sql
20:16:07.207834 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Version_InterView.sql
20:16:07.210006 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Categories_InterView.sql
20:16:07.211966 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_MediaMetaData_InterView.sql
20:16:07.213838 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingsReserveHistory_InterView.sql
20:16:07.215749 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingTypes_InterView.sql
20:16:07.217630 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingTypeFeeprovIDErs_InterView.sql
20:16:07.219867 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CreditCardsExtraInFormation_InterView.sql
20:16:07.221750 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_PaymentprovIDErs_InterView.sql
20:16:07.223669 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingLocations_InterView.sql
20:16:07.225555 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Banners_InterView.sql
20:16:07.227492 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Eventproperties_InterView.sql
20:16:07.229380 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingCommentsMedias_InterView.sql
20:16:07.231650 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Languages_InterView.sql
20:16:07.233594 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Emailtemplatecontents_InterView.sql
20:16:07.235534 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Feedbacks_InterView.sql
20:16:07.237442 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_AuctionEvents_InterView.sql
20:16:07.239360 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SubmittedListingPayment_InterView.sql
20:16:07.241559 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_AuctionEventMedias_InterView.sql
20:16:07.243467 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingQuestions_InterView.sql
20:16:07.245348 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ShippingOptions_InterView.sql
20:16:07.247288 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Contents_InterView.sql
20:16:07.249177 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ImportedListingsMap_InterView.sql
20:16:07.251090 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Properties_InterView.sql
20:16:07.253227 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Listingdecorations_InterView.sql
20:16:07.255122 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Feeschedules_InterView.sql
20:16:07.256987 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ImportedCategoryMap_InterView.sql
20:16:07.258875 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Emailtemplates_InterView.sql
20:16:07.260710 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Reports_InterView.sql
20:16:07.263155 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CreditCardTypes_InterView.sql
20:16:07.265003 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserAlerts_InterView.sql
20:16:07.266878 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingTypeMedia_InterView.sql
20:16:07.268727 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ExternalUserIDs_InterView.sql
20:16:07.270600 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ThReadTracking_InterView.sql
20:16:07.272594 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ShippingMethods_InterView.sql
20:16:07.274779 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Invoices_InterView.sql
20:16:07.276624 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_MediaassetMetaData_InterView.sql
20:16:07.278470 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Propertybags_InterView.sql
20:16:07.280355 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingPaymentCharge_InterView.sql
20:16:07.282290 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingTypeproperties_InterView.sql
20:16:07.284458 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Logentries_InterView.sql
20:16:07.286302 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Listings_InterView.sql
20:16:07.288205 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Notifications_InterView.sql
20:16:07.290064 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingActions_InterView.sql
20:16:07.291970 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_KeyTable_InterView.sql
20:16:07.293850 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Watches_InterView.sql
20:16:07.296331 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Siteproperties_InterView.sql
20:16:07.298501 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserOptOut_InterView.sql
20:16:07.300810 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_BiddingTransactions_InterView.sql
20:16:07.303067 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SysDiagrams_InterView.sql
20:16:07.305004 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Tiers_InterView.sql
20:16:07.307229 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_PaymentConfigurationTable_InterView.sql
20:16:07.309129 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Userclaims_InterView.sql
20:16:07.311094 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserLogins_InterView.sql
20:16:07.312984 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ImportedregionMap_InterView.sql
20:16:07.314895 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Countries_InterView.sql
20:16:07.316783 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_LineItems_InterView.sql
20:16:07.318963 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UnProcessedQueueMessages_InterView.sql
20:16:07.320824 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CategoryCount_InterView.sql
20:16:07.322733 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_StripeCustomers_InterView.sql
20:16:07.324587 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserMessages_InterView.sql
20:16:07.326478 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Decorations_InterView.sql
20:16:07.328685 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Model_InterView.sql
20:16:07.330581 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Addresses_InterView.sql
20:16:07.332460 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Mediaassets_InterView.sql
20:16:07.334315 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Roles_InterView.sql
20:16:07.336254 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_NewSalestoInvoice_InterView.sql
20:16:07.338132 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CategoryListingTypes_InterView.sql
20:16:07.340334 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ReListHistory_InterView.sql
20:16:07.342214 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Listingproperties_InterView.sql
20:16:07.344109 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Feeproperties_InterView.sql
20:16:07.345980 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Currencies_InterView.sql
20:16:07.347885 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingMedias_InterView.sql
20:16:07.350070 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Media_InterView.sql
20:16:07.351975 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingEnddttmAudit_InterView.sql
20:16:07.353853 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_PaymentResponses_InterView.sql
20:16:07.355784 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CategoryListings_InterView.sql
20:16:07.357676 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_LogentriesBuffer_InterView.sql
20:16:07.359598 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_DailyhuntEmailSubscribers_InterView.sql
20:16:07.361758 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SMStemplatecontents_InterView.sql
20:16:07.363734 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Siteproperties_FinalView.sql
20:16:07.365618 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Feeschedules_FinalView.sql
20:16:07.367539 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Properties_FinalView.sql
20:16:07.369406 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Logentries_FinalView.sql
20:16:07.371606 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Userclaims_FinalView.sql
20:16:07.373463 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserOptOut_FinalView.sql
20:16:07.375466 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CreditCardTypes_FinalView.sql
20:16:07.377327 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_KeyTable_FinalView.sql
20:16:07.379227 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Invoices_FinalView.sql
20:16:07.381120 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_LineItems_FinalView.sql
20:16:07.383319 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Propertybags_FinalView.sql
20:16:07.385201 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Contactus_FinalView.sql
20:16:07.387125 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Currencies_FinalView.sql
20:16:07.388978 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Users_FinalView.sql
20:16:07.390901 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserMessages_FinalView.sql
20:16:07.393308 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Addresses_FinalView.sql
20:16:07.395201 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Listingdecorations_FinalView.sql
20:16:07.397071 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Roles_FinalView.sql
20:16:07.398939 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Watches_FinalView.sql
20:16:07.400791 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingTypeMedia_FinalView.sql
20:16:07.402746 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_PaymentResponses_FinalView.sql
20:16:07.404991 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SubmittedListingPayment_FinalView.sql
20:16:07.406910 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ExternalUserIDs_FinalView.sql
20:16:07.408801 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SalesTaxRates_FinalView.sql
20:16:07.410711 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserLogins_FinalView.sql
20:16:07.412594 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CustomFields_FinalView.sql
20:16:07.414876 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_BiddingTransactions_FinalView.sql
20:16:07.416774 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Emailtemplates_FinalView.sql
20:16:07.418696 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ImportedregionMap_FinalView.sql
20:16:07.420566 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_BannerCategories_FinalView.sql
20:16:07.422462 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingActions_FinalView.sql
20:16:07.424374 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ShippingOptions_FinalView.sql
20:16:07.426526 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Contents_FinalView.sql
20:16:07.428445 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingActionproperties_FinalView.sql
20:16:07.430292 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ReListHistory_FinalView.sql
20:16:07.432183 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ShippingMethods_FinalView.sql
20:16:07.434062 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Offers_FinalView.sql
20:16:07.436284 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CustomFieldenums_FinalView.sql
20:16:07.438148 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Emailtemplatecontents_FinalView.sql
20:16:07.440055 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Mediavariations_FinalView.sql
20:16:07.441938 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CategoryListingTypes_FinalView.sql
20:16:07.443832 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CategoryCustomFields_FinalView.sql
20:16:07.445735 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingPaymentCharge_FinalView.sql
20:16:07.447953 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Userproperties_FinalView.sql
20:16:07.449816 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Feeproperties_FinalView.sql
20:16:07.451746 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ImportedCategoryMap_FinalView.sql
20:16:07.451915 [debug] [MainThread]: 1611: conducting full jinja rendering sample on step3_FinalView/AH_ImportedCategoryMap_FinalView.sql
20:16:07.461848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '2382ab44-75ac-44c4-9c2f-cf329a8ae50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30a76a340>]}
20:16:07.463341 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingTypeFeeprovIDErs_FinalView.sql
20:16:07.465617 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingEnddttmAudit_FinalView.sql
20:16:07.467573 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_MediaassetMetaData_FinalView.sql
20:16:07.469471 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Listings_FinalView.sql
20:16:07.471441 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Mediaassets_FinalView.sql
20:16:07.473359 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Media_FinalView.sql
20:16:07.475311 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_AuctionEvents_FinalView.sql
20:16:07.477447 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Locations_FinalView.sql
20:16:07.479364 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CategoryCount_FinalView.sql
20:16:07.481239 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingLocations_FinalView.sql
20:16:07.483147 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SMStemplatecontents_FinalView.sql
20:16:07.485028 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingQuestions_FinalView.sql
20:16:07.488067 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CategoryListings_FinalView.sql
20:16:07.489956 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Feedbacks_FinalView.sql
20:16:07.491862 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Lots_FinalView.sql
20:16:07.493723 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SMStemplates_FinalView.sql
20:16:07.495638 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Reports_FinalView.sql
20:16:07.497491 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Countries_FinalView.sql
20:16:07.499677 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Eventproperties_FinalView.sql
20:16:07.501544 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingCommentsMedias_FinalView.sql
20:16:07.503438 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_States_FinalView.sql
20:16:07.505296 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_PaymentConfigurationTable_FinalView.sql
20:16:07.507210 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SysDiagrams_FinalView.sql
20:16:07.509408 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserRoles_FinalView.sql
20:16:07.511326 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_AuctionEventMedias_FinalView.sql
20:16:07.513240 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Listingproperties_FinalView.sql
20:16:07.515185 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserAlerts_FinalView.sql
20:16:07.517085 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingTypeproperties_FinalView.sql
20:16:07.519016 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CreditCardsExtraInFormation_FinalView.sql
20:16:07.521214 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_NewSalestoInvoice_FinalView.sql
20:16:07.523136 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Customcurrencies_FinalView.sql
20:16:07.525019 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_DailyhuntEmailSubscribers_FinalView.sql
20:16:07.526938 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Events_FinalView.sql
20:16:07.528796 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ImportedListingsMap_FinalView.sql
20:16:07.531058 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_BannedUsers_FinalView.sql
20:16:07.532943 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_MediaMetaData_FinalView.sql
20:16:07.534871 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Notifications_FinalView.sql
20:16:07.536753 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingsReserveHistory_FinalView.sql
20:16:07.538662 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Decorations_FinalView.sql
20:16:07.540533 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Attributes_FinalView.sql
20:16:07.542766 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Tiers_FinalView.sql
20:16:07.544641 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Model_FinalView.sql
20:16:07.546522 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_PaymentprovIDErs_FinalView.sql
20:16:07.548451 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingMedias_FinalView.sql
20:16:07.550313 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ImportedUserMap_FinalView.sql
20:16:07.552574 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingComments_FinalView.sql
20:16:07.554456 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Logstats_FinalView.sql
20:16:07.556374 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UnProcessedQueueMessages_FinalView.sql
20:16:07.558276 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ThReadTracking_FinalView.sql
20:16:07.560204 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_PropertybagItems_FinalView.sql
20:16:07.562083 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CreditCards_FinalView.sql
20:16:07.564294 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Version_FinalView.sql
20:16:07.566168 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_LogentriesBuffer_FinalView.sql
20:16:07.568122 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingTypes_FinalView.sql
20:16:07.569981 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Increments_FinalView.sql
20:16:07.571885 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Categories_FinalView.sql
20:16:07.574062 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Banners_FinalView.sql
20:16:07.575955 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Languages_FinalView.sql
20:16:07.577842 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_StripeCustomers_FinalView.sql
20:16:07.579788 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_ListingPaymentCharge_FT.sql
20:16:07.581673 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_Watches_FT.sql
20:16:07.583642 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_LineItems_FT.sql
20:16:07.585847 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_Invoice_FT.sql
20:16:07.587761 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_ListingActions_FT.sql
20:16:07.589647 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_SubmittedListingPayment_FT.sql
20:16:07.591579 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_Currencies_DM.sql
20:16:07.593440 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_ShippingOptions_DM.sql
20:16:07.595816 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_Buyers_DM.sql
20:16:07.597716 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_Categories_DM.sql
20:16:07.599688 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_Consignors_DM.sql
20:16:08.247568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2382ab44-75ac-44c4-9c2f-cf329a8ae50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30a73ef10>]}
20:16:08.300692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2382ab44-75ac-44c4-9c2f-cf329a8ae50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30a76ac40>]}
20:16:08.301161 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:16:08.310085 [info ] [MainThread]: 
20:16:08.310822 [debug] [MainThread]: Acquiring new synapse connection "master"
20:16:08.312170 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
20:16:08.317743 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
20:16:08.317959 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
20:16:08.318050 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:16:08.318160 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:16:08.720250 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:16:08.767907 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.45 seconds
20:16:08.769790 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
20:16:08.793158 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
20:16:08.804881 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
20:16:08.805414 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
20:16:08.807857 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
20:16:08.808038 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
20:16:08.808122 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:16:08.808229 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:16:08.805670 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
20:16:08.809624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:16:08.809785 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:16:08.938256 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:16:08.938771 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:16:09.005477 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:16:09.009782 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:16:09.088118 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
20:16:09.088442 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
20:16:09.148750 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
20:16:09.159756 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
20:16:32.670482 [debug] [MainThread]: On master: COMMIT
20:16:32.671825 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
20:16:32.672102 [info ] [MainThread]: 
20:16:32.676171 [debug] [Thread-1  ]: Began running node model.Shawn.AH_CreditCards_Incr
20:16:32.676551 [info ] [Thread-1  ]: 1 of 4 START incremental model stg.AH_CreditCards_Incr.......................... [RUN]
20:16:32.677060 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_CreditCards_Incr"
20:16:32.677188 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_CreditCards_Incr
20:16:32.677307 [debug] [Thread-1  ]: Compiling model.Shawn.AH_CreditCards_Incr
20:16:32.682883 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Logstats_Incr
20:16:32.683245 [info ] [Thread-2  ]: 2 of 4 START incremental model stg.AH_Logstats_Incr............................. [RUN]
20:16:32.683704 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Logstats_Incr"
20:16:32.683829 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Logstats_Incr
20:16:32.683928 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Logstats_Incr
20:16:32.687442 [debug] [Thread-3  ]: Began running node model.Shawn.AH_UnProcessedQueueMessages_Incr
20:16:32.687744 [info ] [Thread-3  ]: 3 of 4 START incremental model stg.AH_UnProcessedQueueMessages_Incr............. [RUN]
20:16:32.688201 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr"
20:16:32.688316 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_UnProcessedQueueMessages_Incr
20:16:32.688411 [debug] [Thread-3  ]: Compiling model.Shawn.AH_UnProcessedQueueMessages_Incr
20:16:32.691692 [debug] [Thread-4  ]: Began running node model.Shawn.AH_UserLogins_Incr
20:16:32.691971 [info ] [Thread-4  ]: 4 of 4 START incremental model stg.AH_UserLogins_Incr........................... [RUN]
20:16:32.692386 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_UserLogins_Incr"
20:16:32.692494 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_UserLogins_Incr
20:16:32.692586 [debug] [Thread-4  ]: Compiling model.Shawn.AH_UserLogins_Incr
20:16:32.761226 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_CreditCards_Incr"
20:16:32.776907 [debug] [Thread-1  ]: finished collecting timing info
20:16:32.777077 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_CreditCards_Incr
20:16:32.776313 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Logstats_Incr"
20:16:32.788068 [debug] [Thread-2  ]: finished collecting timing info
20:16:32.788307 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Logstats_Incr
20:16:32.773565 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_UnProcessedQueueMessages_Incr"
20:16:32.821466 [debug] [Thread-3  ]: finished collecting timing info
20:16:32.821718 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_UnProcessedQueueMessages_Incr
20:16:32.810986 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_UserLogins_Incr"
20:16:32.848068 [debug] [Thread-4  ]: finished collecting timing info
20:16:32.848306 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_UserLogins_Incr
20:16:33.105387 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
20:16:33.121402 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    
  
  if object_id ('"stg"."AH_Logstats_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Logstats_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Logstats_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Logstats_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Logstats_Incr__dbt_tmp_temp_view as
    
With hashData as (
		Select
			*, HASHBYTES(''SHA2_256'', concat(Cast([FromDate] as varchar), Cast([RangeMinutes] as varchar), Cast([EntryCount] as varchar), Cast([IsArchived] as varchar), [Severity])) as dbt_scd_id,
			CURRENT_TIMESTAMP as dbt_updated_at, 
			CURRENT_TIMESTAMP as dbt_valid_from, 
			NULL as dbt_valid_to
		From stg.[AH_Logstats_InterView]
	)
Select * From hashData

	where not exists 
	(
		select dbt_scd_id 
		from "BJAC_DW_PROD"."stg"."AH_Logstats_Incr" compareData
		where hashData.dbt_scd_id=compareData.dbt_scd_id
	)

    ');

  CREATE TABLE "stg"."#AH_Logstats_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Logstats_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Logstats_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Logstats_Incr__dbt_tmp_temp_view"
    end



  
20:16:33.121507 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:16:33.121624 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:16:33.106216 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
20:16:33.122687 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    
  
  if object_id ('"stg"."AH_CreditCards_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCards_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CreditCards_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CreditCards_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CreditCards_Incr__dbt_tmp_temp_view as
    
With hashData as (
		Select
			*, HASHBYTES(''SHA2_256'', concat(Cast([ID] as varchar), [ExpirationMonth], [ExpirationYear], Cast([CreditCardTypeID] as varchar), Cast([UserID] as varchar), Cast([AddressID] as varchar), Cast([CreatedOn] as varchar), Cast([UpdatedOn] as varchar), Cast([DeletedOn] as varchar), [CardNumber], [LastUpdatedUser], [LastFourdigits], [Description])) as dbt_scd_id,
			CURRENT_TIMESTAMP as dbt_updated_at,
			CURRENT_TIMESTAMP as dbt_valid_from, 
			NULL as dbt_valid_to
		From stg.[AH_CreditCards_InterView]
	)
Select * From hashData

	where not exists 
	(
		select dbt_scd_id 
		from "BJAC_DW_PROD"."stg"."AH_CreditCards_Incr" compareData
		where hashData.dbt_scd_id=compareData.dbt_scd_id
	)

    ');

  CREATE TABLE "stg"."#AH_CreditCards_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CreditCards_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CreditCards_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCards_Incr__dbt_tmp_temp_view"
    end



  
20:16:33.122853 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:16:33.122965 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:16:33.113047 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
20:16:33.124036 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    
  
  if object_id ('"stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view as
    
With hashData as (
		Select
			*, HASHBYTES(''SHA2_256'', concat([QueueName], [QueueData], Cast([QueueOrder] as varchar))) as dbt_scd_id,
			CURRENT_TIMESTAMP as dbt_updated_at, 
			CURRENT_TIMESTAMP as dbt_valid_from, 
			NULL as dbt_valid_to
		From stg.[AH_UnProcessedQueueMessages_InterView]
	)
Select * From hashData

	where not exists 
	(
		select dbt_scd_id 
		from "BJAC_DW_PROD"."stg"."AH_UnProcessedQueueMessages_Incr" compareData
		where hashData.dbt_scd_id=compareData.dbt_scd_id
	)

    ');

  CREATE TABLE "stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view"
    end



  
20:16:33.124163 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:16:33.124263 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:16:33.121120 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
20:16:33.125569 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    
  
  if object_id ('"stg"."AH_UserLogins_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserLogins_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UserLogins_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserLogins_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UserLogins_Incr__dbt_tmp_temp_view as
    
With hashData as (
		Select
			*, HASHBYTES(''SHA2_256'', concat([LoginprovIDEr], [ProvIDErKey], Cast([UserID] as varchar))) as dbt_scd_id,
			CURRENT_TIMESTAMP as dbt_updated_at, 
			CURRENT_TIMESTAMP as dbt_valid_from, 
			NULL as dbt_valid_to
		From stg.[AH_UserLogins_InterView]
	)
Select * From hashData

	where not exists 
	(
		select dbt_scd_id 
		from "BJAC_DW_PROD"."stg"."AH_UserLogins_Incr" compareData
		where hashData.dbt_scd_id=compareData.dbt_scd_id
	)

    ');

  CREATE TABLE "stg"."#AH_UserLogins_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UserLogins_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UserLogins_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserLogins_Incr__dbt_tmp_temp_view"
    end



  
20:16:33.125702 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:16:33.125807 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:16:33.249010 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:16:33.253635 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:16:33.254205 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:16:33.254495 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:16:37.671984 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 4.55 seconds
20:16:37.690096 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
20:16:37.690374 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    
  if object_id ('"stg"."AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:16:37.690666 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 4.57 seconds
20:16:37.694114 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
20:16:37.694380 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    
  if object_id ('"stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:16:37.734617 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:16:37.736279 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
20:16:37.736494 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserLogins_Incr__dbt_tmp"
    
20:16:37.736749 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:16:37.737833 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
20:16:37.737975 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"
    
20:16:38.832669 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 5.71 seconds
20:16:38.837013 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
20:16:38.837272 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    
  if object_id ('"stg"."AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:16:38.991940 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:16:38.993611 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
20:16:38.993823 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Logstats_Incr__dbt_tmp"
    
20:16:39.203194 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.47 seconds
20:16:39.204801 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
20:16:39.205013 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:16:39.331651 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.59 seconds
20:16:39.333341 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
20:16:39.333924 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:16:39.334218 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:16:39.338762 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
20:16:39.338943 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    
  if object_id ('"stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:16:39.410447 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:16:39.413280 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
20:16:39.413512 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    
  if object_id ('"stg"."AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:16:39.538788 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:16:39.542176 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
20:16:39.542435 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UnProcessedQueueMessages_Incr'
      and table_schema = 'stg'
  
20:16:39.650307 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:16:39.658769 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
20:16:39.659037 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UnProcessedQueueMessages_Incr'
      and table_schema = 'stg'
  
20:16:39.677876 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:16:39.682435 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
20:16:39.682915 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserLogins_Incr'
      and table_schema = 'stg'
  
20:16:39.698762 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:16:39.709914 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_UnProcessedQueueMessages_Incr"
20:16:39.710612 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
20:16:39.710796 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
      
      
      delete from "BJAC_DW_PROD"."stg"."AH_UnProcessedQueueMessages_Incr"
          where (
                dbt_scd_id) in (
      select (dbt_scd_id)
      from "BJAC_DW_PROD"."stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"
          );

      
      

      insert into "BJAC_DW_PROD"."stg"."AH_UnProcessedQueueMessages_Incr" ("QueueName", "QueueData", "QueueOrder", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")
          (
      select "QueueName", "QueueData", "QueueOrder", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to"
      from "BJAC_DW_PROD"."stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"
          )


  
20:16:39.757400 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:16:39.761138 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
20:16:39.761394 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserLogins_Incr'
      and table_schema = 'stg'
  
20:16:39.797969 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:16:39.800659 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_UserLogins_Incr"
20:16:39.801133 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
20:16:39.801273 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
      
      
      delete from "BJAC_DW_PROD"."stg"."AH_UserLogins_Incr"
          where (
                dbt_scd_id) in (
      select (dbt_scd_id)
      from "BJAC_DW_PROD"."stg"."#AH_UserLogins_Incr__dbt_tmp"
          );

      
      

      insert into "BJAC_DW_PROD"."stg"."AH_UserLogins_Incr" ("LoginprovIDEr", "ProvIDErKey", "UserID", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")
          (
      select "LoginprovIDEr", "ProvIDErKey", "UserID", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to"
      from "BJAC_DW_PROD"."stg"."#AH_UserLogins_Incr__dbt_tmp"
          )


  
20:16:40.151484 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
20:16:40.153353 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
20:16:40.153610 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:16:40.243705 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:16:40.246421 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
20:16:40.246664 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    
  if object_id ('"stg"."AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:16:40.427122 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:16:40.430207 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
20:16:40.430404 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logstats_Incr'
      and table_schema = 'stg'
  
20:16:40.501577 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:16:40.505274 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
20:16:40.505492 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logstats_Incr'
      and table_schema = 'stg'
  
20:16:40.561169 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:16:40.563818 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Logstats_Incr"
20:16:40.564292 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
20:16:40.564419 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
      
      
      delete from "BJAC_DW_PROD"."stg"."AH_Logstats_Incr"
          where (
                dbt_scd_id) in (
      select (dbt_scd_id)
      from "BJAC_DW_PROD"."stg"."#AH_Logstats_Incr__dbt_tmp"
          );

      
      

      insert into "BJAC_DW_PROD"."stg"."AH_Logstats_Incr" ("FromDate", "RangeMinutes", "EntryCount", "IsArchived", "Severity", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")
          (
      select "FromDate", "RangeMinutes", "EntryCount", "IsArchived", "Severity", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to"
      from "BJAC_DW_PROD"."stg"."#AH_Logstats_Incr__dbt_tmp"
          )


  
20:16:41.366369 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.66 seconds
20:16:41.373719 [debug] [Thread-3  ]: On model.Shawn.AH_UnProcessedQueueMessages_Incr: COMMIT
20:16:41.387674 [debug] [Thread-3  ]: finished collecting timing info
20:16:41.387999 [debug] [Thread-3  ]: On model.Shawn.AH_UnProcessedQueueMessages_Incr: Close
20:16:41.388777 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2382ab44-75ac-44c4-9c2f-cf329a8ae50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb308571160>]}
20:16:41.389232 [info ] [Thread-3  ]: 3 of 4 OK created incremental model stg.AH_UnProcessedQueueMessages_Incr........ [[32mOK[0m in 8.70s]
20:16:41.389564 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_UnProcessedQueueMessages_Incr
20:16:41.461968 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.66 seconds
20:16:41.463915 [debug] [Thread-4  ]: On model.Shawn.AH_UserLogins_Incr: COMMIT
20:16:41.477682 [debug] [Thread-4  ]: finished collecting timing info
20:16:41.477976 [debug] [Thread-4  ]: On model.Shawn.AH_UserLogins_Incr: Close
20:16:41.478786 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2382ab44-75ac-44c4-9c2f-cf329a8ae50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3085172b0>]}
20:16:41.479218 [info ] [Thread-4  ]: 4 of 4 OK created incremental model stg.AH_UserLogins_Incr...................... [[32mOK[0m in 8.79s]
20:16:41.479517 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_UserLogins_Incr
20:16:42.093815 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.53 seconds
20:16:42.095676 [debug] [Thread-2  ]: On model.Shawn.AH_Logstats_Incr: COMMIT
20:16:42.108348 [debug] [Thread-2  ]: finished collecting timing info
20:16:42.108677 [debug] [Thread-2  ]: On model.Shawn.AH_Logstats_Incr: Close
20:16:42.109433 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2382ab44-75ac-44c4-9c2f-cf329a8ae50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3086795e0>]}
20:16:42.109863 [info ] [Thread-2  ]: 2 of 4 OK created incremental model stg.AH_Logstats_Incr........................ [[32mOK[0m in 9.43s]
20:16:42.110165 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Logstats_Incr
20:16:49.853941 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 16.73 seconds
20:16:49.857611 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
20:16:49.857809 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    
  if object_id ('"stg"."AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:16:49.903463 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:16:49.905372 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
20:16:49.905563 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCards_Incr__dbt_tmp"
    
20:16:50.891093 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.99 seconds
20:16:50.893282 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
20:16:50.893491 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:16:50.979871 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:16:50.982787 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
20:16:50.983014 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    
  if object_id ('"stg"."AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:16:51.157964 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:16:51.160894 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
20:16:51.161108 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCards_Incr'
      and table_schema = 'stg'
  
20:16:51.231252 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:16:51.235296 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
20:16:51.235555 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCards_Incr'
      and table_schema = 'stg'
  
20:16:51.270743 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:16:51.274031 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_CreditCards_Incr"
20:16:51.274524 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
20:16:51.274753 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
      
      
      delete from "BJAC_DW_PROD"."stg"."AH_CreditCards_Incr"
          where (
                dbt_scd_id) in (
      select (dbt_scd_id)
      from "BJAC_DW_PROD"."stg"."#AH_CreditCards_Incr__dbt_tmp"
          );

      
      

      insert into "BJAC_DW_PROD"."stg"."AH_CreditCards_Incr" ("ID", "ExpirationMonth", "ExpirationYear", "CreditCardTypeID", "UserID", "AddressID", "CreatedOn", "UpdatedOn", "DeletedOn", "CardNumber", "LastUpdatedUser", "LastFourdigits", "Description", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")
          (
      select "ID", "ExpirationMonth", "ExpirationYear", "CreditCardTypeID", "UserID", "AddressID", "CreatedOn", "UpdatedOn", "DeletedOn", "CardNumber", "LastUpdatedUser", "LastFourdigits", "Description", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to"
      from "BJAC_DW_PROD"."stg"."#AH_CreditCards_Incr__dbt_tmp"
          )


  
20:16:52.546815 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.27 seconds
20:16:52.548558 [debug] [Thread-1  ]: On model.Shawn.AH_CreditCards_Incr: COMMIT
20:16:52.636577 [debug] [Thread-1  ]: finished collecting timing info
20:16:52.636903 [debug] [Thread-1  ]: On model.Shawn.AH_CreditCards_Incr: Close
20:16:52.637621 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2382ab44-75ac-44c4-9c2f-cf329a8ae50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30868e550>]}
20:16:52.638045 [info ] [Thread-1  ]: 1 of 4 OK created incremental model stg.AH_CreditCards_Incr..................... [[32mOK[0m in 19.96s]
20:16:52.638355 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_CreditCards_Incr
20:16:52.639851 [debug] [MainThread]: Acquiring new synapse connection "master"
20:16:52.640102 [debug] [MainThread]: On master: COMMIT
20:16:52.640397 [info ] [MainThread]: 
20:16:52.640596 [info ] [MainThread]: Finished running 4 incremental models in 44.33s.
20:16:52.640747 [debug] [MainThread]: Connection 'master' was properly closed.
20:16:52.640821 [debug] [MainThread]: Connection 'model.Shawn.AH_Logstats_Incr' was properly closed.
20:16:52.640884 [debug] [MainThread]: Connection 'model.Shawn.AH_CreditCards_Incr' was properly closed.
20:16:52.640944 [debug] [MainThread]: Connection 'model.Shawn.AH_UnProcessedQueueMessages_Incr' was properly closed.
20:16:52.641003 [debug] [MainThread]: Connection 'model.Shawn.AH_UserLogins_Incr' was properly closed.
20:16:52.671280 [info ] [MainThread]: 
20:16:52.671622 [info ] [MainThread]: [32mCompleted successfully[0m
20:16:52.671863 [info ] [MainThread]: 
20:16:52.672001 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
20:16:52.672266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30abf3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30a7981f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb308723760>]}


============================== 2022-09-26 20:16:55.049544 | a9bc2616-eeb2-4085-8b0f-f580f9cb464e ==============================
20:16:55.049544 [info ] [MainThread]: Running with dbt=1.0.0
20:16:55.054719 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='snapshot', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='snapshot', write_json=None)
20:16:55.055006 [debug] [MainThread]: Tracking: tracking
20:16:55.055320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016797fd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016797fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016797fe20>]}
20:16:55.261052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:16:55.261393 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:16:55.288636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01679051c0>]}
20:16:55.339033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0169942940>]}
20:16:55.339482 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:16:55.352862 [info ] [MainThread]: 
20:16:55.353624 [debug] [MainThread]: Acquiring new synapse connection "master"
20:16:55.359224 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
20:16:55.368849 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
20:16:55.369085 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
20:16:55.369181 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:16:55.369299 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:16:55.659928 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:16:55.691309 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.32 seconds
20:16:55.693342 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
20:16:55.715599 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
20:16:55.721518 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
20:16:55.721706 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
20:16:55.721796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:16:55.721900 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:16:55.722873 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
20:16:55.724757 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
20:16:55.724906 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
20:16:55.724987 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:16:55.725082 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:16:55.831859 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:16:55.832412 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:16:55.901043 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:16:55.903407 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:16:56.053516 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
20:16:56.053860 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
20:16:56.115939 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
20:16:56.116262 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
20:17:19.328869 [debug] [MainThread]: On master: COMMIT
20:17:19.330284 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
20:17:19.330632 [info ] [MainThread]: 
20:17:19.335911 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Addresses_Incr
20:17:19.336286 [info ] [Thread-1  ]: 1 of 101 START snapshot stg.AH_Addresses_Incr................................... [RUN]
20:17:19.336809 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Addresses_Incr"
20:17:19.337356 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Addresses_Incr
20:17:19.337043 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_AuctionEventMedias_Incr
20:17:19.337687 [info ] [Thread-3  ]: 3 of 101 START snapshot stg.AH_AuctionEventMedias_Incr.......................... [RUN]
20:17:19.338080 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr"
20:17:19.338182 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_AuctionEventMedias_Incr
20:17:19.338263 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_AuctionEventMedias_Incr
20:17:19.337230 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_AuctionEvents_Incr
20:17:19.341647 [info ] [Thread-4  ]: 4 of 101 START snapshot stg.AH_AuctionEvents_Incr............................... [RUN]
20:17:19.342037 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr"
20:17:19.342143 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_AuctionEvents_Incr
20:17:19.342227 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_AuctionEvents_Incr
20:17:19.345319 [debug] [Thread-4  ]: finished collecting timing info
20:17:19.345473 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_AuctionEvents_Incr
20:17:19.336956 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Attributes_Incr
20:17:19.422850 [info ] [Thread-2  ]: 2 of 101 START snapshot stg.AH_Attributes_Incr.................................. [RUN]
20:17:19.423479 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Attributes_Incr"
20:17:19.423616 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Attributes_Incr
20:17:19.423721 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Attributes_Incr
20:17:19.337488 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Addresses_Incr
20:17:19.429725 [debug] [Thread-1  ]: finished collecting timing info
20:17:19.429944 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Addresses_Incr
20:17:19.341386 [debug] [Thread-3  ]: finished collecting timing info
20:17:19.435840 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_AuctionEventMedias_Incr
20:17:19.426826 [debug] [Thread-2  ]: finished collecting timing info
20:17:19.463877 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Attributes_Incr
20:17:19.497065 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:19.515696 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:17:19.515801 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:17:19.515916 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:17:19.502667 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:19.517498 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:17:19.517676 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:17:19.517794 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:17:19.515375 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:19.524674 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:17:19.524771 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:17:19.524879 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:17:19.524384 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:19.526309 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:17:19.526478 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:17:19.526661 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:17:19.644385 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:17:19.654304 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:17:19.654870 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:17:19.655117 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:17:19.690630 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:17:19.699803 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:17:19.701461 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:17:19.702859 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:17:19.833846 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:19.847753 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:17:19.834779 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:19.848069 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:17:19.838240 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:19.848272 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:17:19.847495 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:19.848457 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:17:19.878988 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:17:19.887775 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:19.902001 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:19.902270 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:17:19.905777 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:19.905956 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_AuctionEvents_InterView]
        ) as __dbt_sbq
    
20:17:19.902356 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:17:19.907537 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:19.907913 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Attributes_InterView]
        ) as __dbt_sbq
    
20:17:19.903938 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:19.908119 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_AuctionEventMedias_InterView]
        ) as __dbt_sbq
    
20:17:19.904177 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Addresses_InterView]
        ) as __dbt_sbq
    
20:17:20.015173 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:17:20.022825 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:17:20.031771 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:17:20.049987 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:17:20.082821 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:20.093449 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Attributes_Incr"
        ) as __dbt_sbq
    
20:17:20.088458 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:20.103764 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr"
        ) as __dbt_sbq
    
20:17:20.093229 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:20.104096 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Addresses_Incr"
        ) as __dbt_sbq
    
20:17:20.107528 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:20.107713 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr"
        ) as __dbt_sbq
    
20:17:20.154404 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:17:20.163821 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:17:20.177260 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:20.177581 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:17:20.179343 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:20.182962 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr'
      and table_schema = 'stg'
  
20:17:20.179555 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr'
      and table_schema = 'stg'
  
20:17:20.182773 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:20.183279 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr'
      and table_schema = 'stg'
  
20:17:20.265363 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:17:20.267589 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:17:20.275758 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:17:20.279128 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:20.305948 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr'
      and table_schema = 'stg'
  
20:17:20.310076 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:20.310305 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
        
  
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Attributes_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Attributes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Attributes_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Attributes_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Attributes_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Attributes_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774''), CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ConText != source_data.ConText
        or
        (
            ((snapshotted_data.ConText is null) and not (source_data.ConText is null))
            or
            ((not snapshotted_data.ConText is null) and (source_data.ConText is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.EditMode != source_data.EditMode
        or
        (
            ((snapshotted_data.EditMode is null) and not (source_data.EditMode is null))
            or
            ((not snapshotted_data.EditMode is null) and (source_data.EditMode is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ConText != source_data.ConText
        or
        (
            ((snapshotted_data.ConText is null) and not (source_data.ConText is null))
            or
            ((not snapshotted_data.ConText is null) and (source_data.ConText is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.EditMode != source_data.EditMode
        or
        (
            ((snapshotted_data.EditMode is null) and not (source_data.EditMode is null))
            or
            ((not snapshotted_data.EditMode is null) and (source_data.EditMode is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Attributes_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Attributes_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Attributes_Incr__dbt_tmp_temp_view"
    end



    
20:17:20.287740 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:17:20.314179 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:20.314384 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
        
  
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_AuctionEvents_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_AuctionEvents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_AuctionEvents_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_AuctionEvents_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774''), CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SoftclosingGroupIncrementseconds != source_data.SoftclosingGroupIncrementseconds
        or
        (
            ((snapshotted_data.SoftclosingGroupIncrementseconds is null) and not (source_data.SoftclosingGroupIncrementseconds is null))
            or
            ((not snapshotted_data.SoftclosingGroupIncrementseconds is null) and (source_data.SoftclosingGroupIncrementseconds is null))
        ) or snapshotted_data.LotCount != source_data.LotCount
        or
        (
            ((snapshotted_data.LotCount is null) and not (source_data.LotCount is null))
            or
            ((not snapshotted_data.LotCount is null) and (source_data.LotCount is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.CurrencyID != source_data.CurrencyID
        or
        (
            ((snapshotted_data.CurrencyID is null) and not (source_data.CurrencyID is null))
            or
            ((not snapshotted_data.CurrencyID is null) and (source_data.CurrencyID is null))
        ) or snapshotted_data.ClosingGroupIncrementseconds != source_data.ClosingGroupIncrementseconds
        or
        (
            ((snapshotted_data.ClosingGroupIncrementseconds is null) and not (source_data.ClosingGroupIncrementseconds is null))
            or
            ((not snapshotted_data.ClosingGroupIncrementseconds is null) and (source_data.ClosingGroupIncrementseconds is null))
        ) or snapshotted_data.CurrentclosingGroup != source_data.CurrentclosingGroup
        or
        (
            ((snapshotted_data.CurrentclosingGroup is null) and not (source_data.CurrentclosingGroup is null))
            or
            ((not snapshotted_data.CurrentclosingGroup is null) and (source_data.CurrentclosingGroup is null))
        ) or snapshotted_data.CurrentSoftclosingGroup != source_data.CurrentSoftclosingGroup
        or
        (
            ((snapshotted_data.CurrentSoftclosingGroup is null) and not (source_data.CurrentSoftclosingGroup is null))
            or
            ((not snapshotted_data.CurrentSoftclosingGroup is null) and (source_data.CurrentSoftclosingGroup is null))
        ) or snapshotted_data.CurrentLotOrder != source_data.CurrentLotOrder
        or
        (
            ((snapshotted_data.CurrentLotOrder is null) and not (source_data.CurrentLotOrder is null))
            or
            ((not snapshotted_data.CurrentLotOrder is null) and (source_data.CurrentLotOrder is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.ProxyBidding != source_data.ProxyBidding
        or
        (
            ((snapshotted_data.ProxyBidding is null) and not (source_data.ProxyBidding is null))
            or
            ((not snapshotted_data.ProxyBidding is null) and (source_data.ProxyBidding is null))
        ) or snapshotted_data.Published != source_data.Published
        or
        (
            ((snapshotted_data.Published is null) and not (source_data.Published is null))
            or
            ((not snapshotted_data.Published is null) and (source_data.Published is null))
        ) or snapshotted_data.PreviewLots != source_data.PreviewLots
        or
        (
            ((snapshotted_data.PreviewLots is null) and not (source_data.PreviewLots is null))
            or
            ((not snapshotted_data.PreviewLots is null) and (source_data.PreviewLots is null))
        ) or snapshotted_data.LotsTaxable != source_data.LotsTaxable
        or
        (
            ((snapshotted_data.LotsTaxable is null) and not (source_data.LotsTaxable is null))
            or
            ((not snapshotted_data.LotsTaxable is null) and (source_data.LotsTaxable is null))
        ) or snapshotted_data.FollowLiveEnabled != source_data.FollowLiveEnabled
        or
        (
            ((snapshotted_data.FollowLiveEnabled is null) and not (source_data.FollowLiveEnabled is null))
            or
            ((not snapshotted_data.FollowLiveEnabled is null) and (source_data.FollowLiveEnabled is null))
        ) or snapshotted_data.BuyersPremiumPercent != source_data.BuyersPremiumPercent
        or
        (
            ((snapshotted_data.BuyersPremiumPercent is null) and not (source_data.BuyersPremiumPercent is null))
            or
            ((not snapshotted_data.BuyersPremiumPercent is null) and (source_data.BuyersPremiumPercent is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Startdttm != source_data.Startdttm
        or
        (
            ((snapshotted_data.Startdttm is null) and not (source_data.Startdttm is null))
            or
            ((not snapshotted_data.Startdttm is null) and (source_data.Startdttm is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.EstimatedLastEnddttm != source_data.EstimatedLastEnddttm
        or
        (
            ((snapshotted_data.EstimatedLastEnddttm is null) and not (source_data.EstimatedLastEnddttm is null))
            or
            ((not snapshotted_data.EstimatedLastEnddttm is null) and (source_data.EstimatedLastEnddttm is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.Timezone != source_data.Timezone
        or
        (
            ((snapshotted_data.Timezone is null) and not (source_data.Timezone is null))
            or
            ((not snapshotted_data.Timezone is null) and (source_data.Timezone is null))
        ) or snapshotted_data.TermsandConditions != source_data.TermsandConditions
        or
        (
            ((snapshotted_data.TermsandConditions is null) and not (source_data.TermsandConditions is null))
            or
            ((not snapshotted_data.TermsandConditions is null) and (source_data.TermsandConditions is null))
        ) or snapshotted_data.PrimaryImageURI != source_data.PrimaryImageURI
        or
        (
            ((snapshotted_data.PrimaryImageURI is null) and not (source_data.PrimaryImageURI is null))
            or
            ((not snapshotted_data.PrimaryImageURI is null) and (source_data.PrimaryImageURI is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.SecondaryImageURI != source_data.SecondaryImageURI
        or
        (
            ((snapshotted_data.SecondaryImageURI is null) and not (source_data.SecondaryImageURI is null))
            or
            ((not snapshotted_data.SecondaryImageURI is null) and (source_data.SecondaryImageURI is null))
        ) or snapshotted_data.OwnerUserName != source_data.OwnerUserName
        or
        (
            ((snapshotted_data.OwnerUserName is null) and not (source_data.OwnerUserName is null))
            or
            ((not snapshotted_data.OwnerUserName is null) and (source_data.OwnerUserName is null))
        ) or snapshotted_data.ShippingInfo != source_data.ShippingInfo
        or
        (
            ((snapshotted_data.ShippingInfo is null) and not (source_data.ShippingInfo is null))
            or
            ((not snapshotted_data.ShippingInfo is null) and (source_data.ShippingInfo is null))
        ) or snapshotted_data.SubTitle != source_data.SubTitle
        or
        (
            ((snapshotted_data.SubTitle is null) and not (source_data.SubTitle is null))
            or
            ((not snapshotted_data.SubTitle is null) and (source_data.SubTitle is null))
        ) or snapshotted_data.ManagedByName != source_data.ManagedByName
        or
        (
            ((snapshotted_data.ManagedByName is null) and not (source_data.ManagedByName is null))
            or
            ((not snapshotted_data.ManagedByName is null) and (source_data.ManagedByName is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SoftclosingGroupIncrementseconds != source_data.SoftclosingGroupIncrementseconds
        or
        (
            ((snapshotted_data.SoftclosingGroupIncrementseconds is null) and not (source_data.SoftclosingGroupIncrementseconds is null))
            or
            ((not snapshotted_data.SoftclosingGroupIncrementseconds is null) and (source_data.SoftclosingGroupIncrementseconds is null))
        ) or snapshotted_data.LotCount != source_data.LotCount
        or
        (
            ((snapshotted_data.LotCount is null) and not (source_data.LotCount is null))
            or
            ((not snapshotted_data.LotCount is null) and (source_data.LotCount is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.CurrencyID != source_data.CurrencyID
        or
        (
            ((snapshotted_data.CurrencyID is null) and not (source_data.CurrencyID is null))
            or
            ((not snapshotted_data.CurrencyID is null) and (source_data.CurrencyID is null))
        ) or snapshotted_data.ClosingGroupIncrementseconds != source_data.ClosingGroupIncrementseconds
        or
        (
            ((snapshotted_data.ClosingGroupIncrementseconds is null) and not (source_data.ClosingGroupIncrementseconds is null))
            or
            ((not snapshotted_data.ClosingGroupIncrementseconds is null) and (source_data.ClosingGroupIncrementseconds is null))
        ) or snapshotted_data.CurrentclosingGroup != source_data.CurrentclosingGroup
        or
        (
            ((snapshotted_data.CurrentclosingGroup is null) and not (source_data.CurrentclosingGroup is null))
            or
            ((not snapshotted_data.CurrentclosingGroup is null) and (source_data.CurrentclosingGroup is null))
        ) or snapshotted_data.CurrentSoftclosingGroup != source_data.CurrentSoftclosingGroup
        or
        (
            ((snapshotted_data.CurrentSoftclosingGroup is null) and not (source_data.CurrentSoftclosingGroup is null))
            or
            ((not snapshotted_data.CurrentSoftclosingGroup is null) and (source_data.CurrentSoftclosingGroup is null))
        ) or snapshotted_data.CurrentLotOrder != source_data.CurrentLotOrder
        or
        (
            ((snapshotted_data.CurrentLotOrder is null) and not (source_data.CurrentLotOrder is null))
            or
            ((not snapshotted_data.CurrentLotOrder is null) and (source_data.CurrentLotOrder is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.ProxyBidding != source_data.ProxyBidding
        or
        (
            ((snapshotted_data.ProxyBidding is null) and not (source_data.ProxyBidding is null))
            or
            ((not snapshotted_data.ProxyBidding is null) and (source_data.ProxyBidding is null))
        ) or snapshotted_data.Published != source_data.Published
        or
        (
            ((snapshotted_data.Published is null) and not (source_data.Published is null))
            or
            ((not snapshotted_data.Published is null) and (source_data.Published is null))
        ) or snapshotted_data.PreviewLots != source_data.PreviewLots
        or
        (
            ((snapshotted_data.PreviewLots is null) and not (source_data.PreviewLots is null))
            or
            ((not snapshotted_data.PreviewLots is null) and (source_data.PreviewLots is null))
        ) or snapshotted_data.LotsTaxable != source_data.LotsTaxable
        or
        (
            ((snapshotted_data.LotsTaxable is null) and not (source_data.LotsTaxable is null))
            or
            ((not snapshotted_data.LotsTaxable is null) and (source_data.LotsTaxable is null))
        ) or snapshotted_data.FollowLiveEnabled != source_data.FollowLiveEnabled
        or
        (
            ((snapshotted_data.FollowLiveEnabled is null) and not (source_data.FollowLiveEnabled is null))
            or
            ((not snapshotted_data.FollowLiveEnabled is null) and (source_data.FollowLiveEnabled is null))
        ) or snapshotted_data.BuyersPremiumPercent != source_data.BuyersPremiumPercent
        or
        (
            ((snapshotted_data.BuyersPremiumPercent is null) and not (source_data.BuyersPremiumPercent is null))
            or
            ((not snapshotted_data.BuyersPremiumPercent is null) and (source_data.BuyersPremiumPercent is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Startdttm != source_data.Startdttm
        or
        (
            ((snapshotted_data.Startdttm is null) and not (source_data.Startdttm is null))
            or
            ((not snapshotted_data.Startdttm is null) and (source_data.Startdttm is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.EstimatedLastEnddttm != source_data.EstimatedLastEnddttm
        or
        (
            ((snapshotted_data.EstimatedLastEnddttm is null) and not (source_data.EstimatedLastEnddttm is null))
            or
            ((not snapshotted_data.EstimatedLastEnddttm is null) and (source_data.EstimatedLastEnddttm is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.Timezone != source_data.Timezone
        or
        (
            ((snapshotted_data.Timezone is null) and not (source_data.Timezone is null))
            or
            ((not snapshotted_data.Timezone is null) and (source_data.Timezone is null))
        ) or snapshotted_data.TermsandConditions != source_data.TermsandConditions
        or
        (
            ((snapshotted_data.TermsandConditions is null) and not (source_data.TermsandConditions is null))
            or
            ((not snapshotted_data.TermsandConditions is null) and (source_data.TermsandConditions is null))
        ) or snapshotted_data.PrimaryImageURI != source_data.PrimaryImageURI
        or
        (
            ((snapshotted_data.PrimaryImageURI is null) and not (source_data.PrimaryImageURI is null))
            or
            ((not snapshotted_data.PrimaryImageURI is null) and (source_data.PrimaryImageURI is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.SecondaryImageURI != source_data.SecondaryImageURI
        or
        (
            ((snapshotted_data.SecondaryImageURI is null) and not (source_data.SecondaryImageURI is null))
            or
            ((not snapshotted_data.SecondaryImageURI is null) and (source_data.SecondaryImageURI is null))
        ) or snapshotted_data.OwnerUserName != source_data.OwnerUserName
        or
        (
            ((snapshotted_data.OwnerUserName is null) and not (source_data.OwnerUserName is null))
            or
            ((not snapshotted_data.OwnerUserName is null) and (source_data.OwnerUserName is null))
        ) or snapshotted_data.ShippingInfo != source_data.ShippingInfo
        or
        (
            ((snapshotted_data.ShippingInfo is null) and not (source_data.ShippingInfo is null))
            or
            ((not snapshotted_data.ShippingInfo is null) and (source_data.ShippingInfo is null))
        ) or snapshotted_data.SubTitle != source_data.SubTitle
        or
        (
            ((snapshotted_data.SubTitle is null) and not (source_data.SubTitle is null))
            or
            ((not snapshotted_data.SubTitle is null) and (source_data.SubTitle is null))
        ) or snapshotted_data.ManagedByName != source_data.ManagedByName
        or
        (
            ((snapshotted_data.ManagedByName is null) and not (source_data.ManagedByName is null))
            or
            ((not snapshotted_data.ManagedByName is null) and (source_data.ManagedByName is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_AuctionEvents_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_AuctionEvents_Incr__dbt_tmp_temp_view"
    end



    
20:17:20.316415 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:20.316980 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
        
  
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_AuctionEventMedias_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_AuctionEventMedias_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774''), CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_AuctionEventMedias_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_temp_view"
    end



    
20:17:20.378877 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:17:20.382831 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:20.383097 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
        
  
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Addresses_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Addresses_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Addresses_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Addresses_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Addresses_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Addresses_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774''), CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:17:19.862774'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.CountryID != source_data.CountryID
        or
        (
            ((snapshotted_data.CountryID is null) and not (source_data.CountryID is null))
            or
            ((not snapshotted_data.CountryID is null) and (source_data.CountryID is null))
        ) or snapshotted_data.Street1 != source_data.Street1
        or
        (
            ((snapshotted_data.Street1 is null) and not (source_data.Street1 is null))
            or
            ((not snapshotted_data.Street1 is null) and (source_data.Street1 is null))
        ) or snapshotted_data.Street2 != source_data.Street2
        or
        (
            ((snapshotted_data.Street2 is null) and not (source_data.Street2 is null))
            or
            ((not snapshotted_data.Street2 is null) and (source_data.Street2 is null))
        ) or snapshotted_data.City != source_data.City
        or
        (
            ((snapshotted_data.City is null) and not (source_data.City is null))
            or
            ((not snapshotted_data.City is null) and (source_data.City is null))
        ) or snapshotted_data.Stateregion != source_data.Stateregion
        or
        (
            ((snapshotted_data.Stateregion is null) and not (source_data.Stateregion is null))
            or
            ((not snapshotted_data.Stateregion is null) and (source_data.Stateregion is null))
        ) or snapshotted_data.ZipPostal != source_data.ZipPostal
        or
        (
            ((snapshotted_data.ZipPostal is null) and not (source_data.ZipPostal is null))
            or
            ((not snapshotted_data.ZipPostal is null) and (source_data.ZipPostal is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.CountryID != source_data.CountryID
        or
        (
            ((snapshotted_data.CountryID is null) and not (source_data.CountryID is null))
            or
            ((not snapshotted_data.CountryID is null) and (source_data.CountryID is null))
        ) or snapshotted_data.Street1 != source_data.Street1
        or
        (
            ((snapshotted_data.Street1 is null) and not (source_data.Street1 is null))
            or
            ((not snapshotted_data.Street1 is null) and (source_data.Street1 is null))
        ) or snapshotted_data.Street2 != source_data.Street2
        or
        (
            ((snapshotted_data.Street2 is null) and not (source_data.Street2 is null))
            or
            ((not snapshotted_data.Street2 is null) and (source_data.Street2 is null))
        ) or snapshotted_data.City != source_data.City
        or
        (
            ((snapshotted_data.City is null) and not (source_data.City is null))
            or
            ((not snapshotted_data.City is null) and (source_data.City is null))
        ) or snapshotted_data.Stateregion != source_data.Stateregion
        or
        (
            ((snapshotted_data.Stateregion is null) and not (source_data.Stateregion is null))
            or
            ((not snapshotted_data.Stateregion is null) and (source_data.Stateregion is null))
        ) or snapshotted_data.ZipPostal != source_data.ZipPostal
        or
        (
            ((snapshotted_data.ZipPostal is null) and not (source_data.ZipPostal is null))
            or
            ((not snapshotted_data.ZipPostal is null) and (source_data.ZipPostal is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Addresses_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Addresses_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Addresses_Incr__dbt_tmp_temp_view"
    end



    
20:17:27.518243 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 7.20 seconds
20:17:27.526003 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:27.526266 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:27.583914 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:17:27.585713 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:27.585939 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    
20:17:28.464789 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 8.15 seconds
20:17:28.468301 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:28.468538 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:28.525213 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:17:28.526719 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:28.526924 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Attributes_Incr__dbt_tmp"
    
20:17:28.681641 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
20:17:28.683227 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:28.683411 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:28.768402 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:17:28.771131 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:28.771386 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:29.084730 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
20:17:29.087827 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:29.088078 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr'
      and table_schema = 'stg'
  
20:17:29.161294 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:17:29.165797 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:29.166078 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:29.228580 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:17:29.230166 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:29.230355 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    
20:17:29.674206 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
20:17:29.676675 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:29.676905 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:29.773553 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:17:29.776284 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:29.776536 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:30.140850 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
20:17:30.144273 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:30.144559 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr'
      and table_schema = 'stg'
  
20:17:30.213129 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:17:30.217491 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:30.217769 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:30.258131 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:30.259681 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:30.259871 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Attributes_Incr__dbt_tmp"
    
20:17:30.412015 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.18 seconds
20:17:30.413623 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:30.413819 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:30.455518 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:30.457987 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:30.458209 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:30.674912 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:17:30.678286 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:30.678616 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr'
      and table_schema = 'stg'
  
20:17:30.724774 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:17:30.733758 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:30.734047 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:30.778991 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:30.780582 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:30.780770 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    
20:17:31.656178 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.40 seconds
20:17:31.657672 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:31.657863 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:31.696174 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:31.699077 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:31.699308 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:31.948681 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:17:31.951461 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:31.951693 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr'
      and table_schema = 'stg'
  
20:17:31.966202 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.19 seconds
20:17:31.968189 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:31.968401 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:32.020281 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:17:32.026352 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:32.026644 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:32.034957 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:17:32.037255 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:32.037441 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:32.132216 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:17:32.133674 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:32.133845 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Attributes_Incr__dbt_tmp"
    
20:17:32.357561 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
20:17:32.363624 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_AuctionEventMedias_Incr"
20:17:32.364302 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:32.364478 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_AuctionEventMedias_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr" (
                  "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "DisplayOrder", "MediaID", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "DisplayOrder", "MediaID", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:17:33.183820 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
20:17:33.185398 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:33.185585 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:33.221965 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:33.224378 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:33.224581 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:33.572255 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
20:17:33.574341 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Attributes_Incr"
20:17:33.574779 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:33.574904 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Attributes_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Attributes_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Attributes_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Attributes_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Attributes_Incr" (
                  "ID", "ConText", "Name", "Value", "EditMode", "Type", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "ConText", "Name", "Value", "EditMode", "Type", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Attributes_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:17:34.043962 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.68 seconds
20:17:34.052183 [debug] [Thread-3  ]: On snapshot.Shawn.AH_AuctionEventMedias_Incr: COMMIT
20:17:34.055510 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
20:17:34.055762 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    end

20:17:34.125821 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:17:34.140016 [debug] [Thread-3  ]: finished collecting timing info
20:17:34.140345 [debug] [Thread-3  ]: On snapshot.Shawn.AH_AuctionEventMedias_Incr: Close
20:17:34.141087 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016426bf10>]}
20:17:34.141564 [info ] [Thread-3  ]: 3 of 101 OK snapshotted stg.AH_AuctionEventMedias_Incr.......................... [[32mOK[0m in 14.80s]
20:17:34.141906 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_AuctionEventMedias_Incr
20:17:34.142078 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_BannedUsers_Incr
20:17:34.142445 [info ] [Thread-3  ]: 5 of 101 START snapshot stg.AH_BannedUsers_Incr................................. [RUN]
20:17:34.142877 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_BannedUsers_Incr"
20:17:34.142992 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_BannedUsers_Incr
20:17:34.143092 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_BannedUsers_Incr
20:17:34.146002 [debug] [Thread-3  ]: finished collecting timing info
20:17:34.146161 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_BannedUsers_Incr
20:17:34.148912 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:34.149056 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:17:34.149143 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:17:34.149245 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:17:34.277952 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:17:34.334130 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:17:34.357370 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:34.357650 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:17:34.387875 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:17:34.390359 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:34.390593 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_BannedUsers_InterView]
        ) as __dbt_sbq
    
20:17:34.483162 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:17:34.506083 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:34.506379 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr"
        ) as __dbt_sbq
    
20:17:34.589266 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:17:34.592812 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:34.593042 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr'
      and table_schema = 'stg'
  
20:17:34.689399 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:17:34.693260 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:34.693514 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
        
  
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BannedUsers_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_BannedUsers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BannedUsers_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_BannedUsers_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_BannedUsers_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:17:34.362998'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:17:34.362998'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:17:34.362998''), CONVERT(DATETIME2, ''2022-09-26 20:17:34.362998'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:17:34.362998'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:17:34.362998'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:17:34.362998'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:17:34.362998'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Lastip != source_data.Lastip
        or
        (
            ((snapshotted_data.Lastip is null) and not (source_data.Lastip is null))
            or
            ((not snapshotted_data.Lastip is null) and (source_data.Lastip is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.FName != source_data.FName
        or
        (
            ((snapshotted_data.FName is null) and not (source_data.FName is null))
            or
            ((not snapshotted_data.FName is null) and (source_data.FName is null))
        ) or snapshotted_data.LName != source_data.LName
        or
        (
            ((snapshotted_data.LName is null) and not (source_data.LName is null))
            or
            ((not snapshotted_data.LName is null) and (source_data.LName is null))
        ) or snapshotted_data.IsLockedOut != source_data.IsLockedOut
        or
        (
            ((snapshotted_data.IsLockedOut is null) and not (source_data.IsLockedOut is null))
            or
            ((not snapshotted_data.IsLockedOut is null) and (source_data.IsLockedOut is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Lastip != source_data.Lastip
        or
        (
            ((snapshotted_data.Lastip is null) and not (source_data.Lastip is null))
            or
            ((not snapshotted_data.Lastip is null) and (source_data.Lastip is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.FName != source_data.FName
        or
        (
            ((snapshotted_data.FName is null) and not (source_data.FName is null))
            or
            ((not snapshotted_data.FName is null) and (source_data.FName is null))
        ) or snapshotted_data.LName != source_data.LName
        or
        (
            ((snapshotted_data.LName is null) and not (source_data.LName is null))
            or
            ((not snapshotted_data.LName is null) and (source_data.LName is null))
        ) or snapshotted_data.IsLockedOut != source_data.IsLockedOut
        or
        (
            ((snapshotted_data.IsLockedOut is null) and not (source_data.IsLockedOut is null))
            or
            ((not snapshotted_data.IsLockedOut is null) and (source_data.IsLockedOut is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_BannedUsers_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_BannedUsers_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BannedUsers_Incr__dbt_tmp_temp_view"
    end



    
20:17:35.259120 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.68 seconds
20:17:35.260773 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Attributes_Incr: COMMIT
20:17:35.261465 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
20:17:35.261595 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."#AH_Attributes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Attributes_Incr__dbt_tmp"
    end

20:17:35.303858 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:35.318359 [debug] [Thread-2  ]: finished collecting timing info
20:17:35.318737 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Attributes_Incr: Close
20:17:35.319484 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654c82e0>]}
20:17:35.319958 [info ] [Thread-2  ]: 2 of 101 OK snapshotted stg.AH_Attributes_Incr.................................. [[32mOK[0m in 15.90s]
20:17:35.320276 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Attributes_Incr
20:17:35.320426 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_BannerCategories_Incr
20:17:35.320805 [info ] [Thread-2  ]: 6 of 101 START snapshot stg.AH_BannerCategories_Incr............................ [RUN]
20:17:35.321193 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_BannerCategories_Incr"
20:17:35.321305 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_BannerCategories_Incr
20:17:35.321401 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_BannerCategories_Incr
20:17:35.324295 [debug] [Thread-2  ]: finished collecting timing info
20:17:35.324464 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_BannerCategories_Incr
20:17:35.327510 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:35.327680 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:17:35.327766 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:17:35.327869 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:17:35.449257 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:17:35.478653 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:17:35.505321 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:35.505609 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:17:35.564781 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:17:35.567040 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:35.567600 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_BannerCategories_InterView]
        ) as __dbt_sbq
    
20:17:35.669728 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:17:35.692702 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:35.692994 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr"
        ) as __dbt_sbq
    
20:17:35.762921 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:17:35.766435 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:35.766710 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr'
      and table_schema = 'stg'
  
20:17:35.844040 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:17:35.847634 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:35.847870 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
        
  
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BannerCategories_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_BannerCategories_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BannerCategories_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_BannerCategories_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_BannerCategories_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:17:35.534960'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:17:35.534960'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:17:35.534960''), CONVERT(DATETIME2, ''2022-09-26 20:17:35.534960'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:17:35.534960'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:17:35.534960'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:17:35.534960'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:17:35.534960'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.BannerID != source_data.BannerID
        or
        (
            ((snapshotted_data.BannerID is null) and not (source_data.BannerID is null))
            or
            ((not snapshotted_data.BannerID is null) and (source_data.BannerID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.BannerID != source_data.BannerID
        or
        (
            ((snapshotted_data.BannerID is null) and not (source_data.BannerID is null))
            or
            ((not snapshotted_data.BannerID is null) and (source_data.BannerID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_BannerCategories_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_BannerCategories_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BannerCategories_Incr__dbt_tmp_temp_view"
    end



    
20:17:40.779950 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 20.40 seconds
20:17:40.783364 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:40.783562 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:40.822312 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:40.823724 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:40.823913 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Addresses_Incr__dbt_tmp"
    
20:17:41.270152 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.58 seconds
20:17:41.273399 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:41.273582 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:41.312387 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:41.313922 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:41.314092 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannedUsers_Incr__dbt_tmp"
    
20:17:41.569806 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 5.72 seconds
20:17:41.573135 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:41.573378 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:41.616008 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:41.617440 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:41.617622 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannerCategories_Incr__dbt_tmp"
    
20:17:41.931348 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.11 seconds
20:17:41.933031 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:41.933231 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:42.013794 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:17:42.016392 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:42.016580 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:42.187198 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.87 seconds
20:17:42.189049 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:42.189250 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:42.251333 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:17:42.254489 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:42.254732 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr'
      and table_schema = 'stg'
  
20:17:42.270970 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:17:42.273588 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:42.273790 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:42.326147 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:17:42.331408 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:42.331599 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:42.372182 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:42.373587 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:42.373781 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Addresses_Incr__dbt_tmp"
    
20:17:42.488818 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.87 seconds
20:17:42.490388 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:42.490618 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:42.497308 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:17:42.500217 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:42.500404 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr'
      and table_schema = 'stg'
  
20:17:42.566697 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:17:42.569099 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:42.569300 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:42.596279 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:17:42.600423 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:42.600663 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:42.658702 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:17:42.660157 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:42.660321 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannedUsers_Incr__dbt_tmp"
    
20:17:42.803158 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:17:42.806021 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:42.806226 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr'
      and table_schema = 'stg'
  
20:17:42.888386 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:17:42.892309 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:42.892534 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:42.930314 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:42.931915 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:42.932094 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannerCategories_Incr__dbt_tmp"
    
20:17:43.499299 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.13 seconds
20:17:43.500947 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:43.501137 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:43.576913 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:17:43.579551 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:43.579733 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:43.778897 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:17:43.782159 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:43.782398 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr'
      and table_schema = 'stg'
  
20:17:43.852137 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:17:43.856820 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:43.857028 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:43.893617 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:43.895109 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:43.895272 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Addresses_Incr__dbt_tmp"
    
20:17:44.122467 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.19 seconds
20:17:44.123988 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:44.124157 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:44.128528 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.47 seconds
20:17:44.129879 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:44.130034 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:44.157611 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:17:44.160131 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:44.160313 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:44.165841 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:44.168036 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:44.168200 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:44.571964 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
20:17:44.574998 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:44.575239 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr'
      and table_schema = 'stg'
  
20:17:44.613068 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:44.617174 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:44.617368 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:44.627730 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.46 seconds
20:17:44.630364 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:44.630575 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr'
      and table_schema = 'stg'
  
20:17:44.654030 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:44.655582 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:44.655778 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannerCategories_Incr__dbt_tmp"
    
20:17:44.664176 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:17:44.668265 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:44.668468 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:44.712315 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:44.713893 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:44.714062 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannedUsers_Incr__dbt_tmp"
    
20:17:45.730562 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.84 seconds
20:17:45.732195 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:45.732379 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:45.773325 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:45.775990 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:45.776165 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:45.966523 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 25.65 seconds
20:17:45.971708 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:45.971949 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:45.973696 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:17:45.975447 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Addresses_Incr"
20:17:45.975788 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:45.975895 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Addresses_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Addresses_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Addresses_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Addresses_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Addresses_Incr" (
                  "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "UserID", "CountryID", "Street1", "Street2", "City", "Stateregion", "ZipPostal", "LastUpdatedUser", "Description", "FirstName", "LastName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "UserID", "CountryID", "Street1", "Street2", "City", "Stateregion", "ZipPostal", "LastUpdatedUser", "Description", "FirstName", "LastName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Addresses_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:17:45.992598 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.28 seconds
20:17:45.994073 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:45.994239 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:46.010517 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:46.011956 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:46.012127 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    
20:17:46.026897 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:17:46.029505 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:46.029679 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:46.041865 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.39 seconds
20:17:46.043215 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:46.043373 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:46.076450 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:17:46.079000 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:46.079184 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:46.222785 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:17:46.224894 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_BannedUsers_Incr"
20:17:46.225295 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:46.225423 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_BannedUsers_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr" (
                  "ID", "Lastip", "UserName", "FName", "LName", "IsLockedOut", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Lastip", "UserName", "FName", "LName", "IsLockedOut", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_BannedUsers_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:17:46.294418 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:17:46.296602 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_BannerCategories_Incr"
20:17:46.297098 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:46.297232 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_BannerCategories_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "BannerID", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "BannerID", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_BannerCategories_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:17:47.348120 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.34 seconds
20:17:47.349638 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:47.349805 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:47.420674 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:17:47.423872 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:47.424079 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:47.639180 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:17:47.642468 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:47.642743 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr'
      and table_schema = 'stg'
  
20:17:47.719782 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:17:47.724400 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:47.724650 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:47.767253 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:47.768970 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:47.769175 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    
20:17:48.172302 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.87 seconds
20:17:48.174034 [debug] [Thread-2  ]: On snapshot.Shawn.AH_BannerCategories_Incr: COMMIT
20:17:48.174199 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.20 seconds
20:17:48.175964 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Addresses_Incr: COMMIT
20:17:48.176624 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
20:17:48.176742 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.95 seconds
20:17:48.177778 [debug] [Thread-3  ]: On snapshot.Shawn.AH_BannedUsers_Incr: COMMIT
20:17:48.178620 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
20:17:48.178746 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."#AH_BannedUsers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BannedUsers_Incr__dbt_tmp"
    end

20:17:48.176843 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."#AH_Addresses_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Addresses_Incr__dbt_tmp"
    end

20:17:48.174906 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
20:17:48.179011 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."#AH_BannerCategories_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BannerCategories_Incr__dbt_tmp"
    end

20:17:48.216447 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:48.217581 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:48.227689 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:17:48.232728 [debug] [Thread-1  ]: finished collecting timing info
20:17:48.243528 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Addresses_Incr: Close
20:17:48.244332 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01643b3100>]}
20:17:48.244793 [info ] [Thread-1  ]: 1 of 101 OK snapshotted stg.AH_Addresses_Incr................................... [[32mOK[0m in 28.91s]
20:17:48.245115 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Addresses_Incr
20:17:48.245268 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Banners_Incr
20:17:48.251097 [info ] [Thread-1  ]: 7 of 101 START snapshot stg.AH_Banners_Incr..................................... [RUN]
20:17:48.251538 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Banners_Incr"
20:17:48.251660 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Banners_Incr
20:17:48.251760 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Banners_Incr
20:17:48.250738 [debug] [Thread-2  ]: finished collecting timing info
20:17:48.260437 [debug] [Thread-2  ]: On snapshot.Shawn.AH_BannerCategories_Incr: Close
20:17:48.261006 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016434d3d0>]}
20:17:48.261379 [info ] [Thread-2  ]: 6 of 101 OK snapshotted stg.AH_BannerCategories_Incr............................ [[32mOK[0m in 12.94s]
20:17:48.261666 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_BannerCategories_Incr
20:17:48.254602 [debug] [Thread-1  ]: finished collecting timing info
20:17:48.262060 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Banners_Incr
20:17:48.264750 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:17:48.264888 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:17:48.264972 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:17:48.265071 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:17:48.261806 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_BiddingTransactions_Incr
20:17:48.266437 [info ] [Thread-2  ]: 8 of 101 START snapshot stg.AH_BiddingTransactions_Incr......................... [RUN]
20:17:48.266871 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr"
20:17:48.266981 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_BiddingTransactions_Incr
20:17:48.267072 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_BiddingTransactions_Incr
20:17:48.269669 [debug] [Thread-2  ]: finished collecting timing info
20:17:48.269810 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_BiddingTransactions_Incr
20:17:48.260237 [debug] [Thread-3  ]: finished collecting timing info
20:17:48.272810 [debug] [Thread-3  ]: On snapshot.Shawn.AH_BannedUsers_Incr: Close
20:17:48.273555 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016426e970>]}
20:17:48.273896 [info ] [Thread-3  ]: 5 of 101 OK snapshotted stg.AH_BannedUsers_Incr................................. [[32mOK[0m in 14.13s]
20:17:48.274173 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_BannedUsers_Incr
20:17:48.274313 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Categories_Incr
20:17:48.274675 [info ] [Thread-3  ]: 9 of 101 START snapshot stg.AH_Categories_Incr.................................. [RUN]
20:17:48.275021 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Categories_Incr"
20:17:48.275126 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Categories_Incr
20:17:48.275213 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Categories_Incr
20:17:48.272621 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:17:48.278085 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:17:48.278170 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:17:48.278268 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:17:48.277926 [debug] [Thread-3  ]: finished collecting timing info
20:17:48.279403 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Categories_Incr
20:17:48.282051 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:17:48.282185 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:17:48.282264 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:17:48.282373 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:17:48.402558 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:17:48.404417 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:17:48.408296 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:17:48.434933 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:17:48.436819 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:17:48.465870 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:17:48.487810 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:17:48.499398 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:17:48.505777 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:17:48.505991 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:17:48.499123 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:17:48.506211 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:17:48.530220 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:17:48.532173 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:17:48.532355 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_BiddingTransactions_InterView]
        ) as __dbt_sbq
    
20:17:48.533788 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:17:48.535310 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:17:48.535454 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Categories_InterView]
        ) as __dbt_sbq
    
20:17:48.537607 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:17:48.539086 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:17:48.539217 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Banners_InterView]
        ) as __dbt_sbq
    
20:17:48.591919 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:17:48.601100 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:17:48.611756 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:17:48.651593 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:17:48.656502 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Banners_Incr"
        ) as __dbt_sbq
    
20:17:48.661082 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:17:48.661245 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Categories_Incr"
        ) as __dbt_sbq
    
20:17:48.655778 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:17:48.661455 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr"
        ) as __dbt_sbq
    
20:17:48.726788 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:17:48.730303 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:17:48.730526 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr'
      and table_schema = 'stg'
  
20:17:48.733211 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:17:48.736740 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:17:48.736951 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:17:48.739936 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:17:48.740083 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr'
      and table_schema = 'stg'
  
20:17:48.737069 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr'
      and table_schema = 'stg'
  
20:17:48.801201 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:17:48.807198 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:17:48.807473 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
        
  
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Banners_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Banners_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Banners_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Banners_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Banners_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Banners_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:17:48.520633'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:17:48.520633'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:17:48.520633''), CONVERT(DATETIME2, ''2022-09-26 20:17:48.520633'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:17:48.520633'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:17:48.520633'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:17:48.520633'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:17:48.520633'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.LinkURI != source_data.LinkURI
        or
        (
            ((snapshotted_data.LinkURI is null) and not (source_data.LinkURI is null))
            or
            ((not snapshotted_data.LinkURI is null) and (source_data.LinkURI is null))
        ) or snapshotted_data.BannerLocation != source_data.BannerLocation
        or
        (
            ((snapshotted_data.BannerLocation is null) and not (source_data.BannerLocation is null))
            or
            ((not snapshotted_data.BannerLocation is null) and (source_data.BannerLocation is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.LinkURI != source_data.LinkURI
        or
        (
            ((snapshotted_data.LinkURI is null) and not (source_data.LinkURI is null))
            or
            ((not snapshotted_data.LinkURI is null) and (source_data.LinkURI is null))
        ) or snapshotted_data.BannerLocation != source_data.BannerLocation
        or
        (
            ((snapshotted_data.BannerLocation is null) and not (source_data.BannerLocation is null))
            or
            ((not snapshotted_data.BannerLocation is null) and (source_data.BannerLocation is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Banners_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Banners_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Banners_Incr__dbt_tmp_temp_view"
    end



    
20:17:48.808732 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:17:48.811669 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:17:48.811869 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
        
  
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BiddingTransactions_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_BiddingTransactions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_BiddingTransactions_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_BiddingTransactions_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:17:48.504963'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:17:48.504963'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:17:48.504963''), CONVERT(DATETIME2, ''2022-09-26 20:17:48.504963'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:17:48.504963'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:17:48.504963'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:17:48.504963'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:17:48.504963'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Maxmindscore != source_data.Maxmindscore
        or
        (
            ((snapshotted_data.Maxmindscore is null) and not (source_data.Maxmindscore is null))
            or
            ((not snapshotted_data.Maxmindscore is null) and (source_data.Maxmindscore is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ListingActionID != source_data.ListingActionID
        or
        (
            ((snapshotted_data.ListingActionID is null) and not (source_data.ListingActionID is null))
            or
            ((not snapshotted_data.ListingActionID is null) and (source_data.ListingActionID is null))
        ) or snapshotted_data.CreditCardID != source_data.CreditCardID
        or
        (
            ((snapshotted_data.CreditCardID is null) and not (source_data.CreditCardID is null))
            or
            ((not snapshotted_data.CreditCardID is null) and (source_data.CreditCardID is null))
        ) or snapshotted_data.Active != source_data.Active
        or
        (
            ((snapshotted_data.Active is null) and not (source_data.Active is null))
            or
            ((not snapshotted_data.Active is null) and (source_data.Active is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Maxmindscore != source_data.Maxmindscore
        or
        (
            ((snapshotted_data.Maxmindscore is null) and not (source_data.Maxmindscore is null))
            or
            ((not snapshotted_data.Maxmindscore is null) and (source_data.Maxmindscore is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ListingActionID != source_data.ListingActionID
        or
        (
            ((snapshotted_data.ListingActionID is null) and not (source_data.ListingActionID is null))
            or
            ((not snapshotted_data.ListingActionID is null) and (source_data.ListingActionID is null))
        ) or snapshotted_data.CreditCardID != source_data.CreditCardID
        or
        (
            ((snapshotted_data.CreditCardID is null) and not (source_data.CreditCardID is null))
            or
            ((not snapshotted_data.CreditCardID is null) and (source_data.CreditCardID is null))
        ) or snapshotted_data.Active != source_data.Active
        or
        (
            ((snapshotted_data.Active is null) and not (source_data.Active is null))
            or
            ((not snapshotted_data.Active is null) and (source_data.Active is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_BiddingTransactions_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BiddingTransactions_Incr__dbt_tmp_temp_view"
    end



    
20:17:48.812386 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:17:48.815568 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:17:48.815762 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
        
  
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Categories_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Categories_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Categories_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Categories_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Categories_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Categories_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:17:48.520633'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:17:48.520633'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:17:48.520633''), CONVERT(DATETIME2, ''2022-09-26 20:17:48.520633'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:17:48.520633'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:17:48.520633'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:17:48.520633'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:17:48.520633'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ParentCategoryID != source_data.ParentCategoryID
        or
        (
            ((snapshotted_data.ParentCategoryID is null) and not (source_data.ParentCategoryID is null))
            or
            ((not snapshotted_data.ParentCategoryID is null) and (source_data.ParentCategoryID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.Lft != source_data.Lft
        or
        (
            ((snapshotted_data.Lft is null) and not (source_data.Lft is null))
            or
            ((not snapshotted_data.Lft is null) and (source_data.Lft is null))
        ) or snapshotted_data.Rgt != source_data.Rgt
        or
        (
            ((snapshotted_data.Rgt is null) and not (source_data.Rgt is null))
            or
            ((not snapshotted_data.Rgt is null) and (source_data.Rgt is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.RolesAllowed != source_data.RolesAllowed
        or
        (
            ((snapshotted_data.RolesAllowed is null) and not (source_data.RolesAllowed is null))
            or
            ((not snapshotted_data.RolesAllowed is null) and (source_data.RolesAllowed is null))
        ) or snapshotted_data.EnabledCustomProperty != source_data.EnabledCustomProperty
        or
        (
            ((snapshotted_data.EnabledCustomProperty is null) and not (source_data.EnabledCustomProperty is null))
            or
            ((not snapshotted_data.EnabledCustomProperty is null) and (source_data.EnabledCustomProperty is null))
        ) or snapshotted_data.MetaKeyWords != source_data.MetaKeyWords
        or
        (
            ((snapshotted_data.MetaKeyWords is null) and not (source_data.MetaKeyWords is null))
            or
            ((not snapshotted_data.MetaKeyWords is null) and (source_data.MetaKeyWords is null))
        ) or snapshotted_data.MetaDescription != source_data.MetaDescription
        or
        (
            ((snapshotted_data.MetaDescription is null) and not (source_data.MetaDescription is null))
            or
            ((not snapshotted_data.MetaDescription is null) and (source_data.MetaDescription is null))
        ) or snapshotted_data.PageTitle != source_data.PageTitle
        or
        (
            ((snapshotted_data.PageTitle is null) and not (source_data.PageTitle is null))
            or
            ((not snapshotted_data.PageTitle is null) and (source_data.PageTitle is null))
        ) or snapshotted_data.Pagecontent != source_data.Pagecontent
        or
        (
            ((snapshotted_data.Pagecontent is null) and not (source_data.Pagecontent is null))
            or
            ((not snapshotted_data.Pagecontent is null) and (source_data.Pagecontent is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.MvcAction != source_data.MvcAction
        or
        (
            ((snapshotted_data.MvcAction is null) and not (source_data.MvcAction is null))
            or
            ((not snapshotted_data.MvcAction is null) and (source_data.MvcAction is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ParentCategoryID != source_data.ParentCategoryID
        or
        (
            ((snapshotted_data.ParentCategoryID is null) and not (source_data.ParentCategoryID is null))
            or
            ((not snapshotted_data.ParentCategoryID is null) and (source_data.ParentCategoryID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.Lft != source_data.Lft
        or
        (
            ((snapshotted_data.Lft is null) and not (source_data.Lft is null))
            or
            ((not snapshotted_data.Lft is null) and (source_data.Lft is null))
        ) or snapshotted_data.Rgt != source_data.Rgt
        or
        (
            ((snapshotted_data.Rgt is null) and not (source_data.Rgt is null))
            or
            ((not snapshotted_data.Rgt is null) and (source_data.Rgt is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.RolesAllowed != source_data.RolesAllowed
        or
        (
            ((snapshotted_data.RolesAllowed is null) and not (source_data.RolesAllowed is null))
            or
            ((not snapshotted_data.RolesAllowed is null) and (source_data.RolesAllowed is null))
        ) or snapshotted_data.EnabledCustomProperty != source_data.EnabledCustomProperty
        or
        (
            ((snapshotted_data.EnabledCustomProperty is null) and not (source_data.EnabledCustomProperty is null))
            or
            ((not snapshotted_data.EnabledCustomProperty is null) and (source_data.EnabledCustomProperty is null))
        ) or snapshotted_data.MetaKeyWords != source_data.MetaKeyWords
        or
        (
            ((snapshotted_data.MetaKeyWords is null) and not (source_data.MetaKeyWords is null))
            or
            ((not snapshotted_data.MetaKeyWords is null) and (source_data.MetaKeyWords is null))
        ) or snapshotted_data.MetaDescription != source_data.MetaDescription
        or
        (
            ((snapshotted_data.MetaDescription is null) and not (source_data.MetaDescription is null))
            or
            ((not snapshotted_data.MetaDescription is null) and (source_data.MetaDescription is null))
        ) or snapshotted_data.PageTitle != source_data.PageTitle
        or
        (
            ((snapshotted_data.PageTitle is null) and not (source_data.PageTitle is null))
            or
            ((not snapshotted_data.PageTitle is null) and (source_data.PageTitle is null))
        ) or snapshotted_data.Pagecontent != source_data.Pagecontent
        or
        (
            ((snapshotted_data.Pagecontent is null) and not (source_data.Pagecontent is null))
            or
            ((not snapshotted_data.Pagecontent is null) and (source_data.Pagecontent is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.MvcAction != source_data.MvcAction
        or
        (
            ((snapshotted_data.MvcAction is null) and not (source_data.MvcAction is null))
            or
            ((not snapshotted_data.MvcAction is null) and (source_data.MvcAction is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Categories_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Categories_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Categories_Incr__dbt_tmp_temp_view"
    end



    
20:17:48.851507 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.08 seconds
20:17:48.853036 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:48.853243 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:48.889436 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:48.973764 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:48.974031 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:49.217105 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:17:49.220168 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:49.220403 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr'
      and table_schema = 'stg'
  
20:17:49.273536 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:17:49.278673 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:49.278873 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:49.319511 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:49.320978 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:49.321144 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    
20:17:50.380570 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
20:17:50.382123 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:50.382278 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:50.422620 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:50.425719 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:50.425928 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:50.799633 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.37 seconds
20:17:50.802977 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_AuctionEvents_Incr"
20:17:50.803576 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:50.803747 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_AuctionEvents_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr" (
                  "ID", "SoftclosingGroupIncrementseconds", "LotCount", "CategoryID", "CurrencyID", "ClosingGroupIncrementseconds", "CurrentclosingGroup", "CurrentSoftclosingGroup", "CurrentLotOrder", "OwnerID", "ProxyBidding", "Published", "PreviewLots", "LotsTaxable", "FollowLiveEnabled", "BuyersPremiumPercent", "DeletedOn", "Startdttm", "Enddttm", "EstimatedLastEnddttm", "CreatedOn", "UpdatedOn", "Description", "LastUpdatedUser", "Status", "Timezone", "TermsandConditions", "PrimaryImageURI", "Title", "SecondaryImageURI", "OwnerUserName", "ShippingInfo", "SubTitle", "ManagedByName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SoftclosingGroupIncrementseconds", "LotCount", "CategoryID", "CurrencyID", "ClosingGroupIncrementseconds", "CurrentclosingGroup", "CurrentSoftclosingGroup", "CurrentLotOrder", "OwnerID", "ProxyBidding", "Published", "PreviewLots", "LotsTaxable", "FollowLiveEnabled", "BuyersPremiumPercent", "DeletedOn", "Startdttm", "Enddttm", "EstimatedLastEnddttm", "CreatedOn", "UpdatedOn", "Description", "LastUpdatedUser", "Status", "Timezone", "TermsandConditions", "PrimaryImageURI", "Title", "SecondaryImageURI", "OwnerUserName", "ShippingInfo", "SubTitle", "ManagedByName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_AuctionEvents_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:17:52.621565 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.82 seconds
20:17:52.623297 [debug] [Thread-4  ]: On snapshot.Shawn.AH_AuctionEvents_Incr: COMMIT
20:17:52.624047 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
20:17:52.624190 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."#AH_AuctionEvents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    end

20:17:52.691371 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:17:52.704421 [debug] [Thread-4  ]: finished collecting timing info
20:17:52.704760 [debug] [Thread-4  ]: On snapshot.Shawn.AH_AuctionEvents_Incr: Close
20:17:52.705541 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0164241e50>]}
20:17:52.706009 [info ] [Thread-4  ]: 4 of 101 OK snapshotted stg.AH_AuctionEvents_Incr............................... [[32mOK[0m in 33.36s]
20:17:52.706348 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_AuctionEvents_Incr
20:17:52.706499 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_CategoryCount_Incr
20:17:52.706912 [info ] [Thread-4  ]: 10 of 101 START snapshot stg.AH_CategoryCount_Incr.............................. [RUN]
20:17:52.707303 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CategoryCount_Incr"
20:17:52.707413 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_CategoryCount_Incr
20:17:52.707509 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_CategoryCount_Incr
20:17:52.710354 [debug] [Thread-4  ]: finished collecting timing info
20:17:52.710528 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_CategoryCount_Incr
20:17:52.713528 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:17:52.713675 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:17:52.713761 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:17:52.713865 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:17:52.857297 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:17:52.926625 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:17:52.950129 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:17:52.950440 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:17:52.980496 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:17:52.982782 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:17:52.982996 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CategoryCount_InterView]
        ) as __dbt_sbq
    
20:17:53.068436 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:17:53.090695 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:17:53.090970 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr"
        ) as __dbt_sbq
    
20:17:53.188200 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:17:53.191523 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:17:53.191714 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr'
      and table_schema = 'stg'
  
20:17:53.270569 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:17:53.274060 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:17:53.274248 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
        
  
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryCount_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CategoryCount_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryCount_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CategoryCount_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CategoryCount_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:17:52.958128'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:17:52.958128'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:17:52.958128''), CONVERT(DATETIME2, ''2022-09-26 20:17:52.958128'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:17:52.958128'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:17:52.958128'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:17:52.958128'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:17:52.958128'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Count != source_data.Count
        or
        (
            ((snapshotted_data.Count is null) and not (source_data.Count is null))
            or
            ((not snapshotted_data.Count is null) and (source_data.Count is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Count != source_data.Count
        or
        (
            ((snapshotted_data.Count is null) and not (source_data.Count is null))
            or
            ((not snapshotted_data.Count is null) and (source_data.Count is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CategoryCount_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CategoryCount_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryCount_Incr__dbt_tmp_temp_view"
    end



    
20:17:56.147096 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.34 seconds
20:17:56.150714 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:17:56.150903 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:56.178797 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 7.37 seconds
20:17:56.182056 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:17:56.182290 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:56.221128 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:56.222695 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:17:56.222882 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Banners_Incr__dbt_tmp"
    
20:17:56.238941 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:17:56.240317 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:17:56.240472 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    
20:17:56.945624 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.67 seconds
20:17:56.949205 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:17:56.949451 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:56.987960 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:56.989526 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:17:56.989719 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCount_Incr__dbt_tmp"
    
20:17:57.246763 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.02 seconds
20:17:57.248469 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:17:57.248680 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:57.287651 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
20:17:57.289367 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:17:57.289621 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:57.327629 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:17:57.330624 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:17:57.330891 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:57.365220 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:17:57.367885 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:17:57.368112 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:57.570376 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:17:57.573316 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:17:57.573558 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr'
      and table_schema = 'stg'
  
20:17:57.732638 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:17:57.738847 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:17:57.739130 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:57.750536 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.38 seconds
20:17:57.753389 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:17:57.753634 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr'
      and table_schema = 'stg'
  
20:17:57.782438 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:57.783966 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:17:57.784154 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Banners_Incr__dbt_tmp"
    
20:17:57.787620 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:17:57.791590 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:17:57.791805 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:57.827858 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:57.829429 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:17:57.829614 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    
20:17:57.994750 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.00 seconds
20:17:57.996360 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:17:57.996701 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:58.067859 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:17:58.070489 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:17:58.070717 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:58.321263 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:17:58.324004 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:17:58.324205 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr'
      and table_schema = 'stg'
  
20:17:58.358836 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:17:58.362763 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:17:58.363005 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:58.413065 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:17:58.414910 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:17:58.415128 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCount_Incr__dbt_tmp"
    
20:17:59.124529 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.34 seconds
20:17:59.126091 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:17:59.126272 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:59.126513 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.30 seconds
20:17:59.127564 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:17:59.127696 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:59.160832 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:17:59.163484 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:17:59.163702 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:59.167400 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:59.169638 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:17:59.169784 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:59.352039 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:17:59.355148 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:17:59.355401 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr'
      and table_schema = 'stg'
  
20:17:59.390143 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:17:59.391817 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:17:59.394287 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:17:59.394451 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr'
      and table_schema = 'stg'
  
20:17:59.397012 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:17:59.397161 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:59.426923 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:17:59.431282 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:17:59.431506 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:17:59.432575 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:17:59.432717 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    
20:17:59.431644 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:59.467467 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:17:59.468996 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:17:59.469174 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Banners_Incr__dbt_tmp"
    
20:17:59.572947 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
20:17:59.574492 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:17:59.574705 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:17:59.650285 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:17:59.652804 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:17:59.653019 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:59.870868 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:17:59.873988 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:17:59.874223 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr'
      and table_schema = 'stg'
  
20:17:59.910216 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:17:59.914663 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:17:59.914910 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:17:59.977157 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:17:59.978663 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:17:59.978838 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCount_Incr__dbt_tmp"
    
20:18:00.470940 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.00 seconds
20:18:00.472496 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:18:00.472687 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:00.488147 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
20:18:00.489752 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:18:00.489938 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:00.511917 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:00.514623 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:18:00.514840 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:00.526904 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:00.529520 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:18:00.529750 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:00.699807 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:18:00.701958 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Banners_Incr"
20:18:00.702466 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:18:00.702679 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Banners_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Banners_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Banners_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Banners_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Banners_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaID", "LinkURI", "BannerLocation", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaID", "LinkURI", "BannerLocation", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Banners_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:18:00.780433 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:18:00.782466 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_BiddingTransactions_Incr"
20:18:00.782982 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:18:00.783118 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_BiddingTransactions_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr" (
                  "ID", "TransactionID", "Maxmindscore", "Amount", "ListingActionID", "CreditCardID", "Active", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "TransactionID", "Maxmindscore", "Amount", "ListingActionID", "CreditCardID", "Active", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:18:00.932600 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
20:18:00.934154 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:18:00.934342 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:00.990199 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:18:00.992823 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:18:00.993081 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:01.218927 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:18:01.221410 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CategoryCount_Incr"
20:18:01.221907 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:18:01.222112 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CategoryCount_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr" (
                  "ID", "Count", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Count", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CategoryCount_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:18:02.705369 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.00 seconds
20:18:02.707160 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Banners_Incr: COMMIT
20:18:02.710770 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
20:18:02.710972 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."#AH_Banners_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Banners_Incr__dbt_tmp"
    end

20:18:02.764233 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:02.777001 [debug] [Thread-1  ]: finished collecting timing info
20:18:02.777350 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Banners_Incr: Close
20:18:02.778148 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0165455ca0>]}
20:18:02.778696 [info ] [Thread-1  ]: 7 of 101 OK snapshotted stg.AH_Banners_Incr..................................... [[32mOK[0m in 14.53s]
20:18:02.779046 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Banners_Incr
20:18:02.779199 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_CategoryCustomFields_Incr
20:18:02.779577 [info ] [Thread-1  ]: 11 of 101 START snapshot stg.AH_CategoryCustomFields_Incr....................... [RUN]
20:18:02.779978 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr"
20:18:02.780094 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_CategoryCustomFields_Incr
20:18:02.780192 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_CategoryCustomFields_Incr
20:18:02.783329 [debug] [Thread-1  ]: finished collecting timing info
20:18:02.783506 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_CategoryCustomFields_Incr
20:18:02.786595 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:02.786750 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:18:02.786833 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:18:02.786937 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:18:02.816332 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.03 seconds
20:18:02.818094 [debug] [Thread-2  ]: On snapshot.Shawn.AH_BiddingTransactions_Incr: COMMIT
20:18:02.818969 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
20:18:02.819112 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."#AH_BiddingTransactions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    end

20:18:02.852113 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.63 seconds
20:18:02.853315 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:18:02.860294 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CategoryCount_Incr: COMMIT
20:18:02.861110 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
20:18:02.861248 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."#AH_CategoryCount_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryCount_Incr__dbt_tmp"
    end

20:18:02.867938 [debug] [Thread-2  ]: finished collecting timing info
20:18:02.868211 [debug] [Thread-2  ]: On snapshot.Shawn.AH_BiddingTransactions_Incr: Close
20:18:02.869296 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016419cfa0>]}
20:18:02.869770 [info ] [Thread-2  ]: 8 of 101 OK snapshotted stg.AH_BiddingTransactions_Incr......................... [[32mOK[0m in 14.60s]
20:18:02.870090 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_BiddingTransactions_Incr
20:18:02.870241 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_CategoryListingTypes_Incr
20:18:02.870646 [info ] [Thread-2  ]: 12 of 101 START snapshot stg.AH_CategoryListingTypes_Incr....................... [RUN]
20:18:02.871047 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr"
20:18:02.871157 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_CategoryListingTypes_Incr
20:18:02.871257 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_CategoryListingTypes_Incr
20:18:02.874097 [debug] [Thread-2  ]: finished collecting timing info
20:18:02.874248 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_CategoryListingTypes_Incr
20:18:02.877544 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:02.877701 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:18:02.877787 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:18:02.877892 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:18:02.900020 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:02.916744 [debug] [Thread-4  ]: finished collecting timing info
20:18:02.917088 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CategoryCount_Incr: Close
20:18:02.917817 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016545c0d0>]}
20:18:02.918487 [info ] [Thread-4  ]: 10 of 101 OK snapshotted stg.AH_CategoryCount_Incr.............................. [[32mOK[0m in 10.21s]
20:18:02.918882 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_CategoryCount_Incr
20:18:02.919028 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_CategoryListings_Incr
20:18:02.919396 [info ] [Thread-4  ]: 13 of 101 START snapshot stg.AH_CategoryListings_Incr........................... [RUN]
20:18:02.919780 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CategoryListings_Incr"
20:18:02.919893 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_CategoryListings_Incr
20:18:02.919991 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_CategoryListings_Incr
20:18:02.922863 [debug] [Thread-4  ]: finished collecting timing info
20:18:02.923026 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_CategoryListings_Incr
20:18:02.925933 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:02.926082 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:18:02.926167 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:18:02.926270 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:18:02.934422 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:18:02.961929 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:18:02.988239 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:02.988528 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:18:02.991480 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:18:03.015283 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:18:03.017389 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:03.017729 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CategoryCustomFields_InterView]
        ) as __dbt_sbq
    
20:18:03.018239 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:18:03.027752 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:18:03.041886 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:03.042195 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:18:03.062629 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:18:03.074945 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:18:03.076941 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:03.077148 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CategoryListingTypes_InterView]
        ) as __dbt_sbq
    
20:18:03.088483 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:03.088780 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:03.088923 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:18:03.111705 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:03.111998 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr"
        ) as __dbt_sbq
    
20:18:03.154041 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:18:03.156783 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:03.157002 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:18:03.157128 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CategoryListings_InterView]
        ) as __dbt_sbq
    
20:18:03.179555 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:03.179847 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr"
        ) as __dbt_sbq
    
20:18:03.205981 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:18:03.209634 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:03.209869 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr'
      and table_schema = 'stg'
  
20:18:03.268020 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:18:03.279839 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:18:03.283571 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:03.283824 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr'
      and table_schema = 'stg'
  
20:18:03.295355 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:03.295627 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr"
        ) as __dbt_sbq
    
20:18:03.299567 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:18:03.302763 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:03.302973 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
        
  
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CategoryCustomFields_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CategoryCustomFields_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:02.989571'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:02.989571'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:18:02.989571''), CONVERT(DATETIME2, ''2022-09-26 20:18:02.989571'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:18:02.989571'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:02.989571'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:02.989571'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:18:02.989571'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CategoryCustomFields_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_temp_view"
    end



    
20:18:03.355248 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:18:03.359173 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:03.359434 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr'
      and table_schema = 'stg'
  
20:18:03.363490 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:18:03.366625 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:03.366831 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
        
  
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CategoryListingTypes_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CategoryListingTypes_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:03.052085'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:03.052085'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:18:03.052085''), CONVERT(DATETIME2, ''2022-09-26 20:18:03.052085'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:18:03.052085'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:03.052085'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:03.052085'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:18:03.052085'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CategoryListingTypes_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_temp_view"
    end



    
20:18:03.444464 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:18:03.448084 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:03.448361 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
        
  
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryListings_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CategoryListings_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryListings_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CategoryListings_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CategoryListings_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:03.130184'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:03.130184'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:18:03.130184''), CONVERT(DATETIME2, ''2022-09-26 20:18:03.130184'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:18:03.130184'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:03.130184'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:03.130184'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:18:03.130184'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CategoryListings_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CategoryListings_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryListings_Incr__dbt_tmp_temp_view"
    end



    
20:18:06.745257 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 17.93 seconds
20:18:06.748868 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:18:06.749093 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:06.794996 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:06.796631 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:18:06.796797 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Categories_Incr__dbt_tmp"
    
20:18:08.253504 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.46 seconds
20:18:08.255204 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:18:08.255437 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:08.346036 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:18:08.348905 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:18:08.349135 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:08.598574 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:18:08.601450 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:18:08.601685 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr'
      and table_schema = 'stg'
  
20:18:08.723024 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:18:08.727244 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:18:08.727497 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:08.809076 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:18:08.810688 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:18:08.810878 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Categories_Incr__dbt_tmp"
    
20:18:10.074837 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.26 seconds
20:18:10.076368 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:18:10.076537 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:10.118855 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:10.121533 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:18:10.121755 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:10.334442 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:18:10.339328 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:18:10.339575 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr'
      and table_schema = 'stg'
  
20:18:10.389909 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:10.394436 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:18:10.394681 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:10.459849 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:10.461468 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:18:10.461660 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Categories_Incr__dbt_tmp"
    
20:18:10.971478 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.60 seconds
20:18:10.975097 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:10.975303 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:11.024082 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:11.025560 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:11.025731 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    
20:18:13.297766 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.84 seconds
20:18:13.299427 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:18:13.299622 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:13.347780 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:13.350695 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:18:13.350934 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:13.629202 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
20:18:13.631680 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Categories_Incr"
20:18:13.632120 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:18:13.632247 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Categories_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Categories_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Categories_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Categories_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Categories_Incr" (
                  "ID", "ParentCategoryID", "DisplayOrder", "Lft", "Rgt", "CreatedOn", "UpdatedOn", "DeletedOn", "RolesAllowed", "EnabledCustomProperty", "MetaKeyWords", "MetaDescription", "PageTitle", "Pagecontent", "Name", "LastUpdatedUser", "Type", "MvcAction", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "ParentCategoryID", "DisplayOrder", "Lft", "Rgt", "CreatedOn", "UpdatedOn", "DeletedOn", "RolesAllowed", "EnabledCustomProperty", "MetaKeyWords", "MetaDescription", "PageTitle", "Pagecontent", "Name", "LastUpdatedUser", "Type", "MvcAction", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Categories_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:18:15.418518 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 4.39 seconds
20:18:15.420152 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:15.420362 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:15.543154 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:18:15.546146 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:15.546370 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:15.796705 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:18:15.799443 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:15.799622 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr'
      and table_schema = 'stg'
  
20:18:15.878330 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:18:15.882749 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:15.882985 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:15.926430 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:15.927978 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:15.928170 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    
20:18:15.930526 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.30 seconds
20:18:15.931884 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Categories_Incr: COMMIT
20:18:15.932868 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
20:18:15.933009 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."#AH_Categories_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Categories_Incr__dbt_tmp"
    end

20:18:15.972190 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:15.985836 [debug] [Thread-3  ]: finished collecting timing info
20:18:15.986160 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Categories_Incr: Close
20:18:15.986950 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016545c220>]}
20:18:15.987434 [info ] [Thread-3  ]: 9 of 101 OK snapshotted stg.AH_Categories_Incr.................................. [[32mOK[0m in 27.71s]
20:18:15.987784 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Categories_Incr
20:18:15.987938 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Contactus_Incr
20:18:15.988326 [info ] [Thread-3  ]: 14 of 101 START snapshot stg.AH_Contactus_Incr.................................. [RUN]
20:18:15.988720 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Contactus_Incr"
20:18:15.988829 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Contactus_Incr
20:18:15.988929 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Contactus_Incr
20:18:15.991766 [debug] [Thread-3  ]: finished collecting timing info
20:18:15.991923 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Contactus_Incr
20:18:15.994848 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:15.994988 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:18:15.995072 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:18:15.995172 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:18:16.129690 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:18:16.167890 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:18:16.191054 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:16.191342 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:18:16.226247 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:18:16.228482 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:16.229030 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Contactus_InterView]
        ) as __dbt_sbq
    
20:18:16.286035 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:18:16.309494 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:16.309767 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Contactus_Incr"
        ) as __dbt_sbq
    
20:18:16.472875 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:18:16.476577 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:16.476838 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr'
      and table_schema = 'stg'
  
20:18:16.550629 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:16.554566 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:16.554814 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
        
  
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Contactus_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Contactus_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Contactus_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Contactus_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Contactus_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Contactus_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:16.192890'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:16.192890'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:18:16.192890''), CONVERT(DATETIME2, ''2022-09-26 20:18:16.192890'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:18:16.192890'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:16.192890'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:16.192890'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:18:16.192890'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Contactus_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Contactus_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Contactus_Incr__dbt_tmp_temp_view"
    end



    
20:18:16.740882 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.81 seconds
20:18:16.742576 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:16.742778 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:16.782920 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:16.785540 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:16.785762 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:16.794163 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 13.35 seconds
20:18:16.797501 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:16.797702 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:16.836977 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:16.838588 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:16.838809 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListings_Incr__dbt_tmp"
    
20:18:17.001859 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:18:17.005034 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:17.005242 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr'
      and table_schema = 'stg'
  
20:18:17.065105 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:18:17.069466 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:17.069678 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:17.107308 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:17.108699 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:17.108880 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    
20:18:17.181911 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 13.88 seconds
20:18:17.185392 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:17.185601 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:17.222854 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:17.224398 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:17.224585 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    
20:18:17.723280 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
20:18:17.724953 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:17.725153 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:17.799318 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:17.801867 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:17.802078 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:18.056329 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:18:18.060497 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:18.060734 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr'
      and table_schema = 'stg'
  
20:18:18.129659 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:18.133806 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:18.134045 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:18.185724 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:18.187265 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:18.187459 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListings_Incr__dbt_tmp"
    
20:18:18.192377 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
20:18:18.193657 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:18.193807 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:18.235872 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.13 seconds
20:18:18.237324 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:18.237524 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:18.265653 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:18.268056 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:18.268260 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:18.270590 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:18:18.272898 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:18.273040 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:18.525966 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:18:18.529152 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:18.529405 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr'
      and table_schema = 'stg'
  
20:18:18.531311 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:18:18.532988 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CategoryListingTypes_Incr"
20:18:18.533397 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:18.533514 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CategoryListingTypes_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr" (
                  "ID", "CategoryID", "ListingTypeID", "CreatedOn", "UpdatedOn", "DeletedOn", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CategoryID", "ListingTypeID", "CreatedOn", "UpdatedOn", "DeletedOn", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:18:18.599051 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:18.603556 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:18.603776 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:18.647043 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:18.648870 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:18.649077 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    
20:18:19.052510 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.86 seconds
20:18:19.054188 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:19.054384 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:19.119109 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:18:19.121672 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:19.121867 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:19.359333 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:18:19.362295 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:19.362524 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr'
      and table_schema = 'stg'
  
20:18:19.395894 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:18:19.400129 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:19.400357 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:19.456891 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:18:19.458469 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:19.458709 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListings_Incr__dbt_tmp"
    
20:18:19.670485 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.02 seconds
20:18:19.671980 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:19.672147 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:19.714383 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:19.716788 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:19.716970 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:19.973676 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:18:19.976774 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:19.976977 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr'
      and table_schema = 'stg'
  
20:18:20.015864 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.48 seconds
20:18:20.017451 [debug] [Thread-2  ]: On snapshot.Shawn.AH_CategoryListingTypes_Incr: COMMIT
20:18:20.018155 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
20:18:20.018282 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    end

20:18:20.018551 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:20.022061 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:20.022196 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:20.069131 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:20.079765 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:18:20.081032 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:20.081215 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    
20:18:20.085603 [debug] [Thread-2  ]: finished collecting timing info
20:18:20.085835 [debug] [Thread-2  ]: On snapshot.Shawn.AH_CategoryListingTypes_Incr: Close
20:18:20.086519 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016545c610>]}
20:18:20.087006 [info ] [Thread-2  ]: 12 of 101 OK snapshotted stg.AH_CategoryListingTypes_Incr....................... [[32mOK[0m in 17.22s]
20:18:20.087324 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_CategoryListingTypes_Incr
20:18:20.087472 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Contents_Incr
20:18:20.087844 [info ] [Thread-2  ]: 15 of 101 START snapshot stg.AH_Contents_Incr................................... [RUN]
20:18:20.088222 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Contents_Incr"
20:18:20.088331 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Contents_Incr
20:18:20.088430 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Contents_Incr
20:18:20.091256 [debug] [Thread-2  ]: finished collecting timing info
20:18:20.091463 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Contents_Incr
20:18:20.094225 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:20.094361 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:18:20.094457 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:18:20.094580 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:18:20.196557 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:18:20.232099 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:18:20.255153 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:20.255424 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:18:20.290187 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:18:20.292722 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:20.292931 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Contents_InterView]
        ) as __dbt_sbq
    
20:18:20.329571 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.87 seconds
20:18:20.331120 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:20.331294 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:20.351708 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:18:20.374167 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:20.374454 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:20.376620 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:20.376786 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:20.374623 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Contents_Incr"
        ) as __dbt_sbq
    
20:18:20.446860 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:20.450620 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:20.450822 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr'
      and table_schema = 'stg'
  
20:18:20.552770 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:18:20.556514 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:20.556733 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
        
  
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Contents_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Contents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Contents_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Contents_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Contents_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Contents_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:20.271058'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:20.271058'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:18:20.271058''), CONVERT(DATETIME2, ''2022-09-26 20:18:20.271058'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:18:20.271058'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:20.271058'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:20.271058'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:18:20.271058'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.Usehtmleditor != source_data.Usehtmleditor
        or
        (
            ((snapshotted_data.Usehtmleditor is null) and not (source_data.Usehtmleditor is null))
            or
            ((not snapshotted_data.Usehtmleditor is null) and (source_data.Usehtmleditor is null))
        ) or snapshotted_data.Userdefined != source_data.Userdefined
        or
        (
            ((snapshotted_data.Userdefined is null) and not (source_data.Userdefined is null))
            or
            ((not snapshotted_data.Userdefined is null) and (source_data.Userdefined is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Text != source_data.Text
        or
        (
            ((snapshotted_data.Text is null) and not (source_data.Text is null))
            or
            ((not snapshotted_data.Text is null) and (source_data.Text is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.PageTitle != source_data.PageTitle
        or
        (
            ((snapshotted_data.PageTitle is null) and not (source_data.PageTitle is null))
            or
            ((not snapshotted_data.PageTitle is null) and (source_data.PageTitle is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.Usehtmleditor != source_data.Usehtmleditor
        or
        (
            ((snapshotted_data.Usehtmleditor is null) and not (source_data.Usehtmleditor is null))
            or
            ((not snapshotted_data.Usehtmleditor is null) and (source_data.Usehtmleditor is null))
        ) or snapshotted_data.Userdefined != source_data.Userdefined
        or
        (
            ((snapshotted_data.Userdefined is null) and not (source_data.Userdefined is null))
            or
            ((not snapshotted_data.Userdefined is null) and (source_data.Userdefined is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Text != source_data.Text
        or
        (
            ((snapshotted_data.Text is null) and not (source_data.Text is null))
            or
            ((not snapshotted_data.Text is null) and (source_data.Text is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.PageTitle != source_data.PageTitle
        or
        (
            ((snapshotted_data.PageTitle is null) and not (source_data.PageTitle is null))
            or
            ((not snapshotted_data.PageTitle is null) and (source_data.PageTitle is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Contents_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Contents_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Contents_Incr__dbt_tmp_temp_view"
    end



    
20:18:20.613768 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:18:20.615953 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CategoryListings_Incr"
20:18:20.616390 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:20.616523 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CategoryListings_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr" (
                  "ID", "DeletedOn", "CreatedOn", "UpdatedOn", "ListingID", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DeletedOn", "CreatedOn", "UpdatedOn", "ListingID", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CategoryListings_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:18:20.943884 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.86 seconds
20:18:20.945545 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:20.945731 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:20.979595 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:18:20.982214 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:20.982418 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:21.404853 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 4.85 seconds
20:18:21.409127 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:21.409375 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:21.447309 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:21.448883 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:21.449070 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contactus_Incr__dbt_tmp"
    
20:18:21.456798 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.47 seconds
20:18:21.458778 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CategoryCustomFields_Incr"
20:18:21.459170 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:21.459283 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CategoryCustomFields_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "CategoryID", "CustomFieldID", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "CategoryID", "CustomFieldID", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:18:22.137826 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.52 seconds
20:18:22.139623 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CategoryListings_Incr: COMMIT
20:18:22.140766 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
20:18:22.140930 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."#AH_CategoryListings_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryListings_Incr__dbt_tmp"
    end

20:18:22.188332 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:22.201711 [debug] [Thread-4  ]: finished collecting timing info
20:18:22.202050 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CategoryListings_Incr: Close
20:18:22.202871 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01641c6130>]}
20:18:22.203365 [info ] [Thread-4  ]: 13 of 101 OK snapshotted stg.AH_CategoryListings_Incr........................... [[32mOK[0m in 19.28s]
20:18:22.203700 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_CategoryListings_Incr
20:18:22.203856 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Countries_Incr
20:18:22.204236 [info ] [Thread-4  ]: 16 of 101 START snapshot stg.AH_Countries_Incr.................................. [RUN]
20:18:22.204656 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Countries_Incr"
20:18:22.204770 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Countries_Incr
20:18:22.204872 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Countries_Incr
20:18:22.207918 [debug] [Thread-4  ]: finished collecting timing info
20:18:22.208081 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Countries_Incr
20:18:22.211300 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:22.211522 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:18:22.211613 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:18:22.211719 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:18:22.332847 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:18:22.379413 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:18:22.395332 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
20:18:22.396887 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:22.397097 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:22.405364 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:22.405536 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:18:22.444050 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:22.446535 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:22.446763 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Countries_InterView]
        ) as __dbt_sbq
    
20:18:22.493488 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:18:22.496086 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:22.496293 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:22.510485 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:18:22.534050 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:22.534338 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Countries_Incr"
        ) as __dbt_sbq
    
20:18:22.613838 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:18:22.617784 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:22.618007 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr'
      and table_schema = 'stg'
  
20:18:22.706140 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:18:22.709764 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:22.710003 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
        
  
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Countries_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Countries_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Countries_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Countries_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Countries_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Countries_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:22.411717'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:22.411717'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:18:22.411717''), CONVERT(DATETIME2, ''2022-09-26 20:18:22.411717'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:18:22.411717'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:22.411717'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:22.411717'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:18:22.411717'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.StateRequired != source_data.StateRequired
        or
        (
            ((snapshotted_data.StateRequired is null) and not (source_data.StateRequired is null))
            or
            ((not snapshotted_data.StateRequired is null) and (source_data.StateRequired is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.StateRequired != source_data.StateRequired
        or
        (
            ((snapshotted_data.StateRequired is null) and not (source_data.StateRequired is null))
            or
            ((not snapshotted_data.StateRequired is null) and (source_data.StateRequired is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Countries_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Countries_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Countries_Incr__dbt_tmp_temp_view"
    end



    
20:18:22.776903 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
20:18:22.780183 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:22.780430 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr'
      and table_schema = 'stg'
  
20:18:22.818990 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:22.823255 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:22.823492 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:22.895233 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:22.896825 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:22.897022 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contactus_Incr__dbt_tmp"
    
20:18:23.334068 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.87 seconds
20:18:23.335830 [debug] [Thread-1  ]: On snapshot.Shawn.AH_CategoryCustomFields_Incr: COMMIT
20:18:23.336618 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
20:18:23.336760 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    end

20:18:23.383501 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:23.398062 [debug] [Thread-1  ]: finished collecting timing info
20:18:23.398388 [debug] [Thread-1  ]: On snapshot.Shawn.AH_CategoryCustomFields_Incr: Close
20:18:23.399162 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016545c4c0>]}
20:18:23.399643 [info ] [Thread-1  ]: 11 of 101 OK snapshotted stg.AH_CategoryCustomFields_Incr....................... [[32mOK[0m in 20.62s]
20:18:23.399966 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_CategoryCustomFields_Incr
20:18:23.400120 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_CreditCardTypes_Incr
20:18:23.400474 [info ] [Thread-1  ]: 17 of 101 START snapshot stg.AH_CreditCardTypes_Incr............................ [RUN]
20:18:23.400853 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr"
20:18:23.400964 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_CreditCardTypes_Incr
20:18:23.401062 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_CreditCardTypes_Incr
20:18:23.403897 [debug] [Thread-1  ]: finished collecting timing info
20:18:23.404057 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_CreditCardTypes_Incr
20:18:23.406984 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:23.407126 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:18:23.407209 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:18:23.407305 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:18:23.531156 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:18:23.561842 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:18:23.586142 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:23.586429 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:18:23.615951 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:18:23.618142 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:23.618705 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CreditCardTypes_InterView]
        ) as __dbt_sbq
    
20:18:23.684980 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:23.708658 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:23.708944 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr"
        ) as __dbt_sbq
    
20:18:23.742886 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.85 seconds
20:18:23.744544 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:23.744746 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:23.757668 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:23.761534 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:23.761785 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr'
      and table_schema = 'stg'
  
20:18:23.801719 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:18:23.804097 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:23.804293 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:23.848145 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:18:23.851667 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:23.851870 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
        
  
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCardTypes_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CreditCardTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CreditCardTypes_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CreditCardTypes_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:23.599234'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:23.599234'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:18:23.599234''), CONVERT(DATETIME2, ''2022-09-26 20:18:23.599234'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:18:23.599234'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:23.599234'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:23.599234'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:18:23.599234'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CreditCardTypes_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCardTypes_Incr__dbt_tmp_temp_view"
    end



    
20:18:23.997693 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:18:24.000667 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:24.000866 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr'
      and table_schema = 'stg'
  
20:18:24.035261 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:18:24.039439 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:24.039666 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:24.090097 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:24.091544 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:24.091697 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contactus_Incr__dbt_tmp"
    
20:18:24.982589 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.89 seconds
20:18:24.984040 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:24.984233 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:25.025823 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:25.028311 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:25.028544 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:25.287424 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:18:25.289623 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Contactus_Incr"
20:18:25.290092 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:25.290227 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Contactus_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Contactus_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Contactus_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Contactus_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Contactus_Incr" (
                  "ID", "Email", "FirstName", "LastName", "Message", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Email", "FirstName", "LastName", "Message", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Contactus_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:18:26.633084 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.34 seconds
20:18:26.634780 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Contactus_Incr: COMMIT
20:18:26.635789 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
20:18:26.635937 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."#AH_Contactus_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Contactus_Incr__dbt_tmp"
    end

20:18:26.699538 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:18:26.713446 [debug] [Thread-3  ]: finished collecting timing info
20:18:26.713784 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Contactus_Incr: Close
20:18:26.714582 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01642a44f0>]}
20:18:26.715086 [info ] [Thread-3  ]: 14 of 101 OK snapshotted stg.AH_Contactus_Incr.................................. [[32mOK[0m in 10.73s]
20:18:26.715415 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Contactus_Incr
20:18:26.715564 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr
20:18:26.715934 [info ] [Thread-3  ]: 18 of 101 START snapshot stg.AH_CreditCardsExtraInFormation_Incr................ [RUN]
20:18:26.716333 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr"
20:18:26.716441 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr
20:18:26.716536 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr
20:18:26.719390 [debug] [Thread-3  ]: finished collecting timing info
20:18:26.719618 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr
20:18:26.722387 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:26.722531 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:18:26.722645 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:18:26.722748 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:18:26.826744 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:18:26.858882 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:18:26.885509 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:26.885803 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:18:26.934692 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:26.937305 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:26.938154 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CreditCardsExtraInFormation_InterView]
        ) as __dbt_sbq
    
20:18:27.188042 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:18:27.215938 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:27.216225 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr"
        ) as __dbt_sbq
    
20:18:27.275014 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:18:27.278514 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:27.278829 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr'
      and table_schema = 'stg'
  
20:18:27.385386 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:18:27.388875 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:27.389118 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
        
  
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CreditCardsExtraInFormation_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:26.896157'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:26.896157'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:18:26.896157''), CONVERT(DATETIME2, ''2022-09-26 20:18:26.896157'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:18:26.896157'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:26.896157'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:26.896157'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:18:26.896157'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Cvv != source_data.Cvv
        or
        (
            ((snapshotted_data.Cvv is null) and not (source_data.Cvv is null))
            or
            ((not snapshotted_data.Cvv is null) and (source_data.Cvv is null))
        ) or snapshotted_data.CreditCardID != source_data.CreditCardID
        or
        (
            ((snapshotted_data.CreditCardID is null) and not (source_data.CreditCardID is null))
            or
            ((not snapshotted_data.CreditCardID is null) and (source_data.CreditCardID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Cvv != source_data.Cvv
        or
        (
            ((snapshotted_data.Cvv is null) and not (source_data.Cvv is null))
            or
            ((not snapshotted_data.Cvv is null) and (source_data.Cvv is null))
        ) or snapshotted_data.CreditCardID != source_data.CreditCardID
        or
        (
            ((snapshotted_data.CreditCardID is null) and not (source_data.CreditCardID is null))
            or
            ((not snapshotted_data.CreditCardID is null) and (source_data.CreditCardID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view"
    end



    
20:18:29.283217 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 6.57 seconds
20:18:29.287530 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:29.287921 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:29.342450 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:29.344119 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:29.344361 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Countries_Incr__dbt_tmp"
    
20:18:29.575431 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.72 seconds
20:18:29.578743 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:29.578979 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:29.643886 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:18:29.645372 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:29.645564 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    
20:18:30.500878 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
20:18:30.502469 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:30.502686 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:30.577728 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:30.580352 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:30.580561 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:30.826328 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:18:30.829722 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:30.829966 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr'
      and table_schema = 'stg'
  
20:18:30.868251 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:30.872637 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:30.873058 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:30.908828 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:30.910323 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:30.910508 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Countries_Incr__dbt_tmp"
    
20:18:31.161817 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.52 seconds
20:18:31.163396 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:31.163582 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:31.241236 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:18:31.243824 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:31.244041 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:31.469251 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:18:31.472283 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:31.472508 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr'
      and table_schema = 'stg'
  
20:18:31.511547 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:31.515736 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:31.516024 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:31.552378 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:31.554014 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:31.554211 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    
20:18:31.638623 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 4.25 seconds
20:18:31.641866 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:31.642085 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:31.707537 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:31.709120 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:31.709328 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    
20:18:31.810754 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 11.25 seconds
20:18:31.813991 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:31.814210 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:31.839471 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.93 seconds
20:18:31.840973 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:31.841163 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:31.864578 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:31.866016 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:31.866225 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contents_Incr__dbt_tmp"
    
20:18:31.882780 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:31.885458 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:31.885676 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:32.317043 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
20:18:32.319775 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:32.319991 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr'
      and table_schema = 'stg'
  
20:18:32.361581 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:32.367648 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:32.367913 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:32.406487 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:32.407955 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:32.408151 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Countries_Incr__dbt_tmp"
    
20:18:32.575716 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.02 seconds
20:18:32.577380 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:32.577581 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:32.611458 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:18:32.613848 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:32.614089 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:32.727378 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.02 seconds
20:18:32.728908 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:32.729135 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:32.799114 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:32.801630 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:32.801868 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:32.848995 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:18:32.852040 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:32.852273 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr'
      and table_schema = 'stg'
  
20:18:32.893874 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:32.898421 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:32.898717 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:32.941774 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.08 seconds
20:18:32.943328 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:32.943539 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:32.962462 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:18:32.963766 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:32.963940 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    
20:18:33.019200 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:18:33.021897 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:33.022129 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:33.038843 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:18:33.042096 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:33.042329 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr'
      and table_schema = 'stg'
  
20:18:33.094194 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:33.098264 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:33.098505 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:33.135796 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:33.137388 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:33.137587 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    
20:18:33.239101 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:18:33.242185 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:33.242399 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr'
      and table_schema = 'stg'
  
20:18:33.279009 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:33.283526 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:33.283786 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:33.285600 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
20:18:33.286918 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:33.287073 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:33.333017 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:33.335926 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:33.336155 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:33.337457 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:33.337628 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contents_Incr__dbt_tmp"
    
20:18:33.336303 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:33.830458 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.87 seconds
20:18:33.832120 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:33.832322 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:33.870752 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:33.873679 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:33.873936 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:36.876895 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.54 seconds
20:18:36.879097 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Countries_Incr"
20:18:36.879575 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:36.879710 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Countries_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Countries_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Countries_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Countries_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Countries_Incr" (
                  "ID", "Name", "Code", "CreatedOn", "UpdatedOn", "DeletedOn", "Enabled", "StateRequired", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Code", "CreatedOn", "UpdatedOn", "DeletedOn", "Enabled", "StateRequired", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Countries_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:18:36.879973 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.01 seconds
20:18:36.881634 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CreditCardTypes_Incr"
20:18:36.881970 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:36.882085 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CreditCardTypes_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr" (
                  "ID", "Enabled", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Enabled", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:18:37.452667 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 4.31 seconds
20:18:37.454288 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:37.454497 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:37.490995 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:37.493638 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:37.493915 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:37.609254 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 4.27 seconds
20:18:37.610873 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:37.611058 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:37.646885 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:37.649668 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:37.649905 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:37.786013 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
20:18:37.789298 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:37.789558 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr'
      and table_schema = 'stg'
  
20:18:37.838827 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:37.843006 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:37.843242 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:37.850983 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:18:37.853688 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:37.853884 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr'
      and table_schema = 'stg'
  
20:18:37.895793 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:37.897251 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:37.897444 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    
20:18:37.904152 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:37.908450 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:37.908690 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:37.946979 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:37.948591 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:37.948790 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contents_Incr__dbt_tmp"
    
20:18:38.455692 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.58 seconds
20:18:38.457352 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Countries_Incr: COMMIT
20:18:38.458079 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
20:18:38.458215 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."#AH_Countries_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Countries_Incr__dbt_tmp"
    end

20:18:38.487000 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.60 seconds
20:18:38.488789 [debug] [Thread-1  ]: On snapshot.Shawn.AH_CreditCardTypes_Incr: COMMIT
20:18:38.491871 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
20:18:38.492045 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."#AH_CreditCardTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    end

20:18:38.507810 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:38.599533 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:18:38.615512 [debug] [Thread-1  ]: finished collecting timing info
20:18:38.620982 [debug] [Thread-1  ]: On snapshot.Shawn.AH_CreditCardTypes_Incr: Close
20:18:38.621754 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016402baf0>]}
20:18:38.622244 [info ] [Thread-1  ]: 17 of 101 OK snapshotted stg.AH_CreditCardTypes_Incr............................ [[32mOK[0m in 15.22s]
20:18:38.622604 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_CreditCardTypes_Incr
20:18:38.622756 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Currencies_Incr
20:18:38.623116 [info ] [Thread-1  ]: 19 of 101 START snapshot stg.AH_Currencies_Incr................................. [RUN]
20:18:38.623517 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Currencies_Incr"
20:18:38.623627 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Currencies_Incr
20:18:38.623726 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Currencies_Incr
20:18:38.620641 [debug] [Thread-4  ]: finished collecting timing info
20:18:38.626723 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Countries_Incr: Close
20:18:38.627357 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016402b100>]}
20:18:38.627737 [info ] [Thread-4  ]: 16 of 101 OK snapshotted stg.AH_Countries_Incr.................................. [[32mOK[0m in 16.42s]
20:18:38.628008 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Countries_Incr
20:18:38.628150 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_CustomFieldenums_Incr
20:18:38.628455 [info ] [Thread-4  ]: 20 of 101 START snapshot stg.AH_CustomFieldenums_Incr........................... [RUN]
20:18:38.628847 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr"
20:18:38.628965 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_CustomFieldenums_Incr
20:18:38.629055 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_CustomFieldenums_Incr
20:18:38.626487 [debug] [Thread-1  ]: finished collecting timing info
20:18:38.632085 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Currencies_Incr
20:18:38.631918 [debug] [Thread-4  ]: finished collecting timing info
20:18:38.635052 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_CustomFieldenums_Incr
20:18:38.637763 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:38.637895 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:18:38.637977 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:18:38.638077 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:18:38.634887 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:38.638628 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:18:38.638730 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:18:38.638823 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:18:38.779409 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:18:38.780019 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:18:38.808631 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:18:38.819841 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:18:38.855160 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:38.856044 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:38.856321 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:18:38.856225 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:18:38.872453 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
20:18:38.873873 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:38.874061 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:38.875761 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.93 seconds
20:18:38.876927 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:38.877067 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:38.883993 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:18:38.885820 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:38.885974 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Currencies_InterView]
        ) as __dbt_sbq
    
20:18:38.887429 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:18:38.889078 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:38.889217 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CustomFieldenums_InterView]
        ) as __dbt_sbq
    
20:18:38.907795 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:18:38.910649 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:38.910899 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:38.911157 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:18:38.913382 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:38.913555 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:38.940460 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:38.949513 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:18:38.986155 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:38.986442 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Currencies_Incr"
        ) as __dbt_sbq
    
20:18:38.987021 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:38.987170 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr"
        ) as __dbt_sbq
    
20:18:39.044190 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:18:39.048179 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:39.048427 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr'
      and table_schema = 'stg'
  
20:18:39.068998 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:18:39.072622 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:39.072866 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr'
      and table_schema = 'stg'
  
20:18:39.110895 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:18:39.112933 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr"
20:18:39.113423 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:39.113559 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr" (
                  "ID", "Cvv", "CreditCardID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Cvv", "CreditCardID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:18:39.127912 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:18:39.131194 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:39.131408 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
        
  
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Currencies_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Currencies_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Currencies_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Currencies_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Currencies_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Currencies_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:38.865095'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:38.865095'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:18:38.865095''), CONVERT(DATETIME2, ''2022-09-26 20:18:38.865095'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:18:38.865095'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:38.865095'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:38.865095'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:18:38.865095'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ConVersiontousd != source_data.ConVersiontousd
        or
        (
            ((snapshotted_data.ConVersiontousd is null) and not (source_data.ConVersiontousd is null))
            or
            ((not snapshotted_data.ConVersiontousd is null) and (source_data.ConVersiontousd is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ConVersiontousd != source_data.ConVersiontousd
        or
        (
            ((snapshotted_data.ConVersiontousd is null) and not (source_data.ConVersiontousd is null))
            or
            ((not snapshotted_data.ConVersiontousd is null) and (source_data.ConVersiontousd is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Currencies_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Currencies_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Currencies_Incr__dbt_tmp_temp_view"
    end



    
20:18:39.146262 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:39.150214 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:39.150452 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
        
  
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CustomFieldenums_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CustomFieldenums_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CustomFieldenums_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CustomFieldenums_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:38.865095'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:38.865095'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:18:38.865095''), CONVERT(DATETIME2, ''2022-09-26 20:18:38.865095'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:18:38.865095'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:38.865095'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:38.865095'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:18:38.865095'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CustomFieldenums_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CustomFieldenums_Incr__dbt_tmp_temp_view"
    end



    
20:18:39.150646 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:18:39.152461 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Contents_Incr"
20:18:39.152826 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:39.152941 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Contents_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Contents_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Contents_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Contents_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Contents_Incr" (
                  "ID", "DisplayOrder", "Usehtmleditor", "Userdefined", "CreatedOn", "UpdatedOn", "DeletedOn", "Text", "Name", "Culture", "PageTitle", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DisplayOrder", "Usehtmleditor", "Userdefined", "CreatedOn", "UpdatedOn", "DeletedOn", "Text", "Name", "Culture", "PageTitle", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Contents_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:18:40.747404 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.59 seconds
20:18:40.749029 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Contents_Incr: COMMIT
20:18:40.749764 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
20:18:40.749895 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."#AH_Contents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Contents_Incr__dbt_tmp"
    end

20:18:40.802000 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:40.815619 [debug] [Thread-2  ]: finished collecting timing info
20:18:40.815953 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Contents_Incr: Close
20:18:40.816707 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01642047f0>]}
20:18:40.817175 [info ] [Thread-2  ]: 15 of 101 OK snapshotted stg.AH_Contents_Incr................................... [[32mOK[0m in 20.73s]
20:18:40.817500 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Contents_Incr
20:18:40.817662 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_CustomFields_Incr
20:18:40.818045 [info ] [Thread-2  ]: 21 of 101 START snapshot stg.AH_CustomFields_Incr............................... [RUN]
20:18:40.818448 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CustomFields_Incr"
20:18:40.818597 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_CustomFields_Incr
20:18:40.818707 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_CustomFields_Incr
20:18:40.821612 [debug] [Thread-2  ]: finished collecting timing info
20:18:40.821845 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_CustomFields_Incr
20:18:40.824778 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:18:40.824926 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:18:40.825010 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:18:40.825109 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:18:40.829136 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.72 seconds
20:18:40.830499 [debug] [Thread-3  ]: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: COMMIT
20:18:40.831204 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
20:18:40.831326 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    end

20:18:40.880787 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:40.894599 [debug] [Thread-3  ]: finished collecting timing info
20:18:40.894944 [debug] [Thread-3  ]: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: Close
20:18:40.895674 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016412b460>]}
20:18:40.896155 [info ] [Thread-3  ]: 18 of 101 OK snapshotted stg.AH_CreditCardsExtraInFormation_Incr................ [[32mOK[0m in 14.18s]
20:18:40.896476 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr
20:18:40.896621 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Customcurrencies_Incr
20:18:40.896983 [info ] [Thread-3  ]: 22 of 101 START snapshot stg.AH_Customcurrencies_Incr........................... [RUN]
20:18:40.897371 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr"
20:18:40.897481 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Customcurrencies_Incr
20:18:40.897578 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Customcurrencies_Incr
20:18:40.903693 [debug] [Thread-3  ]: finished collecting timing info
20:18:40.903890 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Customcurrencies_Incr
20:18:40.906813 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:40.906980 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:18:40.907065 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:18:40.907166 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:18:40.937361 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:18:40.969162 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:18:40.992631 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:18:40.992926 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:18:41.002943 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:18:41.021208 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:18:41.023778 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:18:41.024005 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CustomFields_InterView]
        ) as __dbt_sbq
    
20:18:41.031806 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:18:41.055080 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:41.055362 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:18:41.083449 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:18:41.106106 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:18:41.106585 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:41.108423 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:41.108579 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Customcurrencies_InterView]
        ) as __dbt_sbq
    
20:18:41.106736 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr"
        ) as __dbt_sbq
    
20:18:41.161861 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:41.180558 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:41.184626 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:18:41.184887 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr'
      and table_schema = 'stg'
  
20:18:41.189635 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:41.189855 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr"
        ) as __dbt_sbq
    
20:18:41.238696 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:41.242456 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:41.242720 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr'
      and table_schema = 'stg'
  
20:18:41.258522 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:41.262120 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:18:41.262362 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
        
  
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CustomFields_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CustomFields_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CustomFields_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CustomFields_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CustomFields_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:41.005695'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:41.005695'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:18:41.005695''), CONVERT(DATETIME2, ''2022-09-26 20:18:41.005695'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:18:41.005695'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:41.005695'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:41.005695'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:18:41.005695'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Required != source_data.Required
        or
        (
            ((snapshotted_data.Required is null) and not (source_data.Required is null))
            or
            ((not snapshotted_data.Required is null) and (source_data.Required is null))
        ) or snapshotted_data.Deferred != source_data.Deferred
        or
        (
            ((snapshotted_data.Deferred is null) and not (source_data.Deferred is null))
            or
            ((not snapshotted_data.Deferred is null) and (source_data.Deferred is null))
        ) or snapshotted_data.Encrypted != source_data.Encrypted
        or
        (
            ((snapshotted_data.Encrypted is null) and not (source_data.Encrypted is null))
            or
            ((not snapshotted_data.Encrypted is null) and (source_data.Encrypted is null))
        ) or snapshotted_data.IncludeonInvoice != source_data.IncludeonInvoice
        or
        (
            ((snapshotted_data.IncludeonInvoice is null) and not (source_data.IncludeonInvoice is null))
            or
            ((not snapshotted_data.IncludeonInvoice is null) and (source_data.IncludeonInvoice is null))
        ) or snapshotted_data.IncludeinSalesReport != source_data.IncludeinSalesReport
        or
        (
            ((snapshotted_data.IncludeinSalesReport is null) and not (source_data.IncludeinSalesReport is null))
            or
            ((not snapshotted_data.IncludeinSalesReport is null) and (source_data.IncludeinSalesReport is null))
        ) or snapshotted_data.IncludeonInvoiceasSeller != source_data.IncludeonInvoiceasSeller
        or
        (
            ((snapshotted_data.IncludeonInvoiceasSeller is null) and not (source_data.IncludeonInvoiceasSeller is null))
            or
            ((not snapshotted_data.IncludeonInvoiceasSeller is null) and (source_data.IncludeonInvoiceasSeller is null))
        ) or snapshotted_data.IncludeonInvoiceasBuyer != source_data.IncludeonInvoiceasBuyer
        or
        (
            ((snapshotted_data.IncludeonInvoiceasBuyer is null) and not (source_data.IncludeonInvoiceasBuyer is null))
            or
            ((not snapshotted_data.IncludeonInvoiceasBuyer is null) and (source_data.IncludeonInvoiceasBuyer is null))
        ) or snapshotted_data.IncludeinSalesReportasSeller != source_data.IncludeinSalesReportasSeller
        or
        (
            ((snapshotted_data.IncludeinSalesReportasSeller is null) and not (source_data.IncludeinSalesReportasSeller is null))
            or
            ((not snapshotted_data.IncludeinSalesReportasSeller is null) and (source_data.IncludeinSalesReportasSeller is null))
        ) or snapshotted_data.IncludeinSalesReportasBuyer != source_data.IncludeinSalesReportasBuyer
        or
        (
            ((snapshotted_data.IncludeinSalesReportasBuyer is null) and not (source_data.IncludeinSalesReportasBuyer is null))
            or
            ((not snapshotted_data.IncludeinSalesReportasBuyer is null) and (source_data.IncludeinSalesReportasBuyer is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.VisiBIlity != source_data.VisiBIlity
        or
        (
            ((snapshotted_data.VisiBIlity is null) and not (source_data.VisiBIlity is null))
            or
            ((not snapshotted_data.VisiBIlity is null) and (source_data.VisiBIlity is null))
        ) or snapshotted_data.MutaBIlity != source_data.MutaBIlity
        or
        (
            ((snapshotted_data.MutaBIlity is null) and not (source_data.MutaBIlity is null))
            or
            ((not snapshotted_data.MutaBIlity is null) and (source_data.MutaBIlity is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.DefaultValue != source_data.DefaultValue
        or
        (
            ((snapshotted_data.DefaultValue is null) and not (source_data.DefaultValue is null))
            or
            ((not snapshotted_data.DefaultValue is null) and (source_data.DefaultValue is null))
        ) or snapshotted_data.GroupName != source_data.GroupName
        or
        (
            ((snapshotted_data.GroupName is null) and not (source_data.GroupName is null))
            or
            ((not snapshotted_data.GroupName is null) and (source_data.GroupName is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Required != source_data.Required
        or
        (
            ((snapshotted_data.Required is null) and not (source_data.Required is null))
            or
            ((not snapshotted_data.Required is null) and (source_data.Required is null))
        ) or snapshotted_data.Deferred != source_data.Deferred
        or
        (
            ((snapshotted_data.Deferred is null) and not (source_data.Deferred is null))
            or
            ((not snapshotted_data.Deferred is null) and (source_data.Deferred is null))
        ) or snapshotted_data.Encrypted != source_data.Encrypted
        or
        (
            ((snapshotted_data.Encrypted is null) and not (source_data.Encrypted is null))
            or
            ((not snapshotted_data.Encrypted is null) and (source_data.Encrypted is null))
        ) or snapshotted_data.IncludeonInvoice != source_data.IncludeonInvoice
        or
        (
            ((snapshotted_data.IncludeonInvoice is null) and not (source_data.IncludeonInvoice is null))
            or
            ((not snapshotted_data.IncludeonInvoice is null) and (source_data.IncludeonInvoice is null))
        ) or snapshotted_data.IncludeinSalesReport != source_data.IncludeinSalesReport
        or
        (
            ((snapshotted_data.IncludeinSalesReport is null) and not (source_data.IncludeinSalesReport is null))
            or
            ((not snapshotted_data.IncludeinSalesReport is null) and (source_data.IncludeinSalesReport is null))
        ) or snapshotted_data.IncludeonInvoiceasSeller != source_data.IncludeonInvoiceasSeller
        or
        (
            ((snapshotted_data.IncludeonInvoiceasSeller is null) and not (source_data.IncludeonInvoiceasSeller is null))
            or
            ((not snapshotted_data.IncludeonInvoiceasSeller is null) and (source_data.IncludeonInvoiceasSeller is null))
        ) or snapshotted_data.IncludeonInvoiceasBuyer != source_data.IncludeonInvoiceasBuyer
        or
        (
            ((snapshotted_data.IncludeonInvoiceasBuyer is null) and not (source_data.IncludeonInvoiceasBuyer is null))
            or
            ((not snapshotted_data.IncludeonInvoiceasBuyer is null) and (source_data.IncludeonInvoiceasBuyer is null))
        ) or snapshotted_data.IncludeinSalesReportasSeller != source_data.IncludeinSalesReportasSeller
        or
        (
            ((snapshotted_data.IncludeinSalesReportasSeller is null) and not (source_data.IncludeinSalesReportasSeller is null))
            or
            ((not snapshotted_data.IncludeinSalesReportasSeller is null) and (source_data.IncludeinSalesReportasSeller is null))
        ) or snapshotted_data.IncludeinSalesReportasBuyer != source_data.IncludeinSalesReportasBuyer
        or
        (
            ((snapshotted_data.IncludeinSalesReportasBuyer is null) and not (source_data.IncludeinSalesReportasBuyer is null))
            or
            ((not snapshotted_data.IncludeinSalesReportasBuyer is null) and (source_data.IncludeinSalesReportasBuyer is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.VisiBIlity != source_data.VisiBIlity
        or
        (
            ((snapshotted_data.VisiBIlity is null) and not (source_data.VisiBIlity is null))
            or
            ((not snapshotted_data.VisiBIlity is null) and (source_data.VisiBIlity is null))
        ) or snapshotted_data.MutaBIlity != source_data.MutaBIlity
        or
        (
            ((snapshotted_data.MutaBIlity is null) and not (source_data.MutaBIlity is null))
            or
            ((not snapshotted_data.MutaBIlity is null) and (source_data.MutaBIlity is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.DefaultValue != source_data.DefaultValue
        or
        (
            ((snapshotted_data.DefaultValue is null) and not (source_data.DefaultValue is null))
            or
            ((not snapshotted_data.DefaultValue is null) and (source_data.DefaultValue is null))
        ) or snapshotted_data.GroupName != source_data.GroupName
        or
        (
            ((snapshotted_data.GroupName is null) and not (source_data.GroupName is null))
            or
            ((not snapshotted_data.GroupName is null) and (source_data.GroupName is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CustomFields_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CustomFields_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CustomFields_Incr__dbt_tmp_temp_view"
    end



    
20:18:41.309682 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:41.313481 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:41.313703 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
        
  
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Customcurrencies_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Customcurrencies_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Customcurrencies_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Customcurrencies_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:41.068283'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:41.068283'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:18:41.068283''), CONVERT(DATETIME2, ''2022-09-26 20:18:41.068283'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:18:41.068283'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:41.068283'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:41.068283'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:18:41.068283'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Isocurrencysymbol != source_data.Isocurrencysymbol
        or
        (
            ((snapshotted_data.Isocurrencysymbol is null) and not (source_data.Isocurrencysymbol is null))
            or
            ((not snapshotted_data.Isocurrencysymbol is null) and (source_data.Isocurrencysymbol is null))
        ) or snapshotted_data.Currencysymbol != source_data.Currencysymbol
        or
        (
            ((snapshotted_data.Currencysymbol is null) and not (source_data.Currencysymbol is null))
            or
            ((not snapshotted_data.Currencysymbol is null) and (source_data.Currencysymbol is null))
        ) or snapshotted_data.CurrencyenglishName != source_data.CurrencyenglishName
        or
        (
            ((snapshotted_data.CurrencyenglishName is null) and not (source_data.CurrencyenglishName is null))
            or
            ((not snapshotted_data.CurrencyenglishName is null) and (source_data.CurrencyenglishName is null))
        ) or snapshotted_data.CurrencynativeName != source_data.CurrencynativeName
        or
        (
            ((snapshotted_data.CurrencynativeName is null) and not (source_data.CurrencynativeName is null))
            or
            ((not snapshotted_data.CurrencynativeName is null) and (source_data.CurrencynativeName is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Isocurrencysymbol != source_data.Isocurrencysymbol
        or
        (
            ((snapshotted_data.Isocurrencysymbol is null) and not (source_data.Isocurrencysymbol is null))
            or
            ((not snapshotted_data.Isocurrencysymbol is null) and (source_data.Isocurrencysymbol is null))
        ) or snapshotted_data.Currencysymbol != source_data.Currencysymbol
        or
        (
            ((snapshotted_data.Currencysymbol is null) and not (source_data.Currencysymbol is null))
            or
            ((not snapshotted_data.Currencysymbol is null) and (source_data.Currencysymbol is null))
        ) or snapshotted_data.CurrencyenglishName != source_data.CurrencyenglishName
        or
        (
            ((snapshotted_data.CurrencyenglishName is null) and not (source_data.CurrencyenglishName is null))
            or
            ((not snapshotted_data.CurrencyenglishName is null) and (source_data.CurrencyenglishName is null))
        ) or snapshotted_data.CurrencynativeName != source_data.CurrencynativeName
        or
        (
            ((snapshotted_data.CurrencynativeName is null) and not (source_data.CurrencynativeName is null))
            or
            ((not snapshotted_data.CurrencynativeName is null) and (source_data.CurrencynativeName is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Customcurrencies_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Customcurrencies_Incr__dbt_tmp_temp_view"
    end



    
20:18:49.375338 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 10.24 seconds
20:18:49.380012 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:49.380253 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:49.429150 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:49.430588 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:49.430779 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Currencies_Incr__dbt_tmp"
    
20:18:50.346220 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 11.20 seconds
20:18:50.349477 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:50.349684 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:50.379347 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
20:18:50.380965 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:50.381156 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:50.387657 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:50.388969 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:50.389145 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    
20:18:50.473565 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:18:50.476275 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:50.476497 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:50.745784 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:18:50.748834 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:50.749049 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr'
      and table_schema = 'stg'
  
20:18:50.825756 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:18:50.830204 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:50.830434 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:50.882940 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:50.884444 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:50.884624 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Currencies_Incr__dbt_tmp"
    
20:18:51.271875 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 9.96 seconds
20:18:51.275555 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:51.275803 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:51.340325 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
20:18:51.342000 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:51.342195 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:51.342449 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:51.343535 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:51.343675 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    
20:18:51.420853 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:18:51.423313 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:51.423496 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:51.626506 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:18:51.629742 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:51.629961 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr'
      and table_schema = 'stg'
  
20:18:51.705149 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:18:51.709144 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:51.709381 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:51.760910 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:51.762511 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:51.762732 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    
20:18:51.787781 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.90 seconds
20:18:51.789339 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:51.789514 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:51.869265 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:18:51.871816 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:51.872028 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:52.099848 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:18:52.102801 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:52.103023 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr'
      and table_schema = 'stg'
  
20:18:52.139278 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:52.143499 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:52.143716 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:52.181323 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:52.184711 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:52.184947 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Currencies_Incr__dbt_tmp"
    
20:18:52.289719 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
20:18:52.291475 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:52.291674 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:52.378922 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:18:52.381881 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:52.382121 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:52.619837 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:18:52.622591 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:52.622781 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr'
      and table_schema = 'stg'
  
20:18:52.698628 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:18:52.702837 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:52.703068 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:52.750073 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:52.751836 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:52.752019 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    
20:18:52.867099 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
20:18:52.868758 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:52.868956 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:52.904604 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:52.907042 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:52.907236 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:53.104524 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.92 seconds
20:18:53.106251 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:53.106446 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:53.134969 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:18:53.140093 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:53.140348 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:18:53.142389 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:53.142592 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:53.140491 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr'
      and table_schema = 'stg'
  
20:18:53.189447 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:53.194009 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:53.194217 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:53.243527 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:53.245101 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:53.245290 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    
20:18:53.345536 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:18:53.347635 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Currencies_Incr"
20:18:53.348087 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:53.348219 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Currencies_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Currencies_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Currencies_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Currencies_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Currencies_Incr" (
                  "ID", "Code", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "ConVersiontousd", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Code", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "ConVersiontousd", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Currencies_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:18:53.626417 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.87 seconds
20:18:53.628070 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:53.628260 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:53.671569 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:53.673954 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:53.674168 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:53.888904 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:18:53.892270 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:53.892473 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr'
      and table_schema = 'stg'
  
20:18:53.926132 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:18:53.930383 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:53.930622 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:53.972808 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:53.974301 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:53.974592 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    
20:18:54.143118 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.90 seconds
20:18:54.144652 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:54.144830 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:54.187099 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:54.189599 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:54.189863 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:54.407664 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:18:54.410164 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CustomFieldenums_Incr"
20:18:54.410669 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:54.410818 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CustomFieldenums_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr" (
                  "ID", "Name", "Value", "CreatedOn", "UpdatedOn", "DeletedOn", "CustomFieldID", "Enabled", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Value", "CreatedOn", "UpdatedOn", "DeletedOn", "CustomFieldID", "Enabled", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:18:54.716915 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.37 seconds
20:18:54.718733 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Currencies_Incr: COMMIT
20:18:54.719526 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
20:18:54.719666 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."#AH_Currencies_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Currencies_Incr__dbt_tmp"
    end

20:18:54.785326 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:54.799191 [debug] [Thread-1  ]: finished collecting timing info
20:18:54.799531 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Currencies_Incr: Close
20:18:54.800297 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0165432220>]}
20:18:54.800772 [info ] [Thread-1  ]: 19 of 101 OK snapshotted stg.AH_Currencies_Incr................................. [[32mOK[0m in 16.18s]
20:18:54.801098 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Currencies_Incr
20:18:54.801257 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr
20:18:54.801611 [info ] [Thread-1  ]: 23 of 101 START snapshot stg.AH_DailyhuntEmailSubscribers_Incr.................. [RUN]
20:18:54.801987 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr"
20:18:54.802094 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr
20:18:54.802190 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr
20:18:54.805096 [debug] [Thread-1  ]: finished collecting timing info
20:18:54.805332 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr
20:18:54.808310 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:18:54.808455 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:18:54.808540 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:18:54.808643 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:18:54.844490 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.87 seconds
20:18:54.846020 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:54.846197 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:54.898062 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:54.900498 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:54.900684 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:54.918435 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:18:54.946653 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:18:54.970331 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:18:54.970658 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:18:55.005898 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:55.007940 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:18:55.008140 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_DailyhuntEmailSubscribers_InterView]
        ) as __dbt_sbq
    
20:18:55.096038 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:18:55.112816 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:18:55.114826 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Customcurrencies_Incr"
20:18:55.115269 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:55.115391 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Customcurrencies_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Isocurrencysymbol", "Currencysymbol", "CurrencyenglishName", "CurrencynativeName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Isocurrencysymbol", "Currencysymbol", "CurrencyenglishName", "CurrencynativeName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Customcurrencies_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:18:55.122658 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:18:55.122835 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr"
        ) as __dbt_sbq
    
20:18:55.266200 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:18:55.269806 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:18:55.269989 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr'
      and table_schema = 'stg'
  
20:18:55.354569 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:18:55.357838 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:18:55.358043 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
        
  
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_DailyhuntEmailSubscribers_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:54.974705'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:54.974705'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:18:54.974705''), CONVERT(DATETIME2, ''2022-09-26 20:18:54.974705'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:18:54.974705'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:54.974705'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:54.974705'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:18:54.974705'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ) or snapshotted_data.ZipCode != source_data.ZipCode
        or
        (
            ((snapshotted_data.ZipCode is null) and not (source_data.ZipCode is null))
            or
            ((not snapshotted_data.ZipCode is null) and (source_data.ZipCode is null))
        ) or snapshotted_data.ASenthusiast != source_data.ASenthusiast
        or
        (
            ((snapshotted_data.ASenthusiast is null) and not (source_data.ASenthusiast is null))
            or
            ((not snapshotted_data.ASenthusiast is null) and (source_data.ASenthusiast is null))
        ) or snapshotted_data.AsBidder != source_data.AsBidder
        or
        (
            ((snapshotted_data.AsBidder is null) and not (source_data.AsBidder is null))
            or
            ((not snapshotted_data.AsBidder is null) and (source_data.AsBidder is null))
        ) or snapshotted_data.AsConsignor != source_data.AsConsignor
        or
        (
            ((snapshotted_data.AsConsignor is null) and not (source_data.AsConsignor is null))
            or
            ((not snapshotted_data.AsConsignor is null) and (source_data.AsConsignor is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ) or snapshotted_data.ZipCode != source_data.ZipCode
        or
        (
            ((snapshotted_data.ZipCode is null) and not (source_data.ZipCode is null))
            or
            ((not snapshotted_data.ZipCode is null) and (source_data.ZipCode is null))
        ) or snapshotted_data.ASenthusiast != source_data.ASenthusiast
        or
        (
            ((snapshotted_data.ASenthusiast is null) and not (source_data.ASenthusiast is null))
            or
            ((not snapshotted_data.ASenthusiast is null) and (source_data.ASenthusiast is null))
        ) or snapshotted_data.AsBidder != source_data.AsBidder
        or
        (
            ((snapshotted_data.AsBidder is null) and not (source_data.AsBidder is null))
            or
            ((not snapshotted_data.AsBidder is null) and (source_data.AsBidder is null))
        ) or snapshotted_data.AsConsignor != source_data.AsConsignor
        or
        (
            ((snapshotted_data.AsConsignor is null) and not (source_data.AsConsignor is null))
            or
            ((not snapshotted_data.AsConsignor is null) and (source_data.AsConsignor is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view"
    end



    
20:18:55.844514 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.43 seconds
20:18:55.846153 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CustomFieldenums_Incr: COMMIT
20:18:55.846913 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
20:18:55.847050 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."#AH_CustomFieldenums_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    end

20:18:55.884209 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:18:55.897881 [debug] [Thread-4  ]: finished collecting timing info
20:18:55.898224 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CustomFieldenums_Incr: Close
20:18:55.899035 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654320d0>]}
20:18:55.899532 [info ] [Thread-4  ]: 20 of 101 OK snapshotted stg.AH_CustomFieldenums_Incr........................... [[32mOK[0m in 17.27s]
20:18:55.899857 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_CustomFieldenums_Incr
20:18:55.900007 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Decorations_Incr
20:18:55.900350 [info ] [Thread-4  ]: 24 of 101 START snapshot stg.AH_Decorations_Incr................................ [RUN]
20:18:55.900719 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Decorations_Incr"
20:18:55.900829 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Decorations_Incr
20:18:55.900923 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Decorations_Incr
20:18:55.903727 [debug] [Thread-4  ]: finished collecting timing info
20:18:55.903884 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Decorations_Incr
20:18:55.906832 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:18:55.906977 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:18:55.907061 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:18:55.907163 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:18:56.024275 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:18:56.054884 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:18:56.079101 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:18:56.079384 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:18:56.107980 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:18:56.110243 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:18:56.110782 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Decorations_InterView]
        ) as __dbt_sbq
    
20:18:56.164301 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:56.186946 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:18:56.187221 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Decorations_Incr"
        ) as __dbt_sbq
    
20:18:56.330305 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:18:56.334597 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:18:56.334847 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr'
      and table_schema = 'stg'
  
20:18:56.426205 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:18:56.429781 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:18:56.430020 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
        
  
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Decorations_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Decorations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Decorations_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Decorations_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Decorations_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Decorations_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:56.084108'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:56.084108'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:18:56.084108''), CONVERT(DATETIME2, ''2022-09-26 20:18:56.084108'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:18:56.084108'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:56.084108'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:56.084108'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:18:56.084108'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ValIDFields != source_data.ValIDFields
        or
        (
            ((snapshotted_data.ValIDFields is null) and not (source_data.ValIDFields is null))
            or
            ((not snapshotted_data.ValIDFields is null) and (source_data.ValIDFields is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.FormatString != source_data.FormatString
        or
        (
            ((snapshotted_data.FormatString is null) and not (source_data.FormatString is null))
            or
            ((not snapshotted_data.FormatString is null) and (source_data.FormatString is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ValIDFields != source_data.ValIDFields
        or
        (
            ((snapshotted_data.ValIDFields is null) and not (source_data.ValIDFields is null))
            or
            ((not snapshotted_data.ValIDFields is null) and (source_data.ValIDFields is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.FormatString != source_data.FormatString
        or
        (
            ((snapshotted_data.FormatString is null) and not (source_data.FormatString is null))
            or
            ((not snapshotted_data.FormatString is null) and (source_data.FormatString is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Decorations_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Decorations_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Decorations_Incr__dbt_tmp_temp_view"
    end



    
20:18:56.650583 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.54 seconds
20:18:56.652337 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Customcurrencies_Incr: COMMIT
20:18:56.653184 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
20:18:56.653336 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."#AH_Customcurrencies_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    end

20:18:56.718986 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:56.732341 [debug] [Thread-3  ]: finished collecting timing info
20:18:56.732697 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Customcurrencies_Incr: Close
20:18:56.733481 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01643424f0>]}
20:18:56.733969 [info ] [Thread-3  ]: 22 of 101 OK snapshotted stg.AH_Customcurrencies_Incr........................... [[32mOK[0m in 15.84s]
20:18:56.734289 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Customcurrencies_Incr
20:18:56.734452 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Emailtemplatecontents_Incr
20:18:56.734856 [info ] [Thread-3  ]: 25 of 101 START snapshot stg.AH_Emailtemplatecontents_Incr...................... [RUN]
20:18:56.735262 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr"
20:18:56.735371 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Emailtemplatecontents_Incr
20:18:56.735467 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Emailtemplatecontents_Incr
20:18:56.738278 [debug] [Thread-3  ]: finished collecting timing info
20:18:56.738432 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Emailtemplatecontents_Incr
20:18:56.741500 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:18:56.741646 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:18:56.741730 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:18:56.741831 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:18:56.859610 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:18:56.904843 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:18:56.928286 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:18:56.928579 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:18:56.961094 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:18:56.963371 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:18:56.964180 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Emailtemplatecontents_InterView]
        ) as __dbt_sbq
    
20:18:57.046406 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:18:57.069211 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:18:57.069502 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr"
        ) as __dbt_sbq
    
20:18:57.325133 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:18:57.328545 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:18:57.328754 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr'
      and table_schema = 'stg'
  
20:18:57.417732 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:18:57.421338 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:18:57.421577 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
        
  
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Emailtemplatecontents_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:56.943511'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:56.943511'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:18:56.943511''), CONVERT(DATETIME2, ''2022-09-26 20:18:56.943511'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:18:56.943511'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:18:56.943511'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:18:56.943511'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:18:56.943511'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.SuBJect != source_data.SuBJect
        or
        (
            ((snapshotted_data.SuBJect is null) and not (source_data.SuBJect is null))
            or
            ((not snapshotted_data.SuBJect is null) and (source_data.SuBJect is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.SuBJect != source_data.SuBJect
        or
        (
            ((snapshotted_data.SuBJect is null) and not (source_data.SuBJect is null))
            or
            ((not snapshotted_data.SuBJect is null) and (source_data.SuBJect is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view"
    end



    
20:18:58.412980 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 17.15 seconds
20:18:58.416491 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:18:58.416729 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:58.463913 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:18:58.465592 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:18:58.465820 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFields_Incr__dbt_tmp"
    
20:18:59.406994 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
20:18:59.408670 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:18:59.408860 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:18:59.478640 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:18:59.481592 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:18:59.481819 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:59.699502 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:18:59.702798 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:18:59.703076 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr'
      and table_schema = 'stg'
  
20:18:59.796356 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:18:59.800734 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:18:59.800975 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:18:59.863261 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:18:59.864810 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:18:59.864993 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFields_Incr__dbt_tmp"
    
20:19:00.858036 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.99 seconds
20:19:00.864078 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:19:00.864380 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:00.920486 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:19:00.923476 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:19:00.923737 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:01.159999 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:19:01.162937 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:19:01.163169 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr'
      and table_schema = 'stg'
  
20:19:01.199419 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:01.204341 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:19:01.204607 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:01.284499 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:19:01.285912 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:19:01.286105 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFields_Incr__dbt_tmp"
    
20:19:02.007469 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.65 seconds
20:19:02.011317 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:19:02.011564 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:02.048809 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:02.050326 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:19:02.050519 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    
20:19:02.335194 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
20:19:02.336675 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:19:02.336869 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:02.371976 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:19:02.374998 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:19:02.375234 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:02.745512 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.37 seconds
20:19:02.747850 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CustomFields_Incr"
20:19:02.748314 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:19:02.748444 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CustomFields_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr" (
                  "ID", "Required", "Deferred", "Encrypted", "IncludeonInvoice", "IncludeinSalesReport", "IncludeonInvoiceasSeller", "IncludeonInvoiceasBuyer", "IncludeinSalesReportasSeller", "IncludeinSalesReportasBuyer", "Type", "DisplayOrder", "VisiBIlity", "MutaBIlity", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "DefaultValue", "GroupName", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Required", "Deferred", "Encrypted", "IncludeonInvoice", "IncludeinSalesReport", "IncludeonInvoiceasSeller", "IncludeonInvoiceasBuyer", "IncludeinSalesReportasSeller", "IncludeinSalesReportasBuyer", "Type", "DisplayOrder", "VisiBIlity", "MutaBIlity", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "DefaultValue", "GroupName", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CustomFields_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:19:03.345823 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.30 seconds
20:19:03.347366 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:19:03.347572 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:03.421556 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:19:03.424097 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:19:03.424342 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:03.671202 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:19:03.674098 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:19:03.674323 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr'
      and table_schema = 'stg'
  
20:19:03.747272 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:19:03.751369 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:19:03.751620 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:03.805553 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:19:03.807228 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:19:03.807422 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    
20:19:04.594431 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.85 seconds
20:19:04.596180 [debug] [Thread-2  ]: On snapshot.Shawn.AH_CustomFields_Incr: COMMIT
20:19:04.596956 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
20:19:04.597095 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."#AH_CustomFields_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CustomFields_Incr__dbt_tmp"
    end

20:19:04.667510 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:19:04.681792 [debug] [Thread-2  ]: finished collecting timing info
20:19:04.682134 [debug] [Thread-2  ]: On snapshot.Shawn.AH_CustomFields_Incr: Close
20:19:04.682942 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01641b06a0>]}
20:19:04.683446 [info ] [Thread-2  ]: 21 of 101 OK snapshotted stg.AH_CustomFields_Incr............................... [[32mOK[0m in 23.86s]
20:19:04.683781 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_CustomFields_Incr
20:19:04.683931 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Emailtemplates_Incr
20:19:04.684295 [info ] [Thread-2  ]: 26 of 101 START snapshot stg.AH_Emailtemplates_Incr............................. [RUN]
20:19:04.684675 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr"
20:19:04.684783 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Emailtemplates_Incr
20:19:04.684880 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Emailtemplates_Incr
20:19:04.687690 [debug] [Thread-2  ]: finished collecting timing info
20:19:04.687915 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Emailtemplates_Incr
20:19:04.690774 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:04.690915 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:19:04.690997 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:19:04.691094 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:19:04.696963 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 8.27 seconds
20:19:04.700121 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:19:04.700280 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:04.741199 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:04.742661 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:19:04.742834 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Decorations_Incr__dbt_tmp"
    
20:19:04.808475 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:19:04.846158 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:19:04.869184 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:04.869470 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:19:04.896869 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.09 seconds
20:19:04.898429 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:19:04.898657 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:04.901724 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:19:04.903934 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:04.904095 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Emailtemplates_InterView]
        ) as __dbt_sbq
    
20:19:04.934859 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:04.937302 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:19:04.937504 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:04.982942 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:19:05.006046 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:05.006346 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr"
        ) as __dbt_sbq
    
20:19:05.131866 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:19:05.135559 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:05.135817 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr'
      and table_schema = 'stg'
  
20:19:05.191709 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:19:05.194803 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:19:05.195058 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr'
      and table_schema = 'stg'
  
20:19:05.230282 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:19:05.233758 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:05.234015 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
        
  
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Emailtemplates_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Emailtemplates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Emailtemplates_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Emailtemplates_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:19:04.881147'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:19:04.881147'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:19:04.881147''), CONVERT(DATETIME2, ''2022-09-26 20:19:04.881147'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:19:04.881147'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:19:04.881147'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:19:04.881147'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:19:04.881147'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Emailtemplates_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Emailtemplates_Incr__dbt_tmp_temp_view"
    end



    
20:19:05.244851 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:19:05.249915 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:19:05.250163 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:05.336171 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:19:05.337636 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:19:05.337830 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    
20:19:05.812789 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 8.39 seconds
20:19:05.816148 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:19:05.816389 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:05.847058 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
20:19:05.848638 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:19:05.848821 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:05.856409 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:05.857815 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:19:05.858002 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    
20:19:05.918817 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:19:05.921452 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:19:05.921710 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:06.128067 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:19:06.131388 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:19:06.131668 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr'
      and table_schema = 'stg'
  
20:19:06.208671 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:19:06.213171 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:19:06.213424 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:06.265094 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:19:06.266492 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:19:06.266716 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Decorations_Incr__dbt_tmp"
    
20:19:06.390720 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
20:19:06.392219 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:19:06.392416 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:06.424793 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:19:06.427234 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:19:06.427420 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:06.801657 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
20:19:06.803561 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:19:06.803798 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:06.896956 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:19:06.899391 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:19:06.899602 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:06.909362 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.48 seconds
20:19:06.911346 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr"
20:19:06.911816 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:19:06.911948 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr" (
                  "ID", "Email", "FirstName", "LastName", "ZipCode", "ASenthusiast", "AsBidder", "AsConsignor", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Email", "FirstName", "LastName", "ZipCode", "ASenthusiast", "AsBidder", "AsConsignor", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:19:07.082751 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:19:07.086121 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:19:07.086372 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr'
      and table_schema = 'stg'
  
20:19:07.180766 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:19:07.184856 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:19:07.185093 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:07.239863 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:19:07.241607 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:19:07.241841 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    
20:19:07.283358 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.02 seconds
20:19:07.284955 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:19:07.285149 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:07.320900 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:07.323487 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:19:07.323717 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:07.521488 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:19:07.524368 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:19:07.524586 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr'
      and table_schema = 'stg'
  
20:19:07.569761 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:19:07.576240 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:19:07.576512 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:07.632234 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:19:07.633778 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:19:07.633964 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Decorations_Incr__dbt_tmp"
    
20:19:08.299335 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
20:19:08.300917 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:19:08.301130 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:08.339688 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:08.342336 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:19:08.342601 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:08.506659 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.87 seconds
20:19:08.508300 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:19:08.508494 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:08.548432 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:08.551265 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:19:08.551479 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:19:08.554297 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:19:08.554467 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr'
      and table_schema = 'stg'
  
20:19:08.551621 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:08.562490 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.65 seconds
20:19:08.563957 [debug] [Thread-1  ]: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: COMMIT
20:19:08.564663 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
20:19:08.564791 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    end

20:19:08.601780 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:08.611824 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:19:08.615861 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:19:08.616102 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:08.620877 [debug] [Thread-1  ]: finished collecting timing info
20:19:08.621152 [debug] [Thread-1  ]: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: Close
20:19:08.621836 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654324c0>]}
20:19:08.622289 [info ] [Thread-1  ]: 23 of 101 OK snapshotted stg.AH_DailyhuntEmailSubscribers_Incr.................. [[32mOK[0m in 13.82s]
20:19:08.622660 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr
20:19:08.622814 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Eventproperties_Incr
20:19:08.623177 [info ] [Thread-1  ]: 27 of 101 START snapshot stg.AH_Eventproperties_Incr............................ [RUN]
20:19:08.623560 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Eventproperties_Incr"
20:19:08.623673 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Eventproperties_Incr
20:19:08.623770 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Eventproperties_Incr
20:19:08.626497 [debug] [Thread-1  ]: finished collecting timing info
20:19:08.626696 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Eventproperties_Incr
20:19:08.629646 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:08.629787 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:19:08.629870 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:19:08.629968 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:19:08.654773 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:08.656297 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:19:08.656495 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    
20:19:08.755269 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:19:08.757448 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Decorations_Incr"
20:19:08.757934 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:19:08.758076 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Decorations_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Decorations_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Decorations_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Decorations_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Decorations_Incr" (
                  "ID", "PayToproceed", "CreatedOn", "UpdatedOn", "DeletedOn", "ValIDFields", "Description", "LastUpdatedUser", "Name", "FormatString", "Amount", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "PayToproceed", "CreatedOn", "UpdatedOn", "DeletedOn", "ValIDFields", "Description", "LastUpdatedUser", "Name", "FormatString", "Amount", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Decorations_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:19:08.765370 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:19:08.819234 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:19:08.842466 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:08.842788 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:19:08.872896 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:19:08.875519 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:08.875732 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Eventproperties_InterView]
        ) as __dbt_sbq
    
20:19:08.940721 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:19:08.964351 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:08.964642 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr"
        ) as __dbt_sbq
    
20:19:09.029726 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:19:09.033128 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:09.033398 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr'
      and table_schema = 'stg'
  
20:19:09.117197 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:19:09.121083 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:09.121325 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
        
  
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Eventproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Eventproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Eventproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Eventproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Eventproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:19:08.849863'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:19:08.849863'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:19:08.849863''), CONVERT(DATETIME2, ''2022-09-26 20:19:08.849863'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:19:08.849863'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:19:08.849863'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:19:08.849863'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:19:08.849863'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Eventproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Eventproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Eventproperties_Incr__dbt_tmp_temp_view"
    end



    
20:19:09.565200 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.91 seconds
20:19:09.566824 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:19:09.567007 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:09.605203 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:09.607743 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:19:09.607959 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:10.107965 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.50 seconds
20:19:10.110176 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Emailtemplatecontents_Incr"
20:19:10.110651 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:19:10.110792 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr" (
                  "ID", "Name", "Culture", "SuBJect", "Body", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Culture", "SuBJect", "Body", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:19:10.587875 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.83 seconds
20:19:10.589437 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Decorations_Incr: COMMIT
20:19:10.590168 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
20:19:10.590294 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."#AH_Decorations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Decorations_Incr__dbt_tmp"
    end

20:19:10.635251 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:10.648939 [debug] [Thread-4  ]: finished collecting timing info
20:19:10.649261 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Decorations_Incr: Close
20:19:10.649987 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0165432610>]}
20:19:10.650459 [info ] [Thread-4  ]: 24 of 101 OK snapshotted stg.AH_Decorations_Incr................................ [[32mOK[0m in 14.75s]
20:19:10.650842 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Decorations_Incr
20:19:10.650991 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Events_Incr
20:19:10.651345 [info ] [Thread-4  ]: 28 of 101 START snapshot stg.AH_Events_Incr..................................... [RUN]
20:19:10.651719 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Events_Incr"
20:19:10.651829 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Events_Incr
20:19:10.651924 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Events_Incr
20:19:10.654733 [debug] [Thread-4  ]: finished collecting timing info
20:19:10.654894 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Events_Incr
20:19:10.657729 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:10.657885 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:19:10.658060 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:19:10.658173 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:19:10.783258 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:19:10.817394 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:19:10.841480 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:10.841779 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:19:10.868892 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:19:10.871099 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:10.871635 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Events_InterView]
        ) as __dbt_sbq
    
20:19:10.889727 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 5.66 seconds
20:19:10.893061 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:10.893276 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:10.966741 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:19:10.968521 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:10.968717 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    
20:19:10.987553 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:19:11.009900 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:11.010188 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Events_Incr"
        ) as __dbt_sbq
    
20:19:11.069091 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:19:11.072605 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:11.072841 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr'
      and table_schema = 'stg'
  
20:19:11.179660 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:19:11.183245 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:11.183489 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
        
  
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Events_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Events_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Events_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Events_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Events_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Events_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:19:10.849932'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:19:10.849932'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:19:10.849932''), CONVERT(DATETIME2, ''2022-09-26 20:19:10.849932'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:19:10.849932'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:19:10.849932'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:19:10.849932'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:19:10.849932'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Events_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Events_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Events_Incr__dbt_tmp_temp_view"
    end



    
20:19:11.723301 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.61 seconds
20:19:11.725021 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: COMMIT
20:19:11.725778 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
20:19:11.725914 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    end

20:19:11.771415 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:19:11.862850 [debug] [Thread-3  ]: finished collecting timing info
20:19:11.863117 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.89 seconds
20:19:11.864488 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:11.864657 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:11.863317 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: Close
20:19:11.865406 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654328b0>]}
20:19:11.865819 [info ] [Thread-3  ]: 25 of 101 OK snapshotted stg.AH_Emailtemplatecontents_Incr...................... [[32mOK[0m in 15.13s]
20:19:11.866116 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Emailtemplatecontents_Incr
20:19:11.866255 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ExternalUserIDs_Incr
20:19:11.866619 [info ] [Thread-3  ]: 29 of 101 START snapshot stg.AH_ExternalUserIDs_Incr............................ [RUN]
20:19:11.866986 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr"
20:19:11.867089 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ExternalUserIDs_Incr
20:19:11.867181 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ExternalUserIDs_Incr
20:19:11.869926 [debug] [Thread-3  ]: finished collecting timing info
20:19:11.870066 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ExternalUserIDs_Incr
20:19:11.872758 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:11.872892 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:19:11.872990 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:19:11.873090 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:19:11.933545 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:19:11.936235 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:11.936435 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:11.978584 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:19:12.006428 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:19:12.029668 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:12.029942 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:19:12.058150 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:19:12.060621 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:12.060814 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ExternalUserIDs_InterView]
        ) as __dbt_sbq
    
20:19:12.138607 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:19:12.153081 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:19:12.155748 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:12.155972 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr'
      and table_schema = 'stg'
  
20:19:12.165183 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:12.165404 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr"
        ) as __dbt_sbq
    
20:19:12.188671 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:19:12.193549 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:12.193779 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:12.230889 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:19:12.234945 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:12.235226 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr'
      and table_schema = 'stg'
  
20:19:12.246652 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:19:12.248028 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:12.248189 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    
20:19:12.320721 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:19:12.324262 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:12.324510 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
        
  
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ExternalUserIDs_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ExternalUserIDs_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:19:12.037511'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:19:12.037511'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:19:12.037511''), CONVERT(DATETIME2, ''2022-09-26 20:19:12.037511'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:19:12.037511'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:19:12.037511'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:19:12.037511'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:19:12.037511'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ProvIDErName != source_data.ProvIDErName
        or
        (
            ((snapshotted_data.ProvIDErName is null) and not (source_data.ProvIDErName is null))
            or
            ((not snapshotted_data.ProvIDErName is null) and (source_data.ProvIDErName is null))
        ) or snapshotted_data.ProvIDErUserID != source_data.ProvIDErUserID
        or
        (
            ((snapshotted_data.ProvIDErUserID is null) and not (source_data.ProvIDErUserID is null))
            or
            ((not snapshotted_data.ProvIDErUserID is null) and (source_data.ProvIDErUserID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LocalUserID != source_data.LocalUserID
        or
        (
            ((snapshotted_data.LocalUserID is null) and not (source_data.LocalUserID is null))
            or
            ((not snapshotted_data.LocalUserID is null) and (source_data.LocalUserID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ProvIDErName != source_data.ProvIDErName
        or
        (
            ((snapshotted_data.ProvIDErName is null) and not (source_data.ProvIDErName is null))
            or
            ((not snapshotted_data.ProvIDErName is null) and (source_data.ProvIDErName is null))
        ) or snapshotted_data.ProvIDErUserID != source_data.ProvIDErUserID
        or
        (
            ((snapshotted_data.ProvIDErUserID is null) and not (source_data.ProvIDErUserID is null))
            or
            ((not snapshotted_data.ProvIDErUserID is null) and (source_data.ProvIDErUserID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LocalUserID != source_data.LocalUserID
        or
        (
            ((snapshotted_data.LocalUserID is null) and not (source_data.LocalUserID is null))
            or
            ((not snapshotted_data.LocalUserID is null) and (source_data.LocalUserID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ExternalUserIDs_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_temp_view"
    end



    
20:19:13.110576 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.86 seconds
20:19:13.112190 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:13.112387 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:13.147347 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:19:13.149730 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:13.149953 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:13.378826 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:19:13.381789 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:13.382005 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr'
      and table_schema = 'stg'
  
20:19:13.426661 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:13.430772 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:13.431009 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:13.481380 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:19:13.482905 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:13.483108 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    
20:19:14.426369 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
20:19:14.428042 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:14.428231 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:14.468894 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:14.471300 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:14.471483 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:14.671878 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:19:14.674011 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Emailtemplates_Incr"
20:19:14.674462 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:14.674646 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Emailtemplates_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr" (
                  "ID", "Enabled", "UpdatedOn", "DeletedOn", "CreatedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Enabled", "UpdatedOn", "DeletedOn", "CreatedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Emailtemplates_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:19:15.634308 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 4.45 seconds
20:19:15.637684 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:15.637867 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:15.679309 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:15.680873 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:15.681048 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Events_Incr__dbt_tmp"
    
20:19:15.941601 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.27 seconds
20:19:15.943341 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Emailtemplates_Incr: COMMIT
20:19:15.944276 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
20:19:15.944407 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."#AH_Emailtemplates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    end

20:19:16.006940 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:19:16.021006 [debug] [Thread-2  ]: finished collecting timing info
20:19:16.021341 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Emailtemplates_Incr: Close
20:19:16.022095 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0165432760>]}
20:19:16.022602 [info ] [Thread-2  ]: 26 of 101 OK snapshotted stg.AH_Emailtemplates_Incr............................. [[32mOK[0m in 11.34s]
20:19:16.022938 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Emailtemplates_Incr
20:19:16.023081 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Feedbacks_Incr
20:19:16.023438 [info ] [Thread-2  ]: 30 of 101 START snapshot stg.AH_Feedbacks_Incr.................................. [RUN]
20:19:16.023814 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Feedbacks_Incr"
20:19:16.023922 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Feedbacks_Incr
20:19:16.024018 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Feedbacks_Incr
20:19:16.026767 [debug] [Thread-2  ]: finished collecting timing info
20:19:16.026919 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Feedbacks_Incr
20:19:16.029690 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:16.029857 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:19:16.029942 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:19:16.030042 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:19:16.236157 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:19:16.264066 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:19:16.292347 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:16.292617 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:19:16.331778 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:16.334009 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:16.334606 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Feedbacks_InterView]
        ) as __dbt_sbq
    
20:19:16.399496 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:19:16.422243 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:16.422503 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr"
        ) as __dbt_sbq
    
20:19:16.480175 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:19:16.483857 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:16.484068 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr'
      and table_schema = 'stg'
  
20:19:16.557940 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:19:16.561872 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:16.562066 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
        
  
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feedbacks_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Feedbacks_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feedbacks_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Feedbacks_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Feedbacks_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:19:16.303093'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:19:16.303093'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:19:16.303093''), CONVERT(DATETIME2, ''2022-09-26 20:19:16.303093'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:19:16.303093'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:19:16.303093'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:19:16.303093'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:19:16.303093'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SEndingUserID != source_data.SEndingUserID
        or
        (
            ((snapshotted_data.SEndingUserID is null) and not (source_data.SEndingUserID is null))
            or
            ((not snapshotted_data.SEndingUserID is null) and (source_data.SEndingUserID is null))
        ) or snapshotted_data.ReceivINgUserID != source_data.ReceivINgUserID
        or
        (
            ((snapshotted_data.ReceivINgUserID is null) and not (source_data.ReceivINgUserID is null))
            or
            ((not snapshotted_data.ReceivINgUserID is null) and (source_data.ReceivINgUserID is null))
        ) or snapshotted_data.Rating != source_data.Rating
        or
        (
            ((snapshotted_data.Rating is null) and not (source_data.Rating is null))
            or
            ((not snapshotted_data.Rating is null) and (source_data.Rating is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.ListingOwnerUserName != source_data.ListingOwnerUserName
        or
        (
            ((snapshotted_data.ListingOwnerUserName is null) and not (source_data.ListingOwnerUserName is null))
            or
            ((not snapshotted_data.ListingOwnerUserName is null) and (source_data.ListingOwnerUserName is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SEndingUserID != source_data.SEndingUserID
        or
        (
            ((snapshotted_data.SEndingUserID is null) and not (source_data.SEndingUserID is null))
            or
            ((not snapshotted_data.SEndingUserID is null) and (source_data.SEndingUserID is null))
        ) or snapshotted_data.ReceivINgUserID != source_data.ReceivINgUserID
        or
        (
            ((snapshotted_data.ReceivINgUserID is null) and not (source_data.ReceivINgUserID is null))
            or
            ((not snapshotted_data.ReceivINgUserID is null) and (source_data.ReceivINgUserID is null))
        ) or snapshotted_data.Rating != source_data.Rating
        or
        (
            ((snapshotted_data.Rating is null) and not (source_data.Rating is null))
            or
            ((not snapshotted_data.Rating is null) and (source_data.Rating is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.ListingOwnerUserName != source_data.ListingOwnerUserName
        or
        (
            ((snapshotted_data.ListingOwnerUserName is null) and not (source_data.ListingOwnerUserName is null))
            or
            ((not snapshotted_data.ListingOwnerUserName is null) and (source_data.ListingOwnerUserName is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Feedbacks_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Feedbacks_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feedbacks_Incr__dbt_tmp_temp_view"
    end



    
20:19:17.034934 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.35 seconds
20:19:17.036600 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:17.036790 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:17.164913 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:19:17.167860 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:17.168132 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:17.422913 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:19:17.426067 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:17.426248 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr'
      and table_schema = 'stg'
  
20:19:17.474711 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:19:17.478911 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:17.479134 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:17.560392 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:19:17.561877 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:17.562050 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Events_Incr__dbt_tmp"
    
20:19:18.876471 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.55 seconds
20:19:18.879756 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:18.879963 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:18.954116 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:19:18.955674 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:18.955855 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    
20:19:19.221364 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.66 seconds
20:19:19.223208 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:19.223479 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:19.264852 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:19.267507 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:19.267754 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:19.522265 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 10.40 seconds
20:19:19.526791 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:19.526977 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:19.587431 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:19:19.589025 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:19.589215 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Eventproperties_Incr__dbt_tmp"
    
20:19:19.612040 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
20:19:19.615255 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:19.615468 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr'
      and table_schema = 'stg'
  
20:19:19.669756 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:19:19.674214 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:19.674446 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:19.711126 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:19.712682 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:19.712872 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Events_Incr__dbt_tmp"
    
20:19:20.110371 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
20:19:20.112029 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:20.112193 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:20.186485 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:19:20.189073 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:20.189262 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:20.374999 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:19:20.377953 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:20.378132 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr'
      and table_schema = 'stg'
  
20:19:20.429368 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:19:20.433281 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:20.433469 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:20.498677 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:19:20.500174 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:20.500358 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    
20:19:20.637325 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
20:19:20.639011 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:20.639203 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:20.670991 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
20:19:20.672626 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:20.672828 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:20.710501 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:20.713360 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:20.713560 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:20.721943 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:19:20.724256 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:20.724417 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:20.927365 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:19:20.929514 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Events_Incr"
20:19:20.929939 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:20.930066 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Events_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Events_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Events_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Events_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Events_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Events_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:19:20.934303 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:19:20.936916 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:20.937058 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr'
      and table_schema = 'stg'
  
20:19:20.989381 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:19:20.993815 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:20.994019 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:21.028272 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:19:21.029728 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:21.029906 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Eventproperties_Incr__dbt_tmp"
    
20:19:21.375945 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
20:19:21.377593 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:21.377773 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:21.443555 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:19:21.446050 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:21.446238 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:21.650377 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:19:21.653473 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:21.653673 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr'
      and table_schema = 'stg'
  
20:19:21.687918 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:19:21.692157 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:21.692346 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:21.731814 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:21.733339 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:21.733515 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    
20:19:22.032198 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.00 seconds
20:19:22.033806 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:22.033979 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:22.079925 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:19:22.082663 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:22.082863 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:22.279999 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.35 seconds
20:19:22.281911 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Events_Incr: COMMIT
20:19:22.283683 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
20:19:22.283837 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."#AH_Events_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Events_Incr__dbt_tmp"
    end

20:19:22.310704 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:19:22.313528 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:22.313737 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr'
      and table_schema = 'stg'
  
20:19:22.356455 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:19:22.371187 [debug] [Thread-4  ]: finished collecting timing info
20:19:22.371527 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Events_Incr: Close
20:19:22.372281 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0165432b50>]}
20:19:22.376341 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:19:22.380478 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:22.380656 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:22.453245 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:19:22.454829 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:22.455020 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Eventproperties_Incr__dbt_tmp"
    
20:19:22.572709 [info ] [Thread-4  ]: 28 of 101 OK snapshotted stg.AH_Events_Incr..................................... [[32mOK[0m in 11.72s]
20:19:22.573553 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Events_Incr
20:19:22.573735 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Feeproperties_Incr
20:19:22.574123 [info ] [Thread-4  ]: 31 of 101 START snapshot stg.AH_Feeproperties_Incr.............................. [RUN]
20:19:22.574668 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Feeproperties_Incr"
20:19:22.574817 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Feeproperties_Incr
20:19:22.574933 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Feeproperties_Incr
20:19:22.577962 [debug] [Thread-4  ]: finished collecting timing info
20:19:22.578130 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Feeproperties_Incr
20:19:22.581099 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:19:22.581238 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:19:22.581321 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:19:22.581441 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:19:22.628194 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.89 seconds
20:19:22.629761 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:22.629918 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:22.666197 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:22.668511 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:22.668677 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:22.697318 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:19:22.725807 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:19:22.749445 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:19:22.749669 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:19:22.777777 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:19:22.779953 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:19:22.780145 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Feeproperties_InterView]
        ) as __dbt_sbq
    
20:19:22.851720 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:19:22.873996 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:19:22.874256 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr"
        ) as __dbt_sbq
    
20:19:22.878531 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:19:22.880224 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ExternalUserIDs_Incr"
20:19:22.880570 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:22.880673 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ExternalUserIDs_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr" (
                  "ID", "ProvIDErName", "ProvIDErUserID", "CreatedOn", "UpdatedOn", "DeletedOn", "LocalUserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "ProvIDErName", "ProvIDErUserID", "CreatedOn", "UpdatedOn", "DeletedOn", "LocalUserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:19:22.926856 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:19:22.930498 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:19:22.930744 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr'
      and table_schema = 'stg'
  
20:19:23.001279 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:19:23.004891 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:19:23.005078 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
        
  
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feeproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Feeproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feeproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Feeproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Feeproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:19:22.756359'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:19:22.756359'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:19:22.756359''), CONVERT(DATETIME2, ''2022-09-26 20:19:22.756359'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:19:22.756359'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:19:22.756359'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:19:22.756359'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:19:22.756359'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Processor != source_data.Processor
        or
        (
            ((snapshotted_data.Processor is null) and not (source_data.Processor is null))
            or
            ((not snapshotted_data.Processor is null) and (source_data.Processor is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Processor != source_data.Processor
        or
        (
            ((snapshotted_data.Processor is null) and not (source_data.Processor is null))
            or
            ((not snapshotted_data.Processor is null) and (source_data.Processor is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Feeproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Feeproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feeproperties_Incr__dbt_tmp_temp_view"
    end



    
20:19:23.733232 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.28 seconds
20:19:23.734813 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:23.734989 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:23.787787 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:19:23.790956 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:23.791166 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:24.094897 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:19:24.097041 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Eventproperties_Incr"
20:19:24.097456 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:24.097576 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Eventproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr" (
                  "ID", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "DecimalnativeValue", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "BoolnativeValue", "IntnativeValue", "AuctionEventID", "CustomFieldID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "DecimalnativeValue", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "BoolnativeValue", "IntnativeValue", "AuctionEventID", "CustomFieldID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Eventproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:19:24.369636 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.49 seconds
20:19:24.371360 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ExternalUserIDs_Incr: COMMIT
20:19:24.372145 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
20:19:24.372284 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    end

20:19:24.413600 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:24.426759 [debug] [Thread-3  ]: finished collecting timing info
20:19:24.427073 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ExternalUserIDs_Incr: Close
20:19:24.427789 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0165432ca0>]}
20:19:24.428253 [info ] [Thread-3  ]: 29 of 101 OK snapshotted stg.AH_ExternalUserIDs_Incr............................ [[32mOK[0m in 12.56s]
20:19:24.428574 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ExternalUserIDs_Incr
20:19:24.428722 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Feeschedules_Incr
20:19:24.429062 [info ] [Thread-3  ]: 32 of 101 START snapshot stg.AH_Feeschedules_Incr............................... [RUN]
20:19:24.429439 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Feeschedules_Incr"
20:19:24.429551 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Feeschedules_Incr
20:19:24.429646 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Feeschedules_Incr
20:19:24.432462 [debug] [Thread-3  ]: finished collecting timing info
20:19:24.432615 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Feeschedules_Incr
20:19:24.435412 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:19:24.435546 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:19:24.435629 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:19:24.435728 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:19:24.552990 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:19:24.586208 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:19:24.609248 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:19:24.609525 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:19:24.651389 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:24.653632 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:19:24.653824 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Feeschedules_InterView]
        ) as __dbt_sbq
    
20:19:24.714800 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:19:24.738104 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:19:24.738381 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr"
        ) as __dbt_sbq
    
20:19:24.790839 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:19:24.794391 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:19:24.794640 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr'
      and table_schema = 'stg'
  
20:19:24.876598 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:19:24.880593 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:19:24.880825 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
        
  
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feeschedules_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Feeschedules_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feeschedules_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Feeschedules_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Feeschedules_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:19:24.631393'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:19:24.631393'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:19:24.631393''), CONVERT(DATETIME2, ''2022-09-26 20:19:24.631393'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:19:24.631393'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:19:24.631393'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:19:24.631393'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:19:24.631393'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Feeschedules_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Feeschedules_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feeschedules_Incr__dbt_tmp_temp_view"
    end



    
20:19:24.912797 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 8.35 seconds
20:19:24.916476 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:24.916696 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:24.953613 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:24.955216 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:24.955416 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feedbacks_Incr__dbt_tmp"
    
20:19:25.456889 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.36 seconds
20:19:25.458677 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Eventproperties_Incr: COMMIT
20:19:25.459416 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
20:19:25.459547 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."#AH_Eventproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Eventproperties_Incr__dbt_tmp"
    end

20:19:25.497298 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:25.510701 [debug] [Thread-1  ]: finished collecting timing info
20:19:25.511009 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Eventproperties_Incr: Close
20:19:25.511710 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01642ee670>]}
20:19:25.512170 [info ] [Thread-1  ]: 27 of 101 OK snapshotted stg.AH_Eventproperties_Incr............................ [[32mOK[0m in 16.89s]
20:19:25.512485 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Eventproperties_Incr
20:19:25.512628 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ImportedCategoryMap_Incr
20:19:25.512969 [info ] [Thread-1  ]: 33 of 101 START snapshot stg.AH_ImportedCategoryMap_Incr........................ [RUN]
20:19:25.513343 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr"
20:19:25.513453 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ImportedCategoryMap_Incr
20:19:25.513565 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ImportedCategoryMap_Incr
20:19:25.516317 [debug] [Thread-1  ]: finished collecting timing info
20:19:25.516469 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ImportedCategoryMap_Incr
20:19:25.519268 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:19:25.519407 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:19:25.519489 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:19:25.519585 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:19:25.632569 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:19:25.665398 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:19:25.689417 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:19:25.689702 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:19:25.729338 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:25.731590 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:19:25.731802 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ImportedCategoryMap_InterView]
        ) as __dbt_sbq
    
20:19:25.786140 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:19:25.809664 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:19:25.809949 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr"
        ) as __dbt_sbq
    
20:19:25.877120 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:19:25.880483 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:19:25.880664 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr'
      and table_schema = 'stg'
  
20:19:25.916389 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
20:19:25.918367 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:25.918605 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:25.951294 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:19:25.954703 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:19:25.954910 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
        
  
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ImportedCategoryMap_InterView]

    ),

    snapshotted_data as (

        select *,
            LocalCategoryID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LocalCategoryID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:19:25.693918'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:19:25.693918'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:19:25.693918''), CONVERT(DATETIME2, ''2022-09-26 20:19:25.693918'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(LocalCategoryID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:19:25.693918'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LocalCategoryID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:19:25.693918'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:19:25.693918'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:19:25.693918'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.LocalCategoryID != source_data.LocalCategoryID
        or
        (
            ((snapshotted_data.LocalCategoryID is null) and not (source_data.LocalCategoryID is null))
            or
            ((not snapshotted_data.LocalCategoryID is null) and (source_data.LocalCategoryID is null))
        ) or snapshotted_data.ForeignCategoryID != source_data.ForeignCategoryID
        or
        (
            ((snapshotted_data.ForeignCategoryID is null) and not (source_data.ForeignCategoryID is null))
            or
            ((not snapshotted_data.ForeignCategoryID is null) and (source_data.ForeignCategoryID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.LocalCategoryID != source_data.LocalCategoryID
        or
        (
            ((snapshotted_data.LocalCategoryID is null) and not (source_data.LocalCategoryID is null))
            or
            ((not snapshotted_data.LocalCategoryID is null) and (source_data.LocalCategoryID is null))
        ) or snapshotted_data.ForeignCategoryID != source_data.ForeignCategoryID
        or
        (
            ((snapshotted_data.ForeignCategoryID is null) and not (source_data.ForeignCategoryID is null))
            or
            ((not snapshotted_data.ForeignCategoryID is null) and (source_data.ForeignCategoryID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view"
    end



    
20:19:25.981474 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:19:25.984204 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:25.984401 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:26.227621 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:19:26.231534 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:26.231773 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr'
      and table_schema = 'stg'
  
20:19:26.293171 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:19:26.297744 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:26.297995 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:26.336972 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:26.338640 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:26.338848 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feedbacks_Incr__dbt_tmp"
    
20:19:27.174009 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.83 seconds
20:19:27.175670 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:27.175852 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:27.217485 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:27.220128 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:27.220327 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:27.480945 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:19:27.484697 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:27.484899 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr'
      and table_schema = 'stg'
  
20:19:27.524228 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:27.528997 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:27.529259 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:27.591633 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:19:27.593186 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:27.593386 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feedbacks_Incr__dbt_tmp"
    
20:19:28.719805 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.13 seconds
20:19:28.721419 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:28.721612 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:19:28.758930 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:28.761652 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:28.761881 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:28.972621 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:19:28.974931 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Feedbacks_Incr"
20:19:28.975391 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:19:28.975524 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Feedbacks_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr" (
                  "ID", "SEndingUserID", "ReceivINgUserID", "Rating", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Comment", "LastUpdatedUser", "ListingOwnerUserName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SEndingUserID", "ReceivINgUserID", "Rating", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Comment", "LastUpdatedUser", "ListingOwnerUserName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Feedbacks_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:19:28.982986 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.03 seconds
20:19:28.986304 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:19:28.986520 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:19:29.025508 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:19:29.027328 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:19:29.027529 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    
20:20:27.461142 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 58.43 seconds
20:20:27.463010 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:20:27.463239 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:27.473768 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 58.50 seconds
20:20:27.475398 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Feedbacks_Incr: COMMIT
20:20:27.476155 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
20:20:27.476289 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."#AH_Feedbacks_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feedbacks_Incr__dbt_tmp"
    end

20:20:27.518780 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:27.533267 [debug] [Thread-2  ]: finished collecting timing info
20:20:27.533603 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Feedbacks_Incr: Close
20:20:27.534389 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0165432df0>]}
20:20:27.534934 [info ] [Thread-2  ]: 30 of 101 OK snapshotted stg.AH_Feedbacks_Incr.................................. [[32mOK[0m in 71.51s]
20:20:27.535268 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Feedbacks_Incr
20:20:27.535422 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ImportedListingsMap_Incr
20:20:27.535776 [info ] [Thread-2  ]: 34 of 101 START snapshot stg.AH_ImportedListingsMap_Incr........................ [RUN]
20:20:27.536185 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr"
20:20:27.536295 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ImportedListingsMap_Incr
20:20:27.536394 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ImportedListingsMap_Incr
20:20:27.539385 [debug] [Thread-2  ]: finished collecting timing info
20:20:27.539549 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ImportedListingsMap_Incr
20:20:27.542531 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:27.542716 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:20:27.542800 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:20:27.542899 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:20:27.546787 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:20:27.549333 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:20:27.549522 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:27.609277 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 64.60 seconds
20:20:27.612960 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:20:27.613213 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:27.652985 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:27.654514 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:20:27.654712 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeproperties_Incr__dbt_tmp"
    
20:20:27.660464 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:20:27.712794 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:20:27.735843 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:27.736131 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:20:27.758744 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:20:27.761971 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:20:27.762354 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr'
      and table_schema = 'stg'
  
20:20:27.764253 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:20:27.766788 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:27.766955 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ImportedListingsMap_InterView]
        ) as __dbt_sbq
    
20:20:27.839060 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:20:27.843221 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:20:27.843471 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:27.857371 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:20:27.880046 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:27.880325 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr"
        ) as __dbt_sbq
    
20:20:27.887746 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:27.889244 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:20:27.889448 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    
20:20:27.941765 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:20:27.945227 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:27.945459 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr'
      and table_schema = 'stg'
  
20:20:28.021910 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:20:28.025073 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:28.025279 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
        
  
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ImportedListingsMap_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ImportedListingsMap_InterView]

    ),

    snapshotted_data as (

        select *,
            LoCallistingID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LoCallistingID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:20:27.741669'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:20:27.741669'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:20:27.741669''), CONVERT(DATETIME2, ''2022-09-26 20:20:27.741669'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(LoCallistingID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:20:27.741669'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LoCallistingID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:20:27.741669'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:20:27.741669'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:20:27.741669'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.LoCallistingID != source_data.LoCallistingID
        or
        (
            ((snapshotted_data.LoCallistingID is null) and not (source_data.LoCallistingID is null))
            or
            ((not snapshotted_data.LoCallistingID is null) and (source_data.LoCallistingID is null))
        ) or snapshotted_data.ForeignListingID != source_data.ForeignListingID
        or
        (
            ((snapshotted_data.ForeignListingID is null) and not (source_data.ForeignListingID is null))
            or
            ((not snapshotted_data.ForeignListingID is null) and (source_data.ForeignListingID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.LoCallistingID != source_data.LoCallistingID
        or
        (
            ((snapshotted_data.LoCallistingID is null) and not (source_data.LoCallistingID is null))
            or
            ((not snapshotted_data.LoCallistingID is null) and (source_data.LoCallistingID is null))
        ) or snapshotted_data.ForeignListingID != source_data.ForeignListingID
        or
        (
            ((snapshotted_data.ForeignListingID is null) and not (source_data.ForeignListingID is null))
            or
            ((not snapshotted_data.ForeignListingID is null) and (source_data.ForeignListingID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ImportedListingsMap_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_temp_view"
    end



    
20:20:28.831807 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.18 seconds
20:20:28.833329 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:20:28.833524 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:28.850337 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
20:20:28.851854 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:20:28.852056 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:28.887348 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:28.891376 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:20:28.891631 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:28.910900 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:20:28.913386 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:20:28.913591 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:29.159501 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:20:29.162314 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:20:29.162512 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr'
      and table_schema = 'stg'
  
20:20:29.170024 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:20:29.173123 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:20:29.173349 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr'
      and table_schema = 'stg'
  
20:20:29.197004 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:20:29.201116 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:20:29.201352 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:29.262050 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:20:29.266149 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:20:29.266387 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:29.266628 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:20:29.267832 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:20:29.267972 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    
20:20:29.327942 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:20:29.329424 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:20:29.329613 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeproperties_Incr__dbt_tmp"
    
20:20:29.907830 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 65.03 seconds
20:20:29.911337 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:20:29.911600 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:29.950107 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:29.951697 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:20:29.951878 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeschedules_Incr__dbt_tmp"
    
20:20:30.482340 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.21 seconds
20:20:30.484006 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:20:30.484195 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:30.484802 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
20:20:30.486105 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:20:30.486269 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:30.526385 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:30.528922 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:20:30.529132 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:30.534077 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:20:30.536464 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:20:30.536667 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:30.713038 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:20:30.715316 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ImportedCategoryMap_Incr"
20:20:30.715774 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:20:30.715897 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr" (
                  "LocalCategoryID", "ForeignCategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "LocalCategoryID", "ForeignCategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:20:30.729445 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:20:30.732268 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:20:30.732505 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr'
      and table_schema = 'stg'
  
20:20:30.765084 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:20:30.769561 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:20:30.769804 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:30.809055 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:30.810935 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:20:30.811139 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeproperties_Incr__dbt_tmp"
    
20:20:31.034576 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.08 seconds
20:20:31.036060 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:20:31.036251 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:31.129165 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:20:31.131697 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:20:31.131941 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:31.339595 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:20:31.342498 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:20:31.342769 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr'
      and table_schema = 'stg'
  
20:20:31.415860 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:20:31.420102 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:20:31.420342 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:31.424309 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.40 seconds
20:20:31.427479 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:31.427693 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:31.462317 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:31.463826 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:20:31.464090 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeschedules_Incr__dbt_tmp"
    
20:20:31.465575 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:31.466729 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:31.466862 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    
20:20:32.019878 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.21 seconds
20:20:32.021557 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:20:32.021746 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:32.062635 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:32.065205 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:20:32.065419 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:32.239631 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:20:32.242023 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Feeproperties_Incr"
20:20:32.242512 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:20:32.242742 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Feeproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr" (
                  "ID", "Processor", "Name", "Description", "Amount", "CreatedOn", "UpdatedOn", "DeletedOn", "ListingTypeID", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Processor", "Name", "Description", "Amount", "CreatedOn", "UpdatedOn", "DeletedOn", "ListingTypeID", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Feeproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:20:32.258375 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.54 seconds
20:20:32.259986 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: COMMIT
20:20:32.263155 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
20:20:32.263335 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    end

20:20:32.300962 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:32.314517 [debug] [Thread-1  ]: finished collecting timing info
20:20:32.314878 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: Close
20:20:32.315661 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0164223b80>]}
20:20:32.316149 [info ] [Thread-1  ]: 33 of 101 OK snapshotted stg.AH_ImportedCategoryMap_Incr........................ [[32mOK[0m in 66.80s]
20:20:32.316479 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ImportedCategoryMap_Incr
20:20:32.316636 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ImportedUserMap_Incr
20:20:32.316991 [info ] [Thread-1  ]: 35 of 101 START snapshot stg.AH_ImportedUserMap_Incr............................ [RUN]
20:20:32.317383 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr"
20:20:32.317492 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ImportedUserMap_Incr
20:20:32.317588 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ImportedUserMap_Incr
20:20:32.320528 [debug] [Thread-1  ]: finished collecting timing info
20:20:32.320702 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ImportedUserMap_Incr
20:20:32.323882 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:32.324042 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:20:32.324130 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:20:32.324231 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:20:32.450257 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:20:32.484088 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:20:32.507503 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:32.507800 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:20:32.510577 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
20:20:32.511966 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:20:32.512142 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:32.534462 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:20:32.536985 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.07 seconds
20:20:32.538241 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:32.538384 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:32.539270 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:32.539400 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ImportedUserMap_InterView]
        ) as __dbt_sbq
    
20:20:32.580637 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:20:32.583307 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:20:32.583524 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:32.590944 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:20:32.613955 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:32.614256 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:20:32.616426 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:32.616621 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:32.614422 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr"
        ) as __dbt_sbq
    
20:20:32.681908 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:20:32.685919 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:32.686166 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr'
      and table_schema = 'stg'
  
20:20:32.760773 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:20:32.764596 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:32.764859 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
        
  
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedUserMap_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ImportedUserMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ImportedUserMap_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ImportedUserMap_InterView]

    ),

    snapshotted_data as (

        select *,
            LocalUserID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LocalUserID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:20:32.507343'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:20:32.507343'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:20:32.507343''), CONVERT(DATETIME2, ''2022-09-26 20:20:32.507343'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(LocalUserID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:20:32.507343'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LocalUserID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:20:32.507343'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:20:32.507343'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:20:32.507343'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.LocalUserID != source_data.LocalUserID
        or
        (
            ((snapshotted_data.LocalUserID is null) and not (source_data.LocalUserID is null))
            or
            ((not snapshotted_data.LocalUserID is null) and (source_data.LocalUserID is null))
        ) or snapshotted_data.ForeignUserID != source_data.ForeignUserID
        or
        (
            ((snapshotted_data.ForeignUserID is null) and not (source_data.ForeignUserID is null))
            or
            ((not snapshotted_data.ForeignUserID is null) and (source_data.ForeignUserID is null))
        ) or snapshotted_data.ImportedUserName != source_data.ImportedUserName
        or
        (
            ((snapshotted_data.ImportedUserName is null) and not (source_data.ImportedUserName is null))
            or
            ((not snapshotted_data.ImportedUserName is null) and (source_data.ImportedUserName is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.LocalUserID != source_data.LocalUserID
        or
        (
            ((snapshotted_data.LocalUserID is null) and not (source_data.LocalUserID is null))
            or
            ((not snapshotted_data.LocalUserID is null) and (source_data.LocalUserID is null))
        ) or snapshotted_data.ForeignUserID != source_data.ForeignUserID
        or
        (
            ((snapshotted_data.ForeignUserID is null) and not (source_data.ForeignUserID is null))
            or
            ((not snapshotted_data.ForeignUserID is null) and (source_data.ForeignUserID is null))
        ) or snapshotted_data.ImportedUserName != source_data.ImportedUserName
        or
        (
            ((snapshotted_data.ImportedUserName is null) and not (source_data.ImportedUserName is null))
            or
            ((not snapshotted_data.ImportedUserName is null) and (source_data.ImportedUserName is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ImportedUserMap_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedUserMap_Incr__dbt_tmp_temp_view"
    end



    
20:20:32.825885 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:20:32.828848 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:20:32.829096 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr'
      and table_schema = 'stg'
  
20:20:32.899217 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
20:20:32.902360 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:32.902650 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr'
      and table_schema = 'stg'
  
20:20:32.907302 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:20:32.911654 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:20:32.911875 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:32.960362 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:20:32.961938 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:20:32.962131 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeschedules_Incr__dbt_tmp"
    
20:20:32.972591 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:20:32.976522 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:32.976767 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:33.015151 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:33.016564 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:33.016753 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    
20:20:34.067711 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
20:20:34.069283 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:34.069501 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:34.144644 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:20:34.147225 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:34.147436 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:34.334888 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:20:34.338375 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:34.338643 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr'
      and table_schema = 'stg'
  
20:20:34.389382 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:20:34.393713 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:34.393963 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:34.405426 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.44 seconds
20:20:34.406829 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:20:34.407000 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:34.449990 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:20:34.451620 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:34.451832 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    
20:20:34.467050 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:20:34.469800 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:20:34.470011 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:34.482017 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.24 seconds
20:20:34.483803 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Feeproperties_Incr: COMMIT
20:20:34.484627 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
20:20:34.484798 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."#AH_Feeproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feeproperties_Incr__dbt_tmp"
    end

20:20:34.520829 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:34.535806 [debug] [Thread-4  ]: finished collecting timing info
20:20:34.536146 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Feeproperties_Incr: Close
20:20:34.536909 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016544e0d0>]}
20:20:34.537378 [info ] [Thread-4  ]: 31 of 101 OK snapshotted stg.AH_Feeproperties_Incr.............................. [[32mOK[0m in 71.96s]
20:20:34.537712 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Feeproperties_Incr
20:20:34.537872 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ImportedregionMap_Incr
20:20:34.538220 [info ] [Thread-4  ]: 36 of 101 START snapshot stg.AH_ImportedregionMap_Incr.......................... [RUN]
20:20:34.538629 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr"
20:20:34.538751 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ImportedregionMap_Incr
20:20:34.538855 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ImportedregionMap_Incr
20:20:34.541859 [debug] [Thread-4  ]: finished collecting timing info
20:20:34.542018 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ImportedregionMap_Incr
20:20:34.545042 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:34.545193 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:20:34.545279 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:20:34.545383 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:20:34.667155 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:20:34.715193 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:20:34.717453 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Feeschedules_Incr"
20:20:34.717940 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:20:34.718081 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Feeschedules_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr" (
                  "ID", "PayToproceed", "CreatedOn", "UpdatedOn", "DeletedOn", "EventID", "ListingTypeID", "Description", "LastUpdatedUser", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "PayToproceed", "CreatedOn", "UpdatedOn", "DeletedOn", "EventID", "ListingTypeID", "Description", "LastUpdatedUser", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Feeschedules_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:20:34.720182 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:20:34.743553 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:34.743835 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:20:34.774584 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:20:34.776785 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:34.777022 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ImportedregionMap_InterView]
        ) as __dbt_sbq
    
20:20:34.836674 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:20:34.859286 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:34.859570 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr"
        ) as __dbt_sbq
    
20:20:34.906219 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:20:34.909850 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:34.910083 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr'
      and table_schema = 'stg'
  
20:20:35.005889 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:20:35.009852 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:35.010089 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
        
  
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedregionMap_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ImportedregionMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ImportedregionMap_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ImportedregionMap_InterView]

    ),

    snapshotted_data as (

        select *,
            LocalregionID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LocalregionID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:20:34.757371'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:20:34.757371'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:20:34.757371''), CONVERT(DATETIME2, ''2022-09-26 20:20:34.757371'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(LocalregionID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:20:34.757371'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LocalregionID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:20:34.757371'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:20:34.757371'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:20:34.757371'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.LocalregionID != source_data.LocalregionID
        or
        (
            ((snapshotted_data.LocalregionID is null) and not (source_data.LocalregionID is null))
            or
            ((not snapshotted_data.LocalregionID is null) and (source_data.LocalregionID is null))
        ) or snapshotted_data.ForeignregionID != source_data.ForeignregionID
        or
        (
            ((snapshotted_data.ForeignregionID is null) and not (source_data.ForeignregionID is null))
            or
            ((not snapshotted_data.ForeignregionID is null) and (source_data.ForeignregionID is null))
        ) or snapshotted_data.Foreignregiontier != source_data.Foreignregiontier
        or
        (
            ((snapshotted_data.Foreignregiontier is null) and not (source_data.Foreignregiontier is null))
            or
            ((not snapshotted_data.Foreignregiontier is null) and (source_data.Foreignregiontier is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.LocalregionID != source_data.LocalregionID
        or
        (
            ((snapshotted_data.LocalregionID is null) and not (source_data.LocalregionID is null))
            or
            ((not snapshotted_data.LocalregionID is null) and (source_data.LocalregionID is null))
        ) or snapshotted_data.ForeignregionID != source_data.ForeignregionID
        or
        (
            ((snapshotted_data.ForeignregionID is null) and not (source_data.ForeignregionID is null))
            or
            ((not snapshotted_data.ForeignregionID is null) and (source_data.ForeignregionID is null))
        ) or snapshotted_data.Foreignregiontier != source_data.Foreignregiontier
        or
        (
            ((snapshotted_data.Foreignregiontier is null) and not (source_data.Foreignregiontier is null))
            or
            ((not snapshotted_data.Foreignregiontier is null) and (source_data.Foreignregiontier is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ImportedregionMap_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedregionMap_Incr__dbt_tmp_temp_view"
    end



    
20:20:35.297924 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.85 seconds
20:20:35.299487 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:35.299669 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:35.336538 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:35.338964 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:35.339177 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:35.566102 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:20:35.568049 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ImportedListingsMap_Incr"
20:20:35.568519 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:35.568649 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ImportedListingsMap_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr" (
                  "LoCallistingID", "ForeignListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "LoCallistingID", "ForeignListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:20:36.260725 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.54 seconds
20:20:36.262431 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Feeschedules_Incr: COMMIT
20:20:36.263213 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
20:20:36.263341 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."#AH_Feeschedules_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feeschedules_Incr__dbt_tmp"
    end

20:20:36.305423 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:36.320158 [debug] [Thread-3  ]: finished collecting timing info
20:20:36.320502 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Feeschedules_Incr: Close
20:20:36.321298 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016544e220>]}
20:20:36.321788 [info ] [Thread-3  ]: 32 of 101 OK snapshotted stg.AH_Feeschedules_Incr............................... [[32mOK[0m in 71.89s]
20:20:36.322135 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Feeschedules_Incr
20:20:36.322291 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Increments_Incr
20:20:36.322682 [info ] [Thread-3  ]: 37 of 101 START snapshot stg.AH_Increments_Incr................................. [RUN]
20:20:36.323074 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Increments_Incr"
20:20:36.323183 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Increments_Incr
20:20:36.323279 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Increments_Incr
20:20:36.326133 [debug] [Thread-3  ]: finished collecting timing info
20:20:36.326292 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Increments_Incr
20:20:36.329184 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:36.329323 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:20:36.329406 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:20:36.329503 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:20:36.440831 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:20:36.472569 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.71 seconds
20:20:36.476168 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:36.476431 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:36.476715 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:20:36.499423 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:36.499715 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:20:36.515633 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:36.517049 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:36.517223 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    
20:20:36.529321 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:20:36.531646 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:36.531829 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Increments_InterView]
        ) as __dbt_sbq
    
20:20:36.587210 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:20:36.609768 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:36.610053 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Increments_Incr"
        ) as __dbt_sbq
    
20:20:36.668342 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:20:36.671875 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:36.672105 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr'
      and table_schema = 'stg'
  
20:20:36.754290 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:20:36.757765 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:36.757965 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
        
  
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Increments_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Increments_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Increments_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Increments_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Increments_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Increments_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:20:36.507338'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:20:36.507338'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:20:36.507338''), CONVERT(DATETIME2, ''2022-09-26 20:20:36.507338'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:20:36.507338'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:20:36.507338'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:20:36.507338'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:20:36.507338'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.PriceLevel != source_data.PriceLevel
        or
        (
            ((snapshotted_data.PriceLevel is null) and not (source_data.PriceLevel is null))
            or
            ((not snapshotted_data.PriceLevel is null) and (source_data.PriceLevel is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.PriceLevel != source_data.PriceLevel
        or
        (
            ((snapshotted_data.PriceLevel is null) and not (source_data.PriceLevel is null))
            or
            ((not snapshotted_data.PriceLevel is null) and (source_data.PriceLevel is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Increments_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Increments_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Increments_Incr__dbt_tmp_temp_view"
    end



    
20:20:36.937752 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.37 seconds
20:20:36.939401 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ImportedListingsMap_Incr: COMMIT
20:20:36.940110 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
20:20:36.940237 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    end

20:20:36.984428 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:36.999076 [debug] [Thread-2  ]: finished collecting timing info
20:20:36.999405 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ImportedListingsMap_Incr: Close
20:20:37.000171 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016544e370>]}
20:20:37.000638 [info ] [Thread-2  ]: 34 of 101 OK snapshotted stg.AH_ImportedListingsMap_Incr........................ [[32mOK[0m in 9.46s]
20:20:37.000956 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ImportedListingsMap_Incr
20:20:37.001108 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Invoices_Incr
20:20:37.001455 [info ] [Thread-2  ]: 38 of 101 START snapshot stg.AH_Invoices_Incr................................... [RUN]
20:20:37.001830 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Invoices_Incr"
20:20:37.001940 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Invoices_Incr
20:20:37.002033 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Invoices_Incr
20:20:37.004867 [debug] [Thread-2  ]: finished collecting timing info
20:20:37.005021 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Invoices_Incr
20:20:37.007886 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:20:37.008026 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:20:37.008109 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:20:37.008210 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:20:37.107170 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:20:37.169926 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:20:37.194242 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:20:37.194527 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:20:37.242933 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:20:37.245174 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:20:37.245719 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Invoices_InterView]
        ) as __dbt_sbq
    
20:20:37.343612 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:20:37.367374 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:20:37.367680 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Invoices_Incr"
        ) as __dbt_sbq
    
20:20:37.476574 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:20:37.476934 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
20:20:37.478374 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:37.478576 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:37.482080 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:20:37.482237 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr'
      and table_schema = 'stg'
  
20:20:37.564474 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:20:37.567359 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:37.567657 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:37.567959 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:20:37.572124 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:20:37.572363 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
        
  
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Invoices_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Invoices_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Invoices_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Invoices_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Invoices_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Invoices_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:20:37.210531'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:20:37.210531'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:20:37.210531''), CONVERT(DATETIME2, ''2022-09-26 20:20:37.210531'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:20:37.210531'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:20:37.210531'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:20:37.210531'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:20:37.210531'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Paiddttm != source_data.Paiddttm
        or
        (
            ((snapshotted_data.Paiddttm is null) and not (source_data.Paiddttm is null))
            or
            ((not snapshotted_data.Paiddttm is null) and (source_data.Paiddttm is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Createddttm != source_data.Createddttm
        or
        (
            ((snapshotted_data.Createddttm is null) and not (source_data.Createddttm is null))
            or
            ((not snapshotted_data.Createddttm is null) and (source_data.Createddttm is null))
        ) or snapshotted_data.Fulfilleddttm != source_data.Fulfilleddttm
        or
        (
            ((snapshotted_data.Fulfilleddttm is null) and not (source_data.Fulfilleddttm is null))
            or
            ((not snapshotted_data.Fulfilleddttm is null) and (source_data.Fulfilleddttm is null))
        ) or snapshotted_data.PropertybagID != source_data.PropertybagID
        or
        (
            ((snapshotted_data.PropertybagID is null) and not (source_data.PropertybagID is null))
            or
            ((not snapshotted_data.PropertybagID is null) and (source_data.PropertybagID is null))
        ) or snapshotted_data.ShippingOptionID != source_data.ShippingOptionID
        or
        (
            ((snapshotted_data.ShippingOptionID is null) and not (source_data.ShippingOptionID is null))
            or
            ((not snapshotted_data.ShippingOptionID is null) and (source_data.ShippingOptionID is null))
        ) or snapshotted_data.PayerID != source_data.PayerID
        or
        (
            ((snapshotted_data.PayerID is null) and not (source_data.PayerID is null))
            or
            ((not snapshotted_data.PayerID is null) and (source_data.PayerID is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.SalesTax != source_data.SalesTax
        or
        (
            ((snapshotted_data.SalesTax is null) and not (source_data.SalesTax is null))
            or
            ((not snapshotted_data.SalesTax is null) and (source_data.SalesTax is null))
        ) or snapshotted_data.BuyersPremiumPercent != source_data.BuyersPremiumPercent
        or
        (
            ((snapshotted_data.BuyersPremiumPercent is null) and not (source_data.BuyersPremiumPercent is null))
            or
            ((not snapshotted_data.BuyersPremiumPercent is null) and (source_data.BuyersPremiumPercent is null))
        ) or snapshotted_data.BuyersPremiumAmount != source_data.BuyersPremiumAmount
        or
        (
            ((snapshotted_data.BuyersPremiumAmount is null) and not (source_data.BuyersPremiumAmount is null))
            or
            ((not snapshotted_data.BuyersPremiumAmount is null) and (source_data.BuyersPremiumAmount is null))
        ) or snapshotted_data.ShippingAmount != source_data.ShippingAmount
        or
        (
            ((snapshotted_data.ShippingAmount is null) and not (source_data.ShippingAmount is null))
            or
            ((not snapshotted_data.ShippingAmount is null) and (source_data.ShippingAmount is null))
        ) or snapshotted_data.SubTotal != source_data.SubTotal
        or
        (
            ((snapshotted_data.SubTotal is null) and not (source_data.SubTotal is null))
            or
            ((not snapshotted_data.SubTotal is null) and (source_data.SubTotal is null))
        ) or snapshotted_data.Total != source_data.Total
        or
        (
            ((snapshotted_data.Total is null) and not (source_data.Total is null))
            or
            ((not snapshotted_data.Total is null) and (source_data.Total is null))
        ) or snapshotted_data.IsPayerLocked != source_data.IsPayerLocked
        or
        (
            ((snapshotted_data.IsPayerLocked is null) and not (source_data.IsPayerLocked is null))
            or
            ((not snapshotted_data.IsPayerLocked is null) and (source_data.IsPayerLocked is null))
        ) or snapshotted_data.Shipped != source_data.Shipped
        or
        (
            ((snapshotted_data.Shipped is null) and not (source_data.Shipped is null))
            or
            ((not snapshotted_data.Shipped is null) and (source_data.Shipped is null))
        ) or snapshotted_data.IsArchived != source_data.IsArchived
        or
        (
            ((snapshotted_data.IsArchived is null) and not (source_data.IsArchived is null))
            or
            ((not snapshotted_data.IsArchived is null) and (source_data.IsArchived is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.ShippingLastName != source_data.ShippingLastName
        or
        (
            ((snapshotted_data.ShippingLastName is null) and not (source_data.ShippingLastName is null))
            or
            ((not snapshotted_data.ShippingLastName is null) and (source_data.ShippingLastName is null))
        ) or snapshotted_data.BillingLastName != source_data.BillingLastName
        or
        (
            ((snapshotted_data.BillingLastName is null) and not (source_data.BillingLastName is null))
            or
            ((not snapshotted_data.BillingLastName is null) and (source_data.BillingLastName is null))
        ) or snapshotted_data.OwnerName != source_data.OwnerName
        or
        (
            ((snapshotted_data.OwnerName is null) and not (source_data.OwnerName is null))
            or
            ((not snapshotted_data.OwnerName is null) and (source_data.OwnerName is null))
        ) or snapshotted_data.Shippingdetails != source_data.Shippingdetails
        or
        (
            ((snapshotted_data.Shippingdetails is null) and not (source_data.Shippingdetails is null))
            or
            ((not snapshotted_data.Shippingdetails is null) and (source_data.Shippingdetails is null))
        ) or snapshotted_data.OwnerCity != source_data.OwnerCity
        or
        (
            ((snapshotted_data.OwnerCity is null) and not (source_data.OwnerCity is null))
            or
            ((not snapshotted_data.OwnerCity is null) and (source_data.OwnerCity is null))
        ) or snapshotted_data.OwnerStateregion != source_data.OwnerStateregion
        or
        (
            ((snapshotted_data.OwnerStateregion is null) and not (source_data.OwnerStateregion is null))
            or
            ((not snapshotted_data.OwnerStateregion is null) and (source_data.OwnerStateregion is null))
        ) or snapshotted_data.OwnerzipPostal != source_data.OwnerzipPostal
        or
        (
            ((snapshotted_data.OwnerzipPostal is null) and not (source_data.OwnerzipPostal is null))
            or
            ((not snapshotted_data.OwnerzipPostal is null) and (source_data.OwnerzipPostal is null))
        ) or snapshotted_data.OwnerCountry != source_data.OwnerCountry
        or
        (
            ((snapshotted_data.OwnerCountry is null) and not (source_data.OwnerCountry is null))
            or
            ((not snapshotted_data.OwnerCountry is null) and (source_data.OwnerCountry is null))
        ) or snapshotted_data.ShippingFirstName != source_data.ShippingFirstName
        or
        (
            ((snapshotted_data.ShippingFirstName is null) and not (source_data.ShippingFirstName is null))
            or
            ((not snapshotted_data.ShippingFirstName is null) and (source_data.ShippingFirstName is null))
        ) or snapshotted_data.BillingFirstName != source_data.BillingFirstName
        or
        (
            ((snapshotted_data.BillingFirstName is null) and not (source_data.BillingFirstName is null))
            or
            ((not snapshotted_data.BillingFirstName is null) and (source_data.BillingFirstName is null))
        ) or snapshotted_data.BillingCity != source_data.BillingCity
        or
        (
            ((snapshotted_data.BillingCity is null) and not (source_data.BillingCity is null))
            or
            ((not snapshotted_data.BillingCity is null) and (source_data.BillingCity is null))
        ) or snapshotted_data.BillingStateregion != source_data.BillingStateregion
        or
        (
            ((snapshotted_data.BillingStateregion is null) and not (source_data.BillingStateregion is null))
            or
            ((not snapshotted_data.BillingStateregion is null) and (source_data.BillingStateregion is null))
        ) or snapshotted_data.BillingzipPostal != source_data.BillingzipPostal
        or
        (
            ((snapshotted_data.BillingzipPostal is null) and not (source_data.BillingzipPostal is null))
            or
            ((not snapshotted_data.BillingzipPostal is null) and (source_data.BillingzipPostal is null))
        ) or snapshotted_data.BillingCountry != source_data.BillingCountry
        or
        (
            ((snapshotted_data.BillingCountry is null) and not (source_data.BillingCountry is null))
            or
            ((not snapshotted_data.BillingCountry is null) and (source_data.BillingCountry is null))
        ) or snapshotted_data.OwnerStreet1 != source_data.OwnerStreet1
        or
        (
            ((snapshotted_data.OwnerStreet1 is null) and not (source_data.OwnerStreet1 is null))
            or
            ((not snapshotted_data.OwnerStreet1 is null) and (source_data.OwnerStreet1 is null))
        ) or snapshotted_data.OwnerStreet2 != source_data.OwnerStreet2
        or
        (
            ((snapshotted_data.OwnerStreet2 is null) and not (source_data.OwnerStreet2 is null))
            or
            ((not snapshotted_data.OwnerStreet2 is null) and (source_data.OwnerStreet2 is null))
        ) or snapshotted_data.ShippingCity != source_data.ShippingCity
        or
        (
            ((snapshotted_data.ShippingCity is null) and not (source_data.ShippingCity is null))
            or
            ((not snapshotted_data.ShippingCity is null) and (source_data.ShippingCity is null))
        ) or snapshotted_data.ShippingStateregion != source_data.ShippingStateregion
        or
        (
            ((snapshotted_data.ShippingStateregion is null) and not (source_data.ShippingStateregion is null))
            or
            ((not snapshotted_data.ShippingStateregion is null) and (source_data.ShippingStateregion is null))
        ) or snapshotted_data.ShippingzipPostal != source_data.ShippingzipPostal
        or
        (
            ((snapshotted_data.ShippingzipPostal is null) and not (source_data.ShippingzipPostal is null))
            or
            ((not snapshotted_data.ShippingzipPostal is null) and (source_data.ShippingzipPostal is null))
        ) or snapshotted_data.ShippingCountry != source_data.ShippingCountry
        or
        (
            ((snapshotted_data.ShippingCountry is null) and not (source_data.ShippingCountry is null))
            or
            ((not snapshotted_data.ShippingCountry is null) and (source_data.ShippingCountry is null))
        ) or snapshotted_data.BillingStreet1 != source_data.BillingStreet1
        or
        (
            ((snapshotted_data.BillingStreet1 is null) and not (source_data.BillingStreet1 is null))
            or
            ((not snapshotted_data.BillingStreet1 is null) and (source_data.BillingStreet1 is null))
        ) or snapshotted_data.BillingStreet2 != source_data.BillingStreet2
        or
        (
            ((snapshotted_data.BillingStreet2 is null) and not (source_data.BillingStreet2 is null))
            or
            ((not snapshotted_data.BillingStreet2 is null) and (source_data.BillingStreet2 is null))
        ) or snapshotted_data.Comments != source_data.Comments
        or
        (
            ((snapshotted_data.Comments is null) and not (source_data.Comments is null))
            or
            ((not snapshotted_data.Comments is null) and (source_data.Comments is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Currency != source_data.Currency
        or
        (
            ((snapshotted_data.Currency is null) and not (source_data.Currency is null))
            or
            ((not snapshotted_data.Currency is null) and (source_data.Currency is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.ShippingStreet1 != source_data.ShippingStreet1
        or
        (
            ((snapshotted_data.ShippingStreet1 is null) and not (source_data.ShippingStreet1 is null))
            or
            ((not snapshotted_data.ShippingStreet1 is null) and (source_data.ShippingStreet1 is null))
        ) or snapshotted_data.ShippingStreet2 != source_data.ShippingStreet2
        or
        (
            ((snapshotted_data.ShippingStreet2 is null) and not (source_data.ShippingStreet2 is null))
            or
            ((not snapshotted_data.ShippingStreet2 is null) and (source_data.ShippingStreet2 is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Paiddttm != source_data.Paiddttm
        or
        (
            ((snapshotted_data.Paiddttm is null) and not (source_data.Paiddttm is null))
            or
            ((not snapshotted_data.Paiddttm is null) and (source_data.Paiddttm is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Createddttm != source_data.Createddttm
        or
        (
            ((snapshotted_data.Createddttm is null) and not (source_data.Createddttm is null))
            or
            ((not snapshotted_data.Createddttm is null) and (source_data.Createddttm is null))
        ) or snapshotted_data.Fulfilleddttm != source_data.Fulfilleddttm
        or
        (
            ((snapshotted_data.Fulfilleddttm is null) and not (source_data.Fulfilleddttm is null))
            or
            ((not snapshotted_data.Fulfilleddttm is null) and (source_data.Fulfilleddttm is null))
        ) or snapshotted_data.PropertybagID != source_data.PropertybagID
        or
        (
            ((snapshotted_data.PropertybagID is null) and not (source_data.PropertybagID is null))
            or
            ((not snapshotted_data.PropertybagID is null) and (source_data.PropertybagID is null))
        ) or snapshotted_data.ShippingOptionID != source_data.ShippingOptionID
        or
        (
            ((snapshotted_data.ShippingOptionID is null) and not (source_data.ShippingOptionID is null))
            or
            ((not snapshotted_data.ShippingOptionID is null) and (source_data.ShippingOptionID is null))
        ) or snapshotted_data.PayerID != source_data.PayerID
        or
        (
            ((snapshotted_data.PayerID is null) and not (source_data.PayerID is null))
            or
            ((not snapshotted_data.PayerID is null) and (source_data.PayerID is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.SalesTax != source_data.SalesTax
        or
        (
            ((snapshotted_data.SalesTax is null) and not (source_data.SalesTax is null))
            or
            ((not snapshotted_data.SalesTax is null) and (source_data.SalesTax is null))
        ) or snapshotted_data.BuyersPremiumPercent != source_data.BuyersPremiumPercent
        or
        (
            ((snapshotted_data.BuyersPremiumPercent is null) and not (source_data.BuyersPremiumPercent is null))
            or
            ((not snapshotted_data.BuyersPremiumPercent is null) and (source_data.BuyersPremiumPercent is null))
        ) or snapshotted_data.BuyersPremiumAmount != source_data.BuyersPremiumAmount
        or
        (
            ((snapshotted_data.BuyersPremiumAmount is null) and not (source_data.BuyersPremiumAmount is null))
            or
            ((not snapshotted_data.BuyersPremiumAmount is null) and (source_data.BuyersPremiumAmount is null))
        ) or snapshotted_data.ShippingAmount != source_data.ShippingAmount
        or
        (
            ((snapshotted_data.ShippingAmount is null) and not (source_data.ShippingAmount is null))
            or
            ((not snapshotted_data.ShippingAmount is null) and (source_data.ShippingAmount is null))
        ) or snapshotted_data.SubTotal != source_data.SubTotal
        or
        (
            ((snapshotted_data.SubTotal is null) and not (source_data.SubTotal is null))
            or
            ((not snapshotted_data.SubTotal is null) and (source_data.SubTotal is null))
        ) or snapshotted_data.Total != source_data.Total
        or
        (
            ((snapshotted_data.Total is null) and not (source_data.Total is null))
            or
            ((not snapshotted_data.Total is null) and (source_data.Total is null))
        ) or snapshotted_data.IsPayerLocked != source_data.IsPayerLocked
        or
        (
            ((snapshotted_data.IsPayerLocked is null) and not (source_data.IsPayerLocked is null))
            or
            ((not snapshotted_data.IsPayerLocked is null) and (source_data.IsPayerLocked is null))
        ) or snapshotted_data.Shipped != source_data.Shipped
        or
        (
            ((snapshotted_data.Shipped is null) and not (source_data.Shipped is null))
            or
            ((not snapshotted_data.Shipped is null) and (source_data.Shipped is null))
        ) or snapshotted_data.IsArchived != source_data.IsArchived
        or
        (
            ((snapshotted_data.IsArchived is null) and not (source_data.IsArchived is null))
            or
            ((not snapshotted_data.IsArchived is null) and (source_data.IsArchived is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.ShippingLastName != source_data.ShippingLastName
        or
        (
            ((snapshotted_data.ShippingLastName is null) and not (source_data.ShippingLastName is null))
            or
            ((not snapshotted_data.ShippingLastName is null) and (source_data.ShippingLastName is null))
        ) or snapshotted_data.BillingLastName != source_data.BillingLastName
        or
        (
            ((snapshotted_data.BillingLastName is null) and not (source_data.BillingLastName is null))
            or
            ((not snapshotted_data.BillingLastName is null) and (source_data.BillingLastName is null))
        ) or snapshotted_data.OwnerName != source_data.OwnerName
        or
        (
            ((snapshotted_data.OwnerName is null) and not (source_data.OwnerName is null))
            or
            ((not snapshotted_data.OwnerName is null) and (source_data.OwnerName is null))
        ) or snapshotted_data.Shippingdetails != source_data.Shippingdetails
        or
        (
            ((snapshotted_data.Shippingdetails is null) and not (source_data.Shippingdetails is null))
            or
            ((not snapshotted_data.Shippingdetails is null) and (source_data.Shippingdetails is null))
        ) or snapshotted_data.OwnerCity != source_data.OwnerCity
        or
        (
            ((snapshotted_data.OwnerCity is null) and not (source_data.OwnerCity is null))
            or
            ((not snapshotted_data.OwnerCity is null) and (source_data.OwnerCity is null))
        ) or snapshotted_data.OwnerStateregion != source_data.OwnerStateregion
        or
        (
            ((snapshotted_data.OwnerStateregion is null) and not (source_data.OwnerStateregion is null))
            or
            ((not snapshotted_data.OwnerStateregion is null) and (source_data.OwnerStateregion is null))
        ) or snapshotted_data.OwnerzipPostal != source_data.OwnerzipPostal
        or
        (
            ((snapshotted_data.OwnerzipPostal is null) and not (source_data.OwnerzipPostal is null))
            or
            ((not snapshotted_data.OwnerzipPostal is null) and (source_data.OwnerzipPostal is null))
        ) or snapshotted_data.OwnerCountry != source_data.OwnerCountry
        or
        (
            ((snapshotted_data.OwnerCountry is null) and not (source_data.OwnerCountry is null))
            or
            ((not snapshotted_data.OwnerCountry is null) and (source_data.OwnerCountry is null))
        ) or snapshotted_data.ShippingFirstName != source_data.ShippingFirstName
        or
        (
            ((snapshotted_data.ShippingFirstName is null) and not (source_data.ShippingFirstName is null))
            or
            ((not snapshotted_data.ShippingFirstName is null) and (source_data.ShippingFirstName is null))
        ) or snapshotted_data.BillingFirstName != source_data.BillingFirstName
        or
        (
            ((snapshotted_data.BillingFirstName is null) and not (source_data.BillingFirstName is null))
            or
            ((not snapshotted_data.BillingFirstName is null) and (source_data.BillingFirstName is null))
        ) or snapshotted_data.BillingCity != source_data.BillingCity
        or
        (
            ((snapshotted_data.BillingCity is null) and not (source_data.BillingCity is null))
            or
            ((not snapshotted_data.BillingCity is null) and (source_data.BillingCity is null))
        ) or snapshotted_data.BillingStateregion != source_data.BillingStateregion
        or
        (
            ((snapshotted_data.BillingStateregion is null) and not (source_data.BillingStateregion is null))
            or
            ((not snapshotted_data.BillingStateregion is null) and (source_data.BillingStateregion is null))
        ) or snapshotted_data.BillingzipPostal != source_data.BillingzipPostal
        or
        (
            ((snapshotted_data.BillingzipPostal is null) and not (source_data.BillingzipPostal is null))
            or
            ((not snapshotted_data.BillingzipPostal is null) and (source_data.BillingzipPostal is null))
        ) or snapshotted_data.BillingCountry != source_data.BillingCountry
        or
        (
            ((snapshotted_data.BillingCountry is null) and not (source_data.BillingCountry is null))
            or
            ((not snapshotted_data.BillingCountry is null) and (source_data.BillingCountry is null))
        ) or snapshotted_data.OwnerStreet1 != source_data.OwnerStreet1
        or
        (
            ((snapshotted_data.OwnerStreet1 is null) and not (source_data.OwnerStreet1 is null))
            or
            ((not snapshotted_data.OwnerStreet1 is null) and (source_data.OwnerStreet1 is null))
        ) or snapshotted_data.OwnerStreet2 != source_data.OwnerStreet2
        or
        (
            ((snapshotted_data.OwnerStreet2 is null) and not (source_data.OwnerStreet2 is null))
            or
            ((not snapshotted_data.OwnerStreet2 is null) and (source_data.OwnerStreet2 is null))
        ) or snapshotted_data.ShippingCity != source_data.ShippingCity
        or
        (
            ((snapshotted_data.ShippingCity is null) and not (source_data.ShippingCity is null))
            or
            ((not snapshotted_data.ShippingCity is null) and (source_data.ShippingCity is null))
        ) or snapshotted_data.ShippingStateregion != source_data.ShippingStateregion
        or
        (
            ((snapshotted_data.ShippingStateregion is null) and not (source_data.ShippingStateregion is null))
            or
            ((not snapshotted_data.ShippingStateregion is null) and (source_data.ShippingStateregion is null))
        ) or snapshotted_data.ShippingzipPostal != source_data.ShippingzipPostal
        or
        (
            ((snapshotted_data.ShippingzipPostal is null) and not (source_data.ShippingzipPostal is null))
            or
            ((not snapshotted_data.ShippingzipPostal is null) and (source_data.ShippingzipPostal is null))
        ) or snapshotted_data.ShippingCountry != source_data.ShippingCountry
        or
        (
            ((snapshotted_data.ShippingCountry is null) and not (source_data.ShippingCountry is null))
            or
            ((not snapshotted_data.ShippingCountry is null) and (source_data.ShippingCountry is null))
        ) or snapshotted_data.BillingStreet1 != source_data.BillingStreet1
        or
        (
            ((snapshotted_data.BillingStreet1 is null) and not (source_data.BillingStreet1 is null))
            or
            ((not snapshotted_data.BillingStreet1 is null) and (source_data.BillingStreet1 is null))
        ) or snapshotted_data.BillingStreet2 != source_data.BillingStreet2
        or
        (
            ((snapshotted_data.BillingStreet2 is null) and not (source_data.BillingStreet2 is null))
            or
            ((not snapshotted_data.BillingStreet2 is null) and (source_data.BillingStreet2 is null))
        ) or snapshotted_data.Comments != source_data.Comments
        or
        (
            ((snapshotted_data.Comments is null) and not (source_data.Comments is null))
            or
            ((not snapshotted_data.Comments is null) and (source_data.Comments is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Currency != source_data.Currency
        or
        (
            ((snapshotted_data.Currency is null) and not (source_data.Currency is null))
            or
            ((not snapshotted_data.Currency is null) and (source_data.Currency is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.ShippingStreet1 != source_data.ShippingStreet1
        or
        (
            ((snapshotted_data.ShippingStreet1 is null) and not (source_data.ShippingStreet1 is null))
            or
            ((not snapshotted_data.ShippingStreet1 is null) and (source_data.ShippingStreet1 is null))
        ) or snapshotted_data.ShippingStreet2 != source_data.ShippingStreet2
        or
        (
            ((snapshotted_data.ShippingStreet2 is null) and not (source_data.ShippingStreet2 is null))
            or
            ((not snapshotted_data.ShippingStreet2 is null) and (source_data.ShippingStreet2 is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Invoices_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Invoices_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Invoices_Incr__dbt_tmp_temp_view"
    end



    
20:20:37.757873 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:20:37.761109 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:37.761331 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr'
      and table_schema = 'stg'
  
20:20:37.839886 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:20:37.844165 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:37.844401 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:37.939243 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:20:37.940814 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:37.940992 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    
20:20:38.791068 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.85 seconds
20:20:38.792732 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:38.792933 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:38.824806 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:20:38.827611 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:38.827847 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:38.936618 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.93 seconds
20:20:38.940320 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:38.940558 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:38.982993 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:38.984709 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:38.984920 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    
20:20:39.040515 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:20:39.043499 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:39.043731 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr'
      and table_schema = 'stg'
  
20:20:39.095426 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:20:39.101076 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:39.101334 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:39.188830 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:20:39.190780 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:39.190989 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    
20:20:40.136477 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
20:20:40.138107 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:40.138299 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:40.186882 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.00 seconds
20:20:40.188524 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:40.188705 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:40.219736 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:20:40.222087 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:40.222266 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:40.228970 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:40.230986 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:40.231137 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:40.512655 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
20:20:40.516008 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:40.516253 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr'
      and table_schema = 'stg'
  
20:20:40.615828 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:20:40.620224 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:40.620470 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:40.704261 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:20:40.705719 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:40.705916 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    
20:20:41.168293 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
20:20:41.170376 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ImportedUserMap_Incr"
20:20:41.170940 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:41.171089 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ImportedUserMap_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr" (
                  "LocalUserID", "ForeignUserID", "ImportedUserName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "LocalUserID", "ForeignUserID", "ImportedUserName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:20:41.666976 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
20:20:41.668536 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:41.668726 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:41.777642 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:20:41.780043 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:41.780246 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:42.066565 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
20:20:42.069713 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:42.069953 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr'
      and table_schema = 'stg'
  
20:20:42.160827 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:20:42.165183 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:42.165455 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:42.211096 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:20:42.212559 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:42.212755 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    
20:20:42.523799 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.35 seconds
20:20:42.525644 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ImportedUserMap_Incr: COMMIT
20:20:42.526650 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
20:20:42.526834 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."#AH_ImportedUserMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    end

20:20:42.572846 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:20:42.674932 [debug] [Thread-1  ]: finished collecting timing info
20:20:42.675268 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ImportedUserMap_Incr: Close
20:20:42.676023 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016544e760>]}
20:20:42.676517 [info ] [Thread-1  ]: 35 of 101 OK snapshotted stg.AH_ImportedUserMap_Incr............................ [[32mOK[0m in 10.36s]
20:20:42.676850 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ImportedUserMap_Incr
20:20:42.677000 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_KeyTable_Incr
20:20:42.677340 [info ] [Thread-1  ]: 39 of 101 START snapshot stg.AH_KeyTable_Incr................................... [RUN]
20:20:42.677723 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_KeyTable_Incr"
20:20:42.677831 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_KeyTable_Incr
20:20:42.677926 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_KeyTable_Incr
20:20:42.680767 [debug] [Thread-1  ]: finished collecting timing info
20:20:42.680916 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_KeyTable_Incr
20:20:42.683528 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:42.683664 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:20:42.683746 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:20:42.683843 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:20:42.819502 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:20:42.860085 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:20:42.884221 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:42.884509 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:20:42.914646 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:20:42.916565 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:42.916750 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_KeyTable_InterView]
        ) as __dbt_sbq
    
20:20:42.970098 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:20:42.993103 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:42.993372 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr"
        ) as __dbt_sbq
    
20:20:43.049280 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:20:43.052833 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:43.053042 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr'
      and table_schema = 'stg'
  
20:20:43.054235 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.84 seconds
20:20:43.055541 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:43.055678 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:43.098483 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:43.101195 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:43.101413 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:43.141273 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:20:43.144690 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:43.144904 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
        
  
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_KeyTable_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_KeyTable_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_KeyTable_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_KeyTable_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_KeyTable_InterView]

    ),

    snapshotted_data as (

        select *,
            NextID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            NextID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:20:42.898098'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:20:42.898098'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:20:42.898098''), CONVERT(DATETIME2, ''2022-09-26 20:20:42.898098'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(NextID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:20:42.898098'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            NextID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:20:42.898098'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:20:42.898098'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:20:42.898098'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.NextID != source_data.NextID
        or
        (
            ((snapshotted_data.NextID is null) and not (source_data.NextID is null))
            or
            ((not snapshotted_data.NextID is null) and (source_data.NextID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.NextID != source_data.NextID
        or
        (
            ((snapshotted_data.NextID is null) and not (source_data.NextID is null))
            or
            ((not snapshotted_data.NextID is null) and (source_data.NextID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_KeyTable_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_KeyTable_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_KeyTable_Incr__dbt_tmp_temp_view"
    end



    
20:20:43.326910 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:20:43.329059 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ImportedregionMap_Incr"
20:20:43.329492 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:43.329620 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ImportedregionMap_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr" (
                  "LocalregionID", "ForeignregionID", "Foreignregiontier", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "LocalregionID", "ForeignregionID", "Foreignregiontier", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:20:43.849530 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 7.09 seconds
20:20:43.853126 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:43.853324 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:43.899635 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:20:43.901187 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:43.901366 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Increments_Incr__dbt_tmp"
    
20:20:44.615128 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.29 seconds
20:20:44.616837 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ImportedregionMap_Incr: COMMIT
20:20:44.617633 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
20:20:44.617778 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."#AH_ImportedregionMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    end

20:20:44.654925 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:44.668933 [debug] [Thread-4  ]: finished collecting timing info
20:20:44.669262 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ImportedregionMap_Incr: Close
20:20:44.670020 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016544e4c0>]}
20:20:44.670484 [info ] [Thread-4  ]: 36 of 101 OK snapshotted stg.AH_ImportedregionMap_Incr.......................... [[32mOK[0m in 10.13s]
20:20:44.670889 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ImportedregionMap_Incr
20:20:44.671038 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Languages_Incr
20:20:44.671390 [info ] [Thread-4  ]: 40 of 101 START snapshot stg.AH_Languages_Incr.................................. [RUN]
20:20:44.671773 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Languages_Incr"
20:20:44.671883 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Languages_Incr
20:20:44.671989 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Languages_Incr
20:20:44.674753 [debug] [Thread-4  ]: finished collecting timing info
20:20:44.674911 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Languages_Incr
20:20:44.677711 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:44.677850 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:20:44.677932 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:20:44.678029 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:20:44.799925 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:20:44.827828 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:20:44.851714 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:44.852004 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:20:44.883223 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:20:44.885387 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:44.885885 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Languages_InterView]
        ) as __dbt_sbq
    
20:20:44.952403 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:20:44.953930 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
20:20:44.955143 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:44.955292 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:44.976661 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:44.976938 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Languages_Incr"
        ) as __dbt_sbq
    
20:20:45.024556 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:20:45.028804 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:45.029026 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr'
      and table_schema = 'stg'
  
20:20:45.073329 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:20:45.076049 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:45.076266 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:45.152824 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:20:45.156371 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:45.156603 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
        
  
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Languages_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Languages_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Languages_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Languages_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Languages_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Languages_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:20:44.851268'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:20:44.851268'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:20:44.851268''), CONVERT(DATETIME2, ''2022-09-26 20:20:44.851268'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:20:44.851268'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:20:44.851268'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:20:44.851268'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:20:44.851268'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Languages_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Languages_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Languages_Incr__dbt_tmp_temp_view"
    end



    
20:20:45.354571 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
20:20:45.357505 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:45.357703 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr'
      and table_schema = 'stg'
  
20:20:45.427681 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:20:45.431822 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:45.432053 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:45.497319 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:20:45.498964 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:45.499166 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Increments_Incr__dbt_tmp"
    
20:20:45.593049 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.45 seconds
20:20:45.596689 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:45.596927 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:45.655861 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:20:45.657347 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:45.657518 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_KeyTable_Incr__dbt_tmp"
    
20:20:46.381044 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
20:20:46.382754 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:46.382950 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:46.434718 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:20:46.437165 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:46.437384 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:46.639783 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.98 seconds
20:20:46.641523 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:46.641753 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:46.689921 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:20:46.693170 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:46.693424 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr'
      and table_schema = 'stg'
  
20:20:46.724386 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:20:46.726947 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:46.727162 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:46.727987 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:20:46.732169 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:46.732367 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:46.798767 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:20:46.800255 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:46.800425 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Increments_Incr__dbt_tmp"
    
20:20:46.927325 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:20:46.930132 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:46.930369 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr'
      and table_schema = 'stg'
  
20:20:46.970931 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:46.975377 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:46.975604 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:47.018181 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:47.019929 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:47.020118 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_KeyTable_Incr__dbt_tmp"
    
20:20:47.960962 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
20:20:47.962648 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:47.962851 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:47.973167 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
20:20:47.974603 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:47.974779 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:47.999090 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:48.001580 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:48.001781 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:48.013699 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:48.016002 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:48.016199 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:48.306229 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
20:20:48.309768 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:48.310011 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr'
      and table_schema = 'stg'
  
20:20:48.333611 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
20:20:48.335692 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Increments_Incr"
20:20:48.336158 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:48.336295 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Increments_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Increments_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Increments_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Increments_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Increments_Incr" (
                  "ID", "LastUpdatedUser", "PriceLevel", "Amount", "ListingTypeID", "AuctionEventID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "LastUpdatedUser", "PriceLevel", "Amount", "ListingTypeID", "AuctionEventID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Increments_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:20:48.356484 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:20:48.361085 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:48.361357 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:48.409693 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:20:48.411341 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:48.411526 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_KeyTable_Incr__dbt_tmp"
    
20:20:49.437820 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
20:20:49.439474 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:49.439663 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:49.480464 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:49.482958 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:49.483169 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:49.691763 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:20:49.693920 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_KeyTable_Incr"
20:20:49.694369 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:49.694502 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_KeyTable_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr" (
                  "NextID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "NextID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_KeyTable_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:20:49.996543 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.66 seconds
20:20:49.998338 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Increments_Incr: COMMIT
20:20:49.999173 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
20:20:49.999318 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."#AH_Increments_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Increments_Incr__dbt_tmp"
    end

20:20:50.040804 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:50.055868 [debug] [Thread-3  ]: finished collecting timing info
20:20:50.056219 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Increments_Incr: Close
20:20:50.056997 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016544e610>]}
20:20:50.057486 [info ] [Thread-3  ]: 37 of 101 OK snapshotted stg.AH_Increments_Incr................................. [[32mOK[0m in 13.73s]
20:20:50.057814 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Increments_Incr
20:20:50.057975 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_LineItems_Incr
20:20:50.058336 [info ] [Thread-3  ]: 41 of 101 START snapshot stg.AH_LineItems_Incr.................................. [RUN]
20:20:50.058778 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_LineItems_Incr"
20:20:50.058924 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_LineItems_Incr
20:20:50.059040 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_LineItems_Incr
20:20:50.061875 [debug] [Thread-3  ]: finished collecting timing info
20:20:50.062111 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_LineItems_Incr
20:20:50.065168 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:20:50.065322 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:20:50.065405 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:20:50.065507 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:20:50.175420 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:20:50.205295 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:20:50.229272 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:20:50.229579 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:20:50.239748 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 5.08 seconds
20:20:50.243201 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:50.243430 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:50.259359 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:20:50.261508 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:20:50.261713 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_LineItems_InterView]
        ) as __dbt_sbq
    
20:20:50.281999 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:50.283598 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:50.283792 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Languages_Incr__dbt_tmp"
    
20:20:50.335995 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:20:50.359324 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:20:50.359620 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_LineItems_Incr"
        ) as __dbt_sbq
    
20:20:50.459756 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:20:50.463460 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:20:50.463735 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr'
      and table_schema = 'stg'
  
20:20:50.568310 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:20:50.572728 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:20:50.572992 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
        
  
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LineItems_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_LineItems_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_LineItems_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_LineItems_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_LineItems_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_LineItems_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:20:50.241980'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:20:50.241980'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:20:50.241980''), CONVERT(DATETIME2, ''2022-09-26 20:20:50.241980'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:20:50.241980'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:20:50.241980'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:20:50.241980'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:20:50.241980'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Currency != source_data.Currency
        or
        (
            ((snapshotted_data.Currency is null) and not (source_data.Currency is null))
            or
            ((not snapshotted_data.Currency is null) and (source_data.Currency is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.LotNumber != source_data.LotNumber
        or
        (
            ((snapshotted_data.LotNumber is null) and not (source_data.LotNumber is null))
            or
            ((not snapshotted_data.LotNumber is null) and (source_data.LotNumber is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.InvoiceID != source_data.InvoiceID
        or
        (
            ((snapshotted_data.InvoiceID is null) and not (source_data.InvoiceID is null))
            or
            ((not snapshotted_data.InvoiceID is null) and (source_data.InvoiceID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.PayerID != source_data.PayerID
        or
        (
            ((snapshotted_data.PayerID is null) and not (source_data.PayerID is null))
            or
            ((not snapshotted_data.PayerID is null) and (source_data.PayerID is null))
        ) or snapshotted_data.ReListiteration != source_data.ReListiteration
        or
        (
            ((snapshotted_data.ReListiteration is null) and not (source_data.ReListiteration is null))
            or
            ((not snapshotted_data.ReListiteration is null) and (source_data.ReListiteration is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.TotalAmount != source_data.TotalAmount
        or
        (
            ((snapshotted_data.TotalAmount is null) and not (source_data.TotalAmount is null))
            or
            ((not snapshotted_data.TotalAmount is null) and (source_data.TotalAmount is null))
        ) or snapshotted_data.PeRunitAmount != source_data.PeRunitAmount
        or
        (
            ((snapshotted_data.PeRunitAmount is null) and not (source_data.PeRunitAmount is null))
            or
            ((not snapshotted_data.PeRunitAmount is null) and (source_data.PeRunitAmount is null))
        ) or snapshotted_data.Taxable != source_data.Taxable
        or
        (
            ((snapshotted_data.Taxable is null) and not (source_data.Taxable is null))
            or
            ((not snapshotted_data.Taxable is null) and (source_data.Taxable is null))
        ) or snapshotted_data.IsArchived != source_data.IsArchived
        or
        (
            ((snapshotted_data.IsArchived is null) and not (source_data.IsArchived is null))
            or
            ((not snapshotted_data.IsArchived is null) and (source_data.IsArchived is null))
        ) or snapshotted_data.BuyersPremiuMapplies != source_data.BuyersPremiuMapplies
        or
        (
            ((snapshotted_data.BuyersPremiuMapplies is null) and not (source_data.BuyersPremiuMapplies is null))
            or
            ((not snapshotted_data.BuyersPremiuMapplies is null) and (source_data.BuyersPremiuMapplies is null))
        ) or snapshotted_data.IsPayerArchived != source_data.IsPayerArchived
        or
        (
            ((snapshotted_data.IsPayerArchived is null) and not (source_data.IsPayerArchived is null))
            or
            ((not snapshotted_data.IsPayerArchived is null) and (source_data.IsPayerArchived is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Currency != source_data.Currency
        or
        (
            ((snapshotted_data.Currency is null) and not (source_data.Currency is null))
            or
            ((not snapshotted_data.Currency is null) and (source_data.Currency is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.LotNumber != source_data.LotNumber
        or
        (
            ((snapshotted_data.LotNumber is null) and not (source_data.LotNumber is null))
            or
            ((not snapshotted_data.LotNumber is null) and (source_data.LotNumber is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.InvoiceID != source_data.InvoiceID
        or
        (
            ((snapshotted_data.InvoiceID is null) and not (source_data.InvoiceID is null))
            or
            ((not snapshotted_data.InvoiceID is null) and (source_data.InvoiceID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.PayerID != source_data.PayerID
        or
        (
            ((snapshotted_data.PayerID is null) and not (source_data.PayerID is null))
            or
            ((not snapshotted_data.PayerID is null) and (source_data.PayerID is null))
        ) or snapshotted_data.ReListiteration != source_data.ReListiteration
        or
        (
            ((snapshotted_data.ReListiteration is null) and not (source_data.ReListiteration is null))
            or
            ((not snapshotted_data.ReListiteration is null) and (source_data.ReListiteration is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.TotalAmount != source_data.TotalAmount
        or
        (
            ((snapshotted_data.TotalAmount is null) and not (source_data.TotalAmount is null))
            or
            ((not snapshotted_data.TotalAmount is null) and (source_data.TotalAmount is null))
        ) or snapshotted_data.PeRunitAmount != source_data.PeRunitAmount
        or
        (
            ((snapshotted_data.PeRunitAmount is null) and not (source_data.PeRunitAmount is null))
            or
            ((not snapshotted_data.PeRunitAmount is null) and (source_data.PeRunitAmount is null))
        ) or snapshotted_data.Taxable != source_data.Taxable
        or
        (
            ((snapshotted_data.Taxable is null) and not (source_data.Taxable is null))
            or
            ((not snapshotted_data.Taxable is null) and (source_data.Taxable is null))
        ) or snapshotted_data.IsArchived != source_data.IsArchived
        or
        (
            ((snapshotted_data.IsArchived is null) and not (source_data.IsArchived is null))
            or
            ((not snapshotted_data.IsArchived is null) and (source_data.IsArchived is null))
        ) or snapshotted_data.BuyersPremiuMapplies != source_data.BuyersPremiuMapplies
        or
        (
            ((snapshotted_data.BuyersPremiuMapplies is null) and not (source_data.BuyersPremiuMapplies is null))
            or
            ((not snapshotted_data.BuyersPremiuMapplies is null) and (source_data.BuyersPremiuMapplies is null))
        ) or snapshotted_data.IsPayerArchived != source_data.IsPayerArchived
        or
        (
            ((snapshotted_data.IsPayerArchived is null) and not (source_data.IsPayerArchived is null))
            or
            ((not snapshotted_data.IsPayerArchived is null) and (source_data.IsPayerArchived is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_LineItems_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_LineItems_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LineItems_Incr__dbt_tmp_temp_view"
    end



    
20:20:51.039583 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.34 seconds
20:20:51.041440 [debug] [Thread-1  ]: On snapshot.Shawn.AH_KeyTable_Incr: COMMIT
20:20:51.042222 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
20:20:51.042367 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."#AH_KeyTable_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_KeyTable_Incr__dbt_tmp"
    end

20:20:51.096753 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:20:51.110405 [debug] [Thread-1  ]: finished collecting timing info
20:20:51.110781 [debug] [Thread-1  ]: On snapshot.Shawn.AH_KeyTable_Incr: Close
20:20:51.111589 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016544ea00>]}
20:20:51.112085 [info ] [Thread-1  ]: 39 of 101 OK snapshotted stg.AH_KeyTable_Incr................................... [[32mOK[0m in 8.43s]
20:20:51.112420 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_KeyTable_Incr
20:20:51.112579 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ListingActionproperties_Incr
20:20:51.112936 [info ] [Thread-1  ]: 42 of 101 START snapshot stg.AH_ListingActionproperties_Incr.................... [RUN]
20:20:51.113329 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr"
20:20:51.113440 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ListingActionproperties_Incr
20:20:51.113535 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ListingActionproperties_Incr
20:20:51.116352 [debug] [Thread-1  ]: finished collecting timing info
20:20:51.116513 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ListingActionproperties_Incr
20:20:51.119429 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:20:51.119573 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:20:51.119658 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:20:51.119757 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:20:51.159601 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
20:20:51.161240 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:51.161435 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:51.227037 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:20:51.229492 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:51.229707 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:51.239313 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:20:51.289842 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:20:51.314907 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:20:51.315193 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:20:51.352570 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:51.354792 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:20:51.355007 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingActionproperties_InterView]
        ) as __dbt_sbq
    
20:20:51.436552 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:20:51.459376 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:20:51.459676 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr"
        ) as __dbt_sbq
    
20:20:51.549594 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:20:51.553647 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:20:51.553879 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr'
      and table_schema = 'stg'
  
20:20:51.625831 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:20:51.629580 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:20:51.629811 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
        
  
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActionproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingActionproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingActionproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingActionproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:20:51.320104'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:20:51.320104'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:20:51.320104''), CONVERT(DATETIME2, ''2022-09-26 20:20:51.320104'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:20:51.320104'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:20:51.320104'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:20:51.320104'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:20:51.320104'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.ListingActionID != source_data.ListingActionID
        or
        (
            ((snapshotted_data.ListingActionID is null) and not (source_data.ListingActionID is null))
            or
            ((not snapshotted_data.ListingActionID is null) and (source_data.ListingActionID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.ListingActionID != source_data.ListingActionID
        or
        (
            ((snapshotted_data.ListingActionID is null) and not (source_data.ListingActionID is null))
            or
            ((not snapshotted_data.ListingActionID is null) and (source_data.ListingActionID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingActionproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActionproperties_Incr__dbt_tmp_temp_view"
    end



    
20:20:51.828110 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.60 seconds
20:20:51.831363 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:51.831567 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr'
      and table_schema = 'stg'
  
20:20:51.867505 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:51.871927 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:51.872165 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:51.912132 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:51.913717 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:51.913909 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Languages_Incr__dbt_tmp"
    
20:20:53.577854 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.66 seconds
20:20:53.579458 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:53.579650 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:53.617593 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:53.619967 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:53.620206 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:53.875564 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:20:53.878637 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:53.878883 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr'
      and table_schema = 'stg'
  
20:20:53.913616 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:20:53.920186 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:53.920455 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:53.960073 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:53.961535 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:53.961738 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Languages_Incr__dbt_tmp"
    
20:20:55.552688 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.59 seconds
20:20:55.554311 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:55.554499 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:20:55.592522 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:55.594975 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:55.595184 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:20:55.826885 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:20:55.828907 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Languages_Incr"
20:20:55.829335 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:55.829458 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Languages_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Languages_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Languages_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Languages_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Languages_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Code", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Code", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Languages_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:20:57.224690 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.40 seconds
20:20:57.226584 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Languages_Incr: COMMIT
20:20:57.227771 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
20:20:57.227934 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."#AH_Languages_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Languages_Incr__dbt_tmp"
    end

20:20:57.266454 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:20:57.280216 [debug] [Thread-4  ]: finished collecting timing info
20:20:57.280563 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Languages_Incr: Close
20:20:57.281341 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016544eb50>]}
20:20:57.281809 [info ] [Thread-4  ]: 40 of 101 OK snapshotted stg.AH_Languages_Incr.................................. [[32mOK[0m in 12.61s]
20:20:57.282119 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Languages_Incr
20:20:57.282274 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ListingActions_Incr
20:20:57.282650 [info ] [Thread-4  ]: 43 of 101 START snapshot stg.AH_ListingActions_Incr............................. [RUN]
20:20:57.283035 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingActions_Incr"
20:20:57.283143 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ListingActions_Incr
20:20:57.283242 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ListingActions_Incr
20:20:57.286177 [debug] [Thread-4  ]: finished collecting timing info
20:20:57.286443 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ListingActions_Incr
20:20:57.289730 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:20:57.289925 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:20:57.290011 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:20:57.290115 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:20:57.394216 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:20:57.422627 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:20:57.445957 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:20:57.446251 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:20:57.472834 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:20:57.475230 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:20:57.476052 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingActions_InterView]
        ) as __dbt_sbq
    
20:20:57.561217 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:20:57.583728 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:20:57.584025 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr"
        ) as __dbt_sbq
    
20:20:57.686768 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:20:57.690604 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:20:57.690892 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr'
      and table_schema = 'stg'
  
20:20:57.766138 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:20:57.770000 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:20:57.770265 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
        
  
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActions_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingActions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingActions_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingActions_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingActions_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:20:57.445215'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:20:57.445215'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:20:57.445215''), CONVERT(DATETIME2, ''2022-09-26 20:20:57.445215'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:20:57.445215'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:20:57.445215'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:20:57.445215'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:20:57.445215'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Reason != source_data.Reason
        or
        (
            ((snapshotted_data.Reason is null) and not (source_data.Reason is null))
            or
            ((not snapshotted_data.Reason is null) and (source_data.Reason is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Actiondttm != source_data.Actiondttm
        or
        (
            ((snapshotted_data.Actiondttm is null) and not (source_data.Actiondttm is null))
            or
            ((not snapshotted_data.Actiondttm is null) and (source_data.Actiondttm is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ProxyAmount != source_data.ProxyAmount
        or
        (
            ((snapshotted_data.ProxyAmount is null) and not (source_data.ProxyAmount is null))
            or
            ((not snapshotted_data.ProxyAmount is null) and (source_data.ProxyAmount is null))
        ) or snapshotted_data.Userentered != source_data.Userentered
        or
        (
            ((snapshotted_data.Userentered is null) and not (source_data.Userentered is null))
            or
            ((not snapshotted_data.Userentered is null) and (source_data.Userentered is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Reason != source_data.Reason
        or
        (
            ((snapshotted_data.Reason is null) and not (source_data.Reason is null))
            or
            ((not snapshotted_data.Reason is null) and (source_data.Reason is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Actiondttm != source_data.Actiondttm
        or
        (
            ((snapshotted_data.Actiondttm is null) and not (source_data.Actiondttm is null))
            or
            ((not snapshotted_data.Actiondttm is null) and (source_data.Actiondttm is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ProxyAmount != source_data.ProxyAmount
        or
        (
            ((snapshotted_data.ProxyAmount is null) and not (source_data.ProxyAmount is null))
            or
            ((not snapshotted_data.ProxyAmount is null) and (source_data.ProxyAmount is null))
        ) or snapshotted_data.Userentered != source_data.Userentered
        or
        (
            ((snapshotted_data.Userentered is null) and not (source_data.Userentered is null))
            or
            ((not snapshotted_data.Userentered is null) and (source_data.Userentered is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingActions_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingActions_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActions_Incr__dbt_tmp_temp_view"
    end



    
20:21:09.419291 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 17.79 seconds
20:21:09.422681 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:21:09.422902 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:09.460828 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:09.462343 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:21:09.462534 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    
20:21:10.789403 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.33 seconds
20:21:10.791120 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:21:10.791322 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:10.870576 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:21:10.873296 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:21:10.873502 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:11.067109 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:21:11.070229 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:21:11.070452 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr'
      and table_schema = 'stg'
  
20:21:11.146431 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:21:11.150806 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:21:11.151027 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:11.188819 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:11.190385 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:21:11.190609 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    
20:21:12.338208 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
20:21:12.339839 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:21:12.340034 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:12.391578 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:12.394309 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:21:12.394512 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:12.628205 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:21:12.631381 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:21:12.631601 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr'
      and table_schema = 'stg'
  
20:21:12.695612 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:21:12.700176 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:21:12.700376 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:12.810730 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:21:12.812296 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:21:12.812502 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    
20:21:13.869463 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
20:21:13.871037 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:21:13.871208 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:13.908873 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:13.911411 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:21:13.911609 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:14.132889 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:21:14.135019 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingActionproperties_Incr"
20:21:14.135473 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:21:14.135602 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingActionproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr" (
                  "ID", "BoolnativeValue", "DecimalnativeValue", "CustomFieldID", "IntnativeValue", "ListingActionID", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "BoolnativeValue", "DecimalnativeValue", "CustomFieldID", "IntnativeValue", "ListingActionID", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:21:14.745616 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 24.17 seconds
20:21:14.749278 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:21:14.749499 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:14.920272 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:21:14.921744 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:21:14.921918 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LineItems_Incr__dbt_tmp"
    
20:21:16.300984 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.17 seconds
20:21:16.303104 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingActionproperties_Incr: COMMIT
20:21:16.304153 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
20:21:16.304301 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."#AH_ListingActionproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    end

20:21:16.344421 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:16.358073 [debug] [Thread-1  ]: finished collecting timing info
20:21:16.358382 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingActionproperties_Incr: Close
20:21:16.359134 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016544efd0>]}
20:21:16.359606 [info ] [Thread-1  ]: 42 of 101 OK snapshotted stg.AH_ListingActionproperties_Incr.................... [[32mOK[0m in 25.25s]
20:21:16.359924 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ListingActionproperties_Incr
20:21:16.360074 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ListingCommentsMedias_Incr
20:21:16.360422 [info ] [Thread-1  ]: 44 of 101 START snapshot stg.AH_ListingCommentsMedias_Incr...................... [RUN]
20:21:16.360792 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr"
20:21:16.360899 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ListingCommentsMedias_Incr
20:21:16.360994 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ListingCommentsMedias_Incr
20:21:16.363749 [debug] [Thread-1  ]: finished collecting timing info
20:21:16.363903 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ListingCommentsMedias_Incr
20:21:16.366751 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:16.366889 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:21:16.366970 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:21:16.367068 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:21:16.451909 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.53 seconds
20:21:16.453415 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:21:16.453601 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:16.526309 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:21:16.537135 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:21:16.539003 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 18.77 seconds
20:21:16.541853 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:21:16.542002 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:16.543058 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:21:16.543187 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:16.559419 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:21:16.582925 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:16.583197 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:16.584402 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:21:16.584555 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActions_Incr__dbt_tmp"
    
20:21:16.583343 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:21:16.619526 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:21:16.621714 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:16.621925 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingCommentsMedias_InterView]
        ) as __dbt_sbq
    
20:21:16.684558 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:21:16.707018 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:16.707300 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr"
        ) as __dbt_sbq
    
20:21:16.762222 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:21:16.765502 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:21:16.765711 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr'
      and table_schema = 'stg'
  
20:21:16.782045 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:21:16.786130 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:16.786322 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr'
      and table_schema = 'stg'
  
20:21:16.852298 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:21:16.857228 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:21:16.857451 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:16.873164 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:21:16.876302 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:16.876496 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
        
  
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingCommentsMedias_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:16.601689'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:16.601689'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:21:16.601689''), CONVERT(DATETIME2, ''2022-09-26 20:21:16.601689'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:21:16.601689'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:16.601689'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:16.601689'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:21:16.601689'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.CommentID != source_data.CommentID
        or
        (
            ((snapshotted_data.CommentID is null) and not (source_data.CommentID is null))
            or
            ((not snapshotted_data.CommentID is null) and (source_data.CommentID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.CommentID != source_data.CommentID
        or
        (
            ((snapshotted_data.CommentID is null) and not (source_data.CommentID is null))
            or
            ((not snapshotted_data.CommentID is null) and (source_data.CommentID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view"
    end



    
20:21:16.892950 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:16.894302 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:21:16.894469 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LineItems_Incr__dbt_tmp"
    
20:21:17.259364 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 39.69 seconds
20:21:17.263064 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:21:17.263301 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:17.308915 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:17.310460 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:21:17.310683 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Invoices_Incr__dbt_tmp"
    
20:21:17.866391 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.28 seconds
20:21:17.868044 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:21:17.868224 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:17.881131 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.99 seconds
20:21:17.882481 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:21:17.882660 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:17.914904 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:21:17.917827 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:21:17.917998 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:17.941591 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:21:17.944386 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:21:17.944615 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:18.156026 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:21:18.159258 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:21:18.159498 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr'
      and table_schema = 'stg'
  
20:21:18.170186 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:21:18.172890 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:21:18.173107 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr'
      and table_schema = 'stg'
  
20:21:18.192626 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:21:18.197876 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:21:18.198138 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:18.233476 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:18.235134 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:21:18.235350 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LineItems_Incr__dbt_tmp"
    
20:21:18.236386 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:21:18.240468 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:21:18.240668 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:18.284637 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:18.286243 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:21:18.286451 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActions_Incr__dbt_tmp"
    
20:21:18.521428 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.21 seconds
20:21:18.523082 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:21:18.523270 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:18.601728 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:21:18.605031 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:21:18.605240 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:18.857033 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:21:18.860214 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:21:18.860440 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr'
      and table_schema = 'stg'
  
20:21:18.942583 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:21:18.947920 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:21:18.948141 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:18.990440 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:18.991976 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:21:18.992157 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Invoices_Incr__dbt_tmp"
    
20:21:19.328669 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.09 seconds
20:21:19.330531 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:21:19.330869 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:19.365715 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:21:19.368653 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:21:19.368849 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:19.449956 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
20:21:19.451527 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:21:19.451714 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:19.505492 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:19.508093 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:21:19.508274 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:19.726183 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
20:21:19.728770 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_LineItems_Incr"
20:21:19.729235 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:21:19.729369 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_LineItems_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_LineItems_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_LineItems_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_LineItems_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_LineItems_Incr" (
                  "ID", "Currency", "Status", "Type", "LotNumber", "Description", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "InvoiceID", "ListingID", "Quantity", "OwnerID", "PayerID", "ReListiteration", "AuctionEventID", "TotalAmount", "PeRunitAmount", "Taxable", "IsArchived", "BuyersPremiuMapplies", "IsPayerArchived", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Currency", "Status", "Type", "LotNumber", "Description", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "InvoiceID", "ListingID", "Quantity", "OwnerID", "PayerID", "ReListiteration", "AuctionEventID", "TotalAmount", "PeRunitAmount", "Taxable", "IsArchived", "BuyersPremiuMapplies", "IsPayerArchived", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_LineItems_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:21:19.729646 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:21:19.732510 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:21:19.732667 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr'
      and table_schema = 'stg'
  
20:21:19.765275 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:21:19.772403 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:21:19.772653 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:19.812639 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:19.814198 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:21:19.814378 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActions_Incr__dbt_tmp"
    
20:21:20.223290 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.23 seconds
20:21:20.224905 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:21:20.225091 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:20.277863 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:20.281440 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:21:20.281637 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:20.575348 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
20:21:20.578389 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:21:20.578619 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr'
      and table_schema = 'stg'
  
20:21:20.614698 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:20.619989 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:21:20.620211 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:20.688564 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:21:20.690098 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:21:20.690281 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Invoices_Incr__dbt_tmp"
    
20:21:20.713097 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.90 seconds
20:21:20.714686 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:21:20.714857 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:20.750799 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:20.753574 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:21:20.753780 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:20.960739 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:21:20.963133 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingActions_Incr"
20:21:20.963558 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:21:20.963689 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingActions_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr" (
                  "ID", "Description", "LastUpdatedUser", "Reason", "Status", "CreatedOn", "UpdatedOn", "DeletedOn", "Actiondttm", "Amount", "ProxyAmount", "Userentered", "UserID", "ListingID", "Quantity", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Description", "LastUpdatedUser", "Reason", "Status", "CreatedOn", "UpdatedOn", "DeletedOn", "Actiondttm", "Amount", "ProxyAmount", "Userentered", "UserID", "ListingID", "Quantity", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingActions_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:21:21.363526 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.63 seconds
20:21:21.365636 [debug] [Thread-3  ]: On snapshot.Shawn.AH_LineItems_Incr: COMMIT
20:21:21.366729 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
20:21:21.366908 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."#AH_LineItems_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_LineItems_Incr__dbt_tmp"
    end

20:21:21.412989 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:21.426046 [debug] [Thread-3  ]: finished collecting timing info
20:21:21.426349 [debug] [Thread-3  ]: On snapshot.Shawn.AH_LineItems_Incr: Close
20:21:21.427104 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016425cf70>]}
20:21:21.427533 [info ] [Thread-3  ]: 41 of 101 OK snapshotted stg.AH_LineItems_Incr.................................. [[32mOK[0m in 31.37s]
20:21:21.427849 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_LineItems_Incr
20:21:21.427997 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ListingComments_Incr
20:21:21.428343 [info ] [Thread-3  ]: 45 of 101 START snapshot stg.AH_ListingComments_Incr............................ [RUN]
20:21:21.428695 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingComments_Incr"
20:21:21.428801 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ListingComments_Incr
20:21:21.428898 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ListingComments_Incr
20:21:21.431607 [debug] [Thread-3  ]: finished collecting timing info
20:21:21.431752 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ListingComments_Incr
20:21:21.434491 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:21.434650 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:21:21.434733 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:21:21.434832 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:21:21.559251 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:21:21.590367 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:21:21.613577 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:21.613855 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:21:21.642296 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:21:21.644469 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:21.644925 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingComments_InterView]
        ) as __dbt_sbq
    
20:21:21.736608 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:21:21.760365 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:21.760660 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr"
        ) as __dbt_sbq
    
20:21:21.942654 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:21:21.946217 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:21.946433 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr'
      and table_schema = 'stg'
  
20:21:22.026721 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:21:22.030676 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:22.030873 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
        
  
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingComments_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingComments_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingComments_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingComments_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingComments_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:21.617441'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:21.617441'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:21:21.617441''), CONVERT(DATETIME2, ''2022-09-26 20:21:21.617441'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:21:21.617441'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:21.617441'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:21.617441'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:21:21.617441'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.IsBID != source_data.IsBID
        or
        (
            ((snapshotted_data.IsBID is null) and not (source_data.IsBID is null))
            or
            ((not snapshotted_data.IsBID is null) and (source_data.IsBID is null))
        ) or snapshotted_data.Approved != source_data.Approved
        or
        (
            ((snapshotted_data.Approved is null) and not (source_data.Approved is null))
            or
            ((not snapshotted_data.Approved is null) and (source_data.Approved is null))
        ) or snapshotted_data.ParentID != source_data.ParentID
        or
        (
            ((snapshotted_data.ParentID is null) and not (source_data.ParentID is null))
            or
            ((not snapshotted_data.ParentID is null) and (source_data.ParentID is null))
        ) or snapshotted_data.ReportCount != source_data.ReportCount
        or
        (
            ((snapshotted_data.ReportCount is null) and not (source_data.ReportCount is null))
            or
            ((not snapshotted_data.ReportCount is null) and (source_data.ReportCount is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.IsBID != source_data.IsBID
        or
        (
            ((snapshotted_data.IsBID is null) and not (source_data.IsBID is null))
            or
            ((not snapshotted_data.IsBID is null) and (source_data.IsBID is null))
        ) or snapshotted_data.Approved != source_data.Approved
        or
        (
            ((snapshotted_data.Approved is null) and not (source_data.Approved is null))
            or
            ((not snapshotted_data.Approved is null) and (source_data.Approved is null))
        ) or snapshotted_data.ParentID != source_data.ParentID
        or
        (
            ((snapshotted_data.ParentID is null) and not (source_data.ParentID is null))
            or
            ((not snapshotted_data.ParentID is null) and (source_data.ParentID is null))
        ) or snapshotted_data.ReportCount != source_data.ReportCount
        or
        (
            ((snapshotted_data.ReportCount is null) and not (source_data.ReportCount is null))
            or
            ((not snapshotted_data.ReportCount is null) and (source_data.ReportCount is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingComments_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingComments_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingComments_Incr__dbt_tmp_temp_view"
    end



    
20:21:22.168083 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.48 seconds
20:21:22.169553 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:21:22.169750 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:22.205063 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:22.208616 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:21:22.208802 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:22.529004 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
20:21:22.532278 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Invoices_Incr"
20:21:22.532734 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:21:22.532853 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Invoices_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Invoices_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Invoices_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Invoices_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Invoices_Incr" (
                  "ID", "Paiddttm", "CreatedOn", "UpdatedOn", "DeletedOn", "Createddttm", "Fulfilleddttm", "PropertybagID", "ShippingOptionID", "PayerID", "OwnerID", "AuctionEventID", "SalesTax", "BuyersPremiumPercent", "BuyersPremiumAmount", "ShippingAmount", "SubTotal", "Total", "IsPayerLocked", "Shipped", "IsArchived", "Status", "ShippingLastName", "BillingLastName", "OwnerName", "Shippingdetails", "OwnerCity", "OwnerStateregion", "OwnerzipPostal", "OwnerCountry", "ShippingFirstName", "BillingFirstName", "BillingCity", "BillingStateregion", "BillingzipPostal", "BillingCountry", "OwnerStreet1", "OwnerStreet2", "ShippingCity", "ShippingStateregion", "ShippingzipPostal", "ShippingCountry", "BillingStreet1", "BillingStreet2", "Comments", "LastUpdatedUser", "Currency", "Type", "ShippingStreet1", "ShippingStreet2", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Paiddttm", "CreatedOn", "UpdatedOn", "DeletedOn", "Createddttm", "Fulfilleddttm", "PropertybagID", "ShippingOptionID", "PayerID", "OwnerID", "AuctionEventID", "SalesTax", "BuyersPremiumPercent", "BuyersPremiumAmount", "ShippingAmount", "SubTotal", "Total", "IsPayerLocked", "Shipped", "IsArchived", "Status", "ShippingLastName", "BillingLastName", "OwnerName", "Shippingdetails", "OwnerCity", "OwnerStateregion", "OwnerzipPostal", "OwnerCountry", "ShippingFirstName", "BillingFirstName", "BillingCity", "BillingStateregion", "BillingzipPostal", "BillingCountry", "OwnerStreet1", "OwnerStreet2", "ShippingCity", "ShippingStateregion", "ShippingzipPostal", "ShippingCountry", "BillingStreet1", "BillingStreet2", "Comments", "LastUpdatedUser", "Currency", "Type", "ShippingStreet1", "ShippingStreet2", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Invoices_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:21:22.542892 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.58 seconds
20:21:22.544437 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingActions_Incr: COMMIT
20:21:22.545598 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
20:21:22.545744 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."#AH_ListingActions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingActions_Incr__dbt_tmp"
    end

20:21:22.582735 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:22.596624 [debug] [Thread-4  ]: finished collecting timing info
20:21:22.596961 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingActions_Incr: Close
20:21:22.597752 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654d00d0>]}
20:21:22.598255 [info ] [Thread-4  ]: 43 of 101 OK snapshotted stg.AH_ListingActions_Incr............................. [[32mOK[0m in 25.31s]
20:21:22.598631 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ListingActions_Incr
20:21:22.598794 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ListingEnddttmAudit_Incr
20:21:22.599151 [info ] [Thread-4  ]: 46 of 101 START snapshot stg.AH_ListingEnddttmAudit_Incr........................ [RUN]
20:21:22.599552 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr"
20:21:22.599662 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ListingEnddttmAudit_Incr
20:21:22.599761 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ListingEnddttmAudit_Incr
20:21:22.602773 [debug] [Thread-4  ]: finished collecting timing info
20:21:22.602951 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ListingEnddttmAudit_Incr
20:21:22.605983 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:22.606136 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:21:22.606223 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:21:22.606323 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:21:22.719314 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:21:22.749233 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:21:22.777411 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:22.777695 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:21:22.809906 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:21:22.811992 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:22.812511 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingEnddttmAudit_InterView]
        ) as __dbt_sbq
    
20:21:22.866798 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:22.889598 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:22.889889 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr"
        ) as __dbt_sbq
    
20:21:22.958316 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:21:22.961810 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:22.962025 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr'
      and table_schema = 'stg'
  
20:21:23.039857 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:21:23.043620 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:23.043817 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
        
  
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingEnddttmAudit_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:22.789333'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:22.789333'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:21:22.789333''), CONVERT(DATETIME2, ''2022-09-26 20:21:22.789333'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:21:22.789333'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:22.789333'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:22.789333'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:21:22.789333'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.SourceListingID != source_data.SourceListingID
        or
        (
            ((snapshotted_data.SourceListingID is null) and not (source_data.SourceListingID is null))
            or
            ((not snapshotted_data.SourceListingID is null) and (source_data.SourceListingID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Origin != source_data.Origin
        or
        (
            ((snapshotted_data.Origin is null) and not (source_data.Origin is null))
            or
            ((not snapshotted_data.Origin is null) and (source_data.Origin is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.SourceListingID != source_data.SourceListingID
        or
        (
            ((snapshotted_data.SourceListingID is null) and not (source_data.SourceListingID is null))
            or
            ((not snapshotted_data.SourceListingID is null) and (source_data.SourceListingID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Origin != source_data.Origin
        or
        (
            ((snapshotted_data.Origin is null) and not (source_data.Origin is null))
            or
            ((not snapshotted_data.Origin is null) and (source_data.Origin is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view"
    end



    
20:21:24.981432 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.45 seconds
20:21:24.983247 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Invoices_Incr: COMMIT
20:21:24.984038 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
20:21:24.984180 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."#AH_Invoices_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Invoices_Incr__dbt_tmp"
    end

20:21:25.027649 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:25.041989 [debug] [Thread-2  ]: finished collecting timing info
20:21:25.042320 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Invoices_Incr: Close
20:21:25.043133 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016544e8b0>]}
20:21:25.043618 [info ] [Thread-2  ]: 38 of 101 OK snapshotted stg.AH_Invoices_Incr................................... [[32mOK[0m in 48.04s]
20:21:25.043952 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Invoices_Incr
20:21:25.044111 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ListingLocations_Incr
20:21:25.044472 [info ] [Thread-2  ]: 47 of 101 START snapshot stg.AH_ListingLocations_Incr........................... [RUN]
20:21:25.044863 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingLocations_Incr"
20:21:25.044981 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ListingLocations_Incr
20:21:25.045075 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ListingLocations_Incr
20:21:25.047846 [debug] [Thread-2  ]: finished collecting timing info
20:21:25.048000 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ListingLocations_Incr
20:21:25.050833 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:25.050968 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:21:25.051050 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:21:25.051147 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:21:25.164329 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:21:25.196275 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:21:25.219915 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:25.220199 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:21:25.246895 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:21:25.249146 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:25.249694 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingLocations_InterView]
        ) as __dbt_sbq
    
20:21:25.309312 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:21:25.332241 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:25.332524 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr"
        ) as __dbt_sbq
    
20:21:25.376795 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:25.380391 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:25.380608 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr'
      and table_schema = 'stg'
  
20:21:25.573334 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:21:25.577223 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:25.577473 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
        
  
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingLocations_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingLocations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingLocations_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingLocations_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingLocations_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:25.226863'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:25.226863'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:21:25.226863''), CONVERT(DATETIME2, ''2022-09-26 20:21:25.226863'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:21:25.226863'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:25.226863'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:25.226863'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:21:25.226863'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LocationID != source_data.LocationID
        or
        (
            ((snapshotted_data.LocationID is null) and not (source_data.LocationID is null))
            or
            ((not snapshotted_data.LocationID is null) and (source_data.LocationID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LocationID != source_data.LocationID
        or
        (
            ((snapshotted_data.LocationID is null) and not (source_data.LocationID is null))
            or
            ((not snapshotted_data.LocationID is null) and (source_data.LocationID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingLocations_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingLocations_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingLocations_Incr__dbt_tmp_temp_view"
    end



    
20:21:25.634622 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 8.76 seconds
20:21:25.638962 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:25.639211 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:25.703716 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:21:25.705299 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:25.705485 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    
20:21:26.813463 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.11 seconds
20:21:26.815462 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:26.815649 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:26.908912 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:21:26.911369 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:26.911553 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:27.147671 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:21:27.150651 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:27.150884 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr'
      and table_schema = 'stg'
  
20:21:27.184610 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:21:27.188764 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:27.189011 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:27.230237 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:27.231708 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:27.231873 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    
20:21:28.526605 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.29 seconds
20:21:28.528270 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:28.528490 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:28.578196 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:28.580836 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:28.581073 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:29.205558 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.62 seconds
20:21:29.208774 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:29.209037 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr'
      and table_schema = 'stg'
  
20:21:29.247610 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:29.251847 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:29.252100 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:29.384318 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:21:29.385909 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:29.386123 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    
20:21:30.474349 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.09 seconds
20:21:30.476036 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:30.476246 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:30.551824 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 7.51 seconds
20:21:30.555424 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:30.555678 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:30.568907 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:21:30.571436 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:30.571673 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:30.602498 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:30.604033 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:30.604225 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    
20:21:30.815039 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:21:30.817021 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingCommentsMedias_Incr"
20:21:30.817489 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:30.817617 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr" (
                  "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "MediaID", "CommentID", "DisplayOrder", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "MediaID", "CommentID", "DisplayOrder", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:21:31.862387 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.26 seconds
20:21:31.864355 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:31.864528 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:31.943443 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:21:31.946176 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:31.946375 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:31.947411 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.37 seconds
20:21:31.950166 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:31.950314 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:31.985324 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:21:31.986937 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:31.987153 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingLocations_Incr__dbt_tmp"
    
20:21:32.193950 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:21:32.196670 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:32.196901 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr'
      and table_schema = 'stg'
  
20:21:32.240744 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:32.245054 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:32.245314 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:32.292830 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:32.294730 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:32.294943 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    
20:21:32.721162 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.90 seconds
20:21:32.722961 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: COMMIT
20:21:32.723755 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
20:21:32.723900 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    end

20:21:32.771086 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:32.786400 [debug] [Thread-1  ]: finished collecting timing info
20:21:32.786775 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: Close
20:21:32.787581 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654d0370>]}
20:21:32.788078 [info ] [Thread-1  ]: 44 of 101 OK snapshotted stg.AH_ListingCommentsMedias_Incr...................... [[32mOK[0m in 16.43s]
20:21:32.788403 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ListingCommentsMedias_Incr
20:21:32.788560 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ListingMedias_Incr
20:21:32.788917 [info ] [Thread-1  ]: 48 of 101 START snapshot stg.AH_ListingMedias_Incr.............................. [RUN]
20:21:32.789297 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingMedias_Incr"
20:21:32.789422 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ListingMedias_Incr
20:21:32.789519 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ListingMedias_Incr
20:21:32.792409 [debug] [Thread-1  ]: finished collecting timing info
20:21:32.792572 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ListingMedias_Incr
20:21:32.795592 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:32.795745 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:21:32.795828 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:21:32.795990 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:21:32.921973 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:21:32.952520 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:21:32.976413 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:32.976703 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:21:33.014493 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:33.016652 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:33.017202 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingMedias_InterView]
        ) as __dbt_sbq
    
20:21:33.047545 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
20:21:33.049269 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:33.049483 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:33.073687 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:21:33.096604 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:33.096882 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr"
        ) as __dbt_sbq
    
20:21:33.116827 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:21:33.119300 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:33.119505 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:33.163147 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:21:33.167098 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:33.167335 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr'
      and table_schema = 'stg'
  
20:21:33.188384 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.89 seconds
20:21:33.189891 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:33.190106 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:33.225794 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:33.228383 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:33.228612 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:33.234584 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:21:33.237756 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:33.237957 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
        
  
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingMedias_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingMedias_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingMedias_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingMedias_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:32.977050'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:32.977050'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:21:32.977050''), CONVERT(DATETIME2, ''2022-09-26 20:21:32.977050'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:21:32.977050'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:32.977050'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:32.977050'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:21:32.977050'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingMedias_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingMedias_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingMedias_Incr__dbt_tmp_temp_view"
    end



    
20:21:33.314448 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:21:33.317589 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:33.317809 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr'
      and table_schema = 'stg'
  
20:21:33.350970 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:21:33.355301 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:33.355553 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:33.398175 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:33.399663 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:33.399826 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingLocations_Incr__dbt_tmp"
    
20:21:33.424828 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:21:33.428052 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:33.428282 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr'
      and table_schema = 'stg'
  
20:21:33.469155 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:33.473495 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:33.473758 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:33.517148 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:33.518676 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:33.518873 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    
20:21:35.079399 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.56 seconds
20:21:35.080957 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:35.081172 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:35.191064 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:21:35.193468 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:35.193708 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:35.250965 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.85 seconds
20:21:35.252671 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:35.252915 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:35.403711 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:21:35.406678 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:35.406899 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:35.769229 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.58 seconds
20:21:35.771291 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingEnddttmAudit_Incr"
20:21:35.771721 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:35.771843 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr" (
                  "ID", "SqlDaTestamp", "Enddttm", "SourceListingID", "ListingID", "Origin", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SqlDaTestamp", "Enddttm", "SourceListingID", "ListingID", "Origin", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:21:35.848038 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.44 seconds
20:21:35.851054 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:35.851260 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr'
      and table_schema = 'stg'
  
20:21:35.896701 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:35.901106 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:35.901362 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:35.951367 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:35.953135 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:35.953316 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingLocations_Incr__dbt_tmp"
    
20:21:36.445024 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 14.41 seconds
20:21:36.448671 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:36.448929 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:36.745195 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:21:36.746804 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:36.747006 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingComments_Incr__dbt_tmp"
    
20:21:37.575044 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.62 seconds
20:21:37.576707 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:37.576899 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:37.748986 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:21:37.751629 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:37.751867 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:37.752631 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.98 seconds
20:21:37.753975 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: COMMIT
20:21:37.754730 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
20:21:37.754872 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    end

20:21:37.803582 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:37.909852 [debug] [Thread-4  ]: finished collecting timing info
20:21:37.910192 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: Close
20:21:37.911045 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654d04c0>]}
20:21:37.911520 [info ] [Thread-4  ]: 46 of 101 OK snapshotted stg.AH_ListingEnddttmAudit_Incr........................ [[32mOK[0m in 15.31s]
20:21:37.911846 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ListingEnddttmAudit_Incr
20:21:37.911997 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ListingPaymentCharge_Incr
20:21:37.912353 [info ] [Thread-4  ]: 49 of 101 START snapshot stg.AH_ListingPaymentCharge_Incr....................... [RUN]
20:21:37.912736 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr"
20:21:37.912845 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ListingPaymentCharge_Incr
20:21:37.912941 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ListingPaymentCharge_Incr
20:21:37.915904 [debug] [Thread-4  ]: finished collecting timing info
20:21:37.916065 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ListingPaymentCharge_Incr
20:21:37.918822 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:37.918966 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:21:37.919048 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:21:37.919149 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:21:37.962500 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.22 seconds
20:21:37.964176 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:37.964361 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:37.972878 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:21:37.974781 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingLocations_Incr"
20:21:37.975172 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:37.975342 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingLocations_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr" (
                  "ID", "LocationID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "LocationID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingLocations_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:21:38.021240 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:21:38.031333 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:21:38.033842 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:38.034052 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:38.047619 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:21:38.071666 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:38.071966 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:21:38.105600 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:21:38.108215 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:38.108439 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingPaymentCharge_InterView]
        ) as __dbt_sbq
    
20:21:38.171249 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:21:38.194286 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:38.194598 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr"
        ) as __dbt_sbq
    
20:21:38.225190 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:21:38.228169 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:38.228394 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr'
      and table_schema = 'stg'
  
20:21:38.265815 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:38.271462 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:38.271719 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:38.414638 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:21:38.418315 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:38.418630 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr'
      and table_schema = 'stg'
  
20:21:38.526748 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:21:38.528373 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:38.528573 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingComments_Incr__dbt_tmp"
    
20:21:38.718864 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:21:38.722857 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:38.723111 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
        
  
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingPaymentCharge_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:38.070842'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:38.070842'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:21:38.070842''), CONVERT(DATETIME2, ''2022-09-26 20:21:38.070842'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:21:38.070842'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:38.070842'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:38.070842'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:21:38.070842'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.ChargeAmount != source_data.ChargeAmount
        or
        (
            ((snapshotted_data.ChargeAmount is null) and not (source_data.ChargeAmount is null))
            or
            ((not snapshotted_data.ChargeAmount is null) and (source_data.ChargeAmount is null))
        ) or snapshotted_data.TotalBID != source_data.TotalBID
        or
        (
            ((snapshotted_data.TotalBID is null) and not (source_data.TotalBID is null))
            or
            ((not snapshotted_data.TotalBID is null) and (source_data.TotalBID is null))
        ) or snapshotted_data.BidHoldPercentage != source_data.BidHoldPercentage
        or
        (
            ((snapshotted_data.BidHoldPercentage is null) and not (source_data.BidHoldPercentage is null))
            or
            ((not snapshotted_data.BidHoldPercentage is null) and (source_data.BidHoldPercentage is null))
        ) or snapshotted_data.MaximumBidCharge != source_data.MaximumBidCharge
        or
        (
            ((snapshotted_data.MaximumBidCharge is null) and not (source_data.MaximumBidCharge is null))
            or
            ((not snapshotted_data.MaximumBidCharge is null) and (source_data.MaximumBidCharge is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.ChargeAmount != source_data.ChargeAmount
        or
        (
            ((snapshotted_data.ChargeAmount is null) and not (source_data.ChargeAmount is null))
            or
            ((not snapshotted_data.ChargeAmount is null) and (source_data.ChargeAmount is null))
        ) or snapshotted_data.TotalBID != source_data.TotalBID
        or
        (
            ((snapshotted_data.TotalBID is null) and not (source_data.TotalBID is null))
            or
            ((not snapshotted_data.TotalBID is null) and (source_data.TotalBID is null))
        ) or snapshotted_data.BidHoldPercentage != source_data.BidHoldPercentage
        or
        (
            ((snapshotted_data.BidHoldPercentage is null) and not (source_data.BidHoldPercentage is null))
            or
            ((not snapshotted_data.BidHoldPercentage is null) and (source_data.BidHoldPercentage is null))
        ) or snapshotted_data.MaximumBidCharge != source_data.MaximumBidCharge
        or
        (
            ((snapshotted_data.MaximumBidCharge is null) and not (source_data.MaximumBidCharge is null))
            or
            ((not snapshotted_data.MaximumBidCharge is null) and (source_data.MaximumBidCharge is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view"
    end



    
20:21:39.800110 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.27 seconds
20:21:39.801588 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:39.801788 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:39.835729 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:21:39.838397 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:39.838605 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:39.856045 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.88 seconds
20:21:39.857565 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingLocations_Incr: COMMIT
20:21:39.858692 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
20:21:39.858842 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."#AH_ListingLocations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingLocations_Incr__dbt_tmp"
    end

20:21:40.107015 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:21:40.120297 [debug] [Thread-2  ]: finished collecting timing info
20:21:40.120607 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingLocations_Incr: Close
20:21:40.121331 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016544edf0>]}
20:21:40.121770 [info ] [Thread-2  ]: 47 of 101 OK snapshotted stg.AH_ListingLocations_Incr........................... [[32mOK[0m in 15.08s]
20:21:40.122078 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ListingLocations_Incr
20:21:40.122234 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ListingQuestions_Incr
20:21:40.122594 [info ] [Thread-2  ]: 50 of 101 START snapshot stg.AH_ListingQuestions_Incr........................... [RUN]
20:21:40.122966 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr"
20:21:40.123075 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ListingQuestions_Incr
20:21:40.123168 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ListingQuestions_Incr
20:21:40.125813 [debug] [Thread-2  ]: finished collecting timing info
20:21:40.125956 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ListingQuestions_Incr
20:21:40.128726 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:40.128860 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:21:40.128941 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:21:40.129037 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:21:40.234599 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:21:40.268518 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:21:40.291718 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:40.291998 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:21:40.316611 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.48 seconds
20:21:40.319784 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:40.319988 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr'
      and table_schema = 'stg'
  
20:21:40.334347 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:40.336291 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:40.336465 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingQuestions_InterView]
        ) as __dbt_sbq
    
20:21:40.376032 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:21:40.380793 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:40.381028 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:40.406912 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:21:40.429624 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:40.429868 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:40.431086 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:40.431255 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingComments_Incr__dbt_tmp"
    
20:21:40.430008 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr"
        ) as __dbt_sbq
    
20:21:40.617099 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:21:40.621096 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:40.621354 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr'
      and table_schema = 'stg'
  
20:21:40.700019 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:21:40.704078 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:40.704366 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
        
  
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingQuestions_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingQuestions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingQuestions_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingQuestions_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:40.305189'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:40.305189'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:21:40.305189''), CONVERT(DATETIME2, ''2022-09-26 20:21:40.305189'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:21:40.305189'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:40.305189'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:40.305189'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:21:40.305189'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Question != source_data.Question
        or
        (
            ((snapshotted_data.Question is null) and not (source_data.Question is null))
            or
            ((not snapshotted_data.Question is null) and (source_data.Question is null))
        ) or snapshotted_data.Answer != source_data.Answer
        or
        (
            ((snapshotted_data.Answer is null) and not (source_data.Answer is null))
            or
            ((not snapshotted_data.Answer is null) and (source_data.Answer is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Question != source_data.Question
        or
        (
            ((snapshotted_data.Question is null) and not (source_data.Question is null))
            or
            ((not snapshotted_data.Question is null) and (source_data.Question is null))
        ) or snapshotted_data.Answer != source_data.Answer
        or
        (
            ((snapshotted_data.Answer is null) and not (source_data.Answer is null))
            or
            ((not snapshotted_data.Answer is null) and (source_data.Answer is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingQuestions_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingQuestions_Incr__dbt_tmp_temp_view"
    end



    
20:21:41.351309 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.92 seconds
20:21:41.352851 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:41.353010 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:41.390800 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:41.393546 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:41.393730 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:41.631271 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:21:41.633593 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingComments_Incr"
20:21:41.634034 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:41.634173 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingComments_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr" (
                  "ID", "IsBID", "Approved", "ParentID", "ReportCount", "UserID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "UserName", "Comment", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "IsBID", "Approved", "ParentID", "ReportCount", "UserID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "UserName", "Comment", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingComments_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:21:43.298234 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.66 seconds
20:21:43.300676 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingComments_Incr: COMMIT
20:21:43.301451 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
20:21:43.301594 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."#AH_ListingComments_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingComments_Incr__dbt_tmp"
    end

20:21:43.407300 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:21:43.421080 [debug] [Thread-3  ]: finished collecting timing info
20:21:43.421398 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingComments_Incr: Close
20:21:43.422114 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0164212730>]}
20:21:43.422630 [info ] [Thread-3  ]: 45 of 101 OK snapshotted stg.AH_ListingComments_Incr............................ [[32mOK[0m in 21.99s]
20:21:43.422962 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ListingComments_Incr
20:21:43.423103 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr
20:21:43.423439 [info ] [Thread-3  ]: 51 of 101 START snapshot stg.AH_ListingTypeFeeprovIDErs_Incr.................... [RUN]
20:21:43.423810 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr"
20:21:43.423917 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr
20:21:43.424013 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr
20:21:43.426799 [debug] [Thread-3  ]: finished collecting timing info
20:21:43.426950 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr
20:21:43.429723 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:43.429867 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:21:43.429950 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:21:43.430049 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:21:43.565334 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:21:43.599078 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:21:43.622760 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:43.623019 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:21:43.681982 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:21:43.684169 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:43.684648 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingTypeFeeprovIDErs_InterView]
        ) as __dbt_sbq
    
20:21:43.774293 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:21:43.797097 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:43.797374 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr"
        ) as __dbt_sbq
    
20:21:43.869167 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:21:43.872665 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:43.872839 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr'
      and table_schema = 'stg'
  
20:21:43.980054 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:21:43.983986 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:43.984233 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
        
  
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingTypeFeeprovIDErs_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:43.649006'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:43.649006'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:21:43.649006''), CONVERT(DATETIME2, ''2022-09-26 20:21:43.649006'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:21:43.649006'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:43.649006'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:43.649006'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:21:43.649006'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ProvIDErName != source_data.ProvIDErName
        or
        (
            ((snapshotted_data.ProvIDErName is null) and not (source_data.ProvIDErName is null))
            or
            ((not snapshotted_data.ProvIDErName is null) and (source_data.ProvIDErName is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ProvIDErName != source_data.ProvIDErName
        or
        (
            ((snapshotted_data.ProvIDErName is null) and not (source_data.ProvIDErName is null))
            or
            ((not snapshotted_data.ProvIDErName is null) and (source_data.ProvIDErName is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view"
    end



    
20:21:45.283258 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 12.05 seconds
20:21:45.286933 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:45.287174 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:45.345500 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:21:45.347110 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:45.347314 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingMedias_Incr__dbt_tmp"
    
20:21:46.505879 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
20:21:46.507410 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:46.507608 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:46.581642 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:21:46.584319 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:46.584540 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:46.818471 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:21:46.821677 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:46.821897 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr'
      and table_schema = 'stg'
  
20:21:46.855309 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:21:46.860054 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:46.860262 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:46.940829 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:21:46.942439 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:46.942668 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingMedias_Incr__dbt_tmp"
    
20:21:47.454739 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 8.73 seconds
20:21:47.458112 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:47.458295 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:47.502095 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:47.503677 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:47.503851 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    
20:21:47.907316 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
20:21:47.908975 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:47.909166 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:47.974245 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:21:47.976897 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:47.977092 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:48.231878 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:21:48.234936 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:48.235119 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr'
      and table_schema = 'stg'
  
20:21:48.274212 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:48.278425 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:48.278626 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:48.357296 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:21:48.359925 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:48.360115 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingMedias_Incr__dbt_tmp"
    
20:21:48.519879 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.02 seconds
20:21:48.521490 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:48.521674 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:48.604039 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:21:48.606735 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:48.606932 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:48.931754 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
20:21:48.934937 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:48.935153 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr'
      and table_schema = 'stg'
  
20:21:48.968185 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:21:48.972315 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:48.972501 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:49.021930 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:49.023502 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:49.023686 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    
20:21:49.685210 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.32 seconds
20:21:49.686801 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:49.686995 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:49.728204 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:49.730481 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:49.730678 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:49.872714 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 9.17 seconds
20:21:49.876347 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:49.876570 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:49.901108 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
20:21:49.902782 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:49.902955 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:49.942061 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:49.944213 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 5.96 seconds
20:21:49.947403 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:49.947570 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:21:49.949537 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:49.949678 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    
20:21:49.948570 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:49.948411 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:49.949982 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:49.969879 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:21:49.971847 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingMedias_Incr"
20:21:49.972228 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:49.972343 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingMedias_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaID", "ListingID", "DisplayOrder", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaID", "ListingID", "DisplayOrder", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingMedias_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:21:49.987175 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:49.988456 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:49.988610 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    
20:21:50.475420 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.53 seconds
20:21:50.478611 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:50.478830 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr'
      and table_schema = 'stg'
  
20:21:50.525532 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:50.530013 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:50.530212 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:50.587612 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:21:50.589226 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:50.589435 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    
20:21:51.455426 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.51 seconds
20:21:51.457052 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:51.457236 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:51.528515 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:21:51.531301 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:51.531500 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:51.690346 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.70 seconds
20:21:51.691986 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:51.692168 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:51.692361 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
20:21:51.693458 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:51.693595 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:51.732826 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:51.735401 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:51.735603 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:51.769502 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:21:51.772340 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:51.772539 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr'
      and table_schema = 'stg'
  
20:21:51.786851 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:21:51.791390 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:51.791567 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:51.806969 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:21:51.810812 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:51.810994 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:51.833027 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.86 seconds
20:21:51.834845 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingMedias_Incr: COMMIT
20:21:51.835651 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
20:21:51.835800 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."#AH_ListingMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingMedias_Incr__dbt_tmp"
    end

20:21:51.854172 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:51.855774 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:51.855963 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    
20:21:51.877298 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:51.890522 [debug] [Thread-1  ]: finished collecting timing info
20:21:51.890889 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingMedias_Incr: Close
20:21:51.891656 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654d0610>]}
20:21:51.892135 [info ] [Thread-1  ]: 48 of 101 OK snapshotted stg.AH_ListingMedias_Incr.............................. [[32mOK[0m in 19.10s]
20:21:51.892462 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ListingMedias_Incr
20:21:51.892621 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ListingTypeMedia_Incr
20:21:51.892986 [info ] [Thread-1  ]: 52 of 101 START snapshot stg.AH_ListingTypeMedia_Incr........................... [RUN]
20:21:51.893376 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr"
20:21:51.893484 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ListingTypeMedia_Incr
20:21:51.893580 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ListingTypeMedia_Incr
20:21:51.896498 [debug] [Thread-1  ]: finished collecting timing info
20:21:51.896667 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ListingTypeMedia_Incr
20:21:51.899683 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:21:51.899836 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:21:51.899920 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:21:51.900024 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:21:51.951755 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:21:51.953989 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingPaymentCharge_Incr"
20:21:51.954433 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:51.954604 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr" (
                  "ID", "BuyerID", "ListingID", "UpdatedOn", "CreatedOn", "TransactionID", "ChargeAmount", "TotalBID", "BidHoldPercentage", "MaximumBidCharge", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "BuyerID", "ListingID", "UpdatedOn", "CreatedOn", "TransactionID", "ChargeAmount", "TotalBID", "BidHoldPercentage", "MaximumBidCharge", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:21:51.973779 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:21:51.976611 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:51.976794 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr'
      and table_schema = 'stg'
  
20:21:51.997424 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:21:52.016578 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:52.020965 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:52.021188 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:52.032232 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:21:52.054823 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:21:52.055051 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:21:52.073931 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:52.075510 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:52.075709 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    
20:21:52.105597 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:52.107764 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:21:52.107954 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingTypeMedia_InterView]
        ) as __dbt_sbq
    
20:21:52.173081 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:21:52.195577 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:21:52.195852 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr"
        ) as __dbt_sbq
    
20:21:52.251301 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:21:52.255357 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:21:52.255590 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr'
      and table_schema = 'stg'
  
20:21:52.342207 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:21:52.346101 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:21:52.346318 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
        
  
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingTypeMedia_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingTypeMedia_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:52.070906'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:52.070906'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:21:52.070906''), CONVERT(DATETIME2, ''2022-09-26 20:21:52.070906'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:21:52.070906'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:52.070906'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:52.070906'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:21:52.070906'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaassetName != source_data.MediaassetName
        or
        (
            ((snapshotted_data.MediaassetName is null) and not (source_data.MediaassetName is null))
            or
            ((not snapshotted_data.MediaassetName is null) and (source_data.MediaassetName is null))
        ) or snapshotted_data.Scope != source_data.Scope
        or
        (
            ((snapshotted_data.Scope is null) and not (source_data.Scope is null))
            or
            ((not snapshotted_data.Scope is null) and (source_data.Scope is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaassetName != source_data.MediaassetName
        or
        (
            ((snapshotted_data.MediaassetName is null) and not (source_data.MediaassetName is null))
            or
            ((not snapshotted_data.MediaassetName is null) and (source_data.MediaassetName is null))
        ) or snapshotted_data.Scope != source_data.Scope
        or
        (
            ((snapshotted_data.Scope is null) and not (source_data.Scope is null))
            or
            ((not snapshotted_data.Scope is null) and (source_data.Scope is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingTypeMedia_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_temp_view"
    end



    
20:21:52.741098 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
20:21:52.742827 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:52.743029 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:52.778039 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:21:52.780723 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:52.780934 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:53.008851 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:21:53.011860 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:53.012070 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr'
      and table_schema = 'stg'
  
20:21:53.047784 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:53.052435 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:53.052698 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:53.141387 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:21:53.143076 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:53.143309 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    
20:21:53.229911 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
20:21:53.231653 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:53.231838 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:53.269980 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:53.272517 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:53.272690 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:53.426724 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.47 seconds
20:21:53.428978 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: COMMIT
20:21:53.429779 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
20:21:53.429926 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    end

20:21:53.484088 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:53.498053 [debug] [Thread-4  ]: finished collecting timing info
20:21:53.498278 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:21:53.500659 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:53.500832 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr'
      and table_schema = 'stg'
  
20:21:53.498475 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: Close
20:21:53.501566 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654d08b0>]}
20:21:53.501971 [info ] [Thread-4  ]: 49 of 101 OK snapshotted stg.AH_ListingPaymentCharge_Incr....................... [[32mOK[0m in 15.59s]
20:21:53.502278 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ListingPaymentCharge_Incr
20:21:53.502439 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ListingTypeproperties_Incr
20:21:53.502795 [info ] [Thread-4  ]: 53 of 101 START snapshot stg.AH_ListingTypeproperties_Incr...................... [RUN]
20:21:53.503152 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr"
20:21:53.503259 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ListingTypeproperties_Incr
20:21:53.503352 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ListingTypeproperties_Incr
20:21:53.506088 [debug] [Thread-4  ]: finished collecting timing info
20:21:53.506231 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ListingTypeproperties_Incr
20:21:53.508817 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:21:53.508950 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:21:53.509031 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:21:53.509129 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:21:53.535356 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:21:53.539471 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:53.539666 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:53.587638 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:53.588997 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:53.589169 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    
20:21:53.631911 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:21:53.659752 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:21:53.683740 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:21:53.684016 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:21:53.713088 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:21:53.716431 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:21:53.716649 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingTypeproperties_InterView]
        ) as __dbt_sbq
    
20:21:53.781292 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:21:53.804826 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:21:53.805100 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr"
        ) as __dbt_sbq
    
20:21:53.861937 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:21:53.865417 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:21:53.865786 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr'
      and table_schema = 'stg'
  
20:21:53.940139 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:21:53.943879 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:21:53.944094 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
        
  
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingTypeproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingTypeproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:53.695974'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:53.695974'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:21:53.695974''), CONVERT(DATETIME2, ''2022-09-26 20:21:53.695974'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:21:53.695974'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:53.695974'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:53.695974'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:21:53.695974'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Scope != source_data.Scope
        or
        (
            ((snapshotted_data.Scope is null) and not (source_data.Scope is null))
            or
            ((not snapshotted_data.Scope is null) and (source_data.Scope is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Scope != source_data.Scope
        or
        (
            ((snapshotted_data.Scope is null) and not (source_data.Scope is null))
            or
            ((not snapshotted_data.Scope is null) and (source_data.Scope is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingTypeproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_temp_view"
    end



    
20:21:54.120812 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.98 seconds
20:21:54.122432 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:54.122642 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:54.156423 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:21:54.159088 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:54.159289 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:54.374229 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:21:54.376379 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingQuestions_Incr"
20:21:54.376804 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:54.376924 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingQuestions_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr" (
                  "ID", "UserID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "UserName", "Question", "Answer", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UserID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "UserName", "Question", "Answer", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingQuestions_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:21:54.439040 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.85 seconds
20:21:54.440656 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:54.440832 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:21:54.476991 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:54.480040 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:54.480246 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:54.768123 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
20:21:54.770269 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr"
20:21:54.770800 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:54.770950 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr" (
                  "ID", "ProvIDErName", "CreatedOn", "UpdatedOn", "DeletedOn", "ListingTypeID", "Enabled", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "ProvIDErName", "CreatedOn", "UpdatedOn", "DeletedOn", "ListingTypeID", "Enabled", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:21:55.733382 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.36 seconds
20:21:55.735143 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingQuestions_Incr: COMMIT
20:21:55.735897 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
20:21:55.736025 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."#AH_ListingQuestions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    end

20:21:55.784304 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:21:55.797686 [debug] [Thread-2  ]: finished collecting timing info
20:21:55.798003 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingQuestions_Incr: Close
20:21:55.798766 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654d0a00>]}
20:21:55.799227 [info ] [Thread-2  ]: 50 of 101 OK snapshotted stg.AH_ListingQuestions_Incr........................... [[32mOK[0m in 15.68s]
20:21:55.799551 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ListingQuestions_Incr
20:21:55.799699 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ListingTypes_Incr
20:21:55.800039 [info ] [Thread-2  ]: 54 of 101 START snapshot stg.AH_ListingTypes_Incr............................... [RUN]
20:21:55.800419 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingTypes_Incr"
20:21:55.800528 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ListingTypes_Incr
20:21:55.800625 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ListingTypes_Incr
20:21:55.803399 [debug] [Thread-2  ]: finished collecting timing info
20:21:55.803546 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ListingTypes_Incr
20:21:55.806377 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:21:55.806514 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:21:55.806625 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:21:55.806726 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:21:55.933343 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:21:55.965992 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:21:55.989162 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:21:55.989455 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:21:56.025716 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:21:56.027812 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:21:56.028321 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingTypes_InterView]
        ) as __dbt_sbq
    
20:21:56.087369 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:21:56.109785 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:21:56.110061 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr"
        ) as __dbt_sbq
    
20:21:56.136577 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.37 seconds
20:21:56.138295 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: COMMIT
20:21:56.139486 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
20:21:56.139638 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    end

20:21:56.178610 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:21:56.183782 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:21:56.184043 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr'
      and table_schema = 'stg'
  
20:21:56.202882 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:21:56.216232 [debug] [Thread-3  ]: finished collecting timing info
20:21:56.216562 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: Close
20:21:56.217338 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654d0760>]}
20:21:56.217841 [info ] [Thread-3  ]: 51 of 101 OK snapshotted stg.AH_ListingTypeFeeprovIDErs_Incr.................... [[32mOK[0m in 12.79s]
20:21:56.218170 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr
20:21:56.218327 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Listingdecorations_Incr
20:21:56.218739 [info ] [Thread-3  ]: 55 of 101 START snapshot stg.AH_Listingdecorations_Incr......................... [RUN]
20:21:56.219161 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr"
20:21:56.219271 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Listingdecorations_Incr
20:21:56.219372 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Listingdecorations_Incr
20:21:56.222206 [debug] [Thread-3  ]: finished collecting timing info
20:21:56.222366 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Listingdecorations_Incr
20:21:56.225263 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:21:56.225400 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:21:56.225496 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:21:56.225598 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:21:56.265907 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:21:56.269343 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:21:56.269605 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
        
  
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypes_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypes_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingTypes_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingTypes_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:55.992921'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:55.992921'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:21:55.992921''), CONVERT(DATETIME2, ''2022-09-26 20:21:55.992921'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:21:55.992921'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:55.992921'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:55.992921'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:21:55.992921'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingTypes_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingTypes_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypes_Incr__dbt_tmp_temp_view"
    end



    
20:21:56.339526 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:21:56.366981 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:21:56.391748 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:21:56.392033 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:21:56.450772 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:21:56.453103 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:21:56.453354 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Listingdecorations_InterView]
        ) as __dbt_sbq
    
20:21:56.531420 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:21:56.554634 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:21:56.554929 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr"
        ) as __dbt_sbq
    
20:21:56.625483 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:21:56.629316 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:21:56.629555 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr'
      and table_schema = 'stg'
  
20:21:56.707484 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:21:56.711085 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:21:56.711345 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
        
  
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listingdecorations_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Listingdecorations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Listingdecorations_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Listingdecorations_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:56.430405'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:56.430405'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:21:56.430405''), CONVERT(DATETIME2, ''2022-09-26 20:21:56.430405'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:21:56.430405'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:21:56.430405'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:21:56.430405'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:21:56.430405'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DecorationID != source_data.DecorationID
        or
        (
            ((snapshotted_data.DecorationID is null) and not (source_data.DecorationID is null))
            or
            ((not snapshotted_data.DecorationID is null) and (source_data.DecorationID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DecorationID != source_data.DecorationID
        or
        (
            ((snapshotted_data.DecorationID is null) and not (source_data.DecorationID is null))
            or
            ((not snapshotted_data.DecorationID is null) and (source_data.DecorationID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Listingdecorations_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listingdecorations_Incr__dbt_tmp_temp_view"
    end



    
20:21:58.600927 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.25 seconds
20:21:58.604862 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:21:58.605090 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:21:58.668948 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:21:58.670355 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:21:58.670604 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    
20:22:00.428773 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.76 seconds
20:22:00.430268 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:22:00.430452 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:00.530265 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:22:00.532731 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:22:00.532925 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:00.758030 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:22:00.760986 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:22:00.761238 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr'
      and table_schema = 'stg'
  
20:22:00.800289 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:00.804635 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:22:00.804901 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:00.869599 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:22:00.871215 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:22:00.871412 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    
20:22:01.615477 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 5.35 seconds
20:22:01.620200 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:22:01.620486 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:01.678455 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:22:01.680083 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:22:01.680328 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypes_Incr__dbt_tmp"
    
20:22:02.060111 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.19 seconds
20:22:02.061714 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:22:02.061938 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:02.109015 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:22:02.111710 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:22:02.111956 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:02.369520 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:22:02.372645 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:22:02.372868 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr'
      and table_schema = 'stg'
  
20:22:02.423248 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:22:02.425056 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 5.71 seconds
20:22:02.428275 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:22:02.428488 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:02.431482 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:22:02.431686 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:02.498812 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:22:02.500377 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:22:02.500576 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    
20:22:02.509679 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:22:02.511216 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:22:02.511428 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    
20:22:02.757462 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.08 seconds
20:22:02.759457 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:22:02.759684 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:02.855872 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:22:02.858275 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:22:02.858488 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:03.143295 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
20:22:03.146395 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:22:03.146673 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr'
      and table_schema = 'stg'
  
20:22:03.257884 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:22:03.261909 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:22:03.262132 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:03.309722 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:22:03.311279 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:22:03.311459 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypes_Incr__dbt_tmp"
    
20:22:03.672993 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.17 seconds
20:22:03.674977 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:22:03.675179 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:03.692587 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.18 seconds
20:22:03.694100 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:22:03.694276 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:03.710807 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:03.713186 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:22:03.713393 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:03.763334 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:22:03.766155 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:22:03.766415 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:03.932518 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 9.99 seconds
20:22:03.935965 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:22:03.936234 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:03.950639 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:22:03.952872 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingTypeMedia_Incr"
20:22:03.953325 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:22:03.953450 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingTypeMedia_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr" (
                  "ID", "Enabled", "ListingTypeID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaassetName", "Scope", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Enabled", "ListingTypeID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaassetName", "Scope", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:22:03.988317 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:22:03.989884 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:22:03.990086 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    
20:22:03.995476 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:22:03.998091 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:22:03.998290 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr'
      and table_schema = 'stg'
  
20:22:04.075318 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:22:04.079470 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:22:04.079710 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:04.114645 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:22:04.116374 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:22:04.116556 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    
20:22:04.503127 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.19 seconds
20:22:04.504761 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:22:04.504951 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:04.565677 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:22:04.568288 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:22:04.568526 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:04.767759 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:22:04.770758 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:22:04.770988 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr'
      and table_schema = 'stg'
  
20:22:04.805356 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:22:04.812110 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:22:04.812400 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:04.850746 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:04.852309 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:22:04.852522 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypes_Incr__dbt_tmp"
    
20:22:05.200851 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.21 seconds
20:22:05.202520 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:22:05.202750 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:05.289779 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:22:05.292632 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:22:05.292886 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:05.481590 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.53 seconds
20:22:05.483350 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingTypeMedia_Incr: COMMIT
20:22:05.484169 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
20:22:05.484315 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    end

20:22:05.485359 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.37 seconds
20:22:05.486619 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:22:05.486770 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:05.524990 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:05.532814 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:22:05.535558 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:22:05.535821 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:05.543590 [debug] [Thread-1  ]: finished collecting timing info
20:22:05.543953 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingTypeMedia_Incr: Close
20:22:05.544749 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654d0b50>]}
20:22:05.545250 [info ] [Thread-1  ]: 52 of 101 OK snapshotted stg.AH_ListingTypeMedia_Incr........................... [[32mOK[0m in 13.65s]
20:22:05.545588 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ListingTypeMedia_Incr
20:22:05.545748 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Listingproperties_Incr
20:22:05.546092 [info ] [Thread-1  ]: 56 of 101 START snapshot stg.AH_Listingproperties_Incr.......................... [RUN]
20:22:05.546471 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Listingproperties_Incr"
20:22:05.546625 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Listingproperties_Incr
20:22:05.546726 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Listingproperties_Incr
20:22:05.549546 [debug] [Thread-1  ]: finished collecting timing info
20:22:05.549704 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Listingproperties_Incr
20:22:05.640133 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
20:22:05.642749 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:22:05.642958 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr'
      and table_schema = 'stg'
  
20:22:05.645856 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:22:05.646020 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:22:05.646107 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:22:05.646208 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:22:05.720067 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:22:05.724987 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:22:05.725237 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:05.747363 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:22:05.750204 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:22:05.750424 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr'
      and table_schema = 'stg'
  
20:22:05.762389 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:05.763826 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:22:05.764007 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    
20:22:05.786828 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:05.791461 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:22:05.791701 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:22:05.791835 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:05.825554 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:22:05.841811 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:22:05.843228 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:22:05.843404 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    
20:22:05.851021 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:22:05.851248 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:22:05.878155 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:22:05.880348 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:22:05.880563 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Listingproperties_InterView]
        ) as __dbt_sbq
    
20:22:05.938816 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:22:05.961119 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:22:05.961410 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr"
        ) as __dbt_sbq
    
20:22:06.040489 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:22:06.044393 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:22:06.044647 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr'
      and table_schema = 'stg'
  
20:22:06.064785 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.21 seconds
20:22:06.066274 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:22:06.066457 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:06.109501 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:06.112118 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:22:06.112372 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:06.147580 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:22:06.151689 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:22:06.151954 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
        
  
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listingproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Listingproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listingproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Listingproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Listingproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:22:05.852374'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:22:05.852374'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:22:05.852374''), CONVERT(DATETIME2, ''2022-09-26 20:22:05.852374'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:22:05.852374'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:22:05.852374'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:22:05.852374'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:22:05.852374'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Listingproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Listingproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listingproperties_Incr__dbt_tmp_temp_view"
    end



    
20:22:06.305871 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:22:06.307935 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingTypes_Incr"
20:22:06.308376 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:22:06.308501 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingTypes_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingTypes_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:22:06.809837 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
20:22:06.811484 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:22:06.811691 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:06.823176 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.98 seconds
20:22:06.824636 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:22:06.824819 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:06.846176 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:22:06.848692 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:22:06.848891 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:06.861204 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:06.863652 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:22:06.863853 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:07.216053 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.37 seconds
20:22:07.219485 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:22:07.219761 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr'
      and table_schema = 'stg'
  
20:22:07.283915 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.42 seconds
20:22:07.286086 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Listingdecorations_Incr"
20:22:07.286597 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:22:07.286751 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Listingdecorations_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "DecorationID", "ListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "DecorationID", "ListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Listingdecorations_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:22:07.312714 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:22:07.317464 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:22:07.317719 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:07.355331 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:07.357171 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:22:07.357395 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    
20:22:07.804687 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.50 seconds
20:22:07.806441 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingTypes_Incr: COMMIT
20:22:07.807285 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
20:22:07.807425 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."#AH_ListingTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypes_Incr__dbt_tmp"
    end

20:22:07.845348 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:07.860332 [debug] [Thread-2  ]: finished collecting timing info
20:22:07.860678 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingTypes_Incr: Close
20:22:07.861445 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01641b50d0>]}
20:22:07.861903 [info ] [Thread-2  ]: 54 of 101 OK snapshotted stg.AH_ListingTypes_Incr............................... [[32mOK[0m in 12.06s]
20:22:07.862228 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ListingTypes_Incr
20:22:07.862386 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ListingsReserveHistory_Incr
20:22:07.862761 [info ] [Thread-2  ]: 57 of 101 START snapshot stg.AH_ListingsReserveHistory_Incr..................... [RUN]
20:22:07.863167 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr"
20:22:07.863274 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ListingsReserveHistory_Incr
20:22:07.863369 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ListingsReserveHistory_Incr
20:22:07.866165 [debug] [Thread-2  ]: finished collecting timing info
20:22:07.866346 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ListingsReserveHistory_Incr
20:22:07.869472 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:07.869640 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:22:07.869724 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:22:07.869825 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:22:08.121513 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:22:08.153668 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
20:22:08.176694 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:08.176996 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:22:08.208086 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:22:08.210388 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:08.210647 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingsReserveHistory_InterView]
        ) as __dbt_sbq
    
20:22:08.270155 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:22:08.292782 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:08.293077 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr"
        ) as __dbt_sbq
    
20:22:08.361083 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:22:08.364726 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:08.364971 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr'
      and table_schema = 'stg'
  
20:22:08.495569 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:22:08.499375 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:08.499638 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
        
  
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingsReserveHistory_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:22:08.180536'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:22:08.180536'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:22:08.180536''), CONVERT(DATETIME2, ''2022-09-26 20:22:08.180536'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:22:08.180536'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:22:08.180536'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:22:08.180536'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:22:08.180536'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.OldReserve != source_data.OldReserve
        or
        (
            ((snapshotted_data.OldReserve is null) and not (source_data.OldReserve is null))
            or
            ((not snapshotted_data.OldReserve is null) and (source_data.OldReserve is null))
        ) or snapshotted_data.NewReserve != source_data.NewReserve
        or
        (
            ((snapshotted_data.NewReserve is null) and not (source_data.NewReserve is null))
            or
            ((not snapshotted_data.NewReserve is null) and (source_data.NewReserve is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.OldReserve != source_data.OldReserve
        or
        (
            ((snapshotted_data.OldReserve is null) and not (source_data.OldReserve is null))
            or
            ((not snapshotted_data.OldReserve is null) and (source_data.OldReserve is null))
        ) or snapshotted_data.NewReserve != source_data.NewReserve
        or
        (
            ((snapshotted_data.NewReserve is null) and not (source_data.NewReserve is null))
            or
            ((not snapshotted_data.NewReserve is null) and (source_data.NewReserve is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view"
    end



    
20:22:08.606206 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.25 seconds
20:22:08.607840 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:22:08.608073 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:08.646002 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:08.648754 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:22:08.648980 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:08.814380 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.53 seconds
20:22:08.816794 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Listingdecorations_Incr: COMMIT
20:22:08.817586 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
20:22:08.817774 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."#AH_Listingdecorations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    end

20:22:08.856599 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:08.871128 [debug] [Thread-3  ]: finished collecting timing info
20:22:08.871466 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Listingdecorations_Incr: Close
20:22:08.872230 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0164299a60>]}
20:22:08.872719 [info ] [Thread-3  ]: 55 of 101 OK snapshotted stg.AH_Listingdecorations_Incr......................... [[32mOK[0m in 12.65s]
20:22:08.873040 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Listingdecorations_Incr
20:22:08.873194 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Listings_Incr
20:22:08.873527 [info ] [Thread-3  ]: 58 of 101 START snapshot stg.AH_Listings_Incr................................... [RUN]
20:22:08.873904 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Listings_Incr"
20:22:08.874013 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Listings_Incr
20:22:08.874106 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Listings_Incr
20:22:08.876958 [debug] [Thread-3  ]: finished collecting timing info
20:22:08.877121 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Listings_Incr
20:22:08.880154 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:08.880311 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:22:08.880395 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:22:08.880495 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:22:09.111365 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.46 seconds
20:22:09.113548 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingTypeproperties_Incr"
20:22:09.113972 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:22:09.114097 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingTypeproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr" (
                  "ID", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "Scope", "DecimalnativeValue", "DeletedOn", "DateTimenativeValue", "CreatedOn", "UpdatedOn", "IntnativeValue", "CustomFieldID", "ListingTypeID", "BoolnativeValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "Scope", "DecimalnativeValue", "DeletedOn", "DateTimenativeValue", "CreatedOn", "UpdatedOn", "IntnativeValue", "CustomFieldID", "ListingTypeID", "BoolnativeValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:22:09.120049 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:22:09.154020 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:22:09.177278 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:09.177568 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:22:09.204041 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:22:09.206222 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:09.206463 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Listings_InterView]
        ) as __dbt_sbq
    
20:22:09.263164 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:22:09.285602 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:09.285885 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Listings_Incr"
        ) as __dbt_sbq
    
20:22:09.634347 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
20:22:09.638178 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:09.638414 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr'
      and table_schema = 'stg'
  
20:22:09.710512 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:22:09.714508 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:09.714868 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
        
  
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listings_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Listings_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listings_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Listings_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Listings_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Listings_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:22:09.180555'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:22:09.180555'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:22:09.180555''), CONVERT(DATETIME2, ''2022-09-26 20:22:09.180555'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:22:09.180555'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:22:09.180555'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:22:09.180555'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:22:09.180555'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.PrimaryImageURI != source_data.PrimaryImageURI
        or
        (
            ((snapshotted_data.PrimaryImageURI is null) and not (source_data.PrimaryImageURI is null))
            or
            ((not snapshotted_data.PrimaryImageURI is null) and (source_data.PrimaryImageURI is null))
        ) or snapshotted_data.OwnerUserName != source_data.OwnerUserName
        or
        (
            ((snapshotted_data.OwnerUserName is null) and not (source_data.OwnerUserName is null))
            or
            ((not snapshotted_data.OwnerUserName is null) and (source_data.OwnerUserName is null))
        ) or snapshotted_data.CurrentListingActionUserName != source_data.CurrentListingActionUserName
        or
        (
            ((snapshotted_data.CurrentListingActionUserName is null) and not (source_data.CurrentListingActionUserName is null))
            or
            ((not snapshotted_data.CurrentListingActionUserName is null) and (source_data.CurrentListingActionUserName is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.SubTitle != source_data.SubTitle
        or
        (
            ((snapshotted_data.SubTitle is null) and not (source_data.SubTitle is null))
            or
            ((not snapshotted_data.SubTitle is null) and (source_data.SubTitle is null))
        ) or snapshotted_data.Location != source_data.Location
        or
        (
            ((snapshotted_data.Location is null) and not (source_data.Location is null))
            or
            ((not snapshotted_data.Location is null) and (source_data.Location is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.Startdttm != source_data.Startdttm
        or
        (
            ((snapshotted_data.Startdttm is null) and not (source_data.Startdttm is null))
            or
            ((not snapshotted_data.Startdttm is null) and (source_data.Startdttm is null))
        ) or snapshotted_data.AutoreListrEMAining != source_data.AutoreListrEMAining
        or
        (
            ((snapshotted_data.AutoreListrEMAining is null) and not (source_data.AutoreListrEMAining is null))
            or
            ((not snapshotted_data.AutoreListrEMAining is null) and (source_data.AutoreListrEMAining is null))
        ) or snapshotted_data.CurrentQuantity != source_data.CurrentQuantity
        or
        (
            ((snapshotted_data.CurrentQuantity is null) and not (source_data.CurrentQuantity is null))
            or
            ((not snapshotted_data.CurrentQuantity is null) and (source_data.CurrentQuantity is null))
        ) or snapshotted_data.OriginalQuantity != source_data.OriginalQuantity
        or
        (
            ((snapshotted_data.OriginalQuantity is null) and not (source_data.OriginalQuantity is null))
            or
            ((not snapshotted_data.OriginalQuantity is null) and (source_data.OriginalQuantity is null))
        ) or snapshotted_data.ReListiteration != source_data.ReListiteration
        or
        (
            ((snapshotted_data.ReListiteration is null) and not (source_data.ReListiteration is null))
            or
            ((not snapshotted_data.ReListiteration is null) and (source_data.ReListiteration is null))
        ) or snapshotted_data.LotID != source_data.LotID
        or
        (
            ((snapshotted_data.LotID is null) and not (source_data.LotID is null))
            or
            ((not snapshotted_data.LotID is null) and (source_data.LotID is null))
        ) or snapshotted_data.AcceptedActionCount != source_data.AcceptedActionCount
        or
        (
            ((snapshotted_data.AcceptedActionCount is null) and not (source_data.AcceptedActionCount is null))
            or
            ((not snapshotted_data.AcceptedActionCount is null) and (source_data.AcceptedActionCount is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Duration != source_data.Duration
        or
        (
            ((snapshotted_data.Duration is null) and not (source_data.Duration is null))
            or
            ((not snapshotted_data.Duration is null) and (source_data.Duration is null))
        ) or snapshotted_data.Version != source_data.Version
        or
        (
            ((snapshotted_data.Version is null) and not (source_data.Version is null))
            or
            ((not snapshotted_data.Version is null) and (source_data.Version is null))
        ) or snapshotted_data.CurrencyID != source_data.CurrencyID
        or
        (
            ((snapshotted_data.CurrencyID is null) and not (source_data.CurrencyID is null))
            or
            ((not snapshotted_data.CurrencyID is null) and (source_data.CurrencyID is null))
        ) or snapshotted_data.PrimaryCategoryID != source_data.PrimaryCategoryID
        or
        (
            ((snapshotted_data.PrimaryCategoryID is null) and not (source_data.PrimaryCategoryID is null))
            or
            ((not snapshotted_data.PrimaryCategoryID is null) and (source_data.PrimaryCategoryID is null))
        ) or snapshotted_data.CurrentListingActionID != source_data.CurrentListingActionID
        or
        (
            ((snapshotted_data.CurrentListingActionID is null) and not (source_data.CurrentListingActionID is null))
            or
            ((not snapshotted_data.CurrentListingActionID is null) and (source_data.CurrentListingActionID is null))
        ) or snapshotted_data.OfferCount != source_data.OfferCount
        or
        (
            ((snapshotted_data.OfferCount is null) and not (source_data.OfferCount is null))
            or
            ((not snapshotted_data.OfferCount is null) and (source_data.OfferCount is null))
        ) or snapshotted_data.OriginalreListCount != source_data.OriginalreListCount
        or
        (
            ((snapshotted_data.OriginalreListCount is null) and not (source_data.OriginalreListCount is null))
            or
            ((not snapshotted_data.OriginalreListCount is null) and (source_data.OriginalreListCount is null))
        ) or snapshotted_data.Hits != source_data.Hits
        or
        (
            ((snapshotted_data.Hits is null) and not (source_data.Hits is null))
            or
            ((not snapshotted_data.Hits is null) and (source_data.Hits is null))
        ) or snapshotted_data.CurrentPrice != source_data.CurrentPrice
        or
        (
            ((snapshotted_data.CurrentPrice is null) and not (source_data.CurrentPrice is null))
            or
            ((not snapshotted_data.CurrentPrice is null) and (source_data.CurrentPrice is null))
        ) or snapshotted_data.Increment != source_data.Increment
        or
        (
            ((snapshotted_data.Increment is null) and not (source_data.Increment is null))
            or
            ((not snapshotted_data.Increment is null) and (source_data.Increment is null))
        ) or snapshotted_data.OriginalPrice != source_data.OriginalPrice
        or
        (
            ((snapshotted_data.OriginalPrice is null) and not (source_data.OriginalPrice is null))
            or
            ((not snapshotted_data.OriginalPrice is null) and (source_data.OriginalPrice is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.PrimaryImageURI != source_data.PrimaryImageURI
        or
        (
            ((snapshotted_data.PrimaryImageURI is null) and not (source_data.PrimaryImageURI is null))
            or
            ((not snapshotted_data.PrimaryImageURI is null) and (source_data.PrimaryImageURI is null))
        ) or snapshotted_data.OwnerUserName != source_data.OwnerUserName
        or
        (
            ((snapshotted_data.OwnerUserName is null) and not (source_data.OwnerUserName is null))
            or
            ((not snapshotted_data.OwnerUserName is null) and (source_data.OwnerUserName is null))
        ) or snapshotted_data.CurrentListingActionUserName != source_data.CurrentListingActionUserName
        or
        (
            ((snapshotted_data.CurrentListingActionUserName is null) and not (source_data.CurrentListingActionUserName is null))
            or
            ((not snapshotted_data.CurrentListingActionUserName is null) and (source_data.CurrentListingActionUserName is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.SubTitle != source_data.SubTitle
        or
        (
            ((snapshotted_data.SubTitle is null) and not (source_data.SubTitle is null))
            or
            ((not snapshotted_data.SubTitle is null) and (source_data.SubTitle is null))
        ) or snapshotted_data.Location != source_data.Location
        or
        (
            ((snapshotted_data.Location is null) and not (source_data.Location is null))
            or
            ((not snapshotted_data.Location is null) and (source_data.Location is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.Startdttm != source_data.Startdttm
        or
        (
            ((snapshotted_data.Startdttm is null) and not (source_data.Startdttm is null))
            or
            ((not snapshotted_data.Startdttm is null) and (source_data.Startdttm is null))
        ) or snapshotted_data.AutoreListrEMAining != source_data.AutoreListrEMAining
        or
        (
            ((snapshotted_data.AutoreListrEMAining is null) and not (source_data.AutoreListrEMAining is null))
            or
            ((not snapshotted_data.AutoreListrEMAining is null) and (source_data.AutoreListrEMAining is null))
        ) or snapshotted_data.CurrentQuantity != source_data.CurrentQuantity
        or
        (
            ((snapshotted_data.CurrentQuantity is null) and not (source_data.CurrentQuantity is null))
            or
            ((not snapshotted_data.CurrentQuantity is null) and (source_data.CurrentQuantity is null))
        ) or snapshotted_data.OriginalQuantity != source_data.OriginalQuantity
        or
        (
            ((snapshotted_data.OriginalQuantity is null) and not (source_data.OriginalQuantity is null))
            or
            ((not snapshotted_data.OriginalQuantity is null) and (source_data.OriginalQuantity is null))
        ) or snapshotted_data.ReListiteration != source_data.ReListiteration
        or
        (
            ((snapshotted_data.ReListiteration is null) and not (source_data.ReListiteration is null))
            or
            ((not snapshotted_data.ReListiteration is null) and (source_data.ReListiteration is null))
        ) or snapshotted_data.LotID != source_data.LotID
        or
        (
            ((snapshotted_data.LotID is null) and not (source_data.LotID is null))
            or
            ((not snapshotted_data.LotID is null) and (source_data.LotID is null))
        ) or snapshotted_data.AcceptedActionCount != source_data.AcceptedActionCount
        or
        (
            ((snapshotted_data.AcceptedActionCount is null) and not (source_data.AcceptedActionCount is null))
            or
            ((not snapshotted_data.AcceptedActionCount is null) and (source_data.AcceptedActionCount is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Duration != source_data.Duration
        or
        (
            ((snapshotted_data.Duration is null) and not (source_data.Duration is null))
            or
            ((not snapshotted_data.Duration is null) and (source_data.Duration is null))
        ) or snapshotted_data.Version != source_data.Version
        or
        (
            ((snapshotted_data.Version is null) and not (source_data.Version is null))
            or
            ((not snapshotted_data.Version is null) and (source_data.Version is null))
        ) or snapshotted_data.CurrencyID != source_data.CurrencyID
        or
        (
            ((snapshotted_data.CurrencyID is null) and not (source_data.CurrencyID is null))
            or
            ((not snapshotted_data.CurrencyID is null) and (source_data.CurrencyID is null))
        ) or snapshotted_data.PrimaryCategoryID != source_data.PrimaryCategoryID
        or
        (
            ((snapshotted_data.PrimaryCategoryID is null) and not (source_data.PrimaryCategoryID is null))
            or
            ((not snapshotted_data.PrimaryCategoryID is null) and (source_data.PrimaryCategoryID is null))
        ) or snapshotted_data.CurrentListingActionID != source_data.CurrentListingActionID
        or
        (
            ((snapshotted_data.CurrentListingActionID is null) and not (source_data.CurrentListingActionID is null))
            or
            ((not snapshotted_data.CurrentListingActionID is null) and (source_data.CurrentListingActionID is null))
        ) or snapshotted_data.OfferCount != source_data.OfferCount
        or
        (
            ((snapshotted_data.OfferCount is null) and not (source_data.OfferCount is null))
            or
            ((not snapshotted_data.OfferCount is null) and (source_data.OfferCount is null))
        ) or snapshotted_data.OriginalreListCount != source_data.OriginalreListCount
        or
        (
            ((snapshotted_data.OriginalreListCount is null) and not (source_data.OriginalreListCount is null))
            or
            ((not snapshotted_data.OriginalreListCount is null) and (source_data.OriginalreListCount is null))
        ) or snapshotted_data.Hits != source_data.Hits
        or
        (
            ((snapshotted_data.Hits is null) and not (source_data.Hits is null))
            or
            ((not snapshotted_data.Hits is null) and (source_data.Hits is null))
        ) or snapshotted_data.CurrentPrice != source_data.CurrentPrice
        or
        (
            ((snapshotted_data.CurrentPrice is null) and not (source_data.CurrentPrice is null))
            or
            ((not snapshotted_data.CurrentPrice is null) and (source_data.CurrentPrice is null))
        ) or snapshotted_data.Increment != source_data.Increment
        or
        (
            ((snapshotted_data.Increment is null) and not (source_data.Increment is null))
            or
            ((not snapshotted_data.Increment is null) and (source_data.Increment is null))
        ) or snapshotted_data.OriginalPrice != source_data.OriginalPrice
        or
        (
            ((snapshotted_data.OriginalPrice is null) and not (source_data.OriginalPrice is null))
            or
            ((not snapshotted_data.OriginalPrice is null) and (source_data.OriginalPrice is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Listings_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Listings_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listings_Incr__dbt_tmp_temp_view"
    end



    
20:22:10.480184 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.37 seconds
20:22:10.481805 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingTypeproperties_Incr: COMMIT
20:22:10.482526 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
20:22:10.482723 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    end

20:22:10.518234 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:10.531686 [debug] [Thread-4  ]: finished collecting timing info
20:22:10.532013 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingTypeproperties_Incr: Close
20:22:10.532747 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01640cf6a0>]}
20:22:10.533203 [info ] [Thread-4  ]: 53 of 101 OK snapshotted stg.AH_ListingTypeproperties_Incr...................... [[32mOK[0m in 17.03s]
20:22:10.533517 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ListingTypeproperties_Incr
20:22:10.533667 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Locations_Incr
20:22:10.533986 [info ] [Thread-4  ]: 59 of 101 START snapshot stg.AH_Locations_Incr.................................. [RUN]
20:22:10.534359 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Locations_Incr"
20:22:10.534465 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Locations_Incr
20:22:10.534601 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Locations_Incr
20:22:10.537326 [debug] [Thread-4  ]: finished collecting timing info
20:22:10.537476 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Locations_Incr
20:22:10.540280 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:10.540421 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:22:10.540503 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:22:10.540600 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:22:10.656989 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:22:10.704390 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:22:10.728099 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:10.728383 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:22:10.756843 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:22:10.759008 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:10.759511 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Locations_InterView]
        ) as __dbt_sbq
    
20:22:10.819845 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:22:10.841912 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:10.842194 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Locations_Incr"
        ) as __dbt_sbq
    
20:22:11.265870 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.42 seconds
20:22:11.269326 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:11.269563 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr'
      and table_schema = 'stg'
  
20:22:11.347065 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:22:11.350661 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:11.350880 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
        
  
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Locations_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Locations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Locations_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Locations_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Locations_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Locations_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:22:10.743025'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:22:10.743025'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:22:10.743025''), CONVERT(DATETIME2, ''2022-09-26 20:22:10.743025'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:22:10.743025'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:22:10.743025'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:22:10.743025'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:22:10.743025'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Locations_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Locations_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Locations_Incr__dbt_tmp_temp_view"
    end



    
20:22:18.176429 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 9.68 seconds
20:22:18.179904 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:18.180132 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:18.223791 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:18.225303 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:18.225496 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    
20:22:20.073851 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.85 seconds
20:22:20.075360 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:20.075542 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:20.148961 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:22:20.151305 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:20.151515 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:20.238179 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 8.89 seconds
20:22:20.241459 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:20.241693 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:20.301616 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:22:20.303322 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:20.303659 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Locations_Incr__dbt_tmp"
    
20:22:20.557478 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
20:22:20.560600 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:20.560855 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr'
      and table_schema = 'stg'
  
20:22:20.637300 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:22:20.642649 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:20.642921 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:20.692562 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:22:20.694042 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:20.694239 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    
20:22:21.641797 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.34 seconds
20:22:21.643495 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:21.643717 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:21.719731 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:22:21.722257 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:21.722497 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:22.127032 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
20:22:22.129995 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:22.130224 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr'
      and table_schema = 'stg'
  
20:22:22.328281 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:22:22.332671 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:22.332939 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:22.503325 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:22:22.504895 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:22.505086 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Locations_Incr__dbt_tmp"
    
20:22:23.119912 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.43 seconds
20:22:23.121576 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:23.121774 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:23.201499 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:22:23.204058 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:23.204290 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:23.464670 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:22:23.467792 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:23.468024 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr'
      and table_schema = 'stg'
  
20:22:23.502601 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:22:23.507262 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:23.507527 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:23.544484 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:23.546053 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:23.546264 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    
20:22:24.096529 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.59 seconds
20:22:24.098163 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:24.098379 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:24.137463 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:24.139838 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:24.140073 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:24.714451 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.57 seconds
20:22:24.717431 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:24.717680 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr'
      and table_schema = 'stg'
  
20:22:24.737246 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.19 seconds
20:22:24.738949 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:24.739171 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:24.761350 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:24.765778 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:24.766055 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:24.795852 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:22:24.798198 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:24.798457 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:24.802676 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:24.804026 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:24.804212 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Locations_Incr__dbt_tmp"
    
20:22:25.016393 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:22:25.018991 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingsReserveHistory_Incr"
20:22:25.019525 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:25.019676 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr" (
                  "ID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "OldReserve", "NewReserve", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "OldReserve", "NewReserve", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:22:26.100248 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.30 seconds
20:22:26.101701 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:26.101891 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:26.236429 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:22:26.238889 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:26.239117 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:26.504742 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:22:26.506853 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Locations_Incr"
20:22:26.507325 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:26.507456 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Locations_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Locations_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Locations_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Locations_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Locations_Incr" (
                  "ID", "Name", "Description", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "Amount", "PayToproceed", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Description", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "Amount", "PayToproceed", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Locations_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:22:26.717661 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.70 seconds
20:22:26.719250 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: COMMIT
20:22:26.719972 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
20:22:26.720107 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    end

20:22:26.765690 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:22:26.779854 [debug] [Thread-2  ]: finished collecting timing info
20:22:26.780207 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: Close
20:22:26.780972 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654bc370>]}
20:22:26.781443 [info ] [Thread-2  ]: 57 of 101 OK snapshotted stg.AH_ListingsReserveHistory_Incr..................... [[32mOK[0m in 18.92s]
20:22:26.781764 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ListingsReserveHistory_Incr
20:22:26.781925 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_LogentriesBuffer_Incr
20:22:26.782265 [info ] [Thread-2  ]: 60 of 101 START snapshot stg.AH_LogentriesBuffer_Incr........................... [RUN]
20:22:26.782703 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr"
20:22:26.782832 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_LogentriesBuffer_Incr
20:22:26.782929 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_LogentriesBuffer_Incr
20:22:26.785827 [debug] [Thread-2  ]: finished collecting timing info
20:22:26.786019 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_LogentriesBuffer_Incr
20:22:26.789334 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:26.789550 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:22:26.789638 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:22:26.789744 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:22:26.936087 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:22:26.972862 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:22:26.996444 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:26.996761 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:22:27.025327 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:22:27.027598 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:27.028174 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_LogentriesBuffer_InterView]
        ) as __dbt_sbq
    
20:22:27.078139 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:22:27.100410 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:27.100700 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr"
        ) as __dbt_sbq
    
20:22:27.150562 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:22:27.154256 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:27.154516 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr'
      and table_schema = 'stg'
  
20:22:27.222928 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:22:27.226780 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:27.227067 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
        
  
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_LogentriesBuffer_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_LogentriesBuffer_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:22:27.008965'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:22:27.008965'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:22:27.008965''), CONVERT(DATETIME2, ''2022-09-26 20:22:27.008965'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:22:27.008965'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:22:27.008965'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:22:27.008965'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:22:27.008965'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.Properties != source_data.Properties
        or
        (
            ((snapshotted_data.Properties is null) and not (source_data.Properties is null))
            or
            ((not snapshotted_data.Properties is null) and (source_data.Properties is null))
        ) or snapshotted_data.MachineName != source_data.MachineName
        or
        (
            ((snapshotted_data.MachineName is null) and not (source_data.MachineName is null))
            or
            ((not snapshotted_data.MachineName is null) and (source_data.MachineName is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.FunctionalArea != source_data.FunctionalArea
        or
        (
            ((snapshotted_data.FunctionalArea is null) and not (source_data.FunctionalArea is null))
            or
            ((not snapshotted_data.FunctionalArea is null) and (source_data.FunctionalArea is null))
        ) or snapshotted_data.Severity != source_data.Severity
        or
        (
            ((snapshotted_data.Severity is null) and not (source_data.Severity is null))
            or
            ((not snapshotted_data.Severity is null) and (source_data.Severity is null))
        ) or snapshotted_data.Actor != source_data.Actor
        or
        (
            ((snapshotted_data.Actor is null) and not (source_data.Actor is null))
            or
            ((not snapshotted_data.Actor is null) and (source_data.Actor is null))
        ) or snapshotted_data.ExceptionClass != source_data.ExceptionClass
        or
        (
            ((snapshotted_data.ExceptionClass is null) and not (source_data.ExceptionClass is null))
            or
            ((not snapshotted_data.ExceptionClass is null) and (source_data.ExceptionClass is null))
        ) or snapshotted_data.Stacktrace != source_data.Stacktrace
        or
        (
            ((snapshotted_data.Stacktrace is null) and not (source_data.Stacktrace is null))
            or
            ((not snapshotted_data.Stacktrace is null) and (source_data.Stacktrace is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.EntryDaTestamp != source_data.EntryDaTestamp
        or
        (
            ((snapshotted_data.EntryDaTestamp is null) and not (source_data.EntryDaTestamp is null))
            or
            ((not snapshotted_data.EntryDaTestamp is null) and (source_data.EntryDaTestamp is null))
        ) or snapshotted_data.Priority != source_data.Priority
        or
        (
            ((snapshotted_data.Priority is null) and not (source_data.Priority is null))
            or
            ((not snapshotted_data.Priority is null) and (source_data.Priority is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.Properties != source_data.Properties
        or
        (
            ((snapshotted_data.Properties is null) and not (source_data.Properties is null))
            or
            ((not snapshotted_data.Properties is null) and (source_data.Properties is null))
        ) or snapshotted_data.MachineName != source_data.MachineName
        or
        (
            ((snapshotted_data.MachineName is null) and not (source_data.MachineName is null))
            or
            ((not snapshotted_data.MachineName is null) and (source_data.MachineName is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.FunctionalArea != source_data.FunctionalArea
        or
        (
            ((snapshotted_data.FunctionalArea is null) and not (source_data.FunctionalArea is null))
            or
            ((not snapshotted_data.FunctionalArea is null) and (source_data.FunctionalArea is null))
        ) or snapshotted_data.Severity != source_data.Severity
        or
        (
            ((snapshotted_data.Severity is null) and not (source_data.Severity is null))
            or
            ((not snapshotted_data.Severity is null) and (source_data.Severity is null))
        ) or snapshotted_data.Actor != source_data.Actor
        or
        (
            ((snapshotted_data.Actor is null) and not (source_data.Actor is null))
            or
            ((not snapshotted_data.Actor is null) and (source_data.Actor is null))
        ) or snapshotted_data.ExceptionClass != source_data.ExceptionClass
        or
        (
            ((snapshotted_data.ExceptionClass is null) and not (source_data.ExceptionClass is null))
            or
            ((not snapshotted_data.ExceptionClass is null) and (source_data.ExceptionClass is null))
        ) or snapshotted_data.Stacktrace != source_data.Stacktrace
        or
        (
            ((snapshotted_data.Stacktrace is null) and not (source_data.Stacktrace is null))
            or
            ((not snapshotted_data.Stacktrace is null) and (source_data.Stacktrace is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.EntryDaTestamp != source_data.EntryDaTestamp
        or
        (
            ((snapshotted_data.EntryDaTestamp is null) and not (source_data.EntryDaTestamp is null))
            or
            ((not snapshotted_data.EntryDaTestamp is null) and (source_data.EntryDaTestamp is null))
        ) or snapshotted_data.Priority != source_data.Priority
        or
        (
            ((snapshotted_data.Priority is null) and not (source_data.Priority is null))
            or
            ((not snapshotted_data.Priority is null) and (source_data.Priority is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_LogentriesBuffer_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_temp_view"
    end



    
20:22:28.246475 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.74 seconds
20:22:28.248201 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Locations_Incr: COMMIT
20:22:28.248999 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
20:22:28.249148 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."#AH_Locations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Locations_Incr__dbt_tmp"
    end

20:22:28.291255 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:28.305035 [debug] [Thread-4  ]: finished collecting timing info
20:22:28.305394 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Locations_Incr: Close
20:22:28.306156 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654bc220>]}
20:22:28.500435 [info ] [Thread-4  ]: 59 of 101 OK snapshotted stg.AH_Locations_Incr.................................. [[32mOK[0m in 17.77s]
20:22:28.501309 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Locations_Incr
20:22:28.501477 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Logentries_Incr
20:22:28.501822 [info ] [Thread-4  ]: 61 of 101 START snapshot stg.AH_Logentries_Incr................................. [RUN]
20:22:28.502296 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Logentries_Incr"
20:22:28.502419 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Logentries_Incr
20:22:28.502522 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Logentries_Incr
20:22:28.505560 [debug] [Thread-4  ]: finished collecting timing info
20:22:28.505783 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Logentries_Incr
20:22:28.508842 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:22:28.509040 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:22:28.509125 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:22:28.509223 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:22:28.615789 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:22:28.648087 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:22:28.671265 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:22:28.671589 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:22:28.699882 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:22:28.702048 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:22:28.702298 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Logentries_InterView]
        ) as __dbt_sbq
    
20:22:28.758637 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:22:28.781410 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:22:28.781703 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Logentries_Incr"
        ) as __dbt_sbq
    
20:22:29.307156 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.53 seconds
20:22:29.310799 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:22:29.311049 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr'
      and table_schema = 'stg'
  
20:22:29.379587 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:22:29.383272 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:22:29.383539 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
        
  
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Logentries_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Logentries_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Logentries_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Logentries_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Logentries_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Logentries_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:22:28.680865'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:22:28.680865'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:22:28.680865''), CONVERT(DATETIME2, ''2022-09-26 20:22:28.680865'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:22:28.680865'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:22:28.680865'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:22:28.680865'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:22:28.680865'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Priority != source_data.Priority
        or
        (
            ((snapshotted_data.Priority is null) and not (source_data.Priority is null))
            or
            ((not snapshotted_data.Priority is null) and (source_data.Priority is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.EntryDaTestamp != source_data.EntryDaTestamp
        or
        (
            ((snapshotted_data.EntryDaTestamp is null) and not (source_data.EntryDaTestamp is null))
            or
            ((not snapshotted_data.EntryDaTestamp is null) and (source_data.EntryDaTestamp is null))
        ) or snapshotted_data.MachineName != source_data.MachineName
        or
        (
            ((snapshotted_data.MachineName is null) and not (source_data.MachineName is null))
            or
            ((not snapshotted_data.MachineName is null) and (source_data.MachineName is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.FunctionalArea != source_data.FunctionalArea
        or
        (
            ((snapshotted_data.FunctionalArea is null) and not (source_data.FunctionalArea is null))
            or
            ((not snapshotted_data.FunctionalArea is null) and (source_data.FunctionalArea is null))
        ) or snapshotted_data.Severity != source_data.Severity
        or
        (
            ((snapshotted_data.Severity is null) and not (source_data.Severity is null))
            or
            ((not snapshotted_data.Severity is null) and (source_data.Severity is null))
        ) or snapshotted_data.Actor != source_data.Actor
        or
        (
            ((snapshotted_data.Actor is null) and not (source_data.Actor is null))
            or
            ((not snapshotted_data.Actor is null) and (source_data.Actor is null))
        ) or snapshotted_data.ExceptionClass != source_data.ExceptionClass
        or
        (
            ((snapshotted_data.ExceptionClass is null) and not (source_data.ExceptionClass is null))
            or
            ((not snapshotted_data.ExceptionClass is null) and (source_data.ExceptionClass is null))
        ) or snapshotted_data.Stacktrace != source_data.Stacktrace
        or
        (
            ((snapshotted_data.Stacktrace is null) and not (source_data.Stacktrace is null))
            or
            ((not snapshotted_data.Stacktrace is null) and (source_data.Stacktrace is null))
        ) or snapshotted_data.Properties != source_data.Properties
        or
        (
            ((snapshotted_data.Properties is null) and not (source_data.Properties is null))
            or
            ((not snapshotted_data.Properties is null) and (source_data.Properties is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Priority != source_data.Priority
        or
        (
            ((snapshotted_data.Priority is null) and not (source_data.Priority is null))
            or
            ((not snapshotted_data.Priority is null) and (source_data.Priority is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.EntryDaTestamp != source_data.EntryDaTestamp
        or
        (
            ((snapshotted_data.EntryDaTestamp is null) and not (source_data.EntryDaTestamp is null))
            or
            ((not snapshotted_data.EntryDaTestamp is null) and (source_data.EntryDaTestamp is null))
        ) or snapshotted_data.MachineName != source_data.MachineName
        or
        (
            ((snapshotted_data.MachineName is null) and not (source_data.MachineName is null))
            or
            ((not snapshotted_data.MachineName is null) and (source_data.MachineName is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.FunctionalArea != source_data.FunctionalArea
        or
        (
            ((snapshotted_data.FunctionalArea is null) and not (source_data.FunctionalArea is null))
            or
            ((not snapshotted_data.FunctionalArea is null) and (source_data.FunctionalArea is null))
        ) or snapshotted_data.Severity != source_data.Severity
        or
        (
            ((snapshotted_data.Severity is null) and not (source_data.Severity is null))
            or
            ((not snapshotted_data.Severity is null) and (source_data.Severity is null))
        ) or snapshotted_data.Actor != source_data.Actor
        or
        (
            ((snapshotted_data.Actor is null) and not (source_data.Actor is null))
            or
            ((not snapshotted_data.Actor is null) and (source_data.Actor is null))
        ) or snapshotted_data.ExceptionClass != source_data.ExceptionClass
        or
        (
            ((snapshotted_data.ExceptionClass is null) and not (source_data.ExceptionClass is null))
            or
            ((not snapshotted_data.ExceptionClass is null) and (source_data.ExceptionClass is null))
        ) or snapshotted_data.Stacktrace != source_data.Stacktrace
        or
        (
            ((snapshotted_data.Stacktrace is null) and not (source_data.Stacktrace is null))
            or
            ((not snapshotted_data.Stacktrace is null) and (source_data.Stacktrace is null))
        ) or snapshotted_data.Properties != source_data.Properties
        or
        (
            ((snapshotted_data.Properties is null) and not (source_data.Properties is null))
            or
            ((not snapshotted_data.Properties is null) and (source_data.Properties is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Logentries_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Logentries_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Logentries_Incr__dbt_tmp_temp_view"
    end



    
20:22:41.792165 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 14.56 seconds
20:22:41.795486 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:41.795725 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:41.835300 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:41.837742 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:41.837945 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    
20:22:43.221541 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
20:22:43.223181 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:43.223384 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:43.307321 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:22:43.309820 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:43.310032 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:43.854941 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.54 seconds
20:22:43.857792 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:43.857970 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr'
      and table_schema = 'stg'
  
20:22:44.218608 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
20:22:44.222907 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:44.223139 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:44.261187 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:44.262726 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:44.262913 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    
20:22:45.762989 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.50 seconds
20:22:45.764949 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:45.765172 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:45.839165 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:22:45.841818 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:45.842030 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:46.052555 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:22:46.055605 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:46.055840 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr'
      and table_schema = 'stg'
  
20:22:46.091388 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:46.096181 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:46.096480 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:46.133387 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:46.134814 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:46.134985 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    
20:22:46.690912 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 36.98 seconds
20:22:46.694268 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:46.694483 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:46.735464 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:46.736970 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:46.737151 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listings_Incr__dbt_tmp"
    
20:22:47.815164 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.68 seconds
20:22:47.816661 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:47.816838 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:47.898455 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:22:47.901020 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:47.901204 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:48.149830 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:22:48.152152 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_LogentriesBuffer_Incr"
20:22:48.152551 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:48.152665 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_LogentriesBuffer_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr" (
                  "ID", "Message", "Properties", "MachineName", "Title", "FunctionalArea", "Severity", "Actor", "ExceptionClass", "Stacktrace", "SqlDaTestamp", "EntryDaTestamp", "Priority", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Message", "Properties", "MachineName", "Title", "FunctionalArea", "Severity", "Actor", "ExceptionClass", "Stacktrace", "SqlDaTestamp", "EntryDaTestamp", "Priority", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:22:49.184981 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.45 seconds
20:22:49.186818 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:49.186993 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:49.268891 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:22:49.271650 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:49.271853 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:49.486702 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:22:49.489578 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:49.489805 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr'
      and table_schema = 'stg'
  
20:22:49.560935 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:22:49.565366 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:49.565569 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:49.604385 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:49.605783 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:49.605957 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listings_Incr__dbt_tmp"
    
20:22:50.064087 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.91 seconds
20:22:50.065738 [debug] [Thread-2  ]: On snapshot.Shawn.AH_LogentriesBuffer_Incr: COMMIT
20:22:50.066485 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
20:22:50.066666 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    end

20:22:50.105729 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:50.119480 [debug] [Thread-2  ]: finished collecting timing info
20:22:50.119784 [debug] [Thread-2  ]: On snapshot.Shawn.AH_LogentriesBuffer_Incr: Close
20:22:50.120443 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654bc760>]}
20:22:50.120863 [info ] [Thread-2  ]: 60 of 101 OK snapshotted stg.AH_LogentriesBuffer_Incr........................... [[32mOK[0m in 23.34s]
20:22:50.121178 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_LogentriesBuffer_Incr
20:22:50.121322 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Lots_Incr
20:22:50.121625 [info ] [Thread-2  ]: 62 of 101 START snapshot stg.AH_Lots_Incr....................................... [RUN]
20:22:50.121967 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Lots_Incr"
20:22:50.122066 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Lots_Incr
20:22:50.122153 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Lots_Incr
20:22:50.124719 [debug] [Thread-2  ]: finished collecting timing info
20:22:50.124877 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Lots_Incr
20:22:50.127573 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:22:50.127718 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:22:50.127798 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:22:50.127894 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:22:50.289061 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:22:50.321768 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:22:50.343800 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:22:50.344065 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:22:50.373665 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:22:50.375698 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:22:50.376433 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Lots_InterView]
        ) as __dbt_sbq
    
20:22:50.432889 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:22:50.455964 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:22:50.456241 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Lots_Incr"
        ) as __dbt_sbq
    
20:22:50.506959 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:22:50.510292 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:22:50.510482 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr'
      and table_schema = 'stg'
  
20:22:50.581048 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:22:50.584633 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:22:50.584844 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
        
  
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Lots_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Lots_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Lots_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Lots_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Lots_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Lots_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:22:50.353037'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:22:50.353037'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:22:50.353037''), CONVERT(DATETIME2, ''2022-09-26 20:22:50.353037'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:22:50.353037'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:22:50.353037'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:22:50.353037'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:22:50.353037'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LotNumber != source_data.LotNumber
        or
        (
            ((snapshotted_data.LotNumber is null) and not (source_data.LotNumber is null))
            or
            ((not snapshotted_data.LotNumber is null) and (source_data.LotNumber is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.IsSoftclosing != source_data.IsSoftclosing
        or
        (
            ((snapshotted_data.IsSoftclosing is null) and not (source_data.IsSoftclosing is null))
            or
            ((not snapshotted_data.IsSoftclosing is null) and (source_data.IsSoftclosing is null))
        ) or snapshotted_data.SoftclosingGroup != source_data.SoftclosingGroup
        or
        (
            ((snapshotted_data.SoftclosingGroup is null) and not (source_data.SoftclosingGroup is null))
            or
            ((not snapshotted_data.SoftclosingGroup is null) and (source_data.SoftclosingGroup is null))
        ) or snapshotted_data.LotOrder != source_data.LotOrder
        or
        (
            ((snapshotted_data.LotOrder is null) and not (source_data.LotOrder is null))
            or
            ((not snapshotted_data.LotOrder is null) and (source_data.LotOrder is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.ClosingGroup != source_data.ClosingGroup
        or
        (
            ((snapshotted_data.ClosingGroup is null) and not (source_data.ClosingGroup is null))
            or
            ((not snapshotted_data.ClosingGroup is null) and (source_data.ClosingGroup is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LotNumber != source_data.LotNumber
        or
        (
            ((snapshotted_data.LotNumber is null) and not (source_data.LotNumber is null))
            or
            ((not snapshotted_data.LotNumber is null) and (source_data.LotNumber is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.IsSoftclosing != source_data.IsSoftclosing
        or
        (
            ((snapshotted_data.IsSoftclosing is null) and not (source_data.IsSoftclosing is null))
            or
            ((not snapshotted_data.IsSoftclosing is null) and (source_data.IsSoftclosing is null))
        ) or snapshotted_data.SoftclosingGroup != source_data.SoftclosingGroup
        or
        (
            ((snapshotted_data.SoftclosingGroup is null) and not (source_data.SoftclosingGroup is null))
            or
            ((not snapshotted_data.SoftclosingGroup is null) and (source_data.SoftclosingGroup is null))
        ) or snapshotted_data.LotOrder != source_data.LotOrder
        or
        (
            ((snapshotted_data.LotOrder is null) and not (source_data.LotOrder is null))
            or
            ((not snapshotted_data.LotOrder is null) and (source_data.LotOrder is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.ClosingGroup != source_data.ClosingGroup
        or
        (
            ((snapshotted_data.ClosingGroup is null) and not (source_data.ClosingGroup is null))
            or
            ((not snapshotted_data.ClosingGroup is null) and (source_data.ClosingGroup is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Lots_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Lots_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Lots_Incr__dbt_tmp_temp_view"
    end



    
20:22:51.522533 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.92 seconds
20:22:51.524101 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:51.524294 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:51.597989 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:22:51.601009 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:51.601205 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:51.805528 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:22:51.808449 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:51.808662 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr'
      and table_schema = 'stg'
  
20:22:51.878827 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:22:51.883294 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:51.883500 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:51.924098 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:51.925574 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:51.925756 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listings_Incr__dbt_tmp"
    
20:22:54.027425 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.10 seconds
20:22:54.028992 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:54.029191 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:22:54.069371 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:54.072487 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:54.072702 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:54.337602 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:22:54.340271 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Listings_Incr"
20:22:54.340720 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:54.340848 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Listings_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Listings_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Listings_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Listings_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Listings_Incr" (
                  "ID", "LastUpdatedUser", "PrimaryImageURI", "OwnerUserName", "CurrentListingActionUserName", "Title", "Description", "SubTitle", "Location", "Status", "CreatedOn", "UpdatedOn", "DeletedOn", "Enddttm", "Startdttm", "AutoreListrEMAining", "CurrentQuantity", "OriginalQuantity", "ReListiteration", "LotID", "AcceptedActionCount", "OwnerID", "ListingTypeID", "Duration", "Version", "CurrencyID", "PrimaryCategoryID", "CurrentListingActionID", "OfferCount", "OriginalreListCount", "Hits", "CurrentPrice", "Increment", "OriginalPrice", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "LastUpdatedUser", "PrimaryImageURI", "OwnerUserName", "CurrentListingActionUserName", "Title", "Description", "SubTitle", "Location", "Status", "CreatedOn", "UpdatedOn", "DeletedOn", "Enddttm", "Startdttm", "AutoreListrEMAining", "CurrentQuantity", "OriginalQuantity", "ReListiteration", "LotID", "AcceptedActionCount", "OwnerID", "ListingTypeID", "Duration", "Version", "CurrencyID", "PrimaryCategoryID", "CurrentListingActionID", "OfferCount", "OriginalreListCount", "Hits", "CurrentPrice", "Increment", "OriginalPrice", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Listings_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:22:56.404030 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.06 seconds
20:22:56.406080 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Listings_Incr: COMMIT
20:22:56.406900 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
20:22:56.407046 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."#AH_Listings_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listings_Incr__dbt_tmp"
    end

20:22:56.450753 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:56.464294 [debug] [Thread-3  ]: finished collecting timing info
20:22:56.464628 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Listings_Incr: Close
20:22:56.465380 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654bc4c0>]}
20:22:56.465840 [info ] [Thread-3  ]: 58 of 101 OK snapshotted stg.AH_Listings_Incr................................... [[32mOK[0m in 47.59s]
20:22:56.466168 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Listings_Incr
20:22:56.466327 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_MediaMetaData_Incr
20:22:56.466675 [info ] [Thread-3  ]: 63 of 101 START snapshot stg.AH_MediaMetaData_Incr.............................. [RUN]
20:22:56.467059 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr"
20:22:56.467160 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_MediaMetaData_Incr
20:22:56.467254 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_MediaMetaData_Incr
20:22:56.469948 [debug] [Thread-3  ]: finished collecting timing info
20:22:56.470103 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_MediaMetaData_Incr
20:22:56.473169 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:22:56.473324 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:22:56.473405 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:22:56.473501 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:22:56.583365 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:22:56.614892 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:22:56.637116 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:22:56.637406 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:22:56.667234 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:22:56.669383 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:22:56.669961 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_MediaMetaData_InterView]
        ) as __dbt_sbq
    
20:22:56.743276 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:22:56.764228 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:22:56.764509 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr"
        ) as __dbt_sbq
    
20:22:56.866935 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:22:56.870292 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:22:56.870535 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr'
      and table_schema = 'stg'
  
20:22:56.944210 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:22:56.947814 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:22:56.948041 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
        
  
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_MediaMetaData_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_MediaMetaData_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_MediaMetaData_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_MediaMetaData_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:22:56.649998'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:22:56.649998'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:22:56.649998''), CONVERT(DATETIME2, ''2022-09-26 20:22:56.649998'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:22:56.649998'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:22:56.649998'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:22:56.649998'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:22:56.649998'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_MediaMetaData_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_MediaMetaData_Incr__dbt_tmp_temp_view"
    end



    
20:22:58.659110 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 8.07 seconds
20:22:58.662418 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:22:58.662679 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:22:58.705445 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:22:58.706936 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:22:58.707119 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Lots_Incr__dbt_tmp"
    
20:23:00.264779 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.56 seconds
20:23:00.266278 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:23:00.266467 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:23:00.344160 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:23:00.346530 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:23:00.346770 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:23:00.650165 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:23:00.653099 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:23:00.653309 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr'
      and table_schema = 'stg'
  
20:23:00.748512 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:23:00.752799 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:23:00.753035 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:23:00.798892 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:23:00.800352 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:23:00.800533 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Lots_Incr__dbt_tmp"
    
20:23:03.886271 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.09 seconds
20:23:03.887821 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:23:03.888002 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:23:04.027530 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:23:04.029832 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:23:04.030033 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:23:04.433177 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
20:23:04.435938 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:23:04.436194 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr'
      and table_schema = 'stg'
  
20:23:04.501250 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:23:04.505204 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:23:04.505456 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:23:04.596923 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:23:04.598220 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:23:04.598385 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Lots_Incr__dbt_tmp"
    
20:23:06.742965 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.14 seconds
20:23:06.744466 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:23:06.744650 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:23:06.808954 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:23:06.811457 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:23:06.811678 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:23:07.222906 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
20:23:07.224834 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Lots_Incr"
20:23:07.225280 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:23:07.225409 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Lots_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Lots_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Lots_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Lots_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Lots_Incr" (
                  "ID", "LotNumber", "LastUpdatedUser", "IsSoftclosing", "SoftclosingGroup", "LotOrder", "AuctionEventID", "ClosingGroup", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "LotNumber", "LastUpdatedUser", "IsSoftclosing", "SoftclosingGroup", "LotOrder", "AuctionEventID", "ClosingGroup", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Lots_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:23:10.784199 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.56 seconds
20:23:10.785612 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Lots_Incr: COMMIT
20:23:10.788292 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
20:23:10.788472 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."#AH_Lots_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Lots_Incr__dbt_tmp"
    end

20:23:11.083484 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
20:23:11.095392 [debug] [Thread-2  ]: finished collecting timing info
20:23:11.095691 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Lots_Incr: Close
20:23:11.096382 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016407a1f0>]}
20:23:11.096795 [info ] [Thread-2  ]: 62 of 101 OK snapshotted stg.AH_Lots_Incr....................................... [[32mOK[0m in 20.97s]
20:23:11.097100 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Lots_Incr
20:23:11.097270 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Media_Incr
20:23:11.097578 [info ] [Thread-2  ]: 64 of 101 START snapshot stg.AH_Media_Incr...................................... [RUN]
20:23:11.097939 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Media_Incr"
20:23:11.098039 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Media_Incr
20:23:11.098129 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Media_Incr
20:23:11.100762 [debug] [Thread-2  ]: finished collecting timing info
20:23:11.100914 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Media_Incr
20:23:11.103661 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:23:11.103805 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:23:11.103885 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:23:11.103980 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:23:11.291243 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:23:11.401814 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:23:11.423971 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:23:11.424246 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:23:11.548336 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:23:11.550195 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:23:11.550680 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Media_InterView]
        ) as __dbt_sbq
    
20:23:11.762452 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:23:11.784321 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:23:11.784598 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Media_Incr"
        ) as __dbt_sbq
    
20:23:12.419913 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.64 seconds
20:23:12.423252 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:23:12.423441 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr'
      and table_schema = 'stg'
  
20:23:12.574348 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:23:12.577815 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:23:12.578020 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
        
  
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Media_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Media_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Media_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Media_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Media_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Media_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:23:11.494003'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:23:11.494003'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:23:11.494003''), CONVERT(DATETIME2, ''2022-09-26 20:23:11.494003'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:23:11.494003'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:23:11.494003'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:23:11.494003'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:23:11.494003'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.GUID != source_data.GUID
        or
        (
            ((snapshotted_data.GUID is null) and not (source_data.GUID is null))
            or
            ((not snapshotted_data.GUID is null) and (source_data.GUID is null))
        ) or snapshotted_data.DefaultvariationName != source_data.DefaultvariationName
        or
        (
            ((snapshotted_data.DefaultvariationName is null) and not (source_data.DefaultvariationName is null))
            or
            ((not snapshotted_data.DefaultvariationName is null) and (source_data.DefaultvariationName is null))
        ) or snapshotted_data.Loader != source_data.Loader
        or
        (
            ((snapshotted_data.Loader is null) and not (source_data.Loader is null))
            or
            ((not snapshotted_data.Loader is null) and (source_data.Loader is null))
        ) or snapshotted_data.Saver != source_data.Saver
        or
        (
            ((snapshotted_data.Saver is null) and not (source_data.Saver is null))
            or
            ((not snapshotted_data.Saver is null) and (source_data.Saver is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.ConText != source_data.ConText
        or
        (
            ((snapshotted_data.ConText is null) and not (source_data.ConText is null))
            or
            ((not snapshotted_data.ConText is null) and (source_data.ConText is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.GUID != source_data.GUID
        or
        (
            ((snapshotted_data.GUID is null) and not (source_data.GUID is null))
            or
            ((not snapshotted_data.GUID is null) and (source_data.GUID is null))
        ) or snapshotted_data.DefaultvariationName != source_data.DefaultvariationName
        or
        (
            ((snapshotted_data.DefaultvariationName is null) and not (source_data.DefaultvariationName is null))
            or
            ((not snapshotted_data.DefaultvariationName is null) and (source_data.DefaultvariationName is null))
        ) or snapshotted_data.Loader != source_data.Loader
        or
        (
            ((snapshotted_data.Loader is null) and not (source_data.Loader is null))
            or
            ((not snapshotted_data.Loader is null) and (source_data.Loader is null))
        ) or snapshotted_data.Saver != source_data.Saver
        or
        (
            ((snapshotted_data.Saver is null) and not (source_data.Saver is null))
            or
            ((not snapshotted_data.Saver is null) and (source_data.Saver is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.ConText != source_data.ConText
        or
        (
            ((snapshotted_data.ConText is null) and not (source_data.ConText is null))
            or
            ((not snapshotted_data.ConText is null) and (source_data.ConText is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Media_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Media_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Media_Incr__dbt_tmp_temp_view"
    end



    
20:23:35.756320 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 89.60 seconds
20:23:35.759529 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:23:35.759736 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:23:35.839345 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:23:35.840665 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:23:35.840835 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingproperties_Incr__dbt_tmp"
    
20:23:38.827151 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.99 seconds
20:23:38.828704 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:23:38.828896 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:23:38.942724 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:23:38.945332 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:23:38.945577 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:23:39.557703 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.61 seconds
20:23:39.560924 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:23:39.561204 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr'
      and table_schema = 'stg'
  
20:23:39.674033 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:23:39.678285 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:23:39.678596 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:23:39.748772 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:23:39.750267 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:23:39.750467 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingproperties_Incr__dbt_tmp"
    
20:23:42.883448 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.13 seconds
20:23:42.885028 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:23:42.885227 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:23:43.070879 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:23:43.073341 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:23:43.073582 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:23:43.564169 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.49 seconds
20:23:43.566973 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:23:43.567208 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr'
      and table_schema = 'stg'
  
20:23:43.777585 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:23:43.781979 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:23:43.782235 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:23:43.922057 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:23:43.923401 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:23:43.923574 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingproperties_Incr__dbt_tmp"
    
20:23:47.263712 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.34 seconds
20:23:47.265858 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:23:47.266054 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:23:47.420408 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:23:47.423073 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:23:47.423312 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:23:47.816199 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
20:23:47.818344 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Listingproperties_Incr"
20:23:47.818820 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:23:47.818962 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Listingproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr" (
                  "ID", "DecimalnativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "BoolnativeValue", "IntnativeValue", "ListingID", "CustomFieldID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DecimalnativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "BoolnativeValue", "IntnativeValue", "ListingID", "CustomFieldID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Listingproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:23:49.404186 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 36.83 seconds
20:23:49.407712 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:23:49.407958 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:23:49.510042 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:23:49.511527 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:23:49.511699 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Media_Incr__dbt_tmp"
    
20:23:56.836933 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.33 seconds
20:23:56.838432 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:23:56.838619 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:23:56.955413 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:23:56.958139 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:23:56.958362 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:23:57.659188 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.70 seconds
20:23:57.661864 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:23:57.662076 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr'
      and table_schema = 'stg'
  
20:23:57.769464 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:23:57.773729 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:23:57.773990 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:23:57.871425 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:23:57.873144 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:23:57.873324 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Media_Incr__dbt_tmp"
    
20:24:01.953473 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 4.08 seconds
20:24:01.955037 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:24:01.955231 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:24:02.060259 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:24:02.062763 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:24:02.062996 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:02.515971 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.45 seconds
20:24:02.521213 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:24:02.521478 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr'
      and table_schema = 'stg'
  
20:24:02.586382 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:24:02.590831 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:24:02.591101 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:02.664959 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:24:02.666410 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:24:02.666620 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Media_Incr__dbt_tmp"
    
20:24:05.118037 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.45 seconds
20:24:05.119682 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:24:05.119854 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:24:05.224742 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:24:05.227076 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:24:05.227282 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:05.652643 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
20:24:05.654681 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Media_Incr"
20:24:05.655160 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:24:05.655291 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Media_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Media_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Media_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Media_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Media_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "GUID", "DefaultvariationName", "Loader", "Saver", "LastUpdatedUser", "ConText", "Status", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "GUID", "DefaultvariationName", "Loader", "Saver", "LastUpdatedUser", "ConText", "Status", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Media_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:24:06.976116 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 97.59 seconds
20:24:06.979314 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:24:06.979530 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:07.028967 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:24:07.030424 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:24:07.030639 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Logentries_Incr__dbt_tmp"
    
20:24:08.648442 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.99 seconds
20:24:08.649957 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Media_Incr: COMMIT
20:24:08.650698 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
20:24:08.650831 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."#AH_Media_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Media_Incr__dbt_tmp"
    end

20:24:08.726881 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:24:08.739411 [debug] [Thread-2  ]: finished collecting timing info
20:24:08.739739 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Media_Incr: Close
20:24:08.740419 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654bcdf0>]}
20:24:08.740843 [info ] [Thread-2  ]: 64 of 101 OK snapshotted stg.AH_Media_Incr...................................... [[32mOK[0m in 57.64s]
20:24:08.741164 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Media_Incr
20:24:08.741319 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_MediaassetMetaData_Incr
20:24:08.741614 [info ] [Thread-2  ]: 65 of 101 START snapshot stg.AH_MediaassetMetaData_Incr......................... [RUN]
20:24:08.741965 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr"
20:24:08.742063 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_MediaassetMetaData_Incr
20:24:08.742155 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_MediaassetMetaData_Incr
20:24:08.744852 [debug] [Thread-2  ]: finished collecting timing info
20:24:08.745016 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_MediaassetMetaData_Incr
20:24:08.747853 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:08.747998 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:24:08.748082 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:24:08.748179 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:24:08.889964 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:24:08.950376 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:24:08.972558 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:08.972832 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:24:09.027104 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:24:09.029204 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:09.029757 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_MediaassetMetaData_InterView]
        ) as __dbt_sbq
    
20:24:09.118972 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:24:09.140154 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:09.140447 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr"
        ) as __dbt_sbq
    
20:24:09.217009 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:24:09.220125 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:09.220388 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr'
      and table_schema = 'stg'
  
20:24:09.364944 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:24:09.368296 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:09.368526 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
        
  
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_MediaassetMetaData_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_MediaassetMetaData_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:24:08.994769'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:24:08.994769'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:24:08.994769''), CONVERT(DATETIME2, ''2022-09-26 20:24:08.994769'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:24:08.994769'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:24:08.994769'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:24:08.994769'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:24:08.994769'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.MediaassetID != source_data.MediaassetID
        or
        (
            ((snapshotted_data.MediaassetID is null) and not (source_data.MediaassetID is null))
            or
            ((not snapshotted_data.MediaassetID is null) and (source_data.MediaassetID is null))
        ) or snapshotted_data.MediaMetaDataID != source_data.MediaMetaDataID
        or
        (
            ((snapshotted_data.MediaMetaDataID is null) and not (source_data.MediaMetaDataID is null))
            or
            ((not snapshotted_data.MediaMetaDataID is null) and (source_data.MediaMetaDataID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.MediaassetID != source_data.MediaassetID
        or
        (
            ((snapshotted_data.MediaassetID is null) and not (source_data.MediaassetID is null))
            or
            ((not snapshotted_data.MediaassetID is null) and (source_data.MediaassetID is null))
        ) or snapshotted_data.MediaMetaDataID != source_data.MediaMetaDataID
        or
        (
            ((snapshotted_data.MediaMetaDataID is null) and not (source_data.MediaMetaDataID is null))
            or
            ((not snapshotted_data.MediaMetaDataID is null) and (source_data.MediaMetaDataID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_MediaassetMetaData_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_temp_view"
    end



    
20:24:11.929315 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 4.90 seconds
20:24:11.930828 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:24:11.931037 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:24:12.039646 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:24:12.042034 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:24:12.042210 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:12.391217 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
20:24:12.393998 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:24:12.394211 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr'
      and table_schema = 'stg'
  
20:24:12.493735 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:24:12.497833 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:24:12.498176 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:12.539371 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:24:12.540726 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:24:12.540891 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Logentries_Incr__dbt_tmp"
    
20:24:20.266159 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 7.73 seconds
20:24:20.267592 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:24:20.267775 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:24:20.363977 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:24:20.366731 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:24:20.366990 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:20.819392 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.45 seconds
20:24:20.822559 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:24:20.822812 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr'
      and table_schema = 'stg'
  
20:24:20.930907 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:24:20.935394 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:24:20.935645 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:21.072360 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:24:21.073821 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:24:21.074041 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Logentries_Incr__dbt_tmp"
    
20:24:27.925781 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 6.85 seconds
20:24:27.927405 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:24:27.927609 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:24:27.978794 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:24:27.981438 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:24:27.981678 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:28.284045 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:24:28.286652 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Logentries_Incr"
20:24:28.287150 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:24:28.287397 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Logentries_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Logentries_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Logentries_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Logentries_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Logentries_Incr" (
                  "ID", "Priority", "EventID", "SqlDaTestamp", "EntryDaTestamp", "MachineName", "Message", "Title", "FunctionalArea", "Severity", "Actor", "ExceptionClass", "Stacktrace", "Properties", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Priority", "EventID", "SqlDaTestamp", "EntryDaTestamp", "MachineName", "Message", "Title", "FunctionalArea", "Severity", "Actor", "ExceptionClass", "Stacktrace", "Properties", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Logentries_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:24:30.032530 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 20.66 seconds
20:24:30.036108 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:30.036387 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:30.086262 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:24:30.087679 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:30.087851 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    
20:24:30.790382 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.50 seconds
20:24:30.791960 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Logentries_Incr: COMMIT
20:24:30.793047 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
20:24:30.793216 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."#AH_Logentries_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Logentries_Incr__dbt_tmp"
    end

20:24:30.840038 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:24:30.853689 [debug] [Thread-4  ]: finished collecting timing info
20:24:30.854030 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Logentries_Incr: Close
20:24:30.854794 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654bca00>]}
20:24:30.855258 [info ] [Thread-4  ]: 61 of 101 OK snapshotted stg.AH_Logentries_Incr................................. [[32mOK[0m in 122.35s]
20:24:30.855585 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Logentries_Incr
20:24:30.855736 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Mediaassets_Incr
20:24:30.856045 [info ] [Thread-4  ]: 66 of 101 START snapshot stg.AH_Mediaassets_Incr................................ [RUN]
20:24:30.856403 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Mediaassets_Incr"
20:24:30.856503 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Mediaassets_Incr
20:24:30.856595 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Mediaassets_Incr
20:24:30.859353 [debug] [Thread-4  ]: finished collecting timing info
20:24:30.859527 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Mediaassets_Incr
20:24:30.862531 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:24:30.862715 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:24:30.862796 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:24:30.862892 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:24:30.984218 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:24:31.014310 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:24:31.036979 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:24:31.037256 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:24:31.068836 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:24:31.070937 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:24:31.071786 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Mediaassets_InterView]
        ) as __dbt_sbq
    
20:24:31.133940 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:24:31.155246 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:24:31.155549 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr"
        ) as __dbt_sbq
    
20:24:31.405802 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:24:31.409026 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:24:31.409276 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr'
      and table_schema = 'stg'
  
20:24:31.479914 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:24:31.483373 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:24:31.483641 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
        
  
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Mediaassets_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Mediaassets_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Mediaassets_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Mediaassets_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Mediaassets_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:24:31.041999'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:24:31.041999'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:24:31.041999''), CONVERT(DATETIME2, ''2022-09-26 20:24:31.041999'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:24:31.041999'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:24:31.041999'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:24:31.041999'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:24:31.041999'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.Reference != source_data.Reference
        or
        (
            ((snapshotted_data.Reference is null) and not (source_data.Reference is null))
            or
            ((not snapshotted_data.Reference is null) and (source_data.Reference is null))
        ) or snapshotted_data.Sha1 != source_data.Sha1
        or
        (
            ((snapshotted_data.Sha1 is null) and not (source_data.Sha1 is null))
            or
            ((not snapshotted_data.Sha1 is null) and (source_data.Sha1 is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.Reference != source_data.Reference
        or
        (
            ((snapshotted_data.Reference is null) and not (source_data.Reference is null))
            or
            ((not snapshotted_data.Reference is null) and (source_data.Reference is null))
        ) or snapshotted_data.Sha1 != source_data.Sha1
        or
        (
            ((snapshotted_data.Sha1 is null) and not (source_data.Sha1 is null))
            or
            ((not snapshotted_data.Sha1 is null) and (source_data.Sha1 is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Mediaassets_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Mediaassets_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Mediaassets_Incr__dbt_tmp_temp_view"
    end



    
20:24:31.810389 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.72 seconds
20:24:31.811948 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:31.812150 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:24:31.890935 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:24:31.893323 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:31.893548 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:32.180115 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
20:24:32.183166 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:32.183437 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr'
      and table_schema = 'stg'
  
20:24:32.218769 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:24:32.222589 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:32.222845 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:32.281308 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:24:32.282786 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:32.282990 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    
20:24:33.828168 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.55 seconds
20:24:33.829646 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:33.829841 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:24:33.908795 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:24:33.911079 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:33.911302 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:34.212757 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:24:34.215627 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:34.215884 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr'
      and table_schema = 'stg'
  
20:24:34.398773 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:24:34.402890 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:34.403139 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:34.521743 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:24:34.523628 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:34.523824 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    
20:24:36.115302 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.59 seconds
20:24:36.116713 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:36.116935 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:24:36.159061 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:24:36.161374 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:36.161614 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:37.072293 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.91 seconds
20:24:37.074366 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_MediaassetMetaData_Incr"
20:24:37.074887 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:37.075040 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_MediaassetMetaData_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr" (
                  "ID", "MediaassetID", "MediaMetaDataID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "MediaassetID", "MediaMetaDataID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:24:38.779118 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 101.83 seconds
20:24:38.782587 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:24:38.782985 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:38.825007 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:24:38.826474 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:24:38.826719 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    
20:24:40.054640 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.98 seconds
20:24:40.057060 [debug] [Thread-2  ]: On snapshot.Shawn.AH_MediaassetMetaData_Incr: COMMIT
20:24:40.058596 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
20:24:40.058833 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    end

20:24:40.148375 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:24:40.163042 [debug] [Thread-2  ]: finished collecting timing info
20:24:40.163491 [debug] [Thread-2  ]: On snapshot.Shawn.AH_MediaassetMetaData_Incr: Close
20:24:40.164173 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654b30d0>]}
20:24:40.164720 [info ] [Thread-2  ]: 65 of 101 OK snapshotted stg.AH_MediaassetMetaData_Incr......................... [[32mOK[0m in 31.42s]
20:24:40.165033 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_MediaassetMetaData_Incr
20:24:40.165196 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Mediavariations_Incr
20:24:40.165575 [info ] [Thread-2  ]: 67 of 101 START snapshot stg.AH_Mediavariations_Incr............................ [RUN]
20:24:40.165975 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Mediavariations_Incr"
20:24:40.166078 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Mediavariations_Incr
20:24:40.166169 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Mediavariations_Incr
20:24:40.169166 [debug] [Thread-2  ]: finished collecting timing info
20:24:40.169494 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Mediavariations_Incr
20:24:40.173051 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:24:40.173260 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:24:40.173344 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:24:40.173462 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:24:40.385440 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:24:40.418583 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:24:40.440994 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:24:40.441275 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:24:40.480021 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:24:40.482122 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:24:40.482762 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Mediavariations_InterView]
        ) as __dbt_sbq
    
20:24:40.494680 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.67 seconds
20:24:40.496140 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:24:40.496334 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:24:40.542580 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:24:40.564084 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:24:40.564370 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr"
        ) as __dbt_sbq
    
20:24:40.566867 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:24:40.568972 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:24:40.569136 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:40.610966 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:24:40.615246 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:24:40.615508 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr'
      and table_schema = 'stg'
  
20:24:40.687490 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:24:40.691053 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:24:40.691420 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
        
  
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Mediavariations_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Mediavariations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Mediavariations_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Mediavariations_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Mediavariations_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:24:40.448378'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:24:40.448378'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:24:40.448378''), CONVERT(DATETIME2, ''2022-09-26 20:24:40.448378'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:24:40.448378'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:24:40.448378'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:24:40.448378'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:24:40.448378'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaassetID != source_data.MediaassetID
        or
        (
            ((snapshotted_data.MediaassetID is null) and not (source_data.MediaassetID is null))
            or
            ((not snapshotted_data.MediaassetID is null) and (source_data.MediaassetID is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaassetID != source_data.MediaassetID
        or
        (
            ((snapshotted_data.MediaassetID is null) and not (source_data.MediaassetID is null))
            or
            ((not snapshotted_data.MediaassetID is null) and (source_data.MediaassetID is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Mediavariations_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Mediavariations_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Mediavariations_Incr__dbt_tmp_temp_view"
    end



    
20:24:40.787729 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:24:40.790533 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:24:40.790806 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr'
      and table_schema = 'stg'
  
20:24:40.974096 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:24:40.977833 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:24:40.978072 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:41.015325 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:24:41.016834 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:24:41.017040 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    
20:24:43.251590 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.23 seconds
20:24:43.253312 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:24:43.253550 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:24:43.437493 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:24:43.439927 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:24:43.440152 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:44.144190 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 56.33 seconds
20:24:44.145696 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Listingproperties_Incr: COMMIT
20:24:44.146388 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
20:24:44.146512 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."#AH_Listingproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listingproperties_Incr__dbt_tmp"
    end

20:24:44.189099 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:24:44.291108 [debug] [Thread-1  ]: finished collecting timing info
20:24:44.291449 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Listingproperties_Incr: Close
20:24:44.292183 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654b3040>]}
20:24:44.292667 [info ] [Thread-1  ]: 56 of 101 OK snapshotted stg.AH_Listingproperties_Incr.......................... [[32mOK[0m in 158.75s]
20:24:44.292986 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Listingproperties_Incr
20:24:44.293140 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Model_Incr
20:24:44.293443 [info ] [Thread-1  ]: 68 of 101 START snapshot stg.AH_Model_Incr...................................... [RUN]
20:24:44.293809 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Model_Incr"
20:24:44.293910 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Model_Incr
20:24:44.294001 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Model_Incr
20:24:44.296888 [debug] [Thread-1  ]: finished collecting timing info
20:24:44.297050 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Model_Incr
20:24:44.299900 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:24:44.300052 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:24:44.300135 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:24:44.300234 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:24:44.483087 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:24:44.762682 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.46 seconds
20:24:44.784899 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:24:44.785190 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:24:44.868206 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:24:44.868664 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.43 seconds
20:24:44.871670 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:24:44.871893 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr'
      and table_schema = 'stg'
  
20:24:44.873764 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:24:44.873933 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Model_InterView]
        ) as __dbt_sbq
    
20:24:44.968841 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:24:44.987336 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:24:44.991449 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:24:44.994378 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:44.994171 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:24:44.994668 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Model_Incr"
        ) as __dbt_sbq
    
20:24:45.232049 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:24:45.233787 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:24:45.233977 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    
20:24:45.241682 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:24:45.244854 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:24:45.245045 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr'
      and table_schema = 'stg'
  
20:24:45.393647 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:24:45.396657 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:24:45.396874 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
        
  
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Model_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Model_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Model_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Model_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Model_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Model_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:24:44.839066'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:24:44.839066'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:24:44.839066''), CONVERT(DATETIME2, ''2022-09-26 20:24:44.839066'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:24:44.839066'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:24:44.839066'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:24:44.839066'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:24:44.839066'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Model_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Model_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Model_Incr__dbt_tmp_temp_view"
    end



    
20:24:47.144862 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.91 seconds
20:24:47.146304 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:24:47.146488 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:24:47.217876 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:24:47.220652 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:24:47.220871 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:47.760498 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.54 seconds
20:24:47.762398 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_MediaMetaData_Incr"
20:24:47.762879 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:24:47.763007 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_MediaMetaData_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr" (
                  "ID", "Name", "Value", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Value", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_MediaMetaData_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:24:50.621065 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.86 seconds
20:24:50.622826 [debug] [Thread-3  ]: On snapshot.Shawn.AH_MediaMetaData_Incr: COMMIT
20:24:50.623595 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
20:24:50.623749 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."#AH_MediaMetaData_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    end

20:24:50.664864 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:24:50.677434 [debug] [Thread-3  ]: finished collecting timing info
20:24:50.677752 [debug] [Thread-3  ]: On snapshot.Shawn.AH_MediaMetaData_Incr: Close
20:24:50.678465 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654bc8b0>]}
20:24:50.678947 [info ] [Thread-3  ]: 63 of 101 OK snapshotted stg.AH_MediaMetaData_Incr.............................. [[32mOK[0m in 114.21s]
20:24:50.679273 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_MediaMetaData_Incr
20:24:50.679414 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_NewSalestoInvoice_Incr
20:24:50.679716 [info ] [Thread-3  ]: 69 of 101 START snapshot stg.AH_NewSalestoInvoice_Incr.......................... [RUN]
20:24:50.680105 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr"
20:24:50.680205 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_NewSalestoInvoice_Incr
20:24:50.680297 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_NewSalestoInvoice_Incr
20:24:50.683028 [debug] [Thread-3  ]: finished collecting timing info
20:24:50.683190 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_NewSalestoInvoice_Incr
20:24:50.686052 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:24:50.686203 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:24:50.686284 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:24:50.686378 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:24:50.805372 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:24:50.911848 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:24:50.933595 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:24:50.933880 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:24:50.963717 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:24:50.965726 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:24:50.966237 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_NewSalestoInvoice_InterView]
        ) as __dbt_sbq
    
20:24:51.023361 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:24:51.044735 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:24:51.045013 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr"
        ) as __dbt_sbq
    
20:24:51.116955 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:24:51.119961 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:24:51.120165 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr'
      and table_schema = 'stg'
  
20:24:51.242913 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:24:51.246136 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:24:51.246341 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
        
  
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_NewSalestoInvoice_InterView]

    ),

    snapshotted_data as (

        select *,
            LineItemID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LineItemID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:24:50.932907'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:24:50.932907'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:24:50.932907''), CONVERT(DATETIME2, ''2022-09-26 20:24:50.932907'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(LineItemID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:24:50.932907'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LineItemID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:24:50.932907'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:24:50.932907'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:24:50.932907'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.LineItemID != source_data.LineItemID
        or
        (
            ((snapshotted_data.LineItemID is null) and not (source_data.LineItemID is null))
            or
            ((not snapshotted_data.LineItemID is null) and (source_data.LineItemID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.LineItemID != source_data.LineItemID
        or
        (
            ((snapshotted_data.LineItemID is null) and not (source_data.LineItemID is null))
            or
            ((not snapshotted_data.LineItemID is null) and (source_data.LineItemID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view"
    end



    
20:24:52.217262 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.82 seconds
20:24:52.220669 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:24:52.220896 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:52.272829 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:24:52.274194 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:24:52.274360 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Model_Incr__dbt_tmp"
    
20:24:54.271816 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.00 seconds
20:24:54.273479 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:24:54.273668 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:24:54.470165 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:24:54.472408 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:24:54.472642 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:55.142463 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.67 seconds
20:24:55.145363 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:24:55.145557 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr'
      and table_schema = 'stg'
  
20:24:55.329514 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:24:55.333402 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:24:55.333725 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:24:55.551894 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:24:55.553223 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:24:55.553412 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Model_Incr__dbt_tmp"
    
20:25:00.497543 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 4.94 seconds
20:25:00.499082 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:25:00.499294 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:00.645305 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:25:00.647669 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:25:00.647934 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:01.492654 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.84 seconds
20:25:01.495736 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:25:01.496030 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr'
      and table_schema = 'stg'
  
20:25:01.634075 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:25:01.639525 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:25:01.639783 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:01.806352 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:25:01.807856 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:25:01.808060 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Model_Incr__dbt_tmp"
    
20:25:03.696488 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 12.45 seconds
20:25:03.699976 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:25:03.700264 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:03.968575 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:25:03.970339 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:25:03.970566 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    
20:25:05.882516 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 4.07 seconds
20:25:05.883999 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:25:05.884201 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:06.006372 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:25:06.008817 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:25:06.009057 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:06.487727 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.48 seconds
20:25:06.489642 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Model_Incr"
20:25:06.490112 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:25:06.490246 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Model_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Model_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Model_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Model_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Model_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Model_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:25:06.631667 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.66 seconds
20:25:06.633257 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:25:06.633481 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:06.768529 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:25:06.771109 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:25:06.771360 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:07.260995 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.49 seconds
20:25:07.263843 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:25:07.264095 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr'
      and table_schema = 'stg'
  
20:25:07.396320 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:25:07.400350 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:25:07.400625 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:07.502618 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:25:07.503933 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:25:07.504113 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    
20:25:08.571661 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 37.09 seconds
20:25:08.575031 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:25:08.575296 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:08.664860 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:25:08.666347 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:25:08.666578 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediaassets_Incr__dbt_tmp"
    
20:25:09.278595 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.77 seconds
20:25:09.280019 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:25:09.280214 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:09.347606 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.86 seconds
20:25:09.349173 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Model_Incr: COMMIT
20:25:09.350181 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
20:25:09.350328 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."#AH_Model_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Model_Incr__dbt_tmp"
    end

20:25:09.418756 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:25:09.420967 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:25:09.421195 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:09.421438 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:09.434357 [debug] [Thread-1  ]: finished collecting timing info
20:25:09.434730 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Model_Incr: Close
20:25:09.435460 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654bc610>]}
20:25:09.435920 [info ] [Thread-1  ]: 68 of 101 OK snapshotted stg.AH_Model_Incr...................................... [[32mOK[0m in 25.14s]
20:25:09.436248 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Model_Incr
20:25:09.436402 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Notifications_Incr
20:25:09.436705 [info ] [Thread-1  ]: 70 of 101 START snapshot stg.AH_Notifications_Incr.............................. [RUN]
20:25:09.437060 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Notifications_Incr"
20:25:09.437175 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Notifications_Incr
20:25:09.437269 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Notifications_Incr
20:25:09.440058 [debug] [Thread-1  ]: finished collecting timing info
20:25:09.440238 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Notifications_Incr
20:25:09.443244 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:09.443437 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:25:09.443522 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:25:09.443624 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:25:09.593136 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:25:09.654084 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:25:09.677714 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:09.678417 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:25:09.734839 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:25:09.737048 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:09.737290 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Notifications_InterView]
        ) as __dbt_sbq
    
20:25:09.821297 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
20:25:09.824073 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:25:09.824312 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr'
      and table_schema = 'stg'
  
20:25:09.837897 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:25:09.860784 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:09.861081 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Notifications_Incr"
        ) as __dbt_sbq
    
20:25:09.952171 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:25:09.956301 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:25:09.956588 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:10.035942 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:25:10.037384 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:25:10.037560 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    
20:25:10.625149 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.96 seconds
20:25:10.626940 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:25:10.627163 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:10.656997 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.80 seconds
20:25:10.660803 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:10.661015 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr'
      and table_schema = 'stg'
  
20:25:10.741314 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:25:10.743722 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:25:10.743951 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:10.773259 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:25:10.776603 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:10.776855 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
        
  
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Notifications_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Notifications_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Notifications_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Notifications_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Notifications_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Notifications_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:09.698762'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:09.698762'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:25:09.698762''), CONVERT(DATETIME2, ''2022-09-26 20:25:09.698762'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:25:09.698762'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:09.698762'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:09.698762'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:25:09.698762'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DetailID != source_data.DetailID
        or
        (
            ((snapshotted_data.DetailID is null) and not (source_data.DetailID is null))
            or
            ((not snapshotted_data.DetailID is null) and (source_data.DetailID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Queueddttm != source_data.Queueddttm
        or
        (
            ((snapshotted_data.Queueddttm is null) and not (source_data.Queueddttm is null))
            or
            ((not snapshotted_data.Queueddttm is null) and (source_data.Queueddttm is null))
        ) or snapshotted_data.Statusdttm != source_data.Statusdttm
        or
        (
            ((snapshotted_data.Statusdttm is null) and not (source_data.Statusdttm is null))
            or
            ((not snapshotted_data.Statusdttm is null) and (source_data.Statusdttm is null))
        ) or snapshotted_data.RecipientEmail != source_data.RecipientEmail
        or
        (
            ((snapshotted_data.RecipientEmail is null) and not (source_data.RecipientEmail is null))
            or
            ((not snapshotted_data.RecipientEmail is null) and (source_data.RecipientEmail is null))
        ) or snapshotted_data.CcEmail != source_data.CcEmail
        or
        (
            ((snapshotted_data.CcEmail is null) and not (source_data.CcEmail is null))
            or
            ((not snapshotted_data.CcEmail is null) and (source_data.CcEmail is null))
        ) or snapshotted_data.BCcEmail != source_data.BCcEmail
        or
        (
            ((snapshotted_data.BCcEmail is null) and not (source_data.BCcEmail is null))
            or
            ((not snapshotted_data.BCcEmail is null) and (source_data.BCcEmail is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.StatusMessage != source_data.StatusMessage
        or
        (
            ((snapshotted_data.StatusMessage is null) and not (source_data.StatusMessage is null))
            or
            ((not snapshotted_data.StatusMessage is null) and (source_data.StatusMessage is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.DetailType != source_data.DetailType
        or
        (
            ((snapshotted_data.DetailType is null) and not (source_data.DetailType is null))
            or
            ((not snapshotted_data.DetailType is null) and (source_data.DetailType is null))
        ) or snapshotted_data.ReplytoEmail != source_data.ReplytoEmail
        or
        (
            ((snapshotted_data.ReplytoEmail is null) and not (source_data.ReplytoEmail is null))
            or
            ((not snapshotted_data.ReplytoEmail is null) and (source_data.ReplytoEmail is null))
        ) or snapshotted_data.SEnderUserName != source_data.SEnderUserName
        or
        (
            ((snapshotted_data.SEnderUserName is null) and not (source_data.SEnderUserName is null))
            or
            ((not snapshotted_data.SEnderUserName is null) and (source_data.SEnderUserName is null))
        ) or snapshotted_data.ReceiverUserName != source_data.ReceiverUserName
        or
        (
            ((snapshotted_data.ReceiverUserName is null) and not (source_data.ReceiverUserName is null))
            or
            ((not snapshotted_data.ReceiverUserName is null) and (source_data.ReceiverUserName is null))
        ) or snapshotted_data.Template != source_data.Template
        or
        (
            ((snapshotted_data.Template is null) and not (source_data.Template is null))
            or
            ((not snapshotted_data.Template is null) and (source_data.Template is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DetailID != source_data.DetailID
        or
        (
            ((snapshotted_data.DetailID is null) and not (source_data.DetailID is null))
            or
            ((not snapshotted_data.DetailID is null) and (source_data.DetailID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Queueddttm != source_data.Queueddttm
        or
        (
            ((snapshotted_data.Queueddttm is null) and not (source_data.Queueddttm is null))
            or
            ((not snapshotted_data.Queueddttm is null) and (source_data.Queueddttm is null))
        ) or snapshotted_data.Statusdttm != source_data.Statusdttm
        or
        (
            ((snapshotted_data.Statusdttm is null) and not (source_data.Statusdttm is null))
            or
            ((not snapshotted_data.Statusdttm is null) and (source_data.Statusdttm is null))
        ) or snapshotted_data.RecipientEmail != source_data.RecipientEmail
        or
        (
            ((snapshotted_data.RecipientEmail is null) and not (source_data.RecipientEmail is null))
            or
            ((not snapshotted_data.RecipientEmail is null) and (source_data.RecipientEmail is null))
        ) or snapshotted_data.CcEmail != source_data.CcEmail
        or
        (
            ((snapshotted_data.CcEmail is null) and not (source_data.CcEmail is null))
            or
            ((not snapshotted_data.CcEmail is null) and (source_data.CcEmail is null))
        ) or snapshotted_data.BCcEmail != source_data.BCcEmail
        or
        (
            ((snapshotted_data.BCcEmail is null) and not (source_data.BCcEmail is null))
            or
            ((not snapshotted_data.BCcEmail is null) and (source_data.BCcEmail is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.StatusMessage != source_data.StatusMessage
        or
        (
            ((snapshotted_data.StatusMessage is null) and not (source_data.StatusMessage is null))
            or
            ((not snapshotted_data.StatusMessage is null) and (source_data.StatusMessage is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.DetailType != source_data.DetailType
        or
        (
            ((snapshotted_data.DetailType is null) and not (source_data.DetailType is null))
            or
            ((not snapshotted_data.DetailType is null) and (source_data.DetailType is null))
        ) or snapshotted_data.ReplytoEmail != source_data.ReplytoEmail
        or
        (
            ((snapshotted_data.ReplytoEmail is null) and not (source_data.ReplytoEmail is null))
            or
            ((not snapshotted_data.ReplytoEmail is null) and (source_data.ReplytoEmail is null))
        ) or snapshotted_data.SEnderUserName != source_data.SEnderUserName
        or
        (
            ((snapshotted_data.SEnderUserName is null) and not (source_data.SEnderUserName is null))
            or
            ((not snapshotted_data.SEnderUserName is null) and (source_data.SEnderUserName is null))
        ) or snapshotted_data.ReceiverUserName != source_data.ReceiverUserName
        or
        (
            ((snapshotted_data.ReceiverUserName is null) and not (source_data.ReceiverUserName is null))
            or
            ((not snapshotted_data.ReceiverUserName is null) and (source_data.ReceiverUserName is null))
        ) or snapshotted_data.Template != source_data.Template
        or
        (
            ((snapshotted_data.Template is null) and not (source_data.Template is null))
            or
            ((not snapshotted_data.Template is null) and (source_data.Template is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Notifications_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Notifications_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Notifications_Incr__dbt_tmp_temp_view"
    end



    
20:25:11.067365 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
20:25:11.070257 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:25:11.070497 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr'
      and table_schema = 'stg'
  
20:25:11.178350 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:25:11.183785 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:25:11.184066 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:11.254218 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:11.255687 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:25:11.255881 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediaassets_Incr__dbt_tmp"
    
20:25:11.684849 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.65 seconds
20:25:11.686299 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:25:11.686484 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:11.796888 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:25:11.799420 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:25:11.799692 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:12.346090 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.55 seconds
20:25:12.347929 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_NewSalestoInvoice_Incr"
20:25:12.348432 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:25:12.348577 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr" (
                  "LineItemID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "LineItemID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:25:13.331145 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.08 seconds
20:25:13.332497 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:25:13.332680 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:13.412942 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:25:13.415663 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:25:13.415915 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:13.692067 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
20:25:13.694623 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:25:13.694876 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr'
      and table_schema = 'stg'
  
20:25:13.802526 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:25:13.806964 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:25:13.807247 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:13.898981 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:25:13.900688 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:25:13.900899 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediaassets_Incr__dbt_tmp"
    
20:25:14.969254 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.62 seconds
20:25:14.970755 [debug] [Thread-3  ]: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: COMMIT
20:25:14.971455 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
20:25:14.971578 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    end

20:25:15.052943 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:25:15.066063 [debug] [Thread-3  ]: finished collecting timing info
20:25:15.066395 [debug] [Thread-3  ]: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: Close
20:25:15.067162 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654bcfd0>]}
20:25:15.067628 [info ] [Thread-3  ]: 69 of 101 OK snapshotted stg.AH_NewSalestoInvoice_Incr.......................... [[32mOK[0m in 24.39s]
20:25:15.067952 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_NewSalestoInvoice_Incr
20:25:15.068111 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Offers_Incr
20:25:15.068420 [info ] [Thread-3  ]: 71 of 101 START snapshot stg.AH_Offers_Incr..................................... [RUN]
20:25:15.068801 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Offers_Incr"
20:25:15.068905 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Offers_Incr
20:25:15.068994 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Offers_Incr
20:25:15.071790 [debug] [Thread-3  ]: finished collecting timing info
20:25:15.071965 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Offers_Incr
20:25:15.075005 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:15.075206 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:25:15.075290 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:25:15.075388 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:25:15.179992 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:25:15.214626 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:25:15.238801 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:15.239087 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:25:15.270676 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:25:15.272677 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:15.273232 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Offers_InterView]
        ) as __dbt_sbq
    
20:25:15.340006 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:15.361306 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:15.361597 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Offers_Incr"
        ) as __dbt_sbq
    
20:25:15.425255 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:25:15.428910 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:15.429178 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr'
      and table_schema = 'stg'
  
20:25:15.450329 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.55 seconds
20:25:15.452636 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:25:15.452895 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:15.494250 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:15.496581 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:25:15.496819 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:15.517638 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:25:15.520909 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:15.521179 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
        
  
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Offers_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Offers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Offers_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Offers_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Offers_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Offers_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:15.245774'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:15.245774'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:25:15.245774''), CONVERT(DATETIME2, ''2022-09-26 20:25:15.245774'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:25:15.245774'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:15.245774'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:15.245774'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:25:15.245774'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.OfferMessage != source_data.OfferMessage
        or
        (
            ((snapshotted_data.OfferMessage is null) and not (source_data.OfferMessage is null))
            or
            ((not snapshotted_data.OfferMessage is null) and (source_data.OfferMessage is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.DecLineMessage != source_data.DecLineMessage
        or
        (
            ((snapshotted_data.DecLineMessage is null) and not (source_data.DecLineMessage is null))
            or
            ((not snapshotted_data.DecLineMessage is null) and (source_data.DecLineMessage is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Expirationdttm != source_data.Expirationdttm
        or
        (
            ((snapshotted_data.Expirationdttm is null) and not (source_data.Expirationdttm is null))
            or
            ((not snapshotted_data.Expirationdttm is null) and (source_data.Expirationdttm is null))
        ) or snapshotted_data.SEndingUserID != source_data.SEndingUserID
        or
        (
            ((snapshotted_data.SEndingUserID is null) and not (source_data.SEndingUserID is null))
            or
            ((not snapshotted_data.SEndingUserID is null) and (source_data.SEndingUserID is null))
        ) or snapshotted_data.ReceivINgUserID != source_data.ReceivINgUserID
        or
        (
            ((snapshotted_data.ReceivINgUserID is null) and not (source_data.ReceivINgUserID is null))
            or
            ((not snapshotted_data.ReceivINgUserID is null) and (source_data.ReceivINgUserID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.OfferMessage != source_data.OfferMessage
        or
        (
            ((snapshotted_data.OfferMessage is null) and not (source_data.OfferMessage is null))
            or
            ((not snapshotted_data.OfferMessage is null) and (source_data.OfferMessage is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.DecLineMessage != source_data.DecLineMessage
        or
        (
            ((snapshotted_data.DecLineMessage is null) and not (source_data.DecLineMessage is null))
            or
            ((not snapshotted_data.DecLineMessage is null) and (source_data.DecLineMessage is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Expirationdttm != source_data.Expirationdttm
        or
        (
            ((snapshotted_data.Expirationdttm is null) and not (source_data.Expirationdttm is null))
            or
            ((not snapshotted_data.Expirationdttm is null) and (source_data.Expirationdttm is null))
        ) or snapshotted_data.SEndingUserID != source_data.SEndingUserID
        or
        (
            ((snapshotted_data.SEndingUserID is null) and not (source_data.SEndingUserID is null))
            or
            ((not snapshotted_data.SEndingUserID is null) and (source_data.SEndingUserID is null))
        ) or snapshotted_data.ReceivINgUserID != source_data.ReceivINgUserID
        or
        (
            ((snapshotted_data.ReceivINgUserID is null) and not (source_data.ReceivINgUserID is null))
            or
            ((not snapshotted_data.ReceivINgUserID is null) and (source_data.ReceivINgUserID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Offers_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Offers_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Offers_Incr__dbt_tmp_temp_view"
    end



    
20:25:15.789750 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
20:25:15.791644 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Mediaassets_Incr"
20:25:15.792095 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:25:15.792219 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Mediaassets_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Type", "Reference", "Sha1", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Type", "Reference", "Sha1", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Mediaassets_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:25:17.943021 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.15 seconds
20:25:17.944554 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Mediaassets_Incr: COMMIT
20:25:17.945631 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
20:25:17.945784 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."#AH_Mediaassets_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Mediaassets_Incr__dbt_tmp"
    end

20:25:17.986055 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:17.998786 [debug] [Thread-4  ]: finished collecting timing info
20:25:17.999132 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Mediaassets_Incr: Close
20:25:17.999832 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01567eec40>]}
20:25:18.000305 [info ] [Thread-4  ]: 66 of 101 OK snapshotted stg.AH_Mediaassets_Incr................................ [[32mOK[0m in 47.14s]
20:25:18.000629 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Mediaassets_Incr
20:25:18.000794 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_PaymentConfigurationTable_Incr
20:25:18.001099 [info ] [Thread-4  ]: 72 of 101 START snapshot stg.AH_PaymentConfigurationTable_Incr.................. [RUN]
20:25:18.001480 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr"
20:25:18.001581 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_PaymentConfigurationTable_Incr
20:25:18.001674 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_PaymentConfigurationTable_Incr
20:25:18.004504 [debug] [Thread-4  ]: finished collecting timing info
20:25:18.004684 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_PaymentConfigurationTable_Incr
20:25:18.007757 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:18.007936 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:25:18.008020 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:25:18.008121 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:25:18.128742 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:25:18.161746 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:25:18.184357 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:18.184631 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:25:18.442970 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:25:18.444871 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:18.445362 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_PaymentConfigurationTable_InterView]
        ) as __dbt_sbq
    
20:25:18.838724 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
20:25:18.866141 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:18.866465 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr"
        ) as __dbt_sbq
    
20:25:18.878966 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 38.19 seconds
20:25:18.882311 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:25:18.882595 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:18.917369 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:25:18.920727 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:18.920965 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr'
      and table_schema = 'stg'
  
20:25:18.926612 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:18.928129 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:25:18.928302 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediavariations_Incr__dbt_tmp"
    
20:25:19.025787 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:25:19.029635 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:19.029902 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
        
  
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_PaymentConfigurationTable_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:18.417688'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:18.417688'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:25:18.417688''), CONVERT(DATETIME2, ''2022-09-26 20:25:18.417688'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:25:18.417688'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:18.417688'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:18.417688'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:25:18.417688'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Active != source_data.Active
        or
        (
            ((snapshotted_data.Active is null) and not (source_data.Active is null))
            or
            ((not snapshotted_data.Active is null) and (source_data.Active is null))
        ) or snapshotted_data.MinimumBidHold != source_data.MinimumBidHold
        or
        (
            ((snapshotted_data.MinimumBidHold is null) and not (source_data.MinimumBidHold is null))
            or
            ((not snapshotted_data.MinimumBidHold is null) and (source_data.MinimumBidHold is null))
        ) or snapshotted_data.BasicplanPrice != source_data.BasicplanPrice
        or
        (
            ((snapshotted_data.BasicplanPrice is null) and not (source_data.BasicplanPrice is null))
            or
            ((not snapshotted_data.BasicplanPrice is null) and (source_data.BasicplanPrice is null))
        ) or snapshotted_data.ProPhotographyPrice != source_data.ProPhotographyPrice
        or
        (
            ((snapshotted_data.ProPhotographyPrice is null) and not (source_data.ProPhotographyPrice is null))
            or
            ((not snapshotted_data.ProPhotographyPrice is null) and (source_data.ProPhotographyPrice is null))
        ) or snapshotted_data.ProMarketingPrice != source_data.ProMarketingPrice
        or
        (
            ((snapshotted_data.ProMarketingPrice is null) and not (source_data.ProMarketingPrice is null))
            or
            ((not snapshotted_data.ProMarketingPrice is null) and (source_data.ProMarketingPrice is null))
        ) or snapshotted_data.Minfraudscore != source_data.Minfraudscore
        or
        (
            ((snapshotted_data.Minfraudscore is null) and not (source_data.Minfraudscore is null))
            or
            ((not snapshotted_data.Minfraudscore is null) and (source_data.Minfraudscore is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.MaximumBidCharge != source_data.MaximumBidCharge
        or
        (
            ((snapshotted_data.MaximumBidCharge is null) and not (source_data.MaximumBidCharge is null))
            or
            ((not snapshotted_data.MaximumBidCharge is null) and (source_data.MaximumBidCharge is null))
        ) or snapshotted_data.BidHoldPercentage != source_data.BidHoldPercentage
        or
        (
            ((snapshotted_data.BidHoldPercentage is null) and not (source_data.BidHoldPercentage is null))
            or
            ((not snapshotted_data.BidHoldPercentage is null) and (source_data.BidHoldPercentage is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Active != source_data.Active
        or
        (
            ((snapshotted_data.Active is null) and not (source_data.Active is null))
            or
            ((not snapshotted_data.Active is null) and (source_data.Active is null))
        ) or snapshotted_data.MinimumBidHold != source_data.MinimumBidHold
        or
        (
            ((snapshotted_data.MinimumBidHold is null) and not (source_data.MinimumBidHold is null))
            or
            ((not snapshotted_data.MinimumBidHold is null) and (source_data.MinimumBidHold is null))
        ) or snapshotted_data.BasicplanPrice != source_data.BasicplanPrice
        or
        (
            ((snapshotted_data.BasicplanPrice is null) and not (source_data.BasicplanPrice is null))
            or
            ((not snapshotted_data.BasicplanPrice is null) and (source_data.BasicplanPrice is null))
        ) or snapshotted_data.ProPhotographyPrice != source_data.ProPhotographyPrice
        or
        (
            ((snapshotted_data.ProPhotographyPrice is null) and not (source_data.ProPhotographyPrice is null))
            or
            ((not snapshotted_data.ProPhotographyPrice is null) and (source_data.ProPhotographyPrice is null))
        ) or snapshotted_data.ProMarketingPrice != source_data.ProMarketingPrice
        or
        (
            ((snapshotted_data.ProMarketingPrice is null) and not (source_data.ProMarketingPrice is null))
            or
            ((not snapshotted_data.ProMarketingPrice is null) and (source_data.ProMarketingPrice is null))
        ) or snapshotted_data.Minfraudscore != source_data.Minfraudscore
        or
        (
            ((snapshotted_data.Minfraudscore is null) and not (source_data.Minfraudscore is null))
            or
            ((not snapshotted_data.Minfraudscore is null) and (source_data.Minfraudscore is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.MaximumBidCharge != source_data.MaximumBidCharge
        or
        (
            ((snapshotted_data.MaximumBidCharge is null) and not (source_data.MaximumBidCharge is null))
            or
            ((not snapshotted_data.MaximumBidCharge is null) and (source_data.MaximumBidCharge is null))
        ) or snapshotted_data.BidHoldPercentage != source_data.BidHoldPercentage
        or
        (
            ((snapshotted_data.BidHoldPercentage is null) and not (source_data.BidHoldPercentage is null))
            or
            ((not snapshotted_data.BidHoldPercentage is null) and (source_data.BidHoldPercentage is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view"
    end



    
20:25:20.174111 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.25 seconds
20:25:20.176213 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:25:20.176429 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:20.251188 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:20.253437 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:25:20.253623 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:20.518038 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:25:20.521007 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:25:20.521243 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr'
      and table_schema = 'stg'
  
20:25:20.585845 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:25:20.590588 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:25:20.590850 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:20.703496 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:25:20.704810 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:25:20.704985 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediavariations_Incr__dbt_tmp"
    
20:25:21.594054 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.89 seconds
20:25:21.595471 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:25:21.595651 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:21.638497 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:21.640817 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:25:21.641018 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:22.129584 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.49 seconds
20:25:22.132633 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:25:22.132929 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr'
      and table_schema = 'stg'
  
20:25:22.170865 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:22.175210 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:25:22.175475 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:22.214004 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:22.215518 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:25:22.215754 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediavariations_Incr__dbt_tmp"
    
20:25:23.188059 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
20:25:23.189514 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:25:23.189721 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:23.227768 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:23.230204 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:25:23.230460 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:23.884832 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.65 seconds
20:25:23.886755 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Mediavariations_Incr"
20:25:23.887188 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:25:23.887305 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Mediavariations_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaassetID", "MediaID", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaassetID", "MediaID", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Mediavariations_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:25:25.689299 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.80 seconds
20:25:25.690936 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Mediavariations_Incr: COMMIT
20:25:25.692012 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
20:25:25.692155 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."#AH_Mediavariations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Mediavariations_Incr__dbt_tmp"
    end

20:25:25.738518 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:25:25.750916 [debug] [Thread-2  ]: finished collecting timing info
20:25:25.751246 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Mediavariations_Incr: Close
20:25:25.751950 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654b3220>]}
20:25:25.752383 [info ] [Thread-2  ]: 67 of 101 OK snapshotted stg.AH_Mediavariations_Incr............................ [[32mOK[0m in 45.59s]
20:25:25.752698 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Mediavariations_Incr
20:25:25.752854 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_PaymentResponses_Incr
20:25:25.753156 [info ] [Thread-2  ]: 73 of 101 START snapshot stg.AH_PaymentResponses_Incr........................... [RUN]
20:25:25.753519 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr"
20:25:25.753618 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_PaymentResponses_Incr
20:25:25.753707 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_PaymentResponses_Incr
20:25:25.756421 [debug] [Thread-2  ]: finished collecting timing info
20:25:25.756598 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_PaymentResponses_Incr
20:25:25.759536 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:25.759700 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:25:25.759782 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:25:25.759881 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:25:25.881936 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:25:25.912321 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:25:25.934101 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:25.934402 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:25:25.961582 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:25:25.963705 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:25.964199 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_PaymentResponses_InterView]
        ) as __dbt_sbq
    
20:25:26.160975 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:25:26.182112 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:26.182394 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr"
        ) as __dbt_sbq
    
20:25:26.247799 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:26.251166 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:26.251393 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr'
      and table_schema = 'stg'
  
20:25:26.332356 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:25:26.336350 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:26.336590 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
        
  
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentResponses_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_PaymentResponses_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_PaymentResponses_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_PaymentResponses_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:25.933410'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:25.933410'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:25:25.933410''), CONVERT(DATETIME2, ''2022-09-26 20:25:25.933410'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:25:25.933410'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:25.933410'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:25.933410'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:25:25.933410'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Approved != source_data.Approved
        or
        (
            ((snapshotted_data.Approved is null) and not (source_data.Approved is null))
            or
            ((not snapshotted_data.Approved is null) and (source_data.Approved is null))
        ) or snapshotted_data.InvoiceID != source_data.InvoiceID
        or
        (
            ((snapshotted_data.InvoiceID is null) and not (source_data.InvoiceID is null))
            or
            ((not snapshotted_data.InvoiceID is null) and (source_data.InvoiceID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.AuthorizationCode != source_data.AuthorizationCode
        or
        (
            ((snapshotted_data.AuthorizationCode is null) and not (source_data.AuthorizationCode is null))
            or
            ((not snapshotted_data.AuthorizationCode is null) and (source_data.AuthorizationCode is null))
        ) or snapshotted_data.AvsResponseCode != source_data.AvsResponseCode
        or
        (
            ((snapshotted_data.AvsResponseCode is null) and not (source_data.AvsResponseCode is null))
            or
            ((not snapshotted_data.AvsResponseCode is null) and (source_data.AvsResponseCode is null))
        ) or snapshotted_data.Cvv2ResponseCode != source_data.Cvv2ResponseCode
        or
        (
            ((snapshotted_data.Cvv2ResponseCode is null) and not (source_data.Cvv2ResponseCode is null))
            or
            ((not snapshotted_data.Cvv2ResponseCode is null) and (source_data.Cvv2ResponseCode is null))
        ) or snapshotted_data.CavResponseCode != source_data.CavResponseCode
        or
        (
            ((snapshotted_data.CavResponseCode is null) and not (source_data.CavResponseCode is null))
            or
            ((not snapshotted_data.CavResponseCode is null) and (source_data.CavResponseCode is null))
        ) or snapshotted_data.BuyerStreet != source_data.BuyerStreet
        or
        (
            ((snapshotted_data.BuyerStreet is null) and not (source_data.BuyerStreet is null))
            or
            ((not snapshotted_data.BuyerStreet is null) and (source_data.BuyerStreet is null))
        ) or snapshotted_data.BuyerCity != source_data.BuyerCity
        or
        (
            ((snapshotted_data.BuyerCity is null) and not (source_data.BuyerCity is null))
            or
            ((not snapshotted_data.BuyerCity is null) and (source_data.BuyerCity is null))
        ) or snapshotted_data.ResponseStatus != source_data.ResponseStatus
        or
        (
            ((snapshotted_data.ResponseStatus is null) and not (source_data.ResponseStatus is null))
            or
            ((not snapshotted_data.ResponseStatus is null) and (source_data.ResponseStatus is null))
        ) or snapshotted_data.ProvIDEr != source_data.ProvIDEr
        or
        (
            ((snapshotted_data.ProvIDEr is null) and not (source_data.ProvIDEr is null))
            or
            ((not snapshotted_data.ProvIDEr is null) and (source_data.ProvIDEr is null))
        ) or snapshotted_data.RawResponseCode != source_data.RawResponseCode
        or
        (
            ((snapshotted_data.RawResponseCode is null) and not (source_data.RawResponseCode is null))
            or
            ((not snapshotted_data.RawResponseCode is null) and (source_data.RawResponseCode is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Method != source_data.Method
        or
        (
            ((snapshotted_data.Method is null) and not (source_data.Method is null))
            or
            ((not snapshotted_data.Method is null) and (source_data.Method is null))
        ) or snapshotted_data.BuyerStateregion != source_data.BuyerStateregion
        or
        (
            ((snapshotted_data.BuyerStateregion is null) and not (source_data.BuyerStateregion is null))
            or
            ((not snapshotted_data.BuyerStateregion is null) and (source_data.BuyerStateregion is null))
        ) or snapshotted_data.BuyerzipPostal != source_data.BuyerzipPostal
        or
        (
            ((snapshotted_data.BuyerzipPostal is null) and not (source_data.BuyerzipPostal is null))
            or
            ((not snapshotted_data.BuyerzipPostal is null) and (source_data.BuyerzipPostal is null))
        ) or snapshotted_data.BuyerEmail != source_data.BuyerEmail
        or
        (
            ((snapshotted_data.BuyerEmail is null) and not (source_data.BuyerEmail is null))
            or
            ((not snapshotted_data.BuyerEmail is null) and (source_data.BuyerEmail is null))
        ) or snapshotted_data.AllFields != source_data.AllFields
        or
        (
            ((snapshotted_data.AllFields is null) and not (source_data.AllFields is null))
            or
            ((not snapshotted_data.AllFields is null) and (source_data.AllFields is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Approved != source_data.Approved
        or
        (
            ((snapshotted_data.Approved is null) and not (source_data.Approved is null))
            or
            ((not snapshotted_data.Approved is null) and (source_data.Approved is null))
        ) or snapshotted_data.InvoiceID != source_data.InvoiceID
        or
        (
            ((snapshotted_data.InvoiceID is null) and not (source_data.InvoiceID is null))
            or
            ((not snapshotted_data.InvoiceID is null) and (source_data.InvoiceID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.AuthorizationCode != source_data.AuthorizationCode
        or
        (
            ((snapshotted_data.AuthorizationCode is null) and not (source_data.AuthorizationCode is null))
            or
            ((not snapshotted_data.AuthorizationCode is null) and (source_data.AuthorizationCode is null))
        ) or snapshotted_data.AvsResponseCode != source_data.AvsResponseCode
        or
        (
            ((snapshotted_data.AvsResponseCode is null) and not (source_data.AvsResponseCode is null))
            or
            ((not snapshotted_data.AvsResponseCode is null) and (source_data.AvsResponseCode is null))
        ) or snapshotted_data.Cvv2ResponseCode != source_data.Cvv2ResponseCode
        or
        (
            ((snapshotted_data.Cvv2ResponseCode is null) and not (source_data.Cvv2ResponseCode is null))
            or
            ((not snapshotted_data.Cvv2ResponseCode is null) and (source_data.Cvv2ResponseCode is null))
        ) or snapshotted_data.CavResponseCode != source_data.CavResponseCode
        or
        (
            ((snapshotted_data.CavResponseCode is null) and not (source_data.CavResponseCode is null))
            or
            ((not snapshotted_data.CavResponseCode is null) and (source_data.CavResponseCode is null))
        ) or snapshotted_data.BuyerStreet != source_data.BuyerStreet
        or
        (
            ((snapshotted_data.BuyerStreet is null) and not (source_data.BuyerStreet is null))
            or
            ((not snapshotted_data.BuyerStreet is null) and (source_data.BuyerStreet is null))
        ) or snapshotted_data.BuyerCity != source_data.BuyerCity
        or
        (
            ((snapshotted_data.BuyerCity is null) and not (source_data.BuyerCity is null))
            or
            ((not snapshotted_data.BuyerCity is null) and (source_data.BuyerCity is null))
        ) or snapshotted_data.ResponseStatus != source_data.ResponseStatus
        or
        (
            ((snapshotted_data.ResponseStatus is null) and not (source_data.ResponseStatus is null))
            or
            ((not snapshotted_data.ResponseStatus is null) and (source_data.ResponseStatus is null))
        ) or snapshotted_data.ProvIDEr != source_data.ProvIDEr
        or
        (
            ((snapshotted_data.ProvIDEr is null) and not (source_data.ProvIDEr is null))
            or
            ((not snapshotted_data.ProvIDEr is null) and (source_data.ProvIDEr is null))
        ) or snapshotted_data.RawResponseCode != source_data.RawResponseCode
        or
        (
            ((snapshotted_data.RawResponseCode is null) and not (source_data.RawResponseCode is null))
            or
            ((not snapshotted_data.RawResponseCode is null) and (source_data.RawResponseCode is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Method != source_data.Method
        or
        (
            ((snapshotted_data.Method is null) and not (source_data.Method is null))
            or
            ((not snapshotted_data.Method is null) and (source_data.Method is null))
        ) or snapshotted_data.BuyerStateregion != source_data.BuyerStateregion
        or
        (
            ((snapshotted_data.BuyerStateregion is null) and not (source_data.BuyerStateregion is null))
            or
            ((not snapshotted_data.BuyerStateregion is null) and (source_data.BuyerStateregion is null))
        ) or snapshotted_data.BuyerzipPostal != source_data.BuyerzipPostal
        or
        (
            ((snapshotted_data.BuyerzipPostal is null) and not (source_data.BuyerzipPostal is null))
            or
            ((not snapshotted_data.BuyerzipPostal is null) and (source_data.BuyerzipPostal is null))
        ) or snapshotted_data.BuyerEmail != source_data.BuyerEmail
        or
        (
            ((snapshotted_data.BuyerEmail is null) and not (source_data.BuyerEmail is null))
            or
            ((not snapshotted_data.BuyerEmail is null) and (source_data.BuyerEmail is null))
        ) or snapshotted_data.AllFields != source_data.AllFields
        or
        (
            ((snapshotted_data.AllFields is null) and not (source_data.AllFields is null))
            or
            ((not snapshotted_data.AllFields is null) and (source_data.AllFields is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_PaymentResponses_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentResponses_Incr__dbt_tmp_temp_view"
    end



    
20:25:27.529433 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 12.01 seconds
20:25:27.532830 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:27.533084 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:27.578769 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:25:27.580196 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:27.580394 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Offers_Incr__dbt_tmp"
    
20:25:29.167196 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.59 seconds
20:25:29.168607 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:29.168816 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:29.242474 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:29.245206 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:29.245474 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:29.503074 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:25:29.506051 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:29.506289 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr'
      and table_schema = 'stg'
  
20:25:29.596771 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:25:29.600965 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:29.601225 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:29.638649 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:29.640152 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:29.640643 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Offers_Incr__dbt_tmp"
    
20:25:29.827613 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 10.80 seconds
20:25:29.830803 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:29.831065 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:29.896235 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:29.897672 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:29.897853 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    
20:25:30.977257 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.34 seconds
20:25:30.979288 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:30.979507 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:30.981808 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.08 seconds
20:25:30.983114 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:30.983273 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:31.017912 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:31.020747 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:31.020986 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:31.050531 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:31.053160 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:31.053402 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:31.324274 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:25:31.327277 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:31.327501 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr'
      and table_schema = 'stg'
  
20:25:31.341139 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
20:25:31.343925 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:31.344186 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr'
      and table_schema = 'stg'
  
20:25:31.380827 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:25:31.386799 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:31.387069 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:31.419912 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:25:31.424255 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:31.424540 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:31.460428 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:31.462183 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:31.462419 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Offers_Incr__dbt_tmp"
    
20:25:31.462744 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:31.464412 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:31.464601 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    
20:25:32.940307 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.48 seconds
20:25:32.941841 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:32.942036 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:32.971721 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.51 seconds
20:25:32.973130 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:32.973318 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:33.025848 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:25:33.028410 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:33.028640 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:33.056812 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:25:33.059652 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:33.059939 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:33.280820 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:25:33.283125 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Offers_Incr"
20:25:33.283642 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:33.283784 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Offers_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Offers_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Offers_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Offers_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Offers_Incr" (
                  "ID", "Amount", "LastUpdatedUser", "OfferMessage", "Status", "DecLineMessage", "CreatedOn", "UpdatedOn", "DeletedOn", "Expirationdttm", "SEndingUserID", "ReceivINgUserID", "BuyerID", "Quantity", "ListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Amount", "LastUpdatedUser", "OfferMessage", "Status", "DecLineMessage", "CreatedOn", "UpdatedOn", "DeletedOn", "Expirationdttm", "SEndingUserID", "ReceivINgUserID", "BuyerID", "Quantity", "ListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Offers_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:25:33.368422 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
20:25:33.371436 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:33.371680 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr'
      and table_schema = 'stg'
  
20:25:33.405823 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:25:33.409950 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:33.410197 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:33.454788 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:33.456159 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:33.456341 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    
20:25:34.257831 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 23.48 seconds
20:25:34.260995 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:34.261256 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:34.301617 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:34.303127 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:34.303308 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Notifications_Incr__dbt_tmp"
    
20:25:34.491554 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.04 seconds
20:25:34.492999 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:34.493221 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:34.529831 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:34.532238 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:34.532471 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:34.751977 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:25:34.754032 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_PaymentConfigurationTable_Incr"
20:25:34.754496 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:34.754702 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr" (
                  "ID", "Active", "MinimumBidHold", "BasicplanPrice", "ProPhotographyPrice", "ProMarketingPrice", "Minfraudscore", "UpdatedOn", "CreatedOn", "MaximumBidCharge", "BidHoldPercentage", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Active", "MinimumBidHold", "BasicplanPrice", "ProPhotographyPrice", "ProMarketingPrice", "Minfraudscore", "UpdatedOn", "CreatedOn", "MaximumBidCharge", "BidHoldPercentage", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:25:34.840072 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.56 seconds
20:25:34.842012 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Offers_Incr: COMMIT
20:25:34.842798 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
20:25:34.842942 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."#AH_Offers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Offers_Incr__dbt_tmp"
    end

20:25:34.881007 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:34.895470 [debug] [Thread-3  ]: finished collecting timing info
20:25:34.895812 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Offers_Incr: Close
20:25:34.896549 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654b3760>]}
20:25:34.897015 [info ] [Thread-3  ]: 71 of 101 OK snapshotted stg.AH_Offers_Incr..................................... [[32mOK[0m in 19.83s]
20:25:34.897328 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Offers_Incr
20:25:34.897485 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_PaymentprovIDErs_Incr
20:25:34.897818 [info ] [Thread-3  ]: 74 of 101 START snapshot stg.AH_PaymentprovIDErs_Incr........................... [RUN]
20:25:34.898209 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr"
20:25:34.898311 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_PaymentprovIDErs_Incr
20:25:34.898407 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_PaymentprovIDErs_Incr
20:25:34.901226 [debug] [Thread-3  ]: finished collecting timing info
20:25:34.901402 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_PaymentprovIDErs_Incr
20:25:34.904661 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:34.904871 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:25:34.904956 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:25:34.905055 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:25:35.006289 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:25:35.036913 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:25:35.058700 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:35.058983 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:25:35.086794 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:25:35.088721 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:35.089258 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_PaymentprovIDErs_InterView]
        ) as __dbt_sbq
    
20:25:35.155868 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:35.177127 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:35.177428 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr"
        ) as __dbt_sbq
    
20:25:35.225017 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:25:35.228470 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:35.228733 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr'
      and table_schema = 'stg'
  
20:25:35.316778 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:25:35.320464 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:35.320673 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
        
  
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_PaymentprovIDErs_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:35.058543'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:35.058543'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:25:35.058543''), CONVERT(DATETIME2, ''2022-09-26 20:25:35.058543'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:25:35.058543'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:35.058543'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:35.058543'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:25:35.058543'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.Batchcapable != source_data.Batchcapable
        or
        (
            ((snapshotted_data.Batchcapable is null) and not (source_data.Batchcapable is null))
            or
            ((not snapshotted_data.Batchcapable is null) and (source_data.Batchcapable is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.Batchcapable != source_data.Batchcapable
        or
        (
            ((snapshotted_data.Batchcapable is null) and not (source_data.Batchcapable is null))
            or
            ((not snapshotted_data.Batchcapable is null) and (source_data.Batchcapable is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view"
    end



    
20:25:35.790231 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.49 seconds
20:25:35.791703 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:35.791910 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:35.865447 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:35.867942 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:35.868164 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:36.119352 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.36 seconds
20:25:36.121392 [debug] [Thread-4  ]: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: COMMIT
20:25:36.122737 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
20:25:36.122925 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    end

20:25:36.134138 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:25:36.137145 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:36.137435 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr'
      and table_schema = 'stg'
  
20:25:36.158522 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:36.173220 [debug] [Thread-4  ]: finished collecting timing info
20:25:36.173557 [debug] [Thread-4  ]: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: Close
20:25:36.174285 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01640aadf0>]}
20:25:36.174803 [info ] [Thread-4  ]: 72 of 101 OK snapshotted stg.AH_PaymentConfigurationTable_Incr.................. [[32mOK[0m in 18.17s]
20:25:36.175150 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_PaymentConfigurationTable_Incr
20:25:36.175300 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Properties_Incr
20:25:36.175598 [info ] [Thread-4  ]: 75 of 101 START snapshot stg.AH_Properties_Incr................................. [RUN]
20:25:36.175989 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Properties_Incr"
20:25:36.176096 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Properties_Incr
20:25:36.176191 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Properties_Incr
20:25:36.179038 [debug] [Thread-4  ]: finished collecting timing info
20:25:36.179227 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Properties_Incr
20:25:36.182686 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:36.182886 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:25:36.182973 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:25:36.183077 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:25:36.210569 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:36.217653 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:36.217949 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:36.257835 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:36.259267 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:36.259464 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Notifications_Incr__dbt_tmp"
    
20:25:36.299028 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:25:36.328058 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:25:36.349887 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:36.350188 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:25:36.378687 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:25:36.381125 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:36.381375 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Properties_InterView]
        ) as __dbt_sbq
    
20:25:36.441471 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:25:36.462849 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:36.463132 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Properties_Incr"
        ) as __dbt_sbq
    
20:25:36.515238 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:25:36.518283 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:36.518630 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr'
      and table_schema = 'stg'
  
20:25:36.606016 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:25:36.609740 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:36.609993 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
        
  
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Properties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Properties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Properties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Properties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Properties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Properties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:36.355440'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:36.355440'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:25:36.355440''), CONVERT(DATETIME2, ''2022-09-26 20:25:36.355440'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:25:36.355440'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:36.355440'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:36.355440'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:25:36.355440'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LineItemID != source_data.LineItemID
        or
        (
            ((snapshotted_data.LineItemID is null) and not (source_data.LineItemID is null))
            or
            ((not snapshotted_data.LineItemID is null) and (source_data.LineItemID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LineItemID != source_data.LineItemID
        or
        (
            ((snapshotted_data.LineItemID is null) and not (source_data.LineItemID is null))
            or
            ((not snapshotted_data.LineItemID is null) and (source_data.LineItemID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Properties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Properties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Properties_Incr__dbt_tmp_temp_view"
    end



    
20:25:37.884155 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.62 seconds
20:25:37.885667 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:37.885864 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:37.920969 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:25:37.923750 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:37.924004 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:38.181156 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:25:38.184196 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:38.184469 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr'
      and table_schema = 'stg'
  
20:25:38.220679 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:38.225214 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:38.225481 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:38.261314 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:38.262712 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:38.262882 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Notifications_Incr__dbt_tmp"
    
20:25:39.744527 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.48 seconds
20:25:39.745943 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:39.746133 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:39.780024 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:25:39.782498 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:39.782760 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:40.009536 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:25:40.012235 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Notifications_Incr"
20:25:40.012733 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:40.012880 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Notifications_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Notifications_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Notifications_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Notifications_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Notifications_Incr" (
                  "ID", "DetailID", "CreatedOn", "UpdatedOn", "DeletedOn", "Queueddttm", "Statusdttm", "RecipientEmail", "CcEmail", "BCcEmail", "LastUpdatedUser", "Status", "StatusMessage", "Message", "DetailType", "ReplytoEmail", "SEnderUserName", "ReceiverUserName", "Template", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DetailID", "CreatedOn", "UpdatedOn", "DeletedOn", "Queueddttm", "Statusdttm", "RecipientEmail", "CcEmail", "BCcEmail", "LastUpdatedUser", "Status", "StatusMessage", "Message", "DetailType", "ReplytoEmail", "SEnderUserName", "ReceiverUserName", "Template", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Notifications_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:25:41.945554 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.62 seconds
20:25:41.948897 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:41.949159 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:41.991416 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:41.992895 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:41.993087 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    
20:25:42.438705 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.43 seconds
20:25:42.440247 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Notifications_Incr: COMMIT
20:25:42.440945 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
20:25:42.441079 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."#AH_Notifications_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Notifications_Incr__dbt_tmp"
    end

20:25:42.496867 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:25:42.599892 [debug] [Thread-1  ]: finished collecting timing info
20:25:42.600217 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Notifications_Incr: Close
20:25:42.601021 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654b3610>]}
20:25:42.601506 [info ] [Thread-1  ]: 70 of 101 OK snapshotted stg.AH_Notifications_Incr.............................. [[32mOK[0m in 33.16s]
20:25:42.601835 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Notifications_Incr
20:25:42.601982 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_PropertybagItems_Incr
20:25:42.602281 [info ] [Thread-1  ]: 76 of 101 START snapshot stg.AH_PropertybagItems_Incr........................... [RUN]
20:25:42.602674 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr"
20:25:42.602787 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_PropertybagItems_Incr
20:25:42.602879 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_PropertybagItems_Incr
20:25:42.605658 [debug] [Thread-1  ]: finished collecting timing info
20:25:42.605812 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_PropertybagItems_Incr
20:25:42.608480 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:42.608623 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:25:42.608705 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:25:42.608799 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:25:42.708478 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:25:42.740197 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:25:42.762075 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:42.762360 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:25:42.791338 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:25:42.793412 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:42.793635 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_PropertybagItems_InterView]
        ) as __dbt_sbq
    
20:25:42.868561 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:42.889621 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:42.889905 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr"
        ) as __dbt_sbq
    
20:25:42.948778 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:25:42.952292 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:42.952500 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
20:25:42.953598 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:42.953726 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:42.952643 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr'
      and table_schema = 'stg'
  
20:25:43.038775 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:25:43.041251 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:43.041463 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:43.044623 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:25:43.047578 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:43.047771 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
        
  
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PropertybagItems_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_PropertybagItems_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_PropertybagItems_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_PropertybagItems_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:42.761735'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:42.761735'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:25:42.761735''), CONVERT(DATETIME2, ''2022-09-26 20:25:42.761735'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:25:42.761735'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:42.761735'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:42.761735'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:25:42.761735'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PropertybagID != source_data.PropertybagID
        or
        (
            ((snapshotted_data.PropertybagID is null) and not (source_data.PropertybagID is null))
            or
            ((not snapshotted_data.PropertybagID is null) and (source_data.PropertybagID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PropertybagID != source_data.PropertybagID
        or
        (
            ((snapshotted_data.PropertybagID is null) and not (source_data.PropertybagID is null))
            or
            ((not snapshotted_data.PropertybagID is null) and (source_data.PropertybagID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_PropertybagItems_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PropertybagItems_Incr__dbt_tmp_temp_view"
    end



    
20:25:43.294242 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:25:43.297059 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:43.297292 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr'
      and table_schema = 'stg'
  
20:25:43.332811 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:43.336888 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:43.337118 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:43.375352 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:43.376648 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:43.376838 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    
20:25:44.361615 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 7.75 seconds
20:25:44.365767 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:44.366000 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:44.409861 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
20:25:44.411284 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:44.411465 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:44.411697 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:25:44.412585 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:44.412704 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Properties_Incr__dbt_tmp"
    
20:25:44.448572 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:44.451044 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:44.451248 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:44.769440 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
20:25:44.772191 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:44.772380 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr'
      and table_schema = 'stg'
  
20:25:44.833004 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:25:44.837377 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:44.837626 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:44.892704 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:25:44.894120 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:44.894286 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    
20:25:45.330669 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.92 seconds
20:25:45.332200 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:45.332385 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:45.343030 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 19.01 seconds
20:25:45.346122 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:45.346349 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:45.386143 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:45.387595 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:45.387780 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    
20:25:45.424429 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:25:45.426971 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:45.427206 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:45.922667 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.50 seconds
20:25:45.925620 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:45.925856 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr'
      and table_schema = 'stg'
  
20:25:45.962902 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:45.967008 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:45.967252 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:45.974043 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.08 seconds
20:25:45.975405 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:45.975569 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:46.007416 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:46.008820 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:46.009012 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Properties_Incr__dbt_tmp"
    
20:25:46.017251 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:46.019972 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:46.020319 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:46.266805 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:25:46.269261 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_PaymentprovIDErs_Incr"
20:25:46.269744 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:46.269886 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr" (
                  "ID", "Name", "LastUpdatedUser", "DeletedOn", "CreatedOn", "UpdatedOn", "Batchcapable", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "LastUpdatedUser", "DeletedOn", "CreatedOn", "UpdatedOn", "Batchcapable", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:25:46.695336 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.31 seconds
20:25:46.696832 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:46.696998 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:46.780909 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:25:46.784195 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:46.784425 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:47.013961 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:25:47.017027 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:47.017279 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr'
      and table_schema = 'stg'
  
20:25:47.093892 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:25:47.098083 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:47.098330 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:47.140962 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:47.142402 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:47.142601 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    
20:25:47.408367 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.40 seconds
20:25:47.409807 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:47.409980 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:47.443597 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:25:47.445864 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:47.446099 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:47.932912 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.49 seconds
20:25:47.935984 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:47.936220 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr'
      and table_schema = 'stg'
  
20:25:47.970459 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:25:47.974704 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:47.974945 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:48.016721 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.75 seconds
20:25:48.018244 [debug] [Thread-3  ]: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: COMMIT
20:25:48.018955 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
20:25:48.019089 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    end

20:25:48.030830 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:25:48.032145 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:48.032310 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Properties_Incr__dbt_tmp"
    
20:25:48.063191 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:48.078323 [debug] [Thread-3  ]: finished collecting timing info
20:25:48.078683 [debug] [Thread-3  ]: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: Close
20:25:48.079564 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01640cf190>]}
20:25:48.080037 [info ] [Thread-3  ]: 74 of 101 OK snapshotted stg.AH_PaymentprovIDErs_Incr........................... [[32mOK[0m in 13.18s]
20:25:48.080349 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_PaymentprovIDErs_Incr
20:25:48.080502 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Propertybags_Incr
20:25:48.080794 [info ] [Thread-3  ]: 77 of 101 START snapshot stg.AH_Propertybags_Incr............................... [RUN]
20:25:48.081149 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Propertybags_Incr"
20:25:48.081247 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Propertybags_Incr
20:25:48.081337 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Propertybags_Incr
20:25:48.084102 [debug] [Thread-3  ]: finished collecting timing info
20:25:48.084261 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Propertybags_Incr
20:25:48.087045 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:48.087182 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:25:48.087262 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:25:48.087359 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:25:48.210794 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:25:48.243397 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:25:48.265293 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:48.265583 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:25:48.298679 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:25:48.300591 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:48.301400 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Propertybags_InterView]
        ) as __dbt_sbq
    
20:25:48.359172 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:25:48.381973 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:48.382252 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr"
        ) as __dbt_sbq
    
20:25:48.438103 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:25:48.441165 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:48.441391 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr'
      and table_schema = 'stg'
  
20:25:48.513265 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:48.516638 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:48.516881 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
        
  
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Propertybags_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Propertybags_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Propertybags_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Propertybags_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Propertybags_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:48.277523'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:48.277523'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:25:48.277523''), CONVERT(DATETIME2, ''2022-09-26 20:25:48.277523'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:25:48.277523'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:48.277523'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:48.277523'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:25:48.277523'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Propertybags_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Propertybags_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Propertybags_Incr__dbt_tmp_temp_view"
    end



    
20:25:48.949236 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.81 seconds
20:25:48.950754 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:48.950950 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:48.990924 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:48.993505 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:48.993733 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:49.252582 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:25:49.255477 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:49.255672 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr'
      and table_schema = 'stg'
  
20:25:49.296904 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:49.301140 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:49.301371 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:49.339014 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:49.340443 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:49.340632 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    
20:25:49.720723 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.69 seconds
20:25:49.722188 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:49.722368 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:49.758767 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:49.761182 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:49.761373 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:49.969380 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:25:49.971332 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Properties_Incr"
20:25:49.971744 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:49.971867 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Properties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Properties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Properties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Properties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Properties_Incr" (
                  "ID", "Value", "Name", "CreatedOn", "UpdatedOn", "DeletedOn", "LineItemID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Value", "Name", "CreatedOn", "UpdatedOn", "DeletedOn", "LineItemID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Properties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:25:50.571374 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.23 seconds
20:25:50.572813 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:50.572972 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:50.573191 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 7.53 seconds
20:25:50.576158 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:50.576319 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:50.615962 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:50.619023 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:50.619222 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:50.658912 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:25:50.660294 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:50.660462 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    
20:25:51.013692 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
20:25:51.015950 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_PaymentResponses_Incr"
20:25:51.016377 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:51.016495 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_PaymentResponses_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr" (
                  "ID", "Approved", "InvoiceID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Amount", "AuthorizationCode", "AvsResponseCode", "Cvv2ResponseCode", "CavResponseCode", "BuyerStreet", "BuyerCity", "ResponseStatus", "ProvIDEr", "RawResponseCode", "Description", "TransactionID", "Method", "BuyerStateregion", "BuyerzipPostal", "BuyerEmail", "AllFields", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Approved", "InvoiceID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Amount", "AuthorizationCode", "AvsResponseCode", "Cvv2ResponseCode", "CavResponseCode", "BuyerStreet", "BuyerCity", "ResponseStatus", "ProvIDEr", "RawResponseCode", "Description", "TransactionID", "Method", "BuyerStateregion", "BuyerzipPostal", "BuyerEmail", "AllFields", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_PaymentResponses_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:25:52.197611 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.54 seconds
20:25:52.199913 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:52.200085 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:52.268751 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:52.271052 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:52.271247 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:52.363322 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.39 seconds
20:25:52.364945 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Properties_Incr: COMMIT
20:25:52.365667 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
20:25:52.365803 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."#AH_Properties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Properties_Incr__dbt_tmp"
    end

20:25:52.415495 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:25:52.429494 [debug] [Thread-4  ]: finished collecting timing info
20:25:52.429825 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Properties_Incr: Close
20:25:52.430513 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01643ce160>]}
20:25:52.430989 [info ] [Thread-4  ]: 75 of 101 OK snapshotted stg.AH_Properties_Incr................................. [[32mOK[0m in 16.25s]
20:25:52.431299 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Properties_Incr
20:25:52.431441 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ReListHistory_Incr
20:25:52.431729 [info ] [Thread-4  ]: 78 of 101 START snapshot stg.AH_ReListHistory_Incr.............................. [RUN]
20:25:52.432078 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ReListHistory_Incr"
20:25:52.432179 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ReListHistory_Incr
20:25:52.432271 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ReListHistory_Incr
20:25:52.434965 [debug] [Thread-4  ]: finished collecting timing info
20:25:52.435119 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ReListHistory_Incr
20:25:52.437835 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:25:52.437974 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:25:52.438076 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:25:52.438175 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:25:52.559084 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:25:52.568860 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:25:52.571549 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:52.571725 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr'
      and table_schema = 'stg'
  
20:25:52.592818 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:25:52.614616 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:52.618269 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:52.618492 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:52.619199 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:25:52.619490 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:25:52.624297 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.61 seconds
20:25:52.625546 [debug] [Thread-2  ]: On snapshot.Shawn.AH_PaymentResponses_Incr: COMMIT
20:25:52.626174 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
20:25:52.626290 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."#AH_PaymentResponses_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    end

20:25:52.651686 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:25:52.653916 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:25:52.654106 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ReListHistory_InterView]
        ) as __dbt_sbq
    
20:25:52.660880 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:52.662063 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:52.662212 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    
20:25:52.666704 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:52.679253 [debug] [Thread-2  ]: finished collecting timing info
20:25:52.679543 [debug] [Thread-2  ]: On snapshot.Shawn.AH_PaymentResponses_Incr: Close
20:25:52.680187 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654b34c0>]}
20:25:52.680628 [info ] [Thread-2  ]: 73 of 101 OK snapshotted stg.AH_PaymentResponses_Incr........................... [[32mOK[0m in 26.93s]
20:25:52.680929 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_PaymentResponses_Incr
20:25:52.681077 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Reports_Incr
20:25:52.681357 [info ] [Thread-2  ]: 79 of 101 START snapshot stg.AH_Reports_Incr.................................... [RUN]
20:25:52.681712 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Reports_Incr"
20:25:52.681811 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Reports_Incr
20:25:52.681900 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Reports_Incr
20:25:52.684522 [debug] [Thread-2  ]: finished collecting timing info
20:25:52.684670 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Reports_Incr
20:25:52.687421 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:25:52.687558 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:25:52.687639 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:25:52.687735 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:25:52.714525 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:25:52.737006 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:25:52.737278 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr"
        ) as __dbt_sbq
    
20:25:52.802038 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:25:52.805730 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:25:52.805927 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr'
      and table_schema = 'stg'
  
20:25:52.806211 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:25:52.835562 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:25:52.857032 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:25:52.857314 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:25:52.882665 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:25:52.886223 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:25:52.886652 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
        
  
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ReListHistory_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ReListHistory_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ReListHistory_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ReListHistory_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ReListHistory_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:52.636938'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:52.636938'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:25:52.636938''), CONVERT(DATETIME2, ''2022-09-26 20:25:52.636938'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:25:52.636938'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:52.636938'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:52.636938'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:25:52.636938'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CurrentPrice_Old != source_data.CurrentPrice_Old
        or
        (
            ((snapshotted_data.CurrentPrice_Old is null) and not (source_data.CurrentPrice_Old is null))
            or
            ((not snapshotted_data.CurrentPrice_Old is null) and (source_data.CurrentPrice_Old is null))
        ) or snapshotted_data.CurrentPrice_New != source_data.CurrentPrice_New
        or
        (
            ((snapshotted_data.CurrentPrice_New is null) and not (source_data.CurrentPrice_New is null))
            or
            ((not snapshotted_data.CurrentPrice_New is null) and (source_data.CurrentPrice_New is null))
        ) or snapshotted_data.ReservePrice != source_data.ReservePrice
        or
        (
            ((snapshotted_data.ReservePrice is null) and not (source_data.ReservePrice is null))
            or
            ((not snapshotted_data.ReservePrice is null) and (source_data.ReservePrice is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.NewreListiteration != source_data.NewreListiteration
        or
        (
            ((snapshotted_data.NewreListiteration is null) and not (source_data.NewreListiteration is null))
            or
            ((not snapshotted_data.NewreListiteration is null) and (source_data.NewreListiteration is null))
        ) or snapshotted_data.Duration_Old != source_data.Duration_Old
        or
        (
            ((snapshotted_data.Duration_Old is null) and not (source_data.Duration_Old is null))
            or
            ((not snapshotted_data.Duration_Old is null) and (source_data.Duration_Old is null))
        ) or snapshotted_data.Duration_New != source_data.Duration_New
        or
        (
            ((snapshotted_data.Duration_New is null) and not (source_data.Duration_New is null))
            or
            ((not snapshotted_data.Duration_New is null) and (source_data.Duration_New is null))
        ) or snapshotted_data.HighBidderID != source_data.HighBidderID
        or
        (
            ((snapshotted_data.HighBidderID is null) and not (source_data.HighBidderID is null))
            or
            ((not snapshotted_data.HighBidderID is null) and (source_data.HighBidderID is null))
        ) or snapshotted_data.BidCount != source_data.BidCount
        or
        (
            ((snapshotted_data.BidCount is null) and not (source_data.BidCount is null))
            or
            ((not snapshotted_data.BidCount is null) and (source_data.BidCount is null))
        ) or snapshotted_data.Startdttm_New != source_data.Startdttm_New
        or
        (
            ((snapshotted_data.Startdttm_New is null) and not (source_data.Startdttm_New is null))
            or
            ((not snapshotted_data.Startdttm_New is null) and (source_data.Startdttm_New is null))
        ) or snapshotted_data.Enddttm_Old != source_data.Enddttm_Old
        or
        (
            ((snapshotted_data.Enddttm_Old is null) and not (source_data.Enddttm_Old is null))
            or
            ((not snapshotted_data.Enddttm_Old is null) and (source_data.Enddttm_Old is null))
        ) or snapshotted_data.Enddttm_New != source_data.Enddttm_New
        or
        (
            ((snapshotted_data.Enddttm_New is null) and not (source_data.Enddttm_New is null))
            or
            ((not snapshotted_data.Enddttm_New is null) and (source_data.Enddttm_New is null))
        ) or snapshotted_data.ReListdttm != source_data.ReListdttm
        or
        (
            ((snapshotted_data.ReListdttm is null) and not (source_data.ReListdttm is null))
            or
            ((not snapshotted_data.ReListdttm is null) and (source_data.ReListdttm is null))
        ) or snapshotted_data.Startdttm_Old != source_data.Startdttm_Old
        or
        (
            ((snapshotted_data.Startdttm_Old is null) and not (source_data.Startdttm_Old is null))
            or
            ((not snapshotted_data.Startdttm_Old is null) and (source_data.Startdttm_Old is null))
        ) or snapshotted_data.MaxBidAmount != source_data.MaxBidAmount
        or
        (
            ((snapshotted_data.MaxBidAmount is null) and not (source_data.MaxBidAmount is null))
            or
            ((not snapshotted_data.MaxBidAmount is null) and (source_data.MaxBidAmount is null))
        ) or snapshotted_data.ProxyBidAmount != source_data.ProxyBidAmount
        or
        (
            ((snapshotted_data.ProxyBidAmount is null) and not (source_data.ProxyBidAmount is null))
            or
            ((not snapshotted_data.ProxyBidAmount is null) and (source_data.ProxyBidAmount is null))
        ) or snapshotted_data.BidIncrement != source_data.BidIncrement
        or
        (
            ((snapshotted_data.BidIncrement is null) and not (source_data.BidIncrement is null))
            or
            ((not snapshotted_data.BidIncrement is null) and (source_data.BidIncrement is null))
        ) or snapshotted_data.ListingTitle != source_data.ListingTitle
        or
        (
            ((snapshotted_data.ListingTitle is null) and not (source_data.ListingTitle is null))
            or
            ((not snapshotted_data.ListingTitle is null) and (source_data.ListingTitle is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CurrentPrice_Old != source_data.CurrentPrice_Old
        or
        (
            ((snapshotted_data.CurrentPrice_Old is null) and not (source_data.CurrentPrice_Old is null))
            or
            ((not snapshotted_data.CurrentPrice_Old is null) and (source_data.CurrentPrice_Old is null))
        ) or snapshotted_data.CurrentPrice_New != source_data.CurrentPrice_New
        or
        (
            ((snapshotted_data.CurrentPrice_New is null) and not (source_data.CurrentPrice_New is null))
            or
            ((not snapshotted_data.CurrentPrice_New is null) and (source_data.CurrentPrice_New is null))
        ) or snapshotted_data.ReservePrice != source_data.ReservePrice
        or
        (
            ((snapshotted_data.ReservePrice is null) and not (source_data.ReservePrice is null))
            or
            ((not snapshotted_data.ReservePrice is null) and (source_data.ReservePrice is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.NewreListiteration != source_data.NewreListiteration
        or
        (
            ((snapshotted_data.NewreListiteration is null) and not (source_data.NewreListiteration is null))
            or
            ((not snapshotted_data.NewreListiteration is null) and (source_data.NewreListiteration is null))
        ) or snapshotted_data.Duration_Old != source_data.Duration_Old
        or
        (
            ((snapshotted_data.Duration_Old is null) and not (source_data.Duration_Old is null))
            or
            ((not snapshotted_data.Duration_Old is null) and (source_data.Duration_Old is null))
        ) or snapshotted_data.Duration_New != source_data.Duration_New
        or
        (
            ((snapshotted_data.Duration_New is null) and not (source_data.Duration_New is null))
            or
            ((not snapshotted_data.Duration_New is null) and (source_data.Duration_New is null))
        ) or snapshotted_data.HighBidderID != source_data.HighBidderID
        or
        (
            ((snapshotted_data.HighBidderID is null) and not (source_data.HighBidderID is null))
            or
            ((not snapshotted_data.HighBidderID is null) and (source_data.HighBidderID is null))
        ) or snapshotted_data.BidCount != source_data.BidCount
        or
        (
            ((snapshotted_data.BidCount is null) and not (source_data.BidCount is null))
            or
            ((not snapshotted_data.BidCount is null) and (source_data.BidCount is null))
        ) or snapshotted_data.Startdttm_New != source_data.Startdttm_New
        or
        (
            ((snapshotted_data.Startdttm_New is null) and not (source_data.Startdttm_New is null))
            or
            ((not snapshotted_data.Startdttm_New is null) and (source_data.Startdttm_New is null))
        ) or snapshotted_data.Enddttm_Old != source_data.Enddttm_Old
        or
        (
            ((snapshotted_data.Enddttm_Old is null) and not (source_data.Enddttm_Old is null))
            or
            ((not snapshotted_data.Enddttm_Old is null) and (source_data.Enddttm_Old is null))
        ) or snapshotted_data.Enddttm_New != source_data.Enddttm_New
        or
        (
            ((snapshotted_data.Enddttm_New is null) and not (source_data.Enddttm_New is null))
            or
            ((not snapshotted_data.Enddttm_New is null) and (source_data.Enddttm_New is null))
        ) or snapshotted_data.ReListdttm != source_data.ReListdttm
        or
        (
            ((snapshotted_data.ReListdttm is null) and not (source_data.ReListdttm is null))
            or
            ((not snapshotted_data.ReListdttm is null) and (source_data.ReListdttm is null))
        ) or snapshotted_data.Startdttm_Old != source_data.Startdttm_Old
        or
        (
            ((snapshotted_data.Startdttm_Old is null) and not (source_data.Startdttm_Old is null))
            or
            ((not snapshotted_data.Startdttm_Old is null) and (source_data.Startdttm_Old is null))
        ) or snapshotted_data.MaxBidAmount != source_data.MaxBidAmount
        or
        (
            ((snapshotted_data.MaxBidAmount is null) and not (source_data.MaxBidAmount is null))
            or
            ((not snapshotted_data.MaxBidAmount is null) and (source_data.MaxBidAmount is null))
        ) or snapshotted_data.ProxyBidAmount != source_data.ProxyBidAmount
        or
        (
            ((snapshotted_data.ProxyBidAmount is null) and not (source_data.ProxyBidAmount is null))
            or
            ((not snapshotted_data.ProxyBidAmount is null) and (source_data.ProxyBidAmount is null))
        ) or snapshotted_data.BidIncrement != source_data.BidIncrement
        or
        (
            ((snapshotted_data.BidIncrement is null) and not (source_data.BidIncrement is null))
            or
            ((not snapshotted_data.BidIncrement is null) and (source_data.BidIncrement is null))
        ) or snapshotted_data.ListingTitle != source_data.ListingTitle
        or
        (
            ((snapshotted_data.ListingTitle is null) and not (source_data.ListingTitle is null))
            or
            ((not snapshotted_data.ListingTitle is null) and (source_data.ListingTitle is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ReListHistory_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ReListHistory_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ReListHistory_Incr__dbt_tmp_temp_view"
    end



    
20:25:52.889369 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:25:52.890955 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:25:52.891094 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Reports_InterView]
        ) as __dbt_sbq
    
20:25:52.953368 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:25:52.974819 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:25:52.975093 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Reports_Incr"
        ) as __dbt_sbq
    
20:25:53.085931 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:25:53.089801 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:25:53.090019 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr'
      and table_schema = 'stg'
  
20:25:53.164935 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:53.168352 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:25:53.168593 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
        
  
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Reports_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Reports_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Reports_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Reports_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Reports_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Reports_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:52.871318'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:52.871318'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:25:52.871318''), CONVERT(DATETIME2, ''2022-09-26 20:25:52.871318'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:25:52.871318'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:52.871318'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:52.871318'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:25:52.871318'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SecondstogeneRate != source_data.SecondstogeneRate
        or
        (
            ((snapshotted_data.SecondstogeneRate is null) and not (source_data.SecondstogeneRate is null))
            or
            ((not snapshotted_data.SecondstogeneRate is null) and (source_data.SecondstogeneRate is null))
        ) or snapshotted_data.ReportName != source_data.ReportName
        or
        (
            ((snapshotted_data.ReportName is null) and not (source_data.ReportName is null))
            or
            ((not snapshotted_data.ReportName is null) and (source_data.ReportName is null))
        ) or snapshotted_data.Data != source_data.Data
        or
        (
            ((snapshotted_data.Data is null) and not (source_data.Data is null))
            or
            ((not snapshotted_data.Data is null) and (source_data.Data is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SecondstogeneRate != source_data.SecondstogeneRate
        or
        (
            ((snapshotted_data.SecondstogeneRate is null) and not (source_data.SecondstogeneRate is null))
            or
            ((not snapshotted_data.SecondstogeneRate is null) and (source_data.SecondstogeneRate is null))
        ) or snapshotted_data.ReportName != source_data.ReportName
        or
        (
            ((snapshotted_data.ReportName is null) and not (source_data.ReportName is null))
            or
            ((not snapshotted_data.ReportName is null) and (source_data.ReportName is null))
        ) or snapshotted_data.Data != source_data.Data
        or
        (
            ((snapshotted_data.Data is null) and not (source_data.Data is null))
            or
            ((not snapshotted_data.Data is null) and (source_data.Data is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Reports_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Reports_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Reports_Incr__dbt_tmp_temp_view"
    end



    
20:25:53.895902 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.23 seconds
20:25:53.897475 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:53.897655 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:53.934533 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:53.937353 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:53.937549 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:54.249522 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
20:25:54.252295 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:54.252525 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr'
      and table_schema = 'stg'
  
20:25:54.293710 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:54.298120 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:54.298357 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:54.338049 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:54.339417 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:54.339574 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    
20:25:54.574235 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.06 seconds
20:25:54.577600 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:54.577795 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:54.637164 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:25:54.638657 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:54.638832 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Propertybags_Incr__dbt_tmp"
    
20:25:55.233277 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.89 seconds
20:25:55.234936 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:55.235123 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:55.268458 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:25:55.271051 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:55.271230 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:55.489970 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:25:55.492039 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_PropertybagItems_Incr"
20:25:55.492484 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:55.492617 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_PropertybagItems_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr" (
                  "ID", "PropertybagID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "Value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "PropertybagID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "Value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_PropertybagItems_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:25:55.612978 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
20:25:55.614614 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:55.614823 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:55.683147 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:55.685539 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:55.685731 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:55.903055 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:25:55.906018 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:55.906248 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr'
      and table_schema = 'stg'
  
20:25:55.939090 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:25:55.943105 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:55.943326 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:55.983958 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:55.985377 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:55.985552 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Propertybags_Incr__dbt_tmp"
    
20:25:56.788888 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.30 seconds
20:25:56.790432 [debug] [Thread-1  ]: On snapshot.Shawn.AH_PropertybagItems_Incr: COMMIT
20:25:56.791198 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
20:25:56.791340 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."#AH_PropertybagItems_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    end

20:25:56.858460 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:56.872313 [debug] [Thread-1  ]: finished collecting timing info
20:25:56.872629 [debug] [Thread-1  ]: On snapshot.Shawn.AH_PropertybagItems_Incr: Close
20:25:56.873314 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654b38b0>]}
20:25:56.873775 [info ] [Thread-1  ]: 76 of 101 OK snapshotted stg.AH_PropertybagItems_Incr........................... [[32mOK[0m in 14.27s]
20:25:56.874099 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_PropertybagItems_Incr
20:25:56.874253 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Roles_Incr
20:25:56.874569 [info ] [Thread-1  ]: 80 of 101 START snapshot stg.AH_Roles_Incr...................................... [RUN]
20:25:56.874947 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Roles_Incr"
20:25:56.875047 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Roles_Incr
20:25:56.875136 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Roles_Incr
20:25:56.877814 [debug] [Thread-1  ]: finished collecting timing info
20:25:56.877973 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Roles_Incr
20:25:56.880755 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:25:56.880902 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:25:56.880985 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:25:56.881083 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:25:56.920938 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
20:25:56.922592 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:56.922786 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:56.957982 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:25:56.960144 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:56.960321 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:56.983978 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:25:57.010645 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:25:57.033400 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:25:57.033682 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:25:57.085727 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:25:57.087805 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:25:57.087995 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Roles_InterView]
        ) as __dbt_sbq
    
20:25:57.160456 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:57.181214 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:25:57.181487 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Roles_Incr"
        ) as __dbt_sbq
    
20:25:57.213989 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:25:57.217706 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:57.218003 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr'
      and table_schema = 'stg'
  
20:25:57.249574 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:57.253014 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:25:57.253482 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr'
      and table_schema = 'stg'
  
20:25:57.319879 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:25:57.323864 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:57.324107 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:57.326511 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:25:57.329335 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:25:57.329497 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
        
  
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Roles_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Roles_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Roles_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Roles_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Roles_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Roles_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:57.058877'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:57.058877'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:25:57.058877''), CONVERT(DATETIME2, ''2022-09-26 20:25:57.058877'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:25:57.058877'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:25:57.058877'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:25:57.058877'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:25:57.058877'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Roles_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Roles_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Roles_Incr__dbt_tmp_temp_view"
    end



    
20:25:57.375129 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:25:57.376540 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:57.376711 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Propertybags_Incr__dbt_tmp"
    
20:25:58.245468 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.87 seconds
20:25:58.246914 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:58.247081 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:25:58.281700 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:25:58.283924 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:58.284126 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:25:58.540080 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:25:58.542075 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Propertybags_Incr"
20:25:58.542594 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:25:58.542755 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Propertybags_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Propertybags_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:26:00.060017 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.52 seconds
20:26:00.063059 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Propertybags_Incr: COMMIT
20:26:00.063827 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
20:26:00.063965 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."#AH_Propertybags_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Propertybags_Incr__dbt_tmp"
    end

20:26:00.104741 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:00.117166 [debug] [Thread-3  ]: finished collecting timing info
20:26:00.117494 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Propertybags_Incr: Close
20:26:00.118212 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0164176a30>]}
20:26:00.118731 [info ] [Thread-3  ]: 77 of 101 OK snapshotted stg.AH_Propertybags_Incr............................... [[32mOK[0m in 12.04s]
20:26:00.119079 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Propertybags_Incr
20:26:00.119225 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_SMStemplatecontents_Incr
20:26:00.119536 [info ] [Thread-3  ]: 81 of 101 START snapshot stg.AH_SMStemplatecontents_Incr........................ [RUN]
20:26:00.119912 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr"
20:26:00.120013 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_SMStemplatecontents_Incr
20:26:00.120103 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_SMStemplatecontents_Incr
20:26:00.122836 [debug] [Thread-3  ]: finished collecting timing info
20:26:00.122991 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_SMStemplatecontents_Incr
20:26:00.125685 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:00.125826 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:26:00.125905 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:26:00.126002 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:26:00.242902 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:26:00.259369 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.09 seconds
20:26:00.262628 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:26:00.262870 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:00.275606 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:26:00.297094 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:00.297372 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:26:00.314579 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:00.315876 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:26:00.316058 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Reports_Incr__dbt_tmp"
    
20:26:00.338838 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:00.341098 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:00.341300 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_SMStemplatecontents_InterView]
        ) as __dbt_sbq
    
20:26:00.410570 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:00.438034 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:00.438329 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr"
        ) as __dbt_sbq
    
20:26:00.537517 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:26:00.541025 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:00.541287 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr'
      and table_schema = 'stg'
  
20:26:00.630010 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:26:00.633394 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:00.633641 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
        
  
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_SMStemplatecontents_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_SMStemplatecontents_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:00.308915'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:00.308915'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:26:00.308915''), CONVERT(DATETIME2, ''2022-09-26 20:26:00.308915'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:26:00.308915'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:00.308915'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:00.308915'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:26:00.308915'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SMStemplatecontents_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_temp_view"
    end



    
20:26:01.255834 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
20:26:01.257225 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:26:01.257398 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:01.330224 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:01.334929 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:26:01.335205 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:01.576229 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:26:01.579350 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:26:01.579606 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr'
      and table_schema = 'stg'
  
20:26:01.631542 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:01.635384 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:26:01.635639 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:01.698062 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:01.699547 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:26:01.699730 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Reports_Incr__dbt_tmp"
    
20:26:02.478205 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.15 seconds
20:26:02.481627 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:26:02.481881 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:02.528865 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:02.530258 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:26:02.530443 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Roles_Incr__dbt_tmp"
    
20:26:02.649391 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
20:26:02.650862 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:26:02.651052 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:02.685769 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:26:02.688311 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:26:02.688526 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:02.969671 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
20:26:02.972435 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:26:02.972651 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr'
      and table_schema = 'stg'
  
20:26:03.013673 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:03.017981 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:26:03.018234 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:03.054894 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:03.056360 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:26:03.056533 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Reports_Incr__dbt_tmp"
    
20:26:03.426086 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.90 seconds
20:26:03.427575 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:26:03.427766 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:03.540518 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:26:03.542981 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:26:03.543194 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:03.793905 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:26:03.796720 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:26:03.796931 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr'
      and table_schema = 'stg'
  
20:26:03.832629 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:03.836701 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:26:03.836950 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:03.904559 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:03.906027 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:26:03.906204 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Roles_Incr__dbt_tmp"
    
20:26:03.920462 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.86 seconds
20:26:03.921889 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:26:03.922064 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:03.957987 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:03.962680 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:26:03.962927 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:04.510877 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.55 seconds
20:26:04.512787 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Reports_Incr"
20:26:04.513233 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:26:04.513364 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Reports_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Reports_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Reports_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Reports_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Reports_Incr" (
                  "ID", "SecondstogeneRate", "ReportName", "Data", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SecondstogeneRate", "ReportName", "Data", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Reports_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:26:04.819587 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.91 seconds
20:26:04.821151 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:26:04.821345 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:04.875504 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:04.877763 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:26:04.877985 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:04.881496 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 11.99 seconds
20:26:04.884606 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:26:04.884811 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:04.928162 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:04.929538 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:26:04.929717 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ReListHistory_Incr__dbt_tmp"
    
20:26:05.099667 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:26:05.102668 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:26:05.102902 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr'
      and table_schema = 'stg'
  
20:26:05.144834 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:05.148990 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:26:05.149209 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:05.192307 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:05.193622 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:26:05.193798 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Roles_Incr__dbt_tmp"
    
20:26:06.016306 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.50 seconds
20:26:06.017944 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Reports_Incr: COMMIT
20:26:06.018701 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
20:26:06.018845 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."#AH_Reports_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Reports_Incr__dbt_tmp"
    end

20:26:06.057384 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:06.072018 [debug] [Thread-2  ]: finished collecting timing info
20:26:06.072342 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Reports_Incr: Close
20:26:06.073033 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0156727f70>]}
20:26:06.073476 [info ] [Thread-2  ]: 79 of 101 OK snapshotted stg.AH_Reports_Incr.................................... [[32mOK[0m in 13.39s]
20:26:06.073786 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Reports_Incr
20:26:06.073934 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_SMStemplates_Incr
20:26:06.074213 [info ] [Thread-2  ]: 82 of 101 START snapshot stg.AH_SMStemplates_Incr............................... [RUN]
20:26:06.074608 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_SMStemplates_Incr"
20:26:06.074727 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_SMStemplates_Incr
20:26:06.074820 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_SMStemplates_Incr
20:26:06.077454 [debug] [Thread-2  ]: finished collecting timing info
20:26:06.077611 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_SMStemplates_Incr
20:26:06.080451 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:06.080599 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:26:06.080680 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:26:06.080774 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:26:06.196372 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:26:06.226336 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:26:06.250182 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:06.250451 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:26:06.283695 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:26:06.285725 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:06.286220 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_SMStemplates_InterView]
        ) as __dbt_sbq
    
20:26:06.343720 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:06.365579 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:06.365856 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr"
        ) as __dbt_sbq
    
20:26:06.415090 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.22 seconds
20:26:06.416641 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:26:06.416829 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:06.417658 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.49 seconds
20:26:06.418715 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:26:06.418847 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:06.442098 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:26:06.445729 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:06.445970 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr'
      and table_schema = 'stg'
  
20:26:06.452601 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:06.454817 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:26:06.455009 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:06.508344 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:26:06.511075 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:26:06.511282 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:06.537501 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:26:06.541082 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:06.541303 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
        
  
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SMStemplates_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_SMStemplates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SMStemplates_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_SMStemplates_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_SMStemplates_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:06.262123'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:06.262123'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:26:06.262123''), CONVERT(DATETIME2, ''2022-09-26 20:26:06.262123'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:26:06.262123'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:06.262123'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:06.262123'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:26:06.262123'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_SMStemplates_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SMStemplates_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SMStemplates_Incr__dbt_tmp_temp_view"
    end



    
20:26:06.777369 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:26:06.780158 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:26:06.780369 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr'
      and table_schema = 'stg'
  
20:26:06.788906 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
20:26:06.790753 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Roles_Incr"
20:26:06.791151 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:26:06.791264 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Roles_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Roles_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Roles_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Roles_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Roles_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "LastUpdatedUser", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "LastUpdatedUser", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Roles_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:26:06.825755 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:06.829887 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:26:06.830110 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:06.877382 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:06.879161 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:26:06.879346 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ReListHistory_Incr__dbt_tmp"
    
20:26:07.117845 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.48 seconds
20:26:07.121201 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:07.121405 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:07.169536 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:07.170886 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:07.171075 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    
20:26:08.297913 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.51 seconds
20:26:08.299921 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Roles_Incr: COMMIT
20:26:08.300743 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
20:26:08.300887 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."#AH_Roles_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Roles_Incr__dbt_tmp"
    end

20:26:08.345987 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:08.360152 [debug] [Thread-1  ]: finished collecting timing info
20:26:08.360476 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Roles_Incr: Close
20:26:08.361182 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654bd0d0>]}
20:26:08.361624 [info ] [Thread-1  ]: 80 of 101 OK snapshotted stg.AH_Roles_Incr...................................... [[32mOK[0m in 11.49s]
20:26:08.361937 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Roles_Incr
20:26:08.362088 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_SalesTaxRates_Incr
20:26:08.362375 [info ] [Thread-1  ]: 83 of 101 START snapshot stg.AH_SalesTaxRates_Incr.............................. [RUN]
20:26:08.362771 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr"
20:26:08.362882 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_SalesTaxRates_Incr
20:26:08.362973 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_SalesTaxRates_Incr
20:26:08.365657 [debug] [Thread-1  ]: finished collecting timing info
20:26:08.365810 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_SalesTaxRates_Incr
20:26:08.368670 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:08.368814 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:26:08.368895 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:26:08.368990 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:26:08.369496 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.20 seconds
20:26:08.370535 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:08.370702 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:08.373784 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.49 seconds
20:26:08.375009 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:26:08.375136 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:08.408211 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:26:08.411301 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:26:08.411537 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:08.438758 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:08.440970 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:08.441175 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:08.472469 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:26:08.519469 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:26:08.541005 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:08.541288 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:26:08.584591 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:08.586699 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:08.586887 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_SalesTaxRates_InterView]
        ) as __dbt_sbq
    
20:26:08.645697 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:08.663540 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:26:08.666471 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:26:08.666733 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr'
      and table_schema = 'stg'
  
20:26:08.671055 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:08.671229 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr"
        ) as __dbt_sbq
    
20:26:08.719623 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:08.724351 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:26:08.724620 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:08.737719 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:08.741264 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:08.741496 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr'
      and table_schema = 'stg'
  
20:26:08.761808 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:08.763299 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:26:08.763472 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ReListHistory_Incr__dbt_tmp"
    
20:26:08.810292 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:08.813919 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:08.814145 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
        
  
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SalesTaxRates_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_SalesTaxRates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_SalesTaxRates_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_SalesTaxRates_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:08.558974'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:08.558974'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:26:08.558974''), CONVERT(DATETIME2, ''2022-09-26 20:26:08.558974'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:26:08.558974'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:08.558974'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:08.558974'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:26:08.558974'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Shipping != source_data.Shipping
        or
        (
            ((snapshotted_data.Shipping is null) and not (source_data.Shipping is null))
            or
            ((not snapshotted_data.Shipping is null) and (source_data.Shipping is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.StateID != source_data.StateID
        or
        (
            ((snapshotted_data.StateID is null) and not (source_data.StateID is null))
            or
            ((not snapshotted_data.StateID is null) and (source_data.StateID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.TaxRate != source_data.TaxRate
        or
        (
            ((snapshotted_data.TaxRate is null) and not (source_data.TaxRate is null))
            or
            ((not snapshotted_data.TaxRate is null) and (source_data.TaxRate is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Shipping != source_data.Shipping
        or
        (
            ((snapshotted_data.Shipping is null) and not (source_data.Shipping is null))
            or
            ((not snapshotted_data.Shipping is null) and (source_data.Shipping is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.StateID != source_data.StateID
        or
        (
            ((snapshotted_data.StateID is null) and not (source_data.StateID is null))
            or
            ((not snapshotted_data.StateID is null) and (source_data.StateID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.TaxRate != source_data.TaxRate
        or
        (
            ((snapshotted_data.TaxRate is null) and not (source_data.TaxRate is null))
            or
            ((not snapshotted_data.TaxRate is null) and (source_data.TaxRate is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SalesTaxRates_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SalesTaxRates_Incr__dbt_tmp_temp_view"
    end



    
20:26:08.824706 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.38 seconds
20:26:08.827176 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:08.827353 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr'
      and table_schema = 'stg'
  
20:26:08.865596 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:08.869709 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:08.869945 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:08.916807 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:08.918221 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:08.918392 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    
20:26:09.600617 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.84 seconds
20:26:09.602168 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:26:09.602362 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:09.637809 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:09.640859 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:26:09.641102 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:09.816022 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.90 seconds
20:26:09.817515 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:09.817697 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:09.851634 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:26:09.853883 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:09.854098 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:09.866834 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:26:09.868862 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ReListHistory_Incr"
20:26:09.869295 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:26:09.869424 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ReListHistory_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr" (
                  "ID", "CurrentPrice_Old", "CurrentPrice_New", "ReservePrice", "ListingID", "NewreListiteration", "Duration_Old", "Duration_New", "HighBidderID", "BidCount", "Startdttm_New", "Enddttm_Old", "Enddttm_New", "ReListdttm", "Startdttm_Old", "MaxBidAmount", "ProxyBidAmount", "BidIncrement", "ListingTitle", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CurrentPrice_Old", "CurrentPrice_New", "ReservePrice", "ListingID", "NewreListiteration", "Duration_Old", "Duration_New", "HighBidderID", "BidCount", "Startdttm_New", "Enddttm_Old", "Enddttm_New", "ReListdttm", "Startdttm_Old", "MaxBidAmount", "ProxyBidAmount", "BidIncrement", "ListingTitle", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ReListHistory_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:26:10.056789 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:26:10.059590 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:10.059809 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr'
      and table_schema = 'stg'
  
20:26:10.109822 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:10.113681 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:10.113905 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:10.165866 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:10.167220 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:10.167412 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    
20:26:11.726864 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.56 seconds
20:26:11.728362 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:11.728538 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:11.775270 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:11.777715 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:11.777915 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:11.821459 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.95 seconds
20:26:11.823043 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ReListHistory_Incr: COMMIT
20:26:11.823959 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
20:26:11.824096 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."#AH_ReListHistory_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ReListHistory_Incr__dbt_tmp"
    end

20:26:11.887313 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:11.900595 [debug] [Thread-4  ]: finished collecting timing info
20:26:11.900899 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ReListHistory_Incr: Close
20:26:11.901543 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0164372610>]}
20:26:11.901956 [info ] [Thread-4  ]: 78 of 101 OK snapshotted stg.AH_ReListHistory_Incr.............................. [[32mOK[0m in 19.47s]
20:26:11.902253 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ReListHistory_Incr
20:26:11.902399 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ShippingMethods_Incr
20:26:11.902720 [info ] [Thread-4  ]: 84 of 101 START snapshot stg.AH_ShippingMethods_Incr............................ [RUN]
20:26:11.903061 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr"
20:26:11.903161 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ShippingMethods_Incr
20:26:11.903249 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ShippingMethods_Incr
20:26:11.905774 [debug] [Thread-4  ]: finished collecting timing info
20:26:11.905915 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ShippingMethods_Incr
20:26:11.908526 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:11.908663 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:26:11.908752 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:26:11.908848 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:26:12.022774 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:26:12.050976 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:26:12.052811 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_SMStemplatecontents_Incr"
20:26:12.053201 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:12.053321 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_SMStemplatecontents_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr" (
                  "ID", "Name", "Body", "UpdatedOn", "DeletedOn", "CreatedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Body", "UpdatedOn", "DeletedOn", "CreatedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:26:12.057856 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:26:12.078830 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:12.079086 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:26:12.107815 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:26:12.109656 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:12.109826 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ShippingMethods_InterView]
        ) as __dbt_sbq
    
20:26:12.181896 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:12.202858 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:12.203135 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr"
        ) as __dbt_sbq
    
20:26:12.255240 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:12.258509 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:12.258729 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr'
      and table_schema = 'stg'
  
20:26:12.267496 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 5.73 seconds
20:26:12.270337 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:12.270505 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:12.330594 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:12.334564 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:12.334811 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
        
  
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ShippingMethods_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ShippingMethods_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ShippingMethods_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ShippingMethods_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:12.090391'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:12.090391'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:26:12.090391''), CONVERT(DATETIME2, ''2022-09-26 20:26:12.090391'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:26:12.090391'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:12.090391'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:12.090391'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:26:12.090391'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ShippingMethods_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ShippingMethods_Incr__dbt_tmp_temp_view"
    end



    
20:26:12.338731 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:12.339822 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:12.339964 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplates_Incr__dbt_tmp"
    
20:26:13.379685 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.04 seconds
20:26:13.381397 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:13.381558 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:13.420833 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.37 seconds
20:26:13.422398 [debug] [Thread-3  ]: On snapshot.Shawn.AH_SMStemplatecontents_Incr: COMMIT
20:26:13.423171 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
20:26:13.423306 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    end

20:26:13.452423 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:13.454845 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:13.455039 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:13.458928 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:13.471354 [debug] [Thread-3  ]: finished collecting timing info
20:26:13.471658 [debug] [Thread-3  ]: On snapshot.Shawn.AH_SMStemplatecontents_Incr: Close
20:26:13.472351 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654bd220>]}
20:26:13.472780 [info ] [Thread-3  ]: 81 of 101 OK snapshotted stg.AH_SMStemplatecontents_Incr........................ [[32mOK[0m in 13.35s]
20:26:13.473097 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_SMStemplatecontents_Incr
20:26:13.473248 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ShippingOptions_Incr
20:26:13.473540 [info ] [Thread-3  ]: 85 of 101 START snapshot stg.AH_ShippingOptions_Incr............................ [RUN]
20:26:13.473893 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr"
20:26:13.473994 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ShippingOptions_Incr
20:26:13.474083 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ShippingOptions_Incr
20:26:13.476721 [debug] [Thread-3  ]: finished collecting timing info
20:26:13.476879 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ShippingOptions_Incr
20:26:13.480023 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:13.480182 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:26:13.480263 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:26:13.480362 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:26:13.585021 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:26:13.617273 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:26:13.639783 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:13.640061 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:26:13.669494 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:26:13.671843 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:13.672050 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ShippingOptions_InterView]
        ) as __dbt_sbq
    
20:26:13.724736 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:13.725083 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:26:13.727637 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:13.727827 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr'
      and table_schema = 'stg'
  
20:26:13.748363 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:13.748633 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr"
        ) as __dbt_sbq
    
20:26:13.764078 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:13.767904 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:13.768122 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:13.802760 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:13.806397 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:13.806646 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr'
      and table_schema = 'stg'
  
20:26:13.817839 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:13.819324 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:13.819512 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplates_Incr__dbt_tmp"
    
20:26:13.880400 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:13.883816 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:13.884008 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
        
  
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ShippingOptions_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ShippingOptions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ShippingOptions_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ShippingOptions_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:13.652850'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:13.652850'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:26:13.652850''), CONVERT(DATETIME2, ''2022-09-26 20:26:13.652850'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:26:13.652850'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:13.652850'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:13.652850'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:26:13.652850'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ShippingMethodID != source_data.ShippingMethodID
        or
        (
            ((snapshotted_data.ShippingMethodID is null) and not (source_data.ShippingMethodID is null))
            or
            ((not snapshotted_data.ShippingMethodID is null) and (source_data.ShippingMethodID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.FirstItEMAmount != source_data.FirstItEMAmount
        or
        (
            ((snapshotted_data.FirstItEMAmount is null) and not (source_data.FirstItEMAmount is null))
            or
            ((not snapshotted_data.FirstItEMAmount is null) and (source_data.FirstItEMAmount is null))
        ) or snapshotted_data.AdditionalItEMAmount != source_data.AdditionalItEMAmount
        or
        (
            ((snapshotted_data.AdditionalItEMAmount is null) and not (source_data.AdditionalItEMAmount is null))
            or
            ((not snapshotted_data.AdditionalItEMAmount is null) and (source_data.AdditionalItEMAmount is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ShippingMethodID != source_data.ShippingMethodID
        or
        (
            ((snapshotted_data.ShippingMethodID is null) and not (source_data.ShippingMethodID is null))
            or
            ((not snapshotted_data.ShippingMethodID is null) and (source_data.ShippingMethodID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.FirstItEMAmount != source_data.FirstItEMAmount
        or
        (
            ((snapshotted_data.FirstItEMAmount is null) and not (source_data.FirstItEMAmount is null))
            or
            ((not snapshotted_data.FirstItEMAmount is null) and (source_data.FirstItEMAmount is null))
        ) or snapshotted_data.AdditionalItEMAmount != source_data.AdditionalItEMAmount
        or
        (
            ((snapshotted_data.AdditionalItEMAmount is null) and not (source_data.AdditionalItEMAmount is null))
            or
            ((not snapshotted_data.AdditionalItEMAmount is null) and (source_data.AdditionalItEMAmount is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ShippingOptions_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ShippingOptions_Incr__dbt_tmp_temp_view"
    end



    
20:26:14.906832 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.09 seconds
20:26:14.908285 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:14.908465 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:14.947355 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:14.950013 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:14.950251 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:15.201276 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:26:15.204312 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:15.204555 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr'
      and table_schema = 'stg'
  
20:26:15.238825 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:26:15.242838 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:15.243080 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:15.277686 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:26:15.279180 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:15.279360 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplates_Incr__dbt_tmp"
    
20:26:15.668414 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.85 seconds
20:26:15.671750 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:15.671937 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:15.709335 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:15.710743 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:15.710910 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    
20:26:17.327489 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.05 seconds
20:26:17.328877 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:17.329061 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:17.367937 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:17.370172 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:17.370348 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:17.389116 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.68 seconds
20:26:17.390665 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:17.390854 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:17.460871 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:17.463433 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:17.463624 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:17.594107 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:26:17.596016 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_SMStemplates_Incr"
20:26:17.596407 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:17.596523 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_SMStemplates_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr" (
                  "ID", "Enabled", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Enabled", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_SMStemplates_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:26:17.728899 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:26:17.731772 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:17.732002 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr'
      and table_schema = 'stg'
  
20:26:17.770039 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:17.774242 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:17.774489 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:17.833485 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:17.835238 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:17.835445 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    
20:26:18.040486 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 5.71 seconds
20:26:18.045551 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:18.045765 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:18.092938 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:18.094253 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:18.094440 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    
20:26:19.010377 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.41 seconds
20:26:19.012339 [debug] [Thread-2  ]: On snapshot.Shawn.AH_SMStemplates_Incr: COMMIT
20:26:19.013060 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
20:26:19.013203 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."#AH_SMStemplates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SMStemplates_Incr__dbt_tmp"
    end

20:26:19.050979 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:19.148158 [debug] [Thread-2  ]: finished collecting timing info
20:26:19.148478 [debug] [Thread-2  ]: On snapshot.Shawn.AH_SMStemplates_Incr: Close
20:26:19.149148 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654bd4c0>]}
20:26:19.149608 [info ] [Thread-2  ]: 82 of 101 OK snapshotted stg.AH_SMStemplates_Incr............................... [[32mOK[0m in 13.07s]
20:26:19.149930 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_SMStemplates_Incr
20:26:19.150080 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Siteproperties_Incr
20:26:19.150362 [info ] [Thread-2  ]: 86 of 101 START snapshot stg.AH_Siteproperties_Incr............................. [RUN]
20:26:19.150752 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Siteproperties_Incr"
20:26:19.150863 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Siteproperties_Incr
20:26:19.150953 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Siteproperties_Incr
20:26:19.153614 [debug] [Thread-2  ]: finished collecting timing info
20:26:19.153756 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Siteproperties_Incr
20:26:19.156398 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:19.156536 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:26:19.156615 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:26:19.156717 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:26:19.209100 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.11 seconds
20:26:19.210952 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:19.211201 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:19.233523 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.40 seconds
20:26:19.235009 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:19.235190 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:19.279675 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:19.281964 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:19.282162 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:19.303030 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:26:19.305566 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:19.305786 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:19.306132 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:26:19.339652 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:26:19.361576 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:19.361850 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:26:19.411486 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:19.413382 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:19.413554 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Siteproperties_InterView]
        ) as __dbt_sbq
    
20:26:19.470970 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:19.491962 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:19.492224 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr"
        ) as __dbt_sbq
    
20:26:19.536965 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:26:19.540054 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:19.540272 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr'
      and table_schema = 'stg'
  
20:26:19.549949 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:19.553216 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:19.553402 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr'
      and table_schema = 'stg'
  
20:26:19.568681 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:26:19.571233 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:19.571409 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr'
      and table_schema = 'stg'
  
20:26:19.582376 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:19.586111 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:19.586291 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:19.607186 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:19.611119 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:19.611323 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:19.652348 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:26:19.655813 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:19.656007 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
        
  
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Siteproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Siteproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Siteproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Siteproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Siteproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:19.387309'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:19.387309'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:26:19.387309''), CONVERT(DATETIME2, ''2022-09-26 20:26:19.387309'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:26:19.387309'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:19.387309'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:19.387309'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:26:19.387309'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Siteproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Siteproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Siteproperties_Incr__dbt_tmp_temp_view"
    end



    
20:26:19.656973 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:19.658015 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:19.658136 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    
20:26:19.674609 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:19.675816 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:19.675966 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    
20:26:20.570831 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.69 seconds
20:26:20.574117 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:20.574308 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:20.611317 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:20.612430 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
20:26:20.613463 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:20.613594 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:20.614089 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:20.614206 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    
20:26:20.652439 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:20.655129 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:20.655327 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:20.895574 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:26:20.898273 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:20.898443 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr'
      and table_schema = 'stg'
  
20:26:20.941426 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:20.945657 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:20.945913 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:20.985514 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:20.987235 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:20.987419 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    
20:26:20.987851 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.33 seconds
20:26:20.988931 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:20.989068 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:21.035594 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:21.038080 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:21.038275 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:21.294930 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:26:21.297006 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_SalesTaxRates_Incr"
20:26:21.297450 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:21.297570 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_SalesTaxRates_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr" (
                  "ID", "LastUpdatedUser", "Shipping", "DeletedOn", "CreatedOn", "UpdatedOn", "StateID", "UserID", "TaxRate", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "LastUpdatedUser", "Shipping", "DeletedOn", "CreatedOn", "UpdatedOn", "StateID", "UserID", "TaxRate", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:26:21.543805 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.93 seconds
20:26:21.545373 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:21.545576 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:21.618066 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:21.620598 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:21.620817 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:21.852239 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.86 seconds
20:26:21.853778 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:21.853958 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:21.876377 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:26:21.881166 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:21.881363 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr'
      and table_schema = 'stg'
  
20:26:21.917922 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:21.920617 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:21.920814 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:21.936605 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:21.940213 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:21.940388 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:21.997050 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:21.998502 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:21.998709 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    
20:26:22.182363 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:26:22.184248 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ShippingMethods_Incr"
20:26:22.184637 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:22.184754 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ShippingMethods_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr" (
                  "ID", "DisplayOrder", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DisplayOrder", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ShippingMethods_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:26:22.627297 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.33 seconds
20:26:22.628797 [debug] [Thread-1  ]: On snapshot.Shawn.AH_SalesTaxRates_Incr: COMMIT
20:26:22.629517 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
20:26:22.629649 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."#AH_SalesTaxRates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    end

20:26:22.683004 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:22.696538 [debug] [Thread-1  ]: finished collecting timing info
20:26:22.696876 [debug] [Thread-1  ]: On snapshot.Shawn.AH_SalesTaxRates_Incr: Close
20:26:22.697620 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654bd610>]}
20:26:22.698127 [info ] [Thread-1  ]: 83 of 101 OK snapshotted stg.AH_SalesTaxRates_Incr.............................. [[32mOK[0m in 14.33s]
20:26:22.698461 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_SalesTaxRates_Incr
20:26:22.698652 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_States_Incr
20:26:22.698970 [info ] [Thread-1  ]: 87 of 101 START snapshot stg.AH_States_Incr..................................... [RUN]
20:26:22.699338 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_States_Incr"
20:26:22.699449 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_States_Incr
20:26:22.699540 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_States_Incr
20:26:22.702274 [debug] [Thread-1  ]: finished collecting timing info
20:26:22.702443 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_States_Incr
20:26:22.705303 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:22.705454 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:26:22.705537 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:26:22.705632 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:26:22.826629 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:26:22.853526 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.85 seconds
20:26:22.855101 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:22.855295 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:22.880115 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:26:22.895665 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:22.897833 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:22.898021 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:22.904896 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:22.905064 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:26:22.932435 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:26:22.934448 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:22.934659 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_States_InterView]
        ) as __dbt_sbq
    
20:26:22.999321 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:23.021096 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:23.021372 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_States_Incr"
        ) as __dbt_sbq
    
20:26:23.084518 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:23.088146 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:23.088363 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr'
      and table_schema = 'stg'
  
20:26:23.141092 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:26:23.143935 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:23.144143 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr'
      and table_schema = 'stg'
  
20:26:23.175714 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:26:23.179391 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:23.179613 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
        
  
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_States_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_States_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_States_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_States_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_States_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_States_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:22.918603'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:22.918603'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:26:22.918603''), CONVERT(DATETIME2, ''2022-09-26 20:26:22.918603'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:26:22.918603'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:22.918603'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:22.918603'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:26:22.918603'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CountryID != source_data.CountryID
        or
        (
            ((snapshotted_data.CountryID is null) and not (source_data.CountryID is null))
            or
            ((not snapshotted_data.CountryID is null) and (source_data.CountryID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CountryID != source_data.CountryID
        or
        (
            ((snapshotted_data.CountryID is null) and not (source_data.CountryID is null))
            or
            ((not snapshotted_data.CountryID is null) and (source_data.CountryID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_States_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_States_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_States_Incr__dbt_tmp_temp_view"
    end



    
20:26:23.181643 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:23.185090 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:23.185231 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:23.220984 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:23.222422 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:23.222621 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    
20:26:23.528218 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.34 seconds
20:26:23.529816 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ShippingMethods_Incr: COMMIT
20:26:23.530485 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
20:26:23.530631 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."#AH_ShippingMethods_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    end

20:26:23.568920 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:23.583027 [debug] [Thread-4  ]: finished collecting timing info
20:26:23.583375 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ShippingMethods_Incr: Close
20:26:23.584119 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01642b7400>]}
20:26:23.584607 [info ] [Thread-4  ]: 84 of 101 OK snapshotted stg.AH_ShippingMethods_Incr............................ [[32mOK[0m in 11.68s]
20:26:23.584938 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ShippingMethods_Incr
20:26:23.585094 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_StripeCustomers_Incr
20:26:23.585392 [info ] [Thread-4  ]: 88 of 101 START snapshot stg.AH_StripeCustomers_Incr............................ [RUN]
20:26:23.585781 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr"
20:26:23.585888 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_StripeCustomers_Incr
20:26:23.585988 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_StripeCustomers_Incr
20:26:23.588742 [debug] [Thread-4  ]: finished collecting timing info
20:26:23.588900 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_StripeCustomers_Incr
20:26:23.591684 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:23.591820 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:26:23.591900 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:26:23.591996 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:26:23.705587 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:26:23.735100 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:26:23.757323 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:23.757598 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:26:23.787188 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:26:23.789221 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:23.789710 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_StripeCustomers_InterView]
        ) as __dbt_sbq
    
20:26:23.843519 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:23.864531 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:23.864819 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr"
        ) as __dbt_sbq
    
20:26:23.917388 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:23.920862 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:23.921101 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr'
      and table_schema = 'stg'
  
20:26:23.988398 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:23.992092 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:23.992321 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
        
  
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_StripeCustomers_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_StripeCustomers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_StripeCustomers_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_StripeCustomers_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:23.762368'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:23.762368'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:26:23.762368''), CONVERT(DATETIME2, ''2022-09-26 20:26:23.762368'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:26:23.762368'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:23.762368'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:23.762368'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:26:23.762368'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SellerID != source_data.SellerID
        or
        (
            ((snapshotted_data.SellerID is null) and not (source_data.SellerID is null))
            or
            ((not snapshotted_data.SellerID is null) and (source_data.SellerID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CustomerID != source_data.CustomerID
        or
        (
            ((snapshotted_data.CustomerID is null) and not (source_data.CustomerID is null))
            or
            ((not snapshotted_data.CustomerID is null) and (source_data.CustomerID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SellerID != source_data.SellerID
        or
        (
            ((snapshotted_data.SellerID is null) and not (source_data.SellerID is null))
            or
            ((not snapshotted_data.SellerID is null) and (source_data.SellerID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CustomerID != source_data.CustomerID
        or
        (
            ((snapshotted_data.CustomerID is null) and not (source_data.CustomerID is null))
            or
            ((not snapshotted_data.CustomerID is null) and (source_data.CustomerID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_StripeCustomers_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_StripeCustomers_Incr__dbt_tmp_temp_view"
    end



    
20:26:24.090656 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.87 seconds
20:26:24.092460 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:24.092643 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:24.125631 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:26:24.128132 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:24.128328 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:24.460760 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
20:26:24.462884 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ShippingOptions_Incr"
20:26:24.463315 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:24.463454 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ShippingOptions_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "ShippingMethodID", "ListingID", "FirstItEMAmount", "AdditionalItEMAmount", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "ShippingMethodID", "ListingID", "FirstItEMAmount", "AdditionalItEMAmount", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ShippingOptions_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:26:25.766129 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.30 seconds
20:26:25.767621 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ShippingOptions_Incr: COMMIT
20:26:25.768324 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
20:26:25.768549 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."#AH_ShippingOptions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    end

20:26:25.822301 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:25.835210 [debug] [Thread-3  ]: finished collecting timing info
20:26:25.835512 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ShippingOptions_Incr: Close
20:26:25.836232 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654bd760>]}
20:26:25.836667 [info ] [Thread-3  ]: 85 of 101 OK snapshotted stg.AH_ShippingOptions_Incr............................ [[32mOK[0m in 12.36s]
20:26:25.836974 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ShippingOptions_Incr
20:26:25.837116 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_SubmittedListingPayment_Incr
20:26:25.837399 [info ] [Thread-3  ]: 89 of 101 START snapshot stg.AH_SubmittedListingPayment_Incr.................... [RUN]
20:26:25.837749 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr"
20:26:25.837848 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_SubmittedListingPayment_Incr
20:26:25.837937 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_SubmittedListingPayment_Incr
20:26:25.840626 [debug] [Thread-3  ]: finished collecting timing info
20:26:25.840778 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_SubmittedListingPayment_Incr
20:26:25.843519 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:25.843658 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:26:25.843738 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:26:25.843834 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:26:25.943617 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:26:25.972913 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:26:25.995379 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:25.995655 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:26:26.029949 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:26:26.032081 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:26.033040 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_SubmittedListingPayment_InterView]
        ) as __dbt_sbq
    
20:26:26.135005 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:26:26.156079 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:26.156354 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr"
        ) as __dbt_sbq
    
20:26:26.238530 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:26:26.242096 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:26.242344 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr'
      and table_schema = 'stg'
  
20:26:26.328625 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:26:26.332071 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:26.332311 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
        
  
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_SubmittedListingPayment_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:25.996804'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:25.996804'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:26:25.996804''), CONVERT(DATETIME2, ''2022-09-26 20:26:25.996804'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:26:25.996804'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:25.996804'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:25.996804'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:26:25.996804'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.ConsignorID != source_data.ConsignorID
        or
        (
            ((snapshotted_data.ConsignorID is null) and not (source_data.ConsignorID is null))
            or
            ((not snapshotted_data.ConsignorID is null) and (source_data.ConsignorID is null))
        ) or snapshotted_data.HasproMarketing != source_data.HasproMarketing
        or
        (
            ((snapshotted_data.HasproMarketing is null) and not (source_data.HasproMarketing is null))
            or
            ((not snapshotted_data.HasproMarketing is null) and (source_data.HasproMarketing is null))
        ) or snapshotted_data.HasproPhotography != source_data.HasproPhotography
        or
        (
            ((snapshotted_data.HasproPhotography is null) and not (source_data.HasproPhotography is null))
            or
            ((not snapshotted_data.HasproPhotography is null) and (source_data.HasproPhotography is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.ConsignorID != source_data.ConsignorID
        or
        (
            ((snapshotted_data.ConsignorID is null) and not (source_data.ConsignorID is null))
            or
            ((not snapshotted_data.ConsignorID is null) and (source_data.ConsignorID is null))
        ) or snapshotted_data.HasproMarketing != source_data.HasproMarketing
        or
        (
            ((snapshotted_data.HasproMarketing is null) and not (source_data.HasproMarketing is null))
            or
            ((not snapshotted_data.HasproMarketing is null) and (source_data.HasproMarketing is null))
        ) or snapshotted_data.HasproPhotography != source_data.HasproPhotography
        or
        (
            ((snapshotted_data.HasproPhotography is null) and not (source_data.HasproPhotography is null))
            or
            ((not snapshotted_data.HasproPhotography is null) and (source_data.HasproPhotography is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view"
    end



    
20:26:28.157415 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 8.50 seconds
20:26:28.160653 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:28.160872 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:28.200601 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:28.202030 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:28.202208 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Siteproperties_Incr__dbt_tmp"
    
20:26:29.614757 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.41 seconds
20:26:29.616294 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:29.616464 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:29.683646 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:29.686156 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:29.686353 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:29.934912 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.76 seconds
20:26:29.938019 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:29.938239 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:29.964899 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
20:26:29.967894 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:29.968125 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr'
      and table_schema = 'stg'
  
20:26:29.977045 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:29.978405 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:29.978595 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_States_Incr__dbt_tmp"
    
20:26:30.018424 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:30.022510 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:30.022819 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:30.065387 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:30.066889 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:30.067083 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Siteproperties_Incr__dbt_tmp"
    
20:26:30.096639 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 6.10 seconds
20:26:30.099998 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:30.100246 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:30.137989 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:30.139500 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:30.139684 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    
20:26:31.036590 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
20:26:31.038121 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:31.038307 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:31.122133 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:26:31.124643 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:31.124849 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:31.166609 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
20:26:31.168099 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:31.168595 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:31.169308 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
20:26:31.170407 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:31.170565 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:31.207935 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:31.210456 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:31.210707 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:31.234763 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:31.237278 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:31.237544 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:31.353836 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:26:31.356882 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:31.357155 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr'
      and table_schema = 'stg'
  
20:26:31.396449 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:31.400555 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:31.400803 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:31.449446 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:31.450952 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:31.451135 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_States_Incr__dbt_tmp"
    
20:26:31.467080 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:26:31.469854 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:31.470072 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr'
      and table_schema = 'stg'
  
20:26:31.504334 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:26:31.507270 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:31.507506 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr'
      and table_schema = 'stg'
  
20:26:31.507791 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:31.513997 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:31.514216 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:31.548821 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:31.553074 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:31.553344 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:31.553614 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:31.554682 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:31.554825 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Siteproperties_Incr__dbt_tmp"
    
20:26:31.608892 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:31.610388 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:31.610640 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    
20:26:32.775737 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.22 seconds
20:26:32.777273 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:32.777457 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:32.794953 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.34 seconds
20:26:32.796500 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:32.796691 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:32.838706 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:32.841191 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:32.841417 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:32.880633 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:26:32.883213 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:32.883451 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:32.942236 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.33 seconds
20:26:32.943750 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:32.943929 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:32.977787 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:26:32.980763 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:32.980989 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:33.143897 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:26:33.146098 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Siteproperties_Incr"
20:26:33.146515 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:33.146703 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Siteproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr" (
                  "ID", "DecimalnativeValue", "BoolnativeValue", "IntnativeValue", "CustomFieldID", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DecimalnativeValue", "BoolnativeValue", "IntnativeValue", "CustomFieldID", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Siteproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:26:33.181098 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:26:33.183926 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:33.184153 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr'
      and table_schema = 'stg'
  
20:26:33.219543 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:33.224126 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:33.224379 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:33.262887 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:33.264747 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:33.264933 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_States_Incr__dbt_tmp"
    
20:26:33.280404 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:26:33.283159 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:33.283368 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr'
      and table_schema = 'stg'
  
20:26:33.316834 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:26:33.321060 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:33.321309 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:33.383967 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:33.385420 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:33.385597 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    
20:26:33.496374 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 7.16 seconds
20:26:33.499803 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:33.500040 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:33.553351 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:33.554853 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:33.555041 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    
20:26:34.400386 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.14 seconds
20:26:34.401847 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:34.402119 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:34.439110 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:34.441694 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:34.441913 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:34.639004 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:26:34.641325 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_States_Incr"
20:26:34.641914 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:34.642067 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_States_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_States_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_States_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_States_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_States_Incr" (
                  "ID", "Name", "Code", "CreatedOn", "UpdatedOn", "DeletedOn", "Enabled", "CountryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Code", "CreatedOn", "UpdatedOn", "DeletedOn", "Enabled", "CountryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_States_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:26:34.755146 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.37 seconds
20:26:34.756881 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:34.757325 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:34.757960 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.20 seconds
20:26:34.759094 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:34.759237 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:34.793901 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:34.796510 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:34.796752 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:34.812824 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.67 seconds
20:26:34.814264 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Siteproperties_Incr: COMMIT
20:26:34.815411 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
20:26:34.815563 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."#AH_Siteproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Siteproperties_Incr__dbt_tmp"
    end

20:26:34.835868 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:26:34.838208 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:34.838437 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:34.855816 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:34.870324 [debug] [Thread-2  ]: finished collecting timing info
20:26:34.870691 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Siteproperties_Incr: Close
20:26:34.871409 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654bd8b0>]}
20:26:34.871885 [info ] [Thread-2  ]: 86 of 101 OK snapshotted stg.AH_Siteproperties_Incr............................. [[32mOK[0m in 15.72s]
20:26:34.872212 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Siteproperties_Incr
20:26:34.872373 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_SysDiagrams_Incr
20:26:34.872671 [info ] [Thread-2  ]: 90 of 101 START snapshot stg.AH_SysDiagrams_Incr................................ [RUN]
20:26:34.873048 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr"
20:26:34.873147 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_SysDiagrams_Incr
20:26:34.873242 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_SysDiagrams_Incr
20:26:34.876192 [debug] [Thread-2  ]: finished collecting timing info
20:26:34.876359 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_SysDiagrams_Incr
20:26:34.879177 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:34.879329 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:26:34.879411 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:26:34.879508 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:26:34.983459 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:26:35.012048 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:26:35.035199 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:35.035491 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:26:35.036929 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:26:35.038871 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_StripeCustomers_Incr"
20:26:35.039580 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:35.039718 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_StripeCustomers_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr" (
                  "ID", "SellerID", "BuyerID", "CreatedOn", "UpdatedOn", "DeletedOn", "CustomerID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SellerID", "BuyerID", "CreatedOn", "UpdatedOn", "DeletedOn", "CustomerID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_StripeCustomers_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:26:35.068625 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:26:35.070931 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:35.071182 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_SysDiagrams_InterView]
        ) as __dbt_sbq
    
20:26:35.105491 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:26:35.108118 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:35.108322 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr'
      and table_schema = 'stg'
  
20:26:35.140735 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:35.162597 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:35.162901 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:35.163052 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr"
        ) as __dbt_sbq
    
20:26:35.166981 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:35.167447 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:35.205142 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:35.208127 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:35.208369 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    
20:26:35.246227 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:26:35.249534 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:35.249757 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr'
      and table_schema = 'stg'
  
20:26:35.336552 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:26:35.339930 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:35.340175 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
        
  
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SysDiagrams_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_SysDiagrams_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_SysDiagrams_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_SysDiagrams_InterView]

    ),

    snapshotted_data as (

        select *,
            Diagram_ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            Diagram_ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:35.043744'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:35.043744'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:26:35.043744''), CONVERT(DATETIME2, ''2022-09-26 20:26:35.043744'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(Diagram_ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:26:35.043744'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            Diagram_ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:35.043744'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:35.043744'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:26:35.043744'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.Diagram_ID != source_data.Diagram_ID
        or
        (
            ((snapshotted_data.Diagram_ID is null) and not (source_data.Diagram_ID is null))
            or
            ((not snapshotted_data.Diagram_ID is null) and (source_data.Diagram_ID is null))
        ) or snapshotted_data.Version != source_data.Version
        or
        (
            ((snapshotted_data.Version is null) and not (source_data.Version is null))
            or
            ((not snapshotted_data.Version is null) and (source_data.Version is null))
        ) or snapshotted_data.Principal_ID != source_data.Principal_ID
        or
        (
            ((snapshotted_data.Principal_ID is null) and not (source_data.Principal_ID is null))
            or
            ((not snapshotted_data.Principal_ID is null) and (source_data.Principal_ID is null))
        ) or snapshotted_data.Definition != source_data.Definition
        or
        (
            ((snapshotted_data.Definition is null) and not (source_data.Definition is null))
            or
            ((not snapshotted_data.Definition is null) and (source_data.Definition is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.Diagram_ID != source_data.Diagram_ID
        or
        (
            ((snapshotted_data.Diagram_ID is null) and not (source_data.Diagram_ID is null))
            or
            ((not snapshotted_data.Diagram_ID is null) and (source_data.Diagram_ID is null))
        ) or snapshotted_data.Version != source_data.Version
        or
        (
            ((snapshotted_data.Version is null) and not (source_data.Version is null))
            or
            ((not snapshotted_data.Version is null) and (source_data.Version is null))
        ) or snapshotted_data.Principal_ID != source_data.Principal_ID
        or
        (
            ((snapshotted_data.Principal_ID is null) and not (source_data.Principal_ID is null))
            or
            ((not snapshotted_data.Principal_ID is null) and (source_data.Principal_ID is null))
        ) or snapshotted_data.Definition != source_data.Definition
        or
        (
            ((snapshotted_data.Definition is null) and not (source_data.Definition is null))
            or
            ((not snapshotted_data.Definition is null) and (source_data.Definition is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SysDiagrams_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SysDiagrams_Incr__dbt_tmp_temp_view"
    end



    
20:26:36.269975 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.63 seconds
20:26:36.271545 [debug] [Thread-1  ]: On snapshot.Shawn.AH_States_Incr: COMMIT
20:26:36.272238 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
20:26:36.272365 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."#AH_States_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_States_Incr__dbt_tmp"
    end

20:26:36.313044 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:36.325978 [debug] [Thread-1  ]: finished collecting timing info
20:26:36.326309 [debug] [Thread-1  ]: On snapshot.Shawn.AH_States_Incr: Close
20:26:36.327086 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654bda00>]}
20:26:36.336606 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.13 seconds
20:26:36.338043 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:36.338200 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:36.382933 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:36.385737 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:36.385986 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:36.509630 [info ] [Thread-1  ]: 87 of 101 OK snapshotted stg.AH_States_Incr..................................... [[32mOK[0m in 13.63s]
20:26:36.510466 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_States_Incr
20:26:36.510690 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ThReadTracking_Incr
20:26:36.511007 [info ] [Thread-1  ]: 91 of 101 START snapshot stg.AH_ThReadTracking_Incr............................. [RUN]
20:26:36.511461 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr"
20:26:36.511590 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ThReadTracking_Incr
20:26:36.511703 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ThReadTracking_Incr
20:26:36.514780 [debug] [Thread-1  ]: finished collecting timing info
20:26:36.514967 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ThReadTracking_Incr
20:26:36.517601 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:36.517759 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:26:36.517841 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:26:36.517961 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:26:36.518369 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.48 seconds
20:26:36.519524 [debug] [Thread-4  ]: On snapshot.Shawn.AH_StripeCustomers_Incr: COMMIT
20:26:36.520310 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
20:26:36.520435 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."#AH_StripeCustomers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    end

20:26:36.573671 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:36.588575 [debug] [Thread-4  ]: finished collecting timing info
20:26:36.588956 [debug] [Thread-4  ]: On snapshot.Shawn.AH_StripeCustomers_Incr: Close
20:26:36.589814 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0164118b20>]}
20:26:36.590333 [info ] [Thread-4  ]: 88 of 101 OK snapshotted stg.AH_StripeCustomers_Incr............................ [[32mOK[0m in 13.00s]
20:26:36.590712 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_StripeCustomers_Incr
20:26:36.590932 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Tiers_Incr
20:26:36.591223 [info ] [Thread-4  ]: 92 of 101 START snapshot stg.AH_Tiers_Incr...................................... [RUN]
20:26:36.591592 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Tiers_Incr"
20:26:36.591690 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Tiers_Incr
20:26:36.591827 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Tiers_Incr
20:26:36.595191 [debug] [Thread-4  ]: finished collecting timing info
20:26:36.595348 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Tiers_Incr
20:26:36.598306 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:36.598453 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:26:36.598534 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:26:36.598678 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:26:36.613638 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:26:36.616308 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:36.616513 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr'
      and table_schema = 'stg'
  
20:26:36.640839 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:26:36.658071 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:36.662396 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:36.662712 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:36.675770 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:26:36.701020 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:36.701305 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:26:36.706646 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:36.707924 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:36.708065 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    
20:26:36.726831 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:26:36.739238 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:36.741167 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:36.741368 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ThReadTracking_InterView]
        ) as __dbt_sbq
    
20:26:36.763400 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:26:36.785477 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:36.785795 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:26:36.799427 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:36.820615 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:36.820903 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:36.822641 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:36.822823 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Tiers_InterView]
        ) as __dbt_sbq
    
20:26:36.821055 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr"
        ) as __dbt_sbq
    
20:26:37.233609 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
20:26:37.237371 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:37.237615 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr'
      and table_schema = 'stg'
  
20:26:37.290096 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.47 seconds
20:26:37.312016 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:37.312304 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Tiers_Incr"
        ) as __dbt_sbq
    
20:26:37.313206 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:26:37.316098 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:37.316311 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
        
  
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ThReadTracking_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ThReadTracking_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ThReadTracking_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ThReadTracking_InterView]

    ),

    snapshotted_data as (

        select *,
            ThReadGUID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ThReadGUID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:36.715694'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:36.715694'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:26:36.715694''), CONVERT(DATETIME2, ''2022-09-26 20:26:36.715694'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ThReadGUID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:26:36.715694'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ThReadGUID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:36.715694'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:36.715694'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:26:36.715694'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ThReadGUID != source_data.ThReadGUID
        or
        (
            ((snapshotted_data.ThReadGUID is null) and not (source_data.ThReadGUID is null))
            or
            ((not snapshotted_data.ThReadGUID is null) and (source_data.ThReadGUID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.PrimarythRead != source_data.PrimarythRead
        or
        (
            ((snapshotted_data.PrimarythRead is null) and not (source_data.PrimarythRead is null))
            or
            ((not snapshotted_data.PrimarythRead is null) and (source_data.PrimarythRead is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ThReadGUID != source_data.ThReadGUID
        or
        (
            ((snapshotted_data.ThReadGUID is null) and not (source_data.ThReadGUID is null))
            or
            ((not snapshotted_data.ThReadGUID is null) and (source_data.ThReadGUID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.PrimarythRead != source_data.PrimarythRead
        or
        (
            ((snapshotted_data.PrimarythRead is null) and not (source_data.PrimarythRead is null))
            or
            ((not snapshotted_data.PrimarythRead is null) and (source_data.PrimarythRead is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ThReadTracking_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ThReadTracking_Incr__dbt_tmp_temp_view"
    end



    
20:26:37.659278 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
20:26:37.663195 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:37.663451 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr'
      and table_schema = 'stg'
  
20:26:37.741651 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:26:37.745440 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:37.745697 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
        
  
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Tiers_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Tiers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Tiers_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Tiers_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Tiers_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Tiers_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:36.793822'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:36.793822'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:26:36.793822''), CONVERT(DATETIME2, ''2022-09-26 20:26:36.793822'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:26:36.793822'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:36.793822'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:36.793822'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:26:36.793822'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Upperboundexclusive != source_data.Upperboundexclusive
        or
        (
            ((snapshotted_data.Upperboundexclusive is null) and not (source_data.Upperboundexclusive is null))
            or
            ((not snapshotted_data.Upperboundexclusive is null) and (source_data.Upperboundexclusive is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.Lowerboundinclusive != source_data.Lowerboundinclusive
        or
        (
            ((snapshotted_data.Lowerboundinclusive is null) and not (source_data.Lowerboundinclusive is null))
            or
            ((not snapshotted_data.Lowerboundinclusive is null) and (source_data.Lowerboundinclusive is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.FeescheduleID != source_data.FeescheduleID
        or
        (
            ((snapshotted_data.FeescheduleID is null) and not (source_data.FeescheduleID is null))
            or
            ((not snapshotted_data.FeescheduleID is null) and (source_data.FeescheduleID is null))
        ) or snapshotted_data.ValueType != source_data.ValueType
        or
        (
            ((snapshotted_data.ValueType is null) and not (source_data.ValueType is null))
            or
            ((not snapshotted_data.ValueType is null) and (source_data.ValueType is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Upperboundexclusive != source_data.Upperboundexclusive
        or
        (
            ((snapshotted_data.Upperboundexclusive is null) and not (source_data.Upperboundexclusive is null))
            or
            ((not snapshotted_data.Upperboundexclusive is null) and (source_data.Upperboundexclusive is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.Lowerboundinclusive != source_data.Lowerboundinclusive
        or
        (
            ((snapshotted_data.Lowerboundinclusive is null) and not (source_data.Lowerboundinclusive is null))
            or
            ((not snapshotted_data.Lowerboundinclusive is null) and (source_data.Lowerboundinclusive is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.FeescheduleID != source_data.FeescheduleID
        or
        (
            ((snapshotted_data.FeescheduleID is null) and not (source_data.FeescheduleID is null))
            or
            ((not snapshotted_data.FeescheduleID is null) and (source_data.FeescheduleID is null))
        ) or snapshotted_data.ValueType != source_data.ValueType
        or
        (
            ((snapshotted_data.ValueType is null) and not (source_data.ValueType is null))
            or
            ((not snapshotted_data.ValueType is null) and (source_data.ValueType is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Tiers_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Tiers_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Tiers_Incr__dbt_tmp_temp_view"
    end



    
20:26:37.859670 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
20:26:37.861198 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:37.861375 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:37.897196 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:37.899736 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:37.899942 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:38.198416 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:26:38.200563 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_SubmittedListingPayment_Incr"
20:26:38.201024 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:38.201171 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr" (
                  "ID", "TransactionID", "Amount", "CreatedOn", "UpdatedOn", "ListingID", "ConsignorID", "HasproMarketing", "HasproPhotography", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "TransactionID", "Amount", "CreatedOn", "UpdatedOn", "ListingID", "ConsignorID", "HasproMarketing", "HasproPhotography", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:26:39.631220 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.43 seconds
20:26:39.632856 [debug] [Thread-3  ]: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: COMMIT
20:26:39.633597 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
20:26:39.633733 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    end

20:26:39.673496 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:39.687342 [debug] [Thread-3  ]: finished collecting timing info
20:26:39.687662 [debug] [Thread-3  ]: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: Close
20:26:39.688396 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654bdca0>]}
20:26:39.688839 [info ] [Thread-3  ]: 89 of 101 OK snapshotted stg.AH_SubmittedListingPayment_Incr.................... [[32mOK[0m in 13.85s]
20:26:39.689150 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_SubmittedListingPayment_Incr
20:26:39.689299 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_UserAlerts_Incr
20:26:39.689589 [info ] [Thread-3  ]: 93 of 101 START snapshot stg.AH_UserAlerts_Incr................................. [RUN]
20:26:39.689944 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_UserAlerts_Incr"
20:26:39.690045 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_UserAlerts_Incr
20:26:39.690137 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_UserAlerts_Incr
20:26:39.692862 [debug] [Thread-3  ]: finished collecting timing info
20:26:39.693026 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_UserAlerts_Incr
20:26:39.695778 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:39.695972 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:26:39.696052 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:26:39.696149 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:26:39.919427 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:26:39.970291 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:26:39.991801 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:39.992071 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:26:40.038694 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:40.040756 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:40.040960 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_UserAlerts_InterView]
        ) as __dbt_sbq
    
20:26:40.105687 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:40.127576 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:40.127856 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr"
        ) as __dbt_sbq
    
20:26:40.182652 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:40.186040 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:40.186264 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr'
      and table_schema = 'stg'
  
20:26:40.300890 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:26:40.304670 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:40.304873 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
        
  
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserAlerts_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UserAlerts_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserAlerts_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UserAlerts_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_UserAlerts_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:39.997049'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:39.997049'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:26:39.997049''), CONVERT(DATETIME2, ''2022-09-26 20:26:39.997049'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:26:39.997049'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:39.997049'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:39.997049'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:26:39.997049'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.MakeID != source_data.MakeID
        or
        (
            ((snapshotted_data.MakeID is null) and not (source_data.MakeID is null))
            or
            ((not snapshotted_data.MakeID is null) and (source_data.MakeID is null))
        ) or snapshotted_data.ModelID != source_data.ModelID
        or
        (
            ((snapshotted_data.ModelID is null) and not (source_data.ModelID is null))
            or
            ((not snapshotted_data.ModelID is null) and (source_data.ModelID is null))
        ) or snapshotted_data.YearFrom != source_data.YearFrom
        or
        (
            ((snapshotted_data.YearFrom is null) and not (source_data.YearFrom is null))
            or
            ((not snapshotted_data.YearFrom is null) and (source_data.YearFrom is null))
        ) or snapshotted_data.Yearto != source_data.Yearto
        or
        (
            ((snapshotted_data.Yearto is null) and not (source_data.Yearto is null))
            or
            ((not snapshotted_data.Yearto is null) and (source_data.Yearto is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.MakeID != source_data.MakeID
        or
        (
            ((snapshotted_data.MakeID is null) and not (source_data.MakeID is null))
            or
            ((not snapshotted_data.MakeID is null) and (source_data.MakeID is null))
        ) or snapshotted_data.ModelID != source_data.ModelID
        or
        (
            ((snapshotted_data.ModelID is null) and not (source_data.ModelID is null))
            or
            ((not snapshotted_data.ModelID is null) and (source_data.ModelID is null))
        ) or snapshotted_data.YearFrom != source_data.YearFrom
        or
        (
            ((snapshotted_data.YearFrom is null) and not (source_data.YearFrom is null))
            or
            ((not snapshotted_data.YearFrom is null) and (source_data.YearFrom is null))
        ) or snapshotted_data.Yearto != source_data.Yearto
        or
        (
            ((snapshotted_data.Yearto is null) and not (source_data.Yearto is null))
            or
            ((not snapshotted_data.Yearto is null) and (source_data.Yearto is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_UserAlerts_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UserAlerts_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserAlerts_Incr__dbt_tmp_temp_view"
    end



    
20:26:41.461948 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 4.15 seconds
20:26:41.465423 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:41.465637 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:41.515897 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:41.517389 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:41.517576 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    
20:26:42.410948 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.07 seconds
20:26:42.414250 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:42.414468 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:42.487531 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:42.488983 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:42.489180 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    
20:26:42.673450 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
20:26:42.674914 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:42.675101 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:42.761690 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:26:42.764141 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:42.764359 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:43.500228 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.74 seconds
20:26:43.503282 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:43.503492 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr'
      and table_schema = 'stg'
  
20:26:43.547401 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:43.551537 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:43.551790 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:43.615039 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:43.616497 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:43.616672 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    
20:26:43.791312 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.30 seconds
20:26:43.792845 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:43.793030 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:43.871751 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:26:43.874140 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:43.874322 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:44.148125 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:26:44.150986 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:44.151180 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr'
      and table_schema = 'stg'
  
20:26:44.192953 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:44.196938 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:44.197183 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:44.250796 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:44.252222 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:44.252389 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    
20:26:44.666044 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
20:26:44.667603 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:44.667801 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:44.726629 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:44.729572 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:44.729787 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:44.973567 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:26:44.976306 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:44.976508 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr'
      and table_schema = 'stg'
  
20:26:45.015336 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:45.019136 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:45.019341 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:45.053784 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:26:45.055246 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:45.055433 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    
20:26:45.274588 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.02 seconds
20:26:45.276040 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:45.276229 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:45.355075 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:26:45.357543 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:45.357776 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:45.604747 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:26:45.607539 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:45.607726 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr'
      and table_schema = 'stg'
  
20:26:45.642710 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:26:45.646535 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:45.646805 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:45.698969 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:45.702261 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:45.702462 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    
20:26:46.119983 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
20:26:46.121365 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:46.121545 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:46.156049 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:26:46.158306 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:46.158518 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:46.374227 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 8.63 seconds
20:26:46.377636 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:46.377850 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:46.425477 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:46.426884 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:46.427051 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Tiers_Incr__dbt_tmp"
    
20:26:46.447128 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
20:26:46.448940 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ThReadTracking_Incr"
20:26:46.449330 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:46.449450 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ThReadTracking_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr" (
                  "ThReadGUID", "Name", "DaTestamp", "PrimarythRead", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ThReadGUID", "Name", "DaTestamp", "PrimarythRead", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ThReadTracking_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:26:47.116415 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.41 seconds
20:26:47.117808 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:47.117987 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:47.154702 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:47.156910 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:47.157126 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:47.434579 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
20:26:47.436531 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_SysDiagrams_Incr"
20:26:47.436938 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:47.437066 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_SysDiagrams_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr" (
                  "Diagram_ID", "Version", "Principal_ID", "Definition", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "Diagram_ID", "Version", "Principal_ID", "Definition", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_SysDiagrams_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:26:47.655546 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.23 seconds
20:26:47.657074 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:47.657246 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:47.737900 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:26:47.740858 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:47.741053 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:47.971389 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.52 seconds
20:26:47.974448 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ThReadTracking_Incr: COMMIT
20:26:47.975396 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
20:26:47.975554 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."#AH_ThReadTracking_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    end

20:26:48.022473 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:48.125125 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.38 seconds
20:26:48.127590 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:48.127809 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr'
      and table_schema = 'stg'
  
20:26:48.129334 [debug] [Thread-1  ]: finished collecting timing info
20:26:48.129575 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ThReadTracking_Incr: Close
20:26:48.130204 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654bdfd0>]}
20:26:48.130667 [info ] [Thread-1  ]: 91 of 101 OK snapshotted stg.AH_ThReadTracking_Incr............................. [[32mOK[0m in 11.62s]
20:26:48.130980 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ThReadTracking_Incr
20:26:48.131119 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_UserMessages_Incr
20:26:48.131396 [info ] [Thread-1  ]: 94 of 101 START snapshot stg.AH_UserMessages_Incr............................... [RUN]
20:26:48.131741 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_UserMessages_Incr"
20:26:48.131840 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_UserMessages_Incr
20:26:48.131931 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_UserMessages_Incr
20:26:48.134726 [debug] [Thread-1  ]: finished collecting timing info
20:26:48.134873 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_UserMessages_Incr
20:26:48.137538 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:26:48.137679 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:26:48.137759 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:26:48.137857 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:26:48.200798 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:48.204863 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:48.206762 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:48.267457 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:26:48.269018 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:48.270293 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:48.270477 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Tiers_Incr__dbt_tmp"
    
20:26:48.297965 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:26:48.319438 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:26:48.319713 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:26:48.348711 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:26:48.350787 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:26:48.350998 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_UserMessages_InterView]
        ) as __dbt_sbq
    
20:26:48.443963 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:26:48.465495 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:26:48.465794 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr"
        ) as __dbt_sbq
    
20:26:48.761626 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:26:48.765239 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:26:48.765510 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr'
      and table_schema = 'stg'
  
20:26:48.849710 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.41 seconds
20:26:48.851436 [debug] [Thread-2  ]: On snapshot.Shawn.AH_SysDiagrams_Incr: COMMIT
20:26:48.852496 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
20:26:48.852661 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."#AH_SysDiagrams_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    end

20:26:48.862334 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:26:48.865580 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:26:48.865794 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
        
  
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserMessages_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UserMessages_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserMessages_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UserMessages_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_UserMessages_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:48.325263'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:48.325263'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:26:48.325263''), CONVERT(DATETIME2, ''2022-09-26 20:26:48.325263'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:26:48.325263'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:48.325263'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:48.325263'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:26:48.325263'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SEnderID != source_data.SEnderID
        or
        (
            ((snapshotted_data.SEnderID is null) and not (source_data.SEnderID is null))
            or
            ((not snapshotted_data.SEnderID is null) and (source_data.SEnderID is null))
        ) or snapshotted_data.RecipientID != source_data.RecipientID
        or
        (
            ((snapshotted_data.RecipientID is null) and not (source_data.RecipientID is null))
            or
            ((not snapshotted_data.RecipientID is null) and (source_data.RecipientID is null))
        ) or snapshotted_data.MasTerMessageID != source_data.MasTerMessageID
        or
        (
            ((snapshotted_data.MasTerMessageID is null) and not (source_data.MasTerMessageID is null))
            or
            ((not snapshotted_data.MasTerMessageID is null) and (source_data.MasTerMessageID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Sent != source_data.Sent
        or
        (
            ((snapshotted_data.Sent is null) and not (source_data.Sent is null))
            or
            ((not snapshotted_data.Sent is null) and (source_data.Sent is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.SuBJect != source_data.SuBJect
        or
        (
            ((snapshotted_data.SuBJect is null) and not (source_data.SuBJect is null))
            or
            ((not snapshotted_data.SuBJect is null) and (source_data.SuBJect is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.SEnderStatus != source_data.SEnderStatus
        or
        (
            ((snapshotted_data.SEnderStatus is null) and not (source_data.SEnderStatus is null))
            or
            ((not snapshotted_data.SEnderStatus is null) and (source_data.SEnderStatus is null))
        ) or snapshotted_data.RecipientStatus != source_data.RecipientStatus
        or
        (
            ((snapshotted_data.RecipientStatus is null) and not (source_data.RecipientStatus is null))
            or
            ((not snapshotted_data.RecipientStatus is null) and (source_data.RecipientStatus is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SEnderID != source_data.SEnderID
        or
        (
            ((snapshotted_data.SEnderID is null) and not (source_data.SEnderID is null))
            or
            ((not snapshotted_data.SEnderID is null) and (source_data.SEnderID is null))
        ) or snapshotted_data.RecipientID != source_data.RecipientID
        or
        (
            ((snapshotted_data.RecipientID is null) and not (source_data.RecipientID is null))
            or
            ((not snapshotted_data.RecipientID is null) and (source_data.RecipientID is null))
        ) or snapshotted_data.MasTerMessageID != source_data.MasTerMessageID
        or
        (
            ((snapshotted_data.MasTerMessageID is null) and not (source_data.MasTerMessageID is null))
            or
            ((not snapshotted_data.MasTerMessageID is null) and (source_data.MasTerMessageID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Sent != source_data.Sent
        or
        (
            ((snapshotted_data.Sent is null) and not (source_data.Sent is null))
            or
            ((not snapshotted_data.Sent is null) and (source_data.Sent is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.SuBJect != source_data.SuBJect
        or
        (
            ((snapshotted_data.SuBJect is null) and not (source_data.SuBJect is null))
            or
            ((not snapshotted_data.SuBJect is null) and (source_data.SuBJect is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.SEnderStatus != source_data.SEnderStatus
        or
        (
            ((snapshotted_data.SEnderStatus is null) and not (source_data.SEnderStatus is null))
            or
            ((not snapshotted_data.SEnderStatus is null) and (source_data.SEnderStatus is null))
        ) or snapshotted_data.RecipientStatus != source_data.RecipientStatus
        or
        (
            ((snapshotted_data.RecipientStatus is null) and not (source_data.RecipientStatus is null))
            or
            ((not snapshotted_data.RecipientStatus is null) and (source_data.RecipientStatus is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_UserMessages_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UserMessages_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserMessages_Incr__dbt_tmp_temp_view"
    end



    
20:26:48.913336 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:48.927615 [debug] [Thread-2  ]: finished collecting timing info
20:26:48.927941 [debug] [Thread-2  ]: On snapshot.Shawn.AH_SysDiagrams_Incr: Close
20:26:48.928623 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0164386bb0>]}
20:26:48.929061 [info ] [Thread-2  ]: 90 of 101 OK snapshotted stg.AH_SysDiagrams_Incr................................ [[32mOK[0m in 14.06s]
20:26:48.929393 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_SysDiagrams_Incr
20:26:48.929537 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_UserOptOut_Incr
20:26:48.929824 [info ] [Thread-2  ]: 95 of 101 START snapshot stg.AH_UserOptOut_Incr................................. [RUN]
20:26:48.930177 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_UserOptOut_Incr"
20:26:48.930276 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_UserOptOut_Incr
20:26:48.930367 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_UserOptOut_Incr
20:26:48.933217 [debug] [Thread-2  ]: finished collecting timing info
20:26:48.933409 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_UserOptOut_Incr
20:26:48.936581 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:26:48.936758 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:26:48.936841 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:26:48.936942 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:26:49.036102 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:26:49.076692 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:26:49.098331 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:26:49.098660 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:26:49.140815 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:49.142932 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:26:49.143451 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_UserOptOut_InterView]
        ) as __dbt_sbq
    
20:26:49.156991 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.89 seconds
20:26:49.158378 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:49.158593 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:49.194420 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:49.196712 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:49.196917 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:49.214013 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:49.235318 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:26:49.235608 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr"
        ) as __dbt_sbq
    
20:26:49.298018 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:49.301370 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:26:49.301600 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr'
      and table_schema = 'stg'
  
20:26:49.382232 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:26:49.385654 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:26:49.385888 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
        
  
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserOptOut_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UserOptOut_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserOptOut_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UserOptOut_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_UserOptOut_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:49.106516'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:49.106516'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:26:49.106516''), CONVERT(DATETIME2, ''2022-09-26 20:26:49.106516'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:26:49.106516'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:49.106516'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:49.106516'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:26:49.106516'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.EmailName != source_data.EmailName
        or
        (
            ((snapshotted_data.EmailName is null) and not (source_data.EmailName is null))
            or
            ((not snapshotted_data.EmailName is null) and (source_data.EmailName is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.EmailName != source_data.EmailName
        or
        (
            ((snapshotted_data.EmailName is null) and not (source_data.EmailName is null))
            or
            ((not snapshotted_data.EmailName is null) and (source_data.EmailName is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_UserOptOut_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UserOptOut_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserOptOut_Incr__dbt_tmp_temp_view"
    end



    
20:26:49.504269 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
20:26:49.507151 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:49.507387 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr'
      and table_schema = 'stg'
  
20:26:49.542703 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:49.547950 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:49.548233 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:49.586377 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:49.587840 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:49.588028 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Tiers_Incr__dbt_tmp"
    
20:26:51.470128 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.88 seconds
20:26:51.471586 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:51.471770 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:51.522314 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:51.524819 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:51.525050 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:51.869112 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
20:26:51.871318 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Tiers_Incr"
20:26:51.871810 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:51.871954 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Tiers_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Tiers_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Tiers_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Tiers_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Tiers_Incr" (
                  "ID", "Upperboundexclusive", "Value", "Lowerboundinclusive", "CreatedOn", "UpdatedOn", "DeletedOn", "FeescheduleID", "ValueType", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Upperboundexclusive", "Value", "Lowerboundinclusive", "CreatedOn", "UpdatedOn", "DeletedOn", "FeescheduleID", "ValueType", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Tiers_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:26:51.893380 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 11.59 seconds
20:26:51.896747 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:51.897004 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:51.993550 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:26:51.994997 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:51.995195 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserAlerts_Incr__dbt_tmp"
    
20:26:53.165877 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.17 seconds
20:26:53.167427 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:53.167606 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:53.280744 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:26:53.283256 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:53.283461 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:53.574615 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.70 seconds
20:26:53.576113 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Tiers_Incr: COMMIT
20:26:53.577137 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
20:26:53.577278 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."#AH_Tiers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Tiers_Incr__dbt_tmp"
    end

20:26:53.584888 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:26:53.587453 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:53.587661 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr'
      and table_schema = 'stg'
  
20:26:53.660775 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:26:53.673329 [debug] [Thread-4  ]: finished collecting timing info
20:26:53.673669 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Tiers_Incr: Close
20:26:53.674381 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01643896d0>]}
20:26:53.674870 [info ] [Thread-4  ]: 92 of 101 OK snapshotted stg.AH_Tiers_Incr...................................... [[32mOK[0m in 17.08s]
20:26:53.675203 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Tiers_Incr
20:26:53.675346 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_UserRoles_Incr
20:26:53.675618 [info ] [Thread-4  ]: 96 of 101 START snapshot stg.AH_UserRoles_Incr.................................. [RUN]
20:26:53.675985 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_UserRoles_Incr"
20:26:53.676087 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_UserRoles_Incr
20:26:53.676178 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_UserRoles_Incr
20:26:53.678908 [debug] [Thread-4  ]: finished collecting timing info
20:26:53.679084 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_UserRoles_Incr
20:26:53.681817 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:26:53.681958 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:26:53.682039 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:26:53.682137 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:26:53.726645 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:26:53.730789 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:53.731041 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:53.801815 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:53.803359 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:53.803541 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserAlerts_Incr__dbt_tmp"
    
20:26:53.810371 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:26:53.837690 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:26:53.859677 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:26:53.859960 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:26:53.917312 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:53.919649 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:26:53.919886 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_UserRoles_InterView]
        ) as __dbt_sbq
    
20:26:54.003782 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:26:54.026774 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:26:54.027063 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr"
        ) as __dbt_sbq
    
20:26:54.085486 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:26:54.088864 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:26:54.089142 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr'
      and table_schema = 'stg'
  
20:26:54.206877 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:26:54.210359 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:26:54.210687 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
        
  
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserRoles_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UserRoles_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserRoles_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UserRoles_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_UserRoles_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:53.887827'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:53.887827'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:26:53.887827''), CONVERT(DATETIME2, ''2022-09-26 20:26:53.887827'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:26:53.887827'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:53.887827'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:53.887827'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:26:53.887827'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.RoleID != source_data.RoleID
        or
        (
            ((snapshotted_data.RoleID is null) and not (source_data.RoleID is null))
            or
            ((not snapshotted_data.RoleID is null) and (source_data.RoleID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.RoleID != source_data.RoleID
        or
        (
            ((snapshotted_data.RoleID is null) and not (source_data.RoleID is null))
            or
            ((not snapshotted_data.RoleID is null) and (source_data.RoleID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_UserRoles_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UserRoles_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserRoles_Incr__dbt_tmp_temp_view"
    end



    
20:26:54.862909 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
20:26:54.864386 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:54.864564 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:54.898702 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:26:54.901247 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:54.901486 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:55.091153 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:26:55.094067 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:55.094302 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr'
      and table_schema = 'stg'
  
20:26:55.131879 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:55.136374 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:55.136643 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:55.185643 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:55.187134 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:55.187320 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserAlerts_Incr__dbt_tmp"
    
20:26:56.290023 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
20:26:56.291477 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:56.291644 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:56.329950 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:56.332494 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:56.332713 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:56.636738 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.25 seconds
20:26:56.640230 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:26:56.640480 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:56.884298 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.55 seconds
20:26:56.886401 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_UserAlerts_Incr"
20:26:56.886895 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:56.887026 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_UserAlerts_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr" (
                  "ID", "Enabled", "UserID", "MakeID", "ModelID", "YearFrom", "Yearto", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Enabled", "UserID", "MakeID", "ModelID", "YearFrom", "Yearto", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_UserAlerts_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:26:56.940570 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:26:56.942197 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:26:56.942382 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserOptOut_Incr__dbt_tmp"
    
20:26:58.888356 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.95 seconds
20:26:58.889800 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:26:58.889972 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:26:58.987192 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:26:58.989649 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:26:58.989885 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:59.095160 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.21 seconds
20:26:59.096625 [debug] [Thread-3  ]: On snapshot.Shawn.AH_UserAlerts_Incr: COMMIT
20:26:59.097309 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
20:26:59.097461 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."#AH_UserAlerts_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserAlerts_Incr__dbt_tmp"
    end

20:26:59.192795 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:26:59.206387 [debug] [Thread-3  ]: finished collecting timing info
20:26:59.206744 [debug] [Thread-3  ]: On snapshot.Shawn.AH_UserAlerts_Incr: Close
20:26:59.207478 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015677d700>]}
20:26:59.207938 [info ] [Thread-3  ]: 93 of 101 OK snapshotted stg.AH_UserAlerts_Incr................................. [[32mOK[0m in 19.52s]
20:26:59.208252 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_UserAlerts_Incr
20:26:59.208406 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Userclaims_Incr
20:26:59.208688 [info ] [Thread-3  ]: 97 of 101 START snapshot stg.AH_Userclaims_Incr................................. [RUN]
20:26:59.209050 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Userclaims_Incr"
20:26:59.209150 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Userclaims_Incr
20:26:59.209239 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Userclaims_Incr
20:26:59.211967 [debug] [Thread-3  ]: finished collecting timing info
20:26:59.212126 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Userclaims_Incr
20:26:59.214978 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:26:59.215131 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:26:59.215213 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:26:59.215315 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:26:59.227502 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:26:59.230415 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:26:59.230878 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr'
      and table_schema = 'stg'
  
20:26:59.273268 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:59.277629 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:26:59.277887 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:26:59.327694 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:26:59.329079 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:26:59.329252 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserOptOut_Incr__dbt_tmp"
    
20:26:59.345953 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:26:59.379038 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:26:59.401811 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:26:59.402090 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:26:59.437619 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:26:59.439653 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:26:59.439862 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Userclaims_InterView]
        ) as __dbt_sbq
    
20:26:59.506198 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:59.527855 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:26:59.528141 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr"
        ) as __dbt_sbq
    
20:26:59.601743 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:26:59.605269 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:26:59.605517 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr'
      and table_schema = 'stg'
  
20:26:59.696491 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:26:59.700017 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:26:59.700282 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
        
  
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Userclaims_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Userclaims_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Userclaims_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Userclaims_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Userclaims_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:59.403512'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:59.403512'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:26:59.403512''), CONVERT(DATETIME2, ''2022-09-26 20:26:59.403512'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:26:59.403512'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:26:59.403512'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:26:59.403512'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:26:59.403512'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ClaimType != source_data.ClaimType
        or
        (
            ((snapshotted_data.ClaimType is null) and not (source_data.ClaimType is null))
            or
            ((not snapshotted_data.ClaimType is null) and (source_data.ClaimType is null))
        ) or snapshotted_data.ClaimValue != source_data.ClaimValue
        or
        (
            ((snapshotted_data.ClaimValue is null) and not (source_data.ClaimValue is null))
            or
            ((not snapshotted_data.ClaimValue is null) and (source_data.ClaimValue is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ClaimType != source_data.ClaimType
        or
        (
            ((snapshotted_data.ClaimType is null) and not (source_data.ClaimType is null))
            or
            ((not snapshotted_data.ClaimType is null) and (source_data.ClaimType is null))
        ) or snapshotted_data.ClaimValue != source_data.ClaimValue
        or
        (
            ((snapshotted_data.ClaimValue is null) and not (source_data.ClaimValue is null))
            or
            ((not snapshotted_data.ClaimValue is null) and (source_data.ClaimValue is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Userclaims_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Userclaims_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Userclaims_Incr__dbt_tmp_temp_view"
    end



    
20:27:00.702258 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.37 seconds
20:27:00.703726 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:27:00.703907 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:27:00.737839 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:27:00.740306 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:27:00.740520 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:01.104216 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
20:27:01.107086 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:27:01.107321 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr'
      and table_schema = 'stg'
  
20:27:01.143653 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:27:01.147899 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:27:01.148150 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:01.310807 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:27:01.312280 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:27:01.312474 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserOptOut_Incr__dbt_tmp"
    
20:27:02.618422 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.31 seconds
20:27:02.619962 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:27:02.620147 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:27:02.652593 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:27:02.654911 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:27:02.655137 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:02.850096 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 8.64 seconds
20:27:02.853313 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:27:02.853540 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:02.881516 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:27:02.883609 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_UserOptOut_Incr"
20:27:02.884079 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:27:02.884221 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_UserOptOut_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr" (
                  "ID", "EmailName", "UpdatedOn", "DeletedOn", "CreatedOn", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "EmailName", "UpdatedOn", "DeletedOn", "CreatedOn", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_UserOptOut_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:27:02.912231 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:27:02.913700 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:27:02.913894 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserRoles_Incr__dbt_tmp"
    
20:27:04.009560 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
20:27:04.011048 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:27:04.011240 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:27:04.095256 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:27:04.097473 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:27:04.097689 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:04.276228 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.39 seconds
20:27:04.277703 [debug] [Thread-2  ]: On snapshot.Shawn.AH_UserOptOut_Incr: COMMIT
20:27:04.278837 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
20:27:04.278994 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."#AH_UserOptOut_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserOptOut_Incr__dbt_tmp"
    end

20:27:04.322045 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:27:04.324617 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:27:04.324862 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr'
      and table_schema = 'stg'
  
20:27:04.334444 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:27:04.347889 [debug] [Thread-2  ]: finished collecting timing info
20:27:04.348232 [debug] [Thread-2  ]: On snapshot.Shawn.AH_UserOptOut_Incr: Close
20:27:04.348938 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654b7370>]}
20:27:04.349404 [info ] [Thread-2  ]: 95 of 101 OK snapshotted stg.AH_UserOptOut_Incr................................. [[32mOK[0m in 15.42s]
20:27:04.349742 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_UserOptOut_Incr
20:27:04.349901 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Userproperties_Incr
20:27:04.350200 [info ] [Thread-2  ]: 98 of 101 START snapshot stg.AH_Userproperties_Incr............................. [RUN]
20:27:04.350622 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Userproperties_Incr"
20:27:04.350743 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Userproperties_Incr
20:27:04.350838 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Userproperties_Incr
20:27:04.353600 [debug] [Thread-2  ]: finished collecting timing info
20:27:04.353762 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Userproperties_Incr
20:27:04.356797 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:04.356960 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:27:04.357042 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:27:04.357140 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:27:04.381574 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:27:04.385389 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:27:04.385640 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:04.447749 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:27:04.449103 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:27:04.449283 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserRoles_Incr__dbt_tmp"
    
20:27:04.472084 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:27:04.500898 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:27:04.522833 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:04.523099 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:27:04.557729 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:27:04.560222 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:04.560481 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Userproperties_InterView]
        ) as __dbt_sbq
    
20:27:04.615955 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:27:04.637218 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:04.637507 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr"
        ) as __dbt_sbq
    
20:27:04.783229 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:27:04.786763 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:04.787027 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr'
      and table_schema = 'stg'
  
20:27:04.873356 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:27:04.877214 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:04.877474 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
        
  
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Userproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Userproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Userproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Userproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Userproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:27:04.528590'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:27:04.528590'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:27:04.528590''), CONVERT(DATETIME2, ''2022-09-26 20:27:04.528590'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:27:04.528590'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:27:04.528590'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:27:04.528590'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:27:04.528590'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Userproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Userproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Userproperties_Incr__dbt_tmp_temp_view"
    end



    
20:27:05.250303 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 5.55 seconds
20:27:05.254163 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:27:05.254373 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:05.308642 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:27:05.310053 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:27:05.310220 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userclaims_Incr__dbt_tmp"
    
20:27:05.334812 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.89 seconds
20:27:05.336383 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:27:05.336574 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:27:05.386975 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:27:05.389440 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:27:05.389688 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:05.743519 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
20:27:05.746481 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:27:05.746744 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr'
      and table_schema = 'stg'
  
20:27:05.850290 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:27:05.854250 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:27:05.854467 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:05.930284 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:27:05.931726 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:27:05.931893 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserRoles_Incr__dbt_tmp"
    
20:27:06.690696 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
20:27:06.692330 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:27:06.692575 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:27:06.803154 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:27:06.805648 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:27:06.805902 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:06.912935 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 18.05 seconds
20:27:06.916360 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:27:06.916628 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:06.967156 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:27:06.968640 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:27:06.968859 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserMessages_Incr__dbt_tmp"
    
20:27:07.007668 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:27:07.010641 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:27:07.010877 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr'
      and table_schema = 'stg'
  
20:27:07.068133 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:27:07.071938 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:27:07.072182 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:07.284293 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:27:07.285765 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:27:07.285959 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userclaims_Incr__dbt_tmp"
    
20:27:07.822021 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.89 seconds
20:27:07.823907 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:27:07.824121 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:27:07.865215 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:27:07.867620 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:27:07.867889 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:08.154642 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
20:27:08.156486 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_UserRoles_Incr"
20:27:08.156923 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:27:08.157050 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_UserRoles_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr" (
                  "ID", "RoleID", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "RoleID", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_UserRoles_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:27:09.127567 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.16 seconds
20:27:09.129502 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:27:09.129854 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.84 seconds
20:27:09.131093 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:27:09.131238 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:27:09.129994 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:27:09.184630 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:27:09.187161 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:27:09.187420 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:09.235373 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:27:09.238038 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:27:09.238278 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:09.448942 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:27:09.451997 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:27:09.452255 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr'
      and table_schema = 'stg'
  
20:27:09.484109 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:27:09.488208 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:27:09.488454 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:09.494722 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:27:09.497433 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:27:09.497647 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr'
      and table_schema = 'stg'
  
20:27:09.532835 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:27:09.536835 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:27:09.537089 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:09.546985 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:27:09.548361 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:27:09.548530 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userclaims_Incr__dbt_tmp"
    
20:27:09.576358 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:27:09.577881 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:27:09.578116 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserMessages_Incr__dbt_tmp"
    
20:27:10.004112 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.85 seconds
20:27:10.005553 [debug] [Thread-4  ]: On snapshot.Shawn.AH_UserRoles_Incr: COMMIT
20:27:10.006246 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
20:27:10.006376 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."#AH_UserRoles_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserRoles_Incr__dbt_tmp"
    end

20:27:10.219213 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:27:10.233863 [debug] [Thread-4  ]: finished collecting timing info
20:27:10.234206 [debug] [Thread-4  ]: On snapshot.Shawn.AH_UserRoles_Incr: Close
20:27:10.234978 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01640aafd0>]}
20:27:10.235461 [info ] [Thread-4  ]: 96 of 101 OK snapshotted stg.AH_UserRoles_Incr.................................. [[32mOK[0m in 16.56s]
20:27:10.235787 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_UserRoles_Incr
20:27:10.235938 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Users_Incr
20:27:10.236226 [info ] [Thread-4  ]: 99 of 101 START snapshot stg.AH_Users_Incr...................................... [RUN]
20:27:10.236595 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Users_Incr"
20:27:10.236697 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Users_Incr
20:27:10.236788 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Users_Incr
20:27:10.239542 [debug] [Thread-4  ]: finished collecting timing info
20:27:10.239713 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Users_Incr
20:27:10.242738 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:27:10.242912 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:27:10.242997 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:27:10.243101 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:27:10.385706 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:27:10.416586 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:27:10.438638 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:27:10.438912 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:27:10.471619 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:27:10.473663 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:27:10.474430 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Users_InterView]
        ) as __dbt_sbq
    
20:27:10.532661 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:27:10.553837 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:27:10.554146 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Users_Incr"
        ) as __dbt_sbq
    
20:27:10.747516 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:27:10.751401 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:27:10.751657 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr'
      and table_schema = 'stg'
  
20:27:11.147131 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.60 seconds
20:27:11.148680 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:27:11.148865 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:27:11.365880 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.79 seconds
20:27:11.367509 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:27:11.367730 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:27:11.403116 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:27:11.405605 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:27:11.405812 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:11.457012 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.71 seconds
20:27:11.461018 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:27:11.461281 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
        
  
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Users_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Users_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Users_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Users_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Users_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Users_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:27:10.450533'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:27:10.450533'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:27:10.450533''), CONVERT(DATETIME2, ''2022-09-26 20:27:10.450533'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:27:10.450533'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:27:10.450533'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:27:10.450533'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:27:10.450533'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BillingAddressID != source_data.BillingAddressID
        or
        (
            ((snapshotted_data.BillingAddressID is null) and not (source_data.BillingAddressID is null))
            or
            ((not snapshotted_data.BillingAddressID is null) and (source_data.BillingAddressID is null))
        ) or snapshotted_data.BillingCreditCardID != source_data.BillingCreditCardID
        or
        (
            ((snapshotted_data.BillingCreditCardID is null) and not (source_data.BillingCreditCardID is null))
            or
            ((not snapshotted_data.BillingCreditCardID is null) and (source_data.BillingCreditCardID is null))
        ) or snapshotted_data.PrimaryAddressID != source_data.PrimaryAddressID
        or
        (
            ((snapshotted_data.PrimaryAddressID is null) and not (source_data.PrimaryAddressID is null))
            or
            ((not snapshotted_data.PrimaryAddressID is null) and (source_data.PrimaryAddressID is null))
        ) or snapshotted_data.AccessfailedCount != source_data.AccessfailedCount
        or
        (
            ((snapshotted_data.AccessfailedCount is null) and not (source_data.AccessfailedCount is null))
            or
            ((not snapshotted_data.AccessfailedCount is null) and (source_data.AccessfailedCount is null))
        ) or snapshotted_data.IsApproved != source_data.IsApproved
        or
        (
            ((snapshotted_data.IsApproved is null) and not (source_data.IsApproved is null))
            or
            ((not snapshotted_data.IsApproved is null) and (source_data.IsApproved is null))
        ) or snapshotted_data.IsLockedOut != source_data.IsLockedOut
        or
        (
            ((snapshotted_data.IsLockedOut is null) and not (source_data.IsLockedOut is null))
            or
            ((not snapshotted_data.IsLockedOut is null) and (source_data.IsLockedOut is null))
        ) or snapshotted_data.NewsLetter != source_data.NewsLetter
        or
        (
            ((snapshotted_data.NewsLetter is null) and not (source_data.NewsLetter is null))
            or
            ((not snapshotted_data.NewsLetter is null) and (source_data.NewsLetter is null))
        ) or snapshotted_data.IsVerified != source_data.IsVerified
        or
        (
            ((snapshotted_data.IsVerified is null) and not (source_data.IsVerified is null))
            or
            ((not snapshotted_data.IsVerified is null) and (source_data.IsVerified is null))
        ) or snapshotted_data.IsActive != source_data.IsActive
        or
        (
            ((snapshotted_data.IsActive is null) and not (source_data.IsActive is null))
            or
            ((not snapshotted_data.IsActive is null) and (source_data.IsActive is null))
        ) or snapshotted_data.EmailConfirmed != source_data.EmailConfirmed
        or
        (
            ((snapshotted_data.EmailConfirmed is null) and not (source_data.EmailConfirmed is null))
            or
            ((not snapshotted_data.EmailConfirmed is null) and (source_data.EmailConfirmed is null))
        ) or snapshotted_data.PhoneNumberConfirmed != source_data.PhoneNumberConfirmed
        or
        (
            ((snapshotted_data.PhoneNumberConfirmed is null) and not (source_data.PhoneNumberConfirmed is null))
            or
            ((not snapshotted_data.PhoneNumberConfirmed is null) and (source_data.PhoneNumberConfirmed is null))
        ) or snapshotted_data.TwoFactorEnabled != source_data.TwoFactorEnabled
        or
        (
            ((snapshotted_data.TwoFactorEnabled is null) and not (source_data.TwoFactorEnabled is null))
            or
            ((not snapshotted_data.TwoFactorEnabled is null) and (source_data.TwoFactorEnabled is null))
        ) or snapshotted_data.LockOutEnabled != source_data.LockOutEnabled
        or
        (
            ((snapshotted_data.LockOutEnabled is null) and not (source_data.LockOutEnabled is null))
            or
            ((not snapshotted_data.LockOutEnabled is null) and (source_data.LockOutEnabled is null))
        ) or snapshotted_data.WebapiEnabled != source_data.WebapiEnabled
        or
        (
            ((snapshotted_data.WebapiEnabled is null) and not (source_data.WebapiEnabled is null))
            or
            ((not snapshotted_data.WebapiEnabled is null) and (source_data.WebapiEnabled is null))
        ) or snapshotted_data.CreationDate != source_data.CreationDate
        or
        (
            ((snapshotted_data.CreationDate is null) and not (source_data.CreationDate is null))
            or
            ((not snapshotted_data.CreationDate is null) and (source_data.CreationDate is null))
        ) or snapshotted_data.LastLoginDate != source_data.LastLoginDate
        or
        (
            ((snapshotted_data.LastLoginDate is null) and not (source_data.LastLoginDate is null))
            or
            ((not snapshotted_data.LastLoginDate is null) and (source_data.LastLoginDate is null))
        ) or snapshotted_data.LastActivityDate != source_data.LastActivityDate
        or
        (
            ((snapshotted_data.LastActivityDate is null) and not (source_data.LastActivityDate is null))
            or
            ((not snapshotted_data.LastActivityDate is null) and (source_data.LastActivityDate is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LockOutEndDateUTC != source_data.LockOutEndDateUTC
        or
        (
            ((snapshotted_data.LockOutEndDateUTC is null) and not (source_data.LockOutEndDateUTC is null))
            or
            ((not snapshotted_data.LockOutEndDateUTC is null) and (source_data.LockOutEndDateUTC is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.Password != source_data.Password
        or
        (
            ((snapshotted_data.Password is null) and not (source_data.Password is null))
            or
            ((not snapshotted_data.Password is null) and (source_data.Password is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.Lastip != source_data.Lastip
        or
        (
            ((snapshotted_data.Lastip is null) and not (source_data.Lastip is null))
            or
            ((not snapshotted_data.Lastip is null) and (source_data.Lastip is null))
        ) or snapshotted_data.VerificationToken != source_data.VerificationToken
        or
        (
            ((snapshotted_data.VerificationToken is null) and not (source_data.VerificationToken is null))
            or
            ((not snapshotted_data.VerificationToken is null) and (source_data.VerificationToken is null))
        ) or snapshotted_data.PasswordResetToken != source_data.PasswordResetToken
        or
        (
            ((snapshotted_data.PasswordResetToken is null) and not (source_data.PasswordResetToken is null))
            or
            ((not snapshotted_data.PasswordResetToken is null) and (source_data.PasswordResetToken is null))
        ) or snapshotted_data.ServiceAuthorizationToken != source_data.ServiceAuthorizationToken
        or
        (
            ((snapshotted_data.ServiceAuthorizationToken is null) and not (source_data.ServiceAuthorizationToken is null))
            or
            ((not snapshotted_data.ServiceAuthorizationToken is null) and (source_data.ServiceAuthorizationToken is null))
        ) or snapshotted_data.PasswordHash != source_data.PasswordHash
        or
        (
            ((snapshotted_data.PasswordHash is null) and not (source_data.PasswordHash is null))
            or
            ((not snapshotted_data.PasswordHash is null) and (source_data.PasswordHash is null))
        ) or snapshotted_data.SecURItyStamp != source_data.SecURItyStamp
        or
        (
            ((snapshotted_data.SecURItyStamp is null) and not (source_data.SecURItyStamp is null))
            or
            ((not snapshotted_data.SecURItyStamp is null) and (source_data.SecURItyStamp is null))
        ) or snapshotted_data.PhoneNumber != source_data.PhoneNumber
        or
        (
            ((snapshotted_data.PhoneNumber is null) and not (source_data.PhoneNumber is null))
            or
            ((not snapshotted_data.PhoneNumber is null) and (source_data.PhoneNumber is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BillingAddressID != source_data.BillingAddressID
        or
        (
            ((snapshotted_data.BillingAddressID is null) and not (source_data.BillingAddressID is null))
            or
            ((not snapshotted_data.BillingAddressID is null) and (source_data.BillingAddressID is null))
        ) or snapshotted_data.BillingCreditCardID != source_data.BillingCreditCardID
        or
        (
            ((snapshotted_data.BillingCreditCardID is null) and not (source_data.BillingCreditCardID is null))
            or
            ((not snapshotted_data.BillingCreditCardID is null) and (source_data.BillingCreditCardID is null))
        ) or snapshotted_data.PrimaryAddressID != source_data.PrimaryAddressID
        or
        (
            ((snapshotted_data.PrimaryAddressID is null) and not (source_data.PrimaryAddressID is null))
            or
            ((not snapshotted_data.PrimaryAddressID is null) and (source_data.PrimaryAddressID is null))
        ) or snapshotted_data.AccessfailedCount != source_data.AccessfailedCount
        or
        (
            ((snapshotted_data.AccessfailedCount is null) and not (source_data.AccessfailedCount is null))
            or
            ((not snapshotted_data.AccessfailedCount is null) and (source_data.AccessfailedCount is null))
        ) or snapshotted_data.IsApproved != source_data.IsApproved
        or
        (
            ((snapshotted_data.IsApproved is null) and not (source_data.IsApproved is null))
            or
            ((not snapshotted_data.IsApproved is null) and (source_data.IsApproved is null))
        ) or snapshotted_data.IsLockedOut != source_data.IsLockedOut
        or
        (
            ((snapshotted_data.IsLockedOut is null) and not (source_data.IsLockedOut is null))
            or
            ((not snapshotted_data.IsLockedOut is null) and (source_data.IsLockedOut is null))
        ) or snapshotted_data.NewsLetter != source_data.NewsLetter
        or
        (
            ((snapshotted_data.NewsLetter is null) and not (source_data.NewsLetter is null))
            or
            ((not snapshotted_data.NewsLetter is null) and (source_data.NewsLetter is null))
        ) or snapshotted_data.IsVerified != source_data.IsVerified
        or
        (
            ((snapshotted_data.IsVerified is null) and not (source_data.IsVerified is null))
            or
            ((not snapshotted_data.IsVerified is null) and (source_data.IsVerified is null))
        ) or snapshotted_data.IsActive != source_data.IsActive
        or
        (
            ((snapshotted_data.IsActive is null) and not (source_data.IsActive is null))
            or
            ((not snapshotted_data.IsActive is null) and (source_data.IsActive is null))
        ) or snapshotted_data.EmailConfirmed != source_data.EmailConfirmed
        or
        (
            ((snapshotted_data.EmailConfirmed is null) and not (source_data.EmailConfirmed is null))
            or
            ((not snapshotted_data.EmailConfirmed is null) and (source_data.EmailConfirmed is null))
        ) or snapshotted_data.PhoneNumberConfirmed != source_data.PhoneNumberConfirmed
        or
        (
            ((snapshotted_data.PhoneNumberConfirmed is null) and not (source_data.PhoneNumberConfirmed is null))
            or
            ((not snapshotted_data.PhoneNumberConfirmed is null) and (source_data.PhoneNumberConfirmed is null))
        ) or snapshotted_data.TwoFactorEnabled != source_data.TwoFactorEnabled
        or
        (
            ((snapshotted_data.TwoFactorEnabled is null) and not (source_data.TwoFactorEnabled is null))
            or
            ((not snapshotted_data.TwoFactorEnabled is null) and (source_data.TwoFactorEnabled is null))
        ) or snapshotted_data.LockOutEnabled != source_data.LockOutEnabled
        or
        (
            ((snapshotted_data.LockOutEnabled is null) and not (source_data.LockOutEnabled is null))
            or
            ((not snapshotted_data.LockOutEnabled is null) and (source_data.LockOutEnabled is null))
        ) or snapshotted_data.WebapiEnabled != source_data.WebapiEnabled
        or
        (
            ((snapshotted_data.WebapiEnabled is null) and not (source_data.WebapiEnabled is null))
            or
            ((not snapshotted_data.WebapiEnabled is null) and (source_data.WebapiEnabled is null))
        ) or snapshotted_data.CreationDate != source_data.CreationDate
        or
        (
            ((snapshotted_data.CreationDate is null) and not (source_data.CreationDate is null))
            or
            ((not snapshotted_data.CreationDate is null) and (source_data.CreationDate is null))
        ) or snapshotted_data.LastLoginDate != source_data.LastLoginDate
        or
        (
            ((snapshotted_data.LastLoginDate is null) and not (source_data.LastLoginDate is null))
            or
            ((not snapshotted_data.LastLoginDate is null) and (source_data.LastLoginDate is null))
        ) or snapshotted_data.LastActivityDate != source_data.LastActivityDate
        or
        (
            ((snapshotted_data.LastActivityDate is null) and not (source_data.LastActivityDate is null))
            or
            ((not snapshotted_data.LastActivityDate is null) and (source_data.LastActivityDate is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LockOutEndDateUTC != source_data.LockOutEndDateUTC
        or
        (
            ((snapshotted_data.LockOutEndDateUTC is null) and not (source_data.LockOutEndDateUTC is null))
            or
            ((not snapshotted_data.LockOutEndDateUTC is null) and (source_data.LockOutEndDateUTC is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.Password != source_data.Password
        or
        (
            ((snapshotted_data.Password is null) and not (source_data.Password is null))
            or
            ((not snapshotted_data.Password is null) and (source_data.Password is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.Lastip != source_data.Lastip
        or
        (
            ((snapshotted_data.Lastip is null) and not (source_data.Lastip is null))
            or
            ((not snapshotted_data.Lastip is null) and (source_data.Lastip is null))
        ) or snapshotted_data.VerificationToken != source_data.VerificationToken
        or
        (
            ((snapshotted_data.VerificationToken is null) and not (source_data.VerificationToken is null))
            or
            ((not snapshotted_data.VerificationToken is null) and (source_data.VerificationToken is null))
        ) or snapshotted_data.PasswordResetToken != source_data.PasswordResetToken
        or
        (
            ((snapshotted_data.PasswordResetToken is null) and not (source_data.PasswordResetToken is null))
            or
            ((not snapshotted_data.PasswordResetToken is null) and (source_data.PasswordResetToken is null))
        ) or snapshotted_data.ServiceAuthorizationToken != source_data.ServiceAuthorizationToken
        or
        (
            ((snapshotted_data.ServiceAuthorizationToken is null) and not (source_data.ServiceAuthorizationToken is null))
            or
            ((not snapshotted_data.ServiceAuthorizationToken is null) and (source_data.ServiceAuthorizationToken is null))
        ) or snapshotted_data.PasswordHash != source_data.PasswordHash
        or
        (
            ((snapshotted_data.PasswordHash is null) and not (source_data.PasswordHash is null))
            or
            ((not snapshotted_data.PasswordHash is null) and (source_data.PasswordHash is null))
        ) or snapshotted_data.SecURItyStamp != source_data.SecURItyStamp
        or
        (
            ((snapshotted_data.SecURItyStamp is null) and not (source_data.SecURItyStamp is null))
            or
            ((not snapshotted_data.SecURItyStamp is null) and (source_data.SecURItyStamp is null))
        ) or snapshotted_data.PhoneNumber != source_data.PhoneNumber
        or
        (
            ((snapshotted_data.PhoneNumber is null) and not (source_data.PhoneNumber is null))
            or
            ((not snapshotted_data.PhoneNumber is null) and (source_data.PhoneNumber is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Users_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Users_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Users_Incr__dbt_tmp_temp_view"
    end



    
20:27:11.480885 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
20:27:11.483118 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:27:11.483317 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:11.817282 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
20:27:11.820034 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:27:11.820276 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr'
      and table_schema = 'stg'
  
20:27:11.869945 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:27:11.874722 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:27:11.874996 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:11.911877 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:27:11.913486 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:27:11.913685 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserMessages_Incr__dbt_tmp"
    
20:27:12.550083 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.07 seconds
20:27:12.551998 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Userclaims_Incr"
20:27:12.552416 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:27:12.552533 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Userclaims_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr" (
                  "ID", "UserID", "ClaimType", "ClaimValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UserID", "ClaimType", "ClaimValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Userclaims_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:27:13.390676 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.48 seconds
20:27:13.392748 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:27:13.392955 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:27:13.438618 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:27:13.441187 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:27:13.441385 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:13.711846 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:27:13.713930 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_UserMessages_Incr"
20:27:13.714327 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:27:13.714441 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_UserMessages_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr" (
                  "ID", "SEnderID", "RecipientID", "MasTerMessageID", "ListingID", "Sent", "CreatedOn", "UpdatedOn", "DeletedOn", "SuBJect", "Body", "SEnderStatus", "RecipientStatus", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SEnderID", "RecipientID", "MasTerMessageID", "ListingID", "Sent", "CreatedOn", "UpdatedOn", "DeletedOn", "SuBJect", "Body", "SEnderStatus", "RecipientStatus", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_UserMessages_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:27:14.097285 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.54 seconds
20:27:14.098895 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Userclaims_Incr: COMMIT
20:27:14.099622 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
20:27:14.099753 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."#AH_Userclaims_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Userclaims_Incr__dbt_tmp"
    end

20:27:14.199647 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:27:14.213124 [debug] [Thread-3  ]: finished collecting timing info
20:27:14.213449 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Userclaims_Incr: Close
20:27:14.214142 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654b7760>]}
20:27:14.214647 [info ] [Thread-3  ]: 97 of 101 OK snapshotted stg.AH_Userclaims_Incr................................. [[32mOK[0m in 15.01s]
20:27:14.214965 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Userclaims_Incr
20:27:14.215109 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Version_Incr
20:27:14.215380 [info ] [Thread-3  ]: 100 of 101 START snapshot stg.AH_Version_Incr................................... [RUN]
20:27:14.215727 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Version_Incr"
20:27:14.215826 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Version_Incr
20:27:14.215913 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Version_Incr
20:27:14.218479 [debug] [Thread-3  ]: finished collecting timing info
20:27:14.218667 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Version_Incr
20:27:14.221314 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:14.221447 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:27:14.221528 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:27:14.221622 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:27:14.347716 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:27:14.379137 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:27:14.401473 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:14.401754 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:27:14.445283 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:27:14.447409 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:14.447966 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Version_InterView]
        ) as __dbt_sbq
    
20:27:14.539927 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:27:14.562102 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:14.562375 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Version_Incr"
        ) as __dbt_sbq
    
20:27:14.717004 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:27:14.720394 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:14.720607 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr'
      and table_schema = 'stg'
  
20:27:14.829043 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:27:14.832641 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:14.832867 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
        
  
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Version_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Version_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Version_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Version_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Version_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Version_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:27:14.419379'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:27:14.419379'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:27:14.419379''), CONVERT(DATETIME2, ''2022-09-26 20:27:14.419379'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:27:14.419379'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:27:14.419379'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:27:14.419379'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:27:14.419379'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.VersionNumber != source_data.VersionNumber
        or
        (
            ((snapshotted_data.VersionNumber is null) and not (source_data.VersionNumber is null))
            or
            ((not snapshotted_data.VersionNumber is null) and (source_data.VersionNumber is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.VersionNumber != source_data.VersionNumber
        or
        (
            ((snapshotted_data.VersionNumber is null) and not (source_data.VersionNumber is null))
            or
            ((not snapshotted_data.VersionNumber is null) and (source_data.VersionNumber is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Version_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Version_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Version_Incr__dbt_tmp_temp_view"
    end



    
20:27:15.376195 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.66 seconds
20:27:15.377798 [debug] [Thread-1  ]: On snapshot.Shawn.AH_UserMessages_Incr: COMMIT
20:27:15.378526 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
20:27:15.378705 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."#AH_UserMessages_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserMessages_Incr__dbt_tmp"
    end

20:27:15.435996 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:27:15.449508 [debug] [Thread-1  ]: finished collecting timing info
20:27:15.449815 [debug] [Thread-1  ]: On snapshot.Shawn.AH_UserMessages_Incr: Close
20:27:15.450509 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654b74c0>]}
20:27:15.451011 [info ] [Thread-1  ]: 94 of 101 OK snapshotted stg.AH_UserMessages_Incr............................... [[32mOK[0m in 27.32s]
20:27:15.451323 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_UserMessages_Incr
20:27:15.451465 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Watches_Incr
20:27:15.451737 [info ] [Thread-1  ]: 101 of 101 START snapshot stg.AH_Watches_Incr................................... [RUN]
20:27:15.452084 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Watches_Incr"
20:27:15.452185 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Watches_Incr
20:27:15.452274 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Watches_Incr
20:27:15.454934 [debug] [Thread-1  ]: finished collecting timing info
20:27:15.455086 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Watches_Incr
20:27:15.457740 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:15.457875 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
20:27:15.457956 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:15.458052 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:27:15.583810 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:27:15.619925 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:27:15.642453 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:15.642769 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select SYSDATETIME() as snapshot_start
  
20:27:15.746076 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:27:15.748127 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:15.748651 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Watches_InterView]
        ) as __dbt_sbq
    
20:27:15.834353 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:27:15.856692 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:15.856988 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Watches_Incr"
        ) as __dbt_sbq
    
20:27:15.960070 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:27:15.963442 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:15.963661 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr'
      and table_schema = 'stg'
  
20:27:16.037261 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:27:16.040701 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:16.040889 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
        
  
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Watches_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Watches_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Watches_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Watches_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Watches_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Watches_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:27:15.716224'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:27:15.716224'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-26 20:27:15.716224''), CONVERT(DATETIME2, ''2022-09-26 20:27:15.716224'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-26 20:27:15.716224'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-26 20:27:15.716224'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-26 20:27:15.716224'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-26 20:27:15.716224'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Watches_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Watches_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Watches_Incr__dbt_tmp_temp_view"
    end



    
20:27:21.588378 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.76 seconds
20:27:21.591675 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:21.591855 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:21.791542 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:27:21.792963 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:21.793139 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Version_Incr__dbt_tmp"
    
20:27:22.972268 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.18 seconds
20:27:22.973767 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:22.973928 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:27:23.113091 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:27:23.115485 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:23.115669 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:23.382581 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:27:23.386319 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:23.386527 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr'
      and table_schema = 'stg'
  
20:27:23.482243 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:27:23.486318 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:23.486602 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:23.533592 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:27:23.535053 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:23.535227 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Version_Incr__dbt_tmp"
    
20:27:25.476432 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.94 seconds
20:27:25.477891 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:25.478057 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:27:25.559999 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:27:25.562470 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:25.562757 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:26.048153 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.49 seconds
20:27:26.050893 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:26.051121 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr'
      and table_schema = 'stg'
  
20:27:26.142082 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:27:26.146378 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:26.146627 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:26.279250 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:27:26.280615 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:26.280794 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Version_Incr__dbt_tmp"
    
20:27:29.611659 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.33 seconds
20:27:29.613233 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:29.613421 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:27:29.701644 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:27:29.704110 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:29.704305 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:30.282850 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.58 seconds
20:27:30.284895 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Version_Incr"
20:27:30.285348 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:30.285488 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Version_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Version_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Version_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Version_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Version_Incr" (
                  "ID", "VersionNumber", "Status", "DaTestamp", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "VersionNumber", "Status", "DaTestamp", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Version_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:27:33.075867 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.79 seconds
20:27:33.077396 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Version_Incr: COMMIT
20:27:33.078065 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
20:27:33.078187 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."#AH_Version_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Version_Incr__dbt_tmp"
    end

20:27:33.122824 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:27:33.136205 [debug] [Thread-3  ]: finished collecting timing info
20:27:33.136522 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Version_Incr: Close
20:27:33.137206 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654b7ca0>]}
20:27:33.137638 [info ] [Thread-3  ]: 100 of 101 OK snapshotted stg.AH_Version_Incr................................... [[32mOK[0m in 18.92s]
20:27:33.137966 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Version_Incr
20:27:33.258687 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 17.22 seconds
20:27:33.261799 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:33.262010 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:33.317435 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:27:33.318943 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 28.44 seconds
20:27:33.321454 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:33.321593 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:33.322013 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:33.322125 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Watches_Incr__dbt_tmp"
    
20:27:33.362188 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:27:33.363898 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:33.364081 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userproperties_Incr__dbt_tmp"
    
20:27:34.600029 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.28 seconds
20:27:34.601395 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:34.601566 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:27:34.603311 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.24 seconds
20:27:34.604445 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:34.604570 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:27:34.672550 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:27:34.675270 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:34.675528 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:34.695137 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:27:34.697438 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:34.697646 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:34.937963 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:27:34.940801 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:34.940988 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr'
      and table_schema = 'stg'
  
20:27:34.943876 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:27:34.946235 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:34.946384 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr'
      and table_schema = 'stg'
  
20:27:35.013240 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:27:35.017289 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:35.017528 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:27:35.020984 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:35.021198 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:35.017669 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:35.135723 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:27:35.137297 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:35.137471 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:27:35.138521 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:35.138680 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userproperties_Incr__dbt_tmp"
    
20:27:35.137594 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Watches_Incr__dbt_tmp"
    
20:27:36.290065 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
20:27:36.291628 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:36.291802 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:27:36.292024 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
20:27:36.292984 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:36.293107 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:27:36.373449 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:27:36.376047 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:36.376263 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:36.376531 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:27:36.378798 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:36.378956 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:36.695857 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
20:27:36.698588 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:36.698803 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr'
      and table_schema = 'stg'
  
20:27:36.701820 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
20:27:36.704282 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:36.704434 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr'
      and table_schema = 'stg'
  
20:27:36.757888 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:27:36.762014 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:36.762243 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:36.764395 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:27:36.769932 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:36.770125 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:36.808169 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:27:36.809596 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:36.809783 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Watches_Incr__dbt_tmp"
    
20:27:36.810019 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:27:36.810999 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:36.811132 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userproperties_Incr__dbt_tmp"
    
20:27:38.113712 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.30 seconds
20:27:38.115154 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:38.115322 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:27:38.158752 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:27:38.161635 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:38.161889 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:38.166283 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.36 seconds
20:27:38.167597 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:38.167742 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:27:38.201840 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:27:38.204323 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:38.204535 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:27:38.780952 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.58 seconds
20:27:38.782918 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Watches_Incr"
20:27:38.783337 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:38.783462 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Watches_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Watches_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Watches_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Watches_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Watches_Incr" (
                  "ID", "UserID", "ListingID", "DeletedOn", "CreatedOn", "UpdatedOn", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UserID", "ListingID", "DeletedOn", "CreatedOn", "UpdatedOn", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Watches_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:27:38.802358 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.64 seconds
20:27:38.804535 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Userproperties_Incr"
20:27:38.804998 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:38.805136 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Userproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr" (
                  "ID", "IntnativeValue", "UserID", "CustomFieldID", "BoolnativeValue", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "DecimalnativeValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "IntnativeValue", "UserID", "CustomFieldID", "BoolnativeValue", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "DecimalnativeValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Userproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:27:40.940021 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.16 seconds
20:27:40.941525 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Watches_Incr: COMMIT
20:27:40.942218 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
20:27:40.942348 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."#AH_Watches_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Watches_Incr__dbt_tmp"
    end

20:27:41.000176 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:27:41.012593 [debug] [Thread-1  ]: finished collecting timing info
20:27:41.012903 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Watches_Incr: Close
20:27:41.013589 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01654bd1f0>]}
20:27:41.014029 [info ] [Thread-1  ]: 101 of 101 OK snapshotted stg.AH_Watches_Incr................................... [[32mOK[0m in 25.56s]
20:27:41.014339 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Watches_Incr
20:27:41.021484 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.22 seconds
20:27:41.022799 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Userproperties_Incr: COMMIT
20:27:41.023450 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
20:27:41.023570 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."#AH_Userproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Userproperties_Incr__dbt_tmp"
    end

20:27:41.103622 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:27:41.194668 [debug] [Thread-2  ]: finished collecting timing info
20:27:41.194991 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Userproperties_Incr: Close
20:27:41.195666 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016541f160>]}
20:27:41.196090 [info ] [Thread-2  ]: 98 of 101 OK snapshotted stg.AH_Userproperties_Incr............................. [[32mOK[0m in 36.85s]
20:27:41.196392 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Userproperties_Incr
20:28:05.689313 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 54.23 seconds
20:28:05.692657 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:28:05.692908 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:28:05.735284 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:28:05.736643 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:28:05.736814 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Users_Incr__dbt_tmp"
    
20:28:06.891981 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
20:28:06.893404 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:28:06.893582 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:28:06.972637 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:28:06.975794 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:28:06.976039 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:28:07.190448 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:28:07.193325 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:28:07.193579 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr'
      and table_schema = 'stg'
  
20:28:07.265537 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:28:07.270077 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:28:07.270333 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:28:07.313893 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:28:07.315297 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:28:07.315479 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Users_Incr__dbt_tmp"
    
20:28:08.487299 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.17 seconds
20:28:08.488719 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:28:08.488894 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:28:08.565560 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:28:08.568655 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:28:08.568910 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:28:08.801709 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:28:08.804528 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:28:08.804766 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr'
      and table_schema = 'stg'
  
20:28:08.877889 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:28:08.882873 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:28:08.883123 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:28:08.922603 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:28:08.924119 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:28:08.924342 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Users_Incr__dbt_tmp"
    
20:28:10.089371 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
20:28:10.090838 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:28:10.091016 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
20:28:10.128713 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:28:10.131507 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:28:10.131701 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

20:28:10.408087 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
20:28:10.410754 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Users_Incr"
20:28:10.411177 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:28:10.411305 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Users_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Users_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Users_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Users_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Users_Incr" (
                  "ID", "BillingAddressID", "BillingCreditCardID", "PrimaryAddressID", "AccessfailedCount", "IsApproved", "IsLockedOut", "NewsLetter", "IsVerified", "IsActive", "EmailConfirmed", "PhoneNumberConfirmed", "TwoFactorEnabled", "LockOutEnabled", "WebapiEnabled", "CreationDate", "LastLoginDate", "LastActivityDate", "CreatedOn", "UpdatedOn", "DeletedOn", "LockOutEndDateUTC", "UserName", "Email", "Password", "Comment", "LastUpdatedUser", "Culture", "Lastip", "VerificationToken", "PasswordResetToken", "ServiceAuthorizationToken", "PasswordHash", "SecURItyStamp", "PhoneNumber", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "BillingAddressID", "BillingCreditCardID", "PrimaryAddressID", "AccessfailedCount", "IsApproved", "IsLockedOut", "NewsLetter", "IsVerified", "IsActive", "EmailConfirmed", "PhoneNumberConfirmed", "TwoFactorEnabled", "LockOutEnabled", "WebapiEnabled", "CreationDate", "LastLoginDate", "LastActivityDate", "CreatedOn", "UpdatedOn", "DeletedOn", "LockOutEndDateUTC", "UserName", "Email", "Password", "Comment", "LastUpdatedUser", "Culture", "Lastip", "VerificationToken", "PasswordResetToken", "ServiceAuthorizationToken", "PasswordHash", "SecURItyStamp", "PhoneNumber", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Users_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
20:28:11.956398 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.54 seconds
20:28:11.957813 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Users_Incr: COMMIT
20:28:11.958493 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
20:28:11.958654 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."#AH_Users_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Users_Incr__dbt_tmp"
    end

20:28:12.000197 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:28:12.013306 [debug] [Thread-4  ]: finished collecting timing info
20:28:12.013603 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Users_Incr: Close
20:28:12.014277 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bc2616-eeb2-4085-8b0f-f580f9cb464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016545ca60>]}
20:28:12.014755 [info ] [Thread-4  ]: 99 of 101 OK snapshotted stg.AH_Users_Incr...................................... [[32mOK[0m in 61.78s]
20:28:12.015091 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Users_Incr
20:28:12.017034 [debug] [MainThread]: Acquiring new synapse connection "master"
20:28:12.017302 [debug] [MainThread]: On master: COMMIT
20:28:12.017658 [info ] [MainThread]: 
20:28:12.017861 [info ] [MainThread]: Finished running 101 snapshots in 676.66s.
20:28:12.018012 [debug] [MainThread]: Connection 'master' was properly closed.
20:28:12.018083 [debug] [MainThread]: Connection 'snapshot.Shawn.AH_Userproperties_Incr' was properly closed.
20:28:12.018145 [debug] [MainThread]: Connection 'snapshot.Shawn.AH_Watches_Incr' was properly closed.
20:28:12.018204 [debug] [MainThread]: Connection 'snapshot.Shawn.AH_Version_Incr' was properly closed.
20:28:12.018262 [debug] [MainThread]: Connection 'snapshot.Shawn.AH_Users_Incr' was properly closed.
20:28:12.049133 [info ] [MainThread]: 
20:28:12.049459 [info ] [MainThread]: [32mCompleted successfully[0m
20:28:12.049805 [info ] [MainThread]: 
20:28:12.049942 [info ] [MainThread]: Done. PASS=101 WARN=0 ERROR=0 SKIP=0 TOTAL=101
20:28:12.050192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0169942c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01676828e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016544ef10>]}


============================== 2022-09-26 20:28:14.527005 | 0b5715fa-7560-45f1-a785-4d579419a262 ==============================
20:28:14.527005 [info ] [MainThread]: Running with dbt=1.0.0
20:28:14.527559 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step4_dboSingle'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
20:28:14.527762 [debug] [MainThread]: Tracking: tracking
20:28:14.528061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3ea7de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3ea7de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3ea7dee0>]}
20:28:14.724162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:28:14.724447 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:28:14.750492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3ea01280>]}
20:28:14.798046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b40a42850>]}
20:28:14.798564 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:28:14.810716 [info ] [MainThread]: 
20:28:14.811368 [debug] [MainThread]: Acquiring new synapse connection "master"
20:28:14.816934 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
20:28:14.826192 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
20:28:14.826377 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
20:28:14.826465 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:28:14.826623 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:15.114632 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:15.146653 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.32 seconds
20:28:15.148503 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
20:28:15.170999 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
20:28:15.177180 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
20:28:15.177659 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
20:28:15.179872 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
20:28:15.180048 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
20:28:15.180132 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:28:15.180231 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:15.177907 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
20:28:15.181526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:28:15.181697 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:15.293082 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:15.293635 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:15.360649 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:28:15.364684 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:28:15.483483 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
20:28:15.491056 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
20:28:15.554781 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
20:28:15.555139 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
20:28:39.491649 [debug] [MainThread]: On master: COMMIT
20:28:39.492253 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
20:28:39.492512 [info ] [MainThread]: 
20:28:39.498043 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Addresses
20:28:39.498484 [info ] [Thread-1  ]: 1 of 105 START table model dbo.AH_Addresses..................................... [RUN]
20:28:39.499089 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Addresses"
20:28:39.499228 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Addresses
20:28:39.499343 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Addresses
20:28:39.502301 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Addresses"
20:28:39.502686 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Attributes
20:28:39.502925 [info ] [Thread-2  ]: 2 of 105 START table model dbo.AH_Attributes.................................... [RUN]
20:28:39.503365 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Attributes"
20:28:39.503480 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Attributes
20:28:39.503577 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Attributes
20:28:39.506320 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Attributes"
20:28:39.506670 [debug] [Thread-3  ]: Began running node model.Shawn.AH_AuctionEventMedias
20:28:39.506900 [info ] [Thread-3  ]: 3 of 105 START table model dbo.AH_AuctionEventMedias............................ [RUN]
20:28:39.507349 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_AuctionEventMedias"
20:28:39.507463 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_AuctionEventMedias
20:28:39.507559 [debug] [Thread-3  ]: Compiling model.Shawn.AH_AuctionEventMedias
20:28:39.510325 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_AuctionEventMedias"
20:28:39.510690 [debug] [Thread-4  ]: Began running node model.Shawn.AH_AuctionEvents
20:28:39.510912 [info ] [Thread-4  ]: 4 of 105 START table model dbo.AH_AuctionEvents................................. [RUN]
20:28:39.511368 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_AuctionEvents"
20:28:39.511484 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_AuctionEvents
20:28:39.511578 [debug] [Thread-4  ]: Compiling model.Shawn.AH_AuctionEvents
20:28:39.514528 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_AuctionEvents"
20:28:39.515113 [debug] [Thread-4  ]: finished collecting timing info
20:28:39.515262 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_AuctionEvents
20:28:39.524000 [debug] [Thread-1  ]: finished collecting timing info
20:28:39.524277 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Addresses
20:28:39.542138 [debug] [Thread-2  ]: finished collecting timing info
20:28:39.542436 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Attributes
20:28:39.555587 [debug] [Thread-3  ]: finished collecting timing info
20:28:39.555865 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_AuctionEventMedias
20:28:39.715589 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Attributes"
20:28:39.725168 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Attributes".
20:28:39.725329 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Attributes: 
  
  if object_id ('"dbo"."AH_Attributes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Attributes__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Attributes__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Attributes__dbt_tmp"
    end


   EXEC('create view dbo.AH_Attributes__dbt_tmp_temp_view as
    
Select
	cast([ConText] as nvarchar(4000)) [Context],
	cast([Name] as nvarchar(4000)) [Name],
	cast([Value] as nvarchar(4000)) [Value],
	cast([EditMode] as nvarchar(4000)) [EditMode],
	cast([Type] as nvarchar(4000)) [Type],
	cast([ID] as int) [Id],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_Attributes_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Attributes__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Attributes__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Attributes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Attributes__dbt_tmp_temp_view"
    end



20:28:39.725417 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:28:39.725527 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:39.724543 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_AuctionEvents"
20:28:39.727136 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEvents".
20:28:39.727266 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_AuctionEvents: 
  
  if object_id ('"dbo"."AH_AuctionEvents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_AuctionEvents__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_AuctionEvents__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_AuctionEvents__dbt_tmp"
    end


   EXEC('create view dbo.AH_AuctionEvents__dbt_tmp_temp_view as
    
Select
	cast([SoftclosingGroupIncrementseconds] as int) [SoftClosingGroupIncrementSeconds],
	cast([LotCount] as int) [LotCount],
	cast([CategoryID] as int) [CategoryID],
	cast([CurrencyID] as int) [CurrencyId],
	cast([ID] as int) [Id],
	cast([ClosingGroupIncrementseconds] as int) [ClosingGroupIncrementSeconds],
	cast([CurrentclosingGroup] as int) [CurrentClosingGroup],
	cast([CurrentSoftclosingGroup] as int) [CurrentSoftClosingGroup],
	cast([CurrentLotOrder] as int) [CurrentLotOrder],
	cast([OwnerID] as int) [OwnerId],
	cast([ProxyBidding] as bit) [ProxyBidding],
	cast([Published] as bit) [Published],
	cast([PreviewLots] as bit) [PreviewLots],
	cast([LotsTaxable] as bit) [LotsTaxable],
	cast([FollowLiveEnabled] as bit) [FollowLiveEnabled],
	cast([BuyersPremiumPercent] as numeric(19,4)) [BuyersPremiumPercent],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Startdttm] as datetime) [StartDTTM],
	cast([Enddttm] as datetime) [EndDTTM],
	cast([EstimatedLastEnddttm] as datetime) [EstimatedLastEndDTTM],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Status] as nvarchar(4000)) [Status],
	cast([Timezone] as nvarchar(4000)) [TimeZone],
	cast([TermsandConditions] as nvarchar(4000)) [TermsAndConditions],
	cast([PrimaryImageURI] as nvarchar(4000)) [PrimaryImageURI],
	cast([Title] as nvarchar(4000)) [Title],
	cast([SecondaryImageURI] as nvarchar(4000)) [SecondaryImageURI],
	cast([OwnerUserName] as nvarchar(4000)) [OwnerUserName],
	cast([ShippingInfo] as nvarchar(4000)) [ShippingInfo],
	cast([SubTitle] as nvarchar(4000)) [Subtitle],
	cast([ManagedByName] as nvarchar(4000)) [ManagedByName] 
From stg.[AH_AuctionEvents_FinalView]
    ');

  CREATE TABLE "dbo"."AH_AuctionEvents__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_AuctionEvents__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_AuctionEvents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_AuctionEvents__dbt_tmp_temp_view"
    end



20:28:39.727377 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:28:39.727484 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:39.719685 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Addresses"
20:28:39.728612 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Addresses".
20:28:39.728730 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Addresses: 
  
  if object_id ('"dbo"."AH_Addresses__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Addresses__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Addresses__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Addresses__dbt_tmp"
    end


   EXEC('create view dbo.AH_Addresses__dbt_tmp_temp_view as
    
Select
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UserID] as int) [UserId],
	cast([ID] as int) [Id],
	cast([CountryID] as int) [CountryId],
	cast([Street1] as varchar(128)) [Street1],
	cast([Street2] as varchar(128)) [Street2],
	cast([City] as nvarchar(100)) [City],
	cast([Stateregion] as nvarchar(50)) [StateRegion],
	cast([ZipPostal] as nvarchar(50)) [ZipPostal],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([Description] as nvarchar(4000)) [Description],
	cast([FirstName] as nvarchar(500)) [FirstName],
	cast([LastName] as nvarchar(500)) [LastName] 
From stg.[AH_Addresses_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Addresses__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Addresses__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Addresses__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Addresses__dbt_tmp_temp_view"
    end



20:28:39.728811 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:28:39.728907 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:39.723656 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_AuctionEventMedias"
20:28:39.730084 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEventMedias".
20:28:39.730216 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_AuctionEventMedias: 
  
  if object_id ('"dbo"."AH_AuctionEventMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_AuctionEventMedias__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_AuctionEventMedias__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_AuctionEventMedias__dbt_tmp"
    end


   EXEC('create view dbo.AH_AuctionEventMedias__dbt_tmp_temp_view as
    
Select
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([DisplayOrder] as int) [DisplayOrder],
	cast([ID] as int) [Id],
	cast([MediaID] as int) [MediaId],
	cast([EventID] as int) [EventId] 
From stg.[AH_AuctionEventMedias_FinalView]
    ');

  CREATE TABLE "dbo"."AH_AuctionEventMedias__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_AuctionEventMedias__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_AuctionEventMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_AuctionEventMedias__dbt_tmp_temp_view"
    end



20:28:39.730305 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:28:39.730401 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:39.877504 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:39.884399 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:39.886791 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:39.887674 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:42.810359 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.08 seconds
20:28:42.821065 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.09 seconds
20:28:42.840100 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEventMedias".
20:28:42.840383 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_AuctionEventMedias: rename object "dbo"."AH_AuctionEventMedias" to AH_AuctionEventMedias__dbt_backup
20:28:42.846332 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Addresses".
20:28:42.846635 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Addresses: rename object "dbo"."AH_Addresses" to AH_Addresses__dbt_backup
20:28:42.879144 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.15 seconds
20:28:42.887830 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.16 seconds
20:28:42.903171 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEvents".
20:28:42.911829 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_AuctionEvents: rename object "dbo"."AH_AuctionEvents" to AH_AuctionEvents__dbt_backup
20:28:42.912791 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Attributes".
20:28:42.912962 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Attributes: rename object "dbo"."AH_Attributes" to AH_Attributes__dbt_backup
20:28:43.159466 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
20:28:43.167827 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
20:28:43.169072 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:28:43.177280 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Addresses".
20:28:43.183909 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Addresses: rename object "dbo"."AH_Addresses__dbt_tmp" to AH_Addresses
20:28:43.191744 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
20:28:43.199160 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEvents".
20:28:43.207573 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_AuctionEvents: rename object "dbo"."AH_AuctionEvents__dbt_tmp" to AH_AuctionEvents
20:28:43.207282 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEventMedias".
20:28:43.219457 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_AuctionEventMedias: rename object "dbo"."AH_AuctionEventMedias__dbt_tmp" to AH_AuctionEventMedias
20:28:43.219150 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:28:43.231117 [debug] [Thread-1  ]: On model.Shawn.AH_Addresses: COMMIT
20:28:43.233080 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Attributes".
20:28:43.238910 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Attributes: rename object "dbo"."AH_Attributes__dbt_tmp" to AH_Attributes
20:28:43.238649 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:28:43.240422 [debug] [Thread-4  ]: On model.Shawn.AH_AuctionEvents: COMMIT
20:28:43.248188 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Addresses".
20:28:43.248417 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Addresses: 
    
  if object_id ('"dbo"."AH_Addresses__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Addresses__dbt_backup"
    end

20:28:43.247580 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEvents".
20:28:43.248712 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_AuctionEvents: 
    
  if object_id ('"dbo"."AH_AuctionEvents__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_AuctionEvents__dbt_backup"
    end

20:28:43.262638 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:28:43.264272 [debug] [Thread-3  ]: On model.Shawn.AH_AuctionEventMedias: COMMIT
20:28:43.268672 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEventMedias".
20:28:43.268893 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:28:43.270406 [debug] [Thread-2  ]: On model.Shawn.AH_Attributes: COMMIT
20:28:43.269030 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_AuctionEventMedias: 
    
  if object_id ('"dbo"."AH_AuctionEventMedias__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_AuctionEventMedias__dbt_backup"
    end

20:28:43.274736 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Attributes".
20:28:43.275155 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Attributes: 
    
  if object_id ('"dbo"."AH_Attributes__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Attributes__dbt_backup"
    end

20:28:43.830945 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.56 seconds
20:28:43.841205 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.59 seconds
20:28:43.927625 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.65 seconds
20:28:43.929156 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.68 seconds
20:28:43.932295 [debug] [Thread-3  ]: finished collecting timing info
20:28:43.943594 [debug] [Thread-3  ]: On model.Shawn.AH_AuctionEventMedias: Close
20:28:43.944559 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c3c8850>]}
20:28:43.945023 [info ] [Thread-3  ]: 3 of 105 OK created table model dbo.AH_AuctionEventMedias....................... [[32mOK[0m in 4.44s]
20:28:43.945358 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_AuctionEventMedias
20:28:43.945523 [debug] [Thread-3  ]: Began running node model.Shawn.AH_BannedUsers
20:28:43.951833 [info ] [Thread-3  ]: 5 of 105 START table model dbo.AH_BannedUsers................................... [RUN]
20:28:43.952427 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_BannedUsers"
20:28:43.952555 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_BannedUsers
20:28:43.952661 [debug] [Thread-3  ]: Compiling model.Shawn.AH_BannedUsers
20:28:43.955566 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_BannedUsers"
20:28:43.967969 [debug] [Thread-3  ]: finished collecting timing info
20:28:43.968136 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_BannedUsers
20:28:43.961643 [debug] [Thread-4  ]: finished collecting timing info
20:28:43.986060 [debug] [Thread-4  ]: On model.Shawn.AH_AuctionEvents: Close
20:28:43.967431 [debug] [Thread-1  ]: finished collecting timing info
20:28:43.987343 [debug] [Thread-1  ]: On model.Shawn.AH_Addresses: Close
20:28:43.987849 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c778820>]}
20:28:43.988245 [info ] [Thread-1  ]: 1 of 105 OK created table model dbo.AH_Addresses................................ [[32mOK[0m in 4.49s]
20:28:43.988563 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Addresses
20:28:43.975561 [debug] [Thread-2  ]: finished collecting timing info
20:28:43.989020 [debug] [Thread-2  ]: On model.Shawn.AH_Attributes: Close
20:28:43.989530 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c4ae190>]}
20:28:43.989872 [info ] [Thread-2  ]: 2 of 105 OK created table model dbo.AH_Attributes............................... [[32mOK[0m in 4.49s]
20:28:43.990143 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Attributes
20:28:43.990280 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Banners
20:28:43.987053 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c4a9040>]}
20:28:43.990926 [info ] [Thread-4  ]: 4 of 105 OK created table model dbo.AH_AuctionEvents............................ [[32mOK[0m in 4.48s]
20:28:43.991166 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_AuctionEvents
20:28:43.988718 [debug] [Thread-1  ]: Began running node model.Shawn.AH_BannerCategories
20:28:43.991658 [info ] [Thread-1  ]: 6 of 105 START table model dbo.AH_BannerCategories.............................. [RUN]
20:28:43.992021 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_BannerCategories"
20:28:43.992128 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_BannerCategories
20:28:43.992225 [debug] [Thread-1  ]: Compiling model.Shawn.AH_BannerCategories
20:28:43.990637 [info ] [Thread-2  ]: 7 of 105 START table model dbo.AH_Banners....................................... [RUN]
20:28:43.995754 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Banners"
20:28:43.995865 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Banners
20:28:43.995959 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Banners
20:28:43.991293 [debug] [Thread-4  ]: Began running node model.Shawn.AH_BiddingTransactions
20:28:43.998744 [info ] [Thread-4  ]: 8 of 105 START table model dbo.AH_BiddingTransactions........................... [RUN]
20:28:43.999100 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_BiddingTransactions"
20:28:43.999205 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_BiddingTransactions
20:28:43.999293 [debug] [Thread-4  ]: Compiling model.Shawn.AH_BiddingTransactions
20:28:43.995319 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_BannerCategories"
20:28:44.012205 [debug] [Thread-1  ]: finished collecting timing info
20:28:44.012410 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_BannerCategories
20:28:43.998432 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Banners"
20:28:44.030184 [debug] [Thread-2  ]: finished collecting timing info
20:28:44.030420 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Banners
20:28:44.001852 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_BiddingTransactions"
20:28:44.047428 [debug] [Thread-4  ]: finished collecting timing info
20:28:44.047631 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_BiddingTransactions
20:28:44.040678 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_BannedUsers"
20:28:44.064779 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannedUsers".
20:28:44.064992 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_BannedUsers: 
  
  if object_id ('"dbo"."AH_BannedUsers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_BannedUsers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_BannedUsers__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_BannedUsers__dbt_tmp"
    end


   EXEC('create view dbo.AH_BannedUsers__dbt_tmp_temp_view as
    
Select
	cast([Lastip] as nvarchar(4000)) [LastIP],
	cast([UserName] as nvarchar(4000)) [UserName],
	cast([FName] as nvarchar(4000)) [FName],
	cast([LName] as nvarchar(4000)) [LName],
	cast([IsLockedOut] as bit) [IsLockedOut],
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId] 
From stg.[AH_BannedUsers_FinalView]
    ');

  CREATE TABLE "dbo"."AH_BannedUsers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_BannedUsers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_BannedUsers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_BannedUsers__dbt_tmp_temp_view"
    end



20:28:44.065097 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:28:44.065216 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:44.141390 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_BannerCategories"
20:28:44.152171 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannerCategories".
20:28:44.152317 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_BannerCategories: 
  
  if object_id ('"dbo"."AH_BannerCategories__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_BannerCategories__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_BannerCategories__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_BannerCategories__dbt_tmp"
    end


   EXEC('create view dbo.AH_BannerCategories__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([BannerID] as int) [BannerId],
	cast([CategoryID] as int) [CategoryId] 
From stg.[AH_BannerCategories_FinalView]
    ');

  CREATE TABLE "dbo"."AH_BannerCategories__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_BannerCategories__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_BannerCategories__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_BannerCategories__dbt_tmp_temp_view"
    end



20:28:44.152408 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:28:44.152514 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:44.145688 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_BiddingTransactions"
20:28:44.153655 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BiddingTransactions".
20:28:44.153795 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_BiddingTransactions: 
  
  if object_id ('"dbo"."AH_BiddingTransactions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_BiddingTransactions__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_BiddingTransactions__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_BiddingTransactions__dbt_tmp"
    end


   EXEC('create view dbo.AH_BiddingTransactions__dbt_tmp_temp_view as
    
Select
	cast([TransactionID] as nvarchar(30)) [TransactionId],
	cast([Maxmindscore] as decimal(5,2)) [MaxMindScore],
	cast([Amount] as decimal(24,2)) [Amount],
	cast([ID] as int) [Id],
	cast([ListingActionID] as int) [ListingActionId],
	cast([CreditCardID] as int) [CreditCardId],
	cast([Active] as bit) [Active] 
From stg.[AH_BiddingTransactions_FinalView]
    ');

  CREATE TABLE "dbo"."AH_BiddingTransactions__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_BiddingTransactions__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_BiddingTransactions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_BiddingTransactions__dbt_tmp_temp_view"
    end



20:28:44.153885 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:28:44.153985 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:44.151673 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Banners"
20:28:44.155322 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Banners".
20:28:44.155441 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Banners: 
  
  if object_id ('"dbo"."AH_Banners__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Banners__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Banners__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Banners__dbt_tmp"
    end


   EXEC('create view dbo.AH_Banners__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([MediaID] as int) [MediaId],
	cast([LinkURI] as nvarchar(4000)) [LinkURI],
	cast([BannerLocation] as nvarchar(4000)) [BannerLocation] 
From stg.[AH_Banners_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Banners__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Banners__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Banners__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Banners__dbt_tmp_temp_view"
    end



20:28:44.155521 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:28:44.155612 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:44.186566 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:44.254259 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:44.279964 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:44.280542 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:47.842890 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.69 seconds
20:28:47.858191 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BiddingTransactions".
20:28:47.858451 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_BiddingTransactions: rename object "dbo"."AH_BiddingTransactions" to AH_BiddingTransactions__dbt_backup
20:28:47.866866 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.71 seconds
20:28:47.880954 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Banners".
20:28:47.881184 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.73 seconds
20:28:47.881270 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.82 seconds
20:28:47.881403 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Banners: rename object "dbo"."AH_Banners" to AH_Banners__dbt_backup
20:28:47.895371 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannerCategories".
20:28:47.907540 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_BannerCategories: rename object "dbo"."AH_BannerCategories" to AH_BannerCategories__dbt_backup
20:28:47.895581 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:28:47.907263 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannedUsers".
20:28:47.919163 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_BannedUsers: rename object "dbo"."AH_BannedUsers" to AH_BannedUsers__dbt_backup
20:28:47.918907 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BiddingTransactions".
20:28:47.919446 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_BiddingTransactions: rename object "dbo"."AH_BiddingTransactions__dbt_tmp" to AH_BiddingTransactions
20:28:47.924257 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:28:47.936837 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Banners".
20:28:47.937092 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Banners: rename object "dbo"."AH_Banners__dbt_tmp" to AH_Banners
20:28:47.940084 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:28:47.952919 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannerCategories".
20:28:47.953142 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:28:47.953218 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:28:47.965084 [debug] [Thread-4  ]: On model.Shawn.AH_BiddingTransactions: COMMIT
20:28:47.953346 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_BannerCategories: rename object "dbo"."AH_BannerCategories__dbt_tmp" to AH_BannerCategories
20:28:47.967572 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannedUsers".
20:28:47.971056 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:28:47.972381 [debug] [Thread-2  ]: On model.Shawn.AH_Banners: COMMIT
20:28:47.971177 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_BannedUsers: rename object "dbo"."AH_BannedUsers__dbt_tmp" to AH_BannedUsers
20:28:47.970900 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BiddingTransactions".
20:28:47.976040 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_BiddingTransactions: 
    
  if object_id ('"dbo"."AH_BiddingTransactions__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_BiddingTransactions__dbt_backup"
    end

20:28:47.975732 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Banners".
20:28:47.976220 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Banners: 
    
  if object_id ('"dbo"."AH_Banners__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Banners__dbt_backup"
    end

20:28:47.994528 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:28:47.996616 [debug] [Thread-1  ]: On model.Shawn.AH_BannerCategories: COMMIT
20:28:48.000491 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannerCategories".
20:28:48.000670 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_BannerCategories: 
    
  if object_id ('"dbo"."AH_BannerCategories__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_BannerCategories__dbt_backup"
    end

20:28:48.003717 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:28:48.005283 [debug] [Thread-3  ]: On model.Shawn.AH_BannedUsers: COMMIT
20:28:48.009075 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannedUsers".
20:28:48.009218 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_BannedUsers: 
    
  if object_id ('"dbo"."AH_BannedUsers__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_BannedUsers__dbt_backup"
    end

20:28:48.495697 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.52 seconds
20:28:48.509115 [debug] [Thread-2  ]: finished collecting timing info
20:28:48.509441 [debug] [Thread-2  ]: On model.Shawn.AH_Banners: Close
20:28:48.510178 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c548eb0>]}
20:28:48.510628 [info ] [Thread-2  ]: 7 of 105 OK created table model dbo.AH_Banners.................................. [[32mOK[0m in 4.51s]
20:28:48.510954 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Banners
20:28:48.511102 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Categories
20:28:48.511483 [info ] [Thread-2  ]: 9 of 105 START table model dbo.AH_Categories.................................... [RUN]
20:28:48.511851 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Categories"
20:28:48.511957 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Categories
20:28:48.512052 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Categories
20:28:48.514698 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Categories"
20:28:48.515029 [debug] [Thread-2  ]: finished collecting timing info
20:28:48.515146 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Categories
20:28:48.548385 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.55 seconds
20:28:48.563204 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Categories"
20:28:48.563752 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories".
20:28:48.563889 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories: 
  
  if object_id ('"dbo"."AH_Categories__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Categories__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Categories__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Categories__dbt_tmp"
    end


   EXEC('create view dbo.AH_Categories__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([ParentCategoryID] as int) [ParentCategoryId],
	cast([DisplayOrder] as int) [DisplayOrder],
	cast([Lft] as int) [lft],
	cast([Rgt] as int) [rgt],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([RolesAllowed] as nvarchar(100)) [RolesAllowed],
	cast([EnabledCustomProperty] as nvarchar(100)) [EnabledCustomProperty],
	cast([MetaKeyWords] as nvarchar(4000)) [MetaKeywords],
	cast([MetaDescription] as nvarchar(4000)) [MetaDescription],
	cast([PageTitle] as nvarchar(4000)) [PageTitle],
	cast([Pagecontent] as nvarchar(4000)) [PageContent],
	cast([Name] as nvarchar(500)) [Name],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([Type] as nvarchar(50)) [Type],
	cast([MvcAction] as nvarchar(100)) [MVCAction] 
From stg.[AH_Categories_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Categories__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Categories__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Categories__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Categories__dbt_tmp_temp_view"
    end



20:28:48.563975 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:28:48.564084 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:48.567031 [debug] [Thread-1  ]: finished collecting timing info
20:28:48.567575 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.59 seconds
20:28:48.567701 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.56 seconds
20:28:48.567892 [debug] [Thread-1  ]: On model.Shawn.AH_BannerCategories: Close
20:28:48.576488 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c557190>]}
20:28:48.576884 [info ] [Thread-1  ]: 6 of 105 OK created table model dbo.AH_BannerCategories......................... [[32mOK[0m in 4.58s]
20:28:48.577184 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_BannerCategories
20:28:48.577333 [debug] [Thread-1  ]: Began running node model.Shawn.AH_CategoryCount
20:28:48.577670 [info ] [Thread-1  ]: 10 of 105 START table model dbo.AH_CategoryCount................................ [RUN]
20:28:48.578035 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_CategoryCount"
20:28:48.578157 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_CategoryCount
20:28:48.578254 [debug] [Thread-1  ]: Compiling model.Shawn.AH_CategoryCount
20:28:48.580765 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_CategoryCount"
20:28:48.587409 [debug] [Thread-4  ]: finished collecting timing info
20:28:48.676500 [debug] [Thread-4  ]: On model.Shawn.AH_BiddingTransactions: Close
20:28:48.677359 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c8d7070>]}
20:28:48.677796 [info ] [Thread-4  ]: 8 of 105 OK created table model dbo.AH_BiddingTransactions...................... [[32mOK[0m in 4.68s]
20:28:48.678110 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_BiddingTransactions
20:28:48.587635 [debug] [Thread-1  ]: finished collecting timing info
20:28:48.678578 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_CategoryCount
20:28:48.678265 [debug] [Thread-4  ]: Began running node model.Shawn.AH_CategoryCustomFields
20:28:48.680236 [info ] [Thread-4  ]: 11 of 105 START table model dbo.AH_CategoryCustomFields......................... [RUN]
20:28:48.680645 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_CategoryCustomFields"
20:28:48.680751 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_CategoryCustomFields
20:28:48.680844 [debug] [Thread-4  ]: Compiling model.Shawn.AH_CategoryCustomFields
20:28:48.683600 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_CategoryCustomFields"
20:28:48.698661 [debug] [Thread-4  ]: finished collecting timing info
20:28:48.698880 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_CategoryCustomFields
20:28:48.688395 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:48.706518 [debug] [Thread-3  ]: finished collecting timing info
20:28:48.725977 [debug] [Thread-3  ]: On model.Shawn.AH_BannedUsers: Close
20:28:48.726838 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c37bee0>]}
20:28:48.736086 [info ] [Thread-3  ]: 5 of 105 OK created table model dbo.AH_BannedUsers.............................. [[32mOK[0m in 4.77s]
20:28:48.736524 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_BannedUsers
20:28:48.736666 [debug] [Thread-3  ]: Began running node model.Shawn.AH_CategoryListingTypes
20:28:48.736844 [info ] [Thread-3  ]: 12 of 105 START table model dbo.AH_CategoryListingTypes......................... [RUN]
20:28:48.737253 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_CategoryListingTypes"
20:28:48.737371 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_CategoryListingTypes
20:28:48.737468 [debug] [Thread-3  ]: Compiling model.Shawn.AH_CategoryListingTypes
20:28:48.740412 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_CategoryListingTypes"
20:28:48.748102 [debug] [Thread-3  ]: finished collecting timing info
20:28:48.748251 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_CategoryListingTypes
20:28:48.763647 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_CategoryCount"
20:28:48.771210 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCount".
20:28:48.771382 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryCount: 
  
  if object_id ('"dbo"."AH_CategoryCount__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryCount__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CategoryCount__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CategoryCount__dbt_tmp"
    end


   EXEC('create view dbo.AH_CategoryCount__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([Count] as int) [Count],
	cast([CategoryID] as int) [CategoryId] 
From stg.[AH_CategoryCount_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CategoryCount__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CategoryCount__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CategoryCount__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryCount__dbt_tmp_temp_view"
    end



20:28:48.771478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:28:48.771584 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:48.801829 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_CategoryCustomFields"
20:28:48.802372 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCustomFields".
20:28:48.802527 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CategoryCustomFields: 
  
  if object_id ('"dbo"."AH_CategoryCustomFields__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryCustomFields__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CategoryCustomFields__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CategoryCustomFields__dbt_tmp"
    end


   EXEC('create view dbo.AH_CategoryCustomFields__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([CategoryID] as int) [CategoryId],
	cast([CustomFieldID] as int) [CustomFieldId],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_CategoryCustomFields_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CategoryCustomFields__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CategoryCustomFields__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CategoryCustomFields__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryCustomFields__dbt_tmp_temp_view"
    end



20:28:48.802659 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:28:48.802773 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:48.820285 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_CategoryListingTypes"
20:28:48.820779 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListingTypes".
20:28:48.820919 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CategoryListingTypes: 
  
  if object_id ('"dbo"."AH_CategoryListingTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryListingTypes__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CategoryListingTypes__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CategoryListingTypes__dbt_tmp"
    end


   EXEC('create view dbo.AH_CategoryListingTypes__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([CategoryID] as int) [CategoryId],
	cast([ListingTypeID] as int) [ListingTypeId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_CategoryListingTypes_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CategoryListingTypes__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CategoryListingTypes__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CategoryListingTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryListingTypes__dbt_tmp_temp_view"
    end



20:28:48.821013 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:28:48.821122 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:48.886956 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:48.909692 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:48.935133 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:50.991853 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.22 seconds
20:28:51.007012 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCount".
20:28:51.007272 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryCount: rename object "dbo"."AH_CategoryCount" to AH_CategoryCount__dbt_backup
20:28:51.035707 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:28:51.043711 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.48 seconds
20:28:51.050763 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCount".
20:28:51.059842 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryCount: rename object "dbo"."AH_CategoryCount__dbt_tmp" to AH_CategoryCount
20:28:51.064474 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories".
20:28:51.064738 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories: rename object "dbo"."AH_Categories" to AH_Categories__dbt_backup
20:28:51.095846 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:28:51.098027 [debug] [Thread-1  ]: On model.Shawn.AH_CategoryCount: COMMIT
20:28:51.102512 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCount".
20:28:51.102809 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:28:51.102944 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryCount: 
    
  if object_id ('"dbo"."AH_CategoryCount__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CategoryCount__dbt_backup"
    end

20:28:51.116416 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories".
20:28:51.116626 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories: rename object "dbo"."AH_Categories__dbt_tmp" to AH_Categories
20:28:51.146674 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:28:51.148560 [debug] [Thread-2  ]: On model.Shawn.AH_Categories: COMMIT
20:28:51.153044 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories".
20:28:51.153246 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories: 
    
  if object_id ('"dbo"."AH_Categories__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Categories__dbt_backup"
    end

20:28:51.262201 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.44 seconds
20:28:51.276786 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListingTypes".
20:28:51.277055 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CategoryListingTypes: rename object "dbo"."AH_CategoryListingTypes" to AH_CategoryListingTypes__dbt_backup
20:28:51.289394 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:28:51.301958 [debug] [Thread-1  ]: finished collecting timing info
20:28:51.302313 [debug] [Thread-1  ]: On model.Shawn.AH_CategoryCount: Close
20:28:51.303119 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c37baf0>]}
20:28:51.303559 [info ] [Thread-1  ]: 10 of 105 OK created table model dbo.AH_CategoryCount........................... [[32mOK[0m in 2.73s]
20:28:51.303881 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_CategoryCount
20:28:51.304053 [debug] [Thread-1  ]: Began running node model.Shawn.AH_CategoryListings
20:28:51.304417 [info ] [Thread-1  ]: 13 of 105 START table model dbo.AH_CategoryListings............................. [RUN]
20:28:51.304809 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_CategoryListings"
20:28:51.304919 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_CategoryListings
20:28:51.305018 [debug] [Thread-1  ]: Compiling model.Shawn.AH_CategoryListings
20:28:51.307657 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_CategoryListings"
20:28:51.308002 [debug] [Thread-1  ]: finished collecting timing info
20:28:51.308196 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_CategoryListings
20:28:51.344912 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_CategoryListings"
20:28:51.345460 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListings".
20:28:51.345605 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryListings: 
  
  if object_id ('"dbo"."AH_CategoryListings__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryListings__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CategoryListings__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CategoryListings__dbt_tmp"
    end


   EXEC('create view dbo.AH_CategoryListings__dbt_tmp_temp_view as
    
Select
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([ID] as int) [Id],
	cast([ListingID] as int) [ListingId],
	cast([CategoryID] as int) [CategoryId] 
From stg.[AH_CategoryListings_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CategoryListings__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CategoryListings__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CategoryListings__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryListings__dbt_tmp_temp_view"
    end



20:28:51.345691 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:28:51.345797 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:51.463117 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:28:51.476504 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListingTypes".
20:28:51.476766 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CategoryListingTypes: rename object "dbo"."AH_CategoryListingTypes__dbt_tmp" to AH_CategoryListingTypes
20:28:51.480905 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:51.504679 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:28:51.506530 [debug] [Thread-3  ]: On model.Shawn.AH_CategoryListingTypes: COMMIT
20:28:51.510970 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListingTypes".
20:28:51.511155 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CategoryListingTypes: 
    
  if object_id ('"dbo"."AH_CategoryListingTypes__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CategoryListingTypes__dbt_backup"
    end

20:28:51.542567 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
20:28:51.556187 [debug] [Thread-2  ]: finished collecting timing info
20:28:51.556509 [debug] [Thread-2  ]: On model.Shawn.AH_Categories: Close
20:28:51.557243 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c557580>]}
20:28:51.557662 [info ] [Thread-2  ]: 9 of 105 OK created table model dbo.AH_Categories............................... [[32mOK[0m in 3.05s]
20:28:51.557995 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Categories
20:28:51.558154 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Contactus
20:28:51.558512 [info ] [Thread-2  ]: 14 of 105 START table model dbo.AH_Contactus.................................... [RUN]
20:28:51.558923 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Contactus"
20:28:51.559032 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Contactus
20:28:51.559130 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Contactus
20:28:51.561628 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Contactus"
20:28:51.561947 [debug] [Thread-2  ]: finished collecting timing info
20:28:51.562058 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Contactus
20:28:51.597996 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Contactus"
20:28:51.598531 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contactus".
20:28:51.598741 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Contactus: 
  
  if object_id ('"dbo"."AH_Contactus__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Contactus__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Contactus__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Contactus__dbt_tmp"
    end


   EXEC('create view dbo.AH_Contactus__dbt_tmp_temp_view as
    
Select
	cast([Email] as nvarchar(4000)) [Email],
	cast([FirstName] as nvarchar(4000)) [FirstName],
	cast([LastName] as nvarchar(4000)) [LastName],
	cast([Message] as nvarchar(4000)) [Message],
	cast([ID] as int) [Id] 
From stg.[AH_Contactus_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Contactus__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Contactus__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Contactus__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Contactus__dbt_tmp_temp_view"
    end



20:28:51.598825 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:28:51.598934 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:51.695857 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:51.708890 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:28:51.722340 [debug] [Thread-3  ]: finished collecting timing info
20:28:51.722681 [debug] [Thread-3  ]: On model.Shawn.AH_CategoryListingTypes: Close
20:28:51.723407 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c4cb9a0>]}
20:28:51.723884 [info ] [Thread-3  ]: 12 of 105 OK created table model dbo.AH_CategoryListingTypes.................... [[32mOK[0m in 2.99s]
20:28:51.724207 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_CategoryListingTypes
20:28:51.724356 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Contents
20:28:51.724702 [info ] [Thread-3  ]: 15 of 105 START table model dbo.AH_Contents..................................... [RUN]
20:28:51.725091 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Contents"
20:28:51.725200 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Contents
20:28:51.725296 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Contents
20:28:51.727844 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Contents"
20:28:51.728158 [debug] [Thread-3  ]: finished collecting timing info
20:28:51.728269 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Contents
20:28:51.764061 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Contents"
20:28:51.764592 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contents".
20:28:51.764741 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Contents: 
  
  if object_id ('"dbo"."AH_Contents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Contents__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Contents__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Contents__dbt_tmp"
    end


   EXEC('create view dbo.AH_Contents__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([DisplayOrder] as int) [DisplayOrder],
	cast([Usehtmleditor] as bit) [UseHTMLEditor],
	cast([Userdefined] as bit) [UserDefined],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Text] as nvarchar(4000)) [Text],
	cast([Name] as nvarchar(4000)) [Name],
	cast([Culture] as nvarchar(4000)) [Culture],
	cast([PageTitle] as nvarchar(4000)) [PageTitle] 
From stg.[AH_Contents_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Contents__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Contents__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Contents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Contents__dbt_tmp_temp_view"
    end



20:28:51.764826 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:28:51.764930 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:51.873946 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:53.480134 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.13 seconds
20:28:53.494778 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListings".
20:28:53.495043 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryListings: rename object "dbo"."AH_CategoryListings" to AH_CategoryListings__dbt_backup
20:28:53.532700 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:28:53.623331 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListings".
20:28:53.623606 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryListings: rename object "dbo"."AH_CategoryListings__dbt_tmp" to AH_CategoryListings
20:28:53.679161 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:28:53.681015 [debug] [Thread-1  ]: On model.Shawn.AH_CategoryListings: COMMIT
20:28:53.685369 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListings".
20:28:53.685544 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryListings: 
    
  if object_id ('"dbo"."AH_CategoryListings__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CategoryListings__dbt_backup"
    end

20:28:53.787768 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.19 seconds
20:28:53.802483 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contactus".
20:28:53.802783 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Contactus: rename object "dbo"."AH_Contactus" to AH_Contactus__dbt_backup
20:28:54.132014 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
20:28:54.146125 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contactus".
20:28:54.146392 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Contactus: rename object "dbo"."AH_Contactus__dbt_tmp" to AH_Contactus
20:28:54.193858 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:28:54.195642 [debug] [Thread-2  ]: On model.Shawn.AH_Contactus: COMMIT
20:28:54.199744 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contactus".
20:28:54.199919 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Contactus: 
    
  if object_id ('"dbo"."AH_Contactus__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Contactus__dbt_backup"
    end

20:28:54.760355 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.00 seconds
20:28:54.775575 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contents".
20:28:54.775845 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Contents: rename object "dbo"."AH_Contents" to AH_Contents__dbt_backup
20:28:54.806852 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:28:54.818973 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.13 seconds
20:28:54.823131 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contents".
20:28:54.831775 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Contents: rename object "dbo"."AH_Contents__dbt_tmp" to AH_Contents
20:28:54.834152 [debug] [Thread-1  ]: finished collecting timing info
20:28:54.834416 [debug] [Thread-1  ]: On model.Shawn.AH_CategoryListings: Close
20:28:54.835187 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c775610>]}
20:28:54.835617 [info ] [Thread-1  ]: 13 of 105 OK created table model dbo.AH_CategoryListings........................ [[32mOK[0m in 3.53s]
20:28:54.835942 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_CategoryListings
20:28:54.836093 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Countries
20:28:54.836463 [info ] [Thread-1  ]: 16 of 105 START table model dbo.AH_Countries.................................... [RUN]
20:28:54.836880 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Countries"
20:28:54.836990 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Countries
20:28:54.837088 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Countries
20:28:54.840064 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Countries"
20:28:54.840228 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.64 seconds
20:28:54.851919 [debug] [Thread-1  ]: finished collecting timing info
20:28:54.852149 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Countries
20:28:54.854351 [debug] [Thread-2  ]: finished collecting timing info
20:28:54.863964 [debug] [Thread-2  ]: On model.Shawn.AH_Contactus: Close
20:28:54.864670 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c93d4c0>]}
20:28:54.865067 [info ] [Thread-2  ]: 14 of 105 OK created table model dbo.AH_Contactus............................... [[32mOK[0m in 3.31s]
20:28:54.865370 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Contactus
20:28:54.863692 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:28:54.867062 [debug] [Thread-3  ]: On model.Shawn.AH_Contents: COMMIT
20:28:54.865520 [debug] [Thread-2  ]: Began running node model.Shawn.AH_CreditCardTypes
20:28:54.871249 [info ] [Thread-2  ]: 17 of 105 START table model dbo.AH_CreditCardTypes.............................. [RUN]
20:28:54.871657 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_CreditCardTypes"
20:28:54.871770 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_CreditCardTypes
20:28:54.871866 [debug] [Thread-2  ]: Compiling model.Shawn.AH_CreditCardTypes
20:28:54.874237 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_CreditCardTypes"
20:28:54.870945 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contents".
20:28:54.884855 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Contents: 
    
  if object_id ('"dbo"."AH_Contents__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Contents__dbt_backup"
    end

20:28:54.874585 [debug] [Thread-2  ]: finished collecting timing info
20:28:54.885257 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_CreditCardTypes
20:28:54.923611 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Countries"
20:28:54.924170 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Countries".
20:28:54.924329 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Countries: 
  
  if object_id ('"dbo"."AH_Countries__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Countries__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Countries__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Countries__dbt_tmp"
    end


   EXEC('create view dbo.AH_Countries__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(500)) [Name],
	cast([Code] as char(5)) [Code],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([Enabled] as bit) [Enabled],
	cast([StateRequired] as bit) [StateRequired] 
From stg.[AH_Countries_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Countries__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Countries__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Countries__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Countries__dbt_tmp_temp_view"
    end



20:28:54.924414 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:28:54.924522 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:54.940345 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_CreditCardTypes"
20:28:54.940857 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardTypes".
20:28:54.941000 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CreditCardTypes: 
  
  if object_id ('"dbo"."AH_CreditCardTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CreditCardTypes__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CreditCardTypes__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CreditCardTypes__dbt_tmp"
    end


   EXEC('create view dbo.AH_CreditCardTypes__dbt_tmp_temp_view as
    
Select
	cast([Enabled] as bit) [Enabled],
	cast([ID] as int) [Id],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_CreditCardTypes_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CreditCardTypes__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CreditCardTypes__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CreditCardTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CreditCardTypes__dbt_tmp_temp_view"
    end



20:28:54.941085 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:28:54.941191 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:55.073337 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:55.083326 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:55.120467 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:28:55.133449 [debug] [Thread-3  ]: finished collecting timing info
20:28:55.133789 [debug] [Thread-3  ]: On model.Shawn.AH_Contents: Close
20:28:55.134584 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c4ab970>]}
20:28:55.135048 [info ] [Thread-3  ]: 15 of 105 OK created table model dbo.AH_Contents................................ [[32mOK[0m in 3.41s]
20:28:55.135361 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Contents
20:28:55.135509 [debug] [Thread-3  ]: Began running node model.Shawn.AH_CreditCards
20:28:55.135847 [info ] [Thread-3  ]: 18 of 105 START table model dbo.AH_CreditCards.................................. [RUN]
20:28:55.136224 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_CreditCards"
20:28:55.136338 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_CreditCards
20:28:55.136431 [debug] [Thread-3  ]: Compiling model.Shawn.AH_CreditCards
20:28:55.139103 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_CreditCards"
20:28:55.139441 [debug] [Thread-3  ]: finished collecting timing info
20:28:55.139629 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_CreditCards
20:28:55.176358 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_CreditCards"
20:28:55.176916 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards".
20:28:55.177065 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CreditCards: 
  
  if object_id ('"dbo"."AH_CreditCards__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CreditCards__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CreditCards__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CreditCards__dbt_tmp"
    end


   EXEC('create view dbo.AH_CreditCards__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([ExpirationMonth] as nvarchar(4000)) [ExpirationMonth],
	cast([ExpirationYear] as nvarchar(4000)) [ExpirationYear],
	cast([CreditCardTypeID] as int) [CreditCardTypeId],
	cast([UserID] as int) [UserId],
	cast([AddressID] as int) [AddressId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CardNumber] as nvarchar(4000)) [CardNumber],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([LastFourdigits] as nvarchar(4000)) [LastFourDigits],
	cast([Description] as nvarchar(4000)) [Description] 
From stg.[AH_CreditCards_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CreditCards__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CreditCards__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CreditCards__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CreditCards__dbt_tmp_temp_view"
    end



20:28:55.177154 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:28:55.177263 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:55.310804 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:57.387938 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.46 seconds
20:28:57.402684 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Countries".
20:28:57.402959 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Countries: rename object "dbo"."AH_Countries" to AH_Countries__dbt_backup
20:28:57.451642 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:28:57.465644 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Countries".
20:28:57.465922 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Countries: rename object "dbo"."AH_Countries__dbt_tmp" to AH_Countries
20:28:57.495283 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:28:57.497198 [debug] [Thread-1  ]: On model.Shawn.AH_Countries: COMMIT
20:28:57.501964 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Countries".
20:28:57.502217 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Countries: 
    
  if object_id ('"dbo"."AH_Countries__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Countries__dbt_backup"
    end

20:28:57.909207 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
20:28:57.922936 [debug] [Thread-1  ]: finished collecting timing info
20:28:57.923375 [debug] [Thread-1  ]: On model.Shawn.AH_Countries: Close
20:28:57.924204 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c557d60>]}
20:28:57.924620 [info ] [Thread-1  ]: 16 of 105 OK created table model dbo.AH_Countries............................... [[32mOK[0m in 3.09s]
20:28:57.924934 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Countries
20:28:57.925094 [debug] [Thread-1  ]: Began running node model.Shawn.AH_CreditCardsExtraInFormation
20:28:57.925460 [info ] [Thread-1  ]: 19 of 105 START table model dbo.AH_CreditCardsExtraInFormation.................. [RUN]
20:28:57.925862 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_CreditCardsExtraInFormation"
20:28:57.925973 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_CreditCardsExtraInFormation
20:28:57.926138 [debug] [Thread-1  ]: Compiling model.Shawn.AH_CreditCardsExtraInFormation
20:28:57.929779 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_CreditCardsExtraInFormation"
20:28:57.930147 [debug] [Thread-1  ]: finished collecting timing info
20:28:57.930574 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_CreditCardsExtraInFormation
20:28:57.970719 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_CreditCardsExtraInFormation"
20:28:57.971272 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardsExtraInFormation".
20:28:57.971416 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCardsExtraInFormation: 
  
  if object_id ('"dbo"."AH_CreditCardsExtraInFormation__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CreditCardsExtraInFormation__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CreditCardsExtraInFormation__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CreditCardsExtraInFormation__dbt_tmp"
    end


   EXEC('create view dbo.AH_CreditCardsExtraInFormation__dbt_tmp_temp_view as
    
Select
	cast([Cvv] as nvarchar(4000)) [CVV],
	cast([ID] as int) [Id],
	cast([CreditCardID] as int) [CreditCardId] 
From stg.[AH_CreditCardsExtraInFormation_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CreditCardsExtraInFormation__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CreditCardsExtraInFormation__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CreditCardsExtraInFormation__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CreditCardsExtraInFormation__dbt_tmp_temp_view"
    end



20:28:57.971504 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:28:57.971625 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:58.052284 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.11 seconds
20:28:58.067845 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardTypes".
20:28:58.068122 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CreditCardTypes: rename object "dbo"."AH_CreditCardTypes" to AH_CreditCardTypes__dbt_backup
20:28:58.085427 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:58.105473 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.93 seconds
20:28:58.120343 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards".
20:28:58.120643 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CreditCards: rename object "dbo"."AH_CreditCards" to AH_CreditCards__dbt_backup
20:28:58.123867 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:28:58.137254 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardTypes".
20:28:58.137528 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CreditCardTypes: rename object "dbo"."AH_CreditCardTypes__dbt_tmp" to AH_CreditCardTypes
20:28:58.175159 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:28:58.183806 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:28:58.185483 [debug] [Thread-2  ]: On model.Shawn.AH_CreditCardTypes: COMMIT
20:28:58.192037 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards".
20:28:58.196254 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CreditCards: rename object "dbo"."AH_CreditCards__dbt_tmp" to AH_CreditCards
20:28:58.195987 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardTypes".
20:28:58.196525 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CreditCardTypes: 
    
  if object_id ('"dbo"."AH_CreditCardTypes__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CreditCardTypes__dbt_backup"
    end

20:28:58.234579 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:28:58.236463 [debug] [Thread-3  ]: On model.Shawn.AH_CreditCards: COMMIT
20:28:58.240950 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards".
20:28:58.241157 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CreditCards: 
    
  if object_id ('"dbo"."AH_CreditCards__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CreditCards__dbt_backup"
    end

20:28:58.409152 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:28:58.422780 [debug] [Thread-2  ]: finished collecting timing info
20:28:58.423129 [debug] [Thread-2  ]: On model.Shawn.AH_CreditCardTypes: Close
20:28:58.423884 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c49b0a0>]}
20:28:58.424294 [info ] [Thread-2  ]: 17 of 105 OK created table model dbo.AH_CreditCardTypes......................... [[32mOK[0m in 3.55s]
20:28:58.424598 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_CreditCardTypes
20:28:58.424761 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Currencies
20:28:58.425121 [info ] [Thread-2  ]: 20 of 105 START table model dbo.AH_Currencies................................... [RUN]
20:28:58.425498 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Currencies"
20:28:58.425608 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Currencies
20:28:58.425703 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Currencies
20:28:58.428290 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Currencies"
20:28:58.428622 [debug] [Thread-2  ]: finished collecting timing info
20:28:58.428735 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Currencies
20:28:58.464972 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Currencies"
20:28:58.465509 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies".
20:28:58.465654 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Currencies: 
  
  if object_id ('"dbo"."AH_Currencies__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Currencies__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Currencies__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Currencies__dbt_tmp"
    end


   EXEC('create view dbo.AH_Currencies__dbt_tmp_temp_view as
    
Select
	cast([Code] as nvarchar(4000)) [Code],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([ConVersiontousd] as numeric(19,4)) [ConversionToUSD] 
From stg.[AH_Currencies_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Currencies__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Currencies__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Currencies__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Currencies__dbt_tmp_temp_view"
    end



20:28:58.465747 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:28:58.465854 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:58.725064 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:28:58.845096 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.60 seconds
20:28:58.858970 [debug] [Thread-3  ]: finished collecting timing info
20:28:58.859312 [debug] [Thread-3  ]: On model.Shawn.AH_CreditCards: Close
20:28:58.860094 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c551040>]}
20:28:58.860515 [info ] [Thread-3  ]: 18 of 105 OK created table model dbo.AH_CreditCards............................. [[32mOK[0m in 3.72s]
20:28:58.860827 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_CreditCards
20:28:58.860985 [debug] [Thread-3  ]: Began running node model.Shawn.AH_CustomFieldenums
20:28:58.861356 [info ] [Thread-3  ]: 21 of 105 START table model dbo.AH_CustomFieldenums............................. [RUN]
20:28:58.861748 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_CustomFieldenums"
20:28:58.861859 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_CustomFieldenums
20:28:58.861960 [debug] [Thread-3  ]: Compiling model.Shawn.AH_CustomFieldenums
20:28:58.864750 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_CustomFieldenums"
20:28:58.865191 [debug] [Thread-3  ]: finished collecting timing info
20:28:58.865333 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_CustomFieldenums
20:28:58.901959 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_CustomFieldenums"
20:28:58.902524 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFieldenums".
20:28:58.902716 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CustomFieldenums: 
  
  if object_id ('"dbo"."AH_CustomFieldenums__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CustomFieldenums__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CustomFieldenums__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CustomFieldenums__dbt_tmp"
    end


   EXEC('create view dbo.AH_CustomFieldenums__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([Value] as nvarchar(4000)) [Value],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([CustomFieldID] as int) [CustomFieldId],
	cast([Enabled] as bit) [Enabled] 
From stg.[AH_CustomFieldenums_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CustomFieldenums__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CustomFieldenums__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CustomFieldenums__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CustomFieldenums__dbt_tmp_temp_view"
    end



20:28:58.902805 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:28:58.902926 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:28:59.040870 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:00.602340 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.63 seconds
20:29:00.617619 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardsExtraInFormation".
20:29:00.617891 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCardsExtraInFormation: rename object "dbo"."AH_CreditCardsExtraInFormation" to AH_CreditCardsExtraInFormation__dbt_backup
20:29:00.672346 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:29:00.686341 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardsExtraInFormation".
20:29:00.686653 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCardsExtraInFormation: rename object "dbo"."AH_CreditCardsExtraInFormation__dbt_tmp" to AH_CreditCardsExtraInFormation
20:29:00.738937 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:29:00.740867 [debug] [Thread-1  ]: On model.Shawn.AH_CreditCardsExtraInFormation: COMMIT
20:29:00.745432 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardsExtraInFormation".
20:29:00.745649 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCardsExtraInFormation: 
    
  if object_id ('"dbo"."AH_CreditCardsExtraInFormation__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CreditCardsExtraInFormation__dbt_backup"
    end

20:29:00.898947 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.43 seconds
20:29:00.913780 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies".
20:29:00.914055 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Currencies: rename object "dbo"."AH_Currencies" to AH_Currencies__dbt_backup
20:29:00.975083 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:29:01.066003 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
20:29:01.067577 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.16 seconds
20:29:01.087468 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies".
20:29:01.101953 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Currencies: rename object "dbo"."AH_Currencies__dbt_tmp" to AH_Currencies
20:29:01.093369 [debug] [Thread-1  ]: finished collecting timing info
20:29:01.102296 [debug] [Thread-1  ]: On model.Shawn.AH_CreditCardsExtraInFormation: Close
20:29:01.103196 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c551190>]}
20:29:01.103600 [info ] [Thread-1  ]: 19 of 105 OK created table model dbo.AH_CreditCardsExtraInFormation............. [[32mOK[0m in 3.18s]
20:29:01.103900 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_CreditCardsExtraInFormation
20:29:01.104048 [debug] [Thread-1  ]: Began running node model.Shawn.AH_CustomFields
20:29:01.104397 [info ] [Thread-1  ]: 22 of 105 START table model dbo.AH_CustomFields................................. [RUN]
20:29:01.104766 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_CustomFields"
20:29:01.104872 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_CustomFields
20:29:01.104965 [debug] [Thread-1  ]: Compiling model.Shawn.AH_CustomFields
20:29:01.101646 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFieldenums".
20:29:01.108048 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CustomFieldenums: rename object "dbo"."AH_CustomFieldenums" to AH_CustomFieldenums__dbt_backup
20:29:01.107796 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_CustomFields"
20:29:01.108491 [debug] [Thread-1  ]: finished collecting timing info
20:29:01.108612 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_CustomFields
20:29:01.145511 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_CustomFields"
20:29:01.146073 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFields".
20:29:01.146219 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CustomFields: 
  
  if object_id ('"dbo"."AH_CustomFields__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CustomFields__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CustomFields__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CustomFields__dbt_tmp"
    end


   EXEC('create view dbo.AH_CustomFields__dbt_tmp_temp_view as
    
Select
	cast([Required] as bit) [Required],
	cast([Deferred] as bit) [Deferred],
	cast([Encrypted] as bit) [Encrypted],
	cast([IncludeonInvoice] as bit) [IncludeOnInvoice],
	cast([IncludeinSalesReport] as bit) [IncludeInSalesReport],
	cast([IncludeonInvoiceasSeller] as bit) [IncludeOnInvoiceAsSeller],
	cast([IncludeonInvoiceasBuyer] as bit) [IncludeOnInvoiceAsBuyer],
	cast([IncludeinSalesReportasSeller] as bit) [IncludeInSalesReportAsSeller],
	cast([IncludeinSalesReportasBuyer] as bit) [IncludeInSalesReportAsBuyer],
	cast([ID] as int) [Id],
	cast([Type] as int) [Type],
	cast([DisplayOrder] as int) [DisplayOrder],
	cast([VisiBIlity] as int) [Visibility],
	cast([MutaBIlity] as int) [Mutability],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(500)) [Name],
	cast([DefaultValue] as nvarchar(300)) [DefaultValue],
	cast([GroupName] as nvarchar(500)) [GroupName],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser] 
From stg.[AH_CustomFields_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CustomFields__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CustomFields__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CustomFields__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CustomFields__dbt_tmp_temp_view"
    end



20:29:01.146306 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:01.146417 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:01.147290 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:29:01.148874 [debug] [Thread-2  ]: On model.Shawn.AH_Currencies: COMMIT
20:29:01.154083 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies".
20:29:01.154275 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:29:01.154399 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Currencies: 
    
  if object_id ('"dbo"."AH_Currencies__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Currencies__dbt_backup"
    end

20:29:01.169716 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFieldenums".
20:29:01.169974 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CustomFieldenums: rename object "dbo"."AH_CustomFieldenums__dbt_tmp" to AH_CustomFieldenums
20:29:01.197806 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:01.199713 [debug] [Thread-3  ]: On model.Shawn.AH_CustomFieldenums: COMMIT
20:29:01.204561 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFieldenums".
20:29:01.204782 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CustomFieldenums: 
    
  if object_id ('"dbo"."AH_CustomFieldenums__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CustomFieldenums__dbt_backup"
    end

20:29:01.244311 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:01.515273 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
20:29:01.528414 [debug] [Thread-2  ]: finished collecting timing info
20:29:01.528769 [debug] [Thread-2  ]: On model.Shawn.AH_Currencies: Close
20:29:01.529559 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c6c9970>]}
20:29:01.529985 [info ] [Thread-2  ]: 20 of 105 OK created table model dbo.AH_Currencies.............................. [[32mOK[0m in 3.10s]
20:29:01.530292 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Currencies
20:29:01.530452 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Customcurrencies
20:29:01.530848 [info ] [Thread-2  ]: 23 of 105 START table model dbo.AH_Customcurrencies............................. [RUN]
20:29:01.531238 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Customcurrencies"
20:29:01.531347 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Customcurrencies
20:29:01.531445 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Customcurrencies
20:29:01.534043 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Customcurrencies"
20:29:01.534379 [debug] [Thread-2  ]: finished collecting timing info
20:29:01.534492 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Customcurrencies
20:29:01.570906 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Customcurrencies"
20:29:01.571450 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Customcurrencies".
20:29:01.571595 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Customcurrencies: 
  
  if object_id ('"dbo"."AH_Customcurrencies__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Customcurrencies__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Customcurrencies__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Customcurrencies__dbt_tmp"
    end


   EXEC('create view dbo.AH_Customcurrencies__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Isocurrencysymbol] as nvarchar(4000)) [ISOCurrencySymbol],
	cast([Currencysymbol] as nvarchar(4000)) [CurrencySymbol],
	cast([CurrencyenglishName] as nvarchar(4000)) [CurrencyEnglishName],
	cast([CurrencynativeName] as nvarchar(4000)) [CurrencyNativeName] 
From stg.[AH_Customcurrencies_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Customcurrencies__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Customcurrencies__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Customcurrencies__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Customcurrencies__dbt_tmp_temp_view"
    end



20:29:01.571680 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:29:01.571794 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:01.685153 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:01.710789 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.51 seconds
20:29:01.724836 [debug] [Thread-3  ]: finished collecting timing info
20:29:01.725194 [debug] [Thread-3  ]: On model.Shawn.AH_CustomFieldenums: Close
20:29:01.725988 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c551430>]}
20:29:01.726426 [info ] [Thread-3  ]: 21 of 105 OK created table model dbo.AH_CustomFieldenums........................ [[32mOK[0m in 2.86s]
20:29:01.726832 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_CustomFieldenums
20:29:01.726987 [debug] [Thread-3  ]: Began running node model.Shawn.AH_DailyhuntEmailSubscribers
20:29:01.727355 [info ] [Thread-3  ]: 24 of 105 START table model dbo.AH_DailyhuntEmailSubscribers.................... [RUN]
20:29:01.727768 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_DailyhuntEmailSubscribers"
20:29:01.727880 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_DailyhuntEmailSubscribers
20:29:01.727976 [debug] [Thread-3  ]: Compiling model.Shawn.AH_DailyhuntEmailSubscribers
20:29:01.730716 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_DailyhuntEmailSubscribers"
20:29:01.731143 [debug] [Thread-3  ]: finished collecting timing info
20:29:01.731283 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_DailyhuntEmailSubscribers
20:29:01.768293 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_DailyhuntEmailSubscribers"
20:29:01.768841 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_DailyhuntEmailSubscribers".
20:29:01.768980 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_DailyhuntEmailSubscribers: 
  
  if object_id ('"dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp"
    end


   EXEC('create view dbo.AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view as
    
Select
	cast([Email] as nvarchar(4000)) [Email],
	cast([FirstName] as nvarchar(4000)) [FirstName],
	cast([LastName] as nvarchar(4000)) [LastName],
	cast([ID] as int) [Id],
	cast([ZipCode] as int) [ZipCode],
	cast([ASenthusiast] as bit) [AsEnthusiast],
	cast([AsBidder] as bit) [AsBidder],
	cast([AsConsignor] as bit) [AsConsignor] 
From stg.[AH_DailyhuntEmailSubscribers_FinalView]
    ');

  CREATE TABLE "dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view"
    end



20:29:01.769067 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:29:01.769177 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:01.867119 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:04.712842 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 15.91 seconds
20:29:04.721310 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.15 seconds
20:29:04.735359 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCustomFields".
20:29:04.744892 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CategoryCustomFields: rename object "dbo"."AH_CategoryCustomFields" to AH_CategoryCustomFields__dbt_backup
20:29:04.735644 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.97 seconds
20:29:04.744592 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Customcurrencies".
20:29:04.755809 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Customcurrencies: rename object "dbo"."AH_Customcurrencies" to AH_Customcurrencies__dbt_backup
20:29:04.759408 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_DailyhuntEmailSubscribers".
20:29:04.759618 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_DailyhuntEmailSubscribers: rename object "dbo"."AH_DailyhuntEmailSubscribers" to AH_DailyhuntEmailSubscribers__dbt_backup
20:29:04.779729 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:04.794828 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.65 seconds
20:29:04.803802 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:04.805055 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:29:04.806118 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCustomFields".
20:29:04.806257 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CategoryCustomFields: rename object "dbo"."AH_CategoryCustomFields__dbt_tmp" to AH_CategoryCustomFields
20:29:04.812805 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFields".
20:29:04.823942 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CustomFields: rename object "dbo"."AH_CustomFields" to AH_CustomFields__dbt_backup
20:29:04.909047 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:29:04.910290 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:29:04.911634 [debug] [Thread-4  ]: On model.Shawn.AH_CategoryCustomFields: COMMIT
20:29:04.918196 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_DailyhuntEmailSubscribers".
20:29:04.925930 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_DailyhuntEmailSubscribers: rename object "dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp" to AH_DailyhuntEmailSubscribers
20:29:04.930249 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCustomFields".
20:29:04.939834 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CategoryCustomFields: 
    
  if object_id ('"dbo"."AH_CategoryCustomFields__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CategoryCustomFields__dbt_backup"
    end

20:29:04.925651 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Customcurrencies".
20:29:04.940242 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Customcurrencies: rename object "dbo"."AH_Customcurrencies__dbt_tmp" to AH_Customcurrencies
20:29:04.943782 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFields".
20:29:04.944113 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CustomFields: rename object "dbo"."AH_CustomFields__dbt_tmp" to AH_CustomFields
20:29:04.959866 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:04.961482 [debug] [Thread-3  ]: On model.Shawn.AH_DailyhuntEmailSubscribers: COMMIT
20:29:04.965679 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_DailyhuntEmailSubscribers".
20:29:04.965897 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_DailyhuntEmailSubscribers: 
    
  if object_id ('"dbo"."AH_DailyhuntEmailSubscribers__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_DailyhuntEmailSubscribers__dbt_backup"
    end

20:29:04.969251 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:04.970980 [debug] [Thread-2  ]: On model.Shawn.AH_Customcurrencies: COMMIT
20:29:04.971163 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:04.976708 [debug] [Thread-1  ]: On model.Shawn.AH_CustomFields: COMMIT
20:29:04.975229 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Customcurrencies".
20:29:04.980954 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Customcurrencies: 
    
  if object_id ('"dbo"."AH_Customcurrencies__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Customcurrencies__dbt_backup"
    end

20:29:04.980748 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFields".
20:29:04.981212 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CustomFields: 
    
  if object_id ('"dbo"."AH_CustomFields__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CustomFields__dbt_backup"
    end

20:29:06.134818 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
20:29:06.149231 [debug] [Thread-2  ]: finished collecting timing info
20:29:06.149588 [debug] [Thread-2  ]: On model.Shawn.AH_Customcurrencies: Close
20:29:06.150384 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c425f70>]}
20:29:06.150883 [info ] [Thread-2  ]: 23 of 105 OK created table model dbo.AH_Customcurrencies........................ [[32mOK[0m in 4.62s]
20:29:06.151212 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Customcurrencies
20:29:06.151367 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Decorations
20:29:06.151726 [info ] [Thread-2  ]: 25 of 105 START table model dbo.AH_Decorations.................................. [RUN]
20:29:06.152120 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Decorations"
20:29:06.152232 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Decorations
20:29:06.152326 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Decorations
20:29:06.155076 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Decorations"
20:29:06.155452 [debug] [Thread-2  ]: finished collecting timing info
20:29:06.155645 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Decorations
20:29:06.173621 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.19 seconds
20:29:06.183822 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.24 seconds
20:29:06.185335 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.22 seconds
20:29:06.196648 [debug] [Thread-1  ]: finished collecting timing info
20:29:06.208060 [debug] [Thread-1  ]: On model.Shawn.AH_CustomFields: Close
20:29:06.208958 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c551580>]}
20:29:06.209398 [info ] [Thread-1  ]: 22 of 105 OK created table model dbo.AH_CustomFields............................ [[32mOK[0m in 5.10s]
20:29:06.209718 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_CustomFields
20:29:06.209885 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Emailtemplatecontents
20:29:06.230084 [info ] [Thread-1  ]: 26 of 105 START table model dbo.AH_Emailtemplatecontents........................ [RUN]
20:29:06.230585 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Emailtemplatecontents"
20:29:06.230721 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Emailtemplatecontents
20:29:06.230828 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Emailtemplatecontents
20:29:06.233795 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Emailtemplatecontents"
20:29:06.234188 [debug] [Thread-1  ]: finished collecting timing info
20:29:06.234314 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Emailtemplatecontents
20:29:06.224927 [debug] [Thread-4  ]: finished collecting timing info
20:29:06.242489 [debug] [Thread-4  ]: On model.Shawn.AH_CategoryCustomFields: Close
20:29:06.243270 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c4347c0>]}
20:29:06.243686 [info ] [Thread-4  ]: 11 of 105 OK created table model dbo.AH_CategoryCustomFields.................... [[32mOK[0m in 17.56s]
20:29:06.243995 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_CategoryCustomFields
20:29:06.229643 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Decorations"
20:29:06.254799 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Decorations".
20:29:06.255029 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Decorations: 
  
  if object_id ('"dbo"."AH_Decorations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Decorations__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Decorations__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Decorations__dbt_tmp"
    end


   EXEC('create view dbo.AH_Decorations__dbt_tmp_temp_view as
    
Select
	cast([PayToproceed] as bit) [PayToProceed],
	cast([ID] as int) [Id],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ValIDFields] as nvarchar(4000)) [ValidFields],
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Name] as nvarchar(4000)) [Name],
	cast([FormatString] as nvarchar(4000)) [FormatString],
	cast([Amount] as numeric(19,4)) [Amount] 
From stg.[AH_Decorations_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Decorations__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Decorations__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Decorations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Decorations__dbt_tmp_temp_view"
    end



20:29:06.255129 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:29:06.255247 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:06.244156 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Emailtemplates
20:29:06.256461 [info ] [Thread-4  ]: 27 of 105 START table model dbo.AH_Emailtemplates............................... [RUN]
20:29:06.257027 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Emailtemplates"
20:29:06.257149 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Emailtemplates
20:29:06.257249 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Emailtemplates
20:29:06.242137 [debug] [Thread-3  ]: finished collecting timing info
20:29:06.260852 [debug] [Thread-3  ]: On model.Shawn.AH_DailyhuntEmailSubscribers: Close
20:29:06.261838 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c3ce820>]}
20:29:06.262265 [info ] [Thread-3  ]: 24 of 105 OK created table model dbo.AH_DailyhuntEmailSubscribers............... [[32mOK[0m in 4.53s]
20:29:06.262610 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_DailyhuntEmailSubscribers
20:29:06.262768 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Eventproperties
20:29:06.269958 [info ] [Thread-3  ]: 28 of 105 START table model dbo.AH_Eventproperties.............................. [RUN]
20:29:06.260561 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Emailtemplates"
20:29:06.271044 [debug] [Thread-4  ]: finished collecting timing info
20:29:06.271174 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Emailtemplates
20:29:06.270658 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Eventproperties"
20:29:06.298255 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Eventproperties
20:29:06.298497 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Eventproperties
20:29:06.303017 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Eventproperties"
20:29:06.320386 [debug] [Thread-3  ]: finished collecting timing info
20:29:06.320618 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Eventproperties
20:29:06.331298 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Emailtemplatecontents"
20:29:06.344133 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplatecontents".
20:29:06.344357 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplatecontents: 
  
  if object_id ('"dbo"."AH_Emailtemplatecontents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Emailtemplatecontents__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Emailtemplatecontents__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Emailtemplatecontents__dbt_tmp"
    end


   EXEC('create view dbo.AH_Emailtemplatecontents__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([Culture] as nvarchar(4000)) [Culture],
	cast([SuBJect] as nvarchar(4000)) [Subject],
	cast([Body] as nvarchar(4000)) [Body],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id] 
From stg.[AH_Emailtemplatecontents_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Emailtemplatecontents__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Emailtemplatecontents__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Emailtemplatecontents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Emailtemplatecontents__dbt_tmp_temp_view"
    end



20:29:06.344458 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:06.344579 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:06.367760 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:06.374848 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Emailtemplates"
20:29:06.375367 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplates".
20:29:06.375500 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplates: 
  
  if object_id ('"dbo"."AH_Emailtemplates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Emailtemplates__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Emailtemplates__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Emailtemplates__dbt_tmp"
    end


   EXEC('create view dbo.AH_Emailtemplates__dbt_tmp_temp_view as
    
Select
	cast([Enabled] as bit) [Enabled],
	cast([ID] as int) [Id],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_Emailtemplates_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Emailtemplates__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Emailtemplates__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Emailtemplates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Emailtemplates__dbt_tmp_temp_view"
    end



20:29:06.375586 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:29:06.375694 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:06.396508 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Eventproperties"
20:29:06.397007 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Eventproperties".
20:29:06.397144 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Eventproperties: 
  
  if object_id ('"dbo"."AH_Eventproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Eventproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Eventproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Eventproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_Eventproperties__dbt_tmp_temp_view as
    
Select
	cast([StringnativeValue] as nvarchar(4000)) [StringNativeValue],
	cast([EnumnativeValue] as nvarchar(4000)) [EnumNativeValue],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([DecimalnativeValue] as numeric(19,4)) [DecimalNativeValue],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DateTimenativeValue] as datetime) [DateTimeNativeValue],
	cast([BoolnativeValue] as bit) [BoolNativeValue],
	cast([ID] as int) [Id],
	cast([IntnativeValue] as int) [IntNativeValue],
	cast([AuctionEventID] as int) [AuctionEventId],
	cast([CustomFieldID] as int) [CustomFieldId] 
From stg.[AH_Eventproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Eventproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Eventproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Eventproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Eventproperties__dbt_tmp_temp_view"
    end



20:29:06.397245 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:29:06.397356 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:06.446522 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:06.498969 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:06.500367 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:08.795824 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.54 seconds
20:29:08.812132 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Decorations".
20:29:08.812411 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Decorations: rename object "dbo"."AH_Decorations" to AH_Decorations__dbt_backup
20:29:08.845205 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:08.859051 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Decorations".
20:29:08.859333 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Decorations: rename object "dbo"."AH_Decorations__dbt_tmp" to AH_Decorations
20:29:08.888266 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:08.890046 [debug] [Thread-2  ]: On model.Shawn.AH_Decorations: COMMIT
20:29:08.894223 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Decorations".
20:29:08.894426 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Decorations: 
    
  if object_id ('"dbo"."AH_Decorations__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Decorations__dbt_backup"
    end

20:29:09.114627 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:29:09.127439 [debug] [Thread-2  ]: finished collecting timing info
20:29:09.127794 [debug] [Thread-2  ]: On model.Shawn.AH_Decorations: Close
20:29:09.128563 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c551ac0>]}
20:29:09.128993 [info ] [Thread-2  ]: 25 of 105 OK created table model dbo.AH_Decorations............................. [[32mOK[0m in 2.98s]
20:29:09.129307 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Decorations
20:29:09.129463 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Events
20:29:09.129809 [info ] [Thread-2  ]: 29 of 105 START table model dbo.AH_Events....................................... [RUN]
20:29:09.130177 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Events"
20:29:09.130290 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Events
20:29:09.130385 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Events
20:29:09.133025 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Events"
20:29:09.133384 [debug] [Thread-2  ]: finished collecting timing info
20:29:09.133502 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Events
20:29:09.170130 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Events"
20:29:09.170713 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Events".
20:29:09.170863 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Events: 
  
  if object_id ('"dbo"."AH_Events__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Events__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Events__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Events__dbt_tmp"
    end


   EXEC('create view dbo.AH_Events__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_Events_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Events__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Events__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Events__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Events__dbt_tmp_temp_view"
    end



20:29:09.170950 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:29:09.171059 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:09.271254 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:09.905946 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.51 seconds
20:29:09.921788 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Eventproperties".
20:29:09.922061 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Eventproperties: rename object "dbo"."AH_Eventproperties" to AH_Eventproperties__dbt_backup
20:29:09.995732 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:29:10.009585 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Eventproperties".
20:29:10.009854 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Eventproperties: rename object "dbo"."AH_Eventproperties__dbt_tmp" to AH_Eventproperties
20:29:10.066473 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:29:10.068418 [debug] [Thread-3  ]: On model.Shawn.AH_Eventproperties: COMMIT
20:29:10.072997 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Eventproperties".
20:29:10.073229 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Eventproperties: 
    
  if object_id ('"dbo"."AH_Eventproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Eventproperties__dbt_backup"
    end

20:29:10.153518 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.78 seconds
20:29:10.168645 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplates".
20:29:10.168927 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplates: rename object "dbo"."AH_Emailtemplates" to AH_Emailtemplates__dbt_backup
20:29:10.205705 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:10.219767 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplates".
20:29:10.220044 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplates: rename object "dbo"."AH_Emailtemplates__dbt_tmp" to AH_Emailtemplates
20:29:10.250826 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:10.252781 [debug] [Thread-4  ]: On model.Shawn.AH_Emailtemplates: COMMIT
20:29:10.257351 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplates".
20:29:10.257583 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplates: 
    
  if object_id ('"dbo"."AH_Emailtemplates__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Emailtemplates__dbt_backup"
    end

20:29:10.398302 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
20:29:10.486599 [debug] [Thread-3  ]: finished collecting timing info
20:29:10.486938 [debug] [Thread-3  ]: On model.Shawn.AH_Eventproperties: Close
20:29:10.487645 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c38ea90>]}
20:29:10.488063 [info ] [Thread-3  ]: 28 of 105 OK created table model dbo.AH_Eventproperties......................... [[32mOK[0m in 4.22s]
20:29:10.488377 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Eventproperties
20:29:10.488534 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ExternalUserIDs
20:29:10.488876 [info ] [Thread-3  ]: 30 of 105 START table model dbo.AH_ExternalUserIDs.............................. [RUN]
20:29:10.489241 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ExternalUserIDs"
20:29:10.489350 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ExternalUserIDs
20:29:10.489443 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ExternalUserIDs
20:29:10.492079 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ExternalUserIDs"
20:29:10.492412 [debug] [Thread-3  ]: finished collecting timing info
20:29:10.492526 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ExternalUserIDs
20:29:10.528286 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ExternalUserIDs"
20:29:10.528810 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ExternalUserIDs".
20:29:10.528954 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ExternalUserIDs: 
  
  if object_id ('"dbo"."AH_ExternalUserIDs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ExternalUserIDs__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ExternalUserIDs__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ExternalUserIDs__dbt_tmp"
    end


   EXEC('create view dbo.AH_ExternalUserIDs__dbt_tmp_temp_view as
    
Select
	cast([ProvIDErName] as nvarchar(4000)) [ProviderName],
	cast([ProvIDErUserID] as nvarchar(4000)) [ProviderUserId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([LocalUserID] as int) [LocalUserId] 
From stg.[AH_ExternalUserIDs_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ExternalUserIDs__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ExternalUserIDs__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ExternalUserIDs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ExternalUserIDs__dbt_tmp_temp_view"
    end



20:29:10.529041 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:29:10.529146 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:10.548541 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
20:29:10.565218 [debug] [Thread-4  ]: finished collecting timing info
20:29:10.565552 [debug] [Thread-4  ]: On model.Shawn.AH_Emailtemplates: Close
20:29:10.566251 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c947910>]}
20:29:10.635395 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:10.656255 [info ] [Thread-4  ]: 27 of 105 OK created table model dbo.AH_Emailtemplates.......................... [[32mOK[0m in 4.31s]
20:29:10.657083 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Emailtemplates
20:29:10.657270 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Feedbacks
20:29:10.657666 [info ] [Thread-4  ]: 31 of 105 START table model dbo.AH_Feedbacks.................................... [RUN]
20:29:10.658175 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Feedbacks"
20:29:10.658320 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Feedbacks
20:29:10.658434 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Feedbacks
20:29:10.661367 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Feedbacks"
20:29:10.661732 [debug] [Thread-4  ]: finished collecting timing info
20:29:10.661866 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Feedbacks
20:29:10.698561 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Feedbacks"
20:29:10.699099 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feedbacks".
20:29:10.699236 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Feedbacks: 
  
  if object_id ('"dbo"."AH_Feedbacks__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Feedbacks__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Feedbacks__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Feedbacks__dbt_tmp"
    end


   EXEC('create view dbo.AH_Feedbacks__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([SEndingUserID] as int) [SendingUserId],
	cast([ReceivINgUserID] as int) [ReceivingUserId],
	cast([Rating] as int) [Rating],
	cast([ListingID] as int) [ListingId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DaTestamp] as datetime) [DateStamp],
	cast([Comment] as nvarchar(4000)) [Comment],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([ListingOwnerUserName] as nvarchar(4000)) [ListingOwnerUsername] 
From stg.[AH_Feedbacks_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Feedbacks__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Feedbacks__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Feedbacks__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Feedbacks__dbt_tmp_temp_view"
    end



20:29:10.699323 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:29:10.699431 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:10.803720 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:11.001408 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 4.66 seconds
20:29:11.017081 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplatecontents".
20:29:11.017483 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplatecontents: rename object "dbo"."AH_Emailtemplatecontents" to AH_Emailtemplatecontents__dbt_backup
20:29:11.046409 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:11.061076 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplatecontents".
20:29:11.061357 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplatecontents: rename object "dbo"."AH_Emailtemplatecontents__dbt_tmp" to AH_Emailtemplatecontents
20:29:11.094743 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:11.096665 [debug] [Thread-1  ]: On model.Shawn.AH_Emailtemplatecontents: COMMIT
20:29:11.101201 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplatecontents".
20:29:11.101462 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplatecontents: 
    
  if object_id ('"dbo"."AH_Emailtemplatecontents__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Emailtemplatecontents__dbt_backup"
    end

20:29:11.527766 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
20:29:11.540565 [debug] [Thread-1  ]: finished collecting timing info
20:29:11.540897 [debug] [Thread-1  ]: On model.Shawn.AH_Emailtemplatecontents: Close
20:29:11.541621 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c499520>]}
20:29:11.542055 [info ] [Thread-1  ]: 26 of 105 OK created table model dbo.AH_Emailtemplatecontents................... [[32mOK[0m in 5.31s]
20:29:11.542362 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Emailtemplatecontents
20:29:11.542518 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Feeproperties
20:29:11.542909 [info ] [Thread-1  ]: 32 of 105 START table model dbo.AH_Feeproperties................................ [RUN]
20:29:11.543299 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Feeproperties"
20:29:11.543410 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Feeproperties
20:29:11.543512 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Feeproperties
20:29:11.546074 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Feeproperties"
20:29:11.546384 [debug] [Thread-1  ]: finished collecting timing info
20:29:11.546496 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Feeproperties
20:29:11.582629 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Feeproperties"
20:29:11.583163 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeproperties".
20:29:11.583302 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Feeproperties: 
  
  if object_id ('"dbo"."AH_Feeproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Feeproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Feeproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Feeproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_Feeproperties__dbt_tmp_temp_view as
    
Select
	cast([Processor] as nvarchar(4000)) [Processor],
	cast([Name] as nvarchar(4000)) [Name],
	cast([Description] as nvarchar(4000)) [Description],
	cast([Amount] as numeric(19,4)) [Amount],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([ListingTypeID] as int) [ListingTypeId],
	cast([EventID] as int) [EventId] 
From stg.[AH_Feeproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Feeproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Feeproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Feeproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Feeproperties__dbt_tmp_temp_view"
    end



20:29:11.583387 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:11.583499 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:11.689771 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:13.029548 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.86 seconds
20:29:13.044330 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Events".
20:29:13.044596 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Events: rename object "dbo"."AH_Events" to AH_Events__dbt_backup
20:29:13.092778 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:29:13.107630 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Events".
20:29:13.107940 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Events: rename object "dbo"."AH_Events__dbt_tmp" to AH_Events
20:29:13.147944 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:13.149857 [debug] [Thread-2  ]: On model.Shawn.AH_Events: COMMIT
20:29:13.154399 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Events".
20:29:13.154608 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Events: 
    
  if object_id ('"dbo"."AH_Events__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Events__dbt_backup"
    end

20:29:13.358924 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:29:13.371935 [debug] [Thread-2  ]: finished collecting timing info
20:29:13.372285 [debug] [Thread-2  ]: On model.Shawn.AH_Events: Close
20:29:13.373043 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c4491f0>]}
20:29:13.373460 [info ] [Thread-2  ]: 29 of 105 OK created table model dbo.AH_Events.................................. [[32mOK[0m in 4.24s]
20:29:13.373765 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Events
20:29:13.373931 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Feeschedules
20:29:13.374279 [info ] [Thread-2  ]: 33 of 105 START table model dbo.AH_Feeschedules................................. [RUN]
20:29:13.374722 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Feeschedules"
20:29:13.374845 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Feeschedules
20:29:13.374944 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Feeschedules
20:29:13.377568 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Feeschedules"
20:29:13.377973 [debug] [Thread-2  ]: finished collecting timing info
20:29:13.378094 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Feeschedules
20:29:13.384463 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.69 seconds
20:29:13.405480 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feedbacks".
20:29:13.405730 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Feedbacks: rename object "dbo"."AH_Feedbacks" to AH_Feedbacks__dbt_backup
20:29:13.429649 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Feeschedules"
20:29:13.430163 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeschedules".
20:29:13.430300 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Feeschedules: 
  
  if object_id ('"dbo"."AH_Feeschedules__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Feeschedules__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Feeschedules__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Feeschedules__dbt_tmp"
    end


   EXEC('create view dbo.AH_Feeschedules__dbt_tmp_temp_view as
    
Select
	cast([PayToproceed] as bit) [PayToProceed],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([EventID] as int) [EventId],
	cast([ListingTypeID] as int) [ListingTypeId],
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_Feeschedules_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Feeschedules__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Feeschedules__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Feeschedules__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Feeschedules__dbt_tmp_temp_view"
    end



20:29:13.430388 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:29:13.430494 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:13.446889 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.92 seconds
20:29:13.462621 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ExternalUserIDs".
20:29:13.462860 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:29:13.463002 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ExternalUserIDs: rename object "dbo"."AH_ExternalUserIDs" to AH_ExternalUserIDs__dbt_backup
20:29:13.478875 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feedbacks".
20:29:13.479114 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Feedbacks: rename object "dbo"."AH_Feedbacks__dbt_tmp" to AH_Feedbacks
20:29:13.502673 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:13.514996 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:13.516626 [debug] [Thread-4  ]: On model.Shawn.AH_Feedbacks: COMMIT
20:29:13.522891 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ExternalUserIDs".
20:29:13.526851 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ExternalUserIDs: rename object "dbo"."AH_ExternalUserIDs__dbt_tmp" to AH_ExternalUserIDs
20:29:13.526659 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feedbacks".
20:29:13.527081 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Feedbacks: 
    
  if object_id ('"dbo"."AH_Feedbacks__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Feedbacks__dbt_backup"
    end

20:29:13.548209 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:13.581586 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:29:13.583328 [debug] [Thread-3  ]: On model.Shawn.AH_ExternalUserIDs: COMMIT
20:29:13.587439 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ExternalUserIDs".
20:29:13.587617 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ExternalUserIDs: 
    
  if object_id ('"dbo"."AH_ExternalUserIDs__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ExternalUserIDs__dbt_backup"
    end

20:29:13.679683 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.10 seconds
20:29:13.694692 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeproperties".
20:29:13.694944 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Feeproperties: rename object "dbo"."AH_Feeproperties" to AH_Feeproperties__dbt_backup
20:29:13.726464 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:13.804335 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:29:13.812280 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
20:29:13.818670 [debug] [Thread-3  ]: finished collecting timing info
20:29:13.824323 [debug] [Thread-3  ]: On model.Shawn.AH_ExternalUserIDs: Close
20:29:13.825163 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c54a190>]}
20:29:13.825599 [info ] [Thread-3  ]: 30 of 105 OK created table model dbo.AH_ExternalUserIDs......................... [[32mOK[0m in 3.34s]
20:29:13.825915 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ExternalUserIDs
20:29:13.826072 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ImportedCategoryMap
20:29:13.832097 [info ] [Thread-3  ]: 34 of 105 START table model dbo.AH_ImportedCategoryMap.......................... [RUN]
20:29:13.832708 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ImportedCategoryMap"
20:29:13.832854 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ImportedCategoryMap
20:29:13.832958 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ImportedCategoryMap
20:29:13.835718 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ImportedCategoryMap"
20:29:13.848956 [debug] [Thread-3  ]: finished collecting timing info
20:29:13.849100 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ImportedCategoryMap
20:29:13.843020 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeproperties".
20:29:13.855815 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Feeproperties: rename object "dbo"."AH_Feeproperties__dbt_tmp" to AH_Feeproperties
20:29:13.848532 [debug] [Thread-4  ]: finished collecting timing info
20:29:13.856270 [debug] [Thread-4  ]: On model.Shawn.AH_Feedbacks: Close
20:29:13.857022 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5d7640>]}
20:29:13.857431 [info ] [Thread-4  ]: 31 of 105 OK created table model dbo.AH_Feedbacks............................... [[32mOK[0m in 3.20s]
20:29:13.857732 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Feedbacks
20:29:13.857880 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ImportedListingsMap
20:29:13.858228 [info ] [Thread-4  ]: 35 of 105 START table model dbo.AH_ImportedListingsMap.......................... [RUN]
20:29:13.858640 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ImportedListingsMap"
20:29:13.858757 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ImportedListingsMap
20:29:13.858852 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ImportedListingsMap
20:29:13.861644 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ImportedListingsMap"
20:29:13.862027 [debug] [Thread-4  ]: finished collecting timing info
20:29:13.862150 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ImportedListingsMap
20:29:13.891718 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:13.893428 [debug] [Thread-1  ]: On model.Shawn.AH_Feeproperties: COMMIT
20:29:13.898104 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeproperties".
20:29:13.917993 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Feeproperties: 
    
  if object_id ('"dbo"."AH_Feeproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Feeproperties__dbt_backup"
    end

20:29:13.937065 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ImportedListingsMap"
20:29:13.927518 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ImportedCategoryMap"
20:29:13.937728 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedCategoryMap".
20:29:13.937868 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ImportedCategoryMap: 
  
  if object_id ('"dbo"."AH_ImportedCategoryMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedCategoryMap__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ImportedCategoryMap__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ImportedCategoryMap__dbt_tmp"
    end


   EXEC('create view dbo.AH_ImportedCategoryMap__dbt_tmp_temp_view as
    
Select
	cast([LocalCategoryID] as int) [localCategoryId],
	cast([ForeignCategoryID] as int) [foreignCategoryId] 
From stg.[AH_ImportedCategoryMap_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ImportedCategoryMap__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ImportedCategoryMap__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ImportedCategoryMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedCategoryMap__dbt_tmp_temp_view"
    end



20:29:13.937956 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:29:13.938067 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:13.939501 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedListingsMap".
20:29:13.939715 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ImportedListingsMap: 
  
  if object_id ('"dbo"."AH_ImportedListingsMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedListingsMap__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ImportedListingsMap__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ImportedListingsMap__dbt_tmp"
    end


   EXEC('create view dbo.AH_ImportedListingsMap__dbt_tmp_temp_view as
    
Select
	cast([ForeignListingID] as int) [foreignListingId],
	cast([LoCallistingID] as int) [localListingId] 
From stg.[AH_ImportedListingsMap_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ImportedListingsMap__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ImportedListingsMap__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ImportedListingsMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedListingsMap__dbt_tmp_temp_view"
    end



20:29:13.939808 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:29:13.939914 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:14.047007 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:14.049842 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:14.214228 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:29:14.226820 [debug] [Thread-1  ]: finished collecting timing info
20:29:14.227159 [debug] [Thread-1  ]: On model.Shawn.AH_Feeproperties: Close
20:29:14.227887 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c3d2460>]}
20:29:14.228299 [info ] [Thread-1  ]: 32 of 105 OK created table model dbo.AH_Feeproperties........................... [[32mOK[0m in 2.68s]
20:29:14.228617 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Feeproperties
20:29:14.228781 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ImportedUserMap
20:29:14.229128 [info ] [Thread-1  ]: 36 of 105 START table model dbo.AH_ImportedUserMap.............................. [RUN]
20:29:14.229500 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ImportedUserMap"
20:29:14.229608 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ImportedUserMap
20:29:14.229703 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ImportedUserMap
20:29:14.232326 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ImportedUserMap"
20:29:14.232659 [debug] [Thread-1  ]: finished collecting timing info
20:29:14.232770 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ImportedUserMap
20:29:14.269344 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ImportedUserMap"
20:29:14.269887 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedUserMap".
20:29:14.270030 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ImportedUserMap: 
  
  if object_id ('"dbo"."AH_ImportedUserMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedUserMap__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ImportedUserMap__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ImportedUserMap__dbt_tmp"
    end


   EXEC('create view dbo.AH_ImportedUserMap__dbt_tmp_temp_view as
    
Select
	cast([LocalUserID] as int) [localUserId],
	cast([ForeignUserID] as int) [foreignUserId],
	cast([ImportedUserName] as nvarchar(4000)) [importedUsername] 
From stg.[AH_ImportedUserMap_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ImportedUserMap__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ImportedUserMap__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ImportedUserMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedUserMap__dbt_tmp_temp_view"
    end



20:29:14.270124 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:14.270236 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:14.372378 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:15.324269 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.89 seconds
20:29:15.338726 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeschedules".
20:29:15.338986 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Feeschedules: rename object "dbo"."AH_Feeschedules" to AH_Feeschedules__dbt_backup
20:29:15.371892 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:15.386825 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeschedules".
20:29:15.387099 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Feeschedules: rename object "dbo"."AH_Feeschedules__dbt_tmp" to AH_Feeschedules
20:29:15.418491 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:15.420405 [debug] [Thread-2  ]: On model.Shawn.AH_Feeschedules: COMMIT
20:29:15.424744 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeschedules".
20:29:15.424925 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Feeschedules: 
    
  if object_id ('"dbo"."AH_Feeschedules__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Feeschedules__dbt_backup"
    end

20:29:16.016183 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.59 seconds
20:29:16.029600 [debug] [Thread-2  ]: finished collecting timing info
20:29:16.029922 [debug] [Thread-2  ]: On model.Shawn.AH_Feeschedules: Close
20:29:16.030689 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c520820>]}
20:29:16.031131 [info ] [Thread-2  ]: 33 of 105 OK created table model dbo.AH_Feeschedules............................ [[32mOK[0m in 2.66s]
20:29:16.031443 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Feeschedules
20:29:16.031592 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ImportedregionMap
20:29:16.031924 [info ] [Thread-2  ]: 37 of 105 START table model dbo.AH_ImportedregionMap............................ [RUN]
20:29:16.032286 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ImportedregionMap"
20:29:16.032397 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ImportedregionMap
20:29:16.032493 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ImportedregionMap
20:29:16.035089 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ImportedregionMap"
20:29:16.035434 [debug] [Thread-2  ]: finished collecting timing info
20:29:16.035546 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ImportedregionMap
20:29:16.071719 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ImportedregionMap"
20:29:16.072266 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedregionMap".
20:29:16.072412 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ImportedregionMap: 
  
  if object_id ('"dbo"."AH_ImportedregionMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedregionMap__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ImportedregionMap__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ImportedregionMap__dbt_tmp"
    end


   EXEC('create view dbo.AH_ImportedregionMap__dbt_tmp_temp_view as
    
Select
	cast([LocalregionID] as int) [localRegionId],
	cast([ForeignregionID] as int) [foreignRegionId],
	cast([Foreignregiontier] as int) [foreignRegionTier] 
From stg.[AH_ImportedregionMap_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ImportedregionMap__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ImportedregionMap__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ImportedregionMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedregionMap__dbt_tmp_temp_view"
    end



20:29:16.072506 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:29:16.072616 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:16.098421 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.16 seconds
20:29:16.106922 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.17 seconds
20:29:16.115643 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedCategoryMap".
20:29:16.127822 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ImportedCategoryMap: rename object "dbo"."AH_ImportedCategoryMap" to AH_ImportedCategoryMap__dbt_backup
20:29:16.129597 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedListingsMap".
20:29:16.129785 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ImportedListingsMap: rename object "dbo"."AH_ImportedListingsMap" to AH_ImportedListingsMap__dbt_backup
20:29:16.160589 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:16.169771 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:16.170195 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:16.177279 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedCategoryMap".
20:29:16.187797 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ImportedCategoryMap: rename object "dbo"."AH_ImportedCategoryMap__dbt_tmp" to AH_ImportedCategoryMap
20:29:16.190290 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedListingsMap".
20:29:16.190482 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ImportedListingsMap: rename object "dbo"."AH_ImportedListingsMap__dbt_tmp" to AH_ImportedListingsMap
20:29:16.216735 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:16.218664 [debug] [Thread-3  ]: On model.Shawn.AH_ImportedCategoryMap: COMMIT
20:29:16.223063 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedCategoryMap".
20:29:16.223226 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:16.224572 [debug] [Thread-4  ]: On model.Shawn.AH_ImportedListingsMap: COMMIT
20:29:16.223340 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ImportedCategoryMap: 
    
  if object_id ('"dbo"."AH_ImportedCategoryMap__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ImportedCategoryMap__dbt_backup"
    end

20:29:16.228295 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedListingsMap".
20:29:16.228590 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ImportedListingsMap: 
    
  if object_id ('"dbo"."AH_ImportedListingsMap__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ImportedListingsMap__dbt_backup"
    end

20:29:16.434202 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:29:16.445697 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:29:16.448629 [debug] [Thread-3  ]: finished collecting timing info
20:29:16.458725 [debug] [Thread-3  ]: On model.Shawn.AH_ImportedCategoryMap: Close
20:29:16.459472 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c4de040>]}
20:29:16.459873 [info ] [Thread-3  ]: 34 of 105 OK created table model dbo.AH_ImportedCategoryMap..................... [[32mOK[0m in 2.63s]
20:29:16.460183 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ImportedCategoryMap
20:29:16.460331 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Increments
20:29:16.460674 [info ] [Thread-3  ]: 38 of 105 START table model dbo.AH_Increments................................... [RUN]
20:29:16.461040 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Increments"
20:29:16.461147 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Increments
20:29:16.461240 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Increments
20:29:16.458410 [debug] [Thread-4  ]: finished collecting timing info
20:29:16.464008 [debug] [Thread-4  ]: On model.Shawn.AH_ImportedListingsMap: Close
20:29:16.464541 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c54a580>]}
20:29:16.464920 [info ] [Thread-4  ]: 35 of 105 OK created table model dbo.AH_ImportedListingsMap..................... [[32mOK[0m in 2.61s]
20:29:16.465180 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ImportedListingsMap
20:29:16.465310 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Invoices
20:29:16.465579 [info ] [Thread-4  ]: 39 of 105 START table model dbo.AH_Invoices..................................... [RUN]
20:29:16.465900 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Invoices"
20:29:16.466001 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Invoices
20:29:16.466087 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Invoices
20:29:16.463808 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Increments"
20:29:16.469377 [debug] [Thread-3  ]: finished collecting timing info
20:29:16.469490 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Increments
20:29:16.469035 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Invoices"
20:29:16.479959 [debug] [Thread-4  ]: finished collecting timing info
20:29:16.480128 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Invoices
20:29:16.541138 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Increments"
20:29:16.541663 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Increments".
20:29:16.541798 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Increments: 
  
  if object_id ('"dbo"."AH_Increments__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Increments__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Increments__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Increments__dbt_tmp"
    end


   EXEC('create view dbo.AH_Increments__dbt_tmp_temp_view as
    
Select
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([PriceLevel] as numeric(19,4)) [PriceLevel],
	cast([Amount] as numeric(19,4)) [Amount],
	cast([ID] as int) [Id],
	cast([ListingTypeID] as int) [ListingTypeId],
	cast([AuctionEventID] as int) [AuctionEventId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_Increments_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Increments__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Increments__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Increments__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Increments__dbt_tmp_temp_view"
    end



20:29:16.541879 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:29:16.541989 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:16.543425 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Invoices"
20:29:16.543756 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices".
20:29:16.543870 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Invoices: 
  
  if object_id ('"dbo"."AH_Invoices__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Invoices__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Invoices__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Invoices__dbt_tmp"
    end


   EXEC('create view dbo.AH_Invoices__dbt_tmp_temp_view as
    
Select
	cast([Paiddttm] as datetime) [PaidDTTM],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Createddttm] as datetime) [CreatedDTTM],
	cast([Fulfilleddttm] as datetime) [FulfilledDTTM],
	cast([PropertybagID] as int) [PropertyBagId],
	cast([ID] as int) [Id],
	cast([ShippingOptionID] as int) [ShippingOptionId],
	cast([PayerID] as int) [PayerId],
	cast([OwnerID] as int) [OwnerId],
	cast([AuctionEventID] as int) [AuctionEventId],
	cast([SalesTax] as decimal(24,2)) [SalesTax],
	cast([BuyersPremiumPercent] as numeric(24,2)) [BuyersPremiumPercent],
	cast([BuyersPremiumAmount] as decimal(24,2)) [BuyersPremiumAmount],
	cast([ShippingAmount] as decimal(24,2)) [ShippingAmount],
	cast([SubTotal] as decimal(24,2)) [Subtotal],
	cast([Total] as decimal(24,2)) [Total],
	cast([IsPayerLocked] as bit) [IsPayerLocked],
	cast([Shipped] as bit) [Shipped],
	cast([IsArchived] as bit) [IsArchived],
	cast([Status] as nvarchar(100)) [Status],
	cast([ShippingLastName] as nvarchar(500)) [ShippingLastName],
	cast([BillingLastName] as nvarchar(500)) [BillingLastName],
	cast([OwnerName] as nvarchar(200)) [OwnerName],
	cast([Shippingdetails] as nvarchar(500)) [ShippingDetails],
	cast([OwnerCity] as nvarchar(200)) [OwnerCity],
	cast([OwnerStateregion] as nvarchar(200)) [OwnerStateRegion],
	cast([OwnerzipPostal] as varchar(128)) [OwnerZipPostal],
	cast([OwnerCountry] as nvarchar(200)) [OwnerCountry],
	cast([ShippingFirstName] as nvarchar(500)) [ShippingFirstName],
	cast([BillingFirstName] as nvarchar(500)) [BillingFirstName],
	cast([BillingCity] as nvarchar(40)) [BillingCity],
	cast([BillingStateregion] as nvarchar(40)) [BillingStateRegion],
	cast([BillingzipPostal] as varchar(128)) [BillingZipPostal],
	cast([BillingCountry] as nvarchar(40)) [BillingCountry],
	cast([OwnerStreet1] as varchar(128)) [OwnerStreet1],
	cast([OwnerStreet2] as varchar(128)) [OwnerStreet2],
	cast([ShippingCity] as nvarchar(100)) [ShippingCity],
	cast([ShippingStateregion] as nvarchar(50)) [ShippingStateRegion],
	cast([ShippingzipPostal] as varchar(128)) [ShippingZipPostal],
	cast([ShippingCountry] as nvarchar(100)) [ShippingCountry],
	cast([BillingStreet1] as varchar(128)) [BillingStreet1],
	cast([BillingStreet2] as varchar(128)) [BillingStreet2],
	cast([Comments] as nvarchar(4000)) [Comments],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([Currency] as nvarchar(10)) [Currency],
	cast([Type] as nvarchar(50)) [Type],
	cast([ShippingStreet1] as varchar(128)) [ShippingStreet1],
	cast([ShippingStreet2] as varchar(128)) [ShippingStreet2] 
From stg.[AH_Invoices_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Invoices__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Invoices__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Invoices__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Invoices__dbt_tmp_temp_view"
    end



20:29:16.543956 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:29:16.544050 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:16.672135 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:16.674606 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:17.016458 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.75 seconds
20:29:17.031821 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedUserMap".
20:29:17.032090 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ImportedUserMap: rename object "dbo"."AH_ImportedUserMap" to AH_ImportedUserMap__dbt_backup
20:29:17.062710 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:17.076870 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedUserMap".
20:29:17.077130 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ImportedUserMap: rename object "dbo"."AH_ImportedUserMap__dbt_tmp" to AH_ImportedUserMap
20:29:17.112911 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:17.114892 [debug] [Thread-1  ]: On model.Shawn.AH_ImportedUserMap: COMMIT
20:29:17.119596 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedUserMap".
20:29:17.119822 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ImportedUserMap: 
    
  if object_id ('"dbo"."AH_ImportedUserMap__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ImportedUserMap__dbt_backup"
    end

20:29:17.409464 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
20:29:17.422420 [debug] [Thread-1  ]: finished collecting timing info
20:29:17.422748 [debug] [Thread-1  ]: On model.Shawn.AH_ImportedUserMap: Close
20:29:17.423472 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c8dfe50>]}
20:29:17.423892 [info ] [Thread-1  ]: 36 of 105 OK created table model dbo.AH_ImportedUserMap......................... [[32mOK[0m in 3.19s]
20:29:17.424203 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ImportedUserMap
20:29:17.424359 [debug] [Thread-1  ]: Began running node model.Shawn.AH_KeyTable
20:29:17.424701 [info ] [Thread-1  ]: 40 of 105 START table model dbo.AH_KeyTable..................................... [RUN]
20:29:17.425061 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_KeyTable"
20:29:17.425171 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_KeyTable
20:29:17.425265 [debug] [Thread-1  ]: Compiling model.Shawn.AH_KeyTable
20:29:17.427831 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_KeyTable"
20:29:17.428160 [debug] [Thread-1  ]: finished collecting timing info
20:29:17.428278 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_KeyTable
20:29:17.464608 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_KeyTable"
20:29:17.465135 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_KeyTable".
20:29:17.465275 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_KeyTable: 
  
  if object_id ('"dbo"."AH_KeyTable__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_KeyTable__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_KeyTable__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_KeyTable__dbt_tmp"
    end


   EXEC('create view dbo.AH_KeyTable__dbt_tmp_temp_view as
    
Select
	cast([NextID] as int) [NextId] 
From stg.[AH_KeyTable_FinalView]
    ');

  CREATE TABLE "dbo"."AH_KeyTable__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_KeyTable__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_KeyTable__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_KeyTable__dbt_tmp_temp_view"
    end



20:29:17.465367 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:17.465477 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:17.570848 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:18.005614 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.93 seconds
20:29:18.020366 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedregionMap".
20:29:18.020626 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ImportedregionMap: rename object "dbo"."AH_ImportedregionMap" to AH_ImportedregionMap__dbt_backup
20:29:18.058722 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:18.072804 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedregionMap".
20:29:18.073087 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ImportedregionMap: rename object "dbo"."AH_ImportedregionMap__dbt_tmp" to AH_ImportedregionMap
20:29:18.100949 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:18.102863 [debug] [Thread-2  ]: On model.Shawn.AH_ImportedregionMap: COMMIT
20:29:18.107554 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedregionMap".
20:29:18.107775 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ImportedregionMap: 
    
  if object_id ('"dbo"."AH_ImportedregionMap__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ImportedregionMap__dbt_backup"
    end

20:29:18.333082 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:29:18.347129 [debug] [Thread-2  ]: finished collecting timing info
20:29:18.347473 [debug] [Thread-2  ]: On model.Shawn.AH_ImportedregionMap: Close
20:29:18.348201 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c4b6a60>]}
20:29:18.348618 [info ] [Thread-2  ]: 37 of 105 OK created table model dbo.AH_ImportedregionMap....................... [[32mOK[0m in 2.32s]
20:29:18.348918 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ImportedregionMap
20:29:18.349073 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Languages
20:29:18.349418 [info ] [Thread-2  ]: 41 of 105 START table model dbo.AH_Languages.................................... [RUN]
20:29:18.349792 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Languages"
20:29:18.349904 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Languages
20:29:18.350000 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Languages
20:29:18.352643 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Languages"
20:29:18.352987 [debug] [Thread-2  ]: finished collecting timing info
20:29:18.353104 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Languages
20:29:18.389668 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Languages"
20:29:18.390228 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Languages".
20:29:18.390370 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Languages: 
  
  if object_id ('"dbo"."AH_Languages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Languages__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Languages__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Languages__dbt_tmp"
    end


   EXEC('create view dbo.AH_Languages__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Code] as nvarchar(4000)) [Code],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_Languages_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Languages__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Languages__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Languages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Languages__dbt_tmp_temp_view"
    end



20:29:18.390460 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:29:18.390611 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:18.497547 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:19.252725 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.71 seconds
20:29:19.268042 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Increments".
20:29:19.268312 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Increments: rename object "dbo"."AH_Increments" to AH_Increments__dbt_backup
20:29:19.304134 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:19.319241 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Increments".
20:29:19.319513 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Increments: rename object "dbo"."AH_Increments__dbt_tmp" to AH_Increments
20:29:19.347783 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:19.349652 [debug] [Thread-3  ]: On model.Shawn.AH_Increments: COMMIT
20:29:19.354097 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Increments".
20:29:19.354277 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Increments: 
    
  if object_id ('"dbo"."AH_Increments__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Increments__dbt_backup"
    end

20:29:19.554373 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:29:19.648797 [debug] [Thread-3  ]: finished collecting timing info
20:29:19.649146 [debug] [Thread-3  ]: On model.Shawn.AH_Increments: Close
20:29:19.649927 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c310d30>]}
20:29:19.650357 [info ] [Thread-3  ]: 38 of 105 OK created table model dbo.AH_Increments.............................. [[32mOK[0m in 3.19s]
20:29:19.650721 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Increments
20:29:19.650878 [debug] [Thread-3  ]: Began running node model.Shawn.AH_LineItems
20:29:19.651224 [info ] [Thread-3  ]: 42 of 105 START table model dbo.AH_LineItems.................................... [RUN]
20:29:19.651597 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_LineItems"
20:29:19.651705 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_LineItems
20:29:19.651801 [debug] [Thread-3  ]: Compiling model.Shawn.AH_LineItems
20:29:19.654775 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_LineItems"
20:29:19.655119 [debug] [Thread-3  ]: finished collecting timing info
20:29:19.655236 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_LineItems
20:29:19.691254 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_LineItems"
20:29:19.691782 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems".
20:29:19.691923 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_LineItems: 
  
  if object_id ('"dbo"."AH_LineItems__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_LineItems__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_LineItems__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_LineItems__dbt_tmp"
    end


   EXEC('create view dbo.AH_LineItems__dbt_tmp_temp_view as
    
Select
	cast([Currency] as nvarchar(10)) [Currency],
	cast([Status] as nvarchar(100)) [Status],
	cast([Type] as nvarchar(50)) [Type],
	cast([LotNumber] as nvarchar(4000)) [LotNumber],
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DaTestamp] as datetime) [DateStamp],
	cast([ID] as int) [Id],
	cast([InvoiceID] as int) [InvoiceId],
	cast([ListingID] as int) [ListingId],
	cast([Quantity] as int) [Quantity],
	cast([OwnerID] as int) [OwnerId],
	cast([PayerID] as int) [PayerId],
	cast([ReListiteration] as int) [RelistIteration],
	cast([AuctionEventID] as int) [AuctionEventId],
	cast([TotalAmount] as decimal(24,2)) [TotalAmount],
	cast([PeRunitAmount] as decimal(24,2)) [PerUnitAmount],
	cast([Taxable] as bit) [Taxable],
	cast([IsArchived] as bit) [IsArchived],
	cast([BuyersPremiuMapplies] as bit) [BuyersPremiumApplies],
	cast([IsPayerArchived] as bit) [IsPayerArchived] 
From stg.[AH_LineItems_FinalView]
    ');

  CREATE TABLE "dbo"."AH_LineItems__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_LineItems__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_LineItems__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_LineItems__dbt_tmp_temp_view"
    end



20:29:19.692016 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:29:19.692121 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:19.795195 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:19.804902 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.26 seconds
20:29:19.815754 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.35 seconds
20:29:19.821256 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices".
20:29:19.831791 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Invoices: rename object "dbo"."AH_Invoices" to AH_Invoices__dbt_backup
20:29:19.834356 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_KeyTable".
20:29:19.834579 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_KeyTable: rename object "dbo"."AH_KeyTable" to AH_KeyTable__dbt_backup
20:29:19.862452 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:19.871766 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:19.877883 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices".
20:29:19.887826 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Invoices: rename object "dbo"."AH_Invoices__dbt_tmp" to AH_Invoices
20:29:19.889638 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_KeyTable".
20:29:19.889810 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_KeyTable: rename object "dbo"."AH_KeyTable__dbt_tmp" to AH_KeyTable
20:29:19.916972 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:19.918895 [debug] [Thread-4  ]: On model.Shawn.AH_Invoices: COMMIT
20:29:19.923184 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices".
20:29:19.923359 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:19.924770 [debug] [Thread-1  ]: On model.Shawn.AH_KeyTable: COMMIT
20:29:19.923482 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Invoices: 
    
  if object_id ('"dbo"."AH_Invoices__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Invoices__dbt_backup"
    end

20:29:19.928660 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_KeyTable".
20:29:19.928982 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_KeyTable: 
    
  if object_id ('"dbo"."AH_KeyTable__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_KeyTable__dbt_backup"
    end

20:29:20.521052 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.59 seconds
20:29:20.535449 [debug] [Thread-1  ]: finished collecting timing info
20:29:20.535794 [debug] [Thread-1  ]: On model.Shawn.AH_KeyTable: Close
20:29:20.536043 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.61 seconds
20:29:20.548428 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c54ac10>]}
20:29:20.548934 [info ] [Thread-1  ]: 40 of 105 OK created table model dbo.AH_KeyTable................................ [[32mOK[0m in 3.12s]
20:29:20.549258 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_KeyTable
20:29:20.549414 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ListingActionproperties
20:29:20.549742 [info ] [Thread-1  ]: 43 of 105 START table model dbo.AH_ListingActionproperties...................... [RUN]
20:29:20.550217 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ListingActionproperties"
20:29:20.550332 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ListingActionproperties
20:29:20.550427 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ListingActionproperties
20:29:20.553107 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ListingActionproperties"
20:29:20.553450 [debug] [Thread-1  ]: finished collecting timing info
20:29:20.553566 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ListingActionproperties
20:29:20.547763 [debug] [Thread-4  ]: finished collecting timing info
20:29:20.559926 [debug] [Thread-4  ]: On model.Shawn.AH_Invoices: Close
20:29:20.560704 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c54aac0>]}
20:29:20.561096 [info ] [Thread-4  ]: 39 of 105 OK created table model dbo.AH_Invoices................................ [[32mOK[0m in 4.09s]
20:29:20.561393 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Invoices
20:29:20.561540 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingActions
20:29:20.561904 [info ] [Thread-4  ]: 44 of 105 START table model dbo.AH_ListingActions............................... [RUN]
20:29:20.562287 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingActions"
20:29:20.562395 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingActions
20:29:20.562491 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingActions
20:29:20.565399 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingActions"
20:29:20.565747 [debug] [Thread-4  ]: finished collecting timing info
20:29:20.565860 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingActions
20:29:20.626485 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ListingActionproperties"
20:29:20.634600 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActionproperties".
20:29:20.634771 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingActionproperties: 
  
  if object_id ('"dbo"."AH_ListingActionproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingActionproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingActionproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingActionproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingActionproperties__dbt_tmp_temp_view as
    
Select
	cast([BoolnativeValue] as bit) [BoolNativeValue],
	cast([DecimalnativeValue] as numeric(19,4)) [DecimalNativeValue],
	cast([CustomFieldID] as int) [CustomFieldId],
	cast([ID] as int) [Id],
	cast([IntnativeValue] as int) [IntNativeValue],
	cast([ListingActionID] as int) [ListingActionId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DateTimenativeValue] as datetime) [DateTimeNativeValue],
	cast([StringnativeValue] as nvarchar(4000)) [StringNativeValue],
	cast([EnumnativeValue] as nvarchar(4000)) [EnumNativeValue],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_ListingActionproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingActionproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingActionproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingActionproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingActionproperties__dbt_tmp_temp_view"
    end



20:29:20.634868 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:20.634980 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:20.634002 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingActions"
20:29:20.636404 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions".
20:29:20.636557 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingActions: 
  
  if object_id ('"dbo"."AH_ListingActions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingActions__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingActions__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingActions__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingActions__dbt_tmp_temp_view as
    
Select
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([Reason] as nvarchar(4000)) [Reason],
	cast([Status] as nvarchar(100)) [Status],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Actiondttm] as datetime) [ActionDTTM],
	cast([Amount] as decimal(24,2)) [Amount],
	cast([ProxyAmount] as decimal(24,2)) [ProxyAmount],
	cast([Userentered] as bit) [UserEntered],
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId],
	cast([ListingID] as int) [ListingId],
	cast([Quantity] as int) [Quantity] 
From stg.[AH_ListingActions_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingActions__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingActions__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingActions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingActions__dbt_tmp_temp_view"
    end



20:29:20.636641 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:29:20.636744 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:20.741536 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:20.742133 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:21.972149 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.28 seconds
20:29:21.987321 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems".
20:29:21.987588 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_LineItems: rename object "dbo"."AH_LineItems" to AH_LineItems__dbt_backup
20:29:22.020262 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:22.034313 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems".
20:29:22.034630 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_LineItems: rename object "dbo"."AH_LineItems__dbt_tmp" to AH_LineItems
20:29:22.069107 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:22.070942 [debug] [Thread-3  ]: On model.Shawn.AH_LineItems: COMMIT
20:29:22.075160 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems".
20:29:22.075366 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_LineItems: 
    
  if object_id ('"dbo"."AH_LineItems__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_LineItems__dbt_backup"
    end

20:29:22.220931 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.83 seconds
20:29:22.236787 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Languages".
20:29:22.237048 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Languages: rename object "dbo"."AH_Languages" to AH_Languages__dbt_backup
20:29:22.532637 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:29:22.547330 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Languages".
20:29:22.547596 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Languages: rename object "dbo"."AH_Languages__dbt_tmp" to AH_Languages
20:29:22.550218 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.47 seconds
20:29:22.562896 [debug] [Thread-3  ]: finished collecting timing info
20:29:22.563221 [debug] [Thread-3  ]: On model.Shawn.AH_LineItems: Close
20:29:22.563980 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c86b040>]}
20:29:22.564394 [info ] [Thread-3  ]: 42 of 105 OK created table model dbo.AH_LineItems............................... [[32mOK[0m in 2.91s]
20:29:22.564705 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_LineItems
20:29:22.564919 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingComments
20:29:22.565263 [info ] [Thread-3  ]: 45 of 105 START table model dbo.AH_ListingComments.............................. [RUN]
20:29:22.565659 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingComments"
20:29:22.565766 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingComments
20:29:22.565861 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingComments
20:29:22.568557 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingComments"
20:29:22.568897 [debug] [Thread-3  ]: finished collecting timing info
20:29:22.569011 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingComments
20:29:22.580803 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:22.582503 [debug] [Thread-2  ]: On model.Shawn.AH_Languages: COMMIT
20:29:22.586700 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Languages".
20:29:22.595803 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Languages: 
    
  if object_id ('"dbo"."AH_Languages__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Languages__dbt_backup"
    end

20:29:22.613038 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingComments"
20:29:22.613567 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingComments".
20:29:22.613712 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingComments: 
  
  if object_id ('"dbo"."AH_ListingComments__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingComments__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingComments__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingComments__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingComments__dbt_tmp_temp_view as
    
Select
	cast([IsBID] as bit) [IsBid],
	cast([Approved] as bit) [Approved],
	cast([ParentID] as int) [parentId],
	cast([ReportCount] as int) [ReportCount],
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId],
	cast([ListingID] as int) [ListingId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([UserName] as nvarchar(500)) [UserName],
	cast([Comment] as nvarchar(4000)) [Comment] 
From stg.[AH_ListingComments_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingComments__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingComments__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingComments__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingComments__dbt_tmp_temp_view"
    end



20:29:22.613806 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:29:22.613914 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:22.716832 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:23.122833 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.53 seconds
20:29:23.136315 [debug] [Thread-2  ]: finished collecting timing info
20:29:23.136649 [debug] [Thread-2  ]: On model.Shawn.AH_Languages: Close
20:29:23.137402 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c54ad60>]}
20:29:23.137819 [info ] [Thread-2  ]: 41 of 105 OK created table model dbo.AH_Languages............................... [[32mOK[0m in 4.79s]
20:29:23.138127 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Languages
20:29:23.138285 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ListingCommentsMedias
20:29:23.138656 [info ] [Thread-2  ]: 46 of 105 START table model dbo.AH_ListingCommentsMedias........................ [RUN]
20:29:23.139054 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ListingCommentsMedias"
20:29:23.139163 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ListingCommentsMedias
20:29:23.139256 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ListingCommentsMedias
20:29:23.141890 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ListingCommentsMedias"
20:29:23.142230 [debug] [Thread-2  ]: finished collecting timing info
20:29:23.142347 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ListingCommentsMedias
20:29:23.179292 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ListingCommentsMedias"
20:29:23.179832 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingCommentsMedias".
20:29:23.179969 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingCommentsMedias: 
  
  if object_id ('"dbo"."AH_ListingCommentsMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingCommentsMedias__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingCommentsMedias__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingCommentsMedias__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingCommentsMedias__dbt_tmp_temp_view as
    
Select
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([ID] as int) [Id],
	cast([MediaID] as int) [MediaId],
	cast([CommentID] as int) [CommentId],
	cast([DisplayOrder] as int) [DisplayOrder] 
From stg.[AH_ListingCommentsMedias_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingCommentsMedias__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingCommentsMedias__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingCommentsMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingCommentsMedias__dbt_tmp_temp_view"
    end



20:29:23.180061 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:29:23.180168 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:23.299493 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:25.631210 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.45 seconds
20:29:25.648288 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingCommentsMedias".
20:29:25.648570 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingCommentsMedias: rename object "dbo"."AH_ListingCommentsMedias" to AH_ListingCommentsMedias__dbt_backup
20:29:25.682201 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:25.780166 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingCommentsMedias".
20:29:25.780445 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingCommentsMedias: rename object "dbo"."AH_ListingCommentsMedias__dbt_tmp" to AH_ListingCommentsMedias
20:29:25.816948 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:25.818903 [debug] [Thread-2  ]: On model.Shawn.AH_ListingCommentsMedias: COMMIT
20:29:25.823307 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingCommentsMedias".
20:29:25.823513 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingCommentsMedias: 
    
  if object_id ('"dbo"."AH_ListingCommentsMedias__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingCommentsMedias__dbt_backup"
    end

20:29:26.134121 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
20:29:26.147394 [debug] [Thread-2  ]: finished collecting timing info
20:29:26.147751 [debug] [Thread-2  ]: On model.Shawn.AH_ListingCommentsMedias: Close
20:29:26.148518 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c8df2e0>]}
20:29:26.148946 [info ] [Thread-2  ]: 46 of 105 OK created table model dbo.AH_ListingCommentsMedias................... [[32mOK[0m in 3.01s]
20:29:26.149253 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ListingCommentsMedias
20:29:26.149417 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ListingEnddttmAudit
20:29:26.149760 [info ] [Thread-2  ]: 47 of 105 START table model dbo.AH_ListingEnddttmAudit.......................... [RUN]
20:29:26.150150 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ListingEnddttmAudit"
20:29:26.150259 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ListingEnddttmAudit
20:29:26.150358 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ListingEnddttmAudit
20:29:26.153094 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ListingEnddttmAudit"
20:29:26.153529 [debug] [Thread-2  ]: finished collecting timing info
20:29:26.153656 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ListingEnddttmAudit
20:29:26.190903 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ListingEnddttmAudit"
20:29:26.191469 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingEnddttmAudit".
20:29:26.191618 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingEnddttmAudit: 
  
  if object_id ('"dbo"."AH_ListingEnddttmAudit__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingEnddttmAudit__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingEnddttmAudit__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingEnddttmAudit__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingEnddttmAudit__dbt_tmp_temp_view as
    
Select
	cast([SqlDaTestamp] as datetime) [SQLDateStamp],
	cast([Enddttm] as datetime) [EndDTTM],
	cast([SourceListingID] as int) [SourceListingID],
	cast([ID] as int) [Id],
	cast([ListingID] as int) [ListingID],
	cast([Origin] as nvarchar(4000)) [Origin] 
From stg.[AH_ListingEnddttmAudit_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingEnddttmAudit__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingEnddttmAudit__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingEnddttmAudit__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingEnddttmAudit__dbt_tmp_temp_view"
    end



20:29:26.191713 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:29:26.191828 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:26.307715 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:29.003840 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.81 seconds
20:29:29.019800 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingEnddttmAudit".
20:29:29.020065 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingEnddttmAudit: rename object "dbo"."AH_ListingEnddttmAudit" to AH_ListingEnddttmAudit__dbt_backup
20:29:29.049835 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:29.064363 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingEnddttmAudit".
20:29:29.064632 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingEnddttmAudit: rename object "dbo"."AH_ListingEnddttmAudit__dbt_tmp" to AH_ListingEnddttmAudit
20:29:29.075409 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.46 seconds
20:29:29.090931 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingComments".
20:29:29.091213 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingComments: rename object "dbo"."AH_ListingComments" to AH_ListingComments__dbt_backup
20:29:29.097076 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:29.099106 [debug] [Thread-2  ]: On model.Shawn.AH_ListingEnddttmAudit: COMMIT
20:29:29.103333 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingEnddttmAudit".
20:29:29.103570 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingEnddttmAudit: 
    
  if object_id ('"dbo"."AH_ListingEnddttmAudit__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingEnddttmAudit__dbt_backup"
    end

20:29:29.124776 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 8.49 seconds
20:29:29.135809 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:29.143064 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActionproperties".
20:29:29.151834 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingActionproperties: rename object "dbo"."AH_ListingActionproperties" to AH_ListingActionproperties__dbt_backup
20:29:29.156895 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingComments".
20:29:29.157161 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingComments: rename object "dbo"."AH_ListingComments__dbt_tmp" to AH_ListingComments
20:29:29.180148 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:29.191864 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:29.193544 [debug] [Thread-3  ]: On model.Shawn.AH_ListingComments: COMMIT
20:29:29.197368 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActionproperties".
20:29:29.201491 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingActionproperties: rename object "dbo"."AH_ListingActionproperties__dbt_tmp" to AH_ListingActionproperties
20:29:29.201261 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingComments".
20:29:29.201784 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingComments: 
    
  if object_id ('"dbo"."AH_ListingComments__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingComments__dbt_backup"
    end

20:29:29.215972 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 8.58 seconds
20:29:29.231505 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions".
20:29:29.231888 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:29.233563 [debug] [Thread-1  ]: On model.Shawn.AH_ListingActionproperties: COMMIT
20:29:29.237611 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActionproperties".
20:29:29.237794 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingActionproperties: 
    
  if object_id ('"dbo"."AH_ListingActionproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingActionproperties__dbt_backup"
    end

20:29:29.232023 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingActions: rename object "dbo"."AH_ListingActions" to AH_ListingActions__dbt_backup
20:29:29.516105 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
20:29:29.531047 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions".
20:29:29.531320 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingActions: rename object "dbo"."AH_ListingActions__dbt_tmp" to AH_ListingActions
20:29:29.560731 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:29.562701 [debug] [Thread-4  ]: On model.Shawn.AH_ListingActions: COMMIT
20:29:29.567100 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions".
20:29:29.567320 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingActions: 
    
  if object_id ('"dbo"."AH_ListingActions__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingActions__dbt_backup"
    end

20:29:29.582828 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.48 seconds
20:29:29.596182 [debug] [Thread-2  ]: finished collecting timing info
20:29:29.596516 [debug] [Thread-2  ]: On model.Shawn.AH_ListingEnddttmAudit: Close
20:29:29.597264 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c4a9970>]}
20:29:29.597678 [info ] [Thread-2  ]: 47 of 105 OK created table model dbo.AH_ListingEnddttmAudit..................... [[32mOK[0m in 3.45s]
20:29:29.597986 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ListingEnddttmAudit
20:29:29.598146 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ListingLocations
20:29:29.598478 [info ] [Thread-2  ]: 48 of 105 START table model dbo.AH_ListingLocations............................. [RUN]
20:29:29.598915 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ListingLocations"
20:29:29.599026 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ListingLocations
20:29:29.599123 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ListingLocations
20:29:29.601775 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ListingLocations"
20:29:29.602187 [debug] [Thread-2  ]: finished collecting timing info
20:29:29.602309 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ListingLocations
20:29:29.639314 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ListingLocations"
20:29:29.639874 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingLocations".
20:29:29.640017 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingLocations: 
  
  if object_id ('"dbo"."AH_ListingLocations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingLocations__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingLocations__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingLocations__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingLocations__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([LocationID] as int) [LocationId],
	cast([ListingID] as int) [ListingId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_ListingLocations_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingLocations__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingLocations__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingLocations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingLocations__dbt_tmp_temp_view"
    end



20:29:29.640112 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:29:29.640220 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:30.013824 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:30.411139 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.17 seconds
20:29:30.424360 [debug] [Thread-1  ]: finished collecting timing info
20:29:30.424707 [debug] [Thread-1  ]: On model.Shawn.AH_ListingActionproperties: Close
20:29:30.425474 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c3949a0>]}
20:29:30.425907 [info ] [Thread-1  ]: 43 of 105 OK created table model dbo.AH_ListingActionproperties................. [[32mOK[0m in 9.88s]
20:29:30.426217 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ListingActionproperties
20:29:30.426377 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ListingMedias
20:29:30.426761 [info ] [Thread-1  ]: 49 of 105 START table model dbo.AH_ListingMedias................................ [RUN]
20:29:30.427167 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ListingMedias"
20:29:30.427276 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ListingMedias
20:29:30.427375 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ListingMedias
20:29:30.430187 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ListingMedias"
20:29:30.430423 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.23 seconds
20:29:30.439950 [debug] [Thread-1  ]: finished collecting timing info
20:29:30.440225 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ListingMedias
20:29:30.445909 [debug] [Thread-3  ]: finished collecting timing info
20:29:30.455870 [debug] [Thread-3  ]: On model.Shawn.AH_ListingComments: Close
20:29:30.456730 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c4240a0>]}
20:29:30.457151 [info ] [Thread-3  ]: 45 of 105 OK created table model dbo.AH_ListingComments......................... [[32mOK[0m in 7.89s]
20:29:30.457461 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingComments
20:29:30.457612 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingPaymentCharge
20:29:30.457938 [info ] [Thread-3  ]: 50 of 105 START table model dbo.AH_ListingPaymentCharge......................... [RUN]
20:29:30.458317 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingPaymentCharge"
20:29:30.458423 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingPaymentCharge
20:29:30.458515 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingPaymentCharge
20:29:30.461482 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingPaymentCharge"
20:29:30.461838 [debug] [Thread-3  ]: finished collecting timing info
20:29:30.461952 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingPaymentCharge
20:29:30.517700 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ListingMedias"
20:29:30.518242 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingMedias".
20:29:30.518385 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingMedias: 
  
  if object_id ('"dbo"."AH_ListingMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingMedias__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingMedias__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingMedias__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingMedias__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([MediaID] as int) [MediaId],
	cast([ListingID] as int) [ListingId],
	cast([DisplayOrder] as int) [DisplayOrder] 
From stg.[AH_ListingMedias_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingMedias__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingMedias__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingMedias__dbt_tmp_temp_view"
    end



20:29:30.518469 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:30.518624 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:30.527001 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingPaymentCharge"
20:29:30.527506 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge".
20:29:30.527644 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge: 
  
  if object_id ('"dbo"."AH_ListingPaymentCharge__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingPaymentCharge__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingPaymentCharge__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingPaymentCharge__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingPaymentCharge__dbt_tmp_temp_view as
    
Select
	cast([BuyerID] as int) [BuyerId],
	cast([ListingID] as int) [ListingId],
	cast([ID] as int) [Id],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([TransactionID] as nvarchar(30)) [TransactionId],
	cast([ChargeAmount] as decimal(24,2)) [ChargeAmount],
	cast([TotalBID] as decimal(24,2)) [TotalBid],
	cast([BidHoldPercentage] as decimal(24,3)) [BidHoldPercentage],
	cast([MaximumBidCharge] as decimal(24,2)) [MaximumBidCharge] 
From stg.[AH_ListingPaymentCharge_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingPaymentCharge__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingPaymentCharge__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingPaymentCharge__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingPaymentCharge__dbt_tmp_temp_view"
    end



20:29:30.527732 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:29:30.527839 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:30.627296 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:30.737872 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:30.795800 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.23 seconds
20:29:30.892382 [debug] [Thread-4  ]: finished collecting timing info
20:29:30.892738 [debug] [Thread-4  ]: On model.Shawn.AH_ListingActions: Close
20:29:30.893520 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c4d8eb0>]}
20:29:30.893960 [info ] [Thread-4  ]: 44 of 105 OK created table model dbo.AH_ListingActions.......................... [[32mOK[0m in 10.33s]
20:29:30.894276 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingActions
20:29:30.894447 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingQuestions
20:29:30.894842 [info ] [Thread-4  ]: 51 of 105 START table model dbo.AH_ListingQuestions............................. [RUN]
20:29:30.895266 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingQuestions"
20:29:30.895378 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingQuestions
20:29:30.895474 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingQuestions
20:29:30.898334 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingQuestions"
20:29:30.898838 [debug] [Thread-4  ]: finished collecting timing info
20:29:30.898982 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingQuestions
20:29:30.936111 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingQuestions"
20:29:30.936669 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingQuestions".
20:29:30.936812 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingQuestions: 
  
  if object_id ('"dbo"."AH_ListingQuestions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingQuestions__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingQuestions__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingQuestions__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingQuestions__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId],
	cast([ListingID] as int) [ListingId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([UserName] as nvarchar(4000)) [UserName],
	cast([Question] as nvarchar(4000)) [Question],
	cast([Answer] as nvarchar(4000)) [Answer] 
From stg.[AH_ListingQuestions_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingQuestions__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingQuestions__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingQuestions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingQuestions__dbt_tmp_temp_view"
    end



20:29:30.936900 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:29:30.937008 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:31.042619 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:32.826704 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.19 seconds
20:29:32.842773 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingLocations".
20:29:32.843031 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingLocations: rename object "dbo"."AH_ListingLocations" to AH_ListingLocations__dbt_backup
20:29:32.886945 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:32.902269 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingLocations".
20:29:32.902575 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingLocations: rename object "dbo"."AH_ListingLocations__dbt_tmp" to AH_ListingLocations
20:29:32.931109 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:32.933004 [debug] [Thread-2  ]: On model.Shawn.AH_ListingLocations: COMMIT
20:29:32.937615 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingLocations".
20:29:32.937816 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingLocations: 
    
  if object_id ('"dbo"."AH_ListingLocations__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingLocations__dbt_backup"
    end

20:29:33.387439 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.86 seconds
20:29:33.395807 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.46 seconds
20:29:33.410460 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge".
20:29:33.419720 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge: rename object "dbo"."AH_ListingPaymentCharge" to AH_ListingPaymentCharge__dbt_backup
20:29:33.419308 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingQuestions".
20:29:33.420010 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingQuestions: rename object "dbo"."AH_ListingQuestions" to AH_ListingQuestions__dbt_backup
20:29:33.452436 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:33.463819 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:33.468117 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge".
20:29:33.479812 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge: rename object "dbo"."AH_ListingPaymentCharge__dbt_tmp" to AH_ListingPaymentCharge
20:29:33.480998 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingQuestions".
20:29:33.481160 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingQuestions: rename object "dbo"."AH_ListingQuestions__dbt_tmp" to AH_ListingQuestions
20:29:33.509500 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:33.511651 [debug] [Thread-3  ]: On model.Shawn.AH_ListingPaymentCharge: COMMIT
20:29:33.516023 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge".
20:29:33.516242 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:33.517755 [debug] [Thread-4  ]: On model.Shawn.AH_ListingQuestions: COMMIT
20:29:33.521837 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingQuestions".
20:29:33.522027 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingQuestions: 
    
  if object_id ('"dbo"."AH_ListingQuestions__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingQuestions__dbt_backup"
    end

20:29:33.516378 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge: 
    
  if object_id ('"dbo"."AH_ListingPaymentCharge__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingPaymentCharge__dbt_backup"
    end

20:29:34.127757 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.19 seconds
20:29:34.141342 [debug] [Thread-2  ]: finished collecting timing info
20:29:34.141703 [debug] [Thread-2  ]: On model.Shawn.AH_ListingLocations: Close
20:29:34.142518 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c517040>]}
20:29:34.143026 [info ] [Thread-2  ]: 48 of 105 OK created table model dbo.AH_ListingLocations........................ [[32mOK[0m in 4.54s]
20:29:34.143341 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ListingLocations
20:29:34.143495 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ListingTypeFeeprovIDErs
20:29:34.143836 [info ] [Thread-2  ]: 52 of 105 START table model dbo.AH_ListingTypeFeeprovIDErs...................... [RUN]
20:29:34.144278 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ListingTypeFeeprovIDErs"
20:29:34.144393 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ListingTypeFeeprovIDErs
20:29:34.144495 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ListingTypeFeeprovIDErs
20:29:34.147346 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ListingTypeFeeprovIDErs"
20:29:34.147784 [debug] [Thread-2  ]: finished collecting timing info
20:29:34.147914 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ListingTypeFeeprovIDErs
20:29:34.154949 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.63 seconds
20:29:34.161298 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.64 seconds
20:29:34.182724 [debug] [Thread-3  ]: finished collecting timing info
20:29:34.197870 [debug] [Thread-3  ]: On model.Shawn.AH_ListingPaymentCharge: Close
20:29:34.198740 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5c6820>]}
20:29:34.208177 [info ] [Thread-3  ]: 50 of 105 OK created table model dbo.AH_ListingPaymentCharge.................... [[32mOK[0m in 3.74s]
20:29:34.208603 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingPaymentCharge
20:29:34.197493 [debug] [Thread-4  ]: finished collecting timing info
20:29:34.209094 [debug] [Thread-4  ]: On model.Shawn.AH_ListingQuestions: Close
20:29:34.209881 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c486fd0>]}
20:29:34.210284 [info ] [Thread-4  ]: 51 of 105 OK created table model dbo.AH_ListingQuestions........................ [[32mOK[0m in 3.31s]
20:29:34.208771 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingTypeMedia
20:29:34.210855 [info ] [Thread-3  ]: 53 of 105 START table model dbo.AH_ListingTypeMedia............................. [RUN]
20:29:34.211266 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingTypeMedia"
20:29:34.211381 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingTypeMedia
20:29:34.211483 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingTypeMedia
20:29:34.214314 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingTypeMedia"
20:29:34.210618 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingQuestions
20:29:34.214717 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingTypeproperties
20:29:34.215068 [info ] [Thread-4  ]: 54 of 105 START table model dbo.AH_ListingTypeproperties........................ [RUN]
20:29:34.215583 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingTypeproperties"
20:29:34.215700 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingTypeproperties
20:29:34.215797 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingTypeproperties
20:29:34.219053 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingTypeproperties"
20:29:34.227518 [debug] [Thread-4  ]: finished collecting timing info
20:29:34.227674 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingTypeproperties
20:29:34.227027 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ListingTypeFeeprovIDErs"
20:29:34.236459 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeFeeprovIDErs".
20:29:34.236603 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeFeeprovIDErs: 
  
  if object_id ('"dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view as
    
Select
	cast([ProvIDErName] as nvarchar(4000)) [ProviderName],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([ListingTypeID] as int) [ListingTypeId],
	cast([Enabled] as bit) [Enabled] 
From stg.[AH_ListingTypeFeeprovIDErs_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view"
    end



20:29:34.236701 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:29:34.236817 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:34.235892 [debug] [Thread-3  ]: finished collecting timing info
20:29:34.237865 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingTypeMedia
20:29:34.301223 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingTypeproperties"
20:29:34.314050 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeproperties".
20:29:34.314280 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeproperties: 
  
  if object_id ('"dbo"."AH_ListingTypeproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypeproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingTypeproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypeproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingTypeproperties__dbt_tmp_temp_view as
    
Select
	cast([StringnativeValue] as nvarchar(4000)) [StringNativeValue],
	cast([EnumnativeValue] as nvarchar(4000)) [EnumNativeValue],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Scope] as nvarchar(4000)) [Scope],
	cast([DecimalnativeValue] as numeric(19,4)) [DecimalNativeValue],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DateTimenativeValue] as datetime) [DateTimeNativeValue],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([ID] as int) [Id],
	cast([IntnativeValue] as int) [IntNativeValue],
	cast([CustomFieldID] as int) [CustomFieldId],
	cast([ListingTypeID] as int) [ListingTypeId],
	cast([BoolnativeValue] as bit) [BoolNativeValue] 
From stg.[AH_ListingTypeproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingTypeproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingTypeproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingTypeproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypeproperties__dbt_tmp_temp_view"
    end



20:29:34.314371 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:29:34.314486 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:34.319646 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingTypeMedia"
20:29:34.320215 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeMedia".
20:29:34.320373 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeMedia: 
  
  if object_id ('"dbo"."AH_ListingTypeMedia__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypeMedia__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingTypeMedia__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypeMedia__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingTypeMedia__dbt_tmp_temp_view as
    
Select
	cast([Enabled] as bit) [Enabled],
	cast([ID] as int) [Id],
	cast([ListingTypeID] as int) [ListingTypeId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([MediaassetName] as nvarchar(4000)) [MediaAssetName],
	cast([Scope] as nvarchar(4000)) [Scope] 
From stg.[AH_ListingTypeMedia_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingTypeMedia__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingTypeMedia__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingTypeMedia__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypeMedia__dbt_tmp_temp_view"
    end



20:29:34.320470 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:29:34.320586 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:34.348498 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:34.414491 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:34.426774 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:34.450588 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.93 seconds
20:29:34.466324 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingMedias".
20:29:34.466642 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingMedias: rename object "dbo"."AH_ListingMedias" to AH_ListingMedias__dbt_backup
20:29:34.505020 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:34.519640 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingMedias".
20:29:34.519902 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingMedias: rename object "dbo"."AH_ListingMedias__dbt_tmp" to AH_ListingMedias
20:29:34.574869 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:29:34.576823 [debug] [Thread-1  ]: On model.Shawn.AH_ListingMedias: COMMIT
20:29:34.581437 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingMedias".
20:29:34.581666 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingMedias: 
    
  if object_id ('"dbo"."AH_ListingMedias__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingMedias__dbt_backup"
    end

20:29:34.988535 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
20:29:35.001650 [debug] [Thread-1  ]: finished collecting timing info
20:29:35.001999 [debug] [Thread-1  ]: On model.Shawn.AH_ListingMedias: Close
20:29:35.002788 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c4d87c0>]}
20:29:35.003208 [info ] [Thread-1  ]: 49 of 105 OK created table model dbo.AH_ListingMedias........................... [[32mOK[0m in 4.58s]
20:29:35.003515 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ListingMedias
20:29:35.003665 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ListingTypes
20:29:35.003999 [info ] [Thread-1  ]: 55 of 105 START table model dbo.AH_ListingTypes................................. [RUN]
20:29:35.004359 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ListingTypes"
20:29:35.004467 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ListingTypes
20:29:35.004558 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ListingTypes
20:29:35.007199 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ListingTypes"
20:29:35.007534 [debug] [Thread-1  ]: finished collecting timing info
20:29:35.007649 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ListingTypes
20:29:35.044345 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ListingTypes"
20:29:35.044895 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypes".
20:29:35.045034 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingTypes: 
  
  if object_id ('"dbo"."AH_ListingTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypes__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingTypes__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypes__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingTypes__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_ListingTypes_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingTypes__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingTypes__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypes__dbt_tmp_temp_view"
    end



20:29:35.045119 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:35.045231 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:35.154942 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:36.920460 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.60 seconds
20:29:37.019416 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeMedia".
20:29:37.019686 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeMedia: rename object "dbo"."AH_ListingTypeMedia" to AH_ListingTypeMedia__dbt_backup
20:29:37.054255 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.74 seconds
20:29:37.063467 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:37.064738 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.83 seconds
20:29:37.073426 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeproperties".
20:29:37.079548 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeproperties: rename object "dbo"."AH_ListingTypeproperties" to AH_ListingTypeproperties__dbt_backup
20:29:37.093427 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeFeeprovIDErs".
20:29:37.100945 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeFeeprovIDErs: rename object "dbo"."AH_ListingTypeFeeprovIDErs" to AH_ListingTypeFeeprovIDErs__dbt_backup
20:29:37.100659 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeMedia".
20:29:37.101214 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeMedia: rename object "dbo"."AH_ListingTypeMedia__dbt_tmp" to AH_ListingTypeMedia
20:29:37.118004 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:37.132315 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeproperties".
20:29:37.132585 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:37.132767 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:37.134525 [debug] [Thread-3  ]: On model.Shawn.AH_ListingTypeMedia: COMMIT
20:29:37.132914 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeproperties: rename object "dbo"."AH_ListingTypeproperties__dbt_tmp" to AH_ListingTypeproperties
20:29:37.148744 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeFeeprovIDErs".
20:29:37.152923 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeFeeprovIDErs: rename object "dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp" to AH_ListingTypeFeeprovIDErs
20:29:37.152663 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeMedia".
20:29:37.153178 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeMedia: 
    
  if object_id ('"dbo"."AH_ListingTypeMedia__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypeMedia__dbt_backup"
    end

20:29:37.187949 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:37.189704 [debug] [Thread-4  ]: On model.Shawn.AH_ListingTypeproperties: COMMIT
20:29:37.193985 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeproperties".
20:29:37.194178 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeproperties: 
    
  if object_id ('"dbo"."AH_ListingTypeproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypeproperties__dbt_backup"
    end

20:29:37.200739 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:29:37.202643 [debug] [Thread-2  ]: On model.Shawn.AH_ListingTypeFeeprovIDErs: COMMIT
20:29:37.206781 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeFeeprovIDErs".
20:29:37.206986 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeFeeprovIDErs: 
    
  if object_id ('"dbo"."AH_ListingTypeFeeprovIDErs__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypeFeeprovIDErs__dbt_backup"
    end

20:29:37.477590 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
20:29:37.490365 [debug] [Thread-3  ]: finished collecting timing info
20:29:37.490737 [debug] [Thread-3  ]: On model.Shawn.AH_ListingTypeMedia: Close
20:29:37.491467 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c3df700>]}
20:29:37.491868 [info ] [Thread-3  ]: 53 of 105 OK created table model dbo.AH_ListingTypeMedia........................ [[32mOK[0m in 3.28s]
20:29:37.492165 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingTypeMedia
20:29:37.492325 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Listingdecorations
20:29:37.492655 [info ] [Thread-3  ]: 56 of 105 START table model dbo.AH_Listingdecorations........................... [RUN]
20:29:37.493109 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Listingdecorations"
20:29:37.493239 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:29:37.493347 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Listingdecorations
20:29:37.503875 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Listingdecorations
20:29:37.506996 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Listingdecorations"
20:29:37.507231 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:29:37.509343 [debug] [Thread-4  ]: finished collecting timing info
20:29:37.520281 [debug] [Thread-4  ]: On model.Shawn.AH_ListingTypeproperties: Close
20:29:37.519958 [debug] [Thread-3  ]: finished collecting timing info
20:29:37.520715 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Listingdecorations
20:29:37.522698 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5c4040>]}
20:29:37.523125 [info ] [Thread-4  ]: 54 of 105 OK created table model dbo.AH_ListingTypeproperties................... [[32mOK[0m in 3.31s]
20:29:37.523445 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingTypeproperties
20:29:37.523591 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Listingproperties
20:29:37.523918 [info ] [Thread-4  ]: 57 of 105 START table model dbo.AH_Listingproperties............................ [RUN]
20:29:37.524284 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Listingproperties"
20:29:37.524385 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Listingproperties
20:29:37.524477 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Listingproperties
20:29:37.527295 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Listingproperties"
20:29:37.540055 [debug] [Thread-4  ]: finished collecting timing info
20:29:37.540279 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Listingproperties
20:29:37.529608 [debug] [Thread-2  ]: finished collecting timing info
20:29:37.558047 [debug] [Thread-2  ]: On model.Shawn.AH_ListingTypeFeeprovIDErs: Close
20:29:37.558992 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c43f820>]}
20:29:37.568127 [info ] [Thread-2  ]: 52 of 105 OK created table model dbo.AH_ListingTypeFeeprovIDErs................. [[32mOK[0m in 3.41s]
20:29:37.568530 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ListingTypeFeeprovIDErs
20:29:37.568674 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Listings
20:29:37.568854 [info ] [Thread-2  ]: 58 of 105 START table model dbo.AH_Listings..................................... [RUN]
20:29:37.569269 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Listings"
20:29:37.569386 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Listings
20:29:37.569477 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Listings
20:29:37.572796 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Listings"
20:29:37.594212 [debug] [Thread-2  ]: finished collecting timing info
20:29:37.594454 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Listings
20:29:37.601907 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Listingdecorations"
20:29:37.603446 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingdecorations".
20:29:37.603591 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Listingdecorations: 
  
  if object_id ('"dbo"."AH_Listingdecorations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listingdecorations__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Listingdecorations__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Listingdecorations__dbt_tmp"
    end


   EXEC('create view dbo.AH_Listingdecorations__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([DecorationID] as int) [DecorationId],
	cast([ListingID] as int) [ListingId] 
From stg.[AH_Listingdecorations_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Listingdecorations__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Listingdecorations__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Listingdecorations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listingdecorations__dbt_tmp_temp_view"
    end



20:29:37.603676 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:29:37.603793 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:37.635660 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Listingproperties"
20:29:37.636165 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingproperties".
20:29:37.636306 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Listingproperties: 
  
  if object_id ('"dbo"."AH_Listingproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listingproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Listingproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Listingproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_Listingproperties__dbt_tmp_temp_view as
    
Select
	cast([DecimalnativeValue] as decimal(29,14)) [DecimalnativeValue],
	cast([StringnativeValue] as nvarchar(4000)) [StringnativeValue],
	cast([EnumnativeValue] as nvarchar(200)) [EnumnativeValue],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([CreatedOn] as datetime) [Createdon],
	cast([UpdatedOn] as datetime) [Updatedon],
	cast([DeletedOn] as datetime) [Deletedon],
	cast([DateTimenativeValue] as datetime) [DateTimenativeValue],
	cast([BoolnativeValue] as bit) [BoolnativeValue],
	cast([ID] as int) [ID],
	cast([IntnativeValue] as int) [IntnativeValue],
	cast([ListingID] as int) [ListingID],
	cast([CustomFieldID] as int) [CustomFieldID] 
From stg.[AH_Listingproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Listingproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Listingproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Listingproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listingproperties__dbt_tmp_temp_view"
    end



20:29:37.636394 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:29:37.636500 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:37.659028 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Listings"
20:29:37.659531 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings".
20:29:37.659675 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Listings: 
  
  if object_id ('"dbo"."AH_Listings__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listings__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Listings__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Listings__dbt_tmp"
    end


   EXEC('create view dbo.AH_Listings__dbt_tmp_temp_view as
    
Select
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([PrimaryImageURI] as nvarchar(2048)) [PrimaryImageURI],
	cast([OwnerUserName] as nvarchar(500)) [OwnerUserName],
	cast([CurrentListingActionUserName] as nvarchar(500)) [CurrentListingActionUserName],
	cast([Title] as nvarchar(4000)) [Title],
	cast([Description] as nvarchar(4000)) [Description],
	cast([SubTitle] as nvarchar(4000)) [Subtitle],
	cast([Location] as nvarchar(4000)) [Location],
	cast([Status] as nvarchar(100)) [Status],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Enddttm] as datetime) [EndDTTM],
	cast([Startdttm] as datetime) [StartDTTM],
	cast([AutoreListrEMAining] as int) [AutoRelistRemaining],
	cast([CurrentQuantity] as int) [CurrentQuantity],
	cast([OriginalQuantity] as int) [OriginalQuantity],
	cast([ReListiteration] as int) [RelistIteration],
	cast([LotID] as int) [LotId],
	cast([AcceptedActionCount] as int) [AcceptedActionCount],
	cast([OwnerID] as int) [OwnerId],
	cast([ListingTypeID] as int) [ListingTypeId],
	cast([Duration] as int) [Duration],
	cast([Version] as int) [Version],
	cast([CurrencyID] as money) [CurrencyId],
	cast([PrimaryCategoryID] as int) [PrimaryCategoryId],
	cast([CurrentListingActionID] as int) [CurrentListingActionID],
	cast([OfferCount] as int) [OfferCount],
	cast([ID] as int) [Id],
	cast([OriginalreListCount] as int) [OriginalRelistCount],
	cast([Hits] as int) [Hits],
	cast([CurrentPrice] as decimal(24,2)) [CurrentPrice],
	cast([Increment] as decimal(24,2)) [Increment],
	cast([OriginalPrice] as money) [OriginalPrice] 
From stg.[AH_Listings_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Listings__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Listings__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Listings__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listings__dbt_tmp_temp_view"
    end



20:29:37.659767 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:29:37.659870 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:37.702073 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:37.741346 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:37.764463 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.72 seconds
20:29:37.775916 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:37.782028 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypes".
20:29:37.782316 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingTypes: rename object "dbo"."AH_ListingTypes" to AH_ListingTypes__dbt_backup
20:29:37.811390 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:37.826723 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypes".
20:29:37.826991 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingTypes: rename object "dbo"."AH_ListingTypes__dbt_tmp" to AH_ListingTypes
20:29:37.860500 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:37.862322 [debug] [Thread-1  ]: On model.Shawn.AH_ListingTypes: COMMIT
20:29:37.867155 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypes".
20:29:37.867418 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingTypes: 
    
  if object_id ('"dbo"."AH_ListingTypes__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypes__dbt_backup"
    end

20:29:38.089346 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:29:38.103551 [debug] [Thread-1  ]: finished collecting timing info
20:29:38.103918 [debug] [Thread-1  ]: On model.Shawn.AH_ListingTypes: Close
20:29:38.104699 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c4b59d0>]}
20:29:38.105126 [info ] [Thread-1  ]: 55 of 105 OK created table model dbo.AH_ListingTypes............................ [[32mOK[0m in 3.10s]
20:29:38.105438 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ListingTypes
20:29:38.105609 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ListingsReserveHistory
20:29:38.105940 [info ] [Thread-1  ]: 59 of 105 START table model dbo.AH_ListingsReserveHistory....................... [RUN]
20:29:38.106458 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ListingsReserveHistory"
20:29:38.106629 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ListingsReserveHistory
20:29:38.106735 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ListingsReserveHistory
20:29:38.109448 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ListingsReserveHistory"
20:29:38.109865 [debug] [Thread-1  ]: finished collecting timing info
20:29:38.109990 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ListingsReserveHistory
20:29:38.148202 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ListingsReserveHistory"
20:29:38.148743 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingsReserveHistory".
20:29:38.148886 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingsReserveHistory: 
  
  if object_id ('"dbo"."AH_ListingsReserveHistory__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingsReserveHistory__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingsReserveHistory__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingsReserveHistory__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingsReserveHistory__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([ListingID] as int) [ListingId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([OldReserve] as numeric(19,4)) [OldReserve],
	cast([NewReserve] as numeric(19,4)) [NewReserve] 
From stg.[AH_ListingsReserveHistory_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingsReserveHistory__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingsReserveHistory__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingsReserveHistory__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingsReserveHistory__dbt_tmp_temp_view"
    end



20:29:38.148972 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:38.149077 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:38.272357 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:40.742897 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.08 seconds
20:29:40.750587 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.15 seconds
20:29:40.766645 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings".
20:29:40.776848 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Listings: rename object "dbo"."AH_Listings" to AH_Listings__dbt_backup
20:29:40.779353 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingdecorations".
20:29:40.779615 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Listingdecorations: rename object "dbo"."AH_Listingdecorations" to AH_Listingdecorations__dbt_backup
20:29:40.810224 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:40.822035 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.67 seconds
20:29:40.826485 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingdecorations".
20:29:40.836033 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Listingdecorations: rename object "dbo"."AH_Listingdecorations__dbt_tmp" to AH_Listingdecorations
20:29:40.835732 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:29:40.841343 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingsReserveHistory".
20:29:40.926867 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingsReserveHistory: rename object "dbo"."AH_ListingsReserveHistory" to AH_ListingsReserveHistory__dbt_backup
20:29:40.927249 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:29:40.928669 [debug] [Thread-3  ]: On model.Shawn.AH_Listingdecorations: COMMIT
20:29:40.935964 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingdecorations".
20:29:40.936187 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Listingdecorations: 
    
  if object_id ('"dbo"."AH_Listingdecorations__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Listingdecorations__dbt_backup"
    end

20:29:40.943313 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings".
20:29:40.943550 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Listings: rename object "dbo"."AH_Listings__dbt_tmp" to AH_Listings
20:29:40.959186 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:40.973438 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingsReserveHistory".
20:29:40.973686 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:40.975424 [debug] [Thread-2  ]: On model.Shawn.AH_Listings: COMMIT
20:29:40.973838 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingsReserveHistory: rename object "dbo"."AH_ListingsReserveHistory__dbt_tmp" to AH_ListingsReserveHistory
20:29:40.979305 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings".
20:29:40.979689 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Listings: 
    
  if object_id ('"dbo"."AH_Listings__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Listings__dbt_backup"
    end

20:29:41.007418 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:41.009154 [debug] [Thread-1  ]: On model.Shawn.AH_ListingsReserveHistory: COMMIT
20:29:41.013283 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingsReserveHistory".
20:29:41.013464 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingsReserveHistory: 
    
  if object_id ('"dbo"."AH_ListingsReserveHistory__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingsReserveHistory__dbt_backup"
    end

20:29:41.483828 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.55 seconds
20:29:41.496814 [debug] [Thread-3  ]: finished collecting timing info
20:29:41.497149 [debug] [Thread-3  ]: On model.Shawn.AH_Listingdecorations: Close
20:29:41.497890 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c3755b0>]}
20:29:41.498311 [info ] [Thread-3  ]: 56 of 105 OK created table model dbo.AH_Listingdecorations...................... [[32mOK[0m in 4.00s]
20:29:41.498669 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Listingdecorations
20:29:41.498825 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Locations
20:29:41.499153 [info ] [Thread-3  ]: 60 of 105 START table model dbo.AH_Locations.................................... [RUN]
20:29:41.499522 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Locations"
20:29:41.499634 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Locations
20:29:41.499729 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Locations
20:29:41.502293 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Locations"
20:29:41.502666 [debug] [Thread-3  ]: finished collecting timing info
20:29:41.502788 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Locations
20:29:41.520190 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.54 seconds
20:29:41.534802 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.52 seconds
20:29:41.541700 [debug] [Thread-2  ]: finished collecting timing info
20:29:41.547422 [debug] [Thread-2  ]: On model.Shawn.AH_Listings: Close
20:29:41.548278 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c2f1fa0>]}
20:29:41.565457 [debug] [Thread-1  ]: finished collecting timing info
20:29:41.569783 [debug] [Thread-1  ]: On model.Shawn.AH_ListingsReserveHistory: Close
20:29:41.569462 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Locations"
20:29:41.570966 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Locations".
20:29:41.571086 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Locations: 
  
  if object_id ('"dbo"."AH_Locations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Locations__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Locations__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Locations__dbt_tmp"
    end


   EXEC('create view dbo.AH_Locations__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Amount] as numeric(19,4)) [Amount],
	cast([PayToproceed] as bit) [PayToProceed],
	cast([ID] as int) [Id] 
From stg.[AH_Locations_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Locations__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Locations__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Locations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Locations__dbt_tmp_temp_view"
    end



20:29:41.571177 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:29:41.571286 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:41.570506 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5c4580>]}
20:29:41.677998 [info ] [Thread-2  ]: 58 of 105 OK created table model dbo.AH_Listings................................ [[32mOK[0m in 3.98s]
20:29:41.678678 [info ] [Thread-1  ]: 59 of 105 OK created table model dbo.AH_ListingsReserveHistory.................. [[32mOK[0m in 3.46s]
20:29:41.679471 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Listings
20:29:41.679615 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ListingsReserveHistory
20:29:41.679885 [debug] [Thread-1  ]: Began running node model.Shawn.AH_LogentriesBuffer
20:29:41.680058 [info ] [Thread-1  ]: 62 of 105 START table model dbo.AH_LogentriesBuffer............................. [RUN]
20:29:41.680507 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_LogentriesBuffer"
20:29:41.680619 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_LogentriesBuffer
20:29:41.680713 [debug] [Thread-1  ]: Compiling model.Shawn.AH_LogentriesBuffer
20:29:41.679762 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Logentries
20:29:41.684413 [info ] [Thread-2  ]: 61 of 105 START table model dbo.AH_Logentries................................... [RUN]
20:29:41.684839 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Logentries"
20:29:41.684948 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Logentries
20:29:41.685037 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Logentries
20:29:41.687517 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Logentries"
20:29:41.687948 [debug] [Thread-2  ]: finished collecting timing info
20:29:41.688076 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Logentries
20:29:41.683982 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_LogentriesBuffer"
20:29:41.694199 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:41.694589 [debug] [Thread-1  ]: finished collecting timing info
20:29:41.694892 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_LogentriesBuffer
20:29:41.757785 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Logentries"
20:29:41.758311 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logentries".
20:29:41.758447 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logentries: 
  
  if object_id ('"dbo"."AH_Logentries__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Logentries__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Logentries__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Logentries__dbt_tmp"
    end


   EXEC('create view dbo.AH_Logentries__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([Priority] as int) [Priority],
	cast([EventID] as int) [EventID],
	cast([SqlDaTestamp] as datetime) [SQLDateStamp],
	cast([EntryDaTestamp] as datetime) [EntryDateStamp],
	cast([MachineName] as nvarchar(4000)) [MachineName],
	cast([Message] as nvarchar(4000)) [Message],
	cast([Title] as nvarchar(4000)) [Title],
	cast([FunctionalArea] as nvarchar(4000)) [FunctionalArea],
	cast([Severity] as nvarchar(4000)) [Severity],
	cast([Actor] as nvarchar(4000)) [Actor],
	cast([ExceptionClass] as nvarchar(4000)) [ExceptionClass],
	cast([Stacktrace] as nvarchar(4000)) [StackTrace],
	cast([Properties] as nvarchar(4000)) [Properties] 
From stg.[AH_Logentries_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Logentries__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Logentries__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Logentries__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Logentries__dbt_tmp_temp_view"
    end



20:29:41.758579 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:29:41.762510 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:41.762287 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_LogentriesBuffer"
20:29:41.763760 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LogentriesBuffer".
20:29:41.763889 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_LogentriesBuffer: 
  
  if object_id ('"dbo"."AH_LogentriesBuffer__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_LogentriesBuffer__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_LogentriesBuffer__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_LogentriesBuffer__dbt_tmp"
    end


   EXEC('create view dbo.AH_LogentriesBuffer__dbt_tmp_temp_view as
    
Select
	cast([Message] as nvarchar(4000)) [Message],
	cast([Properties] as nvarchar(4000)) [Properties],
	cast([MachineName] as nvarchar(4000)) [MachineName],
	cast([Title] as nvarchar(4000)) [Title],
	cast([FunctionalArea] as nvarchar(4000)) [FunctionalArea],
	cast([Severity] as nvarchar(4000)) [Severity],
	cast([Actor] as nvarchar(4000)) [Actor],
	cast([ExceptionClass] as nvarchar(4000)) [ExceptionClass],
	cast([Stacktrace] as nvarchar(4000)) [StackTrace],
	cast([SqlDaTestamp] as datetime) [SQLDateStamp],
	cast([EntryDaTestamp] as datetime) [EntryDateStamp],
	cast([ID] as int) [Id],
	cast([Priority] as int) [Priority],
	cast([EventID] as int) [EventID] 
From stg.[AH_LogentriesBuffer_FinalView]
    ');

  CREATE TABLE "dbo"."AH_LogentriesBuffer__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_LogentriesBuffer__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_LogentriesBuffer__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_LogentriesBuffer__dbt_tmp_temp_view"
    end



20:29:41.763971 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:41.764068 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:41.864716 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:41.872081 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:44.570870 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.00 seconds
20:29:44.584844 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Locations".
20:29:44.585107 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Locations: rename object "dbo"."AH_Locations" to AH_Locations__dbt_backup
20:29:44.618032 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:44.632161 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Locations".
20:29:44.632422 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Locations: rename object "dbo"."AH_Locations__dbt_tmp" to AH_Locations
20:29:44.659970 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:44.661721 [debug] [Thread-3  ]: On model.Shawn.AH_Locations: COMMIT
20:29:44.666078 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Locations".
20:29:44.666262 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Locations: 
    
  if object_id ('"dbo"."AH_Locations__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Locations__dbt_backup"
    end

20:29:44.782857 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.02 seconds
20:29:44.797738 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LogentriesBuffer".
20:29:44.797995 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_LogentriesBuffer: rename object "dbo"."AH_LogentriesBuffer" to AH_LogentriesBuffer__dbt_backup
20:29:44.838435 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:44.852237 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LogentriesBuffer".
20:29:44.852502 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_LogentriesBuffer: rename object "dbo"."AH_LogentriesBuffer__dbt_tmp" to AH_LogentriesBuffer
20:29:44.854375 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:29:44.866518 [debug] [Thread-3  ]: finished collecting timing info
20:29:44.866850 [debug] [Thread-3  ]: On model.Shawn.AH_Locations: Close
20:29:44.867567 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5c46d0>]}
20:29:44.867967 [info ] [Thread-3  ]: 60 of 105 OK created table model dbo.AH_Locations............................... [[32mOK[0m in 3.37s]
20:29:44.868263 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Locations
20:29:44.868411 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Logstats
20:29:44.868747 [info ] [Thread-3  ]: 63 of 105 START table model dbo.AH_Logstats..................................... [RUN]
20:29:44.869104 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Logstats"
20:29:44.869210 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Logstats
20:29:44.869303 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Logstats
20:29:44.871895 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Logstats"
20:29:44.872223 [debug] [Thread-3  ]: finished collecting timing info
20:29:44.872334 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Logstats
20:29:44.889748 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:44.891436 [debug] [Thread-1  ]: On model.Shawn.AH_LogentriesBuffer: COMMIT
20:29:44.895540 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LogentriesBuffer".
20:29:44.907785 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_LogentriesBuffer: 
    
  if object_id ('"dbo"."AH_LogentriesBuffer__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_LogentriesBuffer__dbt_backup"
    end

20:29:44.915337 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Logstats"
20:29:44.915800 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats".
20:29:44.915928 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Logstats: 
  
  if object_id ('"dbo"."AH_Logstats__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Logstats__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Logstats__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Logstats__dbt_tmp"
    end


   EXEC('create view dbo.AH_Logstats__dbt_tmp_temp_view as
    
Select
	cast([FromDate] as datetime) [FromDate],
	cast([RangeMinutes] as int) [RangeMinutes],
	cast([EntryCount] as int) [EntryCount],
	cast([IsArchived] as bit) [IsArchived],
	cast([Severity] as nvarchar(4000)) [Severity] 
From stg.[AH_Logstats_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Logstats__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Logstats__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Logstats__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Logstats__dbt_tmp_temp_view"
    end



20:29:44.916021 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:29:44.916123 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:45.050000 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:45.206945 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:29:45.220382 [debug] [Thread-1  ]: finished collecting timing info
20:29:45.220719 [debug] [Thread-1  ]: On model.Shawn.AH_LogentriesBuffer: Close
20:29:45.221487 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c452400>]}
20:29:45.221918 [info ] [Thread-1  ]: 62 of 105 OK created table model dbo.AH_LogentriesBuffer........................ [[32mOK[0m in 3.54s]
20:29:45.222229 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_LogentriesBuffer
20:29:45.222382 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Lots
20:29:45.222748 [info ] [Thread-1  ]: 64 of 105 START table model dbo.AH_Lots......................................... [RUN]
20:29:45.223123 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Lots"
20:29:45.223231 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Lots
20:29:45.223323 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Lots
20:29:45.225868 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Lots"
20:29:45.226193 [debug] [Thread-1  ]: finished collecting timing info
20:29:45.226301 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Lots
20:29:45.262006 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Lots"
20:29:45.262597 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Lots".
20:29:45.262769 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Lots: 
  
  if object_id ('"dbo"."AH_Lots__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Lots__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Lots__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Lots__dbt_tmp"
    end


   EXEC('create view dbo.AH_Lots__dbt_tmp_temp_view as
    
Select
	cast([LotNumber] as nvarchar(4000)) [LotNumber],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([IsSoftclosing] as bit) [IsSoftClosing],
	cast([SoftclosingGroup] as int) [SoftClosingGroup],
	cast([LotOrder] as int) [LotOrder],
	cast([AuctionEventID] as int) [AuctionEventID],
	cast([ID] as int) [Id],
	cast([ClosingGroup] as int) [ClosingGroup],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_Lots_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Lots__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Lots__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Lots__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Lots__dbt_tmp_temp_view"
    end



20:29:45.262863 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:45.262973 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:45.368578 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:47.383917 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 5.63 seconds
20:29:47.400028 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logentries".
20:29:47.400277 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logentries: rename object "dbo"."AH_Logentries" to AH_Logentries__dbt_backup
20:29:47.436551 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:47.450452 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logentries".
20:29:47.450744 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logentries: rename object "dbo"."AH_Logentries__dbt_tmp" to AH_Logentries
20:29:47.493601 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:47.495454 [debug] [Thread-2  ]: On model.Shawn.AH_Logentries: COMMIT
20:29:47.499666 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logentries".
20:29:47.499822 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.58 seconds
20:29:47.499940 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logentries: 
    
  if object_id ('"dbo"."AH_Logentries__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Logentries__dbt_backup"
    end

20:29:47.513963 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats".
20:29:47.514163 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Logstats: rename object "dbo"."AH_Logstats" to AH_Logstats__dbt_backup
20:29:47.544044 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:47.557809 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats".
20:29:47.558084 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Logstats: rename object "dbo"."AH_Logstats__dbt_tmp" to AH_Logstats
20:29:47.586711 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:47.588586 [debug] [Thread-3  ]: On model.Shawn.AH_Logstats: COMMIT
20:29:47.593122 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats".
20:29:47.593347 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Logstats: 
    
  if object_id ('"dbo"."AH_Logstats__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Logstats__dbt_backup"
    end

20:29:47.952988 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.44 seconds
20:29:47.966694 [debug] [Thread-2  ]: finished collecting timing info
20:29:47.967000 [debug] [Thread-2  ]: On model.Shawn.AH_Logentries: Close
20:29:47.967723 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c9576a0>]}
20:29:47.968115 [info ] [Thread-2  ]: 61 of 105 OK created table model dbo.AH_Logentries.............................. [[32mOK[0m in 6.28s]
20:29:47.968412 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Logentries
20:29:47.968566 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Media
20:29:47.968873 [info ] [Thread-2  ]: 65 of 105 START table model dbo.AH_Media........................................ [RUN]
20:29:47.969227 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Media"
20:29:47.969333 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Media
20:29:47.969425 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Media
20:29:47.971975 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Media"
20:29:47.972294 [debug] [Thread-2  ]: finished collecting timing info
20:29:47.972403 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Media
20:29:48.007881 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Media"
20:29:48.008401 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Media".
20:29:48.008540 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Media: 
  
  if object_id ('"dbo"."AH_Media__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Media__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Media__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Media__dbt_tmp"
    end


   EXEC('create view dbo.AH_Media__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([GUID] as uniqueidentifier) [GUID],
	cast([DefaultvariationName] as nvarchar(500)) [DefaultVariationName],
	cast([Loader] as nvarchar(500)) [Loader],
	cast([Saver] as nvarchar(500)) [Saver],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([ConText] as nvarchar(4000)) [Context],
	cast([Status] as nvarchar(100)) [Status] 
From stg.[AH_Media_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Media__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Media__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Media__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Media__dbt_tmp_temp_view"
    end



20:29:48.008624 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:29:48.008726 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:48.216171 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:48.231424 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.64 seconds
20:29:48.244170 [debug] [Thread-3  ]: finished collecting timing info
20:29:48.244489 [debug] [Thread-3  ]: On model.Shawn.AH_Logstats: Close
20:29:48.245205 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c777370>]}
20:29:48.245614 [info ] [Thread-3  ]: 63 of 105 OK created table model dbo.AH_Logstats................................ [[32mOK[0m in 3.38s]
20:29:48.245913 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Logstats
20:29:48.246067 [debug] [Thread-3  ]: Began running node model.Shawn.AH_MediaMetaData
20:29:48.246387 [info ] [Thread-3  ]: 66 of 105 START table model dbo.AH_MediaMetaData................................ [RUN]
20:29:48.246798 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_MediaMetaData"
20:29:48.246910 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_MediaMetaData
20:29:48.247003 [debug] [Thread-3  ]: Compiling model.Shawn.AH_MediaMetaData
20:29:48.249461 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_MediaMetaData"
20:29:48.249765 [debug] [Thread-3  ]: finished collecting timing info
20:29:48.249872 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_MediaMetaData
20:29:48.285288 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_MediaMetaData"
20:29:48.285799 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaMetaData".
20:29:48.285942 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_MediaMetaData: 
  
  if object_id ('"dbo"."AH_MediaMetaData__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_MediaMetaData__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_MediaMetaData__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_MediaMetaData__dbt_tmp"
    end


   EXEC('create view dbo.AH_MediaMetaData__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(500)) [Name],
	cast([Value] as nvarchar(4000)) [Value],
	cast([ID] as int) [Id],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_MediaMetaData_FinalView]
    ');

  CREATE TABLE "dbo"."AH_MediaMetaData__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_MediaMetaData__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_MediaMetaData__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_MediaMetaData__dbt_tmp_temp_view"
    end



20:29:48.286032 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:29:48.286136 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:48.391796 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:29:48.714648 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.45 seconds
20:29:48.730422 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Lots".
20:29:48.730758 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Lots: rename object "dbo"."AH_Lots" to AH_Lots__dbt_backup
20:29:48.768026 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:29:48.782593 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Lots".
20:29:48.782876 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Lots: rename object "dbo"."AH_Lots__dbt_tmp" to AH_Lots
20:29:48.815243 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:29:48.817251 [debug] [Thread-1  ]: On model.Shawn.AH_Lots: COMMIT
20:29:48.821311 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Lots".
20:29:48.821501 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Lots: 
    
  if object_id ('"dbo"."AH_Lots__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Lots__dbt_backup"
    end

20:29:49.244115 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.42 seconds
20:29:49.337987 [debug] [Thread-1  ]: finished collecting timing info
20:29:49.338335 [debug] [Thread-1  ]: On model.Shawn.AH_Lots: Close
20:29:49.339123 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5578e0>]}
20:29:49.339562 [info ] [Thread-1  ]: 64 of 105 OK created table model dbo.AH_Lots.................................... [[32mOK[0m in 4.12s]
20:29:49.339875 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Lots
20:29:49.340027 [debug] [Thread-1  ]: Began running node model.Shawn.AH_MediaassetMetaData
20:29:49.340355 [info ] [Thread-1  ]: 67 of 105 START table model dbo.AH_MediaassetMetaData........................... [RUN]
20:29:49.340726 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_MediaassetMetaData"
20:29:49.340833 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_MediaassetMetaData
20:29:49.340925 [debug] [Thread-1  ]: Compiling model.Shawn.AH_MediaassetMetaData
20:29:49.343635 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_MediaassetMetaData"
20:29:49.343965 [debug] [Thread-1  ]: finished collecting timing info
20:29:49.344077 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_MediaassetMetaData
20:29:49.380712 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_MediaassetMetaData"
20:29:49.381254 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaassetMetaData".
20:29:49.381396 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_MediaassetMetaData: 
  
  if object_id ('"dbo"."AH_MediaassetMetaData__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_MediaassetMetaData__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_MediaassetMetaData__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_MediaassetMetaData__dbt_tmp"
    end


   EXEC('create view dbo.AH_MediaassetMetaData__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([MediaassetID] as int) [MediaAssetId],
	cast([MediaMetaDataID] as int) [MediaMetaDataId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_MediaassetMetaData_FinalView]
    ');

  CREATE TABLE "dbo"."AH_MediaassetMetaData__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_MediaassetMetaData__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_MediaassetMetaData__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_MediaassetMetaData__dbt_tmp_temp_view"
    end



20:29:49.381486 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:49.381593 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:29:49.523324 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:30:01.131772 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 11.75 seconds
20:30:01.147435 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaassetMetaData".
20:30:01.147706 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_MediaassetMetaData: rename object "dbo"."AH_MediaassetMetaData" to AH_MediaassetMetaData__dbt_backup
20:30:01.182213 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:30:01.196161 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaassetMetaData".
20:30:01.196437 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_MediaassetMetaData: rename object "dbo"."AH_MediaassetMetaData__dbt_tmp" to AH_MediaassetMetaData
20:30:01.224712 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:30:01.226387 [debug] [Thread-1  ]: On model.Shawn.AH_MediaassetMetaData: COMMIT
20:30:01.230398 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaassetMetaData".
20:30:01.230609 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_MediaassetMetaData: 
    
  if object_id ('"dbo"."AH_MediaassetMetaData__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_MediaassetMetaData__dbt_backup"
    end

20:30:01.440804 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:30:01.456093 [debug] [Thread-1  ]: finished collecting timing info
20:30:01.456460 [debug] [Thread-1  ]: On model.Shawn.AH_MediaassetMetaData: Close
20:30:01.457234 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5e2190>]}
20:30:01.457747 [info ] [Thread-1  ]: 67 of 105 OK created table model dbo.AH_MediaassetMetaData...................... [[32mOK[0m in 12.12s]
20:30:01.458065 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_MediaassetMetaData
20:30:01.458326 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Mediaassets
20:30:01.458747 [info ] [Thread-1  ]: 68 of 105 START table model dbo.AH_Mediaassets.................................. [RUN]
20:30:01.459186 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Mediaassets"
20:30:01.459294 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Mediaassets
20:30:01.459390 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Mediaassets
20:30:01.462303 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Mediaassets"
20:30:01.462741 [debug] [Thread-1  ]: finished collecting timing info
20:30:01.462868 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Mediaassets
20:30:01.506627 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Mediaassets"
20:30:01.507173 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediaassets".
20:30:01.507320 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Mediaassets: 
  
  if object_id ('"dbo"."AH_Mediaassets__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Mediaassets__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Mediaassets__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Mediaassets__dbt_tmp"
    end


   EXEC('create view dbo.AH_Mediaassets__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DaTestamp] as datetime) [DateStamp],
	cast([ID] as int) [Id],
	cast([Type] as nvarchar(500)) [Type],
	cast([Reference] as nvarchar(4000)) [Reference],
	cast([Sha1] as nvarchar(4000)) [SHA1] 
From stg.[AH_Mediaassets_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Mediaassets__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Mediaassets__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Mediaassets__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Mediaassets__dbt_tmp_temp_view"
    end



20:30:01.507405 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:30:01.507511 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:30:01.637260 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:30:25.087420 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 37.08 seconds
20:30:25.101665 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Media".
20:30:25.101915 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Media: rename object "dbo"."AH_Media" to AH_Media__dbt_backup
20:30:25.173521 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:30:25.187404 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Media".
20:30:25.187662 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Media: rename object "dbo"."AH_Media__dbt_tmp" to AH_Media
20:30:25.216947 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:30:25.218652 [debug] [Thread-2  ]: On model.Shawn.AH_Media: COMMIT
20:30:25.222580 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Media".
20:30:25.222759 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Media: 
    
  if object_id ('"dbo"."AH_Media__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Media__dbt_backup"
    end

20:30:25.424409 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:30:25.436927 [debug] [Thread-2  ]: finished collecting timing info
20:30:25.437248 [debug] [Thread-2  ]: On model.Shawn.AH_Media: Close
20:30:25.437974 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c4b74c0>]}
20:30:25.438385 [info ] [Thread-2  ]: 65 of 105 OK created table model dbo.AH_Media................................... [[32mOK[0m in 37.47s]
20:30:25.438758 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Media
20:30:25.438909 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Mediavariations
20:30:25.439224 [info ] [Thread-2  ]: 69 of 105 START table model dbo.AH_Mediavariations.............................. [RUN]
20:30:25.439589 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Mediavariations"
20:30:25.439688 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Mediavariations
20:30:25.439776 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Mediavariations
20:30:25.442236 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Mediavariations"
20:30:25.442567 [debug] [Thread-2  ]: finished collecting timing info
20:30:25.442689 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Mediavariations
20:30:25.476219 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Mediavariations"
20:30:25.476771 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediavariations".
20:30:25.476915 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Mediavariations: 
  
  if object_id ('"dbo"."AH_Mediavariations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Mediavariations__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Mediavariations__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Mediavariations__dbt_tmp"
    end


   EXEC('create view dbo.AH_Mediavariations__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([MediaassetID] as int) [MediaAssetId],
	cast([MediaID] as int) [MediaId],
	cast([Name] as nvarchar(500)) [Name] 
From stg.[AH_Mediavariations_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Mediavariations__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Mediavariations__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Mediavariations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Mediavariations__dbt_tmp_temp_view"
    end



20:30:25.477000 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:30:25.477104 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:30:25.614228 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:30:41.623978 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 16.15 seconds
20:30:41.637879 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediavariations".
20:30:41.638137 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Mediavariations: rename object "dbo"."AH_Mediavariations" to AH_Mediavariations__dbt_backup
20:30:41.703157 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:30:41.715963 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediavariations".
20:30:41.716192 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Mediavariations: rename object "dbo"."AH_Mediavariations__dbt_tmp" to AH_Mediavariations
20:30:41.745448 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:30:41.747268 [debug] [Thread-2  ]: On model.Shawn.AH_Mediavariations: COMMIT
20:30:41.751300 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediavariations".
20:30:41.751478 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Mediavariations: 
    
  if object_id ('"dbo"."AH_Mediavariations__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Mediavariations__dbt_backup"
    end

20:30:41.947630 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:30:41.960893 [debug] [Thread-2  ]: finished collecting timing info
20:30:41.961211 [debug] [Thread-2  ]: On model.Shawn.AH_Mediavariations: Close
20:30:41.961916 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5e22e0>]}
20:30:41.962356 [info ] [Thread-2  ]: 69 of 105 OK created table model dbo.AH_Mediavariations......................... [[32mOK[0m in 16.52s]
20:30:41.962716 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Mediavariations
20:30:41.962867 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Model
20:30:41.963171 [info ] [Thread-2  ]: 70 of 105 START table model dbo.AH_Model........................................ [RUN]
20:30:41.963522 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Model"
20:30:41.963620 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Model
20:30:41.963709 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Model
20:30:41.966124 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Model"
20:30:41.966458 [debug] [Thread-2  ]: finished collecting timing info
20:30:41.966615 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Model
20:30:42.000775 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Model"
20:30:42.001309 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Model".
20:30:42.001458 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Model: 
  
  if object_id ('"dbo"."AH_Model__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Model__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Model__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Model__dbt_tmp"
    end


   EXEC('create view dbo.AH_Model__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_Model_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Model__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Model__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Model__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Model__dbt_tmp_temp_view"
    end



20:30:42.001543 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:30:42.001652 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:30:42.112653 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:30:44.503204 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.50 seconds
20:30:44.517428 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Model".
20:30:44.517680 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Model: rename object "dbo"."AH_Model" to AH_Model__dbt_backup
20:30:44.552890 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:30:44.567120 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Model".
20:30:44.567375 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Model: rename object "dbo"."AH_Model__dbt_tmp" to AH_Model
20:30:44.596155 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:30:44.597920 [debug] [Thread-2  ]: On model.Shawn.AH_Model: COMMIT
20:30:44.602135 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Model".
20:30:44.602311 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Model: 
    
  if object_id ('"dbo"."AH_Model__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Model__dbt_backup"
    end

20:30:44.815686 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:30:44.827504 [debug] [Thread-2  ]: finished collecting timing info
20:30:44.827799 [debug] [Thread-2  ]: On model.Shawn.AH_Model: Close
20:30:44.828477 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c50c580>]}
20:30:44.828882 [info ] [Thread-2  ]: 70 of 105 OK created table model dbo.AH_Model................................... [[32mOK[0m in 2.87s]
20:30:44.829178 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Model
20:30:44.829326 [debug] [Thread-2  ]: Began running node model.Shawn.AH_NewSalestoInvoice
20:30:44.829621 [info ] [Thread-2  ]: 71 of 105 START table model dbo.AH_NewSalestoInvoice............................ [RUN]
20:30:44.829963 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_NewSalestoInvoice"
20:30:44.830063 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_NewSalestoInvoice
20:30:44.830151 [debug] [Thread-2  ]: Compiling model.Shawn.AH_NewSalestoInvoice
20:30:44.832544 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_NewSalestoInvoice"
20:30:44.832853 [debug] [Thread-2  ]: finished collecting timing info
20:30:44.832970 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_NewSalestoInvoice
20:30:44.866552 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_NewSalestoInvoice"
20:30:44.867068 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_NewSalestoInvoice".
20:30:44.867201 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_NewSalestoInvoice: 
  
  if object_id ('"dbo"."AH_NewSalestoInvoice__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_NewSalestoInvoice__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_NewSalestoInvoice__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_NewSalestoInvoice__dbt_tmp"
    end


   EXEC('create view dbo.AH_NewSalestoInvoice__dbt_tmp_temp_view as
    
Select
	cast([LineItemID] as int) [LineItemId] 
From stg.[AH_NewSalestoInvoice_FinalView]
    ');

  CREATE TABLE "dbo"."AH_NewSalestoInvoice__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_NewSalestoInvoice__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_NewSalestoInvoice__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_NewSalestoInvoice__dbt_tmp_temp_view"
    end



20:30:44.867281 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:30:44.867384 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:30:44.988012 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:30:47.214764 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.35 seconds
20:30:47.228904 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_NewSalestoInvoice".
20:30:47.229141 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_NewSalestoInvoice: rename object "dbo"."AH_NewSalestoInvoice" to AH_NewSalestoInvoice__dbt_backup
20:30:47.259618 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:30:47.272492 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_NewSalestoInvoice".
20:30:47.272746 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_NewSalestoInvoice: rename object "dbo"."AH_NewSalestoInvoice__dbt_tmp" to AH_NewSalestoInvoice
20:30:47.307764 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:30:47.309425 [debug] [Thread-2  ]: On model.Shawn.AH_NewSalestoInvoice: COMMIT
20:30:47.313224 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_NewSalestoInvoice".
20:30:47.313375 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_NewSalestoInvoice: 
    
  if object_id ('"dbo"."AH_NewSalestoInvoice__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_NewSalestoInvoice__dbt_backup"
    end

20:30:47.506852 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:30:47.518681 [debug] [Thread-2  ]: finished collecting timing info
20:30:47.518970 [debug] [Thread-2  ]: On model.Shawn.AH_NewSalestoInvoice: Close
20:30:47.519655 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5e2970>]}
20:30:47.520053 [info ] [Thread-2  ]: 71 of 105 OK created table model dbo.AH_NewSalestoInvoice....................... [[32mOK[0m in 2.69s]
20:30:47.520361 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_NewSalestoInvoice
20:30:47.520510 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Notifications
20:30:47.520796 [info ] [Thread-2  ]: 72 of 105 START table model dbo.AH_Notifications................................ [RUN]
20:30:47.521138 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Notifications"
20:30:47.521238 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Notifications
20:30:47.521328 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Notifications
20:30:47.523767 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Notifications"
20:30:47.524073 [debug] [Thread-2  ]: finished collecting timing info
20:30:47.524177 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Notifications
20:30:47.557416 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Notifications"
20:30:47.557919 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Notifications".
20:30:47.558050 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Notifications: 
  
  if object_id ('"dbo"."AH_Notifications__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Notifications__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Notifications__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Notifications__dbt_tmp"
    end


   EXEC('create view dbo.AH_Notifications__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([DetailID] as int) [DetailID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Queueddttm] as datetime) [QueuedDTTM],
	cast([Statusdttm] as datetime) [StatusDTTM],
	cast([RecipientEmail] as nvarchar(4000)) [RecipientEmail],
	cast([CcEmail] as nvarchar(4000)) [CCEmail],
	cast([BCcEmail] as nvarchar(4000)) [BCCEmail],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Status] as nvarchar(4000)) [Status],
	cast([StatusMessage] as nvarchar(4000)) [StatusMessage],
	cast([Message] as nvarchar(4000)) [Message],
	cast([DetailType] as nvarchar(4000)) [DetailType],
	cast([ReplytoEmail] as nvarchar(4000)) [ReplyToEmail],
	cast([SEnderUserName] as nvarchar(4000)) [SenderUserName],
	cast([ReceiverUserName] as nvarchar(4000)) [ReceiverUserName],
	cast([Template] as nvarchar(4000)) [Template] 
From stg.[AH_Notifications_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Notifications__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Notifications__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Notifications__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Notifications__dbt_tmp_temp_view"
    end



20:30:47.558133 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:30:47.558234 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:30:47.675702 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:30:50.343178 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.78 seconds
20:30:50.424139 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Notifications".
20:30:50.424400 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Notifications: rename object "dbo"."AH_Notifications" to AH_Notifications__dbt_backup
20:30:50.456866 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:30:50.469374 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Notifications".
20:30:50.469618 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Notifications: rename object "dbo"."AH_Notifications__dbt_tmp" to AH_Notifications
20:30:50.498715 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:30:50.500289 [debug] [Thread-2  ]: On model.Shawn.AH_Notifications: COMMIT
20:30:50.504266 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Notifications".
20:30:50.504451 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Notifications: 
    
  if object_id ('"dbo"."AH_Notifications__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Notifications__dbt_backup"
    end

20:30:50.688057 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:30:50.700057 [debug] [Thread-2  ]: finished collecting timing info
20:30:50.700358 [debug] [Thread-2  ]: On model.Shawn.AH_Notifications: Close
20:30:50.701011 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c958a60>]}
20:30:50.701409 [info ] [Thread-2  ]: 72 of 105 OK created table model dbo.AH_Notifications........................... [[32mOK[0m in 3.18s]
20:30:50.701730 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Notifications
20:30:50.701877 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Offers
20:30:50.702161 [info ] [Thread-2  ]: 73 of 105 START table model dbo.AH_Offers....................................... [RUN]
20:30:50.702494 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Offers"
20:30:50.702631 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Offers
20:30:50.702724 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Offers
20:30:50.705110 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Offers"
20:30:50.705417 [debug] [Thread-2  ]: finished collecting timing info
20:30:50.705522 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Offers
20:30:50.738699 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Offers"
20:30:50.739182 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Offers".
20:30:50.739312 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Offers: 
  
  if object_id ('"dbo"."AH_Offers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Offers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Offers__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Offers__dbt_tmp"
    end


   EXEC('create view dbo.AH_Offers__dbt_tmp_temp_view as
    
Select
	cast([Amount] as numeric(19,4)) [Amount],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([OfferMessage] as nvarchar(4000)) [OfferMessage],
	cast([Status] as nvarchar(4000)) [Status],
	cast([DecLineMessage] as nvarchar(4000)) [DeclineMessage],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Expirationdttm] as datetime) [ExpirationDTTM],
	cast([ID] as int) [Id],
	cast([SEndingUserID] as int) [SendingUserId],
	cast([ReceivINgUserID] as int) [ReceivingUserId],
	cast([BuyerID] as int) [BuyerId],
	cast([Quantity] as int) [Quantity],
	cast([ListingID] as int) [ListingId] 
From stg.[AH_Offers_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Offers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Offers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Offers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Offers__dbt_tmp_temp_view"
    end



20:30:50.739394 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:30:50.739491 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:30:50.839446 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:30:53.184806 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.45 seconds
20:30:53.199537 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Offers".
20:30:53.199778 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Offers: rename object "dbo"."AH_Offers" to AH_Offers__dbt_backup
20:30:53.230808 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:30:53.243735 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Offers".
20:30:53.243992 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Offers: rename object "dbo"."AH_Offers__dbt_tmp" to AH_Offers
20:30:53.272638 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:30:53.274381 [debug] [Thread-2  ]: On model.Shawn.AH_Offers: COMMIT
20:30:53.278247 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Offers".
20:30:53.278403 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Offers: 
    
  if object_id ('"dbo"."AH_Offers__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Offers__dbt_backup"
    end

20:30:53.456850 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:30:53.468347 [debug] [Thread-2  ]: finished collecting timing info
20:30:53.468668 [debug] [Thread-2  ]: On model.Shawn.AH_Offers: Close
20:30:53.469373 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5c6250>]}
20:30:53.469773 [info ] [Thread-2  ]: 73 of 105 OK created table model dbo.AH_Offers.................................. [[32mOK[0m in 2.77s]
20:30:53.470084 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Offers
20:30:53.470237 [debug] [Thread-2  ]: Began running node model.Shawn.AH_PaymentConfigurationTable
20:30:53.470530 [info ] [Thread-2  ]: 74 of 105 START table model dbo.AH_PaymentConfigurationTable.................... [RUN]
20:30:53.470921 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_PaymentConfigurationTable"
20:30:53.471021 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_PaymentConfigurationTable
20:30:53.471110 [debug] [Thread-2  ]: Compiling model.Shawn.AH_PaymentConfigurationTable
20:30:53.473535 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_PaymentConfigurationTable"
20:30:53.473860 [debug] [Thread-2  ]: finished collecting timing info
20:30:53.473968 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_PaymentConfigurationTable
20:30:53.508150 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_PaymentConfigurationTable"
20:30:53.508664 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentConfigurationTable".
20:30:53.508808 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_PaymentConfigurationTable: 
  
  if object_id ('"dbo"."AH_PaymentConfigurationTable__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PaymentConfigurationTable__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_PaymentConfigurationTable__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_PaymentConfigurationTable__dbt_tmp"
    end


   EXEC('create view dbo.AH_PaymentConfigurationTable__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([Active] as bit) [Active],
	cast([MinimumBidHold] as numeric(19,4)) [MinimumBidHold],
	cast([BasicplanPrice] as numeric(19,4)) [BasicPlanPrice],
	cast([ProPhotographyPrice] as numeric(19,4)) [ProPhotographyPrice],
	cast([ProMarketingPrice] as numeric(19,4)) [ProMarketingPrice],
	cast([Minfraudscore] as numeric(19,4)) [minFraudScore],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([MaximumBidCharge] as numeric(19,4)) [MaximumBidCharge],
	cast([BidHoldPercentage] as numeric(19,4)) [BidHoldPercentage] 
From stg.[AH_PaymentConfigurationTable_FinalView]
    ');

  CREATE TABLE "dbo"."AH_PaymentConfigurationTable__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_PaymentConfigurationTable__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_PaymentConfigurationTable__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PaymentConfigurationTable__dbt_tmp_temp_view"
    end



20:30:53.508898 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:30:53.509003 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:30:53.621933 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:30:56.269789 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.76 seconds
20:30:56.284027 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentConfigurationTable".
20:30:56.284293 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_PaymentConfigurationTable: rename object "dbo"."AH_PaymentConfigurationTable" to AH_PaymentConfigurationTable__dbt_backup
20:30:56.319650 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:30:56.334130 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentConfigurationTable".
20:30:56.334399 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_PaymentConfigurationTable: rename object "dbo"."AH_PaymentConfigurationTable__dbt_tmp" to AH_PaymentConfigurationTable
20:30:56.363481 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:30:56.365299 [debug] [Thread-2  ]: On model.Shawn.AH_PaymentConfigurationTable: COMMIT
20:30:56.369849 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentConfigurationTable".
20:30:56.370104 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_PaymentConfigurationTable: 
    
  if object_id ('"dbo"."AH_PaymentConfigurationTable__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_PaymentConfigurationTable__dbt_backup"
    end

20:30:56.575690 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:30:56.588135 [debug] [Thread-2  ]: finished collecting timing info
20:30:56.588466 [debug] [Thread-2  ]: On model.Shawn.AH_PaymentConfigurationTable: Close
20:30:56.589193 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c8caa90>]}
20:30:56.589615 [info ] [Thread-2  ]: 74 of 105 OK created table model dbo.AH_PaymentConfigurationTable............... [[32mOK[0m in 3.12s]
20:30:56.589927 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_PaymentConfigurationTable
20:30:56.590085 [debug] [Thread-2  ]: Began running node model.Shawn.AH_PaymentResponses
20:30:56.590388 [info ] [Thread-2  ]: 75 of 105 START table model dbo.AH_PaymentResponses............................. [RUN]
20:30:56.590808 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_PaymentResponses"
20:30:56.590923 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_PaymentResponses
20:30:56.591018 [debug] [Thread-2  ]: Compiling model.Shawn.AH_PaymentResponses
20:30:56.593631 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_PaymentResponses"
20:30:56.593979 [debug] [Thread-2  ]: finished collecting timing info
20:30:56.594093 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_PaymentResponses
20:30:56.629851 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_PaymentResponses"
20:30:56.630393 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentResponses".
20:30:56.630531 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_PaymentResponses: 
  
  if object_id ('"dbo"."AH_PaymentResponses__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PaymentResponses__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_PaymentResponses__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_PaymentResponses__dbt_tmp"
    end


   EXEC('create view dbo.AH_PaymentResponses__dbt_tmp_temp_view as
    
Select
	cast([Approved] as bit) [Approved],
	cast([ID] as int) [Id],
	cast([InvoiceID] as int) [InvoiceId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DaTestamp] as datetime) [DateStamp],
	cast([Amount] as numeric(19,4)) [Amount],
	cast([AuthorizationCode] as nvarchar(4000)) [AuthorizationCode],
	cast([AvsResponseCode] as nvarchar(4000)) [AVSResponseCode],
	cast([Cvv2ResponseCode] as nvarchar(4000)) [CVV2ResponseCode],
	cast([CavResponseCode] as nvarchar(4000)) [CAVResponseCode],
	cast([BuyerStreet] as nvarchar(4000)) [BuyerStreet],
	cast([BuyerCity] as nvarchar(4000)) [BuyerCity],
	cast([ResponseStatus] as nvarchar(4000)) [ResponseStatus],
	cast([ProvIDEr] as nvarchar(4000)) [Provider],
	cast([RawResponseCode] as nvarchar(4000)) [RawResponseCode],
	cast([Description] as nvarchar(4000)) [Description],
	cast([TransactionID] as nvarchar(4000)) [TransactionID],
	cast([Method] as nvarchar(4000)) [Method],
	cast([BuyerStateregion] as nvarchar(4000)) [BuyerStateRegion],
	cast([BuyerzipPostal] as nvarchar(4000)) [BuyerZipPostal],
	cast([BuyerEmail] as nvarchar(4000)) [BuyerEmail],
	cast([AllFields] as nvarchar(4000)) [AllFields],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_PaymentResponses_FinalView]
    ');

  CREATE TABLE "dbo"."AH_PaymentResponses__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_PaymentResponses__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_PaymentResponses__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PaymentResponses__dbt_tmp_temp_view"
    end



20:30:56.630670 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:30:56.630777 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:30:56.729207 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:30:59.398481 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.77 seconds
20:30:59.412372 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentResponses".
20:30:59.412634 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_PaymentResponses: rename object "dbo"."AH_PaymentResponses" to AH_PaymentResponses__dbt_backup
20:30:59.447380 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:30:59.460937 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentResponses".
20:30:59.461190 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_PaymentResponses: rename object "dbo"."AH_PaymentResponses__dbt_tmp" to AH_PaymentResponses
20:30:59.489808 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:30:59.491602 [debug] [Thread-2  ]: On model.Shawn.AH_PaymentResponses: COMMIT
20:30:59.495784 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentResponses".
20:30:59.495972 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_PaymentResponses: 
    
  if object_id ('"dbo"."AH_PaymentResponses__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_PaymentResponses__dbt_backup"
    end

20:30:59.699712 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:30:59.712474 [debug] [Thread-2  ]: finished collecting timing info
20:30:59.712796 [debug] [Thread-2  ]: On model.Shawn.AH_PaymentResponses: Close
20:30:59.713485 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c4b8700>]}
20:30:59.713895 [info ] [Thread-2  ]: 75 of 105 OK created table model dbo.AH_PaymentResponses........................ [[32mOK[0m in 3.12s]
20:30:59.714198 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_PaymentResponses
20:30:59.714353 [debug] [Thread-2  ]: Began running node model.Shawn.AH_PaymentprovIDErs
20:30:59.714711 [info ] [Thread-2  ]: 76 of 105 START table model dbo.AH_PaymentprovIDErs............................. [RUN]
20:30:59.715084 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_PaymentprovIDErs"
20:30:59.715184 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_PaymentprovIDErs
20:30:59.715272 [debug] [Thread-2  ]: Compiling model.Shawn.AH_PaymentprovIDErs
20:30:59.717691 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_PaymentprovIDErs"
20:30:59.718016 [debug] [Thread-2  ]: finished collecting timing info
20:30:59.718125 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_PaymentprovIDErs
20:30:59.752183 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_PaymentprovIDErs"
20:30:59.752707 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentprovIDErs".
20:30:59.752848 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_PaymentprovIDErs: 
  
  if object_id ('"dbo"."AH_PaymentprovIDErs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PaymentprovIDErs__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_PaymentprovIDErs__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_PaymentprovIDErs__dbt_tmp"
    end


   EXEC('create view dbo.AH_PaymentprovIDErs__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([Batchcapable] as bit) [BatchCapable],
	cast([ID] as int) [Id] 
From stg.[AH_PaymentprovIDErs_FinalView]
    ');

  CREATE TABLE "dbo"."AH_PaymentprovIDErs__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_PaymentprovIDErs__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_PaymentprovIDErs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PaymentprovIDErs__dbt_tmp_temp_view"
    end



20:30:59.752930 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:30:59.753031 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:30:59.857220 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:02.155332 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.40 seconds
20:31:02.170119 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentprovIDErs".
20:31:02.170376 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_PaymentprovIDErs: rename object "dbo"."AH_PaymentprovIDErs" to AH_PaymentprovIDErs__dbt_backup
20:31:02.204444 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:02.218282 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentprovIDErs".
20:31:02.218569 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_PaymentprovIDErs: rename object "dbo"."AH_PaymentprovIDErs__dbt_tmp" to AH_PaymentprovIDErs
20:31:02.247583 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:02.249255 [debug] [Thread-2  ]: On model.Shawn.AH_PaymentprovIDErs: COMMIT
20:31:02.253335 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentprovIDErs".
20:31:02.253584 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_PaymentprovIDErs: 
    
  if object_id ('"dbo"."AH_PaymentprovIDErs__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_PaymentprovIDErs__dbt_backup"
    end

20:31:02.436843 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:31:02.449307 [debug] [Thread-2  ]: finished collecting timing info
20:31:02.449631 [debug] [Thread-2  ]: On model.Shawn.AH_PaymentprovIDErs: Close
20:31:02.450369 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5b2040>]}
20:31:02.450853 [info ] [Thread-2  ]: 76 of 105 OK created table model dbo.AH_PaymentprovIDErs........................ [[32mOK[0m in 2.74s]
20:31:02.451177 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_PaymentprovIDErs
20:31:02.451329 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Properties
20:31:02.451625 [info ] [Thread-2  ]: 77 of 105 START table model dbo.AH_Properties................................... [RUN]
20:31:02.451983 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Properties"
20:31:02.452086 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Properties
20:31:02.452178 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Properties
20:31:02.454665 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Properties"
20:31:02.455009 [debug] [Thread-2  ]: finished collecting timing info
20:31:02.455120 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Properties
20:31:02.489676 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Properties"
20:31:02.490209 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Properties".
20:31:02.490345 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Properties: 
  
  if object_id ('"dbo"."AH_Properties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Properties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Properties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Properties__dbt_tmp"
    end


   EXEC('create view dbo.AH_Properties__dbt_tmp_temp_view as
    
Select
	cast([Value] as nvarchar(4000)) [Value],
	cast([Name] as nvarchar(4000)) [Name],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([LineItemID] as int) [LineItemId] 
From stg.[AH_Properties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Properties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Properties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Properties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Properties__dbt_tmp_temp_view"
    end



20:31:02.490426 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:31:02.490529 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:02.605241 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:04.855822 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.37 seconds
20:31:04.871256 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Properties".
20:31:04.871523 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Properties: rename object "dbo"."AH_Properties" to AH_Properties__dbt_backup
20:31:04.906703 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:31:04.920996 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Properties".
20:31:04.921252 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Properties: rename object "dbo"."AH_Properties__dbt_tmp" to AH_Properties
20:31:04.949307 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:04.950980 [debug] [Thread-2  ]: On model.Shawn.AH_Properties: COMMIT
20:31:04.955348 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Properties".
20:31:04.955560 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Properties: 
    
  if object_id ('"dbo"."AH_Properties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Properties__dbt_backup"
    end

20:31:05.171567 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:31:05.184876 [debug] [Thread-2  ]: finished collecting timing info
20:31:05.185194 [debug] [Thread-2  ]: On model.Shawn.AH_Properties: Close
20:31:05.185963 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5b2190>]}
20:31:05.186408 [info ] [Thread-2  ]: 77 of 105 OK created table model dbo.AH_Properties.............................. [[32mOK[0m in 2.73s]
20:31:05.186782 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Properties
20:31:05.186934 [debug] [Thread-2  ]: Began running node model.Shawn.AH_PropertybagItems
20:31:05.187244 [info ] [Thread-2  ]: 78 of 105 START table model dbo.AH_PropertybagItems............................. [RUN]
20:31:05.187631 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_PropertybagItems"
20:31:05.187739 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_PropertybagItems
20:31:05.187833 [debug] [Thread-2  ]: Compiling model.Shawn.AH_PropertybagItems
20:31:05.190528 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_PropertybagItems"
20:31:05.190987 [debug] [Thread-2  ]: finished collecting timing info
20:31:05.191107 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_PropertybagItems
20:31:05.225633 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_PropertybagItems"
20:31:05.226160 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PropertybagItems".
20:31:05.226295 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_PropertybagItems: 
  
  if object_id ('"dbo"."AH_PropertybagItems__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PropertybagItems__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_PropertybagItems__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_PropertybagItems__dbt_tmp"
    end


   EXEC('create view dbo.AH_PropertybagItems__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([PropertybagID] as int) [PropertyBagId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name],
	cast([Value] as nvarchar(4000)) [Value] 
From stg.[AH_PropertybagItems_FinalView]
    ');

  CREATE TABLE "dbo"."AH_PropertybagItems__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_PropertybagItems__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_PropertybagItems__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PropertybagItems__dbt_tmp_temp_view"
    end



20:31:05.226374 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:31:05.226488 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:05.341516 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:07.581951 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.36 seconds
20:31:07.596477 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PropertybagItems".
20:31:07.596746 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_PropertybagItems: rename object "dbo"."AH_PropertybagItems" to AH_PropertybagItems__dbt_backup
20:31:07.715962 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:31:07.730707 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PropertybagItems".
20:31:07.730971 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_PropertybagItems: rename object "dbo"."AH_PropertybagItems__dbt_tmp" to AH_PropertybagItems
20:31:07.760655 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:07.762441 [debug] [Thread-2  ]: On model.Shawn.AH_PropertybagItems: COMMIT
20:31:07.766859 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PropertybagItems".
20:31:07.767079 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_PropertybagItems: 
    
  if object_id ('"dbo"."AH_PropertybagItems__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_PropertybagItems__dbt_backup"
    end

20:31:07.953121 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:31:07.966386 [debug] [Thread-2  ]: finished collecting timing info
20:31:07.966736 [debug] [Thread-2  ]: On model.Shawn.AH_PropertybagItems: Close
20:31:07.967472 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5b22e0>]}
20:31:07.967876 [info ] [Thread-2  ]: 78 of 105 OK created table model dbo.AH_PropertybagItems........................ [[32mOK[0m in 2.78s]
20:31:07.968186 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_PropertybagItems
20:31:07.968340 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Propertybags
20:31:07.968648 [info ] [Thread-2  ]: 79 of 105 START table model dbo.AH_Propertybags................................. [RUN]
20:31:07.968999 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Propertybags"
20:31:07.969097 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Propertybags
20:31:07.969187 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Propertybags
20:31:07.971669 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Propertybags"
20:31:07.972000 [debug] [Thread-2  ]: finished collecting timing info
20:31:07.972109 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Propertybags
20:31:08.006641 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Propertybags"
20:31:08.007159 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Propertybags".
20:31:08.007293 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Propertybags: 
  
  if object_id ('"dbo"."AH_Propertybags__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Propertybags__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Propertybags__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Propertybags__dbt_tmp"
    end


   EXEC('create view dbo.AH_Propertybags__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id] 
From stg.[AH_Propertybags_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Propertybags__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Propertybags__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Propertybags__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Propertybags__dbt_tmp_temp_view"
    end



20:31:08.007375 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:31:08.007480 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:08.120509 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:10.580419 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.57 seconds
20:31:10.664420 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Propertybags".
20:31:10.664670 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Propertybags: rename object "dbo"."AH_Propertybags" to AH_Propertybags__dbt_backup
20:31:10.705076 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:31:10.719183 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Propertybags".
20:31:10.719438 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Propertybags: rename object "dbo"."AH_Propertybags__dbt_tmp" to AH_Propertybags
20:31:10.749709 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:10.751405 [debug] [Thread-2  ]: On model.Shawn.AH_Propertybags: COMMIT
20:31:10.755406 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Propertybags".
20:31:10.755588 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Propertybags: 
    
  if object_id ('"dbo"."AH_Propertybags__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Propertybags__dbt_backup"
    end

20:31:10.974421 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:31:10.987139 [debug] [Thread-2  ]: finished collecting timing info
20:31:10.987431 [debug] [Thread-2  ]: On model.Shawn.AH_Propertybags: Close
20:31:10.988124 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5b2430>]}
20:31:10.988513 [info ] [Thread-2  ]: 79 of 105 OK created table model dbo.AH_Propertybags............................ [[32mOK[0m in 3.02s]
20:31:10.988804 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Propertybags
20:31:10.988951 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ReListHistory
20:31:10.989245 [info ] [Thread-2  ]: 80 of 105 START table model dbo.AH_ReListHistory................................ [RUN]
20:31:10.989602 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ReListHistory"
20:31:10.989702 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ReListHistory
20:31:10.989793 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ReListHistory
20:31:10.992318 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ReListHistory"
20:31:10.992651 [debug] [Thread-2  ]: finished collecting timing info
20:31:10.992761 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ReListHistory
20:31:11.026843 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ReListHistory"
20:31:11.027358 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ReListHistory".
20:31:11.027490 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ReListHistory: 
  
  if object_id ('"dbo"."AH_ReListHistory__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ReListHistory__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ReListHistory__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ReListHistory__dbt_tmp"
    end


   EXEC('create view dbo.AH_ReListHistory__dbt_tmp_temp_view as
    
Select
	cast([CurrentPrice_Old] as numeric(19,4)) [CurrentPrice_Old],
	cast([CurrentPrice_New] as numeric(19,4)) [CurrentPrice_New],
	cast([ReservePrice] as numeric(19,4)) [ReservePrice],
	cast([ID] as int) [Id],
	cast([ListingID] as int) [ListingId],
	cast([NewreListiteration] as int) [NewRelistIteration],
	cast([Duration_Old] as int) [Duration_Old],
	cast([Duration_New] as int) [Duration_New],
	cast([HighBidderID] as int) [HighBidderId],
	cast([BidCount] as int) [BidCount],
	cast([Startdttm_New] as datetime) [StartDTTM_New],
	cast([Enddttm_Old] as datetime) [EndDTTM_Old],
	cast([Enddttm_New] as datetime) [EndDTTM_New],
	cast([ReListdttm] as datetime) [RelistDTTM],
	cast([Startdttm_Old] as datetime) [StartDTTM_Old],
	cast([MaxBidAmount] as numeric(19,4)) [MaxBidAmount],
	cast([ProxyBidAmount] as numeric(19,4)) [ProxyBidAmount],
	cast([BidIncrement] as numeric(19,4)) [BidIncrement],
	cast([ListingTitle] as nvarchar(4000)) [ListingTitle] 
From stg.[AH_ReListHistory_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ReListHistory__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ReListHistory__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ReListHistory__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ReListHistory__dbt_tmp_temp_view"
    end



20:31:11.027580 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:31:11.027683 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:11.142069 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:13.435196 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.41 seconds
20:31:13.448965 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ReListHistory".
20:31:13.449207 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ReListHistory: rename object "dbo"."AH_ReListHistory" to AH_ReListHistory__dbt_backup
20:31:13.484122 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:13.497600 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ReListHistory".
20:31:13.497859 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ReListHistory: rename object "dbo"."AH_ReListHistory__dbt_tmp" to AH_ReListHistory
20:31:13.528245 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:13.530040 [debug] [Thread-2  ]: On model.Shawn.AH_ReListHistory: COMMIT
20:31:13.534096 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ReListHistory".
20:31:13.534277 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ReListHistory: 
    
  if object_id ('"dbo"."AH_ReListHistory__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ReListHistory__dbt_backup"
    end

20:31:13.734887 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:31:13.747338 [debug] [Thread-2  ]: finished collecting timing info
20:31:13.747644 [debug] [Thread-2  ]: On model.Shawn.AH_ReListHistory: Close
20:31:13.748315 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5b2580>]}
20:31:13.748734 [info ] [Thread-2  ]: 80 of 105 OK created table model dbo.AH_ReListHistory........................... [[32mOK[0m in 2.76s]
20:31:13.749030 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ReListHistory
20:31:13.749180 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Reports
20:31:13.749469 [info ] [Thread-2  ]: 81 of 105 START table model dbo.AH_Reports...................................... [RUN]
20:31:13.749813 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Reports"
20:31:13.749908 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Reports
20:31:13.749999 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Reports
20:31:13.752485 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Reports"
20:31:13.752814 [debug] [Thread-2  ]: finished collecting timing info
20:31:13.752920 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Reports
20:31:13.787028 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Reports"
20:31:13.787544 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Reports".
20:31:13.787678 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Reports: 
  
  if object_id ('"dbo"."AH_Reports__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Reports__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Reports__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Reports__dbt_tmp"
    end


   EXEC('create view dbo.AH_Reports__dbt_tmp_temp_view as
    
Select
	cast([SecondstogeneRate] as numeric(19,4)) [SecondsToGenerate],
	cast([ReportName] as nvarchar(4000)) [ReportName],
	cast([Data] as nvarchar(4000)) [Data],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId] 
From stg.[AH_Reports_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Reports__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Reports__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Reports__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Reports__dbt_tmp_temp_view"
    end



20:31:13.787759 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:31:13.787858 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:13.902590 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:16.105373 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.32 seconds
20:31:16.120198 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Reports".
20:31:16.120441 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Reports: rename object "dbo"."AH_Reports" to AH_Reports__dbt_backup
20:31:16.169078 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:31:16.183108 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Reports".
20:31:16.183353 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Reports: rename object "dbo"."AH_Reports__dbt_tmp" to AH_Reports
20:31:16.220655 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:31:16.222418 [debug] [Thread-2  ]: On model.Shawn.AH_Reports: COMMIT
20:31:16.226768 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Reports".
20:31:16.226947 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Reports: 
    
  if object_id ('"dbo"."AH_Reports__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Reports__dbt_backup"
    end

20:31:16.546089 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
20:31:16.558458 [debug] [Thread-2  ]: finished collecting timing info
20:31:16.558792 [debug] [Thread-2  ]: On model.Shawn.AH_Reports: Close
20:31:16.559476 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5b26d0>]}
20:31:16.559874 [info ] [Thread-2  ]: 81 of 105 OK created table model dbo.AH_Reports................................. [[32mOK[0m in 2.81s]
20:31:16.560171 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Reports
20:31:16.560317 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Roles
20:31:16.560603 [info ] [Thread-2  ]: 82 of 105 START table model dbo.AH_Roles........................................ [RUN]
20:31:16.560941 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Roles"
20:31:16.561038 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Roles
20:31:16.561128 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Roles
20:31:16.563551 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Roles"
20:31:16.563863 [debug] [Thread-2  ]: finished collecting timing info
20:31:16.563969 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Roles
20:31:16.597654 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Roles"
20:31:16.598189 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Roles".
20:31:16.598335 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Roles: 
  
  if object_id ('"dbo"."AH_Roles__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Roles__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Roles__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Roles__dbt_tmp"
    end


   EXEC('create view dbo.AH_Roles__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([Name] as nvarchar(500)) [Name] 
From stg.[AH_Roles_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Roles__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Roles__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Roles__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Roles__dbt_tmp_temp_view"
    end



20:31:16.598414 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:31:16.598519 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:16.766249 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:17.682137 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 100.05 seconds
20:31:17.696815 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingproperties".
20:31:17.697092 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Listingproperties: rename object "dbo"."AH_Listingproperties" to AH_Listingproperties__dbt_backup
20:31:17.729970 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:17.743302 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingproperties".
20:31:17.743548 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Listingproperties: rename object "dbo"."AH_Listingproperties__dbt_tmp" to AH_Listingproperties
20:31:17.771659 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:17.773425 [debug] [Thread-4  ]: On model.Shawn.AH_Listingproperties: COMMIT
20:31:17.777488 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingproperties".
20:31:17.777652 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Listingproperties: 
    
  if object_id ('"dbo"."AH_Listingproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Listingproperties__dbt_backup"
    end

20:31:18.008254 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:31:18.020878 [debug] [Thread-4  ]: finished collecting timing info
20:31:18.021181 [debug] [Thread-4  ]: On model.Shawn.AH_Listingproperties: Close
20:31:18.021886 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c42bbb0>]}
20:31:18.022275 [info ] [Thread-4  ]: 57 of 105 OK created table model dbo.AH_Listingproperties....................... [[32mOK[0m in 100.50s]
20:31:18.022630 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Listingproperties
20:31:18.022785 [debug] [Thread-4  ]: Began running node model.Shawn.AH_SMStemplatecontents
20:31:18.023074 [info ] [Thread-4  ]: 83 of 105 START table model dbo.AH_SMStemplatecontents.......................... [RUN]
20:31:18.023427 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_SMStemplatecontents"
20:31:18.023527 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_SMStemplatecontents
20:31:18.023618 [debug] [Thread-4  ]: Compiling model.Shawn.AH_SMStemplatecontents
20:31:18.026045 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_SMStemplatecontents"
20:31:18.026365 [debug] [Thread-4  ]: finished collecting timing info
20:31:18.026475 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_SMStemplatecontents
20:31:18.060723 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_SMStemplatecontents"
20:31:18.061248 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplatecontents".
20:31:18.061387 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SMStemplatecontents: 
  
  if object_id ('"dbo"."AH_SMStemplatecontents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SMStemplatecontents__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_SMStemplatecontents__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_SMStemplatecontents__dbt_tmp"
    end


   EXEC('create view dbo.AH_SMStemplatecontents__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([Body] as nvarchar(4000)) [Body],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([ID] as int) [Id] 
From stg.[AH_SMStemplatecontents_FinalView]
    ');

  CREATE TABLE "dbo"."AH_SMStemplatecontents__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_SMStemplatecontents__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_SMStemplatecontents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SMStemplatecontents__dbt_tmp_temp_view"
    end



20:31:18.061471 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:31:18.061576 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:18.166311 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:19.480086 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.88 seconds
20:31:19.494252 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Roles".
20:31:19.494504 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Roles: rename object "dbo"."AH_Roles" to AH_Roles__dbt_backup
20:31:19.544353 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:31:19.558011 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Roles".
20:31:19.558252 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Roles: rename object "dbo"."AH_Roles__dbt_tmp" to AH_Roles
20:31:19.586244 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:19.588034 [debug] [Thread-2  ]: On model.Shawn.AH_Roles: COMMIT
20:31:19.592331 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Roles".
20:31:19.592509 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Roles: 
    
  if object_id ('"dbo"."AH_Roles__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Roles__dbt_backup"
    end

20:31:19.781305 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:31:19.794287 [debug] [Thread-2  ]: finished collecting timing info
20:31:19.794596 [debug] [Thread-2  ]: On model.Shawn.AH_Roles: Close
20:31:19.795271 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5b2820>]}
20:31:19.795652 [info ] [Thread-2  ]: 82 of 105 OK created table model dbo.AH_Roles................................... [[32mOK[0m in 3.23s]
20:31:19.795966 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Roles
20:31:19.796114 [debug] [Thread-2  ]: Began running node model.Shawn.AH_SMStemplates
20:31:19.796394 [info ] [Thread-2  ]: 84 of 105 START table model dbo.AH_SMStemplates................................. [RUN]
20:31:19.796723 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_SMStemplates"
20:31:19.796820 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_SMStemplates
20:31:19.796910 [debug] [Thread-2  ]: Compiling model.Shawn.AH_SMStemplates
20:31:19.799323 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_SMStemplates"
20:31:19.799639 [debug] [Thread-2  ]: finished collecting timing info
20:31:19.799749 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_SMStemplates
20:31:19.833457 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_SMStemplates"
20:31:19.833976 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplates".
20:31:19.834112 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SMStemplates: 
  
  if object_id ('"dbo"."AH_SMStemplates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SMStemplates__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_SMStemplates__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_SMStemplates__dbt_tmp"
    end


   EXEC('create view dbo.AH_SMStemplates__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([Enabled] as bit) [Enabled],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_SMStemplates_FinalView]
    ');

  CREATE TABLE "dbo"."AH_SMStemplates__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_SMStemplates__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_SMStemplates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SMStemplates__dbt_tmp_temp_view"
    end



20:31:19.834192 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:31:19.834295 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:19.985898 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:21.031550 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.97 seconds
20:31:21.118320 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplatecontents".
20:31:21.118889 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SMStemplatecontents: rename object "dbo"."AH_SMStemplatecontents" to AH_SMStemplatecontents__dbt_backup
20:31:21.153638 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:21.167169 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplatecontents".
20:31:21.167428 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SMStemplatecontents: rename object "dbo"."AH_SMStemplatecontents__dbt_tmp" to AH_SMStemplatecontents
20:31:21.195715 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:21.197375 [debug] [Thread-4  ]: On model.Shawn.AH_SMStemplatecontents: COMMIT
20:31:21.201552 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplatecontents".
20:31:21.201714 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SMStemplatecontents: 
    
  if object_id ('"dbo"."AH_SMStemplatecontents__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_SMStemplatecontents__dbt_backup"
    end

20:31:21.441424 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:31:21.454757 [debug] [Thread-4  ]: finished collecting timing info
20:31:21.455086 [debug] [Thread-4  ]: On model.Shawn.AH_SMStemplatecontents: Close
20:31:21.455775 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c2a54f0>]}
20:31:21.456187 [info ] [Thread-4  ]: 83 of 105 OK created table model dbo.AH_SMStemplatecontents..................... [[32mOK[0m in 3.43s]
20:31:21.456496 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_SMStemplatecontents
20:31:21.456649 [debug] [Thread-4  ]: Began running node model.Shawn.AH_SalesTaxRates
20:31:21.456943 [info ] [Thread-4  ]: 85 of 105 START table model dbo.AH_SalesTaxRates................................ [RUN]
20:31:21.457301 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_SalesTaxRates"
20:31:21.457400 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_SalesTaxRates
20:31:21.457491 [debug] [Thread-4  ]: Compiling model.Shawn.AH_SalesTaxRates
20:31:21.459970 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_SalesTaxRates"
20:31:21.460296 [debug] [Thread-4  ]: finished collecting timing info
20:31:21.460407 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_SalesTaxRates
20:31:21.495074 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_SalesTaxRates"
20:31:21.495585 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SalesTaxRates".
20:31:21.495722 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SalesTaxRates: 
  
  if object_id ('"dbo"."AH_SalesTaxRates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SalesTaxRates__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_SalesTaxRates__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_SalesTaxRates__dbt_tmp"
    end


   EXEC('create view dbo.AH_SalesTaxRates__dbt_tmp_temp_view as
    
Select
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Shipping] as nvarchar(4000)) [Shipping],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([StateID] as int) [StateId],
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId],
	cast([TaxRate] as numeric(19,4)) [TaxRate] 
From stg.[AH_SalesTaxRates_FinalView]
    ');

  CREATE TABLE "dbo"."AH_SalesTaxRates__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_SalesTaxRates__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_SalesTaxRates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SalesTaxRates__dbt_tmp_temp_view"
    end



20:31:21.495805 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:31:21.495907 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:21.603078 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:22.057690 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.22 seconds
20:31:22.072744 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplates".
20:31:22.073019 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SMStemplates: rename object "dbo"."AH_SMStemplates" to AH_SMStemplates__dbt_backup
20:31:22.102691 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:22.116365 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplates".
20:31:22.116622 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SMStemplates: rename object "dbo"."AH_SMStemplates__dbt_tmp" to AH_SMStemplates
20:31:22.146341 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:22.148168 [debug] [Thread-2  ]: On model.Shawn.AH_SMStemplates: COMMIT
20:31:22.152630 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplates".
20:31:22.152844 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SMStemplates: 
    
  if object_id ('"dbo"."AH_SMStemplates__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_SMStemplates__dbt_backup"
    end

20:31:22.376678 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:31:22.388760 [debug] [Thread-2  ]: finished collecting timing info
20:31:22.389064 [debug] [Thread-2  ]: On model.Shawn.AH_SMStemplates: Close
20:31:22.389772 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c31f490>]}
20:31:22.390166 [info ] [Thread-2  ]: 84 of 105 OK created table model dbo.AH_SMStemplates............................ [[32mOK[0m in 2.59s]
20:31:22.390462 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_SMStemplates
20:31:22.390652 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ShippingMethods
20:31:22.390955 [info ] [Thread-2  ]: 86 of 105 START table model dbo.AH_ShippingMethods.............................. [RUN]
20:31:22.391306 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ShippingMethods"
20:31:22.391403 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ShippingMethods
20:31:22.391493 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ShippingMethods
20:31:22.393882 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ShippingMethods"
20:31:22.394195 [debug] [Thread-2  ]: finished collecting timing info
20:31:22.394306 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ShippingMethods
20:31:22.428742 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ShippingMethods"
20:31:22.429236 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingMethods".
20:31:22.429375 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ShippingMethods: 
  
  if object_id ('"dbo"."AH_ShippingMethods__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ShippingMethods__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ShippingMethods__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ShippingMethods__dbt_tmp"
    end


   EXEC('create view dbo.AH_ShippingMethods__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([DisplayOrder] as int) [DisplayOrder],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_ShippingMethods_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ShippingMethods__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ShippingMethods__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ShippingMethods__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ShippingMethods__dbt_tmp_temp_view"
    end



20:31:22.429457 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:31:22.429558 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:22.525409 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:23.952454 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.46 seconds
20:31:23.966112 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SalesTaxRates".
20:31:23.966353 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SalesTaxRates: rename object "dbo"."AH_SalesTaxRates" to AH_SalesTaxRates__dbt_backup
20:31:23.997707 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:24.011551 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SalesTaxRates".
20:31:24.011787 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SalesTaxRates: rename object "dbo"."AH_SalesTaxRates__dbt_tmp" to AH_SalesTaxRates
20:31:24.042381 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:24.044163 [debug] [Thread-4  ]: On model.Shawn.AH_SalesTaxRates: COMMIT
20:31:24.048354 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SalesTaxRates".
20:31:24.048548 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SalesTaxRates: 
    
  if object_id ('"dbo"."AH_SalesTaxRates__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_SalesTaxRates__dbt_backup"
    end

20:31:24.233233 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:31:24.245940 [debug] [Thread-4  ]: finished collecting timing info
20:31:24.246262 [debug] [Thread-4  ]: On model.Shawn.AH_SalesTaxRates: Close
20:31:24.247029 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c444940>]}
20:31:24.247445 [info ] [Thread-4  ]: 85 of 105 OK created table model dbo.AH_SalesTaxRates........................... [[32mOK[0m in 2.79s]
20:31:24.247749 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_SalesTaxRates
20:31:24.247894 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ShippingOptions
20:31:24.248190 [info ] [Thread-4  ]: 87 of 105 START table model dbo.AH_ShippingOptions.............................. [RUN]
20:31:24.248533 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ShippingOptions"
20:31:24.248632 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ShippingOptions
20:31:24.248720 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ShippingOptions
20:31:24.251174 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ShippingOptions"
20:31:24.251501 [debug] [Thread-4  ]: finished collecting timing info
20:31:24.251615 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ShippingOptions
20:31:24.285434 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ShippingOptions"
20:31:24.285951 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions".
20:31:24.286088 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions: 
  
  if object_id ('"dbo"."AH_ShippingOptions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ShippingOptions__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ShippingOptions__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ShippingOptions__dbt_tmp"
    end


   EXEC('create view dbo.AH_ShippingOptions__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([ShippingMethodID] as int) [ShippingMethodId],
	cast([ListingID] as int) [ListingId],
	cast([FirstItEMAmount] as decimal(24,2)) [FirstItemAmount],
	cast([AdditionalItEMAmount] as decimal(24,2)) [AdditionalItemAmount] 
From stg.[AH_ShippingOptions_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ShippingOptions__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ShippingOptions__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ShippingOptions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ShippingOptions__dbt_tmp_temp_view"
    end



20:31:24.286167 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:31:24.286268 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:24.383296 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:25.433969 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.00 seconds
20:31:25.448022 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingMethods".
20:31:25.448272 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ShippingMethods: rename object "dbo"."AH_ShippingMethods" to AH_ShippingMethods__dbt_backup
20:31:25.480452 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:25.493682 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingMethods".
20:31:25.493930 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ShippingMethods: rename object "dbo"."AH_ShippingMethods__dbt_tmp" to AH_ShippingMethods
20:31:25.523218 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:25.524858 [debug] [Thread-2  ]: On model.Shawn.AH_ShippingMethods: COMMIT
20:31:25.529140 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingMethods".
20:31:25.529330 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ShippingMethods: 
    
  if object_id ('"dbo"."AH_ShippingMethods__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ShippingMethods__dbt_backup"
    end

20:31:25.720482 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:31:25.732526 [debug] [Thread-2  ]: finished collecting timing info
20:31:25.732835 [debug] [Thread-2  ]: On model.Shawn.AH_ShippingMethods: Close
20:31:25.733522 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5b2c10>]}
20:31:25.733922 [info ] [Thread-2  ]: 86 of 105 OK created table model dbo.AH_ShippingMethods......................... [[32mOK[0m in 3.34s]
20:31:25.734219 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ShippingMethods
20:31:25.734374 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Siteproperties
20:31:25.734715 [info ] [Thread-2  ]: 88 of 105 START table model dbo.AH_Siteproperties............................... [RUN]
20:31:25.735098 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Siteproperties"
20:31:25.735200 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Siteproperties
20:31:25.735289 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Siteproperties
20:31:25.737808 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Siteproperties"
20:31:25.738150 [debug] [Thread-2  ]: finished collecting timing info
20:31:25.738264 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Siteproperties
20:31:25.772604 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Siteproperties"
20:31:25.773121 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Siteproperties".
20:31:25.773257 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Siteproperties: 
  
  if object_id ('"dbo"."AH_Siteproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Siteproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Siteproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Siteproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_Siteproperties__dbt_tmp_temp_view as
    
Select
	cast([DecimalnativeValue] as numeric(19,4)) [DecimalNativeValue],
	cast([BoolnativeValue] as bit) [BoolNativeValue],
	cast([ID] as int) [Id],
	cast([IntnativeValue] as int) [IntNativeValue],
	cast([CustomFieldID] as int) [CustomFieldId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DateTimenativeValue] as datetime) [DateTimeNativeValue],
	cast([StringnativeValue] as nvarchar(4000)) [StringNativeValue],
	cast([EnumnativeValue] as nvarchar(4000)) [EnumNativeValue],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_Siteproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Siteproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Siteproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Siteproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Siteproperties__dbt_tmp_temp_view"
    end



20:31:25.773345 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:31:25.773453 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:25.888790 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:27.359514 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.07 seconds
20:31:27.374987 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions".
20:31:27.375242 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions: rename object "dbo"."AH_ShippingOptions" to AH_ShippingOptions__dbt_backup
20:31:27.406346 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:27.420861 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions".
20:31:27.421120 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions: rename object "dbo"."AH_ShippingOptions__dbt_tmp" to AH_ShippingOptions
20:31:27.448655 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:27.450458 [debug] [Thread-4  ]: On model.Shawn.AH_ShippingOptions: COMMIT
20:31:27.454922 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions".
20:31:27.455161 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions: 
    
  if object_id ('"dbo"."AH_ShippingOptions__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ShippingOptions__dbt_backup"
    end

20:31:28.420289 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
20:31:28.432578 [debug] [Thread-4  ]: finished collecting timing info
20:31:28.432891 [debug] [Thread-4  ]: On model.Shawn.AH_ShippingOptions: Close
20:31:28.433601 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5b2d60>]}
20:31:28.433991 [info ] [Thread-4  ]: 87 of 105 OK created table model dbo.AH_ShippingOptions......................... [[32mOK[0m in 4.19s]
20:31:28.434293 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ShippingOptions
20:31:28.434445 [debug] [Thread-4  ]: Began running node model.Shawn.AH_States
20:31:28.434769 [info ] [Thread-4  ]: 89 of 105 START table model dbo.AH_States....................................... [RUN]
20:31:28.435123 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_States"
20:31:28.435222 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_States
20:31:28.435310 [debug] [Thread-4  ]: Compiling model.Shawn.AH_States
20:31:28.437696 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_States"
20:31:28.438024 [debug] [Thread-4  ]: finished collecting timing info
20:31:28.438132 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_States
20:31:28.472559 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_States"
20:31:28.473074 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_States".
20:31:28.473208 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_States: 
  
  if object_id ('"dbo"."AH_States__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_States__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_States__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_States__dbt_tmp"
    end


   EXEC('create view dbo.AH_States__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([Code] as nvarchar(4000)) [Code],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Enabled] as bit) [Enabled],
	cast([ID] as int) [Id],
	cast([CountryID] as int) [CountryId] 
From stg.[AH_States_FinalView]
    ');

  CREATE TABLE "dbo"."AH_States__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_States__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_States__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_States__dbt_tmp_temp_view"
    end



20:31:28.473296 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:31:28.473400 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:28.581952 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:30.023559 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 4.25 seconds
20:31:30.038755 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Siteproperties".
20:31:30.039003 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Siteproperties: rename object "dbo"."AH_Siteproperties" to AH_Siteproperties__dbt_backup
20:31:30.070428 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:30.084251 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Siteproperties".
20:31:30.084507 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Siteproperties: rename object "dbo"."AH_Siteproperties__dbt_tmp" to AH_Siteproperties
20:31:30.114974 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:30.116733 [debug] [Thread-2  ]: On model.Shawn.AH_Siteproperties: COMMIT
20:31:30.121045 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Siteproperties".
20:31:30.121231 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Siteproperties: 
    
  if object_id ('"dbo"."AH_Siteproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Siteproperties__dbt_backup"
    end

20:31:30.310492 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:31:30.323001 [debug] [Thread-2  ]: finished collecting timing info
20:31:30.323313 [debug] [Thread-2  ]: On model.Shawn.AH_Siteproperties: Close
20:31:30.323988 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c4717f0>]}
20:31:30.324409 [info ] [Thread-2  ]: 88 of 105 OK created table model dbo.AH_Siteproperties.......................... [[32mOK[0m in 4.59s]
20:31:30.324710 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Siteproperties
20:31:30.324861 [debug] [Thread-2  ]: Began running node model.Shawn.AH_StripeCustomers
20:31:30.325159 [info ] [Thread-2  ]: 90 of 105 START table model dbo.AH_StripeCustomers.............................. [RUN]
20:31:30.325510 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_StripeCustomers"
20:31:30.325612 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_StripeCustomers
20:31:30.325700 [debug] [Thread-2  ]: Compiling model.Shawn.AH_StripeCustomers
20:31:30.328127 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_StripeCustomers"
20:31:30.328456 [debug] [Thread-2  ]: finished collecting timing info
20:31:30.328565 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_StripeCustomers
20:31:30.362904 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_StripeCustomers"
20:31:30.363419 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_StripeCustomers".
20:31:30.363562 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_StripeCustomers: 
  
  if object_id ('"dbo"."AH_StripeCustomers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_StripeCustomers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_StripeCustomers__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_StripeCustomers__dbt_tmp"
    end


   EXEC('create view dbo.AH_StripeCustomers__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([SellerID] as int) [SellerId],
	cast([BuyerID] as int) [BuyerId],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CustomerID] as nvarchar(4000)) [CustomerId] 
From stg.[AH_StripeCustomers_FinalView]
    ');

  CREATE TABLE "dbo"."AH_StripeCustomers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_StripeCustomers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_StripeCustomers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_StripeCustomers__dbt_tmp_temp_view"
    end



20:31:30.363644 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:31:30.363749 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:30.470202 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:31.180444 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.71 seconds
20:31:31.195482 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_States".
20:31:31.195740 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_States: rename object "dbo"."AH_States" to AH_States__dbt_backup
20:31:31.238999 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:31:31.253613 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_States".
20:31:31.253883 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_States: rename object "dbo"."AH_States__dbt_tmp" to AH_States
20:31:31.282999 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:31.284706 [debug] [Thread-4  ]: On model.Shawn.AH_States: COMMIT
20:31:31.288927 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_States".
20:31:31.289108 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_States: 
    
  if object_id ('"dbo"."AH_States__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_States__dbt_backup"
    end

20:31:31.466078 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:31:31.479444 [debug] [Thread-4  ]: finished collecting timing info
20:31:31.479757 [debug] [Thread-4  ]: On model.Shawn.AH_States: Close
20:31:31.480450 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5cf040>]}
20:31:31.660355 [info ] [Thread-4  ]: 89 of 105 OK created table model dbo.AH_States.................................. [[32mOK[0m in 3.05s]
20:31:31.661132 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_States
20:31:31.661303 [debug] [Thread-4  ]: Began running node model.Shawn.AH_SubmittedListingPayment
20:31:31.661614 [info ] [Thread-4  ]: 91 of 105 START table model dbo.AH_SubmittedListingPayment...................... [RUN]
20:31:31.662065 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_SubmittedListingPayment"
20:31:31.662184 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_SubmittedListingPayment
20:31:31.662287 [debug] [Thread-4  ]: Compiling model.Shawn.AH_SubmittedListingPayment
20:31:31.665072 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_SubmittedListingPayment"
20:31:31.665469 [debug] [Thread-4  ]: finished collecting timing info
20:31:31.665601 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_SubmittedListingPayment
20:31:31.700847 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_SubmittedListingPayment"
20:31:31.701372 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment".
20:31:31.701510 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment: 
  
  if object_id ('"dbo"."AH_SubmittedListingPayment__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SubmittedListingPayment__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_SubmittedListingPayment__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_SubmittedListingPayment__dbt_tmp"
    end


   EXEC('create view dbo.AH_SubmittedListingPayment__dbt_tmp_temp_view as
    
Select
	cast([TransactionID] as nvarchar(30)) [TransactionId],
	cast([Amount] as decimal(24,2)) [Amount],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([ListingID] as int) [ListingId],
	cast([ID] as int) [Id],
	cast([ConsignorID] as int) [ConsignorId],
	cast([HasproMarketing] as bit) [HasProMarketing],
	cast([HasproPhotography] as bit) [HasProPhotography] 
From stg.[AH_SubmittedListingPayment_FinalView]
    ');

  CREATE TABLE "dbo"."AH_SubmittedListingPayment__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_SubmittedListingPayment__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_SubmittedListingPayment__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SubmittedListingPayment__dbt_tmp_temp_view"
    end



20:31:31.701591 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:31:31.701696 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:31.831923 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:33.535268 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.17 seconds
20:31:33.628086 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_StripeCustomers".
20:31:33.628354 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_StripeCustomers: rename object "dbo"."AH_StripeCustomers" to AH_StripeCustomers__dbt_backup
20:31:33.665016 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:31:33.679026 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_StripeCustomers".
20:31:33.679283 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_StripeCustomers: rename object "dbo"."AH_StripeCustomers__dbt_tmp" to AH_StripeCustomers
20:31:33.707788 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:33.709548 [debug] [Thread-2  ]: On model.Shawn.AH_StripeCustomers: COMMIT
20:31:33.713846 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_StripeCustomers".
20:31:33.714035 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_StripeCustomers: 
    
  if object_id ('"dbo"."AH_StripeCustomers__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_StripeCustomers__dbt_backup"
    end

20:31:33.885296 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:31:33.897842 [debug] [Thread-2  ]: finished collecting timing info
20:31:33.898151 [debug] [Thread-2  ]: On model.Shawn.AH_StripeCustomers: Close
20:31:33.898909 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5cf280>]}
20:31:33.899309 [info ] [Thread-2  ]: 90 of 105 OK created table model dbo.AH_StripeCustomers......................... [[32mOK[0m in 3.57s]
20:31:33.899638 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_StripeCustomers
20:31:33.899790 [debug] [Thread-2  ]: Began running node model.Shawn.AH_SysDiagrams
20:31:33.900071 [info ] [Thread-2  ]: 92 of 105 START table model dbo.AH_SysDiagrams.................................. [RUN]
20:31:33.900422 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_SysDiagrams"
20:31:33.900529 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_SysDiagrams
20:31:33.900618 [debug] [Thread-2  ]: Compiling model.Shawn.AH_SysDiagrams
20:31:33.903071 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_SysDiagrams"
20:31:33.903397 [debug] [Thread-2  ]: finished collecting timing info
20:31:33.903505 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_SysDiagrams
20:31:33.938731 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_SysDiagrams"
20:31:33.939233 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SysDiagrams".
20:31:33.939365 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SysDiagrams: 
  
  if object_id ('"dbo"."AH_SysDiagrams__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SysDiagrams__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_SysDiagrams__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_SysDiagrams__dbt_tmp"
    end


   EXEC('create view dbo.AH_SysDiagrams__dbt_tmp_temp_view as
    
Select
	cast([Diagram_ID] as int) [diagram_id],
	cast([Version] as int) [version],
	cast([Principal_ID] as int) [principal_id],
	cast([Definition] as varbinary(8000)) [definition],
	cast([Name] as nvarchar(4000)) [name] 
From stg.[AH_SysDiagrams_FinalView]
    ');

  CREATE TABLE "dbo"."AH_SysDiagrams__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_SysDiagrams__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_SysDiagrams__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SysDiagrams__dbt_tmp_temp_view"
    end



20:31:33.939446 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:31:33.939555 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:34.038061 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:34.539591 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.84 seconds
20:31:34.554596 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment".
20:31:34.554860 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment: rename object "dbo"."AH_SubmittedListingPayment" to AH_SubmittedListingPayment__dbt_backup
20:31:34.597503 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:31:34.611576 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment".
20:31:34.611832 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment: rename object "dbo"."AH_SubmittedListingPayment__dbt_tmp" to AH_SubmittedListingPayment
20:31:34.643182 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:34.644951 [debug] [Thread-4  ]: On model.Shawn.AH_SubmittedListingPayment: COMMIT
20:31:34.649103 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment".
20:31:34.649271 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment: 
    
  if object_id ('"dbo"."AH_SubmittedListingPayment__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_SubmittedListingPayment__dbt_backup"
    end

20:31:34.874215 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:31:34.887558 [debug] [Thread-4  ]: finished collecting timing info
20:31:34.887885 [debug] [Thread-4  ]: On model.Shawn.AH_SubmittedListingPayment: Close
20:31:34.888580 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c8c7550>]}
20:31:34.888980 [info ] [Thread-4  ]: 91 of 105 OK created table model dbo.AH_SubmittedListingPayment................. [[32mOK[0m in 3.23s]
20:31:34.889277 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_SubmittedListingPayment
20:31:34.889429 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ThReadTracking
20:31:34.889713 [info ] [Thread-4  ]: 93 of 105 START table model dbo.AH_ThReadTracking............................... [RUN]
20:31:34.890063 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ThReadTracking"
20:31:34.890159 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ThReadTracking
20:31:34.890248 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ThReadTracking
20:31:34.892718 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ThReadTracking"
20:31:34.893043 [debug] [Thread-4  ]: finished collecting timing info
20:31:34.893155 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ThReadTracking
20:31:34.928109 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ThReadTracking"
20:31:34.928645 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ThReadTracking".
20:31:34.928774 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ThReadTracking: 
  
  if object_id ('"dbo"."AH_ThReadTracking__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ThReadTracking__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ThReadTracking__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ThReadTracking__dbt_tmp"
    end


   EXEC('create view dbo.AH_ThReadTracking__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([ThReadGUID] as nvarchar(4000)) [ThreadGUID],
	cast([DaTestamp] as datetime) [DateStamp],
	cast([PrimarythRead] as bit) [PrimaryThread] 
From stg.[AH_ThReadTracking_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ThReadTracking__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ThReadTracking__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ThReadTracking__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ThReadTracking__dbt_tmp_temp_view"
    end



20:31:34.928857 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:31:34.928967 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:35.029766 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:36.144789 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.21 seconds
20:31:36.159733 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SysDiagrams".
20:31:36.160004 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SysDiagrams: rename object "dbo"."AH_SysDiagrams" to AH_SysDiagrams__dbt_backup
20:31:36.191585 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:36.206192 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SysDiagrams".
20:31:36.206456 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SysDiagrams: rename object "dbo"."AH_SysDiagrams__dbt_tmp" to AH_SysDiagrams
20:31:36.236881 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:36.238467 [debug] [Thread-2  ]: On model.Shawn.AH_SysDiagrams: COMMIT
20:31:36.242448 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SysDiagrams".
20:31:36.242678 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SysDiagrams: 
    
  if object_id ('"dbo"."AH_SysDiagrams__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_SysDiagrams__dbt_backup"
    end

20:31:36.437104 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:31:36.449821 [debug] [Thread-2  ]: finished collecting timing info
20:31:36.450132 [debug] [Thread-2  ]: On model.Shawn.AH_SysDiagrams: Close
20:31:36.450854 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5cf430>]}
20:31:36.451271 [info ] [Thread-2  ]: 92 of 105 OK created table model dbo.AH_SysDiagrams............................. [[32mOK[0m in 2.55s]
20:31:36.451569 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_SysDiagrams
20:31:36.451710 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Tiers
20:31:36.451998 [info ] [Thread-2  ]: 94 of 105 START table model dbo.AH_Tiers........................................ [RUN]
20:31:36.452342 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Tiers"
20:31:36.452440 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Tiers
20:31:36.452526 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Tiers
20:31:36.455105 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Tiers"
20:31:36.455427 [debug] [Thread-2  ]: finished collecting timing info
20:31:36.455534 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Tiers
20:31:36.490008 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Tiers"
20:31:36.490524 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Tiers".
20:31:36.490710 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Tiers: 
  
  if object_id ('"dbo"."AH_Tiers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Tiers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Tiers__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Tiers__dbt_tmp"
    end


   EXEC('create view dbo.AH_Tiers__dbt_tmp_temp_view as
    
Select
	cast([Upperboundexclusive] as numeric(26,4)) [UpperBoundExclusive],
	cast([Value] as numeric(19,4)) [Value],
	cast([Lowerboundinclusive] as numeric(19,4)) [LowerBoundInclusive],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [Id],
	cast([FeescheduleID] as int) [FeeScheduleId],
	cast([ValueType] as nvarchar(4000)) [ValueType],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_Tiers_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Tiers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Tiers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Tiers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Tiers__dbt_tmp_temp_view"
    end



20:31:36.490794 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:31:36.490895 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:36.591824 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:37.109717 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.18 seconds
20:31:37.125480 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ThReadTracking".
20:31:37.125744 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ThReadTracking: rename object "dbo"."AH_ThReadTracking" to AH_ThReadTracking__dbt_backup
20:31:37.156104 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:37.170631 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ThReadTracking".
20:31:37.170900 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ThReadTracking: rename object "dbo"."AH_ThReadTracking__dbt_tmp" to AH_ThReadTracking
20:31:37.199027 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:37.200776 [debug] [Thread-4  ]: On model.Shawn.AH_ThReadTracking: COMMIT
20:31:37.204739 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ThReadTracking".
20:31:37.204917 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ThReadTracking: 
    
  if object_id ('"dbo"."AH_ThReadTracking__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ThReadTracking__dbt_backup"
    end

20:31:37.428907 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:31:37.441617 [debug] [Thread-4  ]: finished collecting timing info
20:31:37.441926 [debug] [Thread-4  ]: On model.Shawn.AH_ThReadTracking: Close
20:31:37.442670 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5cf580>]}
20:31:37.443089 [info ] [Thread-4  ]: 93 of 105 OK created table model dbo.AH_ThReadTracking.......................... [[32mOK[0m in 2.55s]
20:31:37.443391 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ThReadTracking
20:31:37.443534 [debug] [Thread-4  ]: Began running node model.Shawn.AH_UnProcessedQueueMessages
20:31:37.443810 [info ] [Thread-4  ]: 95 of 105 START table model dbo.AH_UnProcessedQueueMessages..................... [RUN]
20:31:37.444156 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_UnProcessedQueueMessages"
20:31:37.444256 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_UnProcessedQueueMessages
20:31:37.444347 [debug] [Thread-4  ]: Compiling model.Shawn.AH_UnProcessedQueueMessages
20:31:37.446828 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_UnProcessedQueueMessages"
20:31:37.447164 [debug] [Thread-4  ]: finished collecting timing info
20:31:37.447277 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_UnProcessedQueueMessages
20:31:37.482049 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_UnProcessedQueueMessages"
20:31:37.482636 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages".
20:31:37.482803 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages: 
  
  if object_id ('"dbo"."AH_UnProcessedQueueMessages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UnProcessedQueueMessages__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_UnProcessedQueueMessages__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_UnProcessedQueueMessages__dbt_tmp"
    end


   EXEC('create view dbo.AH_UnProcessedQueueMessages__dbt_tmp_temp_view as
    
Select
	cast([QueueName] as nvarchar(4000)) [QueueName],
	cast([QueueData] as nvarchar(4000)) [QueueData],
	cast([QueueOrder] as int) [QueueOrder] 
From stg.[AH_UnProcessedQueueMessages_FinalView]
    ');

  CREATE TABLE "dbo"."AH_UnProcessedQueueMessages__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_UnProcessedQueueMessages__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_UnProcessedQueueMessages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UnProcessedQueueMessages__dbt_tmp_temp_view"
    end



20:31:37.482887 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:31:37.482995 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:37.580952 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:38.983907 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.49 seconds
20:31:38.999673 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Tiers".
20:31:38.999941 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Tiers: rename object "dbo"."AH_Tiers" to AH_Tiers__dbt_backup
20:31:39.030129 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:39.044401 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Tiers".
20:31:39.044665 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Tiers: rename object "dbo"."AH_Tiers__dbt_tmp" to AH_Tiers
20:31:39.072695 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:39.074499 [debug] [Thread-2  ]: On model.Shawn.AH_Tiers: COMMIT
20:31:39.078788 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Tiers".
20:31:39.078997 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Tiers: 
    
  if object_id ('"dbo"."AH_Tiers__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Tiers__dbt_backup"
    end

20:31:39.252733 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:31:39.266696 [debug] [Thread-2  ]: finished collecting timing info
20:31:39.267026 [debug] [Thread-2  ]: On model.Shawn.AH_Tiers: Close
20:31:39.267754 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5cf6d0>]}
20:31:39.268156 [info ] [Thread-2  ]: 94 of 105 OK created table model dbo.AH_Tiers................................... [[32mOK[0m in 2.82s]
20:31:39.268460 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Tiers
20:31:39.268615 [debug] [Thread-2  ]: Began running node model.Shawn.AH_UserAlerts
20:31:39.268906 [info ] [Thread-2  ]: 96 of 105 START table model dbo.AH_UserAlerts................................... [RUN]
20:31:39.269264 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_UserAlerts"
20:31:39.269367 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_UserAlerts
20:31:39.269459 [debug] [Thread-2  ]: Compiling model.Shawn.AH_UserAlerts
20:31:39.272018 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_UserAlerts"
20:31:39.272362 [debug] [Thread-2  ]: finished collecting timing info
20:31:39.272478 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_UserAlerts
20:31:39.307764 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_UserAlerts"
20:31:39.308283 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserAlerts".
20:31:39.308429 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UserAlerts: 
  
  if object_id ('"dbo"."AH_UserAlerts__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserAlerts__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_UserAlerts__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_UserAlerts__dbt_tmp"
    end


   EXEC('create view dbo.AH_UserAlerts__dbt_tmp_temp_view as
    
Select
	cast([Enabled] as bit) [Enabled],
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId],
	cast([MakeID] as int) [MakeId],
	cast([ModelID] as int) [ModelId],
	cast([YearFrom] as int) [YearFrom],
	cast([Yearto] as int) [YearTo],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_UserAlerts_FinalView]
    ');

  CREATE TABLE "dbo"."AH_UserAlerts__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_UserAlerts__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_UserAlerts__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserAlerts__dbt_tmp_temp_view"
    end



20:31:39.308511 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:31:39.308614 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:39.405990 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:39.824389 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.34 seconds
20:31:39.908299 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages".
20:31:39.908551 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages: rename object "dbo"."AH_UnProcessedQueueMessages" to AH_UnProcessedQueueMessages__dbt_backup
20:31:39.949706 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:31:39.962789 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages".
20:31:39.963033 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages: rename object "dbo"."AH_UnProcessedQueueMessages__dbt_tmp" to AH_UnProcessedQueueMessages
20:31:39.999638 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:31:40.001214 [debug] [Thread-4  ]: On model.Shawn.AH_UnProcessedQueueMessages: COMMIT
20:31:40.007411 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages".
20:31:40.007612 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages: 
    
  if object_id ('"dbo"."AH_UnProcessedQueueMessages__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_UnProcessedQueueMessages__dbt_backup"
    end

20:31:40.216217 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:31:40.228504 [debug] [Thread-4  ]: finished collecting timing info
20:31:40.228804 [debug] [Thread-4  ]: On model.Shawn.AH_UnProcessedQueueMessages: Close
20:31:40.229453 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c793070>]}
20:31:40.229841 [info ] [Thread-4  ]: 95 of 105 OK created table model dbo.AH_UnProcessedQueueMessages................ [[32mOK[0m in 2.79s]
20:31:40.230142 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_UnProcessedQueueMessages
20:31:40.230285 [debug] [Thread-4  ]: Began running node model.Shawn.AH_UserLogins
20:31:40.230574 [info ] [Thread-4  ]: 97 of 105 START table model dbo.AH_UserLogins................................... [RUN]
20:31:40.230922 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_UserLogins"
20:31:40.231022 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_UserLogins
20:31:40.231113 [debug] [Thread-4  ]: Compiling model.Shawn.AH_UserLogins
20:31:40.233449 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_UserLogins"
20:31:40.233761 [debug] [Thread-4  ]: finished collecting timing info
20:31:40.233866 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_UserLogins
20:31:40.268304 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_UserLogins"
20:31:40.268821 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins".
20:31:40.268953 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins: 
  
  if object_id ('"dbo"."AH_UserLogins__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserLogins__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_UserLogins__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_UserLogins__dbt_tmp"
    end


   EXEC('create view dbo.AH_UserLogins__dbt_tmp_temp_view as
    
Select
	cast([LoginprovIDEr] as nvarchar(4000)) [LoginProvider],
	cast([ProvIDErKey] as nvarchar(4000)) [ProviderKey],
	cast([UserID] as int) [UserId] 
From stg.[AH_UserLogins_FinalView]
    ');

  CREATE TABLE "dbo"."AH_UserLogins__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_UserLogins__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_UserLogins__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserLogins__dbt_tmp_temp_view"
    end



20:31:40.269043 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:31:40.269147 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:40.381437 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:41.627504 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.32 seconds
20:31:41.641828 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserAlerts".
20:31:41.642087 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UserAlerts: rename object "dbo"."AH_UserAlerts" to AH_UserAlerts__dbt_backup
20:31:41.680957 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:31:41.694766 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserAlerts".
20:31:41.695016 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UserAlerts: rename object "dbo"."AH_UserAlerts__dbt_tmp" to AH_UserAlerts
20:31:41.723256 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:41.724898 [debug] [Thread-2  ]: On model.Shawn.AH_UserAlerts: COMMIT
20:31:41.728819 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserAlerts".
20:31:41.728983 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UserAlerts: 
    
  if object_id ('"dbo"."AH_UserAlerts__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_UserAlerts__dbt_backup"
    end

20:31:41.902213 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:31:41.914935 [debug] [Thread-2  ]: finished collecting timing info
20:31:41.915229 [debug] [Thread-2  ]: On model.Shawn.AH_UserAlerts: Close
20:31:41.915910 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c8ccfd0>]}
20:31:41.916309 [info ] [Thread-2  ]: 96 of 105 OK created table model dbo.AH_UserAlerts.............................. [[32mOK[0m in 2.65s]
20:31:41.916612 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_UserAlerts
20:31:41.916767 [debug] [Thread-2  ]: Began running node model.Shawn.AH_UserMessages
20:31:41.917035 [info ] [Thread-2  ]: 98 of 105 START table model dbo.AH_UserMessages................................. [RUN]
20:31:41.917379 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_UserMessages"
20:31:41.917479 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_UserMessages
20:31:41.917568 [debug] [Thread-2  ]: Compiling model.Shawn.AH_UserMessages
20:31:41.920030 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_UserMessages"
20:31:41.920347 [debug] [Thread-2  ]: finished collecting timing info
20:31:41.920458 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_UserMessages
20:31:41.953966 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_UserMessages"
20:31:41.954469 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserMessages".
20:31:41.954646 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UserMessages: 
  
  if object_id ('"dbo"."AH_UserMessages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserMessages__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_UserMessages__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_UserMessages__dbt_tmp"
    end


   EXEC('create view dbo.AH_UserMessages__dbt_tmp_temp_view as
    
Select
	cast([SEnderID] as int) [SenderId],
	cast([RecipientID] as int) [RecipientId],
	cast([MasTerMessageID] as int) [MasterMessageId],
	cast([ID] as int) [Id],
	cast([ListingID] as int) [ListingId],
	cast([Sent] as datetime) [Sent],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([SuBJect] as nvarchar(4000)) [Subject],
	cast([Body] as nvarchar(4000)) [Body],
	cast([SEnderStatus] as nvarchar(4000)) [SenderStatus],
	cast([RecipientStatus] as nvarchar(4000)) [RecipientStatus],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_UserMessages_FinalView]
    ');

  CREATE TABLE "dbo"."AH_UserMessages__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_UserMessages__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_UserMessages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserMessages__dbt_tmp_temp_view"
    end



20:31:41.954744 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:31:41.954847 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:42.078779 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:42.715413 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.45 seconds
20:31:42.729480 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins".
20:31:42.729735 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins: rename object "dbo"."AH_UserLogins" to AH_UserLogins__dbt_backup
20:31:42.774004 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:31:42.787526 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins".
20:31:42.787780 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins: rename object "dbo"."AH_UserLogins__dbt_tmp" to AH_UserLogins
20:31:42.815535 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:42.817175 [debug] [Thread-4  ]: On model.Shawn.AH_UserLogins: COMMIT
20:31:42.821038 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins".
20:31:42.821205 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins: 
    
  if object_id ('"dbo"."AH_UserLogins__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_UserLogins__dbt_backup"
    end

20:31:43.019223 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:31:43.032611 [debug] [Thread-4  ]: finished collecting timing info
20:31:43.032931 [debug] [Thread-4  ]: On model.Shawn.AH_UserLogins: Close
20:31:43.033634 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5cf820>]}
20:31:43.034040 [info ] [Thread-4  ]: 97 of 105 OK created table model dbo.AH_UserLogins.............................. [[32mOK[0m in 2.80s]
20:31:43.034342 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_UserLogins
20:31:43.034496 [debug] [Thread-4  ]: Began running node model.Shawn.AH_UserOptOut
20:31:43.034833 [info ] [Thread-4  ]: 99 of 105 START table model dbo.AH_UserOptOut................................... [RUN]
20:31:43.035196 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_UserOptOut"
20:31:43.035294 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_UserOptOut
20:31:43.035383 [debug] [Thread-4  ]: Compiling model.Shawn.AH_UserOptOut
20:31:43.037818 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_UserOptOut"
20:31:43.038152 [debug] [Thread-4  ]: finished collecting timing info
20:31:43.038267 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_UserOptOut
20:31:43.073052 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_UserOptOut"
20:31:43.073574 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserOptOut".
20:31:43.073712 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserOptOut: 
  
  if object_id ('"dbo"."AH_UserOptOut__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserOptOut__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_UserOptOut__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_UserOptOut__dbt_tmp"
    end


   EXEC('create view dbo.AH_UserOptOut__dbt_tmp_temp_view as
    
Select
	cast([EmailName] as nvarchar(4000)) [EmailName],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId] 
From stg.[AH_UserOptOut_FinalView]
    ');

  CREATE TABLE "dbo"."AH_UserOptOut__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_UserOptOut__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_UserOptOut__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserOptOut__dbt_tmp_temp_view"
    end



20:31:43.073809 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:31:43.073917 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:43.190139 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:44.572421 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.62 seconds
20:31:44.586622 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserMessages".
20:31:44.586883 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UserMessages: rename object "dbo"."AH_UserMessages" to AH_UserMessages__dbt_backup
20:31:44.624358 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:31:44.637605 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserMessages".
20:31:44.637846 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UserMessages: rename object "dbo"."AH_UserMessages__dbt_tmp" to AH_UserMessages
20:31:44.667188 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:44.669171 [debug] [Thread-2  ]: On model.Shawn.AH_UserMessages: COMMIT
20:31:44.674303 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserMessages".
20:31:44.674504 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UserMessages: 
    
  if object_id ('"dbo"."AH_UserMessages__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_UserMessages__dbt_backup"
    end

20:31:45.118846 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.44 seconds
20:31:45.131626 [debug] [Thread-2  ]: finished collecting timing info
20:31:45.131939 [debug] [Thread-2  ]: On model.Shawn.AH_UserMessages: Close
20:31:45.132640 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c465880>]}
20:31:45.133029 [info ] [Thread-2  ]: 98 of 105 OK created table model dbo.AH_UserMessages............................ [[32mOK[0m in 3.22s]
20:31:45.133322 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_UserMessages
20:31:45.133470 [debug] [Thread-2  ]: Began running node model.Shawn.AH_UserRoles
20:31:45.133746 [info ] [Thread-2  ]: 100 of 105 START table model dbo.AH_UserRoles................................... [RUN]
20:31:45.134080 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_UserRoles"
20:31:45.134179 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_UserRoles
20:31:45.134269 [debug] [Thread-2  ]: Compiling model.Shawn.AH_UserRoles
20:31:45.136702 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_UserRoles"
20:31:45.137024 [debug] [Thread-2  ]: finished collecting timing info
20:31:45.137133 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_UserRoles
20:31:45.171790 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_UserRoles"
20:31:45.172324 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserRoles".
20:31:45.172465 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UserRoles: 
  
  if object_id ('"dbo"."AH_UserRoles__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserRoles__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_UserRoles__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_UserRoles__dbt_tmp"
    end


   EXEC('create view dbo.AH_UserRoles__dbt_tmp_temp_view as
    
Select
	cast([RoleID] as int) [RoleId],
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId] 
From stg.[AH_UserRoles_FinalView]
    ');

  CREATE TABLE "dbo"."AH_UserRoles__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_UserRoles__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_UserRoles__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserRoles__dbt_tmp_temp_view"
    end



20:31:45.172547 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:31:45.172652 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:45.248157 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.17 seconds
20:31:45.266866 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserOptOut".
20:31:45.267110 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserOptOut: rename object "dbo"."AH_UserOptOut" to AH_UserOptOut__dbt_backup
20:31:45.297451 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:45.304899 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:31:45.318330 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserOptOut".
20:31:45.318596 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserOptOut: rename object "dbo"."AH_UserOptOut__dbt_tmp" to AH_UserOptOut
20:31:45.350705 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:45.352438 [debug] [Thread-4  ]: On model.Shawn.AH_UserOptOut: COMMIT
20:31:45.356746 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserOptOut".
20:31:45.356924 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserOptOut: 
    
  if object_id ('"dbo"."AH_UserOptOut__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_UserOptOut__dbt_backup"
    end

20:31:45.580185 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:31:45.593224 [debug] [Thread-4  ]: finished collecting timing info
20:31:45.593531 [debug] [Thread-4  ]: On model.Shawn.AH_UserOptOut: Close
20:31:45.594214 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5ad9d0>]}
20:31:45.594637 [info ] [Thread-4  ]: 99 of 105 OK created table model dbo.AH_UserOptOut.............................. [[32mOK[0m in 2.56s]
20:31:45.594950 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_UserOptOut
20:31:45.595098 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Userclaims
20:31:45.595369 [info ] [Thread-4  ]: 101 of 105 START table model dbo.AH_Userclaims.................................. [RUN]
20:31:45.595706 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Userclaims"
20:31:45.595803 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Userclaims
20:31:45.595892 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Userclaims
20:31:45.598243 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Userclaims"
20:31:45.598582 [debug] [Thread-4  ]: finished collecting timing info
20:31:45.598711 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Userclaims
20:31:45.632818 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Userclaims"
20:31:45.633337 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userclaims".
20:31:45.633470 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Userclaims: 
  
  if object_id ('"dbo"."AH_Userclaims__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Userclaims__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Userclaims__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Userclaims__dbt_tmp"
    end


   EXEC('create view dbo.AH_Userclaims__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId],
	cast([ClaimType] as nvarchar(4000)) [ClaimType],
	cast([ClaimValue] as nvarchar(4000)) [ClaimValue] 
From stg.[AH_Userclaims_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Userclaims__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Userclaims__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Userclaims__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Userclaims__dbt_tmp_temp_view"
    end



20:31:45.633552 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:31:45.633653 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:45.734883 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:48.050873 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.88 seconds
20:31:48.065649 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserRoles".
20:31:48.065899 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UserRoles: rename object "dbo"."AH_UserRoles" to AH_UserRoles__dbt_backup
20:31:48.104432 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:31:48.118339 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserRoles".
20:31:48.118641 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UserRoles: rename object "dbo"."AH_UserRoles__dbt_tmp" to AH_UserRoles
20:31:48.129154 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.50 seconds
20:31:48.143068 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userclaims".
20:31:48.143320 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Userclaims: rename object "dbo"."AH_Userclaims" to AH_Userclaims__dbt_backup
20:31:48.147679 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:48.149225 [debug] [Thread-2  ]: On model.Shawn.AH_UserRoles: COMMIT
20:31:48.152715 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserRoles".
20:31:48.152856 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UserRoles: 
    
  if object_id ('"dbo"."AH_UserRoles__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_UserRoles__dbt_backup"
    end

20:31:48.175202 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:48.189210 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userclaims".
20:31:48.189461 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Userclaims: rename object "dbo"."AH_Userclaims__dbt_tmp" to AH_Userclaims
20:31:48.217580 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:48.219358 [debug] [Thread-4  ]: On model.Shawn.AH_Userclaims: COMMIT
20:31:48.223221 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userclaims".
20:31:48.223387 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Userclaims: 
    
  if object_id ('"dbo"."AH_Userclaims__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Userclaims__dbt_backup"
    end

20:31:48.388349 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:31:48.401483 [debug] [Thread-2  ]: finished collecting timing info
20:31:48.401794 [debug] [Thread-2  ]: On model.Shawn.AH_UserRoles: Close
20:31:48.402486 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c3126a0>]}
20:31:48.402934 [info ] [Thread-2  ]: 100 of 105 OK created table model dbo.AH_UserRoles.............................. [[32mOK[0m in 3.27s]
20:31:48.403238 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_UserRoles
20:31:48.403382 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Userproperties
20:31:48.403654 [info ] [Thread-2  ]: 102 of 105 START table model dbo.AH_Userproperties.............................. [RUN]
20:31:48.403990 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Userproperties"
20:31:48.404092 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Userproperties
20:31:48.404182 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Userproperties
20:31:48.406591 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Userproperties"
20:31:48.406903 [debug] [Thread-2  ]: finished collecting timing info
20:31:48.407009 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Userproperties
20:31:48.441251 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Userproperties"
20:31:48.441767 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userproperties".
20:31:48.441909 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Userproperties: 
  
  if object_id ('"dbo"."AH_Userproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Userproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Userproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Userproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_Userproperties__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([IntnativeValue] as int) [IntNativeValue],
	cast([UserID] as int) [UserId],
	cast([CustomFieldID] as int) [CustomFieldId],
	cast([BoolnativeValue] as bit) [BoolNativeValue],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DateTimenativeValue] as datetime) [DateTimeNativeValue],
	cast([StringnativeValue] as nvarchar(4000)) [StringNativeValue],
	cast([EnumnativeValue] as nvarchar(4000)) [EnumNativeValue],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([DecimalnativeValue] as numeric(19,4)) [DecimalNativeValue] 
From stg.[AH_Userproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Userproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Userproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Userproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Userproperties__dbt_tmp_temp_view"
    end



20:31:48.441989 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:31:48.442090 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:48.539493 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:48.566131 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
20:31:48.649453 [debug] [Thread-4  ]: finished collecting timing info
20:31:48.649759 [debug] [Thread-4  ]: On model.Shawn.AH_Userclaims: Close
20:31:48.650439 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c6ee730>]}
20:31:48.650907 [info ] [Thread-4  ]: 101 of 105 OK created table model dbo.AH_Userclaims............................. [[32mOK[0m in 3.05s]
20:31:48.651204 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Userclaims
20:31:48.651344 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Users
20:31:48.651606 [info ] [Thread-4  ]: 103 of 105 START table model dbo.AH_Users....................................... [RUN]
20:31:48.651940 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Users"
20:31:48.652038 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Users
20:31:48.652129 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Users
20:31:48.654777 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Users"
20:31:48.655074 [debug] [Thread-4  ]: finished collecting timing info
20:31:48.655179 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Users
20:31:48.689093 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Users"
20:31:48.689592 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Users".
20:31:48.689725 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Users: 
  
  if object_id ('"dbo"."AH_Users__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Users__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Users__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Users__dbt_tmp"
    end


   EXEC('create view dbo.AH_Users__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([BillingAddressID] as int) [BillingAddressID],
	cast([BillingCreditCardID] as int) [BillingCreditCardID],
	cast([PrimaryAddressID] as int) [PrimaryAddressID],
	cast([AccessfailedCount] as int) [AccessFailedCount],
	cast([IsApproved] as bit) [IsApproved],
	cast([IsLockedOut] as bit) [IsLockedOut],
	cast([NewsLetter] as bit) [Newsletter],
	cast([IsVerified] as bit) [IsVerified],
	cast([IsActive] as bit) [IsActive],
	cast([EmailConfirmed] as bit) [EmailConfirmed],
	cast([PhoneNumberConfirmed] as bit) [PhoneNumberConfirmed],
	cast([TwoFactorEnabled] as bit) [TwoFactorEnabled],
	cast([LockOutEnabled] as bit) [LockoutEnabled],
	cast([WebapiEnabled] as bit) [WebAPIEnabled],
	cast([CreationDate] as datetime) [CreationDate],
	cast([LastLoginDate] as datetime) [LastLoginDate],
	cast([LastActivityDate] as datetime) [LastActivityDate],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([LockOutEndDateUTC] as datetime) [LockoutEndDateUtc],
	cast([UserName] as nvarchar(500)) [UserName],
	cast([Email] as nvarchar(320)) [Email],
	cast([Password] as varchar(128)) [Password],
	cast([Comment] as nvarchar(4000)) [Comment],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([Culture] as nvarchar(10)) [Culture],
	cast([Lastip] as nvarchar(50)) [LastIP],
	cast([VerificationToken] as nvarchar(100)) [VerificationToken],
	cast([PasswordResetToken] as varchar(128)) [PasswordResetToken],
	cast([ServiceAuthorizationToken] as nvarchar(100)) [ServiceAuthorizationToken],
	cast([PasswordHash] as nvarchar(4000)) [PasswordHash],
	cast([SecURItyStamp] as nvarchar(4000)) [SecurityStamp],
	cast([PhoneNumber] as nvarchar(40)) [PhoneNumber] 
From stg.[AH_Users_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Users__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Users__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Users__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Users__dbt_tmp_temp_view"
    end



20:31:48.689806 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:31:48.689905 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:48.791380 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:31:57.358261 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 8.67 seconds
20:31:57.373268 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Users".
20:31:57.373516 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Users: rename object "dbo"."AH_Users" to AH_Users__dbt_backup
20:31:57.409324 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:31:57.423444 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Users".
20:31:57.423694 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Users: rename object "dbo"."AH_Users__dbt_tmp" to AH_Users
20:31:57.452476 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:31:57.454270 [debug] [Thread-4  ]: On model.Shawn.AH_Users: COMMIT
20:31:57.458626 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Users".
20:31:57.458844 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Users: 
    
  if object_id ('"dbo"."AH_Users__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Users__dbt_backup"
    end

20:31:57.722665 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:31:57.735523 [debug] [Thread-4  ]: finished collecting timing info
20:31:57.735854 [debug] [Thread-4  ]: On model.Shawn.AH_Users: Close
20:31:57.736585 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c5c72e0>]}
20:31:57.736993 [info ] [Thread-4  ]: 103 of 105 OK created table model dbo.AH_Users.................................. [[32mOK[0m in 9.08s]
20:31:57.737311 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Users
20:31:57.737468 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Version
20:31:57.737755 [info ] [Thread-4  ]: 104 of 105 START table model dbo.AH_Version..................................... [RUN]
20:31:57.738121 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Version"
20:31:57.738223 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Version
20:31:57.738312 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Version
20:31:57.740859 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Version"
20:31:57.741213 [debug] [Thread-4  ]: finished collecting timing info
20:31:57.741329 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Version
20:31:57.776332 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Version"
20:31:57.776855 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Version".
20:31:57.776988 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Version: 
  
  if object_id ('"dbo"."AH_Version__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Version__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Version__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Version__dbt_tmp"
    end


   EXEC('create view dbo.AH_Version__dbt_tmp_temp_view as
    
Select
	cast([VersionNumber] as nvarchar(4000)) [VersionNumber],
	cast([Status] as nvarchar(4000)) [Status],
	cast([DaTestamp] as datetime) [DateStamp],
	cast([ID] as int) [ID] 
From stg.[AH_Version_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Version__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Version__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Version__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Version__dbt_tmp_temp_view"
    end



20:31:57.777072 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:31:57.777174 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:31:57.876098 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:32:00.046796 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.27 seconds
20:32:00.061903 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Version".
20:32:00.062166 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Version: rename object "dbo"."AH_Version" to AH_Version__dbt_backup
20:32:00.094319 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:32:00.109338 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Version".
20:32:00.109599 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Version: rename object "dbo"."AH_Version__dbt_tmp" to AH_Version
20:32:00.137195 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:32:00.138992 [debug] [Thread-4  ]: On model.Shawn.AH_Version: COMMIT
20:32:00.143380 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Version".
20:32:00.143576 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Version: 
    
  if object_id ('"dbo"."AH_Version__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Version__dbt_backup"
    end

20:32:00.395492 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:32:00.409382 [debug] [Thread-4  ]: finished collecting timing info
20:32:00.409739 [debug] [Thread-4  ]: On model.Shawn.AH_Version: Close
20:32:00.410463 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c390220>]}
20:32:00.410922 [info ] [Thread-4  ]: 104 of 105 OK created table model dbo.AH_Version................................ [[32mOK[0m in 2.67s]
20:32:00.411223 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Version
20:32:00.411376 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Watches
20:32:00.411647 [info ] [Thread-4  ]: 105 of 105 START table model dbo.AH_Watches..................................... [RUN]
20:32:00.412012 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Watches"
20:32:00.412116 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Watches
20:32:00.412208 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Watches
20:32:00.414828 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Watches"
20:32:00.415186 [debug] [Thread-4  ]: finished collecting timing info
20:32:00.415301 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Watches
20:32:00.450410 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Watches"
20:32:00.450972 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches".
20:32:00.451109 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Watches: 
  
  if object_id ('"dbo"."AH_Watches__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Watches__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Watches__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Watches__dbt_tmp"
    end


   EXEC('create view dbo.AH_Watches__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [Id],
	cast([UserID] as int) [UserId],
	cast([ListingID] as int) [ListingId],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser] 
From stg.[AH_Watches_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Watches__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Watches__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Watches__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Watches__dbt_tmp_temp_view"
    end



20:32:00.451190 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:32:00.451306 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:32:00.566183 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:32:03.812188 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.36 seconds
20:32:03.826908 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches".
20:32:03.827165 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Watches: rename object "dbo"."AH_Watches" to AH_Watches__dbt_backup
20:32:03.863743 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:32:03.877699 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches".
20:32:03.877950 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Watches: rename object "dbo"."AH_Watches__dbt_tmp" to AH_Watches
20:32:03.907448 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:32:03.909226 [debug] [Thread-4  ]: On model.Shawn.AH_Watches: COMMIT
20:32:03.913616 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches".
20:32:03.913842 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Watches: 
    
  if object_id ('"dbo"."AH_Watches__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Watches__dbt_backup"
    end

20:32:04.201320 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
20:32:04.214379 [debug] [Thread-4  ]: finished collecting timing info
20:32:04.214737 [debug] [Thread-4  ]: On model.Shawn.AH_Watches: Close
20:32:04.215425 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c3cf820>]}
20:32:04.215801 [info ] [Thread-4  ]: 105 of 105 OK created table model dbo.AH_Watches................................ [[32mOK[0m in 3.80s]
20:32:04.216090 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Watches
20:33:06.267875 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 77.83 seconds
20:33:06.283695 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userproperties".
20:33:06.283948 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Userproperties: rename object "dbo"."AH_Userproperties" to AH_Userproperties__dbt_backup
20:33:06.715822 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
20:33:06.730971 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userproperties".
20:33:06.731233 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Userproperties: rename object "dbo"."AH_Userproperties__dbt_tmp" to AH_Userproperties
20:33:06.759842 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:33:06.761530 [debug] [Thread-2  ]: On model.Shawn.AH_Userproperties: COMMIT
20:33:06.765486 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userproperties".
20:33:06.765670 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Userproperties: 
    
  if object_id ('"dbo"."AH_Userproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Userproperties__dbt_backup"
    end

20:33:07.019760 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:33:07.032942 [debug] [Thread-2  ]: finished collecting timing info
20:33:07.033255 [debug] [Thread-2  ]: On model.Shawn.AH_Userproperties: Close
20:33:07.033950 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3e312430>]}
20:33:07.034344 [info ] [Thread-2  ]: 102 of 105 OK created table model dbo.AH_Userproperties......................... [[32mOK[0m in 78.63s]
20:33:07.034703 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Userproperties
20:33:46.397240 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 224.89 seconds
20:33:46.411556 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediaassets".
20:33:46.411811 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Mediaassets: rename object "dbo"."AH_Mediaassets" to AH_Mediaassets__dbt_backup
20:33:46.679767 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:33:46.694527 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediaassets".
20:33:46.694823 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Mediaassets: rename object "dbo"."AH_Mediaassets__dbt_tmp" to AH_Mediaassets
20:33:46.730154 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:33:46.731992 [debug] [Thread-1  ]: On model.Shawn.AH_Mediaassets: COMMIT
20:33:46.736408 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediaassets".
20:33:46.736626 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Mediaassets: 
    
  if object_id ('"dbo"."AH_Mediaassets__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Mediaassets__dbt_backup"
    end

20:33:46.974053 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:33:46.987969 [debug] [Thread-1  ]: finished collecting timing info
20:33:46.988282 [debug] [Thread-1  ]: On model.Shawn.AH_Mediaassets: Close
20:33:46.988960 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c864a30>]}
20:33:46.989346 [info ] [Thread-1  ]: 68 of 105 OK created table model dbo.AH_Mediaassets............................. [[32mOK[0m in 225.53s]
20:33:46.989657 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Mediaassets
20:34:11.477909 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 263.19 seconds
20:34:11.491501 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaMetaData".
20:34:11.491728 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_MediaMetaData: rename object "dbo"."AH_MediaMetaData" to AH_MediaMetaData__dbt_backup
20:34:11.562119 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:34:11.639569 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaMetaData".
20:34:11.639821 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_MediaMetaData: rename object "dbo"."AH_MediaMetaData__dbt_tmp" to AH_MediaMetaData
20:34:11.670812 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:34:11.672375 [debug] [Thread-3  ]: On model.Shawn.AH_MediaMetaData: COMMIT
20:34:11.676467 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaMetaData".
20:34:11.676623 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_MediaMetaData: 
    
  if object_id ('"dbo"."AH_MediaMetaData__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_MediaMetaData__dbt_backup"
    end

20:34:12.077517 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
20:34:12.090191 [debug] [Thread-3  ]: finished collecting timing info
20:34:12.090495 [debug] [Thread-3  ]: On model.Shawn.AH_MediaMetaData: Close
20:34:12.091217 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5715fa-7560-45f1-a785-4d579419a262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c7733d0>]}
20:34:12.091611 [info ] [Thread-3  ]: 66 of 105 OK created table model dbo.AH_MediaMetaData........................... [[32mOK[0m in 263.84s]
20:34:12.091905 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_MediaMetaData
20:34:12.093660 [debug] [MainThread]: Acquiring new synapse connection "master"
20:34:12.093919 [debug] [MainThread]: On master: COMMIT
20:34:12.094497 [info ] [MainThread]: 
20:34:12.094744 [info ] [MainThread]: Finished running 105 table models in 357.28s.
20:34:12.094895 [debug] [MainThread]: Connection 'master' was properly closed.
20:34:12.094968 [debug] [MainThread]: Connection 'model.Shawn.AH_Userproperties' was properly closed.
20:34:12.095031 [debug] [MainThread]: Connection 'model.Shawn.AH_Mediaassets' was properly closed.
20:34:12.095089 [debug] [MainThread]: Connection 'model.Shawn.AH_MediaMetaData' was properly closed.
20:34:12.095148 [debug] [MainThread]: Connection 'model.Shawn.AH_Watches' was properly closed.
20:34:12.127730 [info ] [MainThread]: 
20:34:12.128055 [info ] [MainThread]: [32mCompleted successfully[0m
20:34:12.128459 [info ] [MainThread]: 
20:34:12.128607 [info ] [MainThread]: Done. PASS=105 WARN=0 ERROR=0 SKIP=0 TOTAL=105
20:34:12.128869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c2db520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c6ee760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3c8d8a00>]}


============================== 2022-09-26 20:34:14.454830 | 06ad092e-2a75-4239-9cd0-8038c4ffbd6c ==============================
20:34:14.454830 [info ] [MainThread]: Running with dbt=1.0.0
20:34:14.455377 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step5_DM'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
20:34:14.455556 [debug] [MainThread]: Tracking: tracking
20:34:14.455835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcded5fbc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcded5fbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcded5fbdc0>]}
20:34:14.656422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:34:14.656729 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:34:14.683450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06ad092e-2a75-4239-9cd0-8038c4ffbd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcded5812e0>]}
20:34:14.733097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06ad092e-2a75-4239-9cd0-8038c4ffbd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdef5bf8b0>]}
20:34:14.733547 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:34:14.742260 [info ] [MainThread]: 
20:34:14.742957 [debug] [MainThread]: Acquiring new synapse connection "master"
20:34:14.744245 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
20:34:14.753700 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
20:34:14.753948 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
20:34:14.754040 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:34:14.754154 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:34:15.043256 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:34:15.077129 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.32 seconds
20:34:15.078912 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
20:34:15.100555 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
20:34:15.106468 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
20:34:15.106911 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
20:34:15.108511 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
20:34:15.108648 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
20:34:15.108734 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:34:15.108829 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:34:15.107118 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
20:34:15.110301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:34:15.110438 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:34:15.213281 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:34:15.214603 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:34:15.279001 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:34:15.283321 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:34:15.415373 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
20:34:15.415682 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
20:34:15.478295 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
20:34:15.478615 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
20:34:39.681736 [debug] [MainThread]: On master: COMMIT
20:34:39.682327 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
20:34:39.682628 [info ] [MainThread]: 
20:34:39.685791 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Buyers_DM
20:34:39.686116 [info ] [Thread-1  ]: 1 of 5 START table model dbo.AH_Buyers_DM....................................... [RUN]
20:34:39.686603 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Buyers_DM"
20:34:39.686748 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Buyers_DM
20:34:39.686862 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Buyers_DM
20:34:39.690455 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Buyers_DM"
20:34:39.690710 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Categories_DM
20:34:39.691176 [info ] [Thread-2  ]: 2 of 5 START table model dbo.AH_Categories_DM................................... [RUN]
20:34:39.691728 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Categories_DM"
20:34:39.691863 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Categories_DM
20:34:39.691979 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Categories_DM
20:34:39.690889 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Currencies_DM
20:34:39.694875 [info ] [Thread-4  ]: 4 of 5 START table model dbo.AH_Currencies_DM................................... [RUN]
20:34:39.695543 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Currencies_DM"
20:34:39.695678 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Currencies_DM
20:34:39.695774 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Currencies_DM
20:34:39.690806 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Consignors_DM
20:34:39.698857 [info ] [Thread-3  ]: 3 of 5 START table model dbo.AH_Consignors_DM................................... [RUN]
20:34:39.699370 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Consignors_DM"
20:34:39.699494 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Consignors_DM
20:34:39.699596 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Consignors_DM
20:34:39.694498 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Categories_DM"
20:34:39.703797 [debug] [Thread-2  ]: finished collecting timing info
20:34:39.703937 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Categories_DM
20:34:39.703514 [debug] [Thread-1  ]: finished collecting timing info
20:34:39.711865 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Buyers_DM
20:34:39.698435 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Currencies_DM"
20:34:39.730263 [debug] [Thread-4  ]: finished collecting timing info
20:34:39.703027 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Consignors_DM"
20:34:39.744946 [debug] [Thread-3  ]: finished collecting timing info
20:34:39.745189 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Consignors_DM
20:34:39.730522 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Currencies_DM
20:34:39.905054 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Currencies_DM"
20:34:39.914714 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies_DM".
20:34:39.914869 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Currencies_DM: 
  
  if object_id ('"dbo"."AH_Currencies_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Currencies_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Currencies_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Currencies_DM__dbt_tmp"
    end


   EXEC('create view dbo.AH_Currencies_DM__dbt_tmp_temp_view as
    
SELECT
	[Id] AS [CurrencyId],
	[ConversionToUSD],
	[Code],
	[LastUpdatedUser],
	[CreatedOn] AS [CreatedDate],
	[UpdatedOn] AS [UpdatedDate],
	[DeletedOn] AS [DeletedDate]
FROM [stg].[AH_Currencies_FinalView];
    ');

  CREATE TABLE "dbo"."AH_Currencies_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Currencies_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Currencies_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Currencies_DM__dbt_tmp_temp_view"
    end



20:34:39.914958 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:34:39.915068 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:34:39.914148 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Consignors_DM"
20:34:39.916811 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Consignors_DM".
20:34:39.916978 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Consignors_DM: 
  
  if object_id ('"dbo"."AH_Consignors_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Consignors_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Consignors_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Consignors_DM__dbt_tmp"
    end


   EXEC('create view dbo.AH_Consignors_DM__dbt_tmp_temp_view as
    
with UserProperties_temp as (
    select 
        t1.UserID,
        max(case Name when ''FirstName'' then StringNativeValue else NULL end) as FirstName,
        max(case Name when ''LastName'' then StringNativeValue else NULL end) as LastName,
        max(case Name when ''UserPhone'' then StringNativeValue else NULL end) as Phone,
        max(case Name when ''IsInternational'' then cast(EnumNativeValue as varchar(200)) else NULL end) as IsInternational,
        max(case Name when ''Reg_Reference'' then cast(EnumNativeValue as varchar(200)) else NULL end) as Reg_Reference,
        max(case Name when ''Reg_Referral'' then cast(EnumNativeValue as varchar(200)) else NULL end) as Reg_Referral
    from
        (SELECT
            up.*,
            cf.Name
        FROM [stg].[AH_UserProperties_FinalView] AS up
        left JOIN [stg].[AH_CustomFields_FinalView] as cf
            ON cf.[Id] = up.[CustomFieldId]
        where CustomFieldID=''5''
            or CustomFieldID=''6''
            or CustomFieldID=''161098''
            or CustomFieldID=''2407692''
            or CustomFieldID=''2694978''
            or CustomFieldID=''2708864''
        ) t1
    group by UserID
),
DMstg as (
    SELECT
        HASHBYTES(''SHA2_256'', COALESCE(CAST(u.[ID] AS VARCHAR(200)), '''')) as [Consignor_SKey],
        u.[ID] AS [UserID],
        u.[UserName],
        u.[Email],
        u.[Comment],
        upt.[FirstName],
        upt.[LastName],
        u.[PhoneNumber] AS [Phone],
        upt.[Phone] AS [UserPhone],
        upt.[IsInternational],
        upt.[Reg_Reference],
        upt.[Reg_Referral],
        u.[BillingAddressID],
        badd.[Street1] + '' '' + badd.[Street2] AS [BillingAddress],
        badd.[City] AS [BillingCity],
        badd.[StateRegion] AS [BillingState],
        badd.[ZipPostal] AS [BillingPostalCode],
        bc.[Name] AS [BillingCountry],
        u.[PrimaryAddressID],
        padd.[Street1] + '' '' + padd.[Street2] AS [PrimaryAddress],
        padd.[City] AS [PrimaryCity],
        padd.[StateRegion] AS [PrimaryState],
        padd.[ZipPostal] AS [PrimaryPostalCode],
        pc.[Name] AS [PrimaryCountry],
        u.[BillingCreditCardID],
        c.[ExpirationMonth] AS [CreditCardExpirationMonth],
        c.[ExpirationYear] AS [CreditCardExpirationYear],
        c.[LastFourDigits] AS [CreditCardLastFourDigits],
        c.[AddressID] AS [CreditCardAddressID],
        cadd.[Street1] + '' '' + cadd.[Street2] AS [CreditCardAddress],
        cadd.[City] AS [CreditCardCity],
        cadd.[StateRegion] AS [CreditCardState],
        cadd.[ZipPostal] AS [CreditCardPostalCode],
        cc.[Name] AS [CreditCardCountry],
        u.[Culture],
        u.[IsApproved],
        u.[IsLockedOut],
        u.[Newsletter],
        u.[IsVerified],
        u.[IsActive],
        u.[EmailConfirmed],
        u.[LastLoginDate],
        u.[LastActivityDate],
        u.[CreatedOn] AS [CreatedDate],
        u.[UpdatedOn] AS [UpdatedDate],
        u.[DeletedOn] AS [DeletedDate]
    from [stg].[AH_Users_FinalView] u
    left join UserProperties_temp upt on u.ID=upt.UserID
    left join [stg].[AH_CreditCards_FinalView] c on u.BillingCreditCardID=c.ID
    left join [stg].[AH_Addresses_FinalView] badd on badd.ID=u.BillingAddressID
    left join [stg].[AH_Addresses_FinalView] padd on padd.ID=u.PrimaryAddressID
    left join [stg].[AH_Addresses_FinalView] cadd on cadd.ID=c.AddressID
    left join [stg].[AH_Countries_FinalView] bc on  badd.CountryID=bc.ID
    left join [stg].[AH_Countries_FinalView] pc on  padd.CountryID=pc.ID
    left join [stg].[AH_Countries_FinalView] cc on  cadd.CountryID=cc.ID
    where u.ID in(
        select distinct(OwnerID) from [stg].[AH_Listings_FinalView]
    )
)
SELECT
	[Consignor_SKey],
    [UserID],
	[UserName],
	[Email],
	[Comment],
	[FirstName],
	[LastName],
	[Phone],
	[UserPhone],
	[IsInternational],
	[Reg_Reference],
	[Reg_Referral],
	[BillingAddressID],
	[BillingAddress],
	[BillingCity],
	[BillingState],
	[BillingPostalCode],
	[BillingCountry],
	[PrimaryAddressID],
	[PrimaryAddress],
	[PrimaryCity],
	[PrimaryState],
	[PrimaryPostalCode],
	[PrimaryCountry],
	[BillingCreditCardID],
	[CreditCardExpirationMonth],
	[CreditCardExpirationYear],
	[CreditCardLastFourDigits],
	[CreditCardAddressID],
	[CreditCardAddress],
	[CreditCardCity],
	[CreditCardState],
	[CreditCardPostalCode],
	[CreditCardCountry],
	[Culture],
	[IsApproved],
	[IsLockedOut],
	[Newsletter],
	[IsVerified],
	[IsActive],
	[EmailConfirmed],
	[LastLoginDate],
	[LastActivityDate],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from DMstg
    ');

  CREATE TABLE "dbo"."AH_Consignors_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Consignors_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Consignors_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Consignors_DM__dbt_tmp_temp_view"
    end



20:34:39.917097 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:34:39.917206 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:34:39.913527 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Categories_DM"
20:34:39.918784 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories_DM".
20:34:39.919223 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories_DM: 
  
  if object_id ('"dbo"."AH_Categories_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Categories_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Categories_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Categories_DM__dbt_tmp"
    end


   EXEC('create view dbo.AH_Categories_DM__dbt_tmp_temp_view as
    
SELECT
	Id,
	Name,
	ParentCategoryId,
	DisplayOrder,
	LastUpdatedUser,
	Type,
	MVCAction,
	RolesAllowed,
	EnabledCustomProperty,
	lft,
	rgt,
	CreatedOn,
	UpdatedOn,
	DeletedOn
FROM stg.AH_Categories_FinalView;
    ');

  CREATE TABLE "dbo"."AH_Categories_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Categories_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Categories_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Categories_DM__dbt_tmp_temp_view"
    end



20:34:39.919327 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:34:39.919434 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:34:39.911446 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Buyers_DM"
20:34:39.920357 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Buyers_DM".
20:34:39.920489 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Buyers_DM: 
  
  if object_id ('"dbo"."AH_Buyers_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Buyers_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Buyers_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Buyers_DM__dbt_tmp"
    end


   EXEC('create view dbo.AH_Buyers_DM__dbt_tmp_temp_view as
    

with UserProperties_temp as (
    select 
        t1.UserID,
        max(case Name when ''FirstName'' then StringNativeValue else NULL end) as FirstName,
        max(case Name when ''LastName'' then StringNativeValue else NULL end) as LastName,
        max(case Name when ''UserPhone'' then StringNativeValue else NULL end) as Phone,
        max(case Name when ''IsInternational'' then cast(EnumNativeValue as varchar(200)) else NULL end) as IsInternational,
        max(case Name when ''Reg_Reference'' then cast(EnumNativeValue as varchar(200)) else NULL end) as Reg_Reference,
        max(case Name when ''Reg_Referral'' then cast(EnumNativeValue as varchar(200)) else NULL end) as Reg_Referral
    from
        (SELECT
            up.*,
            cf.Name
        FROM [stg].[AH_UserProperties_FinalView] AS up
        left JOIN [stg].[AH_CustomFields_FinalView] as cf
            ON cf.[Id] = up.[CustomFieldId]
        where CustomFieldID=''5''
            or CustomFieldID=''6''
            or CustomFieldID=''161098''
            or CustomFieldID=''2407692''
            or CustomFieldID=''2694978''
            or CustomFieldID=''2708864''
        ) t1
    group by UserID
), part1 as (
    SELECT
        HASHBYTES(''SHA2_256'', COALESCE(CAST(u.[ID] AS VARCHAR(200)), '''')) AS [Buyer_SKey],
        u.[ID] AS [UserID],
        u.[UserName],
        u.[Email],
        u.[Comment],
        upt.[FirstName],
        upt.[LastName],
        u.[PhoneNumber] AS [Phone],
        upt.[Phone] AS [UserPhone],
        upt.[IsInternational],
        upt.[Reg_Reference],
        upt.[Reg_Referral],
        u.[BillingAddressID],
        badd.[Street1] + '' '' + badd.[Street2] AS [BillingAddress],
        badd.[City] AS [BillingCity],
        badd.[StateRegion] AS [BillingState],
        badd.[ZipPostal] AS [BillingPostalCode],
        bc.[Name] AS [BillingCountry],
        u.[PrimaryAddressID],
        padd.[Street1] + '' '' + padd.[Street2] AS [PrimaryAddress],
        padd.[City] AS [PrimaryCity],
        padd.[StateRegion] AS [PrimaryState],
        padd.[ZipPostal] AS [PrimaryPostalCode],
        pc.[Name] AS [PrimaryCountry],
        u.[BillingCreditCardID],
        c.[ExpirationMonth] AS [CreditCardExpirationMonth],
        c.[ExpirationYear] AS [CreditCardExpirationYear],
        c.[LastFourDigits] AS [CreditCardLastFourDigits],
        c.[AddressID] AS [CreditCardAddressID],
        cadd.[Street1] + '' '' + cadd.[Street2] AS [CreditCardAddress],
        cadd.[City] AS [CreditCardCity],
        cadd.[StateRegion] AS [CreditCardState],
        cadd.[ZipPostal] AS [CreditCardPostalCode],
        cc.[Name] AS [CreditCardCountry],
        u.[Culture],
        u.[IsApproved],
        u.[IsLockedOut],
        u.[Newsletter],
        u.[IsVerified],
        u.[IsActive],
        u.[EmailConfirmed],
        u.[LastLoginDate],
        u.[LastActivityDate],
        u.[CreatedOn] AS [CreatedDate],
        u.[UpdatedOn] AS [UpdatedDate],
        u.[DeletedOn] AS [DeletedDate]
    from [stg].[AH_Users_FinalView] u
    left join UserProperties_temp upt on u.ID=upt.UserID
    left join [stg].[AH_CreditCards_FinalView] c on u.BillingCreditCardID=c.ID
    left join [stg].[AH_Addresses_FinalView] badd on badd.ID=u.BillingAddressID
    left join [stg].[AH_Addresses_FinalView] padd on padd.ID=u.PrimaryAddressID
    left join [stg].[AH_Addresses_FinalView] cadd on cadd.ID=c.AddressID
    left join [stg].[AH_Countries_FinalView] bc on  badd.CountryID=bc.ID
    left join [stg].[AH_Countries_FinalView] pc on  padd.CountryID=pc.ID
    left join [stg].[AH_Countries_FinalView] cc on  cadd.CountryID=cc.ID
    where u.ID not in(
        select distinct(OwnerID) from [stg].[AH_Listings_FinalView]
    )
),
part2 as (
    SELECT
        HASHBYTES(''SHA2_256'', COALESCE(CAST(u.[ID] AS VARCHAR(200)), '''')) AS [Buyer_SKey],
        u.[ID] AS [UserID],
        u.[UserName],
        u.[Email],
        u.[Comment],
        upt.[FirstName],
        upt.[LastName],
        u.[PhoneNumber] AS [Phone],
        upt.[Phone] AS [UserPhone],
        upt.[IsInternational],
        upt.[Reg_Reference],
        upt.[Reg_Referral],
        u.[BillingAddressID],
        badd.[Street1] + '' '' + badd.[Street2] AS [BillingAddress],
        badd.[City] AS [BillingCity],
        badd.[StateRegion] AS [BillingState],
        badd.[ZipPostal] AS [BillingPostalCode],
        bc.[Name] AS [BillingCountry],
        u.[PrimaryAddressID],
        padd.[Street1] + '' '' + padd.[Street2] AS [PrimaryAddress],
        padd.[City] AS [PrimaryCity],
        padd.[StateRegion] AS [PrimaryState],
        padd.[ZipPostal] AS [PrimaryPostalCode],
        pc.[Name] AS [PrimaryCountry],
        u.[BillingCreditCardID],
        c.[ExpirationMonth] AS [CreditCardExpirationMonth],
        c.[ExpirationYear] AS [CreditCardExpirationYear],
        c.[LastFourDigits] AS [CreditCardLastFourDigits],
        c.[AddressID] AS [CreditCardAddressID],
        cadd.[Street1] + '' '' + cadd.[Street2] AS [CreditCardAddress],
        cadd.[City] AS [CreditCardCity],
        cadd.[StateRegion] AS [CreditCardState],
        cadd.[ZipPostal] AS [CreditCardPostalCode],
        cc.[Name] AS [CreditCardCountry],
        u.[Culture],
        u.[IsApproved],
        u.[IsLockedOut],
        u.[Newsletter],
        u.[IsVerified],
        u.[IsActive],
        u.[EmailConfirmed],
        u.[LastLoginDate],
        u.[LastActivityDate],
        u.[CreatedOn] AS [CreatedDate],
        u.[UpdatedOn] AS [UpdatedDate],
        u.[DeletedOn] AS [DeletedDate]
    from [stg].[AH_Users_FinalView] u
    left join UserProperties_temp upt on u.ID=upt.UserID
    left join [stg].[AH_CreditCards_FinalView] c on u.BillingCreditCardID=c.ID
    left join [stg].[AH_Addresses_FinalView] badd on badd.ID=u.BillingAddressID
    left join [stg].[AH_Addresses_FinalView] padd on padd.ID=u.PrimaryAddressID
    left join [stg].[AH_Addresses_FinalView] cadd on cadd.ID=c.AddressID
    left join [stg].[AH_Countries_FinalView] bc on  badd.CountryID=bc.ID
    left join [stg].[AH_Countries_FinalView] pc on  padd.CountryID=pc.ID
    left join [stg].[AH_Countries_FinalView] cc on  cadd.CountryID=cc.ID
    where u.ID in(
        select distinct(UserID) from [stg].[AH_ListingActions_FinalView]
        union
        select distinct(UserID) from [stg].[AH_Watches_FinalView]
        union
        select distinct(UserID) from [stg].[AH_ListingComments_FinalView]
    )
)

select
	[Buyer_SKey],
	[UserID],
	[UserName],
	[Email],
	[Comment],
	[FirstName],
	[LastName],
	[Phone],
	[UserPhone],
	[IsInternational],
	[Reg_Reference],
	[Reg_Referral],
	[BillingAddressID],
	[BillingAddress],
	[BillingCity],
	[BillingState],
	[BillingPostalCode],
	[BillingCountry],
	[PrimaryAddressID],
	[PrimaryAddress],
	[PrimaryCity],
	[PrimaryState],
	[PrimaryPostalCode],
	[PrimaryCountry],
	[BillingCreditCardID],
	[CreditCardExpirationMonth],
	[CreditCardExpirationYear],
	[CreditCardLastFourDigits],
	[CreditCardAddressID],
	[CreditCardAddress],
	[CreditCardCity],
	[CreditCardState],
	[CreditCardPostalCode],
	[CreditCardCountry],
	[Culture],
	[IsApproved],
	[IsLockedOut],
	[Newsletter],
	[IsVerified],
	[IsActive],
	[EmailConfirmed],
	[LastLoginDate],
	[LastActivityDate],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from part1 
union all 
select 
	[Buyer_SKey],
	[UserID],
	[UserName],
	[Email],
	[Comment],
	[FirstName],
	[LastName],
	[Phone],
	[UserPhone],
	[IsInternational],
	[Reg_Reference],
	[Reg_Referral],
	[BillingAddressID],
	[BillingAddress],
	[BillingCity],
	[BillingState],
	[BillingPostalCode],
	[BillingCountry],
	[PrimaryAddressID],
	[PrimaryAddress],
	[PrimaryCity],
	[PrimaryState],
	[PrimaryPostalCode],
	[PrimaryCountry],
	[BillingCreditCardID],
	[CreditCardExpirationMonth],
	[CreditCardExpirationYear],
	[CreditCardLastFourDigits],
	[CreditCardAddressID],
	[CreditCardAddress],
	[CreditCardCity],
	[CreditCardState],
	[CreditCardPostalCode],
	[CreditCardCountry],
	[Culture],
	[IsApproved],
	[IsLockedOut],
	[Newsletter],
	[IsVerified],
	[IsActive],
	[EmailConfirmed],
	[LastLoginDate],
	[LastActivityDate],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from part2
    ');

  CREATE TABLE "dbo"."AH_Buyers_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Buyers_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Buyers_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Buyers_DM__dbt_tmp_temp_view"
    end



20:34:39.920588 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:34:39.920684 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:34:40.065979 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:34:40.067094 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:34:40.074812 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:34:40.075311 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:34:42.785839 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.87 seconds
20:34:42.805473 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies_DM".
20:34:42.805730 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Currencies_DM: rename object "dbo"."AH_Currencies_DM" to AH_Currencies_DM__dbt_backup
20:34:42.877024 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:34:42.967336 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies_DM".
20:34:42.967606 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Currencies_DM: rename object "dbo"."AH_Currencies_DM__dbt_tmp" to AH_Currencies_DM
20:34:43.016085 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.10 seconds
20:34:43.026278 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
20:34:43.041403 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories_DM".
20:34:43.041667 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories_DM: rename object "dbo"."AH_Categories_DM" to AH_Categories_DM__dbt_backup
20:34:43.043630 [debug] [Thread-4  ]: On model.Shawn.AH_Currencies_DM: COMMIT
20:34:43.050775 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies_DM".
20:34:43.050991 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Currencies_DM: 
    
  if object_id ('"dbo"."AH_Currencies_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Currencies_DM__dbt_backup"
    end

20:34:43.072566 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:34:43.086997 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories_DM".
20:34:43.087264 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories_DM: rename object "dbo"."AH_Categories_DM__dbt_tmp" to AH_Categories_DM
20:34:43.115564 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:34:43.117310 [debug] [Thread-2  ]: On model.Shawn.AH_Categories_DM: COMMIT
20:34:43.121623 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories_DM".
20:34:43.121846 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories_DM: 
    
  if object_id ('"dbo"."AH_Categories_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Categories_DM__dbt_backup"
    end

20:34:43.264561 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:34:43.277327 [debug] [Thread-4  ]: finished collecting timing info
20:34:43.277666 [debug] [Thread-4  ]: On model.Shawn.AH_Currencies_DM: Close
20:34:43.278453 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ad092e-2a75-4239-9cd0-8038c4ffbd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde709e5b0>]}
20:34:43.278977 [info ] [Thread-4  ]: 4 of 5 OK created table model dbo.AH_Currencies_DM.............................. [[32mOK[0m in 3.58s]
20:34:43.279308 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Currencies_DM
20:34:43.279467 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ShippingOptions_DM
20:34:43.279776 [info ] [Thread-4  ]: 5 of 5 START table model dbo.AH_ShippingOptions_DM.............................. [RUN]
20:34:43.280166 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ShippingOptions_DM"
20:34:43.280280 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ShippingOptions_DM
20:34:43.280394 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ShippingOptions_DM
20:34:43.283110 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ShippingOptions_DM"
20:34:43.283528 [debug] [Thread-4  ]: finished collecting timing info
20:34:43.283656 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ShippingOptions_DM
20:34:43.320655 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ShippingOptions_DM"
20:34:43.321214 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions_DM".
20:34:43.321356 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions_DM: 
  
  if object_id ('"dbo"."AH_ShippingOptions_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ShippingOptions_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ShippingOptions_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ShippingOptions_DM__dbt_tmp"
    end


   EXEC('create view dbo.AH_ShippingOptions_DM__dbt_tmp_temp_view as
    
SELECT
	so.[Id] AS [ShippingOptionID],
	so.[ShippingMethodId] AS [ShippingMethodID],
	sm.[Name] AS [ShippingMethod],
	so.[FirstItemAmount],
	so.[ListingId] AS [ListingID],
	so.[AdditionalItemAmount],
	so.[CreatedOn] AS [CreatedDate],
	so.[UpdatedOn] AS [UpdatedDate],
	so.[DeletedOn] AS [DeletedDate]
From
	[stg].[AH_ShippingOptions_FinalView] AS so
left JOIN [stg].[AH_ShippingMethods_FinalView] AS sm 
on so.ShippingMethodID=sm.ID
    ');

  CREATE TABLE "dbo"."AH_ShippingOptions_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ShippingOptions_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ShippingOptions_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ShippingOptions_DM__dbt_tmp_temp_view"
    end



20:34:43.321449 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:34:43.321555 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:34:43.381632 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:34:43.396765 [debug] [Thread-2  ]: finished collecting timing info
20:34:43.397111 [debug] [Thread-2  ]: On model.Shawn.AH_Categories_DM: Close
20:34:43.397819 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ad092e-2a75-4239-9cd0-8038c4ffbd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde7051070>]}
20:34:43.398248 [info ] [Thread-2  ]: 2 of 5 OK created table model dbo.AH_Categories_DM.............................. [[32mOK[0m in 3.71s]
20:34:43.398593 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Categories_DM
20:34:43.422609 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:34:47.115121 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.79 seconds
20:34:47.131072 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions_DM".
20:34:47.131334 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions_DM: rename object "dbo"."AH_ShippingOptions_DM" to AH_ShippingOptions_DM__dbt_backup
20:34:47.171462 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:34:47.185796 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions_DM".
20:34:47.186062 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions_DM: rename object "dbo"."AH_ShippingOptions_DM__dbt_tmp" to AH_ShippingOptions_DM
20:34:47.217793 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:34:47.219573 [debug] [Thread-4  ]: On model.Shawn.AH_ShippingOptions_DM: COMMIT
20:34:47.223659 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions_DM".
20:34:47.223853 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions_DM: 
    
  if object_id ('"dbo"."AH_ShippingOptions_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ShippingOptions_DM__dbt_backup"
    end

20:34:48.090561 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.87 seconds
20:34:48.104133 [debug] [Thread-4  ]: finished collecting timing info
20:34:48.104484 [debug] [Thread-4  ]: On model.Shawn.AH_ShippingOptions_DM: Close
20:34:48.105236 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ad092e-2a75-4239-9cd0-8038c4ffbd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde70911f0>]}
20:34:48.105689 [info ] [Thread-4  ]: 5 of 5 OK created table model dbo.AH_ShippingOptions_DM......................... [[32mOK[0m in 4.83s]
20:34:48.106026 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ShippingOptions_DM
20:34:48.314556 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 8.40 seconds
20:34:48.329397 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Consignors_DM".
20:34:48.329670 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Consignors_DM: rename object "dbo"."AH_Consignors_DM" to AH_Consignors_DM__dbt_backup
20:34:48.699718 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.37 seconds
20:34:48.714862 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Consignors_DM".
20:34:48.715376 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Consignors_DM: rename object "dbo"."AH_Consignors_DM__dbt_tmp" to AH_Consignors_DM
20:34:48.753110 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:34:48.754890 [debug] [Thread-3  ]: On model.Shawn.AH_Consignors_DM: COMMIT
20:34:48.759133 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Consignors_DM".
20:34:48.759340 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Consignors_DM: 
    
  if object_id ('"dbo"."AH_Consignors_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Consignors_DM__dbt_backup"
    end

20:34:49.211758 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.45 seconds
20:34:49.224893 [debug] [Thread-3  ]: finished collecting timing info
20:34:49.225234 [debug] [Thread-3  ]: On model.Shawn.AH_Consignors_DM: Close
20:34:49.226028 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ad092e-2a75-4239-9cd0-8038c4ffbd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde70541c0>]}
20:34:49.226481 [info ] [Thread-3  ]: 3 of 5 OK created table model dbo.AH_Consignors_DM.............................. [[32mOK[0m in 9.53s]
20:34:49.226868 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Consignors_DM
20:34:54.030472 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 14.11 seconds
20:34:54.045218 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Buyers_DM".
20:34:54.045488 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Buyers_DM: rename object "dbo"."AH_Buyers_DM" to AH_Buyers_DM__dbt_backup
20:34:54.080643 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:34:54.094292 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Buyers_DM".
20:34:54.094652 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Buyers_DM: rename object "dbo"."AH_Buyers_DM__dbt_tmp" to AH_Buyers_DM
20:34:54.122648 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:34:54.124543 [debug] [Thread-1  ]: On model.Shawn.AH_Buyers_DM: COMMIT
20:34:54.129090 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Buyers_DM".
20:34:54.129316 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Buyers_DM: 
    
  if object_id ('"dbo"."AH_Buyers_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Buyers_DM__dbt_backup"
    end

20:34:54.370998 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:34:54.383932 [debug] [Thread-1  ]: finished collecting timing info
20:34:54.384263 [debug] [Thread-1  ]: On model.Shawn.AH_Buyers_DM: Close
20:34:54.385021 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ad092e-2a75-4239-9cd0-8038c4ffbd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde709ecd0>]}
20:34:54.385458 [info ] [Thread-1  ]: 1 of 5 OK created table model dbo.AH_Buyers_DM.................................. [[32mOK[0m in 14.70s]
20:34:54.385777 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Buyers_DM
20:34:54.387277 [debug] [MainThread]: Acquiring new synapse connection "master"
20:34:54.387555 [debug] [MainThread]: On master: COMMIT
20:34:54.387860 [info ] [MainThread]: 
20:34:54.388138 [info ] [MainThread]: Finished running 5 table models in 39.65s.
20:34:54.388299 [debug] [MainThread]: Connection 'master' was properly closed.
20:34:54.388375 [debug] [MainThread]: Connection 'model.Shawn.AH_Categories_DM' was properly closed.
20:34:54.388439 [debug] [MainThread]: Connection 'model.Shawn.AH_Buyers_DM' was properly closed.
20:34:54.388500 [debug] [MainThread]: Connection 'model.Shawn.AH_ShippingOptions_DM' was properly closed.
20:34:54.388558 [debug] [MainThread]: Connection 'model.Shawn.AH_Consignors_DM' was properly closed.
20:34:54.493025 [info ] [MainThread]: 
20:34:54.493355 [info ] [MainThread]: [32mCompleted successfully[0m
20:34:54.493662 [info ] [MainThread]: 
20:34:54.493807 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
20:34:54.494069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdef5bfc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcded00c040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde7409c40>]}


============================== 2022-09-26 20:34:56.855149 | 9f26dc3b-402f-498c-9455-c425b637e10c ==============================
20:34:56.855149 [info ] [MainThread]: Running with dbt=1.0.0
20:34:56.855706 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step6_FT_1_stg'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
20:34:56.855909 [debug] [MainThread]: Tracking: tracking
20:34:56.856206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fee0afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fee0ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fee0afa0>]}
20:34:57.066025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:34:57.066351 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:34:57.093494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f26dc3b-402f-498c-9455-c425b637e10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fed902e0>]}
20:34:57.145039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f26dc3b-402f-498c-9455-c425b637e10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8700dd18b0>]}
20:34:57.145620 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:34:57.154799 [info ] [MainThread]: 
20:34:57.155507 [debug] [MainThread]: Acquiring new synapse connection "master"
20:34:57.156927 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
20:34:57.166435 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
20:34:57.166730 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
20:34:57.166832 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:34:57.166953 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:34:57.477600 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:34:57.511140 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.34 seconds
20:34:57.513104 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
20:34:57.535920 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
20:34:57.542266 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
20:34:57.542527 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
20:34:57.543020 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
20:34:57.544913 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
20:34:57.545099 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
20:34:57.545187 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:34:57.545289 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:34:57.543244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:34:57.546708 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:34:57.683167 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:34:57.684659 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:34:57.750970 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:34:57.753803 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:34:57.886378 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
20:34:57.886725 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
20:34:57.948441 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
20:34:57.948759 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
20:35:20.655434 [debug] [MainThread]: On master: COMMIT
20:35:20.656039 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
20:35:20.656291 [info ] [MainThread]: 
20:35:20.660120 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Invoices_FT_stg
20:35:20.660526 [info ] [Thread-1  ]: 1 of 6 START table model stg.AH_Invoices_FT_stg................................. [RUN]
20:35:20.661030 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Invoices_FT_stg"
20:35:20.661172 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Invoices_FT_stg
20:35:20.661289 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Invoices_FT_stg
20:35:20.664255 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Invoices_FT_stg"
20:35:20.664476 [debug] [Thread-2  ]: Began running node model.Shawn.AH_LineItems_FT_stg
20:35:20.664929 [info ] [Thread-2  ]: 2 of 6 START table model stg.AH_LineItems_FT_stg................................ [RUN]
20:35:20.665490 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_LineItems_FT_stg"
20:35:20.665623 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_LineItems_FT_stg
20:35:20.665720 [debug] [Thread-2  ]: Compiling model.Shawn.AH_LineItems_FT_stg
20:35:20.664653 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingPaymentCharge_FT_stg
20:35:20.668675 [info ] [Thread-4  ]: 4 of 6 START table model stg.AH_ListingPaymentCharge_FT_stg..................... [RUN]
20:35:20.669110 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_stg"
20:35:20.669224 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingPaymentCharge_FT_stg
20:35:20.669316 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingPaymentCharge_FT_stg
20:35:20.664571 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingActions_FT_stg
20:35:20.672243 [info ] [Thread-3  ]: 3 of 6 START table model stg.AH_ListingActions_FT_stg........................... [RUN]
20:35:20.672690 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingActions_FT_stg"
20:35:20.672815 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingActions_FT_stg
20:35:20.672910 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingActions_FT_stg
20:35:20.668372 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_LineItems_FT_stg"
20:35:20.676259 [debug] [Thread-2  ]: finished collecting timing info
20:35:20.676396 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_LineItems_FT_stg
20:35:20.675999 [debug] [Thread-1  ]: finished collecting timing info
20:35:20.683857 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Invoices_FT_stg
20:35:20.671914 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingPaymentCharge_FT_stg"
20:35:20.702227 [debug] [Thread-4  ]: finished collecting timing info
20:35:20.702470 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingPaymentCharge_FT_stg
20:35:20.675589 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingActions_FT_stg"
20:35:20.704384 [debug] [Thread-3  ]: finished collecting timing info
20:35:20.704555 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingActions_FT_stg
20:35:20.967626 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_LineItems_FT_stg"
20:35:20.976093 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_stg".
20:35:20.976298 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_stg: 
  
  if object_id ('"stg"."AH_LineItems_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LineItems_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_LineItems_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_LineItems_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_LineItems_FT_stg__dbt_tmp_temp_view as
    
SELECT
		[Id] AS [LineItemsID],
		[OwnerId] AS [OwnerID],
		[PayerId] AS [PayerID],
		[InvoiceId] AS [InvoiceID],
		[ListingId] AS [ListingID],
		[Description],
		[LastUpdatedUser],
		[Currency],
		[Status],
		[Type],
		[TotalAmount],
		[Quantity] AS [QTY],
		[PerUnitAmount],
		[Taxable] AS [IsTaxable],
		[IsArchived],
		[Relistiteration],
		[BuyersPremiumApplies] AS [HasBuyerPremiumApplies],
		[IsPayerArchived],
		[DateStamp],
		[CreatedOn] AS [CreatedDate],
		[UpdatedOn] AS [UpdatedDate],
		[DeletedOn] AS [DeletedDate]
FROM [stg].[AH_LineItems_FinalView];
    ');

  CREATE TABLE "stg"."AH_LineItems_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_LineItems_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_LineItems_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LineItems_FT_stg__dbt_tmp_temp_view"
    end



20:35:20.976396 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:35:20.976511 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:35:20.979557 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingPaymentCharge_FT_stg"
20:35:20.989443 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_stg".
20:35:20.989601 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_stg: 
  
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view as
    
SELECT
		[Id] AS [ListingPaymentChargeID],
		[BuyerId],
		[ListingId] AS [ListingID],
		[ChargeAmount],
		[TotalBid],
		[BidHoldPercentage],
		[MaximumBidCharge],
		[TransactionId] AS [TransactionID],
		[CreatedOn] AS [CreatedDate],
		[UpdatedOn] AS [UpdatedDate]
FROM stg.AH_ListingPaymentCharge_FinalView;
    ');

  CREATE TABLE "stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view"
    end



20:35:20.989690 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:35:20.989795 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:35:20.988911 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingActions_FT_stg"
20:35:20.991085 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_stg".
20:35:20.991246 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_stg: 
  
  if object_id ('"stg"."AH_ListingActions_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActions_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_ListingActions_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingActions_FT_stg__dbt_tmp_temp_view as
    
SELECT
		[Id] AS [ListingActionID],
		[UserId] AS [UserID],
		[ListingId] AS [ListingID],
		[ActionDTTM],
		[Description],
		[LastUpdatedUser],
		[Amount],
		[ProxyAmount],
		[Quantity] AS [QTY],
		[Reason],
		[Status],
		[UserEntered] AS [HasUserEntered],
		[CreatedOn] AS [CreatedDate],
		[UpdatedOn] AS [UpdatedDate],
		[DeletedOn] AS [DeletedDate]
FROM [stg].[AH_ListingActions_FinalView];
    ');

  CREATE TABLE "stg"."AH_ListingActions_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingActions_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingActions_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActions_FT_stg__dbt_tmp_temp_view"
    end



20:35:20.991341 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:35:20.991447 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:35:20.995845 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Invoices_FT_stg"
20:35:20.996263 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_stg".
20:35:20.996397 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_stg: 
  
  if object_id ('"stg"."AH_Invoices_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Invoices_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_Invoices_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_Invoices_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_Invoices_FT_stg__dbt_tmp_temp_view as
    
SELECT
	[Id] AS [InvoiceID],
	[PayerId] AS [PayerID],
	[OwnerId] AS [OwnerID],
	[CreatedOn] AS [CreatedDate],
	[UpdatedOn] AS [UpdatedDate],
	[DeletedOn] AS [DeletedDate],
	[Status],
	[CreatedDTTM],
	[FulfilledDTTM],
	[Comments] AS [Comment],
	[LastUpdatedUser],
	[Currency],
	[Type],
	[ShippingAmount],
	[Subtotal],
	[Total],
	[ShippingFirstName],
	[ShippingLastName],
	[ShippingStreet1],
	[ShippingStreet2],
	[ShippingCity],
	[ShippingStateRegion] AS [ShippingState],
	[ShippingZipPostal] AS [ShippingPostalCode],
	[ShippingCountry],
	[BIllingFIrstName] AS [BillingFIrstName],
	[BillingLastName],
	[BillingStreet1],
	[BillingStreet2],
	[BillingCity],
	[BillingStateRegion] AS [BillingState],
	[BillingZIpPostal] AS [BillingPostalCode],
	[BillingCountry],
	[SalesTax],
	[PaidDTTM],
	[IsPayerLocked],
	[Shipped] AS [HasShipped],
	[ShippingDetails],
	[BuyersPremiumPercent] AS [BuyerPremiumPct],
	[BuyersPremiumAmount] AS [BuyerPremiumAmount],
	[IsArchived]
FROM [stg].[AH_Invoices_FinalView];
    ');

  CREATE TABLE "stg"."AH_Invoices_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Invoices_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Invoices_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Invoices_FT_stg__dbt_tmp_temp_view"
    end



20:35:20.996485 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:35:20.996591 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:35:21.090722 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:35:21.115906 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:35:21.117025 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:35:21.117563 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:35:24.517001 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.54 seconds
20:35:24.536214 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_stg".
20:35:24.536472 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_stg: rename object "stg"."AH_LineItems_FT_stg" to AH_LineItems_FT_stg__dbt_backup
20:35:24.618085 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:35:24.632622 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_stg".
20:35:24.632899 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_stg: rename object "stg"."AH_LineItems_FT_stg__dbt_tmp" to AH_LineItems_FT_stg
20:35:24.666630 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:35:24.677992 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT_stg: COMMIT
20:35:24.685178 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_stg".
20:35:24.685428 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_stg: 
    
  if object_id ('"stg"."AH_LineItems_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_LineItems_FT_stg__dbt_backup"
    end

20:35:24.736114 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.74 seconds
20:35:24.825104 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_stg".
20:35:24.825387 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_stg: rename object "stg"."AH_Invoices_FT_stg" to AH_Invoices_FT_stg__dbt_backup
20:35:24.869028 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:35:24.902096 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_stg".
20:35:24.902361 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_stg: rename object "stg"."AH_Invoices_FT_stg__dbt_tmp" to AH_Invoices_FT_stg
20:35:24.909749 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:35:24.936163 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:35:24.940814 [debug] [Thread-1  ]: On model.Shawn.AH_Invoices_FT_stg: COMMIT
20:35:24.937995 [debug] [Thread-2  ]: finished collecting timing info
20:35:24.948875 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT_stg: Close
20:35:24.951609 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f26dc3b-402f-498c-9455-c425b637e10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fc8e1520>]}
20:35:24.952101 [info ] [Thread-2  ]: 2 of 6 OK created table model stg.AH_LineItems_FT_stg........................... [[32mOK[0m in 4.29s]
20:35:24.952430 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_LineItems_FT_stg
20:35:24.952590 [debug] [Thread-2  ]: Began running node model.Shawn.AH_SubmittedListingPayment_FT_stg
20:35:24.958489 [info ] [Thread-2  ]: 5 of 6 START table model stg.AH_SubmittedListingPayment_FT_stg.................. [RUN]
20:35:24.961607 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_stg"
20:35:24.962382 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_SubmittedListingPayment_FT_stg
20:35:24.962523 [debug] [Thread-2  ]: Compiling model.Shawn.AH_SubmittedListingPayment_FT_stg
20:35:24.965626 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_SubmittedListingPayment_FT_stg"
20:35:24.965952 [debug] [Thread-2  ]: finished collecting timing info
20:35:24.966077 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_SubmittedListingPayment_FT_stg
20:35:24.958179 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_stg".
20:35:24.972530 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_stg: 
    
  if object_id ('"stg"."AH_Invoices_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_Invoices_FT_stg__dbt_backup"
    end

20:35:25.073210 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_SubmittedListingPayment_FT_stg"
20:35:25.073768 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_stg".
20:35:25.073920 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_stg: 
  
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view as
    
SELECT
		[Id] AS [SubmittedListingPaymentID],
		[ConsignorId] AS [UserID],
		[ListingId] AS [ListingID],
		[Amount],
		[HasProPhotography],
		[HasProMarketing],
		[TransactionId] AS [TransactionID],
		[CreatedOn] AS [CreatedDate],
		[UpdatedOn] AS [UpdatedDate]
FROM [stg].[AH_SubmittedListingPayment_FinalView];
    ');

  CREATE TABLE "stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view"
    end



20:35:25.074017 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:35:25.074126 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:35:25.180972 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:35:25.193858 [debug] [Thread-1  ]: finished collecting timing info
20:35:25.194160 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:35:25.194363 [debug] [Thread-1  ]: On model.Shawn.AH_Invoices_FT_stg: Close
20:35:25.195224 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f26dc3b-402f-498c-9455-c425b637e10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fc952e50>]}
20:35:25.195654 [info ] [Thread-1  ]: 1 of 6 OK created table model stg.AH_Invoices_FT_stg............................ [[32mOK[0m in 4.53s]
20:35:25.195962 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Invoices_FT_stg
20:35:25.196109 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Watches_FT_stg
20:35:25.196406 [info ] [Thread-1  ]: 6 of 6 START table model stg.AH_Watches_FT_stg.................................. [RUN]
20:35:25.196788 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Watches_FT_stg"
20:35:25.196900 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Watches_FT_stg
20:35:25.196999 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Watches_FT_stg
20:35:25.199573 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Watches_FT_stg"
20:35:25.199890 [debug] [Thread-1  ]: finished collecting timing info
20:35:25.200010 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Watches_FT_stg
20:35:25.263070 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Watches_FT_stg"
20:35:25.263616 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_stg".
20:35:25.263765 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_stg: 
  
  if object_id ('"stg"."AH_Watches_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Watches_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_Watches_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_Watches_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_Watches_FT_stg__dbt_tmp_temp_view as
    
SELECT
		[Id] AS [WatchID],
		[UserId] AS [UserID],
		[ListingId] AS [ListingID],
		[LastUpdatedUser],
		[CreatedOn] AS [CreatedDate],
		[UpdatedOn] AS [UpdatedDate],
		[DeletedOn] AS [DeletedDate]
From [stg].[AH_Watches_FinalView]
    ');

  CREATE TABLE "stg"."AH_Watches_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Watches_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Watches_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Watches_FT_stg__dbt_tmp_temp_view"
    end



20:35:25.263855 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:35:25.263975 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:35:25.384981 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:35:25.469251 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 4.48 seconds
20:35:25.484489 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_stg".
20:35:25.484768 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_stg: rename object "stg"."AH_ListingPaymentCharge_FT_stg" to AH_ListingPaymentCharge_FT_stg__dbt_backup
20:35:25.512695 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:35:25.526671 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_stg".
20:35:25.526946 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_stg: rename object "stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp" to AH_ListingPaymentCharge_FT_stg
20:35:25.565251 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:35:25.567144 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT_stg: COMMIT
20:35:25.571506 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_stg".
20:35:25.571693 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_stg: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_FT_stg__dbt_backup"
    end

20:35:25.816747 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:35:25.829810 [debug] [Thread-4  ]: finished collecting timing info
20:35:25.830154 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT_stg: Close
20:35:25.830990 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f26dc3b-402f-498c-9455-c425b637e10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fc941fd0>]}
20:35:25.831471 [info ] [Thread-4  ]: 4 of 6 OK created table model stg.AH_ListingPaymentCharge_FT_stg................ [[32mOK[0m in 5.16s]
20:35:25.831813 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingPaymentCharge_FT_stg
20:35:27.223829 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.23 seconds
20:35:27.239349 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_stg".
20:35:27.239656 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_stg: rename object "stg"."AH_ListingActions_FT_stg" to AH_ListingActions_FT_stg__dbt_backup
20:35:27.277121 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:35:27.291441 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_stg".
20:35:27.291733 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_stg: rename object "stg"."AH_ListingActions_FT_stg__dbt_tmp" to AH_ListingActions_FT_stg
20:35:27.320733 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:35:27.322531 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT_stg: COMMIT
20:35:27.326952 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_stg".
20:35:27.327225 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_stg: 
    
  if object_id ('"stg"."AH_ListingActions_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_FT_stg__dbt_backup"
    end

20:35:27.551329 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:35:27.566971 [debug] [Thread-3  ]: finished collecting timing info
20:35:27.567316 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT_stg: Close
20:35:27.568052 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f26dc3b-402f-498c-9455-c425b637e10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fc8a3a90>]}
20:35:27.568491 [info ] [Thread-3  ]: 3 of 6 OK created table model stg.AH_ListingActions_FT_stg...................... [[32mOK[0m in 6.90s]
20:35:27.568809 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingActions_FT_stg
20:35:27.583696 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.51 seconds
20:35:27.598376 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_stg".
20:35:27.598679 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_stg: rename object "stg"."AH_SubmittedListingPayment_FT_stg" to AH_SubmittedListingPayment_FT_stg__dbt_backup
20:35:27.631692 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:35:27.646727 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_stg".
20:35:27.647009 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_stg: rename object "stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp" to AH_SubmittedListingPayment_FT_stg
20:35:27.675768 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:35:27.677703 [debug] [Thread-2  ]: On model.Shawn.AH_SubmittedListingPayment_FT_stg: COMMIT
20:35:27.682694 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_stg".
20:35:27.682911 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_stg: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_FT_stg__dbt_backup"
    end

20:35:27.878278 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:35:27.891214 [debug] [Thread-2  ]: finished collecting timing info
20:35:27.891560 [debug] [Thread-2  ]: On model.Shawn.AH_SubmittedListingPayment_FT_stg: Close
20:35:27.892320 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f26dc3b-402f-498c-9455-c425b637e10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fc04e340>]}
20:35:27.892759 [info ] [Thread-2  ]: 5 of 6 OK created table model stg.AH_SubmittedListingPayment_FT_stg............. [[32mOK[0m in 2.93s]
20:35:27.893074 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_SubmittedListingPayment_FT_stg
20:35:28.898446 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.63 seconds
20:35:28.913250 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_stg".
20:35:28.913532 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_stg: rename object "stg"."AH_Watches_FT_stg" to AH_Watches_FT_stg__dbt_backup
20:35:28.945106 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:35:28.959554 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_stg".
20:35:28.959842 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_stg: rename object "stg"."AH_Watches_FT_stg__dbt_tmp" to AH_Watches_FT_stg
20:35:28.988334 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:35:28.990276 [debug] [Thread-1  ]: On model.Shawn.AH_Watches_FT_stg: COMMIT
20:35:28.994449 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_stg".
20:35:28.994732 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_stg: 
    
  if object_id ('"stg"."AH_Watches_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_Watches_FT_stg__dbt_backup"
    end

20:35:29.198069 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:35:29.211448 [debug] [Thread-1  ]: finished collecting timing info
20:35:29.211821 [debug] [Thread-1  ]: On model.Shawn.AH_Watches_FT_stg: Close
20:35:29.212622 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f26dc3b-402f-498c-9455-c425b637e10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fcab0be0>]}
20:35:29.213081 [info ] [Thread-1  ]: 6 of 6 OK created table model stg.AH_Watches_FT_stg............................. [[32mOK[0m in 4.02s]
20:35:29.213403 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Watches_FT_stg
20:35:29.215018 [debug] [MainThread]: Acquiring new synapse connection "master"
20:35:29.215299 [debug] [MainThread]: On master: COMMIT
20:35:29.215623 [info ] [MainThread]: 
20:35:29.215835 [info ] [MainThread]: Finished running 6 table models in 32.06s.
20:35:29.215992 [debug] [MainThread]: Connection 'master' was properly closed.
20:35:29.216069 [debug] [MainThread]: Connection 'model.Shawn.AH_Watches_FT_stg' was properly closed.
20:35:29.216134 [debug] [MainThread]: Connection 'model.Shawn.AH_SubmittedListingPayment_FT_stg' was properly closed.
20:35:29.216197 [debug] [MainThread]: Connection 'model.Shawn.AH_ListingPaymentCharge_FT_stg' was properly closed.
20:35:29.216258 [debug] [MainThread]: Connection 'model.Shawn.AH_ListingActions_FT_stg' was properly closed.
20:35:29.329690 [info ] [MainThread]: 
20:35:29.330042 [info ] [MainThread]: [32mCompleted successfully[0m
20:35:29.330292 [info ] [MainThread]: 
20:35:29.330437 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
20:35:29.330761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fed90760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fed90c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fcb3d2e0>]}


============================== 2022-09-26 20:35:31.796514 | 98f93278-debc-4660-ab78-341b8fd0b831 ==============================
20:35:31.796514 [info ] [MainThread]: Running with dbt=1.0.0
20:35:31.797677 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step6_FT_2_tmp'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
20:35:31.798040 [debug] [MainThread]: Tracking: tracking
20:35:31.802761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d8bd9dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d8bd9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d8bd9f10>]}
20:35:32.025105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:35:32.025445 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:35:32.052154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98f93278-debc-4660-ab78-341b8fd0b831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d8b5f370>]}
20:35:32.104115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98f93278-debc-4660-ab78-341b8fd0b831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8dab9e940>]}
20:35:32.104684 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:35:32.113800 [info ] [MainThread]: 
20:35:32.114497 [debug] [MainThread]: Acquiring new synapse connection "master"
20:35:32.115932 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
20:35:32.125714 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
20:35:32.125991 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
20:35:32.126086 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:35:32.126210 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:35:32.436324 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:35:32.471061 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.34 seconds
20:35:32.472825 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
20:35:32.495417 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
20:35:32.501868 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
20:35:32.502133 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
20:35:32.502226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:35:32.502340 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:35:32.502975 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
20:35:32.504757 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
20:35:32.504922 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
20:35:32.505004 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:35:32.505104 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:35:32.606312 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:35:32.626787 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:35:32.669927 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.16 seconds
20:35:32.689151 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:35:32.831323 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
20:35:32.843827 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
20:35:32.861777 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
20:35:32.862151 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
20:35:55.311215 [debug] [MainThread]: On master: COMMIT
20:35:55.311785 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
20:35:55.312030 [info ] [MainThread]: 
20:35:55.315666 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Invoices_FT_tmp
20:35:55.315986 [info ] [Thread-1  ]: 1 of 6 START table model stg.AH_Invoices_FT_tmp................................. [RUN]
20:35:55.316430 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Invoices_FT_tmp"
20:35:55.316553 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Invoices_FT_tmp
20:35:55.316660 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Invoices_FT_tmp
20:35:55.319426 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Invoices_FT_tmp"
20:35:55.319593 [debug] [Thread-2  ]: Began running node model.Shawn.AH_LineItems_FT_tmp
20:35:55.320000 [info ] [Thread-2  ]: 2 of 6 START table model stg.AH_LineItems_FT_tmp................................ [RUN]
20:35:55.320461 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_LineItems_FT_tmp"
20:35:55.320584 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_LineItems_FT_tmp
20:35:55.320675 [debug] [Thread-2  ]: Compiling model.Shawn.AH_LineItems_FT_tmp
20:35:55.319758 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingPaymentCharge_FT_tmp
20:35:55.323307 [info ] [Thread-4  ]: 4 of 6 START table model stg.AH_ListingPaymentCharge_FT_tmp..................... [RUN]
20:35:55.323664 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_tmp"
20:35:55.323769 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingPaymentCharge_FT_tmp
20:35:55.323852 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingPaymentCharge_FT_tmp
20:35:55.325913 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingPaymentCharge_FT_tmp"
20:35:55.326252 [debug] [Thread-4  ]: finished collecting timing info
20:35:55.326373 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingPaymentCharge_FT_tmp
20:35:55.319680 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingActions_FT_tmp
20:35:55.331792 [info ] [Thread-3  ]: 3 of 6 START table model stg.AH_ListingActions_FT_tmp........................... [RUN]
20:35:55.332173 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingActions_FT_tmp"
20:35:55.332280 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingActions_FT_tmp
20:35:55.332364 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingActions_FT_tmp
20:35:55.323060 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_LineItems_FT_tmp"
20:35:55.335420 [debug] [Thread-2  ]: finished collecting timing info
20:35:55.335521 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_LineItems_FT_tmp
20:35:55.335221 [debug] [Thread-1  ]: finished collecting timing info
20:35:55.343766 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Invoices_FT_tmp
20:35:55.334959 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingActions_FT_tmp"
20:35:55.375171 [debug] [Thread-3  ]: finished collecting timing info
20:35:55.375377 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingActions_FT_tmp
20:35:55.582482 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_LineItems_FT_tmp"
20:35:55.625153 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_tmp".
20:35:55.625322 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_tmp: 
  
  if object_id ('"stg"."AH_LineItems_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LineItems_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_LineItems_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_LineItems_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_LineItems_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		li.[LineItemsID],
		c.[Consignor_Skey],
		b.[Buyer_Skey],
		li.[OwnerID],
		li.[PayerID],
		li.[InvoiceID],
		li.[ListingID],
		li.[Description],
		li.[LastUpdatedUser],
		li.[Currency],
		li.[Status],
		li.[Type],
		li.[TotalAmount],
		li.[QTY],
		li.[PerUnitAmount],
		li.[IsTaxable],
		li.[IsArchived],
		li.[Relistiteration],
		li.[HasBuyerPremiumApplies],
		li.[IsPayerArchived],
		li.[DateStamp],
		li.[CreatedDate],
		li.[UpdatedDate],
		li.[DeletedDate]
FROM
	[stg].[AH_LineItems_FT_stg] li
left join [dbo].[AH_Buyers_DM] b on li.PayerID=b.UserID
left join [dbo].[AH_Consignors_DM] c on li.OwnerID=c.UserID
    ');

  CREATE TABLE "stg"."AH_LineItems_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_LineItems_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_LineItems_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LineItems_FT_tmp__dbt_tmp_temp_view"
    end



20:35:55.625415 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:35:55.625521 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:35:55.624604 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Invoices_FT_tmp"
20:35:55.640249 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_tmp".
20:35:55.640385 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_tmp: 
  
  if object_id ('"stg"."AH_Invoices_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Invoices_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_Invoices_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_Invoices_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_Invoices_FT_tmp__dbt_tmp_temp_view as
    
SELECT
	i.[InvoiceID],
	
    c.[Consignor_Skey],
    b.[Buyer_Skey],
	
    i.[PayerID],
    i.[OwnerID],
	
    i.[CreatedDate],
    i.[UpdatedDate],
    i.[DeletedDate],
    i.[Status],
    i.[CreatedDTTM],
    i.[FulfilledDTTM],
    i.[Comment],
    i.[LastUpdatedUser],
    i.[Currency],
    i.[Type],
    i.[ShippingAmount],
    i.[Subtotal],
    i.[Total],
	
    i.[ShippingFirstName],
    i.[ShippingLastName],
    i.[ShippingStreet1],
    i.[ShippingStreet2],
    i.[ShippingCity],
    i.[ShippingState],
    i.[ShippingPostalCode],
    i.[ShippingCountry],
	
    i.[BillingFIrstName],
    i.[BillingLastName],
    i.[BillingStreet1],
    i.[BillingStreet2],
    i.[BillingCity],
    i.[BillingState],
    i.[BillingPostalCode],
    i.[BillingCountry],
	
    i.[SalesTax],
    
    i.[PaidDTTM],
    i.[IsPayerLocked],
    i.[HasShipped],
    i.[ShippingDetails],
    i.[BuyerPremiumPct],
    i.[BuyerPremiumAmount],
    i.[IsArchived]
FROM
	[stg].[AH_Invoices_FT_stg] i
left join [dbo].[AH_Buyers_DM] b on i.PayerID=b.UserID
left join [dbo].[AH_Consignors_DM] c on i.OwnerID=c.UserID
    ');

  CREATE TABLE "stg"."AH_Invoices_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Invoices_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Invoices_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Invoices_FT_tmp__dbt_tmp_temp_view"
    end



20:35:55.640465 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:35:55.640567 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:35:55.639808 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingPaymentCharge_FT_tmp"
20:35:55.644940 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_tmp".
20:35:55.645058 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: 
  
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		lpc.[ListingPaymentChargeID],
		b.[Buyer_Skey],
		lpc.[BuyerId],
		lpc.[ListingID],
		lpc.[ChargeAmount],
		lpc.[TotalBid],
		lpc.[BidHoldPercentage],
		lpc.[MaximumBidCharge],
		lpc.[TransactionID],
		lpc.[CreatedDate],
		lpc.[UpdatedDate]
FROM 	[stg].[AH_ListingPaymentCharge_FT_stg] lpc
left join [dbo].[AH_Buyers_DM] b on lpc.BuyerId=b.UserID
    ');

  CREATE TABLE "stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view"
    end



20:35:55.645145 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:35:55.645242 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:35:55.644582 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingActions_FT_tmp"
20:35:55.646363 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_tmp".
20:35:55.646491 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_tmp: 
  
  if object_id ('"stg"."AH_ListingActions_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActions_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_ListingActions_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingActions_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		la.[ListingActionID],
		b.[Buyer_Skey],
		la.[UserID],
		la.[ListingID],
		la.[ActionDTTM],
		la.[Description],
		la.[LastUpdatedUser],
		la.[Amount],
		la.[ProxyAmount],
		la.[QTY],
		la.[Reason],
		la.[Status],
		la.[HasUserEntered],
		la.[CreatedDate],
		la.[UpdatedDate],
		la.[DeletedDate]
FROM	[stg].[AH_ListingActions_FT_stg] la
left join [dbo].[AH_Buyers_DM] b on la.UserID=b.UserID
    ');

  CREATE TABLE "stg"."AH_ListingActions_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingActions_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingActions_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActions_FT_tmp__dbt_tmp_temp_view"
    end



20:35:55.646607 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:35:55.646701 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:35:55.746340 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:35:55.750855 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:35:55.751269 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:35:55.761532 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:36:01.886510 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 6.24 seconds
20:36:01.977799 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_tmp".
20:36:01.978053 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: rename object "stg"."AH_ListingPaymentCharge_FT_tmp" to AH_ListingPaymentCharge_FT_tmp__dbt_backup
20:36:02.102673 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:36:02.117771 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_tmp".
20:36:02.118050 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: rename object "stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp" to AH_ListingPaymentCharge_FT_tmp
20:36:02.150905 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:36:02.162057 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: COMMIT
20:36:02.169199 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_tmp".
20:36:02.169456 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_FT_tmp__dbt_backup"
    end

20:36:02.452118 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
20:36:02.468293 [debug] [Thread-4  ]: finished collecting timing info
20:36:02.468604 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: Close
20:36:02.469341 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f93278-debc-4660-ab78-341b8fd0b831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d66ca940>]}
20:36:02.471616 [info ] [Thread-4  ]: 4 of 6 OK created table model stg.AH_ListingPaymentCharge_FT_tmp................ [[32mOK[0m in 7.15s]
20:36:02.471990 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingPaymentCharge_FT_tmp
20:36:02.472702 [debug] [Thread-4  ]: Began running node model.Shawn.AH_SubmittedListingPayment_FT_tmp
20:36:02.473071 [info ] [Thread-4  ]: 5 of 6 START table model stg.AH_SubmittedListingPayment_FT_tmp.................. [RUN]
20:36:02.473692 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_tmp"
20:36:02.473811 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_SubmittedListingPayment_FT_tmp
20:36:02.474657 [debug] [Thread-4  ]: Compiling model.Shawn.AH_SubmittedListingPayment_FT_tmp
20:36:02.477559 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_SubmittedListingPayment_FT_tmp"
20:36:02.477893 [debug] [Thread-4  ]: finished collecting timing info
20:36:02.478013 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_SubmittedListingPayment_FT_tmp
20:36:02.535583 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.89 seconds
20:36:02.551062 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_SubmittedListingPayment_FT_tmp"
20:36:02.559085 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_tmp".
20:36:02.559228 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: 
  
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		slp.[SubmittedListingPaymentID],
		c.[Consignor_Skey],
		slp.[UserID],
		slp.[ListingID],
		slp.[Amount],
		slp.[HasProPhotography],
		slp.[HasProMarketing],
		slp.[TransactionID],
		slp.[CreatedDate],
		slp.[UpdatedDate]
FROM
	[stg].[AH_SubmittedListingPayment_FT_stg] slp
left join [dbo].[AH_Consignors_DM] c on slp.UserID=c.UserID
    ');

  CREATE TABLE "stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view"
    end



20:36:02.559312 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
20:36:02.559424 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:36:02.558573 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_tmp".
20:36:02.560642 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_tmp: rename object "stg"."AH_ListingActions_FT_tmp" to AH_ListingActions_FT_tmp__dbt_backup
20:36:02.607316 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:36:02.624670 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_tmp".
20:36:02.624926 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_tmp: rename object "stg"."AH_ListingActions_FT_tmp__dbt_tmp" to AH_ListingActions_FT_tmp
20:36:02.658720 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:36:02.660585 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT_tmp: COMMIT
20:36:02.664911 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_tmp".
20:36:02.665087 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_tmp: 
    
  if object_id ('"stg"."AH_ListingActions_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_FT_tmp__dbt_backup"
    end

20:36:02.665424 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:36:02.866925 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:36:02.879677 [debug] [Thread-3  ]: finished collecting timing info
20:36:02.879992 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT_tmp: Close
20:36:02.880728 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f93278-debc-4660-ab78-341b8fd0b831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d66bba30>]}
20:36:02.881150 [info ] [Thread-3  ]: 3 of 6 OK created table model stg.AH_ListingActions_FT_tmp...................... [[32mOK[0m in 7.55s]
20:36:02.881452 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingActions_FT_tmp
20:36:02.881605 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Watches_FT_tmp
20:36:02.881888 [info ] [Thread-3  ]: 6 of 6 START table model stg.AH_Watches_FT_tmp.................................. [RUN]
20:36:02.882254 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Watches_FT_tmp"
20:36:02.882363 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Watches_FT_tmp
20:36:02.882460 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Watches_FT_tmp
20:36:02.884986 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Watches_FT_tmp"
20:36:02.885305 [debug] [Thread-3  ]: finished collecting timing info
20:36:02.885414 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Watches_FT_tmp
20:36:02.949281 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Watches_FT_tmp"
20:36:02.949817 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_tmp".
20:36:02.949956 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_tmp: 
  
  if object_id ('"stg"."AH_Watches_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Watches_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_Watches_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_Watches_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_Watches_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		w.[WatchID],
		b.[Buyer_Skey],
		w.[UserID],
		w.[ListingID],
		w.[LastUpdatedUser],
		w.[CreatedDate],
		w.[UpdatedDate],
		w.[DeletedDate]
FROM [stg].[AH_Watches_FT_stg] w
left join [dbo].[AH_Buyers_DM] b on w.UserID=b.UserID
    ');

  CREATE TABLE "stg"."AH_Watches_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Watches_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Watches_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Watches_FT_tmp__dbt_tmp_temp_view"
    end



20:36:02.950048 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:36:02.950155 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:36:03.066730 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:36:03.345006 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 7.70 seconds
20:36:03.360018 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_tmp".
20:36:03.360277 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_tmp: rename object "stg"."AH_Invoices_FT_tmp" to AH_Invoices_FT_tmp__dbt_backup
20:36:03.398374 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:36:03.412072 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_tmp".
20:36:03.412327 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_tmp: rename object "stg"."AH_Invoices_FT_tmp__dbt_tmp" to AH_Invoices_FT_tmp
20:36:03.448564 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:36:03.450443 [debug] [Thread-1  ]: On model.Shawn.AH_Invoices_FT_tmp: COMMIT
20:36:03.454433 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_tmp".
20:36:03.454628 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_tmp: 
    
  if object_id ('"stg"."AH_Invoices_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_Invoices_FT_tmp__dbt_backup"
    end

20:36:03.583658 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.96 seconds
20:36:03.599944 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_tmp".
20:36:03.600213 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_tmp: rename object "stg"."AH_LineItems_FT_tmp" to AH_LineItems_FT_tmp__dbt_backup
20:36:03.657688 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:36:03.667785 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:36:03.672971 [debug] [Thread-1  ]: finished collecting timing info
20:36:03.683859 [debug] [Thread-1  ]: On model.Shawn.AH_Invoices_FT_tmp: Close
20:36:03.684696 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f93278-debc-4660-ab78-341b8fd0b831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d66ca430>]}
20:36:03.685118 [info ] [Thread-1  ]: 1 of 6 OK created table model stg.AH_Invoices_FT_tmp............................ [[32mOK[0m in 8.37s]
20:36:03.685423 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Invoices_FT_tmp
20:36:03.687060 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_tmp".
20:36:03.687196 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_tmp: rename object "stg"."AH_LineItems_FT_tmp__dbt_tmp" to AH_LineItems_FT_tmp
20:36:03.764183 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:36:03.766037 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT_tmp: COMMIT
20:36:03.769986 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_tmp".
20:36:03.770145 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_tmp: 
    
  if object_id ('"stg"."AH_LineItems_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_LineItems_FT_tmp__dbt_backup"
    end

20:36:04.120369 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
20:36:04.133745 [debug] [Thread-2  ]: finished collecting timing info
20:36:04.134054 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT_tmp: Close
20:36:04.134795 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f93278-debc-4660-ab78-341b8fd0b831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d66bb5b0>]}
20:36:04.135222 [info ] [Thread-2  ]: 2 of 6 OK created table model stg.AH_LineItems_FT_tmp........................... [[32mOK[0m in 8.81s]
20:36:04.135526 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_LineItems_FT_tmp
20:36:05.896009 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.34 seconds
20:36:05.911676 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_tmp".
20:36:05.911949 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: rename object "stg"."AH_SubmittedListingPayment_FT_tmp" to AH_SubmittedListingPayment_FT_tmp__dbt_backup
20:36:05.944095 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:36:05.959479 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_tmp".
20:36:05.959750 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: rename object "stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp" to AH_SubmittedListingPayment_FT_tmp
20:36:05.988947 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:36:05.990861 [debug] [Thread-4  ]: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: COMMIT
20:36:05.995189 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_tmp".
20:36:05.995360 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_FT_tmp__dbt_backup"
    end

20:36:06.190033 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:36:06.204040 [debug] [Thread-4  ]: finished collecting timing info
20:36:06.204357 [debug] [Thread-4  ]: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: Close
20:36:06.205083 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f93278-debc-4660-ab78-341b8fd0b831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d664df70>]}
20:36:06.205503 [info ] [Thread-4  ]: 5 of 6 OK created table model stg.AH_SubmittedListingPayment_FT_tmp............. [[32mOK[0m in 3.73s]
20:36:06.205804 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_SubmittedListingPayment_FT_tmp
20:36:11.097583 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 8.15 seconds
20:36:11.113670 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_tmp".
20:36:11.113935 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_tmp: rename object "stg"."AH_Watches_FT_tmp" to AH_Watches_FT_tmp__dbt_backup
20:36:11.153895 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:36:11.247839 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_tmp".
20:36:11.248110 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_tmp: rename object "stg"."AH_Watches_FT_tmp__dbt_tmp" to AH_Watches_FT_tmp
20:36:11.279388 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:36:11.281181 [debug] [Thread-3  ]: On model.Shawn.AH_Watches_FT_tmp: COMMIT
20:36:11.285293 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_tmp".
20:36:11.285489 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_tmp: 
    
  if object_id ('"stg"."AH_Watches_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_Watches_FT_tmp__dbt_backup"
    end

20:36:11.511593 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:36:11.524405 [debug] [Thread-3  ]: finished collecting timing info
20:36:11.524734 [debug] [Thread-3  ]: On model.Shawn.AH_Watches_FT_tmp: Close
20:36:11.525505 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f93278-debc-4660-ab78-341b8fd0b831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d83bbfa0>]}
20:36:11.525932 [info ] [Thread-3  ]: 6 of 6 OK created table model stg.AH_Watches_FT_tmp............................. [[32mOK[0m in 8.64s]
20:36:11.526256 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Watches_FT_tmp
20:36:11.527867 [debug] [MainThread]: Acquiring new synapse connection "master"
20:36:11.528132 [debug] [MainThread]: On master: COMMIT
20:36:11.528432 [info ] [MainThread]: 
20:36:11.528630 [info ] [MainThread]: Finished running 6 table models in 39.41s.
20:36:11.528784 [debug] [MainThread]: Connection 'master' was properly closed.
20:36:11.528859 [debug] [MainThread]: Connection 'model.Shawn.AH_LineItems_FT_tmp' was properly closed.
20:36:11.528921 [debug] [MainThread]: Connection 'model.Shawn.AH_Invoices_FT_tmp' was properly closed.
20:36:11.528980 [debug] [MainThread]: Connection 'model.Shawn.AH_SubmittedListingPayment_FT_tmp' was properly closed.
20:36:11.529039 [debug] [MainThread]: Connection 'model.Shawn.AH_Watches_FT_tmp' was properly closed.
20:36:11.558578 [info ] [MainThread]: 
20:36:11.558956 [info ] [MainThread]: [32mCompleted successfully[0m
20:36:11.559203 [info ] [MainThread]: 
20:36:11.559338 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
20:36:11.559613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8dab9ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d844b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d66b7f70>]}


============================== 2022-09-26 20:36:13.935092 | e013f95f-323e-49b2-8a1c-2b726395f159 ==============================
20:36:13.935092 [info ] [MainThread]: Running with dbt=1.0.0
20:36:13.935634 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step6_FT_3'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
20:36:13.935819 [debug] [MainThread]: Tracking: tracking
20:36:13.936116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c2630e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c2630eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c2630f10>]}
20:36:14.143660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:36:14.143993 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:36:14.171501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e013f95f-323e-49b2-8a1c-2b726395f159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c25b42b0>]}
20:36:14.223569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e013f95f-323e-49b2-8a1c-2b726395f159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c45f3880>]}
20:36:14.224116 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:36:14.232781 [info ] [MainThread]: 
20:36:14.233460 [debug] [MainThread]: Acquiring new synapse connection "master"
20:36:14.234849 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
20:36:14.244212 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
20:36:14.244456 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
20:36:14.244553 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:36:14.244673 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:36:14.564241 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:36:14.596679 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.35 seconds
20:36:14.598473 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
20:36:14.620823 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
20:36:14.627132 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
20:36:14.627618 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
20:36:14.629403 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
20:36:14.629570 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
20:36:14.629655 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:36:14.629755 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:36:14.627866 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
20:36:14.631065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:36:14.631219 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:36:14.754247 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:36:14.754784 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:36:14.822257 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:36:14.827244 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:36:14.959154 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
20:36:14.959478 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
20:36:15.022765 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
20:36:15.023092 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
20:36:37.510621 [debug] [MainThread]: On master: COMMIT
20:36:37.511212 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
20:36:37.511464 [info ] [MainThread]: 
20:36:37.515190 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Invoice_FT
20:36:37.515577 [info ] [Thread-1  ]: 1 of 6 START table model dbo.AH_Invoice_FT...................................... [RUN]
20:36:37.516058 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Invoice_FT"
20:36:37.516182 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Invoice_FT
20:36:37.516295 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Invoice_FT
20:36:37.519552 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Invoice_FT"
20:36:37.519746 [debug] [Thread-2  ]: Began running node model.Shawn.AH_LineItems_FT
20:36:37.520181 [info ] [Thread-2  ]: 2 of 6 START table model dbo.AH_LineItems_FT.................................... [RUN]
20:36:37.520728 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_LineItems_FT"
20:36:37.520851 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_LineItems_FT
20:36:37.520947 [debug] [Thread-2  ]: Compiling model.Shawn.AH_LineItems_FT
20:36:37.519916 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingPaymentCharge_FT
20:36:37.524028 [info ] [Thread-4  ]: 4 of 6 START table model dbo.AH_ListingPaymentCharge_FT......................... [RUN]
20:36:37.524453 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingPaymentCharge_FT"
20:36:37.524561 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingPaymentCharge_FT
20:36:37.524650 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingPaymentCharge_FT
20:36:37.519838 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingActions_FT
20:36:37.527617 [info ] [Thread-3  ]: 3 of 6 START table model dbo.AH_ListingActions_FT............................... [RUN]
20:36:37.528020 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingActions_FT"
20:36:37.528125 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingActions_FT
20:36:37.528214 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingActions_FT
20:36:37.523739 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_LineItems_FT"
20:36:37.532016 [debug] [Thread-2  ]: finished collecting timing info
20:36:37.532137 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_LineItems_FT
20:36:37.531787 [debug] [Thread-1  ]: finished collecting timing info
20:36:37.539767 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Invoice_FT
20:36:37.527352 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingPaymentCharge_FT"
20:36:37.558166 [debug] [Thread-4  ]: finished collecting timing info
20:36:37.558384 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingPaymentCharge_FT
20:36:37.531423 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingActions_FT"
20:36:37.622137 [debug] [Thread-3  ]: finished collecting timing info
20:36:37.622406 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingActions_FT
20:36:37.680781 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_LineItems_FT"
20:36:37.714320 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT".
20:36:37.694936 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Invoice_FT"
20:36:37.719632 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoice_FT".
20:36:37.719773 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoice_FT: 
  
  if object_id ('"dbo"."AH_Invoice_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Invoice_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Invoice_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Invoice_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_Invoice_FT__dbt_tmp_temp_view as
    

with updateData as (
    select 
        FTstg.[InvoiceID],
		FTtmp.[Consignor_Skey],
		FTtmp.[Buyer_Skey],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate],
		FTstg.[DeletedDate],
		FTstg.[Status],
		FTstg.[CreatedDTTM],
		FTstg.[FulfilledDTTM],
		FTstg.[Comment],
		FTstg.[LastUpdatedUser],
		FTstg.[Currency],
		FTstg.[Type],
		FTstg.[ShippingAmount],
		FTstg.[Subtotal],
		FTstg.[Total],
		FTstg.[ShippingFirstName],
		FTstg.[ShippingLastName],
		FTstg.[ShippingStreet1],
		FTstg.[ShippingStreet2],
		FTstg.[ShippingCity],
		FTstg.[ShippingState],
		FTstg.[ShippingPostalCode],
		FTstg.[ShippingCountry],
		FTstg.[BillingFIrstName],
		FTstg.[BillingLastName],
		FTstg.[BillingStreet1],
		FTstg.[BillingStreet2],
		FTstg.[BillingCity],
		FTstg.[BillingState],
		FTstg.[BillingPostalCode],
		FTstg.[BillingCountry],
		FTstg.[SalesTax],
		FTstg.[PaidDTTM],
		FTstg.[IsPayerLocked],
		FTstg.[HasShipped],
		FTstg.[ShippingDetails],
		FTstg.[BuyerPremiumPct],
		FTstg.[BuyerPremiumAmount],
		FTstg.[IsArchived]
    from stg.AH_Invoices_FT_tmp as FTtmp 
    join stg.AH_Invoices_FT_stg as FTstg 
    on FTstg.InvoiceID=FTtmp.InvoiceID
),
insertData as (
    select 
        [InvoiceID],
        [Consignor_Skey],
        [Buyer_Skey],
        [CreatedDate],
        [UpdatedDate],
        [DeletedDate],
        [Status],
        [CreatedDTTM],
        [FulfilledDTTM],
        [Comment],
        [LastUpdatedUser],
        [Currency],
        [Type],
        [ShippingAmount],
        [Subtotal],
        [Total],
        [ShippingFirstName],
        [ShippingLastName],
        [ShippingStreet1],
        [ShippingStreet2],
        [ShippingCity],
        [ShippingState],
        [ShippingPostalCode],
        [ShippingCountry],
        [BillingFIrstName],
        [BillingLastName],
        [BillingStreet1],
        [BillingStreet2],
        [BillingCity],
        [BillingState],
        [BillingPostalCode],
        [BillingCountry],
        [SalesTax],
        [PaidDTTM],
        [IsPayerLocked],
        [HasShipped],
        [ShippingDetails],
        [BuyerPremiumPct],
        [BuyerPremiumAmount],
        [IsArchived]
    from stg.AH_Invoices_FT_tmp
    where InvoiceID not in (select  InvoiceID from stg.AH_Invoices_FT_stg)
)
SELECT
	[InvoiceID],
	[Consignor_Skey],
	[Buyer_Skey],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate],
	[Status],
	[CreatedDTTM],
	[FulfilledDTTM],
	[Comment],
	[LastUpdatedUser],
	[Currency],
	[Type],
	[ShippingAmount],
	[Subtotal],
	[Total],
	[ShippingFirstName],
	[ShippingLastName],
	[ShippingStreet1],
	[ShippingStreet2],
	[ShippingCity],
	[ShippingState],
	[ShippingPostalCode],
	[ShippingCountry],
	[BillingFIrstName],
	[BillingLastName],
	[BillingStreet1],
	[BillingStreet2],
	[BillingCity],
	[BillingState],
	[BillingPostalCode],
	[BillingCountry],
	[SalesTax],
	[PaidDTTM],
	[IsPayerLocked],
	[HasShipped],
	[ShippingDetails],
	[BuyerPremiumPct],
	[BuyerPremiumAmount],
	[IsArchived]
from updateData

union all

SELECT
	[InvoiceID],
	[Consignor_Skey],
	[Buyer_Skey],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate],
	[Status],
	[CreatedDTTM],
	[FulfilledDTTM],
	[Comment],
	[LastUpdatedUser],
	[Currency],
	[Type],
	[ShippingAmount],
	[Subtotal],
	[Total],
	[ShippingFirstName],
	[ShippingLastName],
	[ShippingStreet1],
	[ShippingStreet2],
	[ShippingCity],
	[ShippingState],
	[ShippingPostalCode],
	[ShippingCountry],
	[BillingFIrstName],
	[BillingLastName],
	[BillingStreet1],
	[BillingStreet2],
	[BillingCity],
	[BillingState],
	[BillingPostalCode],
	[BillingCountry],
	[SalesTax],
	[PaidDTTM],
	[IsPayerLocked],
	[HasShipped],
	[ShippingDetails],
	[BuyerPremiumPct],
	[BuyerPremiumAmount],
	[IsArchived]
from insertData
    ');

  CREATE TABLE "dbo"."AH_Invoice_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Invoice_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Invoice_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Invoice_FT__dbt_tmp_temp_view"
    end



20:36:37.719867 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:36:37.719978 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:36:37.714598 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT: 
  
  if object_id ('"dbo"."AH_LineItems_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_LineItems_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_LineItems_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_LineItems_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_LineItems_FT__dbt_tmp_temp_view as
    

with updateData as (
    select 
     	FTstg.[LineItemsID],
		FTtmp.[Consignor_Skey],
		FTtmp.[Buyer_Skey],
		FTstg.[InvoiceID],
		FTstg.[ListingID],
		FTstg.[Description],
		FTstg.[LastUpdatedUser],
		FTstg.[Currency],
		FTstg.[Status],
		FTstg.[Type],
		FTstg.[TotalAmount],
		FTstg.[QTY],
		FTstg.[PerUnitAmount],
		FTstg.[IsTaxable],
		FTstg.[IsArchived],
		FTstg.[Relistiteration],
		FTstg.[HasBuyerPremiumApplies],
		FTstg.[IsPayerArchived],
		FTstg.[DateStamp],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate],
		FTstg.[DeletedDate]
    from stg.AH_LineItems_FT_tmp as FTtmp 
    join stg.AH_LineItems_FT_stg as FTstg 
    on FTstg.LineItemsID=FTtmp.LineItemsID
),
insertData as (
    select 
        [LineItemsID],
        [Consignor_Skey],
        [Buyer_Skey],
        [InvoiceID],
        [ListingID],
        [Description],
        [LastUpdatedUser],
        [Currency],
        [Status],
        [Type],
        [TotalAmount],
        [QTY],
        [PerUnitAmount],
        [IsTaxable],
        [IsArchived],
        [Relistiteration],
        [HasBuyerPremiumApplies],
        [IsPayerArchived],
        [DateStamp],
        [CreatedDate],
        [UpdatedDate],
        [DeletedDate]
    from stg.AH_LineItems_FT_tmp
    where LineItemsID not in (select  LineItemsID from stg.AH_LineItems_FT_stg)
)
SELECT
	[LineItemsID],
	[Consignor_Skey],
	[Buyer_Skey],
	[InvoiceID],
	[ListingID],
	[Description],
	[LastUpdatedUser],
	[Currency],
	[Status],
	[Type],
	[TotalAmount],
	[QTY],
	[PerUnitAmount],
	[IsTaxable],
	[IsArchived],
	[Relistiteration],
	[HasBuyerPremiumApplies],
	[IsPayerArchived],
	[DateStamp],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from updateData

union all

SELECT
	[LineItemsID],
	[Consignor_Skey],
	[Buyer_Skey],
	[InvoiceID],
	[ListingID],
	[Description],
	[LastUpdatedUser],
	[Currency],
	[Status],
	[Type],
	[TotalAmount],
	[QTY],
	[PerUnitAmount],
	[IsTaxable],
	[IsArchived],
	[Relistiteration],
	[HasBuyerPremiumApplies],
	[IsPayerArchived],
	[DateStamp],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from insertData
    ');

  CREATE TABLE "dbo"."AH_LineItems_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_LineItems_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_LineItems_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_LineItems_FT__dbt_tmp_temp_view"
    end



20:36:37.721294 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:36:37.721478 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:36:37.719131 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingPaymentCharge_FT"
20:36:37.729575 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT".
20:36:37.729715 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT: 
  
  if object_id ('"dbo"."AH_ListingPaymentCharge_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingPaymentCharge_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingPaymentCharge_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingPaymentCharge_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingPaymentCharge_FT__dbt_tmp_temp_view as
    
with updateData as (
    select 
		FTstg.[ListingPaymentChargeID],
		FTtmp.[Buyer_Skey],
		FTstg.[ListingID],
		FTstg.[ChargeAmount],
		FTstg.[TotalBid],
		FTstg.[BidHoldPercentage],
		FTstg.[MaximumBidCharge],
		FTstg.[TransactionID],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate]
    from stg.AH_ListingPaymentCharge_FT_tmp as FTtmp 
    join stg.AH_ListingPaymentCharge_FT_stg as FTstg 
    on FTstg.ListingPaymentChargeID=FTtmp.ListingPaymentChargeID
)
,
insertData as (
    select 
        [ListingPaymentChargeID],
        [Buyer_Skey],
        [ListingID],
        [ChargeAmount],
        [TotalBid],
        [BidHoldPercentage],
        [MaximumBidCharge],
        [TransactionID],
        [CreatedDate],
        [UpdatedDate]
    from stg.AH_ListingPaymentCharge_FT_tmp
    where ListingPaymentChargeID not in (select  ListingPaymentChargeID from stg.AH_ListingPaymentCharge_FT_stg)
)
SELECT
	[ListingPaymentChargeID],
	[Buyer_Skey],
	[ListingID],
	[ChargeAmount],
	[TotalBid],
	[BidHoldPercentage],
	[MaximumBidCharge],
	[TransactionID],
	[CreatedDate],
	[UpdatedDate]
from updateData

union all

SELECT
	[ListingPaymentChargeID],
	[Buyer_Skey],
	[ListingID],
	[ChargeAmount],
	[TotalBid],
	[BidHoldPercentage],
	[MaximumBidCharge],
	[TransactionID],
	[CreatedDate],
	[UpdatedDate]
from insertData
    ');

  CREATE TABLE "dbo"."AH_ListingPaymentCharge_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingPaymentCharge_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingPaymentCharge_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingPaymentCharge_FT__dbt_tmp_temp_view"
    end



20:36:37.729806 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:36:37.729911 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:36:37.729087 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingActions_FT"
20:36:37.730951 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT".
20:36:37.731089 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT: 
  
  if object_id ('"dbo"."AH_ListingActions_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingActions_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingActions_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingActions_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingActions_FT__dbt_tmp_temp_view as
    
with updateData as (
    select 
        FTstg.[ListingActionID],
		FTtmp.[Buyer_Skey],
		FTstg.[ListingID],
		FTstg.[ActionDTTM],
		FTstg.[Description],
		FTstg.[LastUpdatedUser],
		FTstg.[Amount],
		FTstg.[ProxyAmount],
		FTstg.[QTY],
		FTstg.[Reason],
		FTstg.[Status],
		FTstg.[HasUserEntered],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate],
		FTstg.[DeletedDate]
    from stg.AH_ListingActions_FT_tmp as FTtmp 
    join stg.AH_ListingActions_FT_stg as FTstg 
    on FTstg.ListingActionID=FTtmp.ListingActionID
)
,
insertData as (
    select 
       	[ListingActionID],
        [Buyer_Skey],
        [ListingID],
        [ActionDTTM],
        [Description],
        [LastUpdatedUser],
        [Amount],
        [ProxyAmount],
        [QTY],
        [Reason],
        [Status],
        [HasUserEntered],
        [CreatedDate],
        [UpdatedDate],
        [DeletedDate]
    from stg.AH_ListingActions_FT_tmp
    where ListingActionID not in (select  ListingActionID from stg.AH_ListingActions_FT_stg)
)
SELECT
	[ListingActionID],
	[Buyer_Skey],
	[ListingID],
	[ActionDTTM],
	[Description],
	[LastUpdatedUser],
	[Amount],
	[ProxyAmount],
	[QTY],
	[Reason],
	[Status],
	[HasUserEntered],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from updateData

union all

SELECT
	[ListingActionID],
	[Buyer_Skey],
	[ListingID],
	[ActionDTTM],
	[Description],
	[LastUpdatedUser],
	[Amount],
	[ProxyAmount],
	[QTY],
	[Reason],
	[Status],
	[HasUserEntered],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from insertData
    ');

  CREATE TABLE "dbo"."AH_ListingActions_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingActions_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingActions_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingActions_FT__dbt_tmp_temp_view"
    end



20:36:37.731181 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:36:37.731280 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:36:37.893824 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:36:37.895951 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:36:37.902241 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:36:37.902889 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:36:44.786908 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 7.07 seconds
20:36:44.882627 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoice_FT".
20:36:44.882884 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoice_FT: rename object "dbo"."AH_Invoice_FT" to AH_Invoice_FT__dbt_backup
20:36:44.954750 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:36:44.970573 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoice_FT".
20:36:44.970855 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoice_FT: rename object "dbo"."AH_Invoice_FT__dbt_tmp" to AH_Invoice_FT
20:36:44.993962 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 7.26 seconds
20:36:45.003946 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:36:45.027609 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT".
20:36:45.031941 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT: rename object "dbo"."AH_ListingPaymentCharge_FT" to AH_ListingPaymentCharge_FT__dbt_backup
20:36:45.031679 [debug] [Thread-1  ]: On model.Shawn.AH_Invoice_FT: COMMIT
20:36:45.039702 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoice_FT".
20:36:45.039934 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoice_FT: 
    
  if object_id ('"dbo"."AH_Invoice_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Invoice_FT__dbt_backup"
    end

20:36:45.060708 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.34 seconds
20:36:45.070910 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:36:45.077369 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT".
20:36:45.087862 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT: rename object "dbo"."AH_LineItems_FT" to AH_LineItems_FT__dbt_backup
20:36:45.089764 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT".
20:36:45.089979 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT: rename object "dbo"."AH_ListingPaymentCharge_FT__dbt_tmp" to AH_ListingPaymentCharge_FT
20:36:45.121616 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:36:45.131780 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 7.40 seconds
20:36:45.132894 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:36:45.134160 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT: COMMIT
20:36:45.138150 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT".
20:36:45.143730 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT: rename object "dbo"."AH_LineItems_FT__dbt_tmp" to AH_LineItems_FT
20:36:45.147494 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT".
20:36:45.147641 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT: 
    
  if object_id ('"dbo"."AH_ListingPaymentCharge_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingPaymentCharge_FT__dbt_backup"
    end

20:36:45.155566 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT".
20:36:45.155890 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT: rename object "dbo"."AH_ListingActions_FT" to AH_ListingActions_FT__dbt_backup
20:36:45.173502 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:36:45.175117 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT: COMMIT
20:36:45.179250 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT".
20:36:45.179411 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT: 
    
  if object_id ('"dbo"."AH_LineItems_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_LineItems_FT__dbt_backup"
    end

20:36:45.193411 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:36:45.208517 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT".
20:36:45.208776 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT: rename object "dbo"."AH_ListingActions_FT__dbt_tmp" to AH_ListingActions_FT
20:36:45.240191 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:36:45.241954 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT: COMMIT
20:36:45.252162 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT".
20:36:45.252471 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT: 
    
  if object_id ('"dbo"."AH_ListingActions_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingActions_FT__dbt_backup"
    end

20:36:45.282057 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:36:45.295830 [debug] [Thread-1  ]: finished collecting timing info
20:36:45.296157 [debug] [Thread-1  ]: On model.Shawn.AH_Invoice_FT: Close
20:36:45.296910 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e013f95f-323e-49b2-8a1c-2b726395f159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c00b03a0>]}
20:36:45.297482 [info ] [Thread-1  ]: 1 of 6 OK created table model dbo.AH_Invoice_FT................................. [[32mOK[0m in 7.78s]
20:36:45.297828 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Invoice_FT
20:36:45.297992 [debug] [Thread-1  ]: Began running node model.Shawn.AH_SubmittedListingPayment_FT
20:36:45.298315 [info ] [Thread-1  ]: 5 of 6 START table model dbo.AH_SubmittedListingPayment_FT...................... [RUN]
20:36:45.298830 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_SubmittedListingPayment_FT"
20:36:45.298959 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_SubmittedListingPayment_FT
20:36:45.299061 [debug] [Thread-1  ]: Compiling model.Shawn.AH_SubmittedListingPayment_FT
20:36:45.302020 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_SubmittedListingPayment_FT"
20:36:45.302358 [debug] [Thread-1  ]: finished collecting timing info
20:36:45.302470 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_SubmittedListingPayment_FT
20:36:45.341313 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_SubmittedListingPayment_FT"
20:36:45.341846 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT".
20:36:45.341989 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT: 
  
  if object_id ('"dbo"."AH_SubmittedListingPayment_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SubmittedListingPayment_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_SubmittedListingPayment_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_SubmittedListingPayment_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_SubmittedListingPayment_FT__dbt_tmp_temp_view as
    
with updateData as (
    select 
		FTstg.[SubmittedListingPaymentID],
		FTtmp.[Consignor_Skey],
		FTstg.[ListingID],
		FTstg.[Amount],
		FTstg.[HasProPhotography],
		FTstg.[HasProMarketing],
		FTstg.[TransactionID],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate]
    from stg.AH_SubmittedListingPayment_FT_tmp as FTtmp 
    join stg.AH_SubmittedListingPayment_FT_stg as FTstg 
    on FTstg.SubmittedListingPaymentID=FTtmp.SubmittedListingPaymentID
)
,
insertData as (
    select 
        [SubmittedListingPaymentID],
        [Consignor_Skey],
        [ListingID],
        [Amount],
        [HasProPhotography],
        [HasProMarketing],
        [TransactionID],
        [CreatedDate],
        [UpdatedDate]
    from stg.AH_SubmittedListingPayment_FT_tmp
    where SubmittedListingPaymentID not in (select  SubmittedListingPaymentID from stg.AH_SubmittedListingPayment_FT_stg)
)
SELECT
	[SubmittedListingPaymentID],
	[Consignor_Skey],
	[ListingID],
	[Amount],
	[HasProPhotography],
	[HasProMarketing],
	[TransactionID],
	[CreatedDate],
	[UpdatedDate]
from updateData

union all

SELECT
	[SubmittedListingPaymentID],
	[Consignor_Skey],
	[ListingID],
	[Amount],
	[HasProPhotography],
	[HasProMarketing],
	[TransactionID],
	[CreatedDate],
	[UpdatedDate]
from insertData
    ');

  CREATE TABLE "dbo"."AH_SubmittedListingPayment_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_SubmittedListingPayment_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_SubmittedListingPayment_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SubmittedListingPayment_FT__dbt_tmp_temp_view"
    end



20:36:45.342083 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:36:45.342190 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:36:45.354375 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:36:45.365141 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:36:45.370449 [debug] [Thread-2  ]: finished collecting timing info
20:36:45.383890 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT: Close
20:36:45.384783 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e013f95f-323e-49b2-8a1c-2b726395f159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c01804f0>]}
20:36:45.385236 [info ] [Thread-2  ]: 2 of 6 OK created table model dbo.AH_LineItems_FT............................... [[32mOK[0m in 7.86s]
20:36:45.385563 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_LineItems_FT
20:36:45.386597 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Watches_FT
20:36:45.386987 [info ] [Thread-2  ]: 6 of 6 START table model dbo.AH_Watches_FT...................................... [RUN]
20:36:45.387437 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Watches_FT"
20:36:45.387547 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Watches_FT
20:36:45.387646 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Watches_FT
20:36:45.390590 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Watches_FT"
20:36:45.392202 [debug] [Thread-4  ]: finished collecting timing info
20:36:45.392447 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT: Close
20:36:45.393014 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e013f95f-323e-49b2-8a1c-2b726395f159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c00f0f70>]}
20:36:45.393362 [info ] [Thread-4  ]: 4 of 6 OK created table model dbo.AH_ListingPaymentCharge_FT.................... [[32mOK[0m in 7.87s]
20:36:45.393645 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingPaymentCharge_FT
20:36:45.394011 [debug] [Thread-2  ]: finished collecting timing info
20:36:45.394129 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Watches_FT
20:36:45.435156 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Watches_FT"
20:36:45.435672 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT".
20:36:45.435808 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT: 
  
  if object_id ('"dbo"."AH_Watches_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Watches_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Watches_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Watches_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_Watches_FT__dbt_tmp_temp_view as
    
with updateData as (
    select 
		FTstg.[WatchID],
		FTtmp.[Buyer_Skey],
		FTstg.[ListingID],
		FTstg.[LastUpdatedUser],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate],
		FTstg.[DeletedDate]
    from stg.AH_Watches_FT_tmp as FTtmp 
    join stg.AH_Watches_FT_stg as FTstg 
    on FTstg.WatchID=FTtmp.WatchID
)
,
insertData as (
    select 
        [WatchID],
        [Buyer_Skey],
        [ListingID],
        [LastUpdatedUser],
        [CreatedDate],
        [UpdatedDate],
        [DeletedDate]
    from stg.AH_Watches_FT_tmp
    where WatchID not in (select  WatchID from stg.AH_Watches_FT_stg)
)
SELECT
	[WatchID],
	[Buyer_Skey],
	[ListingID],
	[LastUpdatedUser],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from updateData

union all

SELECT
	[WatchID],
	[Buyer_Skey],
	[ListingID],
	[LastUpdatedUser],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from insertData
    ');

  CREATE TABLE "dbo"."AH_Watches_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Watches_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Watches_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Watches_FT__dbt_tmp_temp_view"
    end



20:36:45.435895 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:36:45.436003 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:36:45.461913 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:36:45.478063 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:36:45.491456 [debug] [Thread-3  ]: finished collecting timing info
20:36:45.491784 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT: Close
20:36:45.492512 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e013f95f-323e-49b2-8a1c-2b726395f159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c00a19d0>]}
20:36:45.492956 [info ] [Thread-3  ]: 3 of 6 OK created table model dbo.AH_ListingActions_FT.......................... [[32mOK[0m in 7.96s]
20:36:45.493268 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingActions_FT
20:36:45.534750 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:36:50.756552 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.41 seconds
20:36:50.771518 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT".
20:36:50.771780 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT: rename object "dbo"."AH_SubmittedListingPayment_FT" to AH_SubmittedListingPayment_FT__dbt_backup
20:36:50.826867 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
20:36:50.916557 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT".
20:36:50.916832 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT: rename object "dbo"."AH_SubmittedListingPayment_FT__dbt_tmp" to AH_SubmittedListingPayment_FT
20:36:50.946736 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:36:50.948588 [debug] [Thread-1  ]: On model.Shawn.AH_SubmittedListingPayment_FT: COMMIT
20:36:50.953198 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT".
20:36:50.953413 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT: 
    
  if object_id ('"dbo"."AH_SubmittedListingPayment_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_SubmittedListingPayment_FT__dbt_backup"
    end

20:36:51.504703 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.55 seconds
20:36:51.517119 [debug] [Thread-1  ]: finished collecting timing info
20:36:51.517454 [debug] [Thread-1  ]: On model.Shawn.AH_SubmittedListingPayment_FT: Close
20:36:51.518178 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e013f95f-323e-49b2-8a1c-2b726395f159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c0035130>]}
20:36:51.518642 [info ] [Thread-1  ]: 5 of 6 OK created table model dbo.AH_SubmittedListingPayment_FT................. [[32mOK[0m in 6.22s]
20:36:51.518971 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_SubmittedListingPayment_FT
20:36:56.373539 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 10.94 seconds
20:36:56.390449 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT".
20:36:56.390764 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT: rename object "dbo"."AH_Watches_FT" to AH_Watches_FT__dbt_backup
20:36:56.423142 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:36:56.438035 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT".
20:36:56.438308 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT: rename object "dbo"."AH_Watches_FT__dbt_tmp" to AH_Watches_FT
20:36:56.467470 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:36:56.469395 [debug] [Thread-2  ]: On model.Shawn.AH_Watches_FT: COMMIT
20:36:56.474021 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT".
20:36:56.474227 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT: 
    
  if object_id ('"dbo"."AH_Watches_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Watches_FT__dbt_backup"
    end

20:36:57.043455 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.57 seconds
20:36:57.056124 [debug] [Thread-2  ]: finished collecting timing info
20:36:57.056485 [debug] [Thread-2  ]: On model.Shawn.AH_Watches_FT: Close
20:36:57.057309 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e013f95f-323e-49b2-8a1c-2b726395f159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c04751f0>]}
20:36:57.057745 [info ] [Thread-2  ]: 6 of 6 OK created table model dbo.AH_Watches_FT................................. [[32mOK[0m in 11.67s]
20:36:57.058065 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Watches_FT
20:36:57.059678 [debug] [MainThread]: Acquiring new synapse connection "master"
20:36:57.059949 [debug] [MainThread]: On master: COMMIT
20:36:57.060279 [info ] [MainThread]: 
20:36:57.060484 [info ] [MainThread]: Finished running 6 table models in 42.83s.
20:36:57.060642 [debug] [MainThread]: Connection 'master' was properly closed.
20:36:57.060715 [debug] [MainThread]: Connection 'model.Shawn.AH_Watches_FT' was properly closed.
20:36:57.060779 [debug] [MainThread]: Connection 'model.Shawn.AH_SubmittedListingPayment_FT' was properly closed.
20:36:57.060854 [debug] [MainThread]: Connection 'model.Shawn.AH_ListingPaymentCharge_FT' was properly closed.
20:36:57.060916 [debug] [MainThread]: Connection 'model.Shawn.AH_ListingActions_FT' was properly closed.
20:36:57.092042 [info ] [MainThread]: 
20:36:57.092398 [info ] [MainThread]: [32mCompleted successfully[0m
20:36:57.092647 [info ] [MainThread]: 
20:36:57.092786 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
20:36:57.093061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c45f3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c1e97490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c017eeb0>]}


============================== 2022-09-26 20:36:59.482385 | 2d583235-5321-4466-a86c-b5d11736ee94 ==============================
20:36:59.482385 [info ] [MainThread]: Running with dbt=1.0.0
20:36:59.487196 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step7_1'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
20:36:59.487407 [debug] [MainThread]: Tracking: tracking
20:36:59.487732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2e66c6c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2e66c6d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2e66c63d0>]}
20:36:59.693919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:36:59.694228 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:36:59.721014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d583235-5321-4466-a86c-b5d11736ee94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2e664c310>]}
20:36:59.770514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d583235-5321-4466-a86c-b5d11736ee94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2e868b8e0>]}
20:36:59.771084 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:36:59.779388 [info ] [MainThread]: 
20:36:59.780016 [debug] [MainThread]: Acquiring new synapse connection "master"
20:36:59.781130 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
20:36:59.790311 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
20:36:59.790601 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
20:36:59.790708 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:36:59.790829 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:37:00.474766 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:37:00.551769 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.76 seconds
20:37:00.553823 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
20:37:00.577366 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
20:37:00.583547 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
20:37:00.583993 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
20:37:00.585745 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
20:37:00.585902 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
20:37:00.585985 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:37:00.586089 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:37:00.584226 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
20:37:00.587637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:37:00.587787 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:37:00.724282 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:37:00.724591 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:37:00.791014 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:37:00.793851 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:37:00.925025 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
20:37:00.925345 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
20:37:00.987208 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
20:37:00.987532 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
20:37:23.729974 [debug] [MainThread]: On master: COMMIT
20:37:23.730608 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
20:37:23.730875 [info ] [MainThread]: 
20:37:23.734442 [debug] [Thread-1  ]: Began running node model.Shawn.AH_SZ_Properties_FieldIDs
20:37:23.734828 [info ] [Thread-1  ]: 1 of 2 START table model stg.AH_SZ_Properties_FieldIDs.......................... [RUN]
20:37:23.735293 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_SZ_Properties_FieldIDs"
20:37:23.735423 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_SZ_Properties_FieldIDs
20:37:23.735537 [debug] [Thread-1  ]: Compiling model.Shawn.AH_SZ_Properties_FieldIDs
20:37:23.738296 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_SZ_Properties_FieldIDs"
20:37:23.738656 [debug] [Thread-2  ]: Began running node model.Shawn.AH_SZ_Properties_FieldType
20:37:23.738874 [info ] [Thread-2  ]: 2 of 2 START table model stg.AH_SZ_Properties_FieldType......................... [RUN]
20:37:23.739258 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_SZ_Properties_FieldType"
20:37:23.739367 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_SZ_Properties_FieldType
20:37:23.739464 [debug] [Thread-2  ]: Compiling model.Shawn.AH_SZ_Properties_FieldType
20:37:23.741906 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_SZ_Properties_FieldType"
20:37:23.742292 [debug] [Thread-1  ]: finished collecting timing info
20:37:23.742422 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_SZ_Properties_FieldIDs
20:37:23.747839 [debug] [Thread-2  ]: finished collecting timing info
20:37:23.747993 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_SZ_Properties_FieldType
20:37:23.909438 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_SZ_Properties_FieldIDs"
20:37:23.909997 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_FieldIDs".
20:37:23.910150 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_FieldIDs: 
  
  if object_id ('"stg"."AH_SZ_Properties_FieldIDs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SZ_Properties_FieldIDs__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_SZ_Properties_FieldIDs__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_SZ_Properties_FieldIDs__dbt_tmp"
    end


   EXEC('create view stg.AH_SZ_Properties_FieldIDs__dbt_tmp_temp_view as
    

select ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS Sequence,
            cf.name, 
            cf.id, 
            count(*) as cnt
        from stg.AH_Listingproperties_FinalView lp 
            inner join stg.AH_CustomFields_FinalView cf 
            on lp.CustomFieldID = cf.id
        group by cf.Name, cf.id
    ');

  CREATE TABLE "stg"."AH_SZ_Properties_FieldIDs__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SZ_Properties_FieldIDs__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SZ_Properties_FieldIDs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SZ_Properties_FieldIDs__dbt_tmp_temp_view"
    end



20:37:23.910236 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:37:23.910340 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:37:23.912101 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_SZ_Properties_FieldType"
20:37:23.912481 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_FieldType".
20:37:23.912600 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_FieldType: 
  
  if object_id ('"stg"."AH_SZ_Properties_FieldType__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SZ_Properties_FieldType__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_SZ_Properties_FieldType__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_SZ_Properties_FieldType__dbt_tmp"
    end


   EXEC('create view stg.AH_SZ_Properties_FieldType__dbt_tmp_temp_view as
    

select ''BoolNativeValue'' as column_name, ''bit'' as data_type union all
select ''StringNativeValue'' as column_name, ''nvarchar(4000)'' as data_type union all
select ''IntNativeValue'' as column_name, ''int'' as data_type union all
select ''DecimalNativeValue'' as column_name, ''decimal(10,2)'' as data_type union all
select ''DateTimeNativeValue'' as column_name, ''datetime'' as data_type union all
select ''EnumNativeValue'' as column_name, ''nvarchar(200)'' as data_type
    ');

  CREATE TABLE "stg"."AH_SZ_Properties_FieldType__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SZ_Properties_FieldType__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SZ_Properties_FieldType__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SZ_Properties_FieldType__dbt_tmp_temp_view"
    end



20:37:23.912677 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:37:23.912771 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:37:24.023720 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:37:24.037715 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:37:25.410429 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.50 seconds
20:37:25.428312 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_FieldType".
20:37:25.428560 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_FieldType: rename object "stg"."AH_SZ_Properties_FieldType" to AH_SZ_Properties_FieldType__dbt_backup
20:37:25.498296 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:37:25.512891 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_FieldType".
20:37:25.513158 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_FieldType: rename object "stg"."AH_SZ_Properties_FieldType__dbt_tmp" to AH_SZ_Properties_FieldType
20:37:25.545687 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:37:25.556189 [debug] [Thread-2  ]: On model.Shawn.AH_SZ_Properties_FieldType: COMMIT
20:37:25.562852 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_FieldType".
20:37:25.563081 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_FieldType: 
    
  if object_id ('"stg"."AH_SZ_Properties_FieldType__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_SZ_Properties_FieldType__dbt_backup"
    end

20:37:25.759741 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:37:25.772979 [debug] [Thread-2  ]: finished collecting timing info
20:37:25.773286 [debug] [Thread-2  ]: On model.Shawn.AH_SZ_Properties_FieldType: Close
20:37:25.773949 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d583235-5321-4466-a86c-b5d11736ee94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2e41dcf10>]}
20:37:25.774378 [info ] [Thread-2  ]: 2 of 2 OK created table model stg.AH_SZ_Properties_FieldType.................... [[32mOK[0m in 2.03s]
20:37:25.774730 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_SZ_Properties_FieldType
20:37:26.921294 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.01 seconds
20:37:26.936302 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_FieldIDs".
20:37:26.936567 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_FieldIDs: rename object "stg"."AH_SZ_Properties_FieldIDs" to AH_SZ_Properties_FieldIDs__dbt_backup
20:37:26.968432 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:37:26.983099 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_FieldIDs".
20:37:26.983373 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_FieldIDs: rename object "stg"."AH_SZ_Properties_FieldIDs__dbt_tmp" to AH_SZ_Properties_FieldIDs
20:37:27.011322 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:37:27.013021 [debug] [Thread-1  ]: On model.Shawn.AH_SZ_Properties_FieldIDs: COMMIT
20:37:27.017087 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_FieldIDs".
20:37:27.017271 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_FieldIDs: 
    
  if object_id ('"stg"."AH_SZ_Properties_FieldIDs__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_SZ_Properties_FieldIDs__dbt_backup"
    end

20:37:27.358022 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
20:37:27.370419 [debug] [Thread-1  ]: finished collecting timing info
20:37:27.370749 [debug] [Thread-1  ]: On model.Shawn.AH_SZ_Properties_FieldIDs: Close
20:37:27.371456 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d583235-5321-4466-a86c-b5d11736ee94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2e41be1c0>]}
20:37:27.371878 [info ] [Thread-1  ]: 1 of 2 OK created table model stg.AH_SZ_Properties_FieldIDs..................... [[32mOK[0m in 3.64s]
20:37:27.372182 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_SZ_Properties_FieldIDs
20:37:27.373507 [debug] [MainThread]: Acquiring new synapse connection "master"
20:37:27.373756 [debug] [MainThread]: On master: COMMIT
20:37:27.374023 [info ] [MainThread]: 
20:37:27.374218 [info ] [MainThread]: Finished running 2 table models in 27.59s.
20:37:27.374370 [debug] [MainThread]: Connection 'master' was properly closed.
20:37:27.374443 [debug] [MainThread]: Connection 'model.Shawn.AH_SZ_Properties_FieldIDs' was properly closed.
20:37:27.374506 [debug] [MainThread]: Connection 'model.Shawn.AH_SZ_Properties_FieldType' was properly closed.
20:37:27.402857 [info ] [MainThread]: 
20:37:27.403224 [info ] [MainThread]: [32mCompleted successfully[0m
20:37:27.403467 [info ] [MainThread]: 
20:37:27.403603 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
20:37:27.403853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2e5e35880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2e664c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2e41dc910>]}


============================== 2022-09-26 20:37:29.700215 | 929da511-d339-49e9-b69a-4cdfed75b83a ==============================
20:37:29.700215 [info ] [MainThread]: Running with dbt=1.0.0
20:37:29.701255 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step7_2'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
20:37:29.701575 [debug] [MainThread]: Tracking: tracking
20:37:29.702147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802f7bcdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802f7bce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802f7bceb0>]}
20:37:29.913697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:37:29.914012 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:37:29.940321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '929da511-d339-49e9-b69a-4cdfed75b83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802f741250>]}
20:37:29.989626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '929da511-d339-49e9-b69a-4cdfed75b83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80317c79d0>]}
20:37:29.990165 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:37:29.998347 [info ] [MainThread]: 
20:37:29.999002 [debug] [MainThread]: Acquiring new synapse connection "master"
20:37:30.000097 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
20:37:30.009213 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
20:37:30.009444 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
20:37:30.009538 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:37:30.009672 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:37:30.296019 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:37:30.328512 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.32 seconds
20:37:30.330748 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
20:37:30.354221 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
20:37:30.360372 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
20:37:30.360821 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
20:37:30.362580 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
20:37:30.362743 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
20:37:30.362827 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:37:30.362925 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:37:30.361052 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
20:37:30.364638 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:37:30.364786 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:37:30.493011 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:37:30.493569 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:37:30.560306 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:37:30.565810 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:37:30.705507 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
20:37:30.705821 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
20:37:30.783020 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
20:37:30.795727 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
20:37:54.486784 [debug] [MainThread]: On master: COMMIT
20:37:54.487398 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
20:37:54.487639 [info ] [MainThread]: 
20:37:54.491410 [debug] [Thread-1  ]: Began running node model.Shawn.AH_SZ_Properties_Value_ColumnMapping
20:37:54.491771 [info ] [Thread-1  ]: 1 of 1 START table model stg.AH_SZ_Properties_Value_ColumnMapping............... [RUN]
20:37:54.492233 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_SZ_Properties_Value_ColumnMapping"
20:37:54.492355 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_SZ_Properties_Value_ColumnMapping
20:37:54.492473 [debug] [Thread-1  ]: Compiling model.Shawn.AH_SZ_Properties_Value_ColumnMapping
20:37:54.499478 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_Value_ColumnMapping".
20:37:54.499716 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_Value_ColumnMapping: 
    
    
SELECT distinct customfieldid FROM stg.AH_Listingproperties_FinalView where  customfieldid is not null
    

  
20:37:54.499822 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:37:54.499930 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:37:54.638311 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:37:54.951504 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.45 seconds
20:37:54.954310 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_SZ_Properties_Value_ColumnMapping"
20:37:54.955175 [debug] [Thread-1  ]: finished collecting timing info
20:37:54.955380 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_SZ_Properties_Value_ColumnMapping
20:37:55.049667 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_SZ_Properties_Value_ColumnMapping"
20:37:55.050493 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_Value_ColumnMapping".
20:37:55.050725 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_Value_ColumnMapping: 
  
  if object_id ('"stg"."AH_SZ_Properties_Value_ColumnMapping__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SZ_Properties_Value_ColumnMapping__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_SZ_Properties_Value_ColumnMapping__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_SZ_Properties_Value_ColumnMapping__dbt_tmp"
    end


   EXEC('create view stg.AH_SZ_Properties_Value_ColumnMapping__dbt_tmp_temp_view as
    





    

    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161245,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',16575279,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',2533219,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19310753,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3723813,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673475,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19367902,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161225,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',14959150,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161205,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673478,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161242,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',1250225,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161202,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161016,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',9895950,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161222,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3744978,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',21259499,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',21806654,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',14589344,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673487,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',15658044,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161214,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673481,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',13549467,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161732,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',25897193,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161231,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161211,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673484,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',11102056,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161234,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161228,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',10045187,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161208,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161271,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',840228,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161237,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3760788,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',810052,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',26254668,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161243,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3737940,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673473,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19353344,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19310748,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19289629,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161217,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161240,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161008,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161735,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161014,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19310751,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19289626,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673490,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3901735,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',7052946,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161220,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',4507814,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673479,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161203,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',6529375,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',5282840,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161229,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161209,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161223,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',14589345,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',9888915,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673482,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161246,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',2694977,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19360781,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',1250223,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19367903,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',10045185,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161226,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673476,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161206,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161020,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673485,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3716724,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161235,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161736,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',810050,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',6557150,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161215,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161238,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673488,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',4016506,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',2080452,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161733,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161275,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',25897194,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161232,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161212,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',26431196,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',633102,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161241,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19310752,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673477,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161221,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',21833162,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',840229,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161244,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673474,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161204,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161012,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',2694972,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161224,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161218,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3752016,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673483,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',13724070,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19338647,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161247,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',1043518,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',1250224,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',23362439,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19367904,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',25897195,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161227,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161207,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',11102055,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',17214902,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673486,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673480,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',7635382,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3730851,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161230,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161210,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',26431194,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3708441,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161018,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161216,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161239,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161233,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161734,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19289625,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673489,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161219,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161213,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19346144,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',15658043,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161737,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161236,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',810051,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',2545215,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161010,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',21817611,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
    select ''''  as customfieldid, '''' as value_columnname  where 1=2

    ');

  CREATE TABLE "stg"."AH_SZ_Properties_Value_ColumnMapping__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SZ_Properties_Value_ColumnMapping__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SZ_Properties_Value_ColumnMapping__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SZ_Properties_Value_ColumnMapping__dbt_tmp_temp_view"
    end



20:38:32.109998 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 37.06 seconds
20:38:32.130514 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_Value_ColumnMapping".
20:38:32.130824 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_Value_ColumnMapping: rename object "stg"."AH_SZ_Properties_Value_ColumnMapping" to AH_SZ_Properties_Value_ColumnMapping__dbt_backup
20:38:32.404294 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:38:32.418771 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_Value_ColumnMapping".
20:38:32.419032 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_Value_ColumnMapping: rename object "stg"."AH_SZ_Properties_Value_ColumnMapping__dbt_tmp" to AH_SZ_Properties_Value_ColumnMapping
20:38:32.452156 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:38:32.464154 [debug] [Thread-1  ]: On model.Shawn.AH_SZ_Properties_Value_ColumnMapping: COMMIT
20:38:32.471382 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_Value_ColumnMapping".
20:38:32.471641 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_Value_ColumnMapping: 
    
  if object_id ('"stg"."AH_SZ_Properties_Value_ColumnMapping__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_SZ_Properties_Value_ColumnMapping__dbt_backup"
    end

20:38:32.810962 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
20:38:32.824575 [debug] [Thread-1  ]: finished collecting timing info
20:38:32.824923 [debug] [Thread-1  ]: On model.Shawn.AH_SZ_Properties_Value_ColumnMapping: Close
20:38:32.825694 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '929da511-d339-49e9-b69a-4cdfed75b83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802d38d070>]}
20:38:32.826171 [info ] [Thread-1  ]: 1 of 1 OK created table model stg.AH_SZ_Properties_Value_ColumnMapping.......... [[32mOK[0m in 38.33s]
20:38:32.826527 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_SZ_Properties_Value_ColumnMapping
20:38:32.827903 [debug] [MainThread]: Acquiring new synapse connection "master"
20:38:32.828162 [debug] [MainThread]: On master: COMMIT
20:38:32.828444 [info ] [MainThread]: 
20:38:32.828649 [info ] [MainThread]: Finished running 1 table model in 62.83s.
20:38:32.828803 [debug] [MainThread]: Connection 'master' was properly closed.
20:38:32.828874 [debug] [MainThread]: Connection 'model.Shawn.AH_SZ_Properties_Value_ColumnMapping' was properly closed.
20:38:32.828937 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
20:38:32.858478 [info ] [MainThread]: 
20:38:32.858864 [info ] [MainThread]: [32mCompleted successfully[0m
20:38:32.859109 [info ] [MainThread]: 
20:38:32.859250 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
20:38:32.859509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802ef3f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802f4b8880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802d29fac0>]}


============================== 2022-09-26 20:38:35.251647 | 0a29c26e-d783-40fa-8a29-ec7326440659 ==============================
20:38:35.251647 [info ] [MainThread]: Running with dbt=1.0.0
20:38:35.252684 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step7_3'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
20:38:35.253004 [debug] [MainThread]: Tracking: tracking
20:38:35.253608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8473dd4df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8473dd4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8473dd4f70>]}
20:38:35.462048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:38:35.462362 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:38:35.489207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a29c26e-d783-40fa-8a29-ec7326440659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8473d5a340>]}
20:38:35.540016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a29c26e-d783-40fa-8a29-ec7326440659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8475d99910>]}
20:38:35.540566 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:38:35.549071 [info ] [MainThread]: 
20:38:35.549753 [debug] [MainThread]: Acquiring new synapse connection "master"
20:38:35.550995 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
20:38:35.560383 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
20:38:35.560625 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
20:38:35.560720 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:38:35.560842 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:38:35.863934 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:38:35.897665 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.34 seconds
20:38:35.899786 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
20:38:35.921966 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
20:38:35.928201 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
20:38:35.928680 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
20:38:35.930469 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
20:38:35.930651 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
20:38:35.930737 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:38:35.930837 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:38:35.928921 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
20:38:35.932321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:38:35.932470 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:38:36.049244 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:38:36.056287 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:38:36.113434 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:38:36.128959 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:38:36.254783 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
20:38:36.255075 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
20:38:36.318189 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
20:38:36.318473 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
20:38:58.696008 [debug] [MainThread]: On master: COMMIT
20:38:58.696590 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
20:38:58.696837 [info ] [MainThread]: 
20:38:58.700497 [debug] [Thread-1  ]: Began running node model.Shawn.AH_SZ_AllProperties_One_Column
20:38:58.700834 [info ] [Thread-1  ]: 1 of 2 START table model stg.AH_SZ_AllProperties_One_Column..................... [RUN]
20:38:58.701275 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column"
20:38:58.701396 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_SZ_AllProperties_One_Column
20:38:58.701507 [debug] [Thread-1  ]: Compiling model.Shawn.AH_SZ_AllProperties_One_Column
20:38:58.707726 [debug] [Thread-2  ]: Began running node model.Shawn.AH_SZ_Properties_CustomFields_Lookup
20:38:58.708011 [info ] [Thread-2  ]: 2 of 2 START table model stg.AH_SZ_Properties_CustomFields_Lookup............... [RUN]
20:38:58.708404 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_SZ_Properties_CustomFields_Lookup"
20:38:58.708517 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_SZ_Properties_CustomFields_Lookup
20:38:58.708625 [debug] [Thread-2  ]: Compiling model.Shawn.AH_SZ_Properties_CustomFields_Lookup
20:38:58.711259 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_SZ_Properties_CustomFields_Lookup"
20:38:58.713825 [debug] [Thread-2  ]: finished collecting timing info
20:38:58.713957 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_SZ_Properties_CustomFields_Lookup
20:38:58.713424 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:38:58.723724 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
    SELECT id FROM stg.AH_SZ_Properties_FieldIDs 

  
20:38:58.723852 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:38:58.723958 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:38:58.813628 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_SZ_Properties_CustomFields_Lookup"
20:38:58.814180 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_CustomFields_Lookup".
20:38:58.814335 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_CustomFields_Lookup: 
  
  if object_id ('"stg"."AH_SZ_Properties_CustomFields_Lookup__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SZ_Properties_CustomFields_Lookup__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_SZ_Properties_CustomFields_Lookup__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_SZ_Properties_CustomFields_Lookup__dbt_tmp"
    end


   EXEC('create view stg.AH_SZ_Properties_CustomFields_Lookup__dbt_tmp_temp_view as
    
select 
    a.*, 
    c.name,
    b.data_type,
           case when b.data_type = ''nvarchar(4000)'' then c.name + '' nvarchar(4000)''
                when b.data_type = ''nvarchar(200)'' then c.name + '' nvarchar(200)''
                when b.data_type = ''decimal(10,2)'' then c.name + '' decimal(11,2)''
                when b.data_type = ''bit'' then c.name + '' bit''
                when b.data_type = ''int'' then c.name + '' bigint''
                when b.data_type = ''datetime'' then c.name + '' datetime''
           end  as col_definition_str,       
           case when b.data_type = ''nvarchar(4000)'' then ''cast('' + c.name + '' as nvarchar(4000)) as '' + c.name 
                when b.data_type = ''nvarchar(200)'' then ''cast('' + c.name + '' as nvarchar(200)) as '' + c.name 
                when b.data_type = ''decimal(10,2)'' then ''cast(cast('' + c.name + '' as nvarchar(10)) as decimal(11,2)) as '' + c.name
                when b.data_type = ''bit'' then ''cast(cast('' + c.name + '' as nvarchar(1)) as bit) as '' + c.name 
                when b.data_type = ''int'' then ''cast(cast('' + c.name + '' as nvarchar(9)) as bigint) as '' + c.name 
                when b.data_type = ''datetime'' then ''cast(cast('' + c.name + '' as nvarchar(23)) as datetime) as '' + c.name 
            end  as col_type_cast
from stg.AH_SZ_Properties_Value_ColumnMapping a
            left join stg.AH_SZ_Properties_FieldType b 
                on a.value_columnname = b.column_name
            left join stg.AH_SZ_Properties_FieldIDs c
                on a.customfieldid = c.id
where a.customfieldid not in (9895950, 9888915, 6529375) -- remove duplicates
    ');

  CREATE TABLE "stg"."AH_SZ_Properties_CustomFields_Lookup__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SZ_Properties_CustomFields_Lookup__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SZ_Properties_CustomFields_Lookup__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SZ_Properties_CustomFields_Lookup__dbt_tmp_temp_view"
    end



20:38:58.814425 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:38:58.814534 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:38:58.887640 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:38:58.946804 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:38:59.057316 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
20:38:59.060270 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:38:59.060521 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161008
        
  
20:38:59.705243 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.64 seconds
20:38:59.707122 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:38:59.707332 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161016
        
  
20:38:59.817336 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:38:59.819183 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:38:59.819361 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161203
        
  
20:38:59.931298 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:38:59.932995 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:38:59.933172 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161207
        
  
20:39:00.475048 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.54 seconds
20:39:00.476896 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:00.477057 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161211
        
  
20:39:00.592099 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:00.594196 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:00.594455 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161215
        
  
20:39:00.710891 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:00.712593 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:00.712762 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161219
        
  
20:39:00.952423 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
20:39:00.954264 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:00.954456 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161223
        
  
20:39:01.066064 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:01.068049 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:01.068264 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161227
        
  
20:39:01.174936 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:01.176679 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:01.176838 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161231
        
  
20:39:01.443477 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:39:01.445373 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:01.445575 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161235
        
  
20:39:01.554710 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:01.556469 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:01.556648 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161239
        
  
20:39:01.669297 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:01.671229 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:01.671448 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161243
        
  
20:39:01.787026 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:01.788965 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:01.789177 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161247
        
  
20:39:01.911510 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:01.913222 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:01.913412 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161733
        
  
20:39:02.020221 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:02.023379 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:02.023620 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161737
        
  
20:39:02.131991 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:02.134414 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:02.134640 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 673475
        
  
20:39:02.255361 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:02.257163 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:02.257389 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 673479
        
  
20:39:02.370760 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:02.372601 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:02.372813 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 673483
        
  
20:39:02.480073 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:02.481945 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:02.482185 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 673487
        
  
20:39:02.588509 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:02.590208 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:02.590422 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 810050
        
  
20:39:02.702033 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:02.703860 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:02.704070 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 840229
        
  
20:39:02.830750 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:39:02.832461 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:02.832641 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 1250225
        
  
20:39:02.947972 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:02.949677 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:02.949860 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 2694972
        
  
20:39:03.062844 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:03.064753 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:03.064952 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 3723813
        
  
20:39:03.176583 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:03.178464 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:03.178713 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 3752016
        
  
20:39:03.300858 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:03.302985 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:03.303218 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 4507814
        
  
20:39:03.441421 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:39:03.443295 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:03.443494 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 7052946
        
  
20:39:03.564698 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:03.566506 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:03.566739 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 10045185
        
  
20:39:03.708484 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:39:03.710165 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:03.710353 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 13549467
        
  
20:39:03.824452 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:03.826117 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:03.826411 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 14959150
        
  
20:39:03.951980 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:39:03.953705 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:03.953881 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 17214902
        
  
20:39:04.060554 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:04.062259 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:04.062461 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 19310748
        
  
20:39:04.207408 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:39:04.209407 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:04.209618 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 19338647
        
  
20:39:04.332817 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:04.334689 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:04.334900 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 19367902
        
  
20:39:04.450800 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:04.452849 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:04.453117 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 21806654
        
  
20:39:04.576401 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:04.578330 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:04.578581 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 25897193
        
  
20:39:04.700456 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:04.702751 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:04.702979 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 26431194
        
  
20:39:04.826048 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:04.827997 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:04.828223 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161010
        
  
20:39:04.937671 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:04.939623 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:04.939828 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161018
        
  
20:39:05.053639 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:05.055402 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:05.055589 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161204
        
  
20:39:05.061067 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.25 seconds
20:39:05.080018 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_CustomFields_Lookup".
20:39:05.080275 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_CustomFields_Lookup: rename object "stg"."AH_SZ_Properties_CustomFields_Lookup" to AH_SZ_Properties_CustomFields_Lookup__dbt_backup
20:39:05.366714 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
20:39:05.369101 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:05.369343 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161208
        
  
20:39:05.369619 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
20:39:05.383744 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_CustomFields_Lookup".
20:39:05.384017 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_CustomFields_Lookup: rename object "stg"."AH_SZ_Properties_CustomFields_Lookup__dbt_tmp" to AH_SZ_Properties_CustomFields_Lookup
20:39:05.412890 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:39:05.423761 [debug] [Thread-2  ]: On model.Shawn.AH_SZ_Properties_CustomFields_Lookup: COMMIT
20:39:05.430759 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_CustomFields_Lookup".
20:39:05.431044 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_CustomFields_Lookup: 
    
  if object_id ('"stg"."AH_SZ_Properties_CustomFields_Lookup__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_SZ_Properties_CustomFields_Lookup__dbt_backup"
    end

20:39:05.475489 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:05.477247 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:05.477453 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161212
        
  
20:39:05.729727 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
20:39:05.731519 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:05.731706 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161216
        
  
20:39:05.929631 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:39:05.931536 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:05.931734 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161220
        
  
20:39:05.950286 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.52 seconds
20:39:05.964331 [debug] [Thread-2  ]: finished collecting timing info
20:39:05.964681 [debug] [Thread-2  ]: On model.Shawn.AH_SZ_Properties_CustomFields_Lookup: Close
20:39:05.965430 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a29c26e-d783-40fa-8a29-ec7326440659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84718b6a60>]}
20:39:05.965894 [info ] [Thread-2  ]: 2 of 2 OK created table model stg.AH_SZ_Properties_CustomFields_Lookup.......... [[32mOK[0m in 7.26s]
20:39:05.966236 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_SZ_Properties_CustomFields_Lookup
20:39:06.039777 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:06.041661 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:06.041849 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161224
        
  
20:39:06.151439 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:06.153104 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:06.153292 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161228
        
  
20:39:06.259073 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:06.260800 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:06.260976 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161232
        
  
20:39:06.366275 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:06.368021 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:06.368195 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161236
        
  
20:39:06.493711 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:39:06.495636 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:06.495843 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161240
        
  
20:39:06.607096 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:06.608892 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:06.609063 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161244
        
  
20:39:06.717503 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:06.719412 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:06.719588 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161271
        
  
20:39:06.827367 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:06.829207 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:06.829391 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161734
        
  
20:39:06.935845 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:06.937745 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:06.937936 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 633102
        
  
20:39:07.047768 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:07.049593 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:07.049780 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 673476
        
  
20:39:07.166101 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:07.168398 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:07.168643 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 673480
        
  
20:39:07.282982 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:07.284764 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:07.284954 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 673484
        
  
20:39:07.404535 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:07.406267 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:07.406427 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 673488
        
  
20:39:07.515387 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:07.517063 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:07.517267 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 810051
        
  
20:39:07.623595 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:07.625365 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:07.625555 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 1043518
        
  
20:39:07.732517 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:07.734270 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:07.734467 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 2080452
        
  
20:39:07.841843 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:07.843734 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:07.843928 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 2694977
        
  
20:39:07.951585 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:07.953276 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:07.953470 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 3730851
        
  
20:39:08.062773 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:08.064459 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:08.064652 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 3760788
        
  
20:39:08.170649 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:08.172357 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:08.172534 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 5282840
        
  
20:39:08.325290 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:39:08.327182 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:08.327386 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 7635382
        
  
20:39:08.435639 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:08.437409 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:08.437579 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 10045187
        
  
20:39:08.547096 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:08.549301 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:08.549523 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 13724070
        
  
20:39:08.658697 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:08.660400 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:08.660607 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 15658043
        
  
20:39:08.768879 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:08.770652 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:08.770847 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 19289625
        
  
20:39:08.873679 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:39:08.875414 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:08.875607 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 19310751
        
  
20:39:08.986872 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:08.988692 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:08.988862 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 19346144
        
  
20:39:09.209798 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:39:09.211644 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:09.211839 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 19367903
        
  
20:39:09.362767 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:39:09.364448 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:09.364653 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 21817611
        
  
20:39:09.494739 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:39:09.496433 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:09.496640 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 25897194
        
  
20:39:09.603344 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:09.605235 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:09.605452 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 26431196
        
  
20:39:09.734596 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:39:09.736348 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:09.736549 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161012
        
  
20:39:09.846581 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:09.848281 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:09.848465 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161020
        
  
20:39:09.957709 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:09.959825 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:09.960013 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161205
        
  
20:39:10.069792 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:10.071763 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:10.072028 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161209
        
  
20:39:10.180201 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:10.181994 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:10.182476 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161213
        
  
20:39:10.292005 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:10.293799 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:10.294005 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161217
        
  
20:39:10.399232 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:10.401003 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:10.401211 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161221
        
  
20:39:10.508727 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:10.510395 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:10.510618 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161225
        
  
20:39:10.630387 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:10.632139 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:10.632322 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161229
        
  
20:39:10.740295 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:10.742066 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:10.742257 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161233
        
  
20:39:10.850870 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:10.852526 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:10.852715 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161237
        
  
20:39:10.962587 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:10.964271 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:10.964446 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161241
        
  
20:39:11.071835 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:11.073636 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:11.073839 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161245
        
  
20:39:11.181289 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:11.183610 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:11.183837 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161275
        
  
20:39:11.290366 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:11.292186 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:11.292427 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161735
        
  
20:39:11.403046 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:11.405041 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:11.405290 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 673473
        
  
20:39:11.512082 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:11.513762 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:11.513954 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 673477
        
  
20:39:11.635772 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:11.637439 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:11.637627 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 673481
        
  
20:39:11.742318 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:39:11.744087 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:11.744293 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 673485
        
  
20:39:11.852473 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:11.854294 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:11.854485 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 673489
        
  
20:39:11.960742 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:11.962502 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:11.962703 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 810052
        
  
20:39:12.068964 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:12.070701 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:12.070882 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 1250223
        
  
20:39:12.192718 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:12.194997 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:12.195216 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 2533219
        
  
20:39:12.305605 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:12.307421 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:12.307608 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 3708441
        
  
20:39:12.414391 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:12.416501 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:12.416719 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 3737940
        
  
20:39:12.522919 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:12.524794 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:12.524995 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 3901735
        
  
20:39:12.632039 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:12.633887 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:12.634097 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 6529375
        
  
20:39:12.739794 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:12.741556 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:12.741807 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 9888915
        
  
20:39:12.851589 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:12.853263 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:12.853459 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 11102055
        
  
20:39:12.988947 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
20:39:12.990709 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:12.990890 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 14589344
        
  
20:39:13.096984 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:13.098766 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:13.098989 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 15658044
        
  
20:39:13.207820 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:13.209552 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:13.209729 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 19289626
        
  
20:39:13.319779 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:13.321469 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:13.321659 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 19310752
        
  
20:39:13.431067 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:13.432805 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:13.432976 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 19353344
        
  
20:39:13.552073 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:13.553866 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:13.554072 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 19367904
        
  
20:39:13.675902 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:13.678348 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:13.678690 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 21833162
        
  
20:39:13.783992 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:13.785718 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:13.785944 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 25897195
        
  
20:39:13.889000 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:39:13.890879 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:13.891099 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161014
        
  
20:39:14.015541 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:14.017238 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:14.017438 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161202
        
  
20:39:14.124866 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:14.126633 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:14.126815 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161206
        
  
20:39:14.237232 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:14.238990 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:14.239161 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161210
        
  
20:39:14.342100 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:39:14.343813 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:14.344016 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161214
        
  
20:39:14.451515 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:14.453375 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:14.453553 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161218
        
  
20:39:14.559434 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:14.561177 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:14.561350 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161222
        
  
20:39:14.682675 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:14.684489 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:14.684701 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161226
        
  
20:39:14.799712 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:14.801449 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:14.801654 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161230
        
  
20:39:14.908249 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:14.910599 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:14.910831 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161234
        
  
20:39:15.036075 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
20:39:15.037767 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:15.037968 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161238
        
  
20:39:15.145250 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:15.147122 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:15.147294 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161242
        
  
20:39:15.254284 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:15.255991 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:15.256171 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161246
        
  
20:39:15.361037 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:39:15.362877 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:15.363084 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161732
        
  
20:39:15.465717 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:39:15.467431 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:15.467623 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 161736
        
  
20:39:15.771755 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:39:15.773548 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:15.773747 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 673474
        
  
20:39:15.895880 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:15.897615 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:15.897780 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 673478
        
  
20:39:16.005833 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:16.007760 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:16.007970 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 673482
        
  
20:39:16.121507 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:16.123389 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:16.123573 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 673486
        
  
20:39:16.227435 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:39:16.229336 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:16.229516 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 673490
        
  
20:39:16.334728 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:16.336972 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:16.337177 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 840228
        
  
20:39:16.440835 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:39:16.442574 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:16.442742 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 1250224
        
  
20:39:16.545649 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:39:16.547563 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:16.547769 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 2545215
        
  
20:39:16.653290 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:16.655054 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:16.655236 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 3716724
        
  
20:39:16.758082 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:39:16.759905 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:16.760121 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 3744978
        
  
20:39:16.878843 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:16.880596 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:16.880769 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 4016506
        
  
20:39:16.985306 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:39:16.987057 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:16.987267 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 6557150
        
  
20:39:17.106433 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:17.108206 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:17.108387 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 9895950
        
  
20:39:17.213596 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:17.215565 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:17.215789 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 11102056
        
  
20:39:17.324985 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:17.326927 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:17.327122 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 14589345
        
  
20:39:17.436703 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:17.438793 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:17.438984 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 16575279
        
  
20:39:17.543018 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
20:39:17.545307 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:17.545501 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 19289629
        
  
20:39:17.652459 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:17.654463 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:17.654682 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 19310753
        
  
20:39:17.772554 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:17.774277 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:17.774472 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 19360781
        
  
20:39:17.884220 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:17.885960 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:17.886158 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 21259499
        
  
20:39:17.994269 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:17.996163 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:17.996350 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 23362439
        
  
20:39:18.115006 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
20:39:18.116897 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:18.117102 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
            select value_columnname from stg.AH_SZ_Properties_Value_ColumnMapping where customfieldid = 26254668
        
  
20:39:18.226504 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
20:39:18.228379 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_SZ_AllProperties_One_Column"
20:39:18.228940 [debug] [Thread-1  ]: finished collecting timing info
20:39:18.229178 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_SZ_AllProperties_One_Column
20:39:18.297337 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_SZ_AllProperties_One_Column"
20:39:18.298078 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:39:18.298259 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
  
  if object_id ('"stg"."AH_SZ_AllProperties_One_Column__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SZ_AllProperties_One_Column__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_SZ_AllProperties_One_Column__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_SZ_AllProperties_One_Column__dbt_tmp"
    end


   EXEC('create view stg.AH_SZ_AllProperties_One_Column__dbt_tmp_temp_view as
    





    

    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161008

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161016

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161203

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161207

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161211

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161215

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161219

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161223

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161227

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161231

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161235

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161239

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161243

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161247

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161733

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161737

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673475

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673479

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673483

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673487

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 810050

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 840229

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 1250225

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 2694972

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3723813

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3752016

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 4507814

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 7052946

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 10045185

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 13549467

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 14959150

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 17214902

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19310748

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19338647

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19367902

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 21806654

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 25897193

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DateTimeNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 26431194

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161010

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161018

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161204

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161208

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161212

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161216

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161220

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161224

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161228

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161232

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161236

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161240

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161244

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161271

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161734

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 633102

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673476

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673480

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673484

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673488

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 810051

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 1043518

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 2080452

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 2694977

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3730851

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3760788

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 5282840

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 7635382

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 10045187

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 13724070

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 15658043

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19289625

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19310751

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19346144

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19367903

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 21817611

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 25897194

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 26431196

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161012

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161020

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161205

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161209

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161213

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161217

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161221

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161225

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161229

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161233

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161237

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(IntNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161241

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161245

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161275

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161735

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673473

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673477

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673481

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673485

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673489

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 810052

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 1250223

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 2533219

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3708441

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3737940

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3901735

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 6529375

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 9888915

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 11102055

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 14589344

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(IntNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 15658044

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19289626

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19310752

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19353344

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19367904

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 21833162

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 25897195

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161014

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161202

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161206

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161210

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161214

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161218

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161222

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161226

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161230

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161234

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161238

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161242

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161246

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161732

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161736

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673474

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673478

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673482

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673486

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673490

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(IntNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 840228

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 1250224

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 2545215

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3716724

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3744978

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 4016506

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 6557150

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 9895950

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 11102056

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 14589345

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 16575279

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19289629

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19310753

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19360781

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 21259499

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 23362439

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 26254668

        ) a 
        inner join stg.AH_SZ_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
    select 
        '''' as listingid, '''' as customfieldid, '''' as customfieldname, '''' as customfieldvalue 
    where 2=1

    ');

  CREATE TABLE "stg"."AH_SZ_AllProperties_One_Column__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SZ_AllProperties_One_Column__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SZ_AllProperties_One_Column__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SZ_AllProperties_One_Column__dbt_tmp_temp_view"
    end



20:40:10.681561 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 52.38 seconds
20:40:10.697741 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:40:10.698005 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: rename object "stg"."AH_SZ_AllProperties_One_Column" to AH_SZ_AllProperties_One_Column__dbt_backup
20:40:10.978768 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
20:40:10.993634 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:40:10.993912 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: rename object "stg"."AH_SZ_AllProperties_One_Column__dbt_tmp" to AH_SZ_AllProperties_One_Column
20:40:11.033794 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:40:11.035730 [debug] [Thread-1  ]: On model.Shawn.AH_SZ_AllProperties_One_Column: COMMIT
20:40:11.040012 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_AllProperties_One_Column".
20:40:11.040233 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_AllProperties_One_Column: 
    
  if object_id ('"stg"."AH_SZ_AllProperties_One_Column__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_SZ_AllProperties_One_Column__dbt_backup"
    end

20:40:11.375920 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
20:40:11.389983 [debug] [Thread-1  ]: finished collecting timing info
20:40:11.390321 [debug] [Thread-1  ]: On model.Shawn.AH_SZ_AllProperties_One_Column: Close
20:40:11.391154 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a29c26e-d783-40fa-8a29-ec7326440659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f847188cb20>]}
20:40:11.391603 [info ] [Thread-1  ]: 1 of 2 OK created table model stg.AH_SZ_AllProperties_One_Column................ [[32mOK[0m in 72.69s]
20:40:11.391925 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_SZ_AllProperties_One_Column
20:40:11.393335 [debug] [MainThread]: Acquiring new synapse connection "master"
20:40:11.393599 [debug] [MainThread]: On master: COMMIT
20:40:11.393888 [info ] [MainThread]: 
20:40:11.394096 [info ] [MainThread]: Finished running 2 table models in 95.84s.
20:40:11.394251 [debug] [MainThread]: Connection 'master' was properly closed.
20:40:11.394327 [debug] [MainThread]: Connection 'model.Shawn.AH_SZ_AllProperties_One_Column' was properly closed.
20:40:11.394392 [debug] [MainThread]: Connection 'model.Shawn.AH_SZ_Properties_CustomFields_Lookup' was properly closed.
20:40:11.424909 [info ] [MainThread]: 
20:40:11.425281 [info ] [MainThread]: [32mCompleted successfully[0m
20:40:11.425550 [info ] [MainThread]: 
20:40:11.425690 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
20:40:11.425953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f845afc5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8473cee6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84736cbd60>]}


============================== 2022-09-26 20:40:13.842897 | 982ce507-b352-4bbb-9fa0-1fcb8c5d8793 ==============================
20:40:13.842897 [info ] [MainThread]: Running with dbt=1.0.0
20:40:13.843494 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step7_4'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
20:40:13.843688 [debug] [MainThread]: Tracking: tracking
20:40:13.844002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264d9c4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264d9c4d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264d9e4040>]}
20:40:14.053119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:40:14.053443 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:40:14.080329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '982ce507-b352-4bbb-9fa0-1fcb8c5d8793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264d94a3a0>]}
20:40:14.132287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '982ce507-b352-4bbb-9fa0-1fcb8c5d8793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264f9cf970>]}
20:40:14.132837 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:40:14.141487 [info ] [MainThread]: 
20:40:14.142169 [debug] [MainThread]: Acquiring new synapse connection "master"
20:40:14.143314 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
20:40:14.152609 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
20:40:14.152859 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
20:40:14.152953 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:40:14.153069 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:40:14.444254 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:40:14.482859 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.33 seconds
20:40:14.484905 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
20:40:14.506974 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
20:40:14.513704 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
20:40:14.513958 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
20:40:14.514046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:40:14.514159 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:40:14.514913 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
20:40:14.516591 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
20:40:14.516747 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
20:40:14.516829 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:40:14.516926 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:40:14.633434 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:40:14.634335 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:40:14.702149 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:40:14.729459 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:40:14.757207 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
20:40:14.757500 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
20:40:14.926414 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
20:40:14.926806 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
20:40:38.248549 [debug] [MainThread]: On master: COMMIT
20:40:38.249151 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
20:40:38.249394 [info ] [MainThread]: 
20:40:38.252711 [debug] [Thread-1  ]: Began running node model.Shawn.AH_SZ_Properties_Pivot
20:40:38.253123 [info ] [Thread-1  ]: 1 of 1 START table model stg.AH_SZ_Properties_Pivot............................. [RUN]
20:40:38.253648 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_SZ_Properties_Pivot"
20:40:38.253792 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_SZ_Properties_Pivot
20:40:38.253908 [debug] [Thread-1  ]: Compiling model.Shawn.AH_SZ_Properties_Pivot
20:40:38.263896 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_Pivot".
20:40:38.264162 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_Pivot: 
    
    select name from stg.AH_SZ_Properties_CustomFields_Lookup where name != 'listingid'

  
20:40:38.264256 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:40:38.264372 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:40:38.376240 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:40:39.019453 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.76 seconds
20:40:39.039073 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_Pivot".
20:40:39.039324 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_Pivot: 
    
    select col_type_cast  from stg.AH_SZ_Properties_CustomFields_Lookup

  
20:40:39.130264 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
20:40:39.147704 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_SZ_Properties_Pivot"
20:40:39.148314 [debug] [Thread-1  ]: finished collecting timing info
20:40:39.148501 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_SZ_Properties_Pivot
20:40:39.243712 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_SZ_Properties_Pivot"
20:40:39.244311 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_Pivot".
20:40:39.244462 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_Pivot: 
  
  if object_id ('"stg"."AH_SZ_Properties_Pivot__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SZ_Properties_Pivot__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_SZ_Properties_Pivot__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_SZ_Properties_Pivot__dbt_tmp"
    end


   EXEC('create view stg.AH_SZ_Properties_Pivot__dbt_tmp_temp_view as
    









    

    

 







    
    

 

WITH pivot_data_input AS
(
    SELECT 
        listingid, -- Grouping Column
        customfieldname, -- Spreading Column
        customfieldvalue -- Aggregate Column
    FROM [stg].[AH_SZ_AllProperties_One_Column] 
        -- [TEST] where listingid = 10023682
),
pivoted_data AS
(
    SELECT 
        listingid, [VehicleStoryDescriptionExterior2], [Commission], [MagicBoxSection1], [BuyItNowUsed], [DealerName], [Mileage], [LockUsername], [WhereDidYouHearAboutUsListingReferral], [ExpertVideoReview], [CarfaxPassFail], [MileageAccurate], [DealerFees], [Make], [IsTaxable], [CurrentIssues], [PersonalMileage], [VehicleStoryDescriptionUndercarriage], [CarfaxLink], [HideListing], [TargetReserve], [HasProPhotography], [ListingNotes], [VehicleStoryDescriptionInterior2Pictures], [VehicleStoryDescriptionUndercarriagePictures], [Utm_Campaign_Listing_Submission], [VehicleStory], [VehicleColor], [Decade], [PaintWork], [IsFeaturedVehicle], [StartingBid], [Copy_Writer_Status], [VehicleStoryDescriptionCarFaxPictures], [OdometerUnits], [Specialist_Section_Notes], [Era], [Acct_Rep_Phone], [CountryOfOrigin], [CommissionOverrideReason], [MakeOfferAvailable], [MagicBoxSection5], [MagicBoxSection6], [BeenListed], [Copy_Writer], [VehicleStoryDescriptionExterior2Pictures], [VehicleStoryDescriptionExterior], [HasMagicBox], [HasDealerFee], [Utm_Source_Listing_Submission], [AddressLine2], [PremiumListing], [IsPaid], [MakeWholeAmount], [CarfaxPassFailError], [LeadSource], [Specialist_Section_Comp2_Info], [ListingState], [WGL_Public_Report], [PhotoPlanId], [Specialist_Section_Comp1_Info], [Curated], [VehicleStoryOpeningStatementPictures], [HowLongOwned], [MagicBoxSection2], [Dealer], [HaveAllPhotos], [DealerURL], [OriginalEngine], [Model], [BuyItNow], [Specialist], [StateProvinceRegion], [EstimatedMarketValue], [OriginalEngineText], [HasProMarketing], [VehicleStoryDescriptionExteriorPictures], [DraftEmailNotificationSent], [Specialist_Section_Comp5_Info], [CarTitleInYourName], [Specialist_Section_Comp1_Price], [Specialist_Section_Comp3_Price], [MakeOfferAllowed], [CountryCL], [SnapprPackage], [FixedPrice], [Acct_Rep], [Taxonomy], [CCID], [VehicleStoryDescriptionCarFax], [IsPromoVehicle], [IsApproved], [Specialist_Section_Comp4_Info], [BeenListedText], [ReserveReviewEmailDate], [VehicleTitle], [WhereDidYouHearAboutUsListingOther], [Specialist_Section_Original_Reserve], [Address], [UserComments], [NoReserveCheck], [MagicBoxSection4], [Specialist_Section_Comp2_Price], [CaliforniaSmogCheck], [Modifications], [SchedulingComplete], [LastServiceInformation], [CityCL], [Transmission], [TransactionId], [Comped], [VehicleStoryDescriptionEngineTransmission], [ReservePrice], [UI_ListingStateHold], [Specialist_Section_Comp5_Price], [Rust], [VehicleStoryDescriptionEngineTransmissionPictures], [VehicleStoryDescriptionInterior2], [VehicleStoryDescriptionInteriorPictures], [WhereDidYouHearAboutUsListing], [Photo_Plan], [IsEdited], [VIN], [Acct_Rep_Name], [Photo_Plan_Status], [VehicleStoryDescriptionInterior], [MarketValue], [VehicleStoryOpeningStatement], [MaxReserve], [SpinCarLink], [PaintWorkText], [Copy_Writer_Feedback], [Specialist_Section_Comp3_Info], [Utm_Medium_Listing_Submission], [CounterReserve], [TransmissionText], [ServiceRecords], [MagicBoxSection3], [ListingProgress], [AnythingElseWeShouldKnow], [EngineSize], [PackageTransactionId], [Year], [BeenModified], [Acct_Rep_Email], [Specialist_Section_Comp4_Price], [Zip], [ReservePriceCL]
    FROM pivot_data_input
    PIVOT (
        max(customfieldvalue) for customfieldname in ( [VehicleStoryDescriptionExterior2], [Commission], [MagicBoxSection1], [BuyItNowUsed], [DealerName], [Mileage], [LockUsername], [WhereDidYouHearAboutUsListingReferral], [ExpertVideoReview], [CarfaxPassFail], [MileageAccurate], [DealerFees], [Make], [IsTaxable], [CurrentIssues], [PersonalMileage], [VehicleStoryDescriptionUndercarriage], [CarfaxLink], [HideListing], [TargetReserve], [HasProPhotography], [ListingNotes], [VehicleStoryDescriptionInterior2Pictures], [VehicleStoryDescriptionUndercarriagePictures], [Utm_Campaign_Listing_Submission], [VehicleStory], [VehicleColor], [Decade], [PaintWork], [IsFeaturedVehicle], [StartingBid], [Copy_Writer_Status], [VehicleStoryDescriptionCarFaxPictures], [OdometerUnits], [Specialist_Section_Notes], [Era], [Acct_Rep_Phone], [CountryOfOrigin], [CommissionOverrideReason], [MakeOfferAvailable], [MagicBoxSection5], [MagicBoxSection6], [BeenListed], [Copy_Writer], [VehicleStoryDescriptionExterior2Pictures], [VehicleStoryDescriptionExterior], [HasMagicBox], [HasDealerFee], [Utm_Source_Listing_Submission], [AddressLine2], [PremiumListing], [IsPaid], [MakeWholeAmount], [CarfaxPassFailError], [LeadSource], [Specialist_Section_Comp2_Info], [ListingState], [WGL_Public_Report], [PhotoPlanId], [Specialist_Section_Comp1_Info], [Curated], [VehicleStoryOpeningStatementPictures], [HowLongOwned], [MagicBoxSection2], [Dealer], [HaveAllPhotos], [DealerURL], [OriginalEngine], [Model], [BuyItNow], [Specialist], [StateProvinceRegion], [EstimatedMarketValue], [OriginalEngineText], [HasProMarketing], [VehicleStoryDescriptionExteriorPictures], [DraftEmailNotificationSent], [Specialist_Section_Comp5_Info], [CarTitleInYourName], [Specialist_Section_Comp1_Price], [Specialist_Section_Comp3_Price], [MakeOfferAllowed], [CountryCL], [SnapprPackage], [FixedPrice], [Acct_Rep], [Taxonomy], [CCID], [VehicleStoryDescriptionCarFax], [IsPromoVehicle], [IsApproved], [Specialist_Section_Comp4_Info], [BeenListedText], [ReserveReviewEmailDate], [VehicleTitle], [WhereDidYouHearAboutUsListingOther], [Specialist_Section_Original_Reserve], [Address], [UserComments], [NoReserveCheck], [MagicBoxSection4], [Specialist_Section_Comp2_Price], [CaliforniaSmogCheck], [Modifications], [SchedulingComplete], [LastServiceInformation], [CityCL], [Transmission], [TransactionId], [Comped], [VehicleStoryDescriptionEngineTransmission], [ReservePrice], [UI_ListingStateHold], [Specialist_Section_Comp5_Price], [Rust], [VehicleStoryDescriptionEngineTransmissionPictures], [VehicleStoryDescriptionInterior2], [VehicleStoryDescriptionInteriorPictures], [WhereDidYouHearAboutUsListing], [Photo_Plan], [IsEdited], [VIN], [Acct_Rep_Name], [Photo_Plan_Status], [VehicleStoryDescriptionInterior], [MarketValue], [VehicleStoryOpeningStatement], [MaxReserve], [SpinCarLink], [PaintWorkText], [Copy_Writer_Feedback], [Specialist_Section_Comp3_Info], [Utm_Medium_Listing_Submission], [CounterReserve], [TransmissionText], [ServiceRecords], [MagicBoxSection3], [ListingProgress], [AnythingElseWeShouldKnow], [EngineSize], [PackageTransactionId], [Year], [BeenModified], [Acct_Rep_Email], [Specialist_Section_Comp4_Price], [Zip], [ReservePriceCL])
    )as pvt
)


select 
    listingid, [VehicleStoryDescriptionExterior2], [Commission], [MagicBoxSection1], [BuyItNowUsed], [DealerName], [Mileage], [LockUsername], [WhereDidYouHearAboutUsListingReferral], [ExpertVideoReview], [CarfaxPassFail], [MileageAccurate], [DealerFees], [Make], [IsTaxable], [CurrentIssues], [PersonalMileage], [VehicleStoryDescriptionUndercarriage], [CarfaxLink], [HideListing], [TargetReserve], [HasProPhotography], [ListingNotes], [VehicleStoryDescriptionInterior2Pictures], [VehicleStoryDescriptionUndercarriagePictures], [Utm_Campaign_Listing_Submission], [VehicleStory], [VehicleColor], [Decade], [PaintWork], [IsFeaturedVehicle], [StartingBid], [Copy_Writer_Status], [VehicleStoryDescriptionCarFaxPictures], [OdometerUnits], [Specialist_Section_Notes], [Era], [Acct_Rep_Phone], [CountryOfOrigin], [CommissionOverrideReason], [MakeOfferAvailable], [MagicBoxSection5], [MagicBoxSection6], [BeenListed], [Copy_Writer], [VehicleStoryDescriptionExterior2Pictures], [VehicleStoryDescriptionExterior], [HasMagicBox], [HasDealerFee], [Utm_Source_Listing_Submission], [AddressLine2], [PremiumListing], [IsPaid], [MakeWholeAmount], [CarfaxPassFailError], [LeadSource], [Specialist_Section_Comp2_Info], [ListingState], [WGL_Public_Report], [PhotoPlanId], [Specialist_Section_Comp1_Info], [Curated], [VehicleStoryOpeningStatementPictures], [HowLongOwned], [MagicBoxSection2], [Dealer], [HaveAllPhotos], [DealerURL], [OriginalEngine], [Model], [BuyItNow], [Specialist], [StateProvinceRegion], [EstimatedMarketValue], [OriginalEngineText], [HasProMarketing], [VehicleStoryDescriptionExteriorPictures], [DraftEmailNotificationSent], [Specialist_Section_Comp5_Info], [CarTitleInYourName], [Specialist_Section_Comp1_Price], [Specialist_Section_Comp3_Price], [MakeOfferAllowed], [CountryCL], [SnapprPackage], [FixedPrice], [Acct_Rep], [Taxonomy], [CCID], [VehicleStoryDescriptionCarFax], [IsPromoVehicle], [IsApproved], [Specialist_Section_Comp4_Info], [BeenListedText], [ReserveReviewEmailDate], [VehicleTitle], [WhereDidYouHearAboutUsListingOther], [Specialist_Section_Original_Reserve], [Address], [UserComments], [NoReserveCheck], [MagicBoxSection4], [Specialist_Section_Comp2_Price], [CaliforniaSmogCheck], [Modifications], [SchedulingComplete], [LastServiceInformation], [CityCL], [Transmission], [TransactionId], [Comped], [VehicleStoryDescriptionEngineTransmission], [ReservePrice], [UI_ListingStateHold], [Specialist_Section_Comp5_Price], [Rust], [VehicleStoryDescriptionEngineTransmissionPictures], [VehicleStoryDescriptionInterior2], [VehicleStoryDescriptionInteriorPictures], [WhereDidYouHearAboutUsListing], [Photo_Plan], [IsEdited], [VIN], [Acct_Rep_Name], [Photo_Plan_Status], [VehicleStoryDescriptionInterior], [MarketValue], [VehicleStoryOpeningStatement], [MaxReserve], [SpinCarLink], [PaintWorkText], [Copy_Writer_Feedback], [Specialist_Section_Comp3_Info], [Utm_Medium_Listing_Submission], [CounterReserve], [TransmissionText], [ServiceRecords], [MagicBoxSection3], [ListingProgress], [AnythingElseWeShouldKnow], [EngineSize], [PackageTransactionId], [Year], [BeenModified], [Acct_Rep_Email], [Specialist_Section_Comp4_Price], [Zip], [ReservePriceCL]
from pivoted_data
    ');

  CREATE TABLE "stg"."AH_SZ_Properties_Pivot__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SZ_Properties_Pivot__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SZ_Properties_Pivot__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SZ_Properties_Pivot__dbt_tmp_temp_view"
    end



20:40:44.598823 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.35 seconds
20:40:44.617863 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_Pivot".
20:40:44.618115 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_Pivot: rename object "stg"."AH_SZ_Properties_Pivot" to AH_SZ_Properties_Pivot__dbt_backup
20:40:44.703188 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:40:44.718535 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_Pivot".
20:40:44.718828 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_Pivot: rename object "stg"."AH_SZ_Properties_Pivot__dbt_tmp" to AH_SZ_Properties_Pivot
20:40:44.748685 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:40:44.760176 [debug] [Thread-1  ]: On model.Shawn.AH_SZ_Properties_Pivot: COMMIT
20:40:44.767191 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SZ_Properties_Pivot".
20:40:44.767439 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SZ_Properties_Pivot: 
    
  if object_id ('"stg"."AH_SZ_Properties_Pivot__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_SZ_Properties_Pivot__dbt_backup"
    end

20:40:45.074511 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
20:40:45.087770 [debug] [Thread-1  ]: finished collecting timing info
20:40:45.088112 [debug] [Thread-1  ]: On model.Shawn.AH_SZ_Properties_Pivot: Close
20:40:45.088895 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '982ce507-b352-4bbb-9fa0-1fcb8c5d8793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264747a3d0>]}
20:40:45.089368 [info ] [Thread-1  ]: 1 of 1 OK created table model stg.AH_SZ_Properties_Pivot........................ [[32mOK[0m in 6.84s]
20:40:45.089703 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_SZ_Properties_Pivot
20:40:45.090996 [debug] [MainThread]: Acquiring new synapse connection "master"
20:40:45.091262 [debug] [MainThread]: On master: COMMIT
20:40:45.091530 [info ] [MainThread]: 
20:40:45.091722 [info ] [MainThread]: Finished running 1 table model in 30.95s.
20:40:45.091872 [debug] [MainThread]: Connection 'master' was properly closed.
20:40:45.091944 [debug] [MainThread]: Connection 'model.Shawn.AH_SZ_Properties_Pivot' was properly closed.
20:40:45.092008 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
20:40:45.121465 [info ] [MainThread]: 
20:40:45.121835 [info ] [MainThread]: [32mCompleted successfully[0m
20:40:45.122081 [info ] [MainThread]: 
20:40:45.122218 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
20:40:45.122489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264d9739a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264d6ac730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26474a8c10>]}


============================== 2022-09-26 20:40:47.436733 | 54ed56a3-3e1e-45de-9598-31889f989183 ==============================
20:40:47.436733 [info ] [MainThread]: Running with dbt=1.0.0
20:40:47.437911 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step8_1_DM'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
20:40:47.438254 [debug] [MainThread]: Tracking: tracking
20:40:47.442816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0095a9dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0095a9dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0095a9ddc0>]}
20:40:47.653650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:40:47.653987 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:40:47.681037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54ed56a3-3e1e-45de-9598-31889f989183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0095a232e0>]}
20:40:47.732107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54ed56a3-3e1e-45de-9598-31889f989183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0097a618b0>]}
20:40:47.732651 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:40:47.741297 [info ] [MainThread]: 
20:40:47.741977 [debug] [MainThread]: Acquiring new synapse connection "master"
20:40:47.743819 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
20:40:47.753158 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
20:40:47.753430 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
20:40:47.753526 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:40:47.753654 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:40:48.045430 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:40:48.080354 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.33 seconds
20:40:48.082329 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
20:40:48.104416 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
20:40:48.111278 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
20:40:48.111742 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
20:40:48.113538 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
20:40:48.113701 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
20:40:48.113797 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:40:48.113897 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:40:48.111980 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
20:40:48.115186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:40:48.115336 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:40:48.244657 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:40:48.245226 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:40:48.310728 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:40:48.314578 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.20 seconds
20:40:48.452331 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
20:40:48.452646 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
20:40:48.531213 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
20:40:48.531599 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
20:41:11.917108 [debug] [MainThread]: On master: COMMIT
20:41:11.917729 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
20:41:11.918009 [info ] [MainThread]: 
20:41:11.921372 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Cars_DM
20:41:11.921764 [info ] [Thread-1  ]: 1 of 1 START table model dbo.AH_Cars_DM......................................... [RUN]
20:41:11.922265 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Cars_DM"
20:41:11.922399 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Cars_DM
20:41:11.922519 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Cars_DM
20:41:11.925683 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Cars_DM"
20:41:11.926190 [debug] [Thread-1  ]: finished collecting timing info
20:41:11.926347 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Cars_DM
20:41:11.993578 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Cars_DM"
20:41:11.994176 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Cars_DM".
20:41:11.994334 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Cars_DM: 
  
  if object_id ('"dbo"."AH_Cars_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Cars_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Cars_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Cars_DM__dbt_tmp"
    end


   EXEC('create view dbo.AH_Cars_DM__dbt_tmp_temp_view as
    
with DMStg as (
    SELECT
        HASHBYTES(''SHA2_256'',
            CONCAT(
                COALESCE(CAST(lpp.[ListingId] AS VARCHAR(200)), ''''), ''|'',
                COALESCE(CAST(lpp.[VIN] AS VARCHAR(200)), ''''), ''|'',
                COALESCE(CAST(lpp.[Year] AS VARCHAR(200)), ''''), ''|'',
                COALESCE(CAST(lpp.[Make] AS VARCHAR(200)), ''''), ''|'',
                COALESCE(CAST(lpp.[Model] AS VARCHAR(200)), '''')
            )
        ) as [Car_Skey],
		lpp.[ListingId] AS [ListingID],
		lpp.[VIN],
		lpp.[Year],
		lpp.[Make],
		lpp.[Model],
		lpp.[VehicleColor],
		lpp.[EngineSize],
		l.[CreatedOn] AS [CreatedDate],
		l.[UpdatedOn] AS [UpdatedDate],
		l.[DeletedOn] AS [DeletedDate]
    from stg.AH_SZ_Properties_Pivot as lpp
    inner join [stg].[AH_Listings_FinalView] as l 
    on lpp.ListingID=l.ID
)
select 
	[ListingID],	
    [Car_Skey],
	[VIN],
	[Year],
	[Make],
	[Model],
	[VehicleColor],
	[EngineSize],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from DMStg
    ');

  CREATE TABLE "dbo"."AH_Cars_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Cars_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Cars_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Cars_DM__dbt_tmp_temp_view"
    end



20:41:11.994432 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:41:11.994588 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:41:12.132841 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:41:18.373049 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.38 seconds
20:41:18.393487 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Cars_DM".
20:41:18.393822 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Cars_DM: rename object "dbo"."AH_Cars_DM" to AH_Cars_DM__dbt_backup
20:41:18.463305 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
20:41:18.483575 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Cars_DM".
20:41:18.483859 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Cars_DM: rename object "dbo"."AH_Cars_DM__dbt_tmp" to AH_Cars_DM
20:41:18.514485 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:41:18.525841 [debug] [Thread-1  ]: On model.Shawn.AH_Cars_DM: COMMIT
20:41:18.534372 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Cars_DM".
20:41:18.534675 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Cars_DM: 
    
  if object_id ('"dbo"."AH_Cars_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Cars_DM__dbt_backup"
    end

20:41:18.760596 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
20:41:18.783450 [debug] [Thread-1  ]: finished collecting timing info
20:41:18.783887 [debug] [Thread-1  ]: On model.Shawn.AH_Cars_DM: Close
20:41:18.784825 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ed56a3-3e1e-45de-9598-31889f989183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f008f557880>]}
20:41:18.785364 [info ] [Thread-1  ]: 1 of 1 OK created table model dbo.AH_Cars_DM.................................... [[32mOK[0m in 6.86s]
20:41:18.785705 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Cars_DM
20:41:18.787078 [debug] [MainThread]: Acquiring new synapse connection "master"
20:41:18.787400 [debug] [MainThread]: On master: COMMIT
20:41:18.787702 [info ] [MainThread]: 
20:41:18.787910 [info ] [MainThread]: Finished running 1 table model in 31.05s.
20:41:18.788064 [debug] [MainThread]: Connection 'master' was properly closed.
20:41:18.788137 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
20:41:18.788256 [debug] [MainThread]: Connection 'model.Shawn.AH_Cars_DM' was properly closed.
20:41:18.820812 [info ] [MainThread]: 
20:41:18.821241 [info ] [MainThread]: [32mCompleted successfully[0m
20:41:18.821539 [info ] [MainThread]: 
20:41:18.821688 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
20:41:18.821964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0097a61c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0095a52460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f008f557e80>]}


============================== 2022-09-26 20:41:21.209523 | 7a0964a6-61bc-4565-8aa3-f4ce9fee3d28 ==============================
20:41:21.209523 [info ] [MainThread]: Running with dbt=1.0.0
20:41:21.214688 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step8_2_FT_stg'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
20:41:21.215004 [debug] [MainThread]: Tracking: tracking
20:41:21.215322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1de32e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1de32d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1de52040>]}
20:41:21.422821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:41:21.423145 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:41:21.449532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a0964a6-61bc-4565-8aa3-f4ce9fee3d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1ddb83a0>]}
20:41:21.499013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a0964a6-61bc-4565-8aa3-f4ce9fee3d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1fe3d970>]}
20:41:21.499551 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:41:21.507793 [info ] [MainThread]: 
20:41:21.508434 [debug] [MainThread]: Acquiring new synapse connection "master"
20:41:21.509477 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
20:41:21.518640 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
20:41:21.518840 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
20:41:21.518929 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:41:21.519039 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:41:21.818989 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:41:21.851798 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.33 seconds
20:41:21.854004 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
20:41:21.876765 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
20:41:21.883454 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
20:41:21.883909 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
20:41:21.885680 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
20:41:21.885830 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
20:41:21.885928 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:41:21.886029 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:41:21.884146 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
20:41:21.887555 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:41:21.887710 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:41:21.984844 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:41:21.986561 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:41:22.052571 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:41:22.055090 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:41:22.191719 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
20:41:22.192029 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
20:41:22.274682 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
20:41:22.275057 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
20:41:45.719819 [debug] [MainThread]: On master: COMMIT
20:41:45.720410 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
20:41:45.720666 [info ] [MainThread]: 
20:41:45.723798 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Listings_FT_stg
20:41:45.724132 [info ] [Thread-1  ]: 1 of 1 START table model stg.AH_Listings_FT_stg................................. [RUN]
20:41:45.724580 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Listings_FT_stg"
20:41:45.724706 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Listings_FT_stg
20:41:45.724822 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Listings_FT_stg
20:41:45.728118 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Listings_FT_stg"
20:41:45.728614 [debug] [Thread-1  ]: finished collecting timing info
20:41:45.728769 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Listings_FT_stg
20:41:45.821514 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Listings_FT_stg"
20:41:45.822122 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_stg".
20:41:45.822298 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_stg: 
  
  if object_id ('"stg"."AH_Listings_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listings_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_Listings_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_Listings_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_Listings_FT_stg__dbt_tmp_temp_view as
    
SELECT
		l.[ID] AS [ListingID],
		l.[OwnerID],
		l.[PrimaryCategoryId],
		l.[CurrencyID],
		l.[ListingTypeID],
		lt.[Name] AS [ListingType],
		l.[CreatedOn] AS [CreatedDate],
		l.[UpdatedOn] AS [UpdatedDate],
		l.[DeletedOn] AS [DeletedDate],
		l.[Title],
		l.[OriginalRelistCount],
		l.[Hits],
		l.[EndDTTM],
		l.[StartDTTM],
		l.[Subtitle],
		l.[Location],
		l.[Status],
		l.[CurrentPrice],
		l.[LastUpdatedUser],
		l.[Duration],
		l.[Version],
		l.[Increment],
		l.[OriginalPrice],
		l.[AutoRelistRemaining],
		l.[CurrentQuantity],
		l.[OriginalQuantity],
		l.[RelistIteration],
		l.[PrimaryImageURI],
		l.[AcceptedActionCount],
		l.[OwnerUserName],
		l.[CurrentListingActionId],
		l.[CurrentListingActionUserName],
		l.[OfferCount],
		lp.[VehicleStoryOpeningStatement],
		lp.[VehicleStoryDescriptionCarFax],
		lp.[Acct_Rep_Phone],
		lp.[HasMagicBox],
		lp.[HasDealerFee],
		lp.[VehicleStory],
		lp.[CarfaxPassFailError],
		lp.[LeadSource],
		lp.[VehicleStoryDescriptionInterior2Pictures],
		lp.[Decade],
		lp.[PaintWork],
		lp.[Specialist_Section_Comp2_Info],
		lp.[Curated],
		lp.[VehicleStoryDescriptionUndercarriagePictures],
		lp.[IsFeaturedVehicle],
		lp.[VehicleStoryOpeningStatementPictures],
		lp.[Copy_Writer_Status],
		lp.[FixedPrice],
		lp.[LockUsername],
		lp.[NoReserveCheck],
		lp.[VehicleStoryDescriptionCarFaxPictures],
		lp.[BeenListed],
		lp.[Acct_Rep],
		lp.[MagicBoxSection4],
		lp.[Copy_Writer],
		lp.[Taxonomy],
		lp.[PersonalMileage],
		lp.[Specialist_Section_Comp2_Price],
		lp.[VehicleStoryDescriptionInterior2],
		lp.[VehicleStoryDescriptionUndercarriage],
		lp.[VehicleStoryDescriptionInteriorPictures],
		lp.[Acct_Rep_Name],
		lp.[CarfaxLink],
		lp.[HideListing],
		lp.[CurrentIssues],
		lp.[TargetReserve],
		lp.[TransactionId],
		lp.[Specialist],
		lp.[BuyItNow],
		lp.[VehicleStoryDescriptionEngineTransmission],
		lp.[CountryOfOrigin],
		lp.[CommissionOverrideReason],
		lp.[WhereDidYouHearAboutUsListingReferral],
		lp.[CaliforniaSmogCheck],
		lp.[Modifications],
		lp.[Zip],
		lp.[ListingState],
		lp.[AnythingElseWeShouldKnow],
		lp.[VehicleTitle],
		lp.[Specialist_Section_Notes],
		lp.[VehicleStoryDescriptionExterior2],
		lp.[Photo_Plan],
		lp.[VehicleStoryDescriptionExterior2Pictures],
		lp.[Era],
		lp.[Commission],
		lp.[MakeOfferAvailable],
		lp.[IsEdited],
		lp.[WhereDidYouHearAboutUsListingOther],
		lp.[MagicBoxSection1],
		lp.[VehicleStoryDescriptionExteriorPictures],
		lp.[Specialist_Section_Original_Reserve],
		lp.[Specialist_Section_Comp1_Info],
		lp.[UI_ListingStateHold],
		lp.[AddressLine2],
		lp.[Specialist_Section_Comp5_Price],
		lp.[WGL_Public_Report],
		lp.[PremiumListing],
		lp.[ReservePrice],
		lp.[DealerURL],
		lp.[IsPaid],
		lp.[OriginalEngineText],
		lp.[HasProMarketing],
		lp.[PhotoPlanId],
		lp.[TransmissionText],
		lp.[MakeOfferAllowed],
		lp.[SchedulingComplete],
		lp.[ServiceRecords],
		lp.[CountryCL],
		lp.[OdometerUnits],
		lp.[BuyItNowUsed],
		lp.[MagicBoxSection3],
		lp.[SnapprPackage],
		lp.[CarfaxPassFail],
		lp.[CCID],
		lp.[StateProvinceRegion],
		lp.[DealerName],
		lp.[ListingProgress],
		lp.[StartingBid],
		lp.[EstimatedMarketValue],
		lp.[Mileage],
		lp.[IsPromoVehicle],
		lp.[MagicBoxSection2],
		lp.[SpinCarLink],
		lp.[MagicBoxSection5],
		lp.[Photo_Plan_Status],
		lp.[Address],
		lp.[HaveAllPhotos],
		lp.[MagicBoxSection6],
		lp.[OriginalEngine],
		lp.[VehicleStoryDescriptionInterior],
		lp.[UserComments],
		lp.[CarTitleInYourName],
		lp.[MarketValue],
		lp.[PackageTransactionId],
		lp.[Specialist_Section_Comp1_Price],
		lp.[Rust],
		lp.[MakeWholeAmount],
		lp.[Specialist_Section_Comp3_Price],
		lp.[VehicleStoryDescriptionEngineTransmissionPictures],
		lp.[WhereDidYouHearAboutUsListing],
		lp.[HasProPhotography],
		lp.[IsApproved],
		lp.[ListingNotes],
		lp.[Specialist_Section_Comp4_Info],
		lp.[HowLongOwned],
		lp.[DraftEmailNotificationSent],
		lp.[Copy_Writer_Feedback],
		lp.[ExpertVideoReview],
		lp.[Specialist_Section_Comp5_Info],
		lp.[Comped],
		lp.[BeenListedText],
		lp.[IsTaxable],
		lp.[Transmission],
		lp.[BeenModified],
		lp.[Specialist_Section_Comp3_Info],
		lp.[CityCL],
		lp.[PaintWorkText],
		lp.[Dealer],
		lp.[ReservePriceCL],
		lp.[MileageAccurate],
		lp.[Acct_Rep_Email],
		lp.[LastServiceInformation],
		lp.[DealerFees],
		lp.[Specialist_Section_Comp4_Price],
		lp.[VehicleStoryDescriptionExterior]
from [stg].[AH_Listings_FinalView] l
left join stg.AH_SZ_Properties_Pivot lp on l.ID=lp.ListingID
left join [stg].[AH_ListingTypes_FinalView] lt on l.ListingTypeID=lt.ID
    ');

  CREATE TABLE "stg"."AH_Listings_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Listings_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Listings_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listings_FT_stg__dbt_tmp_temp_view"
    end



20:41:45.822401 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:41:45.822511 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:41:45.977986 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:41:50.355890 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 4.53 seconds
20:41:50.374593 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_stg".
20:41:50.374852 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_stg: rename object "stg"."AH_Listings_FT_stg" to AH_Listings_FT_stg__dbt_backup
20:41:50.454671 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:41:50.468887 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_stg".
20:41:50.469143 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_stg: rename object "stg"."AH_Listings_FT_stg__dbt_tmp" to AH_Listings_FT_stg
20:41:50.498962 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:41:50.510696 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT_stg: COMMIT
20:41:50.517913 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_stg".
20:41:50.518166 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_stg: 
    
  if object_id ('"stg"."AH_Listings_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_Listings_FT_stg__dbt_backup"
    end

20:41:50.810885 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
20:41:50.825503 [debug] [Thread-1  ]: finished collecting timing info
20:41:50.825855 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT_stg: Close
20:41:50.826704 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a0964a6-61bc-4565-8aa3-f4ce9fee3d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1c184940>]}
20:41:50.827227 [info ] [Thread-1  ]: 1 of 1 OK created table model stg.AH_Listings_FT_stg............................ [[32mOK[0m in 5.10s]
20:41:50.827577 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Listings_FT_stg
20:41:50.828980 [debug] [MainThread]: Acquiring new synapse connection "master"
20:41:50.829276 [debug] [MainThread]: On master: COMMIT
20:41:50.829569 [info ] [MainThread]: 
20:41:50.829779 [info ] [MainThread]: Finished running 1 table model in 29.32s.
20:41:50.829932 [debug] [MainThread]: Connection 'master' was properly closed.
20:41:50.830005 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
20:41:50.830070 [debug] [MainThread]: Connection 'model.Shawn.AH_Listings_FT_stg' was properly closed.
20:41:50.860507 [info ] [MainThread]: 
20:41:50.860844 [info ] [MainThread]: [32mCompleted successfully[0m
20:41:50.861154 [info ] [MainThread]: 
20:41:50.861296 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
20:41:50.861564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1ddec910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1d5ba850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1c11ac10>]}


============================== 2022-09-26 20:41:53.203097 | 1cfa5595-03d0-4e40-9b80-318fbbd4a533 ==============================
20:41:53.203097 [info ] [MainThread]: Running with dbt=1.0.0
20:41:53.203642 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step8_3_FT_tmp'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
20:41:53.203847 [debug] [MainThread]: Tracking: tracking
20:41:53.204151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f909eda5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f909eda5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f909eda5e80>]}
20:41:53.410510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:41:53.410929 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:41:53.437777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cfa5595-03d0-4e40-9b80-318fbbd4a533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f909ed28220>]}
20:41:53.488877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cfa5595-03d0-4e40-9b80-318fbbd4a533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a0d6e9a0>]}
20:41:53.489437 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:41:53.497840 [info ] [MainThread]: 
20:41:53.498482 [debug] [MainThread]: Acquiring new synapse connection "master"
20:41:53.499562 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
20:41:53.508775 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
20:41:53.509010 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
20:41:53.509109 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:41:53.509223 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:41:53.792121 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:41:53.826496 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.32 seconds
20:41:53.828436 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
20:41:53.850057 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
20:41:53.856132 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
20:41:53.856571 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
20:41:53.858292 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
20:41:53.858441 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
20:41:53.858523 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:41:53.858646 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:41:53.856810 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
20:41:53.860156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:41:53.860303 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:41:53.961464 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:41:53.966897 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:41:54.027411 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:41:54.033436 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:41:54.160253 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
20:41:54.160554 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
20:41:54.238244 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
20:41:54.238645 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
20:42:17.544345 [debug] [MainThread]: On master: COMMIT
20:42:17.544942 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
20:42:17.545209 [info ] [MainThread]: 
20:42:17.548927 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Listings_FT_tmp
20:42:17.549284 [info ] [Thread-1  ]: 1 of 1 START table model stg.AH_Listings_FT_tmp................................. [RUN]
20:42:17.549744 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Listings_FT_tmp"
20:42:17.549870 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Listings_FT_tmp
20:42:17.549983 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Listings_FT_tmp
20:42:17.553247 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Listings_FT_tmp"
20:42:17.553676 [debug] [Thread-1  ]: finished collecting timing info
20:42:17.553818 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Listings_FT_tmp
20:42:17.648040 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Listings_FT_tmp"
20:42:17.648625 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_tmp".
20:42:17.648784 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_tmp: 
  
  if object_id ('"stg"."AH_Listings_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listings_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_Listings_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_Listings_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_Listings_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		l.[ListingID],
		condm.[Consignor_SKey],
		cardm.[Car_Skey],
		l.[OwnerID],
		l.[PrimaryCategoryId],
		l.[CurrencyID],
		l.[ListingTypeID],
		l.[ListingType],
		l.[CreatedDate],
		l.[UpdatedDate],
		l.[DeletedDate],
		l.[Title],
		l.[OriginalRelistCount],
		l.[Hits],
		l.[EndDTTM],
		l.[StartDTTM],
		l.[Subtitle],
		l.[Location],
		l.[Status],
		l.[CurrentPrice],
		l.[LastUpdatedUser],
		l.[Duration],
		l.[Version],
		l.[Increment],
		l.[OriginalPrice],
		l.[AutoRelistRemaining],
		l.[CurrentQuantity],
		l.[OriginalQuantity],
		l.[RelistIteration],
		l.[PrimaryImageURI],
		l.[AcceptedActionCount],
		l.[OwnerUserName],
		l.[CurrentListingActionId],
		l.[CurrentListingActionUserName],
		l.[OfferCount],
		l.[VehicleStoryOpeningStatement],
		l.[VehicleStoryDescriptionCarFax],
		l.[Acct_Rep_Phone],
		l.[HasMagicBox],
		l.[HasDealerFee],
		l.[VehicleStory],
		l.[CarfaxPassFailError],
		l.[LeadSource],
		l.[VehicleStoryDescriptionInterior2Pictures],
		l.[Decade],
		l.[PaintWork],
		l.[Specialist_Section_Comp2_Info],
		l.[Curated],
		l.[VehicleStoryDescriptionUndercarriagePictures],
		l.[IsFeaturedVehicle],
		l.[VehicleStoryOpeningStatementPictures],
		l.[Copy_Writer_Status],
		l.[FixedPrice],
		l.[LockUsername],
		l.[NoReserveCheck],
		l.[VehicleStoryDescriptionCarFaxPictures],
		l.[BeenListed],
		l.[Acct_Rep],
		l.[MagicBoxSection4],
		l.[Copy_Writer],
		l.[Taxonomy],
		l.[PersonalMileage],
		l.[Specialist_Section_Comp2_Price],
		l.[VehicleStoryDescriptionInterior2],
		l.[VehicleStoryDescriptionUndercarriage],
		l.[VehicleStoryDescriptionInteriorPictures],
		l.[Acct_Rep_Name],
		l.[CarfaxLink],
		l.[HideListing],
		l.[CurrentIssues],
		l.[TargetReserve],
		l.[TransactionId],
		l.[Specialist],
		l.[BuyItNow],
		l.[VehicleStoryDescriptionEngineTransmission],
		l.[CountryOfOrigin],
		l.[CommissionOverrideReason],
		l.[WhereDidYouHearAboutUsListingReferral],
		l.[CaliforniaSmogCheck],
		l.[Modifications],
		l.[Zip],
		l.[ListingState],
		l.[AnythingElseWeShouldKnow],
		l.[VehicleTitle],
		l.[Specialist_Section_Notes],
		l.[VehicleStoryDescriptionExterior2],
		l.[Photo_Plan],
		l.[VehicleStoryDescriptionExterior2Pictures],
		l.[Era],
		l.[Commission],
		l.[MakeOfferAvailable],
		l.[IsEdited],
		l.[WhereDidYouHearAboutUsListingOther],
		l.[MagicBoxSection1],
		l.[VehicleStoryDescriptionExteriorPictures],
		l.[Specialist_Section_Original_Reserve],
		l.[Specialist_Section_Comp1_Info],
		l.[UI_ListingStateHold],
		l.[AddressLine2],
		l.[Specialist_Section_Comp5_Price],
		l.[WGL_Public_Report],
		l.[PremiumListing],
		l.[ReservePrice],
		l.[DealerURL],
		l.[IsPaid],
		l.[OriginalEngineText],
		l.[HasProMarketing],
		l.[PhotoPlanId],
		l.[TransmissionText],
		l.[MakeOfferAllowed],
		l.[SchedulingComplete],
		l.[ServiceRecords],
		l.[CountryCL],
		l.[OdometerUnits],
		l.[BuyItNowUsed],
		l.[MagicBoxSection3],
		l.[SnapprPackage],
		l.[CarfaxPassFail],
		l.[CCID],
		l.[StateProvinceRegion],
		l.[DealerName],
		l.[ListingProgress],
		l.[StartingBid],
		l.[EstimatedMarketValue],
		l.[Mileage],
		l.[IsPromoVehicle],
		l.[MagicBoxSection2],
		l.[SpinCarLink],
		l.[MagicBoxSection5],
		l.[Photo_Plan_Status],
		l.[Address],
		l.[HaveAllPhotos],
		l.[MagicBoxSection6],
		l.[OriginalEngine],
		l.[VehicleStoryDescriptionInterior],
		l.[UserComments],
		l.[CarTitleInYourName],
		l.[MarketValue],
		l.[PackageTransactionId],
		l.[Specialist_Section_Comp1_Price],
		l.[Rust],
		l.[MakeWholeAmount],
		l.[Specialist_Section_Comp3_Price],
		l.[VehicleStoryDescriptionEngineTransmissionPictures],
		l.[WhereDidYouHearAboutUsListing],
		l.[HasProPhotography],
		l.[IsApproved],
		l.[ListingNotes],
		l.[Specialist_Section_Comp4_Info],
		l.[HowLongOwned],
		l.[DraftEmailNotificationSent],
		l.[Copy_Writer_Feedback],
		l.[ExpertVideoReview],
		l.[Specialist_Section_Comp5_Info],
		l.[Comped],
		l.[BeenListedText],
		l.[IsTaxable],
		l.[Transmission],
		l.[BeenModified],
		l.[Specialist_Section_Comp3_Info],
		l.[CityCL],
		l.[PaintWorkText],
		l.[Dealer],
		l.[ReservePriceCL],
		l.[MileageAccurate],
		l.[Acct_Rep_Email],
		l.[LastServiceInformation],
		l.[DealerFees],
		l.[Specialist_Section_Comp4_Price],
		l.[VehicleStoryDescriptionExterior]
from [stg].[AH_Listings_FT_stg] l
left join [dbo].[AH_Cars_DM] cardm on l.ListingID=cardm.ListingID
left join [dbo].[AH_Consignors_DM] condm on l.OwnerID=condm.UserID
    ');

  CREATE TABLE "stg"."AH_Listings_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Listings_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Listings_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listings_FT_tmp__dbt_tmp_temp_view"
    end



20:42:17.648881 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:42:17.648990 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:42:17.790912 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:42:22.772682 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.12 seconds
20:42:22.791578 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_tmp".
20:42:22.791854 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_tmp: rename object "stg"."AH_Listings_FT_tmp" to AH_Listings_FT_tmp__dbt_backup
20:42:22.942579 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
20:42:22.957299 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_tmp".
20:42:22.957576 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_tmp: rename object "stg"."AH_Listings_FT_tmp__dbt_tmp" to AH_Listings_FT_tmp
20:42:22.988691 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:42:22.999716 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT_tmp: COMMIT
20:42:23.006901 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_tmp".
20:42:23.007145 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_tmp: 
    
  if object_id ('"stg"."AH_Listings_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_Listings_FT_tmp__dbt_backup"
    end

20:42:24.621682 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.61 seconds
20:42:24.634822 [debug] [Thread-1  ]: finished collecting timing info
20:42:24.635154 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT_tmp: Close
20:42:24.635914 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfa5595-03d0-4e40-9b80-318fbbd4a533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f909c9557c0>]}
20:42:24.636368 [info ] [Thread-1  ]: 1 of 1 OK created table model stg.AH_Listings_FT_tmp............................ [[32mOK[0m in 7.09s]
20:42:24.636704 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Listings_FT_tmp
20:42:24.637973 [debug] [MainThread]: Acquiring new synapse connection "master"
20:42:24.638235 [debug] [MainThread]: On master: COMMIT
20:42:24.638496 [info ] [MainThread]: 
20:42:24.638733 [info ] [MainThread]: Finished running 1 table model in 31.14s.
20:42:24.638886 [debug] [MainThread]: Connection 'master' was properly closed.
20:42:24.638960 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
20:42:24.639023 [debug] [MainThread]: Connection 'model.Shawn.AH_Listings_FT_tmp' was properly closed.
20:42:24.668148 [info ] [MainThread]: 
20:42:24.668520 [info ] [MainThread]: [32mCompleted successfully[0m
20:42:24.668761 [info ] [MainThread]: 
20:42:24.668900 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
20:42:24.669168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a0d6ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f909e6276d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f909c955dc0>]}


============================== 2022-09-26 20:42:27.154714 | 67dbb23b-b886-485a-b328-d4d609176150 ==============================
20:42:27.154714 [info ] [MainThread]: Running with dbt=1.0.0
20:42:27.155743 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step8_4_FT'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
20:42:27.155954 [debug] [MainThread]: Tracking: tracking
20:42:27.156282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faadc4a0df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faadc4a0e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faadc4a0f70>]}
20:42:27.360204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:42:27.360513 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:42:27.387045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67dbb23b-b886-485a-b328-d4d609176150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faadc426340>]}
20:42:27.435257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67dbb23b-b886-485a-b328-d4d609176150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faade465910>]}
20:42:27.435778 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:42:27.443907 [info ] [MainThread]: 
20:42:27.444502 [debug] [MainThread]: Acquiring new synapse connection "master"
20:42:27.446022 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
20:42:27.455131 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
20:42:27.455340 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
20:42:27.455434 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:42:27.455547 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:42:27.755792 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:42:27.792508 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.34 seconds
20:42:27.794599 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
20:42:27.817018 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
20:42:27.823135 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
20:42:27.823543 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
20:42:27.825217 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
20:42:27.825374 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
20:42:27.825455 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:42:27.825552 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:42:27.823760 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
20:42:27.827006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:42:27.827151 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:42:27.973035 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:42:27.973568 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:42:28.040213 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.21 seconds
20:42:28.042692 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.22 seconds
20:42:28.175959 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
20:42:28.176264 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
20:42:28.237971 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
20:42:28.238267 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
20:42:51.978132 [debug] [MainThread]: On master: COMMIT
20:42:51.978758 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
20:42:51.979025 [info ] [MainThread]: 
20:42:51.982646 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Listings_FT
20:42:51.982995 [info ] [Thread-1  ]: 1 of 1 START table model dbo.AH_Listings_FT..................................... [RUN]
20:42:51.983445 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Listings_FT"
20:42:51.983568 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Listings_FT
20:42:51.983678 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Listings_FT
20:42:51.988272 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Listings_FT"
20:42:51.988691 [debug] [Thread-1  ]: finished collecting timing info
20:42:51.988823 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Listings_FT
20:42:52.057239 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Listings_FT"
20:42:52.057813 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT".
20:42:52.057964 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT: 
  
  if object_id ('"dbo"."AH_Listings_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listings_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Listings_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Listings_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_Listings_FT__dbt_tmp_temp_view as
    
with updateData as (
    select 
    	FTstg.[ListingID],
		FTtmp.[Consignor_SKey],
		FTtmp.[Car_Skey],
		FTstg.[PrimaryCategoryId],
		FTstg.[CurrencyID],
		FTstg.[ListingTypeID],
		FTstg.[ListingType],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate],
		FTstg.[DeletedDate],
		FTstg.[Title],
		FTstg.[OriginalRelistCount],
		FTstg.[Hits],
		FTstg.[EndDTTM],
		FTstg.[StartDTTM],
		FTstg.[Subtitle],
		FTstg.[Location],
		FTstg.[Status],
		FTstg.[CurrentPrice],
		FTstg.[LastUpdatedUser],
		FTstg.[Duration],
		FTstg.[Version],
		FTstg.[Increment],
		FTstg.[OriginalPrice],
		FTstg.[AutoRelistRemaining],
		FTstg.[CurrentQuantity],
		FTstg.[OriginalQuantity],
		FTstg.[RelistIteration],
		FTstg.[PrimaryImageURI],
		FTstg.[AcceptedActionCount],
		FTstg.[OwnerUserName],
		FTstg.[CurrentListingActionId],
		FTstg.[CurrentListingActionUserName],
		FTstg.[OfferCount],
		FTstg.[VehicleStoryOpeningStatement],
		FTstg.[VehicleStoryDescriptionCarFax],
		FTstg.[Acct_Rep_Phone],
		FTstg.[HasMagicBox],
		FTstg.[HasDealerFee],
		FTstg.[VehicleStory],
		FTstg.[CarfaxPassFailError],
		FTstg.[LeadSource],
		FTstg.[VehicleStoryDescriptionInterior2Pictures],
		FTstg.[Decade],
		FTstg.[PaintWork],
		FTstg.[Specialist_Section_Comp2_Info],
		FTstg.[Curated],
		FTstg.[VehicleStoryDescriptionUndercarriagePictures],
		FTstg.[IsFeaturedVehicle],
		FTstg.[VehicleStoryOpeningStatementPictures],
		FTstg.[Copy_Writer_Status],
		FTstg.[FixedPrice],
		FTstg.[LockUsername],
		FTstg.[NoReserveCheck],
		FTstg.[VehicleStoryDescriptionCarFaxPictures],
		FTstg.[BeenListed],
		FTstg.[Acct_Rep],
		FTstg.[MagicBoxSection4],
		FTstg.[Copy_Writer],
		FTstg.[Taxonomy],
		FTstg.[PersonalMileage],
		FTstg.[Specialist_Section_Comp2_Price],
		FTstg.[VehicleStoryDescriptionInterior2],
		FTstg.[VehicleStoryDescriptionUndercarriage],
		FTstg.[VehicleStoryDescriptionInteriorPictures],
		FTstg.[Acct_Rep_Name],
		FTstg.[CarfaxLink],
		FTstg.[HideListing],
		FTstg.[CurrentIssues],
		FTstg.[TargetReserve],
		FTstg.[TransactionId],
		FTstg.[Specialist],
		FTstg.[BuyItNow],
		FTstg.[VehicleStoryDescriptionEngineTransmission],
		FTstg.[CountryOfOrigin],
		FTstg.[CommissionOverrideReason],
		FTstg.[WhereDidYouHearAboutUsListingReferral],
		FTstg.[CaliforniaSmogCheck],
		FTstg.[Modifications],
		FTstg.[Zip],
		FTstg.[ListingState],
		FTstg.[AnythingElseWeShouldKnow],
		FTstg.[VehicleTitle],
		FTstg.[Specialist_Section_Notes],
		FTstg.[VehicleStoryDescriptionExterior2],
		FTstg.[Photo_Plan],
		FTstg.[VehicleStoryDescriptionExterior2Pictures],
		FTstg.[Era],
		FTstg.[Commission],
		FTstg.[MakeOfferAvailable],
		FTstg.[IsEdited],
		FTstg.[WhereDidYouHearAboutUsListingOther],
		FTstg.[MagicBoxSection1],
		FTstg.[VehicleStoryDescriptionExteriorPictures],
		FTstg.[Specialist_Section_Original_Reserve],
		FTstg.[Specialist_Section_Comp1_Info],
		FTstg.[UI_ListingStateHold],
		FTstg.[AddressLine2],
		FTstg.[Specialist_Section_Comp5_Price],
		FTstg.[WGL_Public_Report],
		FTstg.[PremiumListing],
		FTstg.[ReservePrice],
		FTstg.[DealerURL],
		FTstg.[IsPaid],
		FTstg.[OriginalEngineText],
		FTstg.[HasProMarketing],
		FTstg.[PhotoPlanId],
		FTstg.[TransmissionText],
		FTstg.[MakeOfferAllowed],
		FTstg.[SchedulingComplete],
		FTstg.[ServiceRecords],
		FTstg.[CountryCL],
		FTstg.[OdometerUnits],
		FTstg.[BuyItNowUsed],
		FTstg.[MagicBoxSection3],
		FTstg.[SnapprPackage],
		FTstg.[CarfaxPassFail],
		FTstg.[CCID],
		FTstg.[StateProvinceRegion],
		FTstg.[DealerName],
		FTstg.[ListingProgress],
		FTstg.[StartingBid],
		FTstg.[EstimatedMarketValue],
		FTstg.[Mileage],
		FTstg.[IsPromoVehicle],
		FTstg.[MagicBoxSection2],
		FTstg.[SpinCarLink],
		FTstg.[MagicBoxSection5],
		FTstg.[Photo_Plan_Status],
		FTstg.[Address],
		FTstg.[HaveAllPhotos],
		FTstg.[MagicBoxSection6],
		FTstg.[OriginalEngine],
		FTstg.[VehicleStoryDescriptionInterior],
		FTstg.[UserComments],
		FTstg.[CarTitleInYourName],
		FTstg.[MarketValue],
		FTstg.[PackageTransactionId],
		FTstg.[Specialist_Section_Comp1_Price],
		FTstg.[Rust],
		FTstg.[MakeWholeAmount],
		FTstg.[Specialist_Section_Comp3_Price],
		FTstg.[VehicleStoryDescriptionEngineTransmissionPictures],
		FTstg.[WhereDidYouHearAboutUsListing],
		FTstg.[HasProPhotography],
		FTstg.[IsApproved],
		FTstg.[ListingNotes],
		FTstg.[Specialist_Section_Comp4_Info],
		FTstg.[HowLongOwned],
		FTstg.[DraftEmailNotificationSent],
		FTstg.[Copy_Writer_Feedback],
		FTstg.[ExpertVideoReview],
		FTstg.[Specialist_Section_Comp5_Info],
		FTstg.[Comped],
		FTstg.[BeenListedText],
		FTstg.[IsTaxable],
		FTstg.[Transmission],
		FTstg.[BeenModified],
		FTstg.[Specialist_Section_Comp3_Info],
		FTstg.[CityCL],
		FTstg.[PaintWorkText],
		FTstg.[Dealer],
		FTstg.[ReservePriceCL],
		FTstg.[MileageAccurate],
		FTstg.[Acct_Rep_Email],
		FTstg.[LastServiceInformation],
		FTstg.[DealerFees],
		FTstg.[Specialist_Section_Comp4_Price],
		FTstg.[VehicleStoryDescriptionExterior]
    from stg.AH_Listings_FT_tmp as FTtmp 
    join stg.AH_Listings_FT_stg as FTstg 
    on FTstg.ListingID=FTtmp.ListingID
)
,
insertData as (
    select 
        [ListingID],
        [Consignor_SKey],
        [Car_Skey],
        [PrimaryCategoryId],
        [CurrencyID],
        [ListingTypeID],
        [ListingType],
        [CreatedDate],
        [UpdatedDate],
        [DeletedDate],
        [Title],
        [OriginalRelistCount],
        [Hits],
        [EndDTTM],
        [StartDTTM],
        [Subtitle],
        [Location],
        [Status],
        [CurrentPrice],
        [LastUpdatedUser],
        [Duration],
        [Version],
        [Increment],
        [OriginalPrice],
        [AutoRelistRemaining],
        [CurrentQuantity],
        [OriginalQuantity],
        [RelistIteration],
        [PrimaryImageURI],
        [AcceptedActionCount],
        [OwnerUserName],
        [CurrentListingActionId],
        [CurrentListingActionUserName],
        [OfferCount],
        [VehicleStoryOpeningStatement],
        [VehicleStoryDescriptionCarFax],
        [Acct_Rep_Phone],
        [HasMagicBox],
        [HasDealerFee],
        [VehicleStory],
        [CarfaxPassFailError],
        [LeadSource],
        [VehicleStoryDescriptionInterior2Pictures],
        [Decade],
        [PaintWork],
        [Specialist_Section_Comp2_Info],
        [Curated],
        [VehicleStoryDescriptionUndercarriagePictures],
        [IsFeaturedVehicle],
        [VehicleStoryOpeningStatementPictures],
        [Copy_Writer_Status],
        [FixedPrice],
        [LockUsername],
        [NoReserveCheck],
        [VehicleStoryDescriptionCarFaxPictures],
        [BeenListed],
        [Acct_Rep],
        [MagicBoxSection4],
        [Copy_Writer],
        [Taxonomy],
        [PersonalMileage],
        [Specialist_Section_Comp2_Price],
        [VehicleStoryDescriptionInterior2],
        [VehicleStoryDescriptionUndercarriage],
        [VehicleStoryDescriptionInteriorPictures],
        [Acct_Rep_Name],
        [CarfaxLink],
        [HideListing],
        [CurrentIssues],
        [TargetReserve],
        [TransactionId],
        [Specialist],
        [BuyItNow],
        [VehicleStoryDescriptionEngineTransmission],
        [CountryOfOrigin],
        [CommissionOverrideReason],
        [WhereDidYouHearAboutUsListingReferral],
        [CaliforniaSmogCheck],
        [Modifications],
        [Zip],
        [ListingState],
        [AnythingElseWeShouldKnow],
        [VehicleTitle],
        [Specialist_Section_Notes],
        [VehicleStoryDescriptionExterior2],
        [Photo_Plan],
        [VehicleStoryDescriptionExterior2Pictures],
        [Era],
        [Commission],
        [MakeOfferAvailable],
        [IsEdited],
        [WhereDidYouHearAboutUsListingOther],
        [MagicBoxSection1],
        [VehicleStoryDescriptionExteriorPictures],
        [Specialist_Section_Original_Reserve],
        [Specialist_Section_Comp1_Info],
        [UI_ListingStateHold],
        [AddressLine2],
        [Specialist_Section_Comp5_Price],
        [WGL_Public_Report],
        [PremiumListing],
        [ReservePrice],
        [DealerURL],
        [IsPaid],
        [OriginalEngineText],
        [HasProMarketing],
        [PhotoPlanId],
        [TransmissionText],
        [MakeOfferAllowed],
        [SchedulingComplete],
        [ServiceRecords],
        [CountryCL],
        [OdometerUnits],
        [BuyItNowUsed],
        [MagicBoxSection3],
        [SnapprPackage],
        [CarfaxPassFail],
        [CCID],
        [StateProvinceRegion],
        [DealerName],
        [ListingProgress],
        [StartingBid],
        [EstimatedMarketValue],
        [Mileage],
        [IsPromoVehicle],
        [MagicBoxSection2],
        [SpinCarLink],
        [MagicBoxSection5],
        [Photo_Plan_Status],
        [Address],
        [HaveAllPhotos],
        [MagicBoxSection6],
        [OriginalEngine],
        [VehicleStoryDescriptionInterior],
        [UserComments],
        [CarTitleInYourName],
        [MarketValue],
        [PackageTransactionId],
        [Specialist_Section_Comp1_Price],
        [Rust],
        [MakeWholeAmount],
        [Specialist_Section_Comp3_Price],
        [VehicleStoryDescriptionEngineTransmissionPictures],
        [WhereDidYouHearAboutUsListing],
        [HasProPhotography],
        [IsApproved],
        [ListingNotes],
        [Specialist_Section_Comp4_Info],
        [HowLongOwned],
        [DraftEmailNotificationSent],
        [Copy_Writer_Feedback],
        [ExpertVideoReview],
        [Specialist_Section_Comp5_Info],
        [Comped],
        [BeenListedText],
        [IsTaxable],
        [Transmission],
        [BeenModified],
        [Specialist_Section_Comp3_Info],
        [CityCL],
        [PaintWorkText],
        [Dealer],
        [ReservePriceCL],
        [MileageAccurate],
        [Acct_Rep_Email],
        [LastServiceInformation],
        [DealerFees],
        [Specialist_Section_Comp4_Price],
        [VehicleStoryDescriptionExterior]
    from stg.AH_Listings_FT_tmp
    where ListingID not in (select  ListingID from stg.AH_Listings_FT_stg)
)
SELECT
	[ListingID],
	[Consignor_SKey],
	[Car_Skey],
	[PrimaryCategoryId],
	[CurrencyID],
	[ListingTypeID],
	[ListingType],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate],
	[Title],
	[OriginalRelistCount],
	[Hits],
	[EndDTTM],
	[StartDTTM],
	[Subtitle],
	[Location],
	[Status],
	[CurrentPrice],
	[LastUpdatedUser],
	[Duration],
	[Version],
	[Increment],
	[OriginalPrice],
	[AutoRelistRemaining],
	[CurrentQuantity],
	[OriginalQuantity],
	[RelistIteration],
	[PrimaryImageURI],
	[AcceptedActionCount],
	[OwnerUserName],
	[CurrentListingActionId],
	[CurrentListingActionUserName],
	[OfferCount],
	[VehicleStoryOpeningStatement],
	[VehicleStoryDescriptionCarFax],
	[Acct_Rep_Phone],
	[HasMagicBox],
	[HasDealerFee],
	[VehicleStory],
	[CarfaxPassFailError],
	[LeadSource],
	[VehicleStoryDescriptionInterior2Pictures],
	[Decade],
	[PaintWork],
	[Specialist_Section_Comp2_Info],
	[Curated],
	[VehicleStoryDescriptionUndercarriagePictures],
	[IsFeaturedVehicle],
	[VehicleStoryOpeningStatementPictures],
	[Copy_Writer_Status],
	[FixedPrice],
	[LockUsername],
	[NoReserveCheck],
	[VehicleStoryDescriptionCarFaxPictures],
	[BeenListed],
	[Acct_Rep],
	[MagicBoxSection4],
	[Copy_Writer],
	[Taxonomy],
	[PersonalMileage],
	[Specialist_Section_Comp2_Price],
	[VehicleStoryDescriptionInterior2],
	[VehicleStoryDescriptionUndercarriage],
	[VehicleStoryDescriptionInteriorPictures],
	[Acct_Rep_Name],
	[CarfaxLink],
	[HideListing],
	[CurrentIssues],
	[TargetReserve],
	[TransactionId],
	[Specialist],
	[BuyItNow],
	[VehicleStoryDescriptionEngineTransmission],
	[CountryOfOrigin],
	[CommissionOverrideReason],
	[WhereDidYouHearAboutUsListingReferral],
	[CaliforniaSmogCheck],
	[Modifications],
	[Zip],
	[ListingState],
	[AnythingElseWeShouldKnow],
	[VehicleTitle],
	[Specialist_Section_Notes],
	[VehicleStoryDescriptionExterior2],
	[Photo_Plan],
	[VehicleStoryDescriptionExterior2Pictures],
	[Era],
	[Commission],
	[MakeOfferAvailable],
	[IsEdited],
	[WhereDidYouHearAboutUsListingOther],
	[MagicBoxSection1],
	[VehicleStoryDescriptionExteriorPictures],
	[Specialist_Section_Original_Reserve],
	[Specialist_Section_Comp1_Info],
	[UI_ListingStateHold],
	[AddressLine2],
	[Specialist_Section_Comp5_Price],
	[WGL_Public_Report],
	[PremiumListing],
	[ReservePrice],
	[DealerURL],
	[IsPaid],
	[OriginalEngineText],
	[HasProMarketing],
	[PhotoPlanId],
	[TransmissionText],
	[MakeOfferAllowed],
	[SchedulingComplete],
	[ServiceRecords],
	[CountryCL],
	[OdometerUnits],
	[BuyItNowUsed],
	[MagicBoxSection3],
	[SnapprPackage],
	[CarfaxPassFail],
	[CCID],
	[StateProvinceRegion],
	[DealerName],
	[ListingProgress],
	[StartingBid],
	[EstimatedMarketValue],
	[Mileage],
	[IsPromoVehicle],
	[MagicBoxSection2],
	[SpinCarLink],
	[MagicBoxSection5],
	[Photo_Plan_Status],
	[Address],
	[HaveAllPhotos],
	[MagicBoxSection6],
	[OriginalEngine],
	[VehicleStoryDescriptionInterior],
	[UserComments],
	[CarTitleInYourName],
	[MarketValue],
	[PackageTransactionId],
	[Specialist_Section_Comp1_Price],
	[Rust],
	[MakeWholeAmount],
	[Specialist_Section_Comp3_Price],
	[VehicleStoryDescriptionEngineTransmissionPictures],
	[WhereDidYouHearAboutUsListing],
	[HasProPhotography],
	[IsApproved],
	[ListingNotes],
	[Specialist_Section_Comp4_Info],
	[HowLongOwned],
	[DraftEmailNotificationSent],
	[Copy_Writer_Feedback],
	[ExpertVideoReview],
	[Specialist_Section_Comp5_Info],
	[Comped],
	[BeenListedText],
	[IsTaxable],
	[Transmission],
	[BeenModified],
	[Specialist_Section_Comp3_Info],
	[CityCL],
	[PaintWorkText],
	[Dealer],
	[ReservePriceCL],
	[MileageAccurate],
	[Acct_Rep_Email],
	[LastServiceInformation],
	[DealerFees],
	[Specialist_Section_Comp4_Price],
	[VehicleStoryDescriptionExterior]
from updateData

union all

SELECT
	[ListingID],
	[Consignor_SKey],
	[Car_Skey],
	[PrimaryCategoryId],
	[CurrencyID],
	[ListingTypeID],
	[ListingType],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate],
	[Title],
	[OriginalRelistCount],
	[Hits],
	[EndDTTM],
	[StartDTTM],
	[Subtitle],
	[Location],
	[Status],
	[CurrentPrice],
	[LastUpdatedUser],
	[Duration],
	[Version],
	[Increment],
	[OriginalPrice],
	[AutoRelistRemaining],
	[CurrentQuantity],
	[OriginalQuantity],
	[RelistIteration],
	[PrimaryImageURI],
	[AcceptedActionCount],
	[OwnerUserName],
	[CurrentListingActionId],
	[CurrentListingActionUserName],
	[OfferCount],
	[VehicleStoryOpeningStatement],
	[VehicleStoryDescriptionCarFax],
	[Acct_Rep_Phone],
	[HasMagicBox],
	[HasDealerFee],
	[VehicleStory],
	[CarfaxPassFailError],
	[LeadSource],
	[VehicleStoryDescriptionInterior2Pictures],
	[Decade],
	[PaintWork],
	[Specialist_Section_Comp2_Info],
	[Curated],
	[VehicleStoryDescriptionUndercarriagePictures],
	[IsFeaturedVehicle],
	[VehicleStoryOpeningStatementPictures],
	[Copy_Writer_Status],
	[FixedPrice],
	[LockUsername],
	[NoReserveCheck],
	[VehicleStoryDescriptionCarFaxPictures],
	[BeenListed],
	[Acct_Rep],
	[MagicBoxSection4],
	[Copy_Writer],
	[Taxonomy],
	[PersonalMileage],
	[Specialist_Section_Comp2_Price],
	[VehicleStoryDescriptionInterior2],
	[VehicleStoryDescriptionUndercarriage],
	[VehicleStoryDescriptionInteriorPictures],
	[Acct_Rep_Name],
	[CarfaxLink],
	[HideListing],
	[CurrentIssues],
	[TargetReserve],
	[TransactionId],
	[Specialist],
	[BuyItNow],
	[VehicleStoryDescriptionEngineTransmission],
	[CountryOfOrigin],
	[CommissionOverrideReason],
	[WhereDidYouHearAboutUsListingReferral],
	[CaliforniaSmogCheck],
	[Modifications],
	[Zip],
	[ListingState],
	[AnythingElseWeShouldKnow],
	[VehicleTitle],
	[Specialist_Section_Notes],
	[VehicleStoryDescriptionExterior2],
	[Photo_Plan],
	[VehicleStoryDescriptionExterior2Pictures],
	[Era],
	[Commission],
	[MakeOfferAvailable],
	[IsEdited],
	[WhereDidYouHearAboutUsListingOther],
	[MagicBoxSection1],
	[VehicleStoryDescriptionExteriorPictures],
	[Specialist_Section_Original_Reserve],
	[Specialist_Section_Comp1_Info],
	[UI_ListingStateHold],
	[AddressLine2],
	[Specialist_Section_Comp5_Price],
	[WGL_Public_Report],
	[PremiumListing],
	[ReservePrice],
	[DealerURL],
	[IsPaid],
	[OriginalEngineText],
	[HasProMarketing],
	[PhotoPlanId],
	[TransmissionText],
	[MakeOfferAllowed],
	[SchedulingComplete],
	[ServiceRecords],
	[CountryCL],
	[OdometerUnits],
	[BuyItNowUsed],
	[MagicBoxSection3],
	[SnapprPackage],
	[CarfaxPassFail],
	[CCID],
	[StateProvinceRegion],
	[DealerName],
	[ListingProgress],
	[StartingBid],
	[EstimatedMarketValue],
	[Mileage],
	[IsPromoVehicle],
	[MagicBoxSection2],
	[SpinCarLink],
	[MagicBoxSection5],
	[Photo_Plan_Status],
	[Address],
	[HaveAllPhotos],
	[MagicBoxSection6],
	[OriginalEngine],
	[VehicleStoryDescriptionInterior],
	[UserComments],
	[CarTitleInYourName],
	[MarketValue],
	[PackageTransactionId],
	[Specialist_Section_Comp1_Price],
	[Rust],
	[MakeWholeAmount],
	[Specialist_Section_Comp3_Price],
	[VehicleStoryDescriptionEngineTransmissionPictures],
	[WhereDidYouHearAboutUsListing],
	[HasProPhotography],
	[IsApproved],
	[ListingNotes],
	[Specialist_Section_Comp4_Info],
	[HowLongOwned],
	[DraftEmailNotificationSent],
	[Copy_Writer_Feedback],
	[ExpertVideoReview],
	[Specialist_Section_Comp5_Info],
	[Comped],
	[BeenListedText],
	[IsTaxable],
	[Transmission],
	[BeenModified],
	[Specialist_Section_Comp3_Info],
	[CityCL],
	[PaintWorkText],
	[Dealer],
	[ReservePriceCL],
	[MileageAccurate],
	[Acct_Rep_Email],
	[LastServiceInformation],
	[DealerFees],
	[Specialist_Section_Comp4_Price],
	[VehicleStoryDescriptionExterior]
from insertData
    ');

  CREATE TABLE "dbo"."AH_Listings_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Listings_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Listings_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listings_FT__dbt_tmp_temp_view"
    end



20:42:52.058090 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:42:52.058204 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:42:52.178908 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:42:56.048993 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.99 seconds
20:42:56.068585 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT".
20:42:56.068846 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT: rename object "dbo"."AH_Listings_FT" to AH_Listings_FT__dbt_backup
20:42:56.150347 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
20:42:56.165212 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT".
20:42:56.165493 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT: rename object "dbo"."AH_Listings_FT__dbt_tmp" to AH_Listings_FT
20:42:56.194976 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
20:42:56.205938 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT: COMMIT
20:42:56.213037 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT".
20:42:56.213290 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT: 
    
  if object_id ('"dbo"."AH_Listings_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Listings_FT__dbt_backup"
    end

20:42:58.544554 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.33 seconds
20:42:58.559185 [debug] [Thread-1  ]: finished collecting timing info
20:42:58.559515 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT: Close
20:42:58.560296 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67dbb23b-b886-485a-b328-d4d609176150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad9f748e0>]}
20:42:58.560731 [info ] [Thread-1  ]: 1 of 1 OK created table model dbo.AH_Listings_FT................................ [[32mOK[0m in 6.58s]
20:42:58.561045 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Listings_FT
20:42:58.562373 [debug] [MainThread]: Acquiring new synapse connection "master"
20:42:58.562670 [debug] [MainThread]: On master: COMMIT
20:42:58.562952 [info ] [MainThread]: 
20:42:58.563145 [info ] [MainThread]: Finished running 1 table model in 31.12s.
20:42:58.563299 [debug] [MainThread]: Connection 'master' was properly closed.
20:42:58.563374 [debug] [MainThread]: Connection 'model.Shawn.AH_Listings_FT' was properly closed.
20:42:58.563438 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
20:42:58.592592 [info ] [MainThread]: 
20:42:58.592957 [info ] [MainThread]: [32mCompleted successfully[0m
20:42:58.593189 [info ] [MainThread]: 
20:42:58.593329 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
20:42:58.593603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faadc457910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faadc1a8370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad9f74910>]}
